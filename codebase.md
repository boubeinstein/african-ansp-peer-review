# .claude/settings.local.json

```json
{
  "permissions": {
    "allow": [
      "Bash(ls:*)",
      "Bash(npm run typecheck:*)",
      "Bash(npm run lint:*)",
      "Bash(npm run build:*)",
      "Bash(npm install:*)",
      "Bash(npm run test:run:*)",
      "Bash(node -e:*)",
      "Bash(npx prisma generate:*)",
      "Bash(npx tsx:*)",
      "Bash(npx prisma db push:*)",
      "Bash(npm run test:*)"
    ]
  }
}

```

# .gitignore

```
# Dependencies
node_modules
.pnpm-store

# Next.js
.next
out
build

# Environment files
.env
.env.local
.env.*.local

# Database
prisma/*.db
prisma/*.db-journal

# Debug
npm-debug.log*
yarn-debug.log*
yarn-error.log*

# IDE
.idea
.vscode
*.swp
*.swo

# OS
.DS_Store
Thumbs.db

# Test
coverage
.nyc_output

# Misc
*.pem
*.log

```

# codebase-1.md

```md
# .gitignore

\`\`\`
# Dependencies
node_modules
.pnpm-store

# Next.js
.next
out
build

# Environment files
.env
.env.local
.env.*.local

# Database
prisma/*.db
prisma/*.db-journal

# Debug
npm-debug.log*
yarn-debug.log*
yarn-error.log*

# IDE
.idea
.vscode
*.swp
*.swo

# OS
.DS_Store
Thumbs.db

# Test
coverage
.nyc_output

# Misc
*.pem
*.log

\`\`\`

# components.json

\`\`\`json
{
  "$schema": "https://ui.shadcn.com/schema.json",
  "style": "new-york",
  "rsc": true,
  "tsx": true,
  "tailwind": {
    "config": "",
    "css": "src/app/globals.css",
    "baseColor": "gray",
    "cssVariables": true,
    "prefix": ""
  },
  "iconLibrary": "lucide",
  "aliases": {
    "components": "@/components",
    "utils": "@/lib/utils",
    "ui": "@/components/ui",
    "lib": "@/lib",
    "hooks": "@/hooks"
  },
  "registries": {}
}

\`\`\`

# eslint.config.mjs

\`\`\`mjs
import { defineConfig, globalIgnores } from "eslint/config";
import nextVitals from "eslint-config-next/core-web-vitals";
import nextTs from "eslint-config-next/typescript";

const eslintConfig = defineConfig([
  ...nextVitals,
  ...nextTs,
  // Override default ignores of eslint-config-next.
  globalIgnores([
    // Default ignores of eslint-config-next:
    ".next/**",
    "out/**",
    "build/**",
    "next-env.d.ts",
  ]),
]);

export default eslintConfig;

\`\`\`

# messages/en.json

\`\`\`json
{
  "common": {
    "appName": "African ANSP Peer Review",
    "appTagline": "Collaborative Excellence in Aviation Safety",
    "actions": {
      "save": "Save",
      "cancel": "Cancel",
      "submit": "Submit",
      "delete": "Delete",
      "edit": "Edit",
      "view": "View",
      "close": "Close",
      "confirm": "Confirm",
      "back": "Back",
      "next": "Next",
      "profile": "Profile",
      "settings": "Settings",
      "logout": "Log out"
    }
  },
  "navigation": {
    "dashboard": "Dashboard",
    "questionnaires": "Questionnaires",
    "assessments": "Assessments",
    "reviews": "Peer Reviews",
    "organizations": "Organizations",
    "reviewers": "Reviewers",
    "training": "Training",
    "settings": "Settings"
  },
  "auth": {
    "login": {
      "title": "Welcome back",
      "subtitle": "Sign in to your account to continue",
      "signIn": "Sign in",
      "signingIn": "Signing in...",
      "forgotPassword": "Forgot password?",
      "noAccount": "Don't have an account?",
      "signUp": "Sign up"
    },
    "register": {
      "title": "Create an account",
      "subtitle": "Join the African ANSP Peer Review Program",
      "createAccount": "Create account",
      "creating": "Creating account...",
      "haveAccount": "Already have an account?",
      "signIn": "Sign in",
      "success": "Account created successfully!",
      "redirecting": "Redirecting to login...",
      "passwordRequirements": "Min 12 characters with uppercase, lowercase, number, and special character"
    },
    "fields": {
      "email": "Email",
      "password": "Password",
      "confirmPassword": "Confirm Password",
      "firstName": "First Name",
      "lastName": "Last Name",
      "language": "Preferred Language"
    },
    "errors": {
      "invalidCredentials": "Invalid email or password",
      "generic": "An error occurred. Please try again."
    }
  },
  "dashboard": {
    "title": "Dashboard",
    "welcome": "Welcome back",
    "overview": "Here's an overview of your peer review activities."
  },
  "questionnaire": {
    "ans": {
      "title": "ANS Questionnaire (USOAP CMA 2024)",
      "subtitle": "851 Protocol Questions across 9 audit areas"
    },
    "sms": {
      "title": "SMS Questionnaire (CANSO SoE)",
      "subtitle": "Safety Management System maturity assessment"
    }
  }
}

\`\`\`

# messages/fr.json

\`\`\`json
{
  "common": {
    "appName": "Revue par les Pairs ANSP Africains",
    "appTagline": "Excellence Collaborative en Sécurité Aéronautique",
    "actions": {
      "save": "Enregistrer",
      "cancel": "Annuler",
      "submit": "Soumettre",
      "delete": "Supprimer",
      "edit": "Modifier",
      "view": "Voir",
      "close": "Fermer",
      "confirm": "Confirmer",
      "back": "Retour",
      "next": "Suivant",
      "profile": "Profil",
      "settings": "Paramètres",
      "logout": "Déconnexion"
    }
  },
  "navigation": {
    "dashboard": "Tableau de bord",
    "questionnaires": "Questionnaires",
    "assessments": "Évaluations",
    "reviews": "Revues par les Pairs",
    "organizations": "Organisations",
    "reviewers": "Évaluateurs",
    "training": "Formation",
    "settings": "Paramètres"
  },
  "auth": {
    "login": {
      "title": "Bon retour",
      "subtitle": "Connectez-vous à votre compte pour continuer",
      "signIn": "Se connecter",
      "signingIn": "Connexion...",
      "forgotPassword": "Mot de passe oublié?",
      "noAccount": "Vous n'avez pas de compte?",
      "signUp": "S'inscrire"
    },
    "register": {
      "title": "Créer un compte",
      "subtitle": "Rejoignez le Programme de Revue par les Pairs ANSP Africains",
      "createAccount": "Créer un compte",
      "creating": "Création du compte...",
      "haveAccount": "Vous avez déjà un compte?",
      "signIn": "Se connecter",
      "success": "Compte créé avec succès!",
      "redirecting": "Redirection vers la connexion...",
      "passwordRequirements": "Min 12 caractères avec majuscule, minuscule, chiffre et caractère spécial"
    },
    "fields": {
      "email": "E-mail",
      "password": "Mot de passe",
      "confirmPassword": "Confirmer le mot de passe",
      "firstName": "Prénom",
      "lastName": "Nom",
      "language": "Langue préférée"
    },
    "errors": {
      "invalidCredentials": "E-mail ou mot de passe invalide",
      "generic": "Une erreur s'est produite. Veuillez réessayer."
    }
  },
  "dashboard": {
    "title": "Tableau de bord",
    "welcome": "Bon retour",
    "overview": "Voici un aperçu de vos activités de revue par les pairs."
  },
  "questionnaire": {
    "ans": {
      "title": "Questionnaire ANS (USOAP CMA 2024)",
      "subtitle": "851 Questions de Protocole dans 9 domaines d'audit"
    },
    "sms": {
      "title": "Questionnaire SMS (CANSO SoE)",
      "subtitle": "Évaluation de la maturité du Système de Gestion de la Sécurité"
    }
  }
}

\`\`\`

# next-env.d.ts

\`\`\`ts
/// <reference types="next" />
/// <reference types="next/image-types/global" />
import "./.next/dev/types/routes.d.ts";

// NOTE: This file should not be edited
// see https://nextjs.org/docs/app/api-reference/config/typescript for more information.

\`\`\`

# next.config.ts

\`\`\`ts
import type { NextConfig } from "next";
import createNextIntlPlugin from "next-intl/plugin";

const withNextIntl = createNextIntlPlugin("./src/lib/i18n/request.ts");

const nextConfig: NextConfig = {
  /* config options here */
};

export default withNextIntl(nextConfig);

\`\`\`

# package.json

\`\`\`json
{
  "name": "african-ansp-peer-review",
  "version": "0.1.0",
  "private": true,
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "eslint",
    "typecheck": "tsc --noEmit"
  },
  "dependencies": {
    "@auth/prisma-adapter": "^2.11.1",
    "@hookform/resolvers": "^5.2.2",
    "@prisma/adapter-pg": "^7.2.0",
    "@prisma/client": "^7.2.0",
    "@radix-ui/react-accordion": "^1.2.12",
    "@radix-ui/react-alert-dialog": "^1.1.15",
    "@radix-ui/react-avatar": "^1.1.11",
    "@radix-ui/react-checkbox": "^1.3.3",
    "@radix-ui/react-dialog": "^1.1.15",
    "@radix-ui/react-dropdown-menu": "^2.1.16",
    "@radix-ui/react-label": "^2.1.8",
    "@radix-ui/react-popover": "^1.1.15",
    "@radix-ui/react-progress": "^1.1.8",
    "@radix-ui/react-scroll-area": "^1.2.10",
    "@radix-ui/react-select": "^2.2.6",
    "@radix-ui/react-separator": "^1.1.8",
    "@radix-ui/react-slot": "^1.2.4",
    "@radix-ui/react-switch": "^1.2.6",
    "@radix-ui/react-tabs": "^1.1.13",
    "@radix-ui/react-toast": "^1.2.15",
    "@radix-ui/react-tooltip": "^1.2.8",
    "@tanstack/react-query": "^5.90.16",
    "@trpc/client": "^11.8.1",
    "@trpc/next": "^11.8.1",
    "@trpc/react-query": "^11.8.1",
    "@trpc/server": "^11.8.1",
    "bcryptjs": "^3.0.3",
    "class-variance-authority": "^0.7.1",
    "clsx": "^2.1.1",
    "date-fns": "^4.1.0",
    "lucide-react": "^0.562.0",
    "nanoid": "^5.1.6",
    "next": "16.1.1",
    "next-auth": "^5.0.0-beta.30",
    "next-intl": "^4.7.0",
    "next-themes": "^0.4.6",
    "pg": "^8.16.3",
    "prisma": "^7.2.0",
    "react": "19.2.3",
    "react-dom": "19.2.3",
    "react-hook-form": "^7.71.1",
    "recharts": "^3.6.0",
    "sonner": "^2.0.7",
    "superjson": "^2.2.6",
    "tailwind-merge": "^3.4.0",
    "zod": "^4.3.5",
    "zustand": "^5.0.10"
  },
  "devDependencies": {
    "@tailwindcss/postcss": "^4",
    "@types/bcryptjs": "^2.4.6",
    "@types/node": "^20",
    "@types/pg": "^8.16.0",
    "@types/react": "^19",
    "@types/react-dom": "^19",
    "dotenv": "^17.2.3",
    "eslint": "^9",
    "eslint-config-next": "16.1.1",
    "tailwindcss": "^4",
    "tailwindcss-animate": "^1.0.7",
    "tw-animate-css": "^1.4.0",
    "typescript": "^5"
  }
}

\`\`\`

# postcss.config.mjs

\`\`\`mjs
const config = {
  plugins: {
    "@tailwindcss/postcss": {},
  },
};

export default config;

\`\`\`

# prisma.config.ts

\`\`\`ts
import "dotenv/config";
import { defineConfig } from "prisma/config";

export default defineConfig({
  schema: "prisma/schema.prisma",
  migrations: {
    path: "prisma/migrations",
  },
  datasource: {
    url: process.env.DATABASE_URL!,
  },
});
\`\`\`

# prisma/schema.prisma

\`\`\`prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model Organization {
  id               String           @id @default(cuid())
  nameEn           String           @map("name_en")
  nameFr           String           @map("name_fr")
  icaoCode         String?          @unique @map("icao_code")
  country          String
  region           AfricanRegion
  city             String?
  membershipStatus MembershipStatus @default(PENDING)
  joinedAt         DateTime?        @map("joined_at")
  createdAt        DateTime         @default(now()) @map("created_at")
  updatedAt        DateTime         @updatedAt @map("updated_at")
  assessments      Assessment[]
  documents        Document[]
  findings         Finding[]
  reviewsAsHost    Review[]         @relation("HostANSP")
  users            User[]

  @@map("organizations")
}

model User {
  id                  String                 @id @default(cuid())
  email               String                 @unique
  passwordHash        String?                @map("password_hash")
  emailVerified       DateTime?              @map("email_verified")
  firstName           String                 @map("first_name")
  lastName            String                 @map("last_name")
  title               String?
  phone               String?
  locale              Locale                 @default(EN)
  timezone            String                 @default("UTC")
  theme               Theme                  @default(SYSTEM)
  role                UserRole               @default(STAFF)
  organizationId      String?                @map("organization_id")
  lastLoginAt         DateTime?              @map("last_login_at")
  isActive            Boolean                @default(true) @map("is_active")
  createdAt           DateTime               @default(now()) @map("created_at")
  updatedAt           DateTime               @updatedAt @map("updated_at")
  assessmentResponses AssessmentResponse[]
  auditLogs           AuditLog[]
  assignedCAPs        CorrectiveActionPlan[] @relation("AssignedTo")
  assignedFindings    Finding[]              @relation("AssignedTo")
  notifications       Notification[]
  reviewTeamMembers   ReviewTeamMember[]
  reviewerProfile     ReviewerProfile?
  organization        Organization?          @relation(fields: [organizationId], references: [id])

  @@map("users")
}

model Questionnaire {
  id            String                  @id @default(cuid())
  code          String                  @unique
  type          QuestionnaireType
  version       String
  titleEn       String                  @map("title_en")
  titleFr       String                  @map("title_fr")
  descriptionEn String?                 @map("description_en")
  descriptionFr String?                 @map("description_fr")
  effectiveDate DateTime                @map("effective_date")
  expiryDate    DateTime?               @map("expiry_date")
  isActive      Boolean                 @default(true) @map("is_active")
  createdAt     DateTime                @default(now()) @map("created_at")
  updatedAt     DateTime                @updatedAt @map("updated_at")
  assessments   Assessment[]
  categories    QuestionnaireCategory[]
  questions     Question[]

  @@map("questionnaires")
}

model QuestionnaireCategory {
  id              String           @id @default(cuid())
  questionnaireId String           @map("questionnaire_id")
  code            String
  sortOrder       Int              @map("sort_order")
  nameEn          String           @map("name_en")
  nameFr          String           @map("name_fr")
  descriptionEn   String?          @map("description_en")
  descriptionFr   String?          @map("description_fr")
  auditArea       USOAPAuditArea?  @map("audit_area")
  criticalElement CriticalElement? @map("critical_element")
  smsComponent    SMSComponent?    @map("sms_component")
  studyArea       CANSOStudyArea?  @map("study_area")
  transversalArea TransversalArea? @map("transversal_area")
  createdAt       DateTime         @default(now()) @map("created_at")
  updatedAt       DateTime         @updatedAt @map("updated_at")
  questionnaire   Questionnaire    @relation(fields: [questionnaireId], references: [id])
  questions       Question[]

  @@unique([questionnaireId, code])
  @@map("questionnaire_categories")
}

model Question {
  id               String                @id @default(cuid())
  questionnaireId  String                @map("questionnaire_id")
  categoryId       String                @map("category_id")
  pqNumber         String?               @map("pq_number")
  auditArea        USOAPAuditArea?       @map("audit_area")
  criticalElement  CriticalElement?      @map("critical_element")
  isPriorityPQ     Boolean               @default(false) @map("is_priority_pq")
  requiresOnSite   Boolean               @default(false) @map("requires_on_site")
  pqStatus         PQAmendmentStatus     @default(NO_CHANGE) @map("pq_status")
  previousPqNumber String?               @map("previous_pq_number")
  smsComponent     SMSComponent?         @map("sms_component")
  studyArea        CANSOStudyArea?       @map("study_area")
  maturityLevel    MaturityLevel?        @map("maturity_level")
  questionTextEn   String                @map("question_text_en")
  questionTextFr   String                @map("question_text_fr")
  guidanceEn       String?               @map("guidance_en")
  guidanceFr       String?               @map("guidance_fr")
  responseType     ResponseType          @default(SATISFACTORY_NOT)
  requiredEvidence String[]              @default([])
  weight           Float                 @default(1.0)
  maxScore         Float                 @default(1.0) @map("max_score")
  sortOrder        Int                   @map("sort_order")
  isActive         Boolean               @default(true) @map("is_active")
  createdAt        DateTime              @default(now()) @map("created_at")
  updatedAt        DateTime              @updatedAt @map("updated_at")
  responses        AssessmentResponse[]
  findings         Finding[]
  icaoReferences   ICAOReference[]
  category         QuestionnaireCategory @relation(fields: [categoryId], references: [id])
  questionnaire    Questionnaire         @relation(fields: [questionnaireId], references: [id])

  @@unique([questionnaireId, pqNumber])
  @@index([auditArea, criticalElement])
  @@index([smsComponent, studyArea])
  @@map("questions")
}

model ICAOReference {
  id            String            @id @default(cuid())
  questionId    String            @map("question_id")
  referenceType ICAOReferenceType @map("reference_type")
  document      String
  chapter       String?
  description   String?
  question      Question          @relation(fields: [questionId], references: [id])

  @@map("icao_references")
}

model ReviewerProfile {
  id                    String                  @id @default(cuid())
  userId                String                  @unique @map("user_id")
  organizationId        String                  @map("organization_id")
  status                ReviewerStatus          @default(NOMINATED)
  nominatedAt           DateTime?               @map("nominated_at")
  selectedAt            DateTime?               @map("selected_at")
  certifiedAt           DateTime?               @map("certified_at")
  currentPosition       String                  @map("current_position")
  yearsExperience       Int                     @map("years_experience")
  biography             String?
  biographyFr           String?                 @map("biography_fr")
  expertiseAreas        ExpertiseArea[]         @default([])
  specializations       String[]                @default([])
  reviewsCompleted      Int                     @default(0) @map("reviews_completed")
  reviewsAsLead         Int                     @default(0) @map("reviews_as_lead")
  lastReviewDate        DateTime?               @map("last_review_date")
  isAvailable           Boolean                 @default(true) @map("is_available")
  availableFrom         DateTime?               @map("available_from")
  availableTo           DateTime?               @map("available_to")
  conflictOrganizations String[]                @default([]) @map("conflict_organizations")
  averageRating         Float?                  @map("average_rating")
  feedbackCount         Int                     @default(0) @map("feedback_count")
  createdAt             DateTime                @default(now()) @map("created_at")
  updatedAt             DateTime                @updatedAt @map("updated_at")
  teamAssignments       ReviewTeamMember[]
  certifications        ReviewerCertification[]
  languages             ReviewerLanguage[]
  user                  User                    @relation(fields: [userId], references: [id])
  trainingRecords       ReviewerTraining[]

  @@map("reviewer_profiles")
}

model ReviewerLanguage {
  id                String              @id @default(cuid())
  reviewerProfileId String              @map("reviewer_profile_id")
  language          Language
  proficiency       LanguageProficiency
  isNative          Boolean             @default(false) @map("is_native")
  reviewerProfile   ReviewerProfile     @relation(fields: [reviewerProfileId], references: [id])

  @@unique([reviewerProfileId, language])
  @@map("reviewer_languages")
}

model ReviewerCertification {
  id                String            @id @default(cuid())
  reviewerProfileId String            @map("reviewer_profile_id")
  type              CertificationType
  name              String
  issuingBody       String            @map("issuing_body")
  certificateNumber String?           @map("certificate_number")
  issuedDate        DateTime          @map("issued_date")
  expiryDate        DateTime?         @map("expiry_date")
  isValid           Boolean           @default(true) @map("is_valid")
  documentUrl       String?           @map("document_url")
  reviewerProfile   ReviewerProfile   @relation(fields: [reviewerProfileId], references: [id])

  @@map("reviewer_certifications")
}

model ReviewerTraining {
  id                String          @id @default(cuid())
  reviewerProfileId String          @map("reviewer_profile_id")
  trainingType      TrainingType    @map("training_type")
  courseName        String          @map("course_name")
  courseNameFr      String?         @map("course_name_fr")
  provider          String
  startDate         DateTime        @map("start_date")
  completionDate    DateTime?       @map("completion_date")
  status            TrainingStatus  @default(IN_PROGRESS)
  grade             String?
  location          String?
  isOnline          Boolean         @default(false) @map("is_online")
  certificateUrl    String?         @map("certificate_url")
  createdAt         DateTime        @default(now()) @map("created_at")
  reviewerProfile   ReviewerProfile @relation(fields: [reviewerProfileId], references: [id])

  @@map("reviewer_trainings")
}

model Assessment {
  id              String               @id @default(cuid())
  type            AssessmentType       @default(SELF_ASSESSMENT)
  questionnaireId String               @map("questionnaire_id")
  organizationId  String               @map("organization_id")
  status          AssessmentStatus     @default(DRAFT)
  progress        Float                @default(0)
  startedAt       DateTime?            @map("started_at")
  submittedAt     DateTime?            @map("submitted_at")
  completedAt     DateTime?            @map("completed_at")
  overallScore    Float?               @map("overall_score")
  maturityLevel   MaturityLevel?       @map("maturity_level")
  eiScore         Float?               @map("ei_score")
  categoryScores  Json?                @map("category_scores")
  reviewId        String?              @map("review_id")
  createdAt       DateTime             @default(now()) @map("created_at")
  updatedAt       DateTime             @updatedAt @map("updated_at")
  responses       AssessmentResponse[]
  organization    Organization         @relation(fields: [organizationId], references: [id])
  questionnaire   Questionnaire        @relation(fields: [questionnaireId], references: [id])
  review          Review?              @relation(fields: [reviewId], references: [id])
  documents       Document[]

  @@index([organizationId, questionnaireId])
  @@map("assessments")
}

model AssessmentResponse {
  id            String         @id @default(cuid())
  assessmentId  String         @map("assessment_id")
  questionId    String         @map("question_id")
  responseValue String?        @map("response_value")
  maturityLevel MaturityLevel? @map("maturity_level")
  score         Float?
  notes         String?
  evidenceUrls  String[]       @default([]) @map("evidence_urls")
  respondedById String?        @map("responded_by_id")
  respondedAt   DateTime?      @map("responded_at")
  createdAt     DateTime       @default(now()) @map("created_at")
  updatedAt     DateTime       @updatedAt @map("updated_at")
  assessment    Assessment     @relation(fields: [assessmentId], references: [id])
  question      Question       @relation(fields: [questionId], references: [id])
  respondedBy   User?          @relation(fields: [respondedById], references: [id])

  @@unique([assessmentId, questionId])
  @@map("assessment_responses")
}

model Review {
  id                    String             @id @default(cuid())
  referenceNumber       String             @unique @map("reference_number")
  reviewType            ReviewType         @default(FULL)
  hostOrganizationId    String             @map("host_organization_id")
  status                ReviewStatus       @default(REQUESTED)
  phase                 ReviewPhase        @default(PLANNING)
  requestedDate         DateTime           @map("requested_date")
  plannedStartDate      DateTime?          @map("planned_start_date")
  plannedEndDate        DateTime?          @map("planned_end_date")
  actualStartDate       DateTime?          @map("actual_start_date")
  actualEndDate         DateTime?          @map("actual_end_date")
  questionnairesInScope String[]           @default([]) @map("questionnaires_in_scope")
  areasInScope          String[]           @default([]) @map("areas_in_scope")
  createdAt             DateTime           @default(now()) @map("created_at")
  updatedAt             DateTime           @updatedAt @map("updated_at")
  assessments           Assessment[]
  documents             Document[]
  findings              Finding[]
  report                ReviewReport?
  teamMembers           ReviewTeamMember[]
  hostOrganization      Organization       @relation("HostANSP", fields: [hostOrganizationId], references: [id])

  @@map("reviews")
}

model ReviewTeamMember {
  id                String           @id @default(cuid())
  reviewId          String           @map("review_id")
  userId            String           @map("user_id")
  reviewerProfileId String?          @map("reviewer_profile_id")
  role              TeamRole         @default(REVIEWER)
  assignedAreas     String[]         @default([]) @map("assigned_areas")
  confirmedAt       DateTime?        @map("confirmed_at")
  declinedAt        DateTime?        @map("declined_at")
  declineReason     String?          @map("decline_reason")
  createdAt         DateTime         @default(now()) @map("created_at")
  review            Review           @relation(fields: [reviewId], references: [id])
  reviewerProfile   ReviewerProfile? @relation(fields: [reviewerProfileId], references: [id])
  user              User             @relation(fields: [userId], references: [id])

  @@unique([reviewId, userId])
  @@map("review_team_members")
}

model ReviewReport {
  id                 String         @id @default(cuid())
  reviewId           String         @unique @map("review_id")
  titleEn            String         @map("title_en")
  titleFr            String         @map("title_fr")
  executiveSummaryEn String?        @map("executive_summary_en")
  executiveSummaryFr String?        @map("executive_summary_fr")
  overallMaturity    MaturityLevel? @map("overall_maturity")
  overallEI          Float?         @map("overall_ei")
  status             String         @default("DRAFT")
  draftedAt          DateTime?      @map("drafted_at")
  reviewedAt         DateTime?      @map("reviewed_at")
  finalizedAt        DateTime?      @map("finalized_at")
  pdfUrl             String?        @map("pdf_url")
  createdAt          DateTime       @default(now()) @map("created_at")
  updatedAt          DateTime       @updatedAt @map("updated_at")
  review             Review         @relation(fields: [reviewId], references: [id])

  @@map("review_reports")
}

model Finding {
  id                   String                @id @default(cuid())
  reviewId             String                @map("review_id")
  organizationId       String                @map("organization_id")
  questionId           String?               @map("question_id")
  referenceNumber      String                @unique @map("reference_number")
  findingType          FindingType           @default(OBSERVATION)
  severity             FindingSeverity       @default(MINOR)
  titleEn              String                @map("title_en")
  titleFr              String                @map("title_fr")
  descriptionEn        String                @map("description_en")
  descriptionFr        String                @map("description_fr")
  evidenceEn           String?               @map("evidence_en")
  evidenceFr           String?               @map("evidence_fr")
  icaoReference        String?               @map("icao_reference")
  criticalElement      CriticalElement?      @map("critical_element")
  status               FindingStatus         @default(OPEN)
  assignedToId         String?               @map("assigned_to_id")
  capRequired          Boolean               @default(true) @map("cap_required")
  identifiedAt         DateTime              @default(now()) @map("identified_at")
  targetCloseDate      DateTime?             @map("target_close_date")
  closedAt             DateTime?             @map("closed_at")
  createdAt            DateTime              @default(now()) @map("created_at")
  updatedAt            DateTime              @updatedAt @map("updated_at")
  correctiveActionPlan CorrectiveActionPlan?
  documents            Document[]
  assignedTo           User?                 @relation("AssignedTo", fields: [assignedToId], references: [id])
  organization         Organization          @relation(fields: [organizationId], references: [id])
  question             Question?             @relation(fields: [questionId], references: [id])
  review               Review                @relation(fields: [reviewId], references: [id])

  @@index([reviewId, status])
  @@index([organizationId, status])
  @@map("findings")
}

model CorrectiveActionPlan {
  id                 String     @id @default(cuid())
  findingId          String     @unique @map("finding_id")
  rootCauseEn        String     @map("root_cause_en")
  rootCauseFr        String     @map("root_cause_fr")
  correctiveActionEn String     @map("corrective_action_en")
  correctiveActionFr String     @map("corrective_action_fr")
  preventiveActionEn String?    @map("preventive_action_en")
  preventiveActionFr String?    @map("preventive_action_fr")
  status             CAPStatus  @default(DRAFT)
  assignedToId       String?    @map("assigned_to_id")
  submittedAt        DateTime?  @map("submitted_at")
  acceptedAt         DateTime?  @map("accepted_at")
  dueDate            DateTime   @map("due_date")
  completedAt        DateTime?  @map("completed_at")
  verifiedAt         DateTime?  @map("verified_at")
  verificationMethod String?    @map("verification_method")
  verificationNotes  String?    @map("verification_notes")
  verifiedById       String?    @map("verified_by_id")
  createdAt          DateTime   @default(now()) @map("created_at")
  updatedAt          DateTime   @updatedAt @map("updated_at")
  assignedTo         User?      @relation("AssignedTo", fields: [assignedToId], references: [id])
  finding            Finding    @relation(fields: [findingId], references: [id])
  documents          Document[]

  @@map("corrective_action_plans")
}

model TrainingModule {
  id            String             @id @default(cuid())
  moduleNumber  Int                @map("module_number")
  code          String             @unique
  titleEn       String             @map("title_en")
  titleFr       String             @map("title_fr")
  descriptionEn String             @map("description_en")
  descriptionFr String             @map("description_fr")
  objectivesEn  String[]           @default([]) @map("objectives_en")
  objectivesFr  String[]           @default([]) @map("objectives_fr")
  iconName      String?            @map("icon_name")
  sortOrder     Int                @map("sort_order")
  isActive      Boolean            @default(true) @map("is_active")
  isEnabled     Boolean            @default(true) @map("is_enabled")
  enabledUntil  DateTime?          @map("enabled_until")
  createdAt     DateTime           @default(now()) @map("created_at")
  updatedAt     DateTime           @updatedAt @map("updated_at")
  resources     TrainingResource[]
  topics        TrainingTopic[]

  @@map("training_modules")
}

model TrainingTopic {
  id                String           @id @default(cuid())
  moduleId          String           @map("module_id")
  titleEn           String           @map("title_en")
  titleFr           String           @map("title_fr")
  contentEn         String           @map("content_en")
  contentFr         String           @map("content_fr")
  relatedPQs        String[]         @default([]) @map("related_pqs")
  relatedStudyAreas CANSOStudyArea[] @default([]) @map("related_study_areas")
  sortOrder         Int              @map("sort_order")
  module            TrainingModule   @relation(fields: [moduleId], references: [id])

  @@map("training_topics")
}

model TrainingResource {
  id           String         @id @default(cuid())
  moduleId     String         @map("module_id")
  titleEn      String         @map("title_en")
  titleFr      String         @map("title_fr")
  resourceType ResourceType   @map("resource_type")
  url          String?
  fileUrl      String?        @map("file_url")
  sortOrder    Int            @map("sort_order")
  module       TrainingModule @relation(fields: [moduleId], references: [id])

  @@map("training_resources")
}

model Document {
  id             String                @id @default(cuid())
  name           String
  description    String?
  fileUrl        String                @map("file_url")
  fileType       String                @map("file_type")
  fileSize       Int                   @map("file_size")
  category       String?
  tags           String[]              @default([])
  organizationId String?               @map("organization_id")
  assessmentId   String?               @map("assessment_id")
  reviewId       String?               @map("review_id")
  findingId      String?               @map("finding_id")
  capId          String?               @map("cap_id")
  uploadedById   String                @map("uploaded_by_id")
  uploadedAt     DateTime              @default(now()) @map("uploaded_at")
  createdAt      DateTime              @default(now()) @map("created_at")
  updatedAt      DateTime              @updatedAt @map("updated_at")
  assessment     Assessment?           @relation(fields: [assessmentId], references: [id])
  cap            CorrectiveActionPlan? @relation(fields: [capId], references: [id])
  finding        Finding?              @relation(fields: [findingId], references: [id])
  organization   Organization?         @relation(fields: [organizationId], references: [id])
  review         Review?               @relation(fields: [reviewId], references: [id])

  @@map("documents")
}

model Notification {
  id          String    @id @default(cuid())
  userId      String    @map("user_id")
  type        String
  titleEn     String    @map("title_en")
  titleFr     String    @map("title_fr")
  messageEn   String    @map("message_en")
  messageFr   String    @map("message_fr")
  link        String?
  data        Json?
  readAt      DateTime? @map("read_at")
  emailSentAt DateTime? @map("email_sent_at")
  createdAt   DateTime  @default(now()) @map("created_at")
  user        User      @relation(fields: [userId], references: [id])

  @@index([userId, readAt])
  @@map("notifications")
}

model AuditLog {
  id           String   @id @default(cuid())
  userId       String?  @map("user_id")
  action       String
  entityType   String   @map("entity_type")
  entityId     String   @map("entity_id")
  previousData Json?    @map("previous_data")
  newData      Json?    @map("new_data")
  ipAddress    String?  @map("ip_address")
  userAgent    String?  @map("user_agent")
  createdAt    DateTime @default(now()) @map("created_at")
  user         User?    @relation(fields: [userId], references: [id])

  @@index([entityType, entityId])
  @@index([userId, createdAt])
  @@map("audit_logs")
}

enum Locale {
  EN
  FR
}

enum Theme {
  LIGHT
  DARK
  SYSTEM
}

enum UserRole {
  SUPER_ADMIN
  SYSTEM_ADMIN
  STEERING_COMMITTEE
  PROGRAMME_COORDINATOR
  LEAD_REVIEWER
  PEER_REVIEWER
  OBSERVER
  ANSP_ADMIN
  SAFETY_MANAGER
  QUALITY_MANAGER
  STAFF
}

enum AfricanRegion {
  WACAF
  ESAF
  NORTHERN
}

enum MembershipStatus {
  PENDING
  ACTIVE
  SUSPENDED
  INACTIVE
}

enum QuestionnaireType {
  ANS_USOAP_CMA
  SMS_CANSO_SOE
}

enum USOAPAuditArea {
  LEG
  ORG
  PEL
  OPS
  AIR
  AIG
  ANS
  AGA
  SSP
}

enum CriticalElement {
  CE_1
  CE_2
  CE_3
  CE_4
  CE_5
  CE_6
  CE_7
  CE_8
}

enum SMSComponent {
  SAFETY_POLICY_OBJECTIVES
  SAFETY_RISK_MANAGEMENT
  SAFETY_ASSURANCE
  SAFETY_PROMOTION
}

enum CANSOStudyArea {
  SA_1_1
  SA_1_2
  SA_1_3
  SA_1_4
  SA_1_5
  SA_2_1
  SA_2_2
  SA_3_1
  SA_3_2
  SA_3_3
  SA_4_1
  SA_4_2
}

enum TransversalArea {
  SPM
  HP
  CI
}

enum MaturityLevel {
  LEVEL_A
  LEVEL_B
  LEVEL_C
  LEVEL_D
  LEVEL_E
}

enum PQAmendmentStatus {
  NO_CHANGE
  REVISED
  NEW
  MERGED
  DELETED
  REFERENCE_REVISED
}

enum ResponseType {
  SATISFACTORY_NOT
  MATURITY_LEVEL
  YES_NO
  SCALE_1_5
  TEXT
  MULTI_SELECT
}

enum ICAOReferenceType {
  CC
  STD
  RP
  PANS
  GM
  Cir
  SUPPS
}

enum ReviewerStatus {
  NOMINATED
  SELECTED
  IN_TRAINING
  CERTIFIED
  LEAD_QUALIFIED
  INACTIVE
  RETIRED
}

enum ExpertiseArea {
  ATS
  AIM_AIS
  MET
  CNS
  PANS_OPS
  SAR
  SMS_POLICY
  SMS_RISK
  SMS_ASSURANCE
  SMS_PROMOTION
  AERODROME
  RFF
  ENGINEERING
  QMS
  TRAINING
  HUMAN_FACTORS
}

enum Language {
  EN
  FR
  AR
  PT
  ES
}

enum LanguageProficiency {
  BASIC
  INTERMEDIATE
  ADVANCED
  NATIVE
}

enum CertificationType {
  PEER_REVIEWER
  LEAD_REVIEWER
  SMS_ASSESSOR
  ICAO_AUDITOR
  CANSO_TRAINER
  ATC_LICENSE
  OTHER
}

enum TrainingType {
  INITIAL_REVIEWER
  REFRESHER
  LEAD_REVIEWER
  SMS_ASSESSMENT
  USOAP_CMA
  CANSO_SOE
  SPECIALIZED
}

enum TrainingStatus {
  SCHEDULED
  IN_PROGRESS
  COMPLETED
  INCOMPLETE
  CANCELLED
}

enum AssessmentType {
  SELF_ASSESSMENT
  PEER_REVIEW
  GAP_ANALYSIS
  FOLLOW_UP
}

enum AssessmentStatus {
  DRAFT
  SUBMITTED
  UNDER_REVIEW
  COMPLETED
  ARCHIVED
}

enum ReviewType {
  FULL
  FOCUSED
  FOLLOW_UP
  SURVEILLANCE
}

enum ReviewStatus {
  REQUESTED
  APPROVED
  PLANNING
  SCHEDULED
  IN_PROGRESS
  REPORT_DRAFTING
  REPORT_REVIEW
  COMPLETED
  CANCELLED
}

enum ReviewPhase {
  PLANNING
  PREPARATION
  ON_SITE
  REPORTING
  FOLLOW_UP
  CLOSED
}

enum TeamRole {
  LEAD_REVIEWER
  REVIEWER
  TECHNICAL_EXPERT
  OBSERVER
  TRAINEE
}

enum FindingType {
  NON_CONFORMITY
  OBSERVATION
  RECOMMENDATION
  GOOD_PRACTICE
  CONCERN
}

enum FindingSeverity {
  CRITICAL
  MAJOR
  MINOR
  OBSERVATION
}

enum FindingStatus {
  OPEN
  CAP_REQUIRED
  CAP_SUBMITTED
  CAP_ACCEPTED
  IN_PROGRESS
  VERIFICATION
  CLOSED
  DEFERRED
}

enum CAPStatus {
  DRAFT
  SUBMITTED
  UNDER_REVIEW
  ACCEPTED
  REJECTED
  IN_PROGRESS
  COMPLETED
  VERIFIED
  CLOSED
}

enum ResourceType {
  DOCUMENT
  VIDEO
  PRESENTATION
  CHECKLIST
  TEMPLATE
  EXTERNAL_LINK
}

\`\`\`

# prisma/schema.prisma.backup

\`\`\`backup
// African ANSP Peer Review Program - Database Schema
// Aligned with 2024 USOAP CMA Protocol Questions & CANSO SoE 2024
// Last Updated: January 2026

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

// =============================================================================
// ENUMS
// =============================================================================

enum Locale {
  EN
  FR
}

enum Theme {
  LIGHT
  DARK
  SYSTEM
}

enum UserRole {
  SUPER_ADMIN
  SYSTEM_ADMIN
  STEERING_COMMITTEE
  PROGRAMME_COORDINATOR
  LEAD_REVIEWER
  PEER_REVIEWER
  OBSERVER
  ANSP_ADMIN
  SAFETY_MANAGER
  QUALITY_MANAGER
  STAFF
}

enum AfricanRegion {
  WACAF
  ESAF
  NORTHERN
}

enum MembershipStatus {
  PENDING
  ACTIVE
  SUSPENDED
  INACTIVE
}

enum QuestionnaireType {
  ANS_USOAP_CMA
  SMS_CANSO_SOE
}

enum USOAPAuditArea {
  LEG
  ORG
  PEL
  OPS
  AIR
  AIG
  ANS
  AGA
  SSP
}

enum CriticalElement {
  CE_1
  CE_2
  CE_3
  CE_4
  CE_5
  CE_6
  CE_7
  CE_8
}

enum SMSComponent {
  SAFETY_POLICY_OBJECTIVES
  SAFETY_RISK_MANAGEMENT
  SAFETY_ASSURANCE
  SAFETY_PROMOTION
}

enum CANSOStudyArea {
  SA_1_1
  SA_1_2
  SA_1_3
  SA_1_4
  SA_1_5
  SA_2_1
  SA_2_2
  SA_3_1
  SA_3_2
  SA_3_3
  SA_4_1
  SA_4_2
}

enum TransversalArea {
  SPM
  HP
  CI
}

enum MaturityLevel {
  LEVEL_A
  LEVEL_B
  LEVEL_C
  LEVEL_D
  LEVEL_E
}

enum PQAmendmentStatus {
  NO_CHANGE
  REVISED
  NEW
  MERGED
  DELETED
  REFERENCE_REVISED
}

enum ResponseType {
  SATISFACTORY_NOT
  MATURITY_LEVEL
  YES_NO
  SCALE_1_5
  TEXT
  MULTI_SELECT
}

enum ICAOReferenceType {
  CC
  STD
  RP
  PANS
  GM
  Cir
  SUPPS
}

enum ReviewerStatus {
  NOMINATED
  SELECTED
  IN_TRAINING
  CERTIFIED
  LEAD_QUALIFIED
  INACTIVE
  RETIRED
}

enum ExpertiseArea {
  ATS
  AIM_AIS
  MET
  CNS
  PANS_OPS
  SAR
  SMS_POLICY
  SMS_RISK
  SMS_ASSURANCE
  SMS_PROMOTION
  AERODROME
  RFF
  ENGINEERING
  QMS
  TRAINING
  HUMAN_FACTORS
}

enum Language {
  EN
  FR
  AR
  PT
  ES
}

enum LanguageProficiency {
  BASIC
  INTERMEDIATE
  ADVANCED
  NATIVE
}

enum CertificationType {
  PEER_REVIEWER
  LEAD_REVIEWER
  SMS_ASSESSOR
  ICAO_AUDITOR
  CANSO_TRAINER
  ATC_LICENSE
  OTHER
}

enum TrainingType {
  INITIAL_REVIEWER
  REFRESHER
  LEAD_REVIEWER
  SMS_ASSESSMENT
  USOAP_CMA
  CANSO_SOE
  SPECIALIZED
}

enum TrainingStatus {
  SCHEDULED
  IN_PROGRESS
  COMPLETED
  INCOMPLETE
  CANCELLED
}

enum AssessmentType {
  SELF_ASSESSMENT
  PEER_REVIEW
  GAP_ANALYSIS
  FOLLOW_UP
}

enum AssessmentStatus {
  DRAFT
  SUBMITTED
  UNDER_REVIEW
  COMPLETED
  ARCHIVED
}

enum ReviewType {
  FULL
  FOCUSED
  FOLLOW_UP
  SURVEILLANCE
}

enum ReviewStatus {
  REQUESTED
  APPROVED
  PLANNING
  SCHEDULED
  IN_PROGRESS
  REPORT_DRAFTING
  REPORT_REVIEW
  COMPLETED
  CANCELLED
}

enum ReviewPhase {
  PLANNING
  PREPARATION
  ON_SITE
  REPORTING
  FOLLOW_UP
  CLOSED
}

enum TeamRole {
  LEAD_REVIEWER
  REVIEWER
  TECHNICAL_EXPERT
  OBSERVER
  TRAINEE
}

enum FindingType {
  NON_CONFORMITY
  OBSERVATION
  RECOMMENDATION
  GOOD_PRACTICE
  CONCERN
}

enum FindingSeverity {
  CRITICAL
  MAJOR
  MINOR
  OBSERVATION
}

enum FindingStatus {
  OPEN
  CAP_REQUIRED
  CAP_SUBMITTED
  CAP_ACCEPTED
  IN_PROGRESS
  VERIFICATION
  CLOSED
  DEFERRED
}

enum CAPStatus {
  DRAFT
  SUBMITTED
  UNDER_REVIEW
  ACCEPTED
  REJECTED
  IN_PROGRESS
  COMPLETED
  VERIFIED
  CLOSED
}

enum ResourceType {
  DOCUMENT
  VIDEO
  PRESENTATION
  CHECKLIST
  TEMPLATE
  EXTERNAL_LINK
}

// =============================================================================
// CORE MODELS
// =============================================================================

model Organization {
  id                String              @id @default(cuid())
  nameEn            String              @map("name_en")
  nameFr            String              @map("name_fr")
  icaoCode          String?             @unique @map("icao_code")
  country           String
  region            AfricanRegion
  city              String?
  membershipStatus  MembershipStatus    @default(PENDING)
  joinedAt          DateTime?           @map("joined_at")
  users             User[]
  assessments       Assessment[]
  reviewsAsHost     Review[]            @relation("HostANSP")
  findings          Finding[]
  documents         Document[]
  createdAt         DateTime            @default(now()) @map("created_at")
  updatedAt         DateTime            @updatedAt @map("updated_at")
  @@map("organizations")
}

model User {
  id                  String              @id @default(cuid())
  email               String              @unique
  passwordHash        String?             @map("password_hash")
  emailVerified       DateTime?           @map("email_verified")
  firstName           String              @map("first_name")
  lastName            String              @map("last_name")
  title               String?
  phone               String?
  locale              Locale              @default(EN)
  timezone            String              @default("UTC")
  theme               Theme               @default(SYSTEM)
  role                UserRole            @default(STAFF)
  organizationId      String?             @map("organization_id")
  organization        Organization?       @relation(fields: [organizationId], references: [id])
  reviewerProfile     ReviewerProfile?
  lastLoginAt         DateTime?           @map("last_login_at")
  isActive            Boolean             @default(true) @map("is_active")
  assessmentResponses AssessmentResponse[]
  reviewTeamMembers   ReviewTeamMember[]
  assignedFindings    Finding[]           @relation("AssignedTo")
  assignedCAPs        CorrectiveActionPlan[] @relation("AssignedTo")
  notifications       Notification[]
  auditLogs           AuditLog[]
  createdAt           DateTime            @default(now()) @map("created_at")
  updatedAt           DateTime            @updatedAt @map("updated_at")
  @@map("users")
}

// =============================================================================
// QUESTIONNAIRE SYSTEM
// =============================================================================

model Questionnaire {
  id                String              @id @default(cuid())
  code              String              @unique
  type              QuestionnaireType
  version           String
  titleEn           String              @map("title_en")
  titleFr           String              @map("title_fr")
  descriptionEn     String?             @map("description_en")
  descriptionFr     String?             @map("description_fr")
  categories        QuestionnaireCategory[]
  questions         Question[]
  effectiveDate     DateTime            @map("effective_date")
  expiryDate        DateTime?           @map("expiry_date")
  isActive          Boolean             @default(true) @map("is_active")
  assessments       Assessment[]
  createdAt         DateTime            @default(now()) @map("created_at")
  updatedAt         DateTime            @updatedAt @map("updated_at")
  @@map("questionnaires")
}

model QuestionnaireCategory {
  id                String              @id @default(cuid())
  questionnaireId   String              @map("questionnaire_id")
  questionnaire     Questionnaire       @relation(fields: [questionnaireId], references: [id])
  code              String
  sortOrder         Int                 @map("sort_order")
  nameEn            String              @map("name_en")
  nameFr            String              @map("name_fr")
  descriptionEn     String?             @map("description_en")
  descriptionFr     String?             @map("description_fr")
  auditArea         USOAPAuditArea?     @map("audit_area")
  criticalElement   CriticalElement?    @map("critical_element")
  smsComponent      SMSComponent?       @map("sms_component")
  studyArea         CANSOStudyArea?     @map("study_area")
  transversalArea   TransversalArea?    @map("transversal_area")
  questions         Question[]
  createdAt         DateTime            @default(now()) @map("created_at")
  updatedAt         DateTime            @updatedAt @map("updated_at")
  @@unique([questionnaireId, code])
  @@map("questionnaire_categories")
}

model Question {
  id                  String              @id @default(cuid())
  questionnaireId     String              @map("questionnaire_id")
  questionnaire       Questionnaire       @relation(fields: [questionnaireId], references: [id])
  categoryId          String              @map("category_id")
  category            QuestionnaireCategory @relation(fields: [categoryId], references: [id])
  pqNumber            String?             @map("pq_number")
  auditArea           USOAPAuditArea?     @map("audit_area")
  criticalElement     CriticalElement?    @map("critical_element")
  isPriorityPQ        Boolean             @default(false) @map("is_priority_pq")
  requiresOnSite      Boolean             @default(false) @map("requires_on_site")
  pqStatus            PQAmendmentStatus   @default(NO_CHANGE) @map("pq_status")
  previousPqNumber    String?             @map("previous_pq_number")
  smsComponent        SMSComponent?       @map("sms_component")
  studyArea           CANSOStudyArea?     @map("study_area")
  maturityLevel       MaturityLevel?      @map("maturity_level")
  questionTextEn      String              @map("question_text_en")
  questionTextFr      String              @map("question_text_fr")
  guidanceEn          String?             @map("guidance_en") @db.Text
  guidanceFr          String?             @map("guidance_fr") @db.Text
  icaoReferences      ICAOReference[]
  responseType        ResponseType        @default(SATISFACTORY_NOT)
  requiredEvidence    String[]            @default([])
  weight              Float               @default(1.0)
  maxScore            Float               @default(1.0) @map("max_score")
  sortOrder           Int                 @map("sort_order")
  isActive            Boolean             @default(true) @map("is_active")
  responses           AssessmentResponse[]
  findings            Finding[]
  createdAt           DateTime            @default(now()) @map("created_at")
  updatedAt           DateTime            @updatedAt @map("updated_at")
  @@unique([questionnaireId, pqNumber])
  @@index([auditArea, criticalElement])
  @@index([smsComponent, studyArea])
  @@map("questions")
}

model ICAOReference {
  id                String              @id @default(cuid())
  questionId        String              @map("question_id")
  question          Question            @relation(fields: [questionId], references: [id])
  referenceType     ICAOReferenceType   @map("reference_type")
  document          String
  chapter           String?
  description       String?
  @@map("icao_references")
}

// =============================================================================
// REVIEWER PROFILES
// =============================================================================

model ReviewerProfile {
  id                    String              @id @default(cuid())
  userId                String              @unique @map("user_id")
  user                  User                @relation(fields: [userId], references: [id])
  organizationId        String              @map("organization_id")
  status                ReviewerStatus      @default(NOMINATED)
  nominatedAt           DateTime?           @map("nominated_at")
  selectedAt            DateTime?           @map("selected_at")
  certifiedAt           DateTime?           @map("certified_at")
  currentPosition       String              @map("current_position")
  yearsExperience       Int                 @map("years_experience")
  biography             String?             @db.Text
  biographyFr           String?             @map("biography_fr") @db.Text
  expertiseAreas        ExpertiseArea[]     @default([])
  specializations       String[]            @default([])
  languages             ReviewerLanguage[]
  certifications        ReviewerCertification[]
  trainingRecords       ReviewerTraining[]
  reviewsCompleted      Int                 @default(0) @map("reviews_completed")
  reviewsAsLead         Int                 @default(0) @map("reviews_as_lead")
  lastReviewDate        DateTime?           @map("last_review_date")
  isAvailable           Boolean             @default(true) @map("is_available")
  availableFrom         DateTime?           @map("available_from")
  availableTo           DateTime?           @map("available_to")
  conflictOrganizations String[]            @default([]) @map("conflict_organizations")
  averageRating         Float?              @map("average_rating")
  feedbackCount         Int                 @default(0) @map("feedback_count")
  teamAssignments       ReviewTeamMember[]
  createdAt             DateTime            @default(now()) @map("created_at")
  updatedAt             DateTime            @updatedAt @map("updated_at")
  @@map("reviewer_profiles")
}

model ReviewerLanguage {
  id                  String              @id @default(cuid())
  reviewerProfileId   String              @map("reviewer_profile_id")
  reviewerProfile     ReviewerProfile     @relation(fields: [reviewerProfileId], references: [id])
  language            Language
  proficiency         LanguageProficiency
  isNative            Boolean             @default(false) @map("is_native")
  @@unique([reviewerProfileId, language])
  @@map("reviewer_languages")
}

model ReviewerCertification {
  id                  String              @id @default(cuid())
  reviewerProfileId   String              @map("reviewer_profile_id")
  reviewerProfile     ReviewerProfile     @relation(fields: [reviewerProfileId], references: [id])
  type                CertificationType
  name                String
  issuingBody         String              @map("issuing_body")
  certificateNumber   String?             @map("certificate_number")
  issuedDate          DateTime            @map("issued_date")
  expiryDate          DateTime?           @map("expiry_date")
  isValid             Boolean             @default(true) @map("is_valid")
  documentUrl         String?             @map("document_url")
  @@map("reviewer_certifications")
}

model ReviewerTraining {
  id                  String              @id @default(cuid())
  reviewerProfileId   String              @map("reviewer_profile_id")
  reviewerProfile     ReviewerProfile     @relation(fields: [reviewerProfileId], references: [id])
  trainingType        TrainingType        @map("training_type")
  courseName          String              @map("course_name")
  courseNameFr        String?             @map("course_name_fr")
  provider            String
  startDate           DateTime            @map("start_date")
  completionDate      DateTime?           @map("completion_date")
  status              TrainingStatus      @default(IN_PROGRESS)
  grade               String?
  location            String?
  isOnline            Boolean             @default(false) @map("is_online")
  certificateUrl      String?             @map("certificate_url")
  createdAt           DateTime            @default(now()) @map("created_at")
  @@map("reviewer_trainings")
}

// =============================================================================
// ASSESSMENT & REVIEW
// =============================================================================

model Assessment {
  id                  String              @id @default(cuid())
  type                AssessmentType      @default(SELF_ASSESSMENT)
  questionnaireId     String              @map("questionnaire_id")
  questionnaire       Questionnaire       @relation(fields: [questionnaireId], references: [id])
  organizationId      String              @map("organization_id")
  organization        Organization        @relation(fields: [organizationId], references: [id])
  status              AssessmentStatus    @default(DRAFT)
  progress            Float               @default(0)
  startedAt           DateTime?           @map("started_at")
  submittedAt         DateTime?           @map("submitted_at")
  completedAt         DateTime?           @map("completed_at")
  overallScore        Float?              @map("overall_score")
  maturityLevel       MaturityLevel?      @map("maturity_level")
  eiScore             Float?              @map("ei_score")
  categoryScores      Json?               @map("category_scores")
  reviewId            String?             @map("review_id")
  review              Review?             @relation(fields: [reviewId], references: [id])
  responses           AssessmentResponse[]
  documents           Document[]
  createdAt           DateTime            @default(now()) @map("created_at")
  updatedAt           DateTime            @updatedAt @map("updated_at")
  @@index([organizationId, questionnaireId])
  @@map("assessments")
}

model AssessmentResponse {
  id                  String              @id @default(cuid())
  assessmentId        String              @map("assessment_id")
  assessment          Assessment          @relation(fields: [assessmentId], references: [id])
  questionId          String              @map("question_id")
  question            Question            @relation(fields: [questionId], references: [id])
  responseValue       String?             @map("response_value")
  maturityLevel       MaturityLevel?      @map("maturity_level")
  score               Float?
  notes               String?             @db.Text
  evidenceUrls        String[]            @default([]) @map("evidence_urls")
  respondedById       String?             @map("responded_by_id")
  respondedBy         User?               @relation(fields: [respondedById], references: [id])
  respondedAt         DateTime?           @map("responded_at")
  createdAt           DateTime            @default(now()) @map("created_at")
  updatedAt           DateTime            @updatedAt @map("updated_at")
  @@unique([assessmentId, questionId])
  @@map("assessment_responses")
}

model Review {
  id                  String              @id @default(cuid())
  referenceNumber     String              @unique @map("reference_number")
  reviewType          ReviewType          @default(FULL)
  hostOrganizationId  String              @map("host_organization_id")
  hostOrganization    Organization        @relation("HostANSP", fields: [hostOrganizationId], references: [id])
  status              ReviewStatus        @default(REQUESTED)
  phase               ReviewPhase         @default(PLANNING)
  requestedDate       DateTime            @map("requested_date")
  plannedStartDate    DateTime?           @map("planned_start_date")
  plannedEndDate      DateTime?           @map("planned_end_date")
  actualStartDate     DateTime?           @map("actual_start_date")
  actualEndDate       DateTime?           @map("actual_end_date")
  questionnairesInScope String[]          @default([]) @map("questionnaires_in_scope")
  areasInScope        String[]            @default([]) @map("areas_in_scope")
  teamMembers         ReviewTeamMember[]
  assessments         Assessment[]
  findings            Finding[]
  report              ReviewReport?
  documents           Document[]
  createdAt           DateTime            @default(now()) @map("created_at")
  updatedAt           DateTime            @updatedAt @map("updated_at")
  @@map("reviews")
}

model ReviewTeamMember {
  id                  String              @id @default(cuid())
  reviewId            String              @map("review_id")
  review              Review              @relation(fields: [reviewId], references: [id])
  userId              String              @map("user_id")
  user                User                @relation(fields: [userId], references: [id])
  reviewerProfileId   String?             @map("reviewer_profile_id")
  reviewerProfile     ReviewerProfile?    @relation(fields: [reviewerProfileId], references: [id])
  role                TeamRole            @default(REVIEWER)
  assignedAreas       String[]            @default([]) @map("assigned_areas")
  confirmedAt         DateTime?           @map("confirmed_at")
  declinedAt          DateTime?           @map("declined_at")
  declineReason       String?             @map("decline_reason")
  createdAt           DateTime            @default(now()) @map("created_at")
  @@unique([reviewId, userId])
  @@map("review_team_members")
}

model ReviewReport {
  id                  String              @id @default(cuid())
  reviewId            String              @unique @map("review_id")
  review              Review              @relation(fields: [reviewId], references: [id])
  titleEn             String              @map("title_en")
  titleFr             String              @map("title_fr")
  executiveSummaryEn  String?             @map("executive_summary_en") @db.Text
  executiveSummaryFr  String?             @map("executive_summary_fr") @db.Text
  overallMaturity     MaturityLevel?      @map("overall_maturity")
  overallEI           Float?              @map("overall_ei")
  status              String              @default("DRAFT")
  draftedAt           DateTime?           @map("drafted_at")
  reviewedAt          DateTime?           @map("reviewed_at")
  finalizedAt         DateTime?           @map("finalized_at")
  pdfUrl              String?             @map("pdf_url")
  createdAt           DateTime            @default(now()) @map("created_at")
  updatedAt           DateTime            @updatedAt @map("updated_at")
  @@map("review_reports")
}

// =============================================================================
// FINDINGS & CAP
// =============================================================================

model Finding {
  id                   String              @id @default(cuid())
  reviewId             String              @map("review_id")
  review               Review              @relation(fields: [reviewId], references: [id])
  organizationId       String              @map("organization_id")
  organization         Organization        @relation(fields: [organizationId], references: [id])
  questionId           String?             @map("question_id")
  question             Question?           @relation(fields: [questionId], references: [id])
  referenceNumber      String              @unique @map("reference_number")
  findingType          FindingType         @default(OBSERVATION)
  severity             FindingSeverity     @default(MINOR)
  titleEn              String              @map("title_en")
  titleFr              String              @map("title_fr")
  descriptionEn        String              @map("description_en") @db.Text
  descriptionFr        String              @map("description_fr") @db.Text
  evidenceEn           String?             @map("evidence_en") @db.Text
  evidenceFr           String?             @map("evidence_fr") @db.Text
  icaoReference        String?             @map("icao_reference")
  criticalElement      CriticalElement?    @map("critical_element")
  status               FindingStatus       @default(OPEN)
  assignedToId         String?             @map("assigned_to_id")
  assignedTo           User?               @relation("AssignedTo", fields: [assignedToId], references: [id])
  capRequired          Boolean             @default(true) @map("cap_required")
  correctiveActionPlan CorrectiveActionPlan?
  identifiedAt         DateTime            @default(now()) @map("identified_at")
  targetCloseDate      DateTime?           @map("target_close_date")
  closedAt             DateTime?           @map("closed_at")
  documents            Document[]
  createdAt            DateTime            @default(now()) @map("created_at")
  updatedAt            DateTime            @updatedAt @map("updated_at")
  @@index([reviewId, status])
  @@index([organizationId, status])
  @@map("findings")
}

model CorrectiveActionPlan {
  id                  String              @id @default(cuid())
  findingId           String              @unique @map("finding_id")
  finding             Finding             @relation(fields: [findingId], references: [id])
  rootCauseEn         String              @map("root_cause_en") @db.Text
  rootCauseFr         String              @map("root_cause_fr") @db.Text
  correctiveActionEn  String              @map("corrective_action_en") @db.Text
  correctiveActionFr  String              @map("corrective_action_fr") @db.Text
  preventiveActionEn  String?             @map("preventive_action_en") @db.Text
  preventiveActionFr  String?             @map("preventive_action_fr") @db.Text
  status              CAPStatus           @default(DRAFT)
  assignedToId        String?             @map("assigned_to_id")
  assignedTo          User?               @relation("AssignedTo", fields: [assignedToId], references: [id])
  submittedAt         DateTime?           @map("submitted_at")
  acceptedAt          DateTime?           @map("accepted_at")
  dueDate             DateTime            @map("due_date")
  completedAt         DateTime?           @map("completed_at")
  verifiedAt          DateTime?           @map("verified_at")
  verificationMethod  String?             @map("verification_method")
  verificationNotes   String?             @map("verification_notes") @db.Text
  verifiedById        String?             @map("verified_by_id")
  documents           Document[]
  createdAt           DateTime            @default(now()) @map("created_at")
  updatedAt           DateTime            @updatedAt @map("updated_at")
  @@map("corrective_action_plans")
}

// =============================================================================
// TRAINING MODULE
// =============================================================================

model TrainingModule {
  id                  String              @id @default(cuid())
  moduleNumber        Int                 @map("module_number")
  code                String              @unique
  titleEn             String              @map("title_en")
  titleFr             String              @map("title_fr")
  descriptionEn       String              @map("description_en") @db.Text
  descriptionFr       String              @map("description_fr") @db.Text
  objectivesEn        String[]            @default([]) @map("objectives_en")
  objectivesFr        String[]            @default([]) @map("objectives_fr")
  topics              TrainingTopic[]
  resources           TrainingResource[]
  iconName            String?             @map("icon_name")
  sortOrder           Int                 @map("sort_order")
  isActive            Boolean             @default(true) @map("is_active")
  isEnabled           Boolean             @default(true) @map("is_enabled")
  enabledUntil        DateTime?           @map("enabled_until")
  createdAt           DateTime            @default(now()) @map("created_at")
  updatedAt           DateTime            @updatedAt @map("updated_at")
  @@map("training_modules")
}

model TrainingTopic {
  id                  String              @id @default(cuid())
  moduleId            String              @map("module_id")
  module              TrainingModule      @relation(fields: [moduleId], references: [id])
  titleEn             String              @map("title_en")
  titleFr             String              @map("title_fr")
  contentEn           String              @map("content_en") @db.Text
  contentFr           String              @map("content_fr") @db.Text
  relatedPQs          String[]            @default([]) @map("related_pqs")
  relatedStudyAreas   CANSOStudyArea[]    @default([]) @map("related_study_areas")
  sortOrder           Int                 @map("sort_order")
  @@map("training_topics")
}

model TrainingResource {
  id                  String              @id @default(cuid())
  moduleId            String              @map("module_id")
  module              TrainingModule      @relation(fields: [moduleId], references: [id])
  titleEn             String              @map("title_en")
  titleFr             String              @map("title_fr")
  resourceType        ResourceType        @map("resource_type")
  url                 String?
  fileUrl             String?             @map("file_url")
  sortOrder           Int                 @map("sort_order")
  @@map("training_resources")
}

// =============================================================================
// DOCUMENTS & SUPPORT
// =============================================================================

model Document {
  id                  String              @id @default(cuid())
  name                String
  description         String?
  fileUrl             String              @map("file_url")
  fileType            String              @map("file_type")
  fileSize            Int                 @map("file_size")
  category            String?
  tags                String[]            @default([])
  organizationId      String?             @map("organization_id")
  organization        Organization?       @relation(fields: [organizationId], references: [id])
  assessmentId        String?             @map("assessment_id")
  assessment          Assessment?         @relation(fields: [assessmentId], references: [id])
  reviewId            String?             @map("review_id")
  review              Review?             @relation(fields: [reviewId], references: [id])
  findingId           String?             @map("finding_id")
  finding             Finding?            @relation(fields: [findingId], references: [id])
  capId               String?             @map("cap_id")
  cap                 CorrectiveActionPlan? @relation(fields: [capId], references: [id])
  uploadedById        String              @map("uploaded_by_id")
  uploadedAt          DateTime            @default(now()) @map("uploaded_at")
  createdAt           DateTime            @default(now()) @map("created_at")
  updatedAt           DateTime            @updatedAt @map("updated_at")
  @@map("documents")
}

model Notification {
  id                  String              @id @default(cuid())
  userId              String              @map("user_id")
  user                User                @relation(fields: [userId], references: [id])
  type                String
  titleEn             String              @map("title_en")
  titleFr             String              @map("title_fr")
  messageEn           String              @map("message_en")
  messageFr           String              @map("message_fr")
  link                String?
  data                Json?
  readAt              DateTime?           @map("read_at")
  emailSentAt         DateTime?           @map("email_sent_at")
  createdAt           DateTime            @default(now()) @map("created_at")
  @@index([userId, readAt])
  @@map("notifications")
}

model AuditLog {
  id                  String              @id @default(cuid())
  userId              String?             @map("user_id")
  user                User?               @relation(fields: [userId], references: [id])
  action              String
  entityType          String              @map("entity_type")
  entityId            String              @map("entity_id")
  previousData        Json?               @map("previous_data")
  newData             Json?               @map("new_data")
  ipAddress           String?             @map("ip_address")
  userAgent           String?             @map("user_agent")
  createdAt           DateTime            @default(now()) @map("created_at")
  @@index([entityType, entityId])
  @@index([userId, createdAt])
  @@map("audit_logs")
}

\`\`\`

# public/file.svg

This is a file of the type: SVG Image

# public/globe.svg

This is a file of the type: SVG Image

# public/next.svg

This is a file of the type: SVG Image

# public/vercel.svg

This is a file of the type: SVG Image

# public/window.svg

This is a file of the type: SVG Image

# README.md

\`\`\`md
This is a [Next.js](https://nextjs.org) project bootstrapped with [`create-next-app`](https://nextjs.org/docs/app/api-reference/cli/create-next-app).

## Getting Started

First, run the development server:

\`\`\`bash
npm run dev
# or
yarn dev
# or
pnpm dev
# or
bun dev
\`\`\`

Open [http://localhost:3000](http://localhost:3000) with your browser to see the result.

You can start editing the page by modifying `app/page.tsx`. The page auto-updates as you edit the file.

This project uses [`next/font`](https://nextjs.org/docs/app/building-your-application/optimizing/fonts) to automatically optimize and load [Geist](https://vercel.com/font), a new font family for Vercel.

## Learn More

To learn more about Next.js, take a look at the following resources:

- [Next.js Documentation](https://nextjs.org/docs) - learn about Next.js features and API.
- [Learn Next.js](https://nextjs.org/learn) - an interactive Next.js tutorial.

You can check out [the Next.js GitHub repository](https://github.com/vercel/next.js) - your feedback and contributions are welcome!

## Deploy on Vercel

The easiest way to deploy your Next.js app is to use the [Vercel Platform](https://vercel.com/new?utm_medium=default-template&filter=next.js&utm_source=create-next-app&utm_campaign=create-next-app-readme) from the creators of Next.js.

Check out our [Next.js deployment documentation](https://nextjs.org/docs/app/building-your-application/deploying) for more details.

\`\`\`

# src/app/[locale]/(auth)/layout.tsx

\`\`\`tsx
interface AuthLayoutProps {
  children: React.ReactNode;
}

export default function AuthLayout({ children }: AuthLayoutProps) {
  return <>{children}</>;
}

\`\`\`

# src/app/[locale]/(auth)/login/page.tsx

\`\`\`tsx
"use client";

import { useState, use } from "react";
import { signIn } from "next-auth/react";
import { useRouter, useSearchParams } from "next/navigation";
import { useTranslations } from "next-intl";
import Link from "next/link";
import { useForm } from "react-hook-form";
import { zodResolver } from "@hookform/resolvers/zod";
import { z } from "zod";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from "@/components/ui/card";
import { Alert, AlertDescription } from "@/components/ui/alert";
import { Loader2, AlertCircle } from "lucide-react";

const loginSchema = z.object({
  email: z.string().email("Invalid email address"),
  password: z.string().min(1, "Password is required"),
});

type LoginForm = z.infer<typeof loginSchema>;

export default function LoginPage({ params }: { params: Promise<{ locale: string }> }) {
  const { locale } = use(params);
  const router = useRouter();
  const searchParams = useSearchParams();
  const t = useTranslations("auth");
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  const callbackUrl = searchParams.get("callbackUrl") || `/${locale}/dashboard`;

  const { register, handleSubmit, formState: { errors } } = useForm<LoginForm>({
    resolver: zodResolver(loginSchema),
  });

  const onSubmit = async (data: LoginForm) => {
    setIsLoading(true);
    setError(null);

    try {
      const result = await signIn("credentials", {
        email: data.email,
        password: data.password,
        redirect: false,
      });

      if (result?.error) {
        setError(t("errors.invalidCredentials"));
      } else {
        router.push(callbackUrl);
        router.refresh();
      }
    } catch {
      setError(t("errors.generic"));
    } finally {
      setIsLoading(false);
    }
  };

  return (
    <div className="min-h-screen flex items-center justify-center bg-muted/30 px-4">
      <Card className="w-full max-w-md">
        <CardHeader className="text-center">
          <div className="flex justify-center mb-4">
            <div className="flex h-12 w-12 items-center justify-center rounded-lg bg-primary text-primary-foreground text-xl font-bold">A</div>
          </div>
          <CardTitle className="text-2xl">{t("login.title")}</CardTitle>
          <CardDescription>{t("login.subtitle")}</CardDescription>
        </CardHeader>
        <form onSubmit={handleSubmit(onSubmit)}>
          <CardContent className="space-y-4">
            {error && (
              <Alert variant="destructive">
                <AlertCircle className="h-4 w-4" />
                <AlertDescription>{error}</AlertDescription>
              </Alert>
            )}
            <div className="space-y-2">
              <Label htmlFor="email">{t("fields.email")}</Label>
              <Input id="email" type="email" placeholder="name@example.com" {...register("email")} disabled={isLoading} />
              {errors.email && <p className="text-sm text-destructive">{errors.email.message}</p>}
            </div>
            <div className="space-y-2">
              <div className="flex items-center justify-between">
                <Label htmlFor="password">{t("fields.password")}</Label>
                <Link href={`/${locale}/forgot-password`} className="text-sm text-primary hover:underline">{t("login.forgotPassword")}</Link>
              </div>
              <Input id="password" type="password" {...register("password")} disabled={isLoading} />
              {errors.password && <p className="text-sm text-destructive">{errors.password.message}</p>}
            </div>
          </CardContent>
          <CardFooter className="flex flex-col gap-4">
            <Button type="submit" className="w-full" disabled={isLoading}>
              {isLoading ? <><Loader2 className="mr-2 h-4 w-4 animate-spin" />{t("login.signingIn")}</> : t("login.signIn")}
            </Button>
            <p className="text-sm text-muted-foreground text-center">
              {t("login.noAccount")} <Link href={`/${locale}/register`} className="text-primary hover:underline">{t("login.signUp")}</Link>
            </p>
          </CardFooter>
        </form>
      </Card>
    </div>
  );
}

\`\`\`

# src/app/[locale]/(auth)/register/page.tsx

\`\`\`tsx
"use client";

import { useState, use } from "react";
import { useRouter } from "next/navigation";
import { useTranslations } from "next-intl";
import Link from "next/link";
import { useForm } from "react-hook-form";
import { zodResolver } from "@hookform/resolvers/zod";
import { z } from "zod";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from "@/components/ui/card";
import { Alert, AlertDescription } from "@/components/ui/alert";
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/ui/select";
import { Loader2, AlertCircle, CheckCircle } from "lucide-react";

const registerSchema = z.object({
  firstName: z.string().min(2, "First name must be at least 2 characters"),
  lastName: z.string().min(2, "Last name must be at least 2 characters"),
  email: z.string().email("Invalid email address"),
  password: z.string()
    .min(12, "Password must be at least 12 characters")
    .regex(/[A-Z]/, "Must contain uppercase")
    .regex(/[a-z]/, "Must contain lowercase")
    .regex(/[0-9]/, "Must contain number")
    .regex(/[^A-Za-z0-9]/, "Must contain special character"),
  confirmPassword: z.string(),
  locale: z.enum(["EN", "FR"]),
}).refine((data) => data.password === data.confirmPassword, {
  message: "Passwords don't match",
  path: ["confirmPassword"],
});

type RegisterForm = z.infer<typeof registerSchema>;

export default function RegisterPage({ params }: { params: Promise<{ locale: string }> }) {
  const { locale } = use(params);
  const router = useRouter();
  const t = useTranslations("auth");
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const [success, setSuccess] = useState(false);

  const { register, handleSubmit, setValue, formState: { errors } } = useForm<RegisterForm>({
    resolver: zodResolver(registerSchema),
    defaultValues: { locale: locale.toUpperCase() as "EN" | "FR" },
  });

  const onSubmit = async (data: RegisterForm) => {
    setIsLoading(true);
    setError(null);

    try {
      const response = await fetch("/api/auth/register", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          firstName: data.firstName,
          lastName: data.lastName,
          email: data.email,
          password: data.password,
          locale: data.locale,
        }),
      });

      const result = await response.json();

      if (!response.ok) {
        setError(result.error || t("errors.generic"));
      } else {
        setSuccess(true);
        setTimeout(() => router.push(`/${locale}/login`), 2000);
      }
    } catch {
      setError(t("errors.generic"));
    } finally {
      setIsLoading(false);
    }
  };

  if (success) {
    return (
      <div className="min-h-screen flex items-center justify-center bg-muted/30 px-4">
        <Card className="w-full max-w-md">
          <CardContent className="pt-6">
            <div className="flex flex-col items-center text-center">
              <CheckCircle className="h-12 w-12 text-green-500 mb-4" />
              <h2 className="text-xl font-semibold mb-2">{t("register.success")}</h2>
              <p className="text-muted-foreground">{t("register.redirecting")}</p>
            </div>
          </CardContent>
        </Card>
      </div>
    );
  }

  return (
    <div className="min-h-screen flex items-center justify-center bg-muted/30 px-4 py-8">
      <Card className="w-full max-w-md">
        <CardHeader className="text-center">
          <div className="flex justify-center mb-4">
            <div className="flex h-12 w-12 items-center justify-center rounded-lg bg-primary text-primary-foreground text-xl font-bold">A</div>
          </div>
          <CardTitle className="text-2xl">{t("register.title")}</CardTitle>
          <CardDescription>{t("register.subtitle")}</CardDescription>
        </CardHeader>
        <form onSubmit={handleSubmit(onSubmit)}>
          <CardContent className="space-y-4">
            {error && (
              <Alert variant="destructive">
                <AlertCircle className="h-4 w-4" />
                <AlertDescription>{error}</AlertDescription>
              </Alert>
            )}
            <div className="grid grid-cols-2 gap-4">
              <div className="space-y-2">
                <Label htmlFor="firstName">{t("fields.firstName")}</Label>
                <Input id="firstName" {...register("firstName")} disabled={isLoading} />
                {errors.firstName && <p className="text-xs text-destructive">{errors.firstName.message}</p>}
              </div>
              <div className="space-y-2">
                <Label htmlFor="lastName">{t("fields.lastName")}</Label>
                <Input id="lastName" {...register("lastName")} disabled={isLoading} />
                {errors.lastName && <p className="text-xs text-destructive">{errors.lastName.message}</p>}
              </div>
            </div>
            <div className="space-y-2">
              <Label htmlFor="email">{t("fields.email")}</Label>
              <Input id="email" type="email" placeholder="name@example.com" {...register("email")} disabled={isLoading} />
              {errors.email && <p className="text-sm text-destructive">{errors.email.message}</p>}
            </div>
            <div className="space-y-2">
              <Label htmlFor="password">{t("fields.password")}</Label>
              <Input id="password" type="password" {...register("password")} disabled={isLoading} />
              {errors.password && <p className="text-sm text-destructive">{errors.password.message}</p>}
              <p className="text-xs text-muted-foreground">{t("register.passwordRequirements")}</p>
            </div>
            <div className="space-y-2">
              <Label htmlFor="confirmPassword">{t("fields.confirmPassword")}</Label>
              <Input id="confirmPassword" type="password" {...register("confirmPassword")} disabled={isLoading} />
              {errors.confirmPassword && <p className="text-sm text-destructive">{errors.confirmPassword.message}</p>}
            </div>
            <div className="space-y-2">
              <Label htmlFor="locale">{t("fields.language")}</Label>
              <Select defaultValue={locale.toUpperCase()} onValueChange={(value) => setValue("locale", value as "EN" | "FR")} disabled={isLoading}>
                <SelectTrigger><SelectValue /></SelectTrigger>
                <SelectContent>
                  <SelectItem value="EN">English</SelectItem>
                  <SelectItem value="FR">Français</SelectItem>
                </SelectContent>
              </Select>
            </div>
          </CardContent>
          <CardFooter className="flex flex-col gap-4">
            <Button type="submit" className="w-full" disabled={isLoading}>
              {isLoading ? <><Loader2 className="mr-2 h-4 w-4 animate-spin" />{t("register.creating")}</> : t("register.createAccount")}
            </Button>
            <p className="text-sm text-muted-foreground text-center">
              {t("register.haveAccount")} <Link href={`/${locale}/login`} className="text-primary hover:underline">{t("register.signIn")}</Link>
            </p>
          </CardFooter>
        </form>
      </Card>
    </div>
  );
}

\`\`\`

# src/app/[locale]/(auth)/unauthorized/page.tsx

\`\`\`tsx
import Link from "next/link";
import { Button } from "@/components/ui/button";
import { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from "@/components/ui/card";
import { ShieldX } from "lucide-react";

export default async function UnauthorizedPage({ params }: { params: Promise<{ locale: string }> }) {
  const { locale } = await params;

  return (
    <div className="min-h-screen flex items-center justify-center bg-muted/30 px-4">
      <Card className="w-full max-w-md text-center">
        <CardHeader>
          <div className="flex justify-center mb-4">
            <ShieldX className="h-16 w-16 text-destructive" />
          </div>
          <CardTitle className="text-2xl">Access Denied</CardTitle>
          <CardDescription>You don&apos;t have permission to access this page.</CardDescription>
        </CardHeader>
        <CardContent>
          <p className="text-sm text-muted-foreground">If you believe this is an error, please contact your administrator.</p>
        </CardContent>
        <CardFooter className="flex justify-center">
          <Button asChild>
            <Link href={`/${locale}/dashboard`}>Return to Dashboard</Link>
          </Button>
        </CardFooter>
      </Card>
    </div>
  );
}

\`\`\`

# src/app/[locale]/(dashboard)/dashboard/page.tsx

\`\`\`tsx
import { getTranslations } from "next-intl/server";
import { auth } from "@/lib/auth";
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "@/components/ui/card";
import { ClipboardList, FileCheck, Users, AlertTriangle } from "lucide-react";

export async function generateMetadata({ params }: { params: Promise<{ locale: string }> }) {
  const { locale } = await params;
  const t = await getTranslations({ locale, namespace: "dashboard" });
  return { title: t("title") };
}

export default async function DashboardPage() {
  const session = await auth();
  const firstName = session?.user?.firstName || "User";

  return (
    <div className="space-y-6">
      <div>
        <h1 className="text-2xl font-bold tracking-tight">Welcome back, {firstName}!</h1>
        <p className="text-muted-foreground">Here&apos;s an overview of your peer review activities.</p>
      </div>

      <div className="grid gap-4 md:grid-cols-2 lg:grid-cols-4">
        <Card>
          <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
            <CardTitle className="text-sm font-medium">Active Assessments</CardTitle>
            <ClipboardList className="h-4 w-4 text-muted-foreground" />
          </CardHeader>
          <CardContent>
            <div className="text-2xl font-bold">3</div>
            <p className="text-xs text-muted-foreground">2 pending submission</p>
          </CardContent>
        </Card>

        <Card>
          <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
            <CardTitle className="text-sm font-medium">Peer Reviews</CardTitle>
            <FileCheck className="h-4 w-4 text-muted-foreground" />
          </CardHeader>
          <CardContent>
            <div className="text-2xl font-bold">1</div>
            <p className="text-xs text-muted-foreground">Scheduled for Q2 2026</p>
          </CardContent>
        </Card>

        <Card>
          <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
            <CardTitle className="text-sm font-medium">Team Members</CardTitle>
            <Users className="h-4 w-4 text-muted-foreground" />
          </CardHeader>
          <CardContent>
            <div className="text-2xl font-bold">45</div>
            <p className="text-xs text-muted-foreground">Certified reviewers</p>
          </CardContent>
        </Card>

        <Card>
          <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
            <CardTitle className="text-sm font-medium">Open Findings</CardTitle>
            <AlertTriangle className="h-4 w-4 text-muted-foreground" />
          </CardHeader>
          <CardContent>
            <div className="text-2xl font-bold">7</div>
            <p className="text-xs text-muted-foreground">3 require CAP</p>
          </CardContent>
        </Card>
      </div>

      <Card>
        <CardHeader>
          <CardTitle>Quick Actions</CardTitle>
          <CardDescription>Get started with common tasks</CardDescription>
        </CardHeader>
        <CardContent className="grid gap-4 md:grid-cols-3">
          <div className="rounded-lg border p-4 hover:bg-muted/50 cursor-pointer transition-colors">
            <h3 className="font-medium">Start Self-Assessment</h3>
            <p className="text-sm text-muted-foreground">Begin a new ANS or SMS assessment</p>
          </div>
          <div className="rounded-lg border p-4 hover:bg-muted/50 cursor-pointer transition-colors">
            <h3 className="font-medium">Browse Questionnaires</h3>
            <p className="text-sm text-muted-foreground">Explore 851 USOAP CMA Protocol Questions</p>
          </div>
          <div className="rounded-lg border p-4 hover:bg-muted/50 cursor-pointer transition-colors">
            <h3 className="font-medium">Training Modules</h3>
            <p className="text-sm text-muted-foreground">Access peer reviewer training materials</p>
          </div>
        </CardContent>
      </Card>
    </div>
  );
}

\`\`\`

# src/app/[locale]/(dashboard)/layout.tsx

\`\`\`tsx
import { redirect } from "next/navigation";
import { auth } from "@/lib/auth";
import { AppShell } from "@/components/layout/app-shell";

interface DashboardLayoutProps {
  children: React.ReactNode;
  params: Promise<{ locale: string }>;
}

export default async function DashboardLayout({
  children,
  params,
}: DashboardLayoutProps) {
  const { locale } = await params;
  const session = await auth();

  if (!session?.user) {
    redirect(`/${locale}/login`);
  }

  const user = {
    firstName: session.user.firstName,
    lastName: session.user.lastName,
    email: session.user.email || "",
    role: session.user.role,
  };

  return (
    <AppShell locale={locale} user={user}>
      {children}
    </AppShell>
  );
}

\`\`\`

# src/app/[locale]/layout.tsx

\`\`\`tsx
import { NextIntlClientProvider } from "next-intl";
import { getMessages } from "next-intl/server";
import { notFound } from "next/navigation";
import { routing } from "@/lib/i18n/routing";
import "../globals.css";

export default async function LocaleLayout({
  children,
  params,
}: {
  children: React.ReactNode;
  params: Promise<{ locale: string }>;
}) {
  const { locale } = await params;

  if (!routing.locales.includes(locale as "en" | "fr")) {
    notFound();
  }

  const messages = await getMessages();

  return (
    <html lang={locale} suppressHydrationWarning>
      <body className="antialiased" suppressHydrationWarning>
        <NextIntlClientProvider messages={messages}>
          {children}
        </NextIntlClientProvider>
      </body>
    </html>
  );
}

\`\`\`

# src/app/[locale]/page.tsx

\`\`\`tsx
import { useTranslations } from "next-intl";
import Link from "next/link";

export default function HomePage() {
  const t = useTranslations("common");

  return (
    <main className="flex min-h-screen flex-col items-center justify-center p-24">
      <h1 className="text-4xl font-bold mb-4">{t("appName")}</h1>
      <p className="text-xl text-muted-foreground mb-8">{t("appTagline")}</p>
      <div className="flex gap-4">
        <Link
          href="/en/login"
          className="px-6 py-3 bg-primary text-primary-foreground rounded-lg"
        >
          English
        </Link>
        <Link
          href="/fr/login"
          className="px-6 py-3 bg-secondary text-secondary-foreground rounded-lg"
        >
          Français
        </Link>
      </div>
    </main>
  );
}

\`\`\`

# src/app/api/auth/[...nextauth]/route.ts

\`\`\`ts
import { GET, POST } from "@/lib/auth";

export { GET, POST };

\`\`\`

# src/app/api/auth/register/route.ts

\`\`\`ts
import { NextResponse } from "next/server";
import bcrypt from "bcryptjs";
import { db } from "@/lib/db";
import { z } from "zod";

const registerSchema = z.object({
  email: z.string().email(),
  password: z.string().min(12),
  firstName: z.string().min(2),
  lastName: z.string().min(2),
  locale: z.enum(["EN", "FR"]).default("EN"),
});

export async function POST(req: Request) {
  try {
    const body = await req.json();
    const { email, password, firstName, lastName, locale } = registerSchema.parse(body);

    const existingUser = await db.user.findUnique({
      where: { email },
    });

    if (existingUser) {
      return NextResponse.json(
        { error: "User already exists" },
        { status: 400 }
      );
    }

    const passwordHash = await bcrypt.hash(password, 12);

    const user = await db.user.create({
      data: {
        email,
        passwordHash,
        firstName,
        lastName,
        locale,
        role: "STAFF",
      },
    });

    return NextResponse.json(
      { message: "User created successfully", userId: user.id },
      { status: 201 }
    );
  } catch (error) {
    if (error instanceof z.ZodError) {
      return NextResponse.json(
        { error: "Invalid input", details: error.issues },
        { status: 400 }
      );
    }
    console.error("Registration error:", error);
    return NextResponse.json(
      { error: "Internal server error" },
      { status: 500 }
    );
  }
}

\`\`\`

# src/app/favicon.ico

This is a binary file of the type: Binary

# src/app/globals.css

\`\`\`css
@import "tailwindcss";

@custom-variant dark (&:is(.dark *));

@plugin "tailwindcss-animate";

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-border: var(--border);
  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);
  --color-secondary: var(--secondary);
  --color-secondary-foreground: var(--secondary-foreground);
  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);

  /* Maturity level colors */
  --color-maturity-a: #EF4444;
  --color-maturity-b: #F97316;
  --color-maturity-c: #EAB308;
  --color-maturity-d: #22C55E;
  --color-maturity-e: #3B82F6;
  --color-sidebar-ring: var(--sidebar-ring);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar: var(--sidebar);
  --color-chart-5: var(--chart-5);
  --color-chart-4: var(--chart-4);
  --color-chart-3: var(--chart-3);
  --color-chart-2: var(--chart-2);
  --color-chart-1: var(--chart-1);
  --color-ring: var(--ring);
  --color-input: var(--input);
  --color-destructive: var(--destructive);
  --color-accent-foreground: var(--accent-foreground);
  --color-accent: var(--accent);
  --color-popover-foreground: var(--popover-foreground);
  --color-popover: var(--popover);
  --color-card-foreground: var(--card-foreground);
  --color-card: var(--card);
  --radius-sm: calc(var(--radius) - 4px);
  --radius-md: calc(var(--radius) - 2px);
  --radius-lg: var(--radius);
  --radius-xl: calc(var(--radius) + 4px);
  --radius-2xl: calc(var(--radius) + 8px);
  --radius-3xl: calc(var(--radius) + 12px);
  --radius-4xl: calc(var(--radius) + 16px);
}

:root {
  --primary: oklch(0.21 0.034 264.665);
  --primary-foreground: oklch(0.985 0.002 247.839);
  --secondary: oklch(0.967 0.003 264.542);
  --secondary-foreground: oklch(0.21 0.034 264.665);
  --muted: oklch(0.967 0.003 264.542);
  --muted-foreground: oklch(0.551 0.027 264.364);
  --border: oklch(0.928 0.006 264.531);
  --radius: 0.625rem;
  --background: oklch(1 0 0);
  --foreground: oklch(0.13 0.028 261.692);
  --card: oklch(1 0 0);
  --card-foreground: oklch(0.13 0.028 261.692);
  --popover: oklch(1 0 0);
  --popover-foreground: oklch(0.13 0.028 261.692);
  --accent: oklch(0.967 0.003 264.542);
  --accent-foreground: oklch(0.21 0.034 264.665);
  --destructive: oklch(0.577 0.245 27.325);
  --input: oklch(0.928 0.006 264.531);
  --ring: oklch(0.707 0.022 261.325);
  --chart-1: oklch(0.646 0.222 41.116);
  --chart-2: oklch(0.6 0.118 184.704);
  --chart-3: oklch(0.398 0.07 227.392);
  --chart-4: oklch(0.828 0.189 84.429);
  --chart-5: oklch(0.769 0.188 70.08);
  --sidebar: oklch(0.985 0.002 247.839);
  --sidebar-foreground: oklch(0.13 0.028 261.692);
  --sidebar-primary: oklch(0.21 0.034 264.665);
  --sidebar-primary-foreground: oklch(0.985 0.002 247.839);
  --sidebar-accent: oklch(0.967 0.003 264.542);
  --sidebar-accent-foreground: oklch(0.21 0.034 264.665);
  --sidebar-border: oklch(0.928 0.006 264.531);
  --sidebar-ring: oklch(0.707 0.022 261.325);
}

.dark {
  --background: oklch(0.13 0.028 261.692);
  --foreground: oklch(0.985 0.002 247.839);
  --primary: oklch(0.928 0.006 264.531);
  --primary-foreground: oklch(0.21 0.034 264.665);
  --secondary: oklch(0.278 0.033 256.848);
  --secondary-foreground: oklch(0.985 0.002 247.839);
  --muted: oklch(0.278 0.033 256.848);
  --muted-foreground: oklch(0.707 0.022 261.325);
  --border: oklch(1 0 0 / 10%);
  --card: oklch(0.21 0.034 264.665);
  --card-foreground: oklch(0.985 0.002 247.839);
  --popover: oklch(0.21 0.034 264.665);
  --popover-foreground: oklch(0.985 0.002 247.839);
  --accent: oklch(0.278 0.033 256.848);
  --accent-foreground: oklch(0.985 0.002 247.839);
  --destructive: oklch(0.704 0.191 22.216);
  --input: oklch(1 0 0 / 15%);
  --ring: oklch(0.551 0.027 264.364);
  --chart-1: oklch(0.488 0.243 264.376);
  --chart-2: oklch(0.696 0.17 162.48);
  --chart-3: oklch(0.769 0.188 70.08);
  --chart-4: oklch(0.627 0.265 303.9);
  --chart-5: oklch(0.645 0.246 16.439);
  --sidebar: oklch(0.21 0.034 264.665);
  --sidebar-foreground: oklch(0.985 0.002 247.839);
  --sidebar-primary: oklch(0.488 0.243 264.376);
  --sidebar-primary-foreground: oklch(0.985 0.002 247.839);
  --sidebar-accent: oklch(0.278 0.033 256.848);
  --sidebar-accent-foreground: oklch(0.985 0.002 247.839);
  --sidebar-border: oklch(1 0 0 / 10%);
  --sidebar-ring: oklch(0.551 0.027 264.364);
}

body {
  background: hsl(var(--background));
  color: hsl(var(--foreground));
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
}

/* Utility classes for design system */
.bg-primary {
  background-color: hsl(var(--primary));
}

.text-primary-foreground {
  color: hsl(var(--primary-foreground));
}

.bg-secondary {
  background-color: hsl(var(--secondary));
}

.text-secondary-foreground {
  color: hsl(var(--secondary-foreground));
}

.text-muted-foreground {
  color: hsl(var(--muted-foreground));
}

@layer base {
  * {
    @apply border-border outline-ring/50;
  }
  body {
    @apply bg-background text-foreground;
  }
}

\`\`\`

# src/app/layout.tsx

\`\`\`tsx
import type { Metadata } from "next";

export const metadata: Metadata = {
  title: "African ANSP Peer Review",
  description: "Collaborative Excellence in Aviation Safety",
};

export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return children;
}

\`\`\`

# src/app/page.tsx

\`\`\`tsx
import Image from "next/image";

export default function Home() {
  return (
    <div className="flex min-h-screen items-center justify-center bg-zinc-50 font-sans dark:bg-black">
      <main className="flex min-h-screen w-full max-w-3xl flex-col items-center justify-between py-32 px-16 bg-white dark:bg-black sm:items-start">
        <Image
          className="dark:invert"
          src="/next.svg"
          alt="Next.js logo"
          width={100}
          height={20}
          priority
        />
        <div className="flex flex-col items-center gap-6 text-center sm:items-start sm:text-left">
          <h1 className="max-w-xs text-3xl font-semibold leading-10 tracking-tight text-black dark:text-zinc-50">
            To get started, edit the page.tsx file.
          </h1>
          <p className="max-w-md text-lg leading-8 text-zinc-600 dark:text-zinc-400">
            Looking for a starting point or more instructions? Head over to{" "}
            <a
              href="https://vercel.com/templates?framework=next.js&utm_source=create-next-app&utm_medium=appdir-template-tw&utm_campaign=create-next-app"
              className="font-medium text-zinc-950 dark:text-zinc-50"
            >
              Templates
            </a>{" "}
            or the{" "}
            <a
              href="https://nextjs.org/learn?utm_source=create-next-app&utm_medium=appdir-template-tw&utm_campaign=create-next-app"
              className="font-medium text-zinc-950 dark:text-zinc-50"
            >
              Learning
            </a>{" "}
            center.
          </p>
        </div>
        <div className="flex flex-col gap-4 text-base font-medium sm:flex-row">
          <a
            className="flex h-12 w-full items-center justify-center gap-2 rounded-full bg-foreground px-5 text-background transition-colors hover:bg-[#383838] dark:hover:bg-[#ccc] md:w-[158px]"
            href="https://vercel.com/new?utm_source=create-next-app&utm_medium=appdir-template-tw&utm_campaign=create-next-app"
            target="_blank"
            rel="noopener noreferrer"
          >
            <Image
              className="dark:invert"
              src="/vercel.svg"
              alt="Vercel logomark"
              width={16}
              height={16}
            />
            Deploy Now
          </a>
          <a
            className="flex h-12 w-full items-center justify-center rounded-full border border-solid border-black/[.08] px-5 transition-colors hover:border-transparent hover:bg-black/[.04] dark:border-white/[.145] dark:hover:bg-[#1a1a1a] md:w-[158px]"
            href="https://nextjs.org/docs?utm_source=create-next-app&utm_medium=appdir-template-tw&utm_campaign=create-next-app"
            target="_blank"
            rel="noopener noreferrer"
          >
            Documentation
          </a>
        </div>
      </main>
    </div>
  );
}

\`\`\`

# src/components/layout/app-shell.tsx

\`\`\`tsx
import { Sidebar } from "./sidebar";
import { Header } from "./header";

interface AppShellProps {
  children: React.ReactNode;
  locale: string;
  user: {
    firstName: string;
    lastName: string;
    email: string;
    role: string;
  };
}

export function AppShell({ children, locale, user }: AppShellProps) {
  return (
    <div className="flex h-screen overflow-hidden">
      <Sidebar locale={locale} />
      <div className="flex flex-1 flex-col overflow-hidden">
        <Header locale={locale} user={user} />
        <main className="flex-1 overflow-auto bg-muted/30 p-6">
          {children}
        </main>
      </div>
    </div>
  );
}

\`\`\`

# src/components/layout/header.tsx

\`\`\`tsx
"use client";

import { useTranslations } from "next-intl";
import { signOut } from "next-auth/react";
import { useRouter } from "next/navigation";
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuLabel,
  DropdownMenuSeparator,
  DropdownMenuTrigger,
} from "@/components/ui/dropdown-menu";
import { Button } from "@/components/ui/button";
import { Avatar, AvatarFallback } from "@/components/ui/avatar";
import { Badge } from "@/components/ui/badge";
import { Bell, Globe, LogOut, User, Settings } from "lucide-react";
import Link from "next/link";

interface HeaderProps {
  locale: string;
  user: {
    firstName: string;
    lastName: string;
    email: string;
    role: string;
  };
}

export function Header({ locale, user }: HeaderProps) {
  const t = useTranslations("common");
  const router = useRouter();
  const otherLocale = locale === "en" ? "fr" : "en";
  const initials = `${user.firstName[0]}${user.lastName[0]}`.toUpperCase();

  const handleSignOut = async () => {
    await signOut({ redirect: false });
    router.push(`/${locale}/login`);
  };

  const switchLocale = () => {
    const currentPath = window.location.pathname;
    const newPath = currentPath.replace(`/${locale}`, `/${otherLocale}`);
    router.push(newPath);
  };

  return (
    <header className="flex h-16 items-center justify-between border-b bg-background px-6">
      <div className="flex items-center gap-4">
        <h1 className="text-lg font-semibold">{t("appName")}</h1>
      </div>

      <div className="flex items-center gap-2">
        <Button variant="ghost" size="icon" onClick={switchLocale}>
          <Globe className="h-4 w-4" />
        </Button>

        <Button variant="ghost" size="icon" className="relative">
          <Bell className="h-4 w-4" />
          <span className="absolute -right-1 -top-1 flex h-4 w-4 items-center justify-center rounded-full bg-destructive text-[10px] text-destructive-foreground">
            3
          </span>
        </Button>

        <DropdownMenu>
          <DropdownMenuTrigger asChild>
            <Button variant="ghost" className="flex items-center gap-2 px-2">
              <Avatar className="h-8 w-8">
                <AvatarFallback className="bg-primary text-primary-foreground text-xs">
                  {initials}
                </AvatarFallback>
              </Avatar>
              <div className="hidden flex-col items-start text-sm md:flex">
                <span className="font-medium">{user.firstName} {user.lastName}</span>
                <Badge variant="secondary" className="text-[10px] px-1 py-0">
                  {user.role.replace("_", " ")}
                </Badge>
              </div>
            </Button>
          </DropdownMenuTrigger>
          <DropdownMenuContent align="end" className="w-56">
            <DropdownMenuLabel>
              <div className="flex flex-col">
                <span>{user.firstName} {user.lastName}</span>
                <span className="text-xs font-normal text-muted-foreground">{user.email}</span>
              </div>
            </DropdownMenuLabel>
            <DropdownMenuSeparator />
            <DropdownMenuItem asChild>
              <Link href={`/${locale}/dashboard/profile`}>
                <User className="mr-2 h-4 w-4" />
                {t("actions.profile")}
              </Link>
            </DropdownMenuItem>
            <DropdownMenuItem asChild>
              <Link href={`/${locale}/dashboard/settings`}>
                <Settings className="mr-2 h-4 w-4" />
                {t("actions.settings")}
              </Link>
            </DropdownMenuItem>
            <DropdownMenuSeparator />
            <DropdownMenuItem onClick={handleSignOut} className="text-destructive">
              <LogOut className="mr-2 h-4 w-4" />
              {t("actions.logout")}
            </DropdownMenuItem>
          </DropdownMenuContent>
        </DropdownMenu>
      </div>
    </header>
  );
}

\`\`\`

# src/components/layout/sidebar.tsx

\`\`\`tsx
"use client";

import Link from "next/link";
import { usePathname } from "next/navigation";
import { useTranslations } from "next-intl";
import { cn } from "@/lib/utils";
import {
  LayoutDashboard,
  ClipboardList,
  FileCheck,
  Users,
  Building2,
  BookOpen,
  Settings,
  ChevronLeft,
  ChevronRight,
} from "lucide-react";
import { Button } from "@/components/ui/button";
import { ScrollArea } from "@/components/ui/scroll-area";
import { useState } from "react";

interface NavItem {
  titleKey: string;
  href: string;
  icon: React.ElementType;
}

const navItems: NavItem[] = [
  { titleKey: "dashboard", href: "/dashboard", icon: LayoutDashboard },
  { titleKey: "questionnaires", href: "/dashboard/questionnaires", icon: ClipboardList },
  { titleKey: "assessments", href: "/dashboard/assessments", icon: FileCheck },
  { titleKey: "reviews", href: "/dashboard/reviews", icon: Users },
  { titleKey: "organizations", href: "/dashboard/organizations", icon: Building2 },
  { titleKey: "training", href: "/dashboard/training", icon: BookOpen },
  { titleKey: "settings", href: "/dashboard/settings", icon: Settings },
];

interface SidebarProps {
  locale: string;
}

export function Sidebar({ locale }: SidebarProps) {
  const pathname = usePathname();
  const t = useTranslations("navigation");
  const [collapsed, setCollapsed] = useState(false);

  return (
    <div
      className={cn(
        "relative flex flex-col border-r bg-background transition-all duration-300",
        collapsed ? "w-16" : "w-64"
      )}
    >
      <div className="flex h-16 items-center justify-center border-b px-4">
        {!collapsed && (
          <Link href={`/${locale}/dashboard`} className="flex items-center gap-2">
            <div className="flex h-8 w-8 items-center justify-center rounded-lg bg-primary text-primary-foreground font-bold">
              A
            </div>
            <span className="font-semibold text-sm">ANSP Peer Review</span>
          </Link>
        )}
        {collapsed && (
          <div className="flex h-8 w-8 items-center justify-center rounded-lg bg-primary text-primary-foreground font-bold">
            A
          </div>
        )}
      </div>

      <ScrollArea className="flex-1 px-3 py-4">
        <nav className="flex flex-col gap-1">
          {navItems.map((item) => {
            const isActive = pathname.includes(item.href);
            return (
              <Link
                key={item.href}
                href={`/${locale}${item.href}`}
                className={cn(
                  "flex items-center gap-3 rounded-lg px-3 py-2 text-sm transition-colors",
                  isActive
                    ? "bg-primary text-primary-foreground"
                    : "text-muted-foreground hover:bg-muted hover:text-foreground"
                )}
              >
                <item.icon className="h-4 w-4 shrink-0" />
                {!collapsed && <span>{t(item.titleKey)}</span>}
              </Link>
            );
          })}
        </nav>
      </ScrollArea>

      <Button
        variant="ghost"
        size="icon"
        className="absolute -right-3 top-20 h-6 w-6 rounded-full border bg-background"
        onClick={() => setCollapsed(!collapsed)}
      >
        {collapsed ? <ChevronRight className="h-3 w-3" /> : <ChevronLeft className="h-3 w-3" />}
      </Button>
    </div>
  );
}

\`\`\`

# src/components/ui/alert.tsx

\`\`\`tsx
import * as React from "react"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const alertVariants = cva(
  "relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",
  {
    variants: {
      variant: {
        default: "bg-card text-card-foreground",
        destructive:
          "text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  }
)

function Alert({
  className,
  variant,
  ...props
}: React.ComponentProps<"div"> & VariantProps<typeof alertVariants>) {
  return (
    <div
      data-slot="alert"
      role="alert"
      className={cn(alertVariants({ variant }), className)}
      {...props}
    />
  )
}

function AlertTitle({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="alert-title"
      className={cn(
        "col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",
        className
      )}
      {...props}
    />
  )
}

function AlertDescription({
  className,
  ...props
}: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="alert-description"
      className={cn(
        "text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",
        className
      )}
      {...props}
    />
  )
}

export { Alert, AlertTitle, AlertDescription }

\`\`\`

# src/components/ui/avatar.tsx

\`\`\`tsx
"use client"

import * as React from "react"
import * as AvatarPrimitive from "@radix-ui/react-avatar"

import { cn } from "@/lib/utils"

function Avatar({
  className,
  ...props
}: React.ComponentProps<typeof AvatarPrimitive.Root>) {
  return (
    <AvatarPrimitive.Root
      data-slot="avatar"
      className={cn(
        "relative flex size-8 shrink-0 overflow-hidden rounded-full",
        className
      )}
      {...props}
    />
  )
}

function AvatarImage({
  className,
  ...props
}: React.ComponentProps<typeof AvatarPrimitive.Image>) {
  return (
    <AvatarPrimitive.Image
      data-slot="avatar-image"
      className={cn("aspect-square size-full", className)}
      {...props}
    />
  )
}

function AvatarFallback({
  className,
  ...props
}: React.ComponentProps<typeof AvatarPrimitive.Fallback>) {
  return (
    <AvatarPrimitive.Fallback
      data-slot="avatar-fallback"
      className={cn(
        "bg-muted flex size-full items-center justify-center rounded-full",
        className
      )}
      {...props}
    />
  )
}

export { Avatar, AvatarImage, AvatarFallback }

\`\`\`

# src/components/ui/badge.tsx

\`\`\`tsx
import * as React from "react"
import { Slot } from "@radix-ui/react-slot"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const badgeVariants = cva(
  "inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",
  {
    variants: {
      variant: {
        default:
          "border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",
        secondary:
          "border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",
        destructive:
          "border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",
        outline:
          "text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  }
)

function Badge({
  className,
  variant,
  asChild = false,
  ...props
}: React.ComponentProps<"span"> &
  VariantProps<typeof badgeVariants> & { asChild?: boolean }) {
  const Comp = asChild ? Slot : "span"

  return (
    <Comp
      data-slot="badge"
      className={cn(badgeVariants({ variant }), className)}
      {...props}
    />
  )
}

export { Badge, badgeVariants }

\`\`\`

# src/components/ui/button.tsx

\`\`\`tsx
import * as React from "react"
import { Slot } from "@radix-ui/react-slot"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const buttonVariants = cva(
  "inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",
  {
    variants: {
      variant: {
        default: "bg-primary text-primary-foreground hover:bg-primary/90",
        destructive:
          "bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",
        outline:
          "border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",
        secondary:
          "bg-secondary text-secondary-foreground hover:bg-secondary/80",
        ghost:
          "hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",
        link: "text-primary underline-offset-4 hover:underline",
      },
      size: {
        default: "h-9 px-4 py-2 has-[>svg]:px-3",
        sm: "h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",
        lg: "h-10 rounded-md px-6 has-[>svg]:px-4",
        icon: "size-9",
        "icon-sm": "size-8",
        "icon-lg": "size-10",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  }
)

function Button({
  className,
  variant = "default",
  size = "default",
  asChild = false,
  ...props
}: React.ComponentProps<"button"> &
  VariantProps<typeof buttonVariants> & {
    asChild?: boolean
  }) {
  const Comp = asChild ? Slot : "button"

  return (
    <Comp
      data-slot="button"
      data-variant={variant}
      data-size={size}
      className={cn(buttonVariants({ variant, size, className }))}
      {...props}
    />
  )
}

export { Button, buttonVariants }

\`\`\`

# src/components/ui/card.tsx

\`\`\`tsx
import * as React from "react"

import { cn } from "@/lib/utils"

function Card({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card"
      className={cn(
        "bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",
        className
      )}
      {...props}
    />
  )
}

function CardHeader({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-header"
      className={cn(
        "@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",
        className
      )}
      {...props}
    />
  )
}

function CardTitle({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-title"
      className={cn("leading-none font-semibold", className)}
      {...props}
    />
  )
}

function CardDescription({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-description"
      className={cn("text-muted-foreground text-sm", className)}
      {...props}
    />
  )
}

function CardAction({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-action"
      className={cn(
        "col-start-2 row-span-2 row-start-1 self-start justify-self-end",
        className
      )}
      {...props}
    />
  )
}

function CardContent({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-content"
      className={cn("px-6", className)}
      {...props}
    />
  )
}

function CardFooter({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-footer"
      className={cn("flex items-center px-6 [.border-t]:pt-6", className)}
      {...props}
    />
  )
}

export {
  Card,
  CardHeader,
  CardFooter,
  CardTitle,
  CardAction,
  CardDescription,
  CardContent,
}

\`\`\`

# src/components/ui/dialog.tsx

\`\`\`tsx
"use client"

import * as React from "react"
import * as DialogPrimitive from "@radix-ui/react-dialog"
import { XIcon } from "lucide-react"

import { cn } from "@/lib/utils"

function Dialog({
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Root>) {
  return <DialogPrimitive.Root data-slot="dialog" {...props} />
}

function DialogTrigger({
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Trigger>) {
  return <DialogPrimitive.Trigger data-slot="dialog-trigger" {...props} />
}

function DialogPortal({
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Portal>) {
  return <DialogPrimitive.Portal data-slot="dialog-portal" {...props} />
}

function DialogClose({
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Close>) {
  return <DialogPrimitive.Close data-slot="dialog-close" {...props} />
}

function DialogOverlay({
  className,
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Overlay>) {
  return (
    <DialogPrimitive.Overlay
      data-slot="dialog-overlay"
      className={cn(
        "data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",
        className
      )}
      {...props}
    />
  )
}

function DialogContent({
  className,
  children,
  showCloseButton = true,
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Content> & {
  showCloseButton?: boolean
}) {
  return (
    <DialogPortal data-slot="dialog-portal">
      <DialogOverlay />
      <DialogPrimitive.Content
        data-slot="dialog-content"
        className={cn(
          "bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 outline-none sm:max-w-lg",
          className
        )}
        {...props}
      >
        {children}
        {showCloseButton && (
          <DialogPrimitive.Close
            data-slot="dialog-close"
            className="ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4"
          >
            <XIcon />
            <span className="sr-only">Close</span>
          </DialogPrimitive.Close>
        )}
      </DialogPrimitive.Content>
    </DialogPortal>
  )
}

function DialogHeader({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="dialog-header"
      className={cn("flex flex-col gap-2 text-center sm:text-left", className)}
      {...props}
    />
  )
}

function DialogFooter({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="dialog-footer"
      className={cn(
        "flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",
        className
      )}
      {...props}
    />
  )
}

function DialogTitle({
  className,
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Title>) {
  return (
    <DialogPrimitive.Title
      data-slot="dialog-title"
      className={cn("text-lg leading-none font-semibold", className)}
      {...props}
    />
  )
}

function DialogDescription({
  className,
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Description>) {
  return (
    <DialogPrimitive.Description
      data-slot="dialog-description"
      className={cn("text-muted-foreground text-sm", className)}
      {...props}
    />
  )
}

export {
  Dialog,
  DialogClose,
  DialogContent,
  DialogDescription,
  DialogFooter,
  DialogHeader,
  DialogOverlay,
  DialogPortal,
  DialogTitle,
  DialogTrigger,
}

\`\`\`

# src/components/ui/dropdown-menu.tsx

\`\`\`tsx
"use client"

import * as React from "react"
import * as DropdownMenuPrimitive from "@radix-ui/react-dropdown-menu"
import { CheckIcon, ChevronRightIcon, CircleIcon } from "lucide-react"

import { cn } from "@/lib/utils"

function DropdownMenu({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Root>) {
  return <DropdownMenuPrimitive.Root data-slot="dropdown-menu" {...props} />
}

function DropdownMenuPortal({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Portal>) {
  return (
    <DropdownMenuPrimitive.Portal data-slot="dropdown-menu-portal" {...props} />
  )
}

function DropdownMenuTrigger({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Trigger>) {
  return (
    <DropdownMenuPrimitive.Trigger
      data-slot="dropdown-menu-trigger"
      {...props}
    />
  )
}

function DropdownMenuContent({
  className,
  sideOffset = 4,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Content>) {
  return (
    <DropdownMenuPrimitive.Portal>
      <DropdownMenuPrimitive.Content
        data-slot="dropdown-menu-content"
        sideOffset={sideOffset}
        className={cn(
          "bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",
          className
        )}
        {...props}
      />
    </DropdownMenuPrimitive.Portal>
  )
}

function DropdownMenuGroup({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Group>) {
  return (
    <DropdownMenuPrimitive.Group data-slot="dropdown-menu-group" {...props} />
  )
}

function DropdownMenuItem({
  className,
  inset,
  variant = "default",
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Item> & {
  inset?: boolean
  variant?: "default" | "destructive"
}) {
  return (
    <DropdownMenuPrimitive.Item
      data-slot="dropdown-menu-item"
      data-inset={inset}
      data-variant={variant}
      className={cn(
        "focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className
      )}
      {...props}
    />
  )
}

function DropdownMenuCheckboxItem({
  className,
  children,
  checked,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.CheckboxItem>) {
  return (
    <DropdownMenuPrimitive.CheckboxItem
      data-slot="dropdown-menu-checkbox-item"
      className={cn(
        "focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-sm py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className
      )}
      checked={checked}
      {...props}
    >
      <span className="pointer-events-none absolute left-2 flex size-3.5 items-center justify-center">
        <DropdownMenuPrimitive.ItemIndicator>
          <CheckIcon className="size-4" />
        </DropdownMenuPrimitive.ItemIndicator>
      </span>
      {children}
    </DropdownMenuPrimitive.CheckboxItem>
  )
}

function DropdownMenuRadioGroup({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.RadioGroup>) {
  return (
    <DropdownMenuPrimitive.RadioGroup
      data-slot="dropdown-menu-radio-group"
      {...props}
    />
  )
}

function DropdownMenuRadioItem({
  className,
  children,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.RadioItem>) {
  return (
    <DropdownMenuPrimitive.RadioItem
      data-slot="dropdown-menu-radio-item"
      className={cn(
        "focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-sm py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className
      )}
      {...props}
    >
      <span className="pointer-events-none absolute left-2 flex size-3.5 items-center justify-center">
        <DropdownMenuPrimitive.ItemIndicator>
          <CircleIcon className="size-2 fill-current" />
        </DropdownMenuPrimitive.ItemIndicator>
      </span>
      {children}
    </DropdownMenuPrimitive.RadioItem>
  )
}

function DropdownMenuLabel({
  className,
  inset,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Label> & {
  inset?: boolean
}) {
  return (
    <DropdownMenuPrimitive.Label
      data-slot="dropdown-menu-label"
      data-inset={inset}
      className={cn(
        "px-2 py-1.5 text-sm font-medium data-[inset]:pl-8",
        className
      )}
      {...props}
    />
  )
}

function DropdownMenuSeparator({
  className,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Separator>) {
  return (
    <DropdownMenuPrimitive.Separator
      data-slot="dropdown-menu-separator"
      className={cn("bg-border -mx-1 my-1 h-px", className)}
      {...props}
    />
  )
}

function DropdownMenuShortcut({
  className,
  ...props
}: React.ComponentProps<"span">) {
  return (
    <span
      data-slot="dropdown-menu-shortcut"
      className={cn(
        "text-muted-foreground ml-auto text-xs tracking-widest",
        className
      )}
      {...props}
    />
  )
}

function DropdownMenuSub({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Sub>) {
  return <DropdownMenuPrimitive.Sub data-slot="dropdown-menu-sub" {...props} />
}

function DropdownMenuSubTrigger({
  className,
  inset,
  children,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.SubTrigger> & {
  inset?: boolean
}) {
  return (
    <DropdownMenuPrimitive.SubTrigger
      data-slot="dropdown-menu-sub-trigger"
      data-inset={inset}
      className={cn(
        "focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className
      )}
      {...props}
    >
      {children}
      <ChevronRightIcon className="ml-auto size-4" />
    </DropdownMenuPrimitive.SubTrigger>
  )
}

function DropdownMenuSubContent({
  className,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.SubContent>) {
  return (
    <DropdownMenuPrimitive.SubContent
      data-slot="dropdown-menu-sub-content"
      className={cn(
        "bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-hidden rounded-md border p-1 shadow-lg",
        className
      )}
      {...props}
    />
  )
}

export {
  DropdownMenu,
  DropdownMenuPortal,
  DropdownMenuTrigger,
  DropdownMenuContent,
  DropdownMenuGroup,
  DropdownMenuLabel,
  DropdownMenuItem,
  DropdownMenuCheckboxItem,
  DropdownMenuRadioGroup,
  DropdownMenuRadioItem,
  DropdownMenuSeparator,
  DropdownMenuShortcut,
  DropdownMenuSub,
  DropdownMenuSubTrigger,
  DropdownMenuSubContent,
}

\`\`\`

# src/components/ui/form.tsx

\`\`\`tsx
"use client"

import * as React from "react"
import type * as LabelPrimitive from "@radix-ui/react-label"
import { Slot } from "@radix-ui/react-slot"
import {
  Controller,
  FormProvider,
  useFormContext,
  useFormState,
  type ControllerProps,
  type FieldPath,
  type FieldValues,
} from "react-hook-form"

import { cn } from "@/lib/utils"
import { Label } from "@/components/ui/label"

const Form = FormProvider

type FormFieldContextValue<
  TFieldValues extends FieldValues = FieldValues,
  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>,
> = {
  name: TName
}

const FormFieldContext = React.createContext<FormFieldContextValue>(
  {} as FormFieldContextValue
)

const FormField = <
  TFieldValues extends FieldValues = FieldValues,
  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>,
>({
  ...props
}: ControllerProps<TFieldValues, TName>) => {
  return (
    <FormFieldContext.Provider value={{ name: props.name }}>
      <Controller {...props} />
    </FormFieldContext.Provider>
  )
}

const useFormField = () => {
  const fieldContext = React.useContext(FormFieldContext)
  const itemContext = React.useContext(FormItemContext)
  const { getFieldState } = useFormContext()
  const formState = useFormState({ name: fieldContext.name })
  const fieldState = getFieldState(fieldContext.name, formState)

  if (!fieldContext) {
    throw new Error("useFormField should be used within <FormField>")
  }

  const { id } = itemContext

  return {
    id,
    name: fieldContext.name,
    formItemId: `${id}-form-item`,
    formDescriptionId: `${id}-form-item-description`,
    formMessageId: `${id}-form-item-message`,
    ...fieldState,
  }
}

type FormItemContextValue = {
  id: string
}

const FormItemContext = React.createContext<FormItemContextValue>(
  {} as FormItemContextValue
)

function FormItem({ className, ...props }: React.ComponentProps<"div">) {
  const id = React.useId()

  return (
    <FormItemContext.Provider value={{ id }}>
      <div
        data-slot="form-item"
        className={cn("grid gap-2", className)}
        {...props}
      />
    </FormItemContext.Provider>
  )
}

function FormLabel({
  className,
  ...props
}: React.ComponentProps<typeof LabelPrimitive.Root>) {
  const { error, formItemId } = useFormField()

  return (
    <Label
      data-slot="form-label"
      data-error={!!error}
      className={cn("data-[error=true]:text-destructive", className)}
      htmlFor={formItemId}
      {...props}
    />
  )
}

function FormControl({ ...props }: React.ComponentProps<typeof Slot>) {
  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()

  return (
    <Slot
      data-slot="form-control"
      id={formItemId}
      aria-describedby={
        !error
          ? `${formDescriptionId}`
          : `${formDescriptionId} ${formMessageId}`
      }
      aria-invalid={!!error}
      {...props}
    />
  )
}

function FormDescription({ className, ...props }: React.ComponentProps<"p">) {
  const { formDescriptionId } = useFormField()

  return (
    <p
      data-slot="form-description"
      id={formDescriptionId}
      className={cn("text-muted-foreground text-sm", className)}
      {...props}
    />
  )
}

function FormMessage({ className, ...props }: React.ComponentProps<"p">) {
  const { error, formMessageId } = useFormField()
  const body = error ? String(error?.message ?? "") : props.children

  if (!body) {
    return null
  }

  return (
    <p
      data-slot="form-message"
      id={formMessageId}
      className={cn("text-destructive text-sm", className)}
      {...props}
    >
      {body}
    </p>
  )
}

export {
  useFormField,
  Form,
  FormItem,
  FormLabel,
  FormControl,
  FormDescription,
  FormMessage,
  FormField,
}

\`\`\`

# src/components/ui/input.tsx

\`\`\`tsx
import * as React from "react"

import { cn } from "@/lib/utils"

function Input({ className, type, ...props }: React.ComponentProps<"input">) {
  return (
    <input
      type={type}
      data-slot="input"
      className={cn(
        "file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",
        "focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]",
        "aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",
        className
      )}
      {...props}
    />
  )
}

export { Input }

\`\`\`

# src/components/ui/label.tsx

\`\`\`tsx
"use client"

import * as React from "react"
import * as LabelPrimitive from "@radix-ui/react-label"

import { cn } from "@/lib/utils"

function Label({
  className,
  ...props
}: React.ComponentProps<typeof LabelPrimitive.Root>) {
  return (
    <LabelPrimitive.Root
      data-slot="label"
      className={cn(
        "flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",
        className
      )}
      {...props}
    />
  )
}

export { Label }

\`\`\`

# src/components/ui/progress.tsx

\`\`\`tsx
"use client"

import * as React from "react"
import * as ProgressPrimitive from "@radix-ui/react-progress"

import { cn } from "@/lib/utils"

function Progress({
  className,
  value,
  ...props
}: React.ComponentProps<typeof ProgressPrimitive.Root>) {
  return (
    <ProgressPrimitive.Root
      data-slot="progress"
      className={cn(
        "bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",
        className
      )}
      {...props}
    >
      <ProgressPrimitive.Indicator
        data-slot="progress-indicator"
        className="bg-primary h-full w-full flex-1 transition-all"
        style={{ transform: `translateX(-${100 - (value || 0)}%)` }}
      />
    </ProgressPrimitive.Root>
  )
}

export { Progress }

\`\`\`

# src/components/ui/scroll-area.tsx

\`\`\`tsx
"use client"

import * as React from "react"
import * as ScrollAreaPrimitive from "@radix-ui/react-scroll-area"

import { cn } from "@/lib/utils"

function ScrollArea({
  className,
  children,
  ...props
}: React.ComponentProps<typeof ScrollAreaPrimitive.Root>) {
  return (
    <ScrollAreaPrimitive.Root
      data-slot="scroll-area"
      className={cn("relative", className)}
      {...props}
    >
      <ScrollAreaPrimitive.Viewport
        data-slot="scroll-area-viewport"
        className="focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1"
      >
        {children}
      </ScrollAreaPrimitive.Viewport>
      <ScrollBar />
      <ScrollAreaPrimitive.Corner />
    </ScrollAreaPrimitive.Root>
  )
}

function ScrollBar({
  className,
  orientation = "vertical",
  ...props
}: React.ComponentProps<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>) {
  return (
    <ScrollAreaPrimitive.ScrollAreaScrollbar
      data-slot="scroll-area-scrollbar"
      orientation={orientation}
      className={cn(
        "flex touch-none p-px transition-colors select-none",
        orientation === "vertical" &&
          "h-full w-2.5 border-l border-l-transparent",
        orientation === "horizontal" &&
          "h-2.5 flex-col border-t border-t-transparent",
        className
      )}
      {...props}
    >
      <ScrollAreaPrimitive.ScrollAreaThumb
        data-slot="scroll-area-thumb"
        className="bg-border relative flex-1 rounded-full"
      />
    </ScrollAreaPrimitive.ScrollAreaScrollbar>
  )
}

export { ScrollArea, ScrollBar }

\`\`\`

# src/components/ui/select.tsx

\`\`\`tsx
"use client"

import * as React from "react"
import * as SelectPrimitive from "@radix-ui/react-select"
import { CheckIcon, ChevronDownIcon, ChevronUpIcon } from "lucide-react"

import { cn } from "@/lib/utils"

function Select({
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Root>) {
  return <SelectPrimitive.Root data-slot="select" {...props} />
}

function SelectGroup({
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Group>) {
  return <SelectPrimitive.Group data-slot="select-group" {...props} />
}

function SelectValue({
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Value>) {
  return <SelectPrimitive.Value data-slot="select-value" {...props} />
}

function SelectTrigger({
  className,
  size = "default",
  children,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Trigger> & {
  size?: "sm" | "default"
}) {
  return (
    <SelectPrimitive.Trigger
      data-slot="select-trigger"
      data-size={size}
      className={cn(
        "border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className
      )}
      {...props}
    >
      {children}
      <SelectPrimitive.Icon asChild>
        <ChevronDownIcon className="size-4 opacity-50" />
      </SelectPrimitive.Icon>
    </SelectPrimitive.Trigger>
  )
}

function SelectContent({
  className,
  children,
  position = "item-aligned",
  align = "center",
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Content>) {
  return (
    <SelectPrimitive.Portal>
      <SelectPrimitive.Content
        data-slot="select-content"
        className={cn(
          "bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",
          position === "popper" &&
            "data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",
          className
        )}
        position={position}
        align={align}
        {...props}
      >
        <SelectScrollUpButton />
        <SelectPrimitive.Viewport
          className={cn(
            "p-1",
            position === "popper" &&
              "h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"
          )}
        >
          {children}
        </SelectPrimitive.Viewport>
        <SelectScrollDownButton />
      </SelectPrimitive.Content>
    </SelectPrimitive.Portal>
  )
}

function SelectLabel({
  className,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Label>) {
  return (
    <SelectPrimitive.Label
      data-slot="select-label"
      className={cn("text-muted-foreground px-2 py-1.5 text-xs", className)}
      {...props}
    />
  )
}

function SelectItem({
  className,
  children,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Item>) {
  return (
    <SelectPrimitive.Item
      data-slot="select-item"
      className={cn(
        "focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",
        className
      )}
      {...props}
    >
      <span
        data-slot="select-item-indicator"
        className="absolute right-2 flex size-3.5 items-center justify-center"
      >
        <SelectPrimitive.ItemIndicator>
          <CheckIcon className="size-4" />
        </SelectPrimitive.ItemIndicator>
      </span>
      <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>
    </SelectPrimitive.Item>
  )
}

function SelectSeparator({
  className,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Separator>) {
  return (
    <SelectPrimitive.Separator
      data-slot="select-separator"
      className={cn("bg-border pointer-events-none -mx-1 my-1 h-px", className)}
      {...props}
    />
  )
}

function SelectScrollUpButton({
  className,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.ScrollUpButton>) {
  return (
    <SelectPrimitive.ScrollUpButton
      data-slot="select-scroll-up-button"
      className={cn(
        "flex cursor-default items-center justify-center py-1",
        className
      )}
      {...props}
    >
      <ChevronUpIcon className="size-4" />
    </SelectPrimitive.ScrollUpButton>
  )
}

function SelectScrollDownButton({
  className,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.ScrollDownButton>) {
  return (
    <SelectPrimitive.ScrollDownButton
      data-slot="select-scroll-down-button"
      className={cn(
        "flex cursor-default items-center justify-center py-1",
        className
      )}
      {...props}
    >
      <ChevronDownIcon className="size-4" />
    </SelectPrimitive.ScrollDownButton>
  )
}

export {
  Select,
  SelectContent,
  SelectGroup,
  SelectItem,
  SelectLabel,
  SelectScrollDownButton,
  SelectScrollUpButton,
  SelectSeparator,
  SelectTrigger,
  SelectValue,
}

\`\`\`

# src/components/ui/separator.tsx

\`\`\`tsx
"use client"

import * as React from "react"
import * as SeparatorPrimitive from "@radix-ui/react-separator"

import { cn } from "@/lib/utils"

function Separator({
  className,
  orientation = "horizontal",
  decorative = true,
  ...props
}: React.ComponentProps<typeof SeparatorPrimitive.Root>) {
  return (
    <SeparatorPrimitive.Root
      data-slot="separator"
      decorative={decorative}
      orientation={orientation}
      className={cn(
        "bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",
        className
      )}
      {...props}
    />
  )
}

export { Separator }

\`\`\`

# src/components/ui/sheet.tsx

\`\`\`tsx
"use client"

import * as React from "react"
import * as SheetPrimitive from "@radix-ui/react-dialog"
import { XIcon } from "lucide-react"

import { cn } from "@/lib/utils"

function Sheet({ ...props }: React.ComponentProps<typeof SheetPrimitive.Root>) {
  return <SheetPrimitive.Root data-slot="sheet" {...props} />
}

function SheetTrigger({
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Trigger>) {
  return <SheetPrimitive.Trigger data-slot="sheet-trigger" {...props} />
}

function SheetClose({
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Close>) {
  return <SheetPrimitive.Close data-slot="sheet-close" {...props} />
}

function SheetPortal({
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Portal>) {
  return <SheetPrimitive.Portal data-slot="sheet-portal" {...props} />
}

function SheetOverlay({
  className,
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Overlay>) {
  return (
    <SheetPrimitive.Overlay
      data-slot="sheet-overlay"
      className={cn(
        "data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",
        className
      )}
      {...props}
    />
  )
}

function SheetContent({
  className,
  children,
  side = "right",
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Content> & {
  side?: "top" | "right" | "bottom" | "left"
}) {
  return (
    <SheetPortal>
      <SheetOverlay />
      <SheetPrimitive.Content
        data-slot="sheet-content"
        className={cn(
          "bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500",
          side === "right" &&
            "data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm",
          side === "left" &&
            "data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm",
          side === "top" &&
            "data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b",
          side === "bottom" &&
            "data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",
          className
        )}
        {...props}
      >
        {children}
        <SheetPrimitive.Close className="ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none">
          <XIcon className="size-4" />
          <span className="sr-only">Close</span>
        </SheetPrimitive.Close>
      </SheetPrimitive.Content>
    </SheetPortal>
  )
}

function SheetHeader({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="sheet-header"
      className={cn("flex flex-col gap-1.5 p-4", className)}
      {...props}
    />
  )
}

function SheetFooter({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="sheet-footer"
      className={cn("mt-auto flex flex-col gap-2 p-4", className)}
      {...props}
    />
  )
}

function SheetTitle({
  className,
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Title>) {
  return (
    <SheetPrimitive.Title
      data-slot="sheet-title"
      className={cn("text-foreground font-semibold", className)}
      {...props}
    />
  )
}

function SheetDescription({
  className,
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Description>) {
  return (
    <SheetPrimitive.Description
      data-slot="sheet-description"
      className={cn("text-muted-foreground text-sm", className)}
      {...props}
    />
  )
}

export {
  Sheet,
  SheetTrigger,
  SheetClose,
  SheetContent,
  SheetHeader,
  SheetFooter,
  SheetTitle,
  SheetDescription,
}

\`\`\`

# src/components/ui/skeleton.tsx

\`\`\`tsx
import { cn } from "@/lib/utils"

function Skeleton({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="skeleton"
      className={cn("bg-accent animate-pulse rounded-md", className)}
      {...props}
    />
  )
}

export { Skeleton }

\`\`\`

# src/components/ui/sonner.tsx

\`\`\`tsx
"use client"

import {
  CircleCheckIcon,
  InfoIcon,
  Loader2Icon,
  OctagonXIcon,
  TriangleAlertIcon,
} from "lucide-react"
import { useTheme } from "next-themes"
import { Toaster as Sonner, type ToasterProps } from "sonner"

const Toaster = ({ ...props }: ToasterProps) => {
  const { theme = "system" } = useTheme()

  return (
    <Sonner
      theme={theme as ToasterProps["theme"]}
      className="toaster group"
      icons={{
        success: <CircleCheckIcon className="size-4" />,
        info: <InfoIcon className="size-4" />,
        warning: <TriangleAlertIcon className="size-4" />,
        error: <OctagonXIcon className="size-4" />,
        loading: <Loader2Icon className="size-4 animate-spin" />,
      }}
      style={
        {
          "--normal-bg": "var(--popover)",
          "--normal-text": "var(--popover-foreground)",
          "--normal-border": "var(--border)",
          "--border-radius": "var(--radius)",
        } as React.CSSProperties
      }
      {...props}
    />
  )
}

export { Toaster }

\`\`\`

# src/components/ui/table.tsx

\`\`\`tsx
"use client"

import * as React from "react"

import { cn } from "@/lib/utils"

function Table({ className, ...props }: React.ComponentProps<"table">) {
  return (
    <div
      data-slot="table-container"
      className="relative w-full overflow-x-auto"
    >
      <table
        data-slot="table"
        className={cn("w-full caption-bottom text-sm", className)}
        {...props}
      />
    </div>
  )
}

function TableHeader({ className, ...props }: React.ComponentProps<"thead">) {
  return (
    <thead
      data-slot="table-header"
      className={cn("[&_tr]:border-b", className)}
      {...props}
    />
  )
}

function TableBody({ className, ...props }: React.ComponentProps<"tbody">) {
  return (
    <tbody
      data-slot="table-body"
      className={cn("[&_tr:last-child]:border-0", className)}
      {...props}
    />
  )
}

function TableFooter({ className, ...props }: React.ComponentProps<"tfoot">) {
  return (
    <tfoot
      data-slot="table-footer"
      className={cn(
        "bg-muted/50 border-t font-medium [&>tr]:last:border-b-0",
        className
      )}
      {...props}
    />
  )
}

function TableRow({ className, ...props }: React.ComponentProps<"tr">) {
  return (
    <tr
      data-slot="table-row"
      className={cn(
        "hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",
        className
      )}
      {...props}
    />
  )
}

function TableHead({ className, ...props }: React.ComponentProps<"th">) {
  return (
    <th
      data-slot="table-head"
      className={cn(
        "text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",
        className
      )}
      {...props}
    />
  )
}

function TableCell({ className, ...props }: React.ComponentProps<"td">) {
  return (
    <td
      data-slot="table-cell"
      className={cn(
        "p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",
        className
      )}
      {...props}
    />
  )
}

function TableCaption({
  className,
  ...props
}: React.ComponentProps<"caption">) {
  return (
    <caption
      data-slot="table-caption"
      className={cn("text-muted-foreground mt-4 text-sm", className)}
      {...props}
    />
  )
}

export {
  Table,
  TableHeader,
  TableBody,
  TableFooter,
  TableHead,
  TableRow,
  TableCell,
  TableCaption,
}

\`\`\`

# src/components/ui/tabs.tsx

\`\`\`tsx
"use client"

import * as React from "react"
import * as TabsPrimitive from "@radix-ui/react-tabs"

import { cn } from "@/lib/utils"

function Tabs({
  className,
  ...props
}: React.ComponentProps<typeof TabsPrimitive.Root>) {
  return (
    <TabsPrimitive.Root
      data-slot="tabs"
      className={cn("flex flex-col gap-2", className)}
      {...props}
    />
  )
}

function TabsList({
  className,
  ...props
}: React.ComponentProps<typeof TabsPrimitive.List>) {
  return (
    <TabsPrimitive.List
      data-slot="tabs-list"
      className={cn(
        "bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",
        className
      )}
      {...props}
    />
  )
}

function TabsTrigger({
  className,
  ...props
}: React.ComponentProps<typeof TabsPrimitive.Trigger>) {
  return (
    <TabsPrimitive.Trigger
      data-slot="tabs-trigger"
      className={cn(
        "data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className
      )}
      {...props}
    />
  )
}

function TabsContent({
  className,
  ...props
}: React.ComponentProps<typeof TabsPrimitive.Content>) {
  return (
    <TabsPrimitive.Content
      data-slot="tabs-content"
      className={cn("flex-1 outline-none", className)}
      {...props}
    />
  )
}

export { Tabs, TabsList, TabsTrigger, TabsContent }

\`\`\`

# src/components/ui/tooltip.tsx

\`\`\`tsx
"use client"

import * as React from "react"
import * as TooltipPrimitive from "@radix-ui/react-tooltip"

import { cn } from "@/lib/utils"

function TooltipProvider({
  delayDuration = 0,
  ...props
}: React.ComponentProps<typeof TooltipPrimitive.Provider>) {
  return (
    <TooltipPrimitive.Provider
      data-slot="tooltip-provider"
      delayDuration={delayDuration}
      {...props}
    />
  )
}

function Tooltip({
  ...props
}: React.ComponentProps<typeof TooltipPrimitive.Root>) {
  return (
    <TooltipProvider>
      <TooltipPrimitive.Root data-slot="tooltip" {...props} />
    </TooltipProvider>
  )
}

function TooltipTrigger({
  ...props
}: React.ComponentProps<typeof TooltipPrimitive.Trigger>) {
  return <TooltipPrimitive.Trigger data-slot="tooltip-trigger" {...props} />
}

function TooltipContent({
  className,
  sideOffset = 0,
  children,
  ...props
}: React.ComponentProps<typeof TooltipPrimitive.Content>) {
  return (
    <TooltipPrimitive.Portal>
      <TooltipPrimitive.Content
        data-slot="tooltip-content"
        sideOffset={sideOffset}
        className={cn(
          "bg-foreground text-background animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",
          className
        )}
        {...props}
      >
        {children}
        <TooltipPrimitive.Arrow className="bg-foreground fill-foreground z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]" />
      </TooltipPrimitive.Content>
    </TooltipPrimitive.Portal>
  )
}

export { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }

\`\`\`

# src/lib/auth/config.ts

\`\`\`ts
import { type NextAuthConfig } from "next-auth";
import Credentials from "next-auth/providers/credentials";
import bcrypt from "bcryptjs";
import { db } from "@/lib/db";
import { UserRole, Locale } from "@prisma/client";

export const authConfig: NextAuthConfig = {
  session: {
    strategy: "jwt",
    maxAge: 30 * 24 * 60 * 60,
  },
  pages: {
    signIn: "/login",
    error: "/login",
  },
  callbacks: {
    async jwt({ token, user }) {
      if (user) {
        token.id = user.id;
        token.role = user.role;
        token.organizationId = user.organizationId;
        token.firstName = user.firstName;
        token.lastName = user.lastName;
        token.locale = user.locale;
      }
      return token;
    },
    async session({ session, token }) {
      if (token && session.user) {
        session.user.id = token.id as string;
        session.user.role = token.role as UserRole;
        session.user.organizationId = token.organizationId as string | null;
        session.user.firstName = token.firstName as string;
        session.user.lastName = token.lastName as string;
        session.user.locale = token.locale as Locale;
      }
      return session;
    },
  },
  providers: [
    Credentials({
      name: "credentials",
      credentials: {
        email: { label: "Email", type: "email" },
        password: { label: "Password", type: "password" },
      },
      async authorize(credentials) {
        if (!credentials?.email || !credentials?.password) {
          return null;
        }

        const user = await db.user.findUnique({
          where: { email: credentials.email as string },
          include: { organization: true },
        });

        if (!user || !user.passwordHash) {
          return null;
        }

        const isPasswordValid = await bcrypt.compare(
          credentials.password as string,
          user.passwordHash
        );

        if (!isPasswordValid) {
          return null;
        }

        await db.user.update({
          where: { id: user.id },
          data: { lastLoginAt: new Date() },
        });

        return {
          id: user.id,
          email: user.email,
          firstName: user.firstName,
          lastName: user.lastName,
          role: user.role,
          organizationId: user.organizationId,
          locale: user.locale,
        };
      },
    }),
  ],
};

\`\`\`

# src/lib/auth/index.ts

\`\`\`ts
import NextAuth from "next-auth";
import { authConfig } from "./config";

export const {
  handlers: { GET, POST },
  auth,
  signIn,
  signOut,
} = NextAuth(authConfig);

\`\`\`

# src/lib/auth/permissions.ts

\`\`\`ts
import { UserRole } from "@prisma/client";

export type Permission =
  | "users:read" | "users:create" | "users:update" | "users:delete"
  | "organizations:read" | "organizations:create" | "organizations:update" | "organizations:delete"
  | "questionnaires:read" | "questionnaires:create" | "questionnaires:update" | "questionnaires:delete"
  | "assessments:read" | "assessments:create" | "assessments:update" | "assessments:delete" | "assessments:submit"
  | "reviews:read" | "reviews:create" | "reviews:update" | "reviews:delete" | "reviews:assign-team" | "reviews:approve"
  | "findings:read" | "findings:create" | "findings:update" | "findings:delete"
  | "cap:read" | "cap:create" | "cap:update" | "cap:verify"
  | "reviewers:read" | "reviewers:create" | "reviewers:update" | "reviewers:delete"
  | "training:read" | "training:manage"
  | "reports:read" | "reports:export" | "analytics:read"
  | "system:admin" | "system:audit-logs";

export const rolePermissions: Record<UserRole, Permission[]> = {
  SUPER_ADMIN: [
    "users:read", "users:create", "users:update", "users:delete",
    "organizations:read", "organizations:create", "organizations:update", "organizations:delete",
    "questionnaires:read", "questionnaires:create", "questionnaires:update", "questionnaires:delete",
    "assessments:read", "assessments:create", "assessments:update", "assessments:delete", "assessments:submit",
    "reviews:read", "reviews:create", "reviews:update", "reviews:delete", "reviews:assign-team", "reviews:approve",
    "findings:read", "findings:create", "findings:update", "findings:delete",
    "cap:read", "cap:create", "cap:update", "cap:verify",
    "reviewers:read", "reviewers:create", "reviewers:update", "reviewers:delete",
    "training:read", "training:manage",
    "reports:read", "reports:export", "analytics:read",
    "system:admin", "system:audit-logs",
  ],
  SYSTEM_ADMIN: [
    "users:read", "users:create", "users:update",
    "organizations:read", "organizations:create", "organizations:update",
    "questionnaires:read", "questionnaires:create", "questionnaires:update",
    "assessments:read", "reviews:read", "findings:read", "cap:read",
    "reviewers:read", "reviewers:create", "reviewers:update",
    "training:read", "training:manage",
    "reports:read", "reports:export", "analytics:read",
    "system:admin", "system:audit-logs",
  ],
  STEERING_COMMITTEE: [
    "users:read", "organizations:read", "questionnaires:read",
    "assessments:read", "reviews:read", "reviews:approve",
    "findings:read", "cap:read", "reviewers:read", "training:read",
    "reports:read", "reports:export", "analytics:read",
  ],
  PROGRAMME_COORDINATOR: [
    "users:read", "users:create", "users:update", "organizations:read",
    "questionnaires:read", "assessments:read",
    "reviews:read", "reviews:create", "reviews:update", "reviews:assign-team",
    "findings:read", "cap:read", "reviewers:read", "reviewers:update",
    "training:read", "reports:read", "reports:export", "analytics:read",
  ],
  LEAD_REVIEWER: [
    "organizations:read", "questionnaires:read", "assessments:read",
    "reviews:read", "reviews:update",
    "findings:read", "findings:create", "findings:update",
    "cap:read", "cap:verify", "reviewers:read", "training:read",
    "reports:read", "reports:export",
  ],
  PEER_REVIEWER: [
    "organizations:read", "questionnaires:read", "assessments:read",
    "reviews:read", "findings:read", "findings:create",
    "cap:read", "reviewers:read", "training:read", "reports:read",
  ],
  OBSERVER: [
    "questionnaires:read", "assessments:read", "reviews:read",
    "findings:read", "training:read",
  ],
  ANSP_ADMIN: [
    "users:read", "users:create", "users:update", "questionnaires:read",
    "assessments:read", "assessments:create", "assessments:update", "assessments:submit",
    "reviews:read", "findings:read",
    "cap:read", "cap:create", "cap:update",
    "training:read", "reports:read",
  ],
  SAFETY_MANAGER: [
    "questionnaires:read",
    "assessments:read", "assessments:create", "assessments:update", "assessments:submit",
    "reviews:read", "findings:read",
    "cap:read", "cap:create", "cap:update",
    "training:read", "reports:read",
  ],
  QUALITY_MANAGER: [
    "questionnaires:read",
    "assessments:read", "assessments:create", "assessments:update",
    "reviews:read", "findings:read",
    "cap:read", "cap:create", "cap:update",
    "training:read", "reports:read",
  ],
  STAFF: [
    "questionnaires:read", "assessments:read", "training:read",
  ],
};

export function hasPermission(role: UserRole, permission: Permission): boolean {
  return rolePermissions[role]?.includes(permission) ?? false;
}

export function hasAnyPermission(role: UserRole, permissions: Permission[]): boolean {
  return permissions.some((permission) => hasPermission(role, permission));
}

export function hasAllPermissions(role: UserRole, permissions: Permission[]): boolean {
  return permissions.every((permission) => hasPermission(role, permission));
}

export function getPermissions(role: UserRole): Permission[] {
  return rolePermissions[role] ?? [];
}

\`\`\`

# src/lib/auth/rbac.ts

\`\`\`ts
import { auth } from "@/lib/auth";
import { Permission, hasPermission, hasAnyPermission } from "./permissions";
import { redirect } from "next/navigation";

export async function checkPermission(permission: Permission) {
  const session = await auth();

  if (!session?.user) {
    redirect("/login");
  }

  if (!hasPermission(session.user.role, permission)) {
    redirect("/unauthorized");
  }

  return session;
}

export async function checkAnyPermission(permissions: Permission[]) {
  const session = await auth();

  if (!session?.user) {
    redirect("/login");
  }

  if (!hasAnyPermission(session.user.role, permissions)) {
    redirect("/unauthorized");
  }

  return session;
}

export async function requireAuth() {
  const session = await auth();

  if (!session?.user) {
    redirect("/login");
  }

  return session;
}

\`\`\`

# src/lib/auth/types.ts

\`\`\`ts
import { UserRole, Locale } from "@prisma/client";
import type { DefaultSession } from "next-auth";

declare module "next-auth" {
  interface User {
    id: string;
    email: string;
    firstName: string;
    lastName: string;
    role: UserRole;
    organizationId: string | null;
    locale: Locale;
  }

  interface Session extends DefaultSession {
    user: {
      id: string;
      email: string;
      firstName: string;
      lastName: string;
      role: UserRole;
      organizationId: string | null;
      locale: Locale;
    } & DefaultSession["user"];
  }
}

\`\`\`

# src/lib/db/index.ts

\`\`\`ts
import { PrismaClient } from "@prisma/client";
import { PrismaPg } from "@prisma/adapter-pg";
import { Pool } from "pg";

const globalForPrisma = globalThis as unknown as {
  prisma: PrismaClient | undefined;
  pool: Pool | undefined;
};

function createPrismaClient() {
  const connectionString = process.env.DATABASE_URL;
  
  if (!connectionString) {
    throw new Error("DATABASE_URL environment variable is not set");
  }

  const pool = globalForPrisma.pool ?? new Pool({ connectionString });
  globalForPrisma.pool = pool;

  const adapter = new PrismaPg(pool);
  
  return new PrismaClient({ adapter });
}

export const db = globalForPrisma.prisma ?? createPrismaClient();

if (process.env.NODE_ENV !== "production") {
  globalForPrisma.prisma = db;
}

export const prisma = db;
export default db;

\`\`\`

# src/lib/i18n/request.ts

\`\`\`ts
import { getRequestConfig } from "next-intl/server";
import { routing } from "./routing";

export default getRequestConfig(async ({ requestLocale }) => {
  let locale = await requestLocale;

  // Ensure that a valid locale is used
  if (!locale || !routing.locales.includes(locale as "en" | "fr")) {
    locale = routing.defaultLocale;
  }

  return {
    locale,
    messages: (await import(`../../../messages/${locale}.json`)).default
  };
});

\`\`\`

# src/lib/i18n/routing.ts

\`\`\`ts
import { defineRouting } from "next-intl/routing";
import { createNavigation } from "next-intl/navigation";

export const routing = defineRouting({
  locales: ["en", "fr"],
  defaultLocale: "en",
});

export const { Link, redirect, usePathname, useRouter } = createNavigation(routing);

\`\`\`

# src/lib/utils.ts

\`\`\`ts
import { clsx, type ClassValue } from "clsx"
import { twMerge } from "tailwind-merge"

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs))
}

\`\`\`

# src/lib/utils/cn.ts

\`\`\`ts
import { type ClassValue, clsx } from "clsx";
import { twMerge } from "tailwind-merge";

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs));
}

\`\`\`

# src/middleware.ts

\`\`\`ts
import createMiddleware from "next-intl/middleware";
import { routing } from "@/lib/i18n/routing";

export default createMiddleware(routing);

export const config = {
  matcher: ["/((?!api|_next|_vercel|.*\\..*).*)"]
};

\`\`\`

# src/types/index.ts

\`\`\`ts
export type Locale = "EN" | "FR";
export type QuestionnaireType = "ANS_USOAP_CMA" | "SMS_CANSO_SOE";

export type USOAPAuditArea = "LEG" | "ORG" | "PEL" | "OPS" | "AIR" | "AIG" | "ANS" | "AGA" | "SSP";
export type CriticalElement = "CE_1" | "CE_2" | "CE_3" | "CE_4" | "CE_5" | "CE_6" | "CE_7" | "CE_8";
export type SMSComponent = "SAFETY_POLICY_OBJECTIVES" | "SAFETY_RISK_MANAGEMENT" | "SAFETY_ASSURANCE" | "SAFETY_PROMOTION";
export type CANSOStudyArea = "SA_1_1" | "SA_1_2" | "SA_1_3" | "SA_1_4" | "SA_1_5" | "SA_2_1" | "SA_2_2" | "SA_3_1" | "SA_3_2" | "SA_3_3" | "SA_4_1" | "SA_4_2";
export type MaturityLevel = "LEVEL_A" | "LEVEL_B" | "LEVEL_C" | "LEVEL_D" | "LEVEL_E";

export type UserRole =
  | "SUPER_ADMIN" | "SYSTEM_ADMIN" | "STEERING_COMMITTEE" | "PROGRAMME_COORDINATOR"
  | "LEAD_REVIEWER" | "PEER_REVIEWER" | "OBSERVER"
  | "ANSP_ADMIN" | "SAFETY_MANAGER" | "QUALITY_MANAGER" | "STAFF";

export type ExpertiseArea =
  | "ATS" | "AIM_AIS" | "MET" | "CNS" | "PANS_OPS" | "SAR"
  | "SMS_POLICY" | "SMS_RISK" | "SMS_ASSURANCE" | "SMS_PROMOTION"
  | "AERODROME" | "RFF" | "ENGINEERING" | "QMS" | "TRAINING" | "HUMAN_FACTORS";

export interface BilingualContent {
  en: string;
  fr: string;
}

\`\`\`

# tsconfig.json

\`\`\`json
{
  "compilerOptions": {
    "target": "ES2017",
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "react-jsx",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "paths": {
      "@/*": ["./src/*"]
    }
  },
  "include": [
    "next-env.d.ts",
    "**/*.ts",
    "**/*.tsx",
    ".next/types/**/*.ts",
    ".next/dev/types/**/*.ts",
    "**/*.mts"
  ],
  "exclude": ["node_modules"]
}

\`\`\`

# tsconfig.tsbuildinfo

\`\`\`tsbuildinfo
{"fileNames":["./node_modules/typescript/lib/lib.es5.d.ts","./node_modules/typescript/lib/lib.es2015.d.ts","./node_modules/typescript/lib/lib.es2016.d.ts","./node_modules/typescript/lib/lib.es2017.d.ts","./node_modules/typescript/lib/lib.es2018.d.ts","./node_modules/typescript/lib/lib.es2019.d.ts","./node_modules/typescript/lib/lib.es2020.d.ts","./node_modules/typescript/lib/lib.es2021.d.ts","./node_modules/typescript/lib/lib.es2022.d.ts","./node_modules/typescript/lib/lib.es2023.d.ts","./node_modules/typescript/lib/lib.es2024.d.ts","./node_modules/typescript/lib/lib.esnext.d.ts","./node_modules/typescript/lib/lib.dom.d.ts","./node_modules/typescript/lib/lib.dom.iterable.d.ts","./node_modules/typescript/lib/lib.es2015.core.d.ts","./node_modules/typescript/lib/lib.es2015.collection.d.ts","./node_modules/typescript/lib/lib.es2015.generator.d.ts","./node_modules/typescript/lib/lib.es2015.iterable.d.ts","./node_modules/typescript/lib/lib.es2015.promise.d.ts","./node_modules/typescript/lib/lib.es2015.proxy.d.ts","./node_modules/typescript/lib/lib.es2015.reflect.d.ts","./node_modules/typescript/lib/lib.es2015.symbol.d.ts","./node_modules/typescript/lib/lib.es2015.symbol.wellknown.d.ts","./node_modules/typescript/lib/lib.es2016.array.include.d.ts","./node_modules/typescript/lib/lib.es2016.intl.d.ts","./node_modules/typescript/lib/lib.es2017.arraybuffer.d.ts","./node_modules/typescript/lib/lib.es2017.date.d.ts","./node_modules/typescript/lib/lib.es2017.object.d.ts","./node_modules/typescript/lib/lib.es2017.sharedmemory.d.ts","./node_modules/typescript/lib/lib.es2017.string.d.ts","./node_modules/typescript/lib/lib.es2017.intl.d.ts","./node_modules/typescript/lib/lib.es2017.typedarrays.d.ts","./node_modules/typescript/lib/lib.es2018.asyncgenerator.d.ts","./node_modules/typescript/lib/lib.es2018.asynciterable.d.ts","./node_modules/typescript/lib/lib.es2018.intl.d.ts","./node_modules/typescript/lib/lib.es2018.promise.d.ts","./node_modules/typescript/lib/lib.es2018.regexp.d.ts","./node_modules/typescript/lib/lib.es2019.array.d.ts","./node_modules/typescript/lib/lib.es2019.object.d.ts","./node_modules/typescript/lib/lib.es2019.string.d.ts","./node_modules/typescript/lib/lib.es2019.symbol.d.ts","./node_modules/typescript/lib/lib.es2019.intl.d.ts","./node_modules/typescript/lib/lib.es2020.bigint.d.ts","./node_modules/typescript/lib/lib.es2020.date.d.ts","./node_modules/typescript/lib/lib.es2020.promise.d.ts","./node_modules/typescript/lib/lib.es2020.sharedmemory.d.ts","./node_modules/typescript/lib/lib.es2020.string.d.ts","./node_modules/typescript/lib/lib.es2020.symbol.wellknown.d.ts","./node_modules/typescript/lib/lib.es2020.intl.d.ts","./node_modules/typescript/lib/lib.es2020.number.d.ts","./node_modules/typescript/lib/lib.es2021.promise.d.ts","./node_modules/typescript/lib/lib.es2021.string.d.ts","./node_modules/typescript/lib/lib.es2021.weakref.d.ts","./node_modules/typescript/lib/lib.es2021.intl.d.ts","./node_modules/typescript/lib/lib.es2022.array.d.ts","./node_modules/typescript/lib/lib.es2022.error.d.ts","./node_modules/typescript/lib/lib.es2022.intl.d.ts","./node_modules/typescript/lib/lib.es2022.object.d.ts","./node_modules/typescript/lib/lib.es2022.string.d.ts","./node_modules/typescript/lib/lib.es2022.regexp.d.ts","./node_modules/typescript/lib/lib.es2023.array.d.ts","./node_modules/typescript/lib/lib.es2023.collection.d.ts","./node_modules/typescript/lib/lib.es2023.intl.d.ts","./node_modules/typescript/lib/lib.es2024.arraybuffer.d.ts","./node_modules/typescript/lib/lib.es2024.collection.d.ts","./node_modules/typescript/lib/lib.es2024.object.d.ts","./node_modules/typescript/lib/lib.es2024.promise.d.ts","./node_modules/typescript/lib/lib.es2024.regexp.d.ts","./node_modules/typescript/lib/lib.es2024.sharedmemory.d.ts","./node_modules/typescript/lib/lib.es2024.string.d.ts","./node_modules/typescript/lib/lib.esnext.array.d.ts","./node_modules/typescript/lib/lib.esnext.collection.d.ts","./node_modules/typescript/lib/lib.esnext.intl.d.ts","./node_modules/typescript/lib/lib.esnext.disposable.d.ts","./node_modules/typescript/lib/lib.esnext.promise.d.ts","./node_modules/typescript/lib/lib.esnext.decorators.d.ts","./node_modules/typescript/lib/lib.esnext.iterator.d.ts","./node_modules/typescript/lib/lib.esnext.float16.d.ts","./node_modules/typescript/lib/lib.esnext.error.d.ts","./node_modules/typescript/lib/lib.esnext.sharedmemory.d.ts","./node_modules/typescript/lib/lib.decorators.d.ts","./node_modules/typescript/lib/lib.decorators.legacy.d.ts","./node_modules/@types/react/global.d.ts","./node_modules/csstype/index.d.ts","./node_modules/@types/react/index.d.ts","./node_modules/next/dist/styled-jsx/types/css.d.ts","./node_modules/next/dist/styled-jsx/types/macro.d.ts","./node_modules/next/dist/styled-jsx/types/style.d.ts","./node_modules/next/dist/styled-jsx/types/global.d.ts","./node_modules/next/dist/styled-jsx/types/index.d.ts","./node_modules/next/dist/server/get-page-files.d.ts","./node_modules/@types/node/compatibility/disposable.d.ts","./node_modules/@types/node/compatibility/indexable.d.ts","./node_modules/@types/node/compatibility/iterators.d.ts","./node_modules/@types/node/compatibility/index.d.ts","./node_modules/@types/node/globals.typedarray.d.ts","./node_modules/@types/node/buffer.buffer.d.ts","./node_modules/@types/node/globals.d.ts","./node_modules/@types/node/web-globals/abortcontroller.d.ts","./node_modules/@types/node/web-globals/domexception.d.ts","./node_modules/@types/node/web-globals/events.d.ts","./node_modules/undici-types/header.d.ts","./node_modules/undici-types/readable.d.ts","./node_modules/undici-types/file.d.ts","./node_modules/undici-types/fetch.d.ts","./node_modules/undici-types/formdata.d.ts","./node_modules/undici-types/connector.d.ts","./node_modules/undici-types/client.d.ts","./node_modules/undici-types/errors.d.ts","./node_modules/undici-types/dispatcher.d.ts","./node_modules/undici-types/global-dispatcher.d.ts","./node_modules/undici-types/global-origin.d.ts","./node_modules/undici-types/pool-stats.d.ts","./node_modules/undici-types/pool.d.ts","./node_modules/undici-types/handlers.d.ts","./node_modules/undici-types/balanced-pool.d.ts","./node_modules/undici-types/agent.d.ts","./node_modules/undici-types/mock-interceptor.d.ts","./node_modules/undici-types/mock-agent.d.ts","./node_modules/undici-types/mock-client.d.ts","./node_modules/undici-types/mock-pool.d.ts","./node_modules/undici-types/mock-errors.d.ts","./node_modules/undici-types/proxy-agent.d.ts","./node_modules/undici-types/env-http-proxy-agent.d.ts","./node_modules/undici-types/retry-handler.d.ts","./node_modules/undici-types/retry-agent.d.ts","./node_modules/undici-types/api.d.ts","./node_modules/undici-types/interceptors.d.ts","./node_modules/undici-types/util.d.ts","./node_modules/undici-types/cookies.d.ts","./node_modules/undici-types/patch.d.ts","./node_modules/undici-types/websocket.d.ts","./node_modules/undici-types/eventsource.d.ts","./node_modules/undici-types/filereader.d.ts","./node_modules/undici-types/diagnostics-channel.d.ts","./node_modules/undici-types/content-type.d.ts","./node_modules/undici-types/cache.d.ts","./node_modules/undici-types/index.d.ts","./node_modules/@types/node/web-globals/fetch.d.ts","./node_modules/@types/node/assert.d.ts","./node_modules/@types/node/assert/strict.d.ts","./node_modules/@types/node/async_hooks.d.ts","./node_modules/@types/node/buffer.d.ts","./node_modules/@types/node/child_process.d.ts","./node_modules/@types/node/cluster.d.ts","./node_modules/@types/node/console.d.ts","./node_modules/@types/node/constants.d.ts","./node_modules/@types/node/crypto.d.ts","./node_modules/@types/node/dgram.d.ts","./node_modules/@types/node/diagnostics_channel.d.ts","./node_modules/@types/node/dns.d.ts","./node_modules/@types/node/dns/promises.d.ts","./node_modules/@types/node/domain.d.ts","./node_modules/@types/node/events.d.ts","./node_modules/@types/node/fs.d.ts","./node_modules/@types/node/fs/promises.d.ts","./node_modules/@types/node/http.d.ts","./node_modules/@types/node/http2.d.ts","./node_modules/@types/node/https.d.ts","./node_modules/@types/node/inspector.generated.d.ts","./node_modules/@types/node/module.d.ts","./node_modules/@types/node/net.d.ts","./node_modules/@types/node/os.d.ts","./node_modules/@types/node/path.d.ts","./node_modules/@types/node/perf_hooks.d.ts","./node_modules/@types/node/process.d.ts","./node_modules/@types/node/punycode.d.ts","./node_modules/@types/node/querystring.d.ts","./node_modules/@types/node/readline.d.ts","./node_modules/@types/node/readline/promises.d.ts","./node_modules/@types/node/repl.d.ts","./node_modules/@types/node/sea.d.ts","./node_modules/@types/node/stream.d.ts","./node_modules/@types/node/stream/promises.d.ts","./node_modules/@types/node/stream/consumers.d.ts","./node_modules/@types/node/stream/web.d.ts","./node_modules/@types/node/string_decoder.d.ts","./node_modules/@types/node/test.d.ts","./node_modules/@types/node/timers.d.ts","./node_modules/@types/node/timers/promises.d.ts","./node_modules/@types/node/tls.d.ts","./node_modules/@types/node/trace_events.d.ts","./node_modules/@types/node/tty.d.ts","./node_modules/@types/node/url.d.ts","./node_modules/@types/node/util.d.ts","./node_modules/@types/node/v8.d.ts","./node_modules/@types/node/vm.d.ts","./node_modules/@types/node/wasi.d.ts","./node_modules/@types/node/worker_threads.d.ts","./node_modules/@types/node/zlib.d.ts","./node_modules/@types/node/index.d.ts","./node_modules/@types/react/canary.d.ts","./node_modules/@types/react/experimental.d.ts","./node_modules/@types/react-dom/index.d.ts","./node_modules/@types/react-dom/canary.d.ts","./node_modules/@types/react-dom/experimental.d.ts","./node_modules/next/dist/lib/fallback.d.ts","./node_modules/next/dist/compiled/webpack/webpack.d.ts","./node_modules/next/dist/shared/lib/modern-browserslist-target.d.ts","./node_modules/next/dist/shared/lib/entry-constants.d.ts","./node_modules/next/dist/shared/lib/constants.d.ts","./node_modules/next/dist/server/config.d.ts","./node_modules/next/dist/lib/load-custom-routes.d.ts","./node_modules/next/dist/shared/lib/image-config.d.ts","./node_modules/next/dist/build/webpack/plugins/subresource-integrity-plugin.d.ts","./node_modules/next/dist/server/body-streams.d.ts","./node_modules/next/dist/server/lib/cache-control.d.ts","./node_modules/next/dist/lib/setup-exception-listeners.d.ts","./node_modules/next/dist/lib/worker.d.ts","./node_modules/next/dist/lib/constants.d.ts","./node_modules/next/dist/lib/bundler.d.ts","./node_modules/next/dist/server/lib/experimental/ppr.d.ts","./node_modules/next/dist/lib/page-types.d.ts","./node_modules/next/dist/build/segment-config/app/app-segment-config.d.ts","./node_modules/next/dist/build/segment-config/pages/pages-segment-config.d.ts","./node_modules/next/dist/build/analysis/get-page-static-info.d.ts","./node_modules/next/dist/build/webpack/loaders/get-module-build-info.d.ts","./node_modules/next/dist/build/webpack/plugins/middleware-plugin.d.ts","./node_modules/next/dist/server/require-hook.d.ts","./node_modules/next/dist/server/node-polyfill-crypto.d.ts","./node_modules/next/dist/server/node-environment-baseline.d.ts","./node_modules/next/dist/server/node-environment-extensions/error-inspect.d.ts","./node_modules/next/dist/server/node-environment-extensions/console-file.d.ts","./node_modules/next/dist/server/node-environment-extensions/console-exit.d.ts","./node_modules/next/dist/server/node-environment-extensions/console-dim.external.d.ts","./node_modules/next/dist/server/node-environment-extensions/unhandled-rejection.d.ts","./node_modules/next/dist/server/node-environment-extensions/random.d.ts","./node_modules/next/dist/server/node-environment-extensions/date.d.ts","./node_modules/next/dist/server/node-environment-extensions/web-crypto.d.ts","./node_modules/next/dist/server/node-environment-extensions/node-crypto.d.ts","./node_modules/next/dist/server/node-environment-extensions/fast-set-immediate.external.d.ts","./node_modules/next/dist/server/node-environment.d.ts","./node_modules/next/dist/build/page-extensions-type.d.ts","./node_modules/next/dist/server/route-kind.d.ts","./node_modules/next/dist/server/route-definitions/route-definition.d.ts","./node_modules/next/dist/server/route-definitions/app-page-route-definition.d.ts","./node_modules/next/dist/server/lib/cache-handlers/types.d.ts","./node_modules/next/dist/server/response-cache/types.d.ts","./node_modules/next/dist/server/resume-data-cache/cache-store.d.ts","./node_modules/next/dist/server/resume-data-cache/resume-data-cache.d.ts","./node_modules/next/dist/client/components/app-router-headers.d.ts","./node_modules/next/dist/server/render-result.d.ts","./node_modules/next/dist/server/instrumentation/types.d.ts","./node_modules/next/dist/lib/coalesced-function.d.ts","./node_modules/next/dist/shared/lib/router/utils/middleware-route-matcher.d.ts","./node_modules/next/dist/server/lib/router-utils/types.d.ts","./node_modules/next/dist/trace/types.d.ts","./node_modules/next/dist/trace/trace.d.ts","./node_modules/next/dist/trace/shared.d.ts","./node_modules/next/dist/trace/index.d.ts","./node_modules/next/dist/build/load-jsconfig.d.ts","./node_modules/@next/env/dist/index.d.ts","./node_modules/next/dist/build/webpack/plugins/telemetry-plugin/use-cache-tracker-utils.d.ts","./node_modules/next/dist/build/webpack/plugins/telemetry-plugin/telemetry-plugin.d.ts","./node_modules/next/dist/telemetry/storage.d.ts","./node_modules/next/dist/build/build-context.d.ts","./node_modules/next/dist/shared/lib/bloom-filter.d.ts","./node_modules/next/dist/build/webpack-config.d.ts","./node_modules/next/dist/build/swc/generated-native.d.ts","./node_modules/next/dist/build/swc/types.d.ts","./node_modules/next/dist/server/dev/parse-version-info.d.ts","./node_modules/next/dist/next-devtools/shared/types.d.ts","./node_modules/next/dist/server/dev/dev-indicator-server-state.d.ts","./node_modules/next/dist/next-devtools/dev-overlay/cache-indicator.d.ts","./node_modules/next/dist/server/lib/parse-stack.d.ts","./node_modules/next/dist/next-devtools/server/shared.d.ts","./node_modules/next/dist/next-devtools/shared/stack-frame.d.ts","./node_modules/next/dist/next-devtools/dev-overlay/utils/get-error-by-type.d.ts","./node_modules/@types/react/jsx-runtime.d.ts","./node_modules/next/dist/next-devtools/dev-overlay/container/runtime-error/render-error.d.ts","./node_modules/next/dist/next-devtools/dev-overlay/shared.d.ts","./node_modules/next/dist/server/dev/debug-channel.d.ts","./node_modules/next/dist/server/dev/hot-reloader-types.d.ts","./node_modules/next/dist/server/lib/i18n-provider.d.ts","./node_modules/next/dist/server/web/next-url.d.ts","./node_modules/next/dist/compiled/@edge-runtime/cookies/index.d.ts","./node_modules/next/dist/server/web/spec-extension/cookies.d.ts","./node_modules/next/dist/server/web/spec-extension/request.d.ts","./node_modules/next/dist/server/after/builtin-request-context.d.ts","./node_modules/next/dist/server/web/spec-extension/fetch-event.d.ts","./node_modules/next/dist/server/web/spec-extension/response.d.ts","./node_modules/next/dist/build/segment-config/middleware/middleware-config.d.ts","./node_modules/next/dist/server/web/types.d.ts","./node_modules/next/dist/build/webpack/plugins/pages-manifest-plugin.d.ts","./node_modules/next/dist/shared/lib/router/utils/parse-url.d.ts","./node_modules/next/dist/server/route-definitions/locale-route-definition.d.ts","./node_modules/next/dist/server/route-definitions/pages-route-definition.d.ts","./node_modules/next/dist/build/webpack/plugins/flight-manifest-plugin.d.ts","./node_modules/next/dist/build/webpack/plugins/next-font-manifest-plugin.d.ts","./node_modules/next/dist/shared/lib/deep-readonly.d.ts","./node_modules/next/dist/next-devtools/userspace/pages/pages-dev-overlay-setup.d.ts","./node_modules/next/dist/server/render.d.ts","./node_modules/next/dist/shared/lib/mitt.d.ts","./node_modules/next/dist/client/with-router.d.ts","./node_modules/next/dist/client/router.d.ts","./node_modules/next/dist/client/route-loader.d.ts","./node_modules/next/dist/client/page-loader.d.ts","./node_modules/next/dist/shared/lib/router/router.d.ts","./node_modules/next/dist/shared/lib/router-context.shared-runtime.d.ts","./node_modules/next/dist/shared/lib/loadable-context.shared-runtime.d.ts","./node_modules/next/dist/shared/lib/loadable.shared-runtime.d.ts","./node_modules/next/dist/shared/lib/image-config-context.shared-runtime.d.ts","./node_modules/next/dist/client/components/readonly-url-search-params.d.ts","./node_modules/next/dist/shared/lib/hooks-client-context.shared-runtime.d.ts","./node_modules/next/dist/shared/lib/head-manager-context.shared-runtime.d.ts","./node_modules/next/dist/shared/lib/app-router-types.d.ts","./node_modules/next/dist/client/flight-data-helpers.d.ts","./node_modules/next/dist/client/components/router-reducer/ppr-navigations.d.ts","./node_modules/next/dist/client/components/segment-cache/types.d.ts","./node_modules/next/dist/client/components/segment-cache/navigation.d.ts","./node_modules/next/dist/client/components/segment-cache/cache-key.d.ts","./node_modules/next/dist/client/components/router-reducer/fetch-server-response.d.ts","./node_modules/next/dist/client/components/router-reducer/router-reducer-types.d.ts","./node_modules/next/dist/shared/lib/app-router-context.shared-runtime.d.ts","./node_modules/next/dist/shared/lib/server-inserted-html.shared-runtime.d.ts","./node_modules/next/dist/server/route-modules/pages/vendored/contexts/entrypoints.d.ts","./node_modules/next/dist/server/route-modules/pages/module.compiled.d.ts","./node_modules/next/dist/build/templates/pages.d.ts","./node_modules/next/dist/server/route-modules/pages/module.d.ts","./node_modules/next/dist/server/route-modules/pages/builtin/_error.d.ts","./node_modules/next/dist/server/load-default-error-components.d.ts","./node_modules/next/dist/server/base-http/node.d.ts","./node_modules/next/dist/server/response-cache/index.d.ts","./node_modules/next/dist/server/route-definitions/pages-api-route-definition.d.ts","./node_modules/next/dist/server/route-matches/pages-api-route-match.d.ts","./node_modules/next/dist/server/route-matchers/route-matcher.d.ts","./node_modules/next/dist/server/route-matcher-providers/route-matcher-provider.d.ts","./node_modules/next/dist/server/route-matcher-managers/route-matcher-manager.d.ts","./node_modules/next/dist/server/normalizers/normalizer.d.ts","./node_modules/next/dist/server/normalizers/locale-route-normalizer.d.ts","./node_modules/next/dist/server/normalizers/request/pathname-normalizer.d.ts","./node_modules/next/dist/server/normalizers/request/suffix.d.ts","./node_modules/next/dist/server/normalizers/request/rsc.d.ts","./node_modules/next/dist/server/normalizers/request/next-data.d.ts","./node_modules/next/dist/server/normalizers/request/segment-prefix-rsc.d.ts","./node_modules/next/dist/build/static-paths/types.d.ts","./node_modules/next/dist/server/base-server.d.ts","./node_modules/next/dist/server/lib/async-callback-set.d.ts","./node_modules/next/dist/shared/lib/router/utils/route-regex.d.ts","./node_modules/next/dist/shared/lib/router/utils/route-matcher.d.ts","./node_modules/sharp/lib/index.d.ts","./node_modules/next/dist/server/image-optimizer.d.ts","./node_modules/next/dist/server/next-server.d.ts","./node_modules/next/dist/server/lib/types.d.ts","./node_modules/next/dist/server/lib/lru-cache.d.ts","./node_modules/next/dist/server/lib/dev-bundler-service.d.ts","./node_modules/next/dist/server/use-cache/cache-life.d.ts","./node_modules/next/dist/server/dev/static-paths-worker.d.ts","./node_modules/next/dist/server/dev/next-dev-server.d.ts","./node_modules/next/dist/server/next.d.ts","./node_modules/next/dist/server/lib/render-server.d.ts","./node_modules/next/dist/server/lib/router-server.d.ts","./node_modules/next/dist/shared/lib/router/utils/path-match.d.ts","./node_modules/next/dist/server/lib/router-utils/filesystem.d.ts","./node_modules/next/dist/server/lib/router-utils/setup-dev-bundler.d.ts","./node_modules/next/dist/server/lib/router-utils/router-server-context.d.ts","./node_modules/next/dist/server/route-modules/route-module.d.ts","./node_modules/next/dist/server/load-components.d.ts","./node_modules/next/dist/server/web/adapter.d.ts","./node_modules/next/dist/server/app-render/types.d.ts","./node_modules/next/dist/build/webpack/loaders/metadata/types.d.ts","./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.d.ts","./node_modules/next/dist/server/lib/app-dir-module.d.ts","./node_modules/next/dist/server/web/spec-extension/adapters/request-cookies.d.ts","./node_modules/next/dist/server/async-storage/draft-mode-provider.d.ts","./node_modules/next/dist/server/web/spec-extension/adapters/headers.d.ts","./node_modules/next/dist/server/app-render/cache-signal.d.ts","./node_modules/next/dist/server/app-render/dynamic-rendering.d.ts","./node_modules/next/dist/server/request/fallback-params.d.ts","./node_modules/next/dist/server/app-render/work-unit-async-storage-instance.d.ts","./node_modules/next/dist/server/lib/lazy-result.d.ts","./node_modules/next/dist/server/lib/implicit-tags.d.ts","./node_modules/next/dist/server/app-render/staged-rendering.d.ts","./node_modules/next/dist/server/app-render/work-unit-async-storage.external.d.ts","./node_modules/next/dist/shared/lib/router/utils/parse-relative-url.d.ts","./node_modules/next/dist/server/app-render/app-render.d.ts","./node_modules/next/dist/server/route-modules/app-page/vendored/contexts/entrypoints.d.ts","./node_modules/next/dist/client/components/error-boundary.d.ts","./node_modules/next/dist/client/components/layout-router.d.ts","./node_modules/next/dist/client/components/render-from-template-context.d.ts","./node_modules/next/dist/server/app-render/action-async-storage-instance.d.ts","./node_modules/next/dist/server/app-render/action-async-storage.external.d.ts","./node_modules/next/dist/client/components/client-page.d.ts","./node_modules/next/dist/client/components/client-segment.d.ts","./node_modules/next/dist/server/request/search-params.d.ts","./node_modules/next/dist/client/components/hooks-server-context.d.ts","./node_modules/next/dist/client/components/http-access-fallback/error-boundary.d.ts","./node_modules/next/dist/lib/metadata/types/alternative-urls-types.d.ts","./node_modules/next/dist/lib/metadata/types/extra-types.d.ts","./node_modules/next/dist/lib/metadata/types/metadata-types.d.ts","./node_modules/next/dist/lib/metadata/types/manifest-types.d.ts","./node_modules/next/dist/lib/metadata/types/opengraph-types.d.ts","./node_modules/next/dist/lib/metadata/types/twitter-types.d.ts","./node_modules/next/dist/lib/metadata/types/metadata-interface.d.ts","./node_modules/next/dist/lib/metadata/types/resolvers.d.ts","./node_modules/next/dist/lib/metadata/types/icons.d.ts","./node_modules/next/dist/lib/metadata/resolve-metadata.d.ts","./node_modules/next/dist/lib/metadata/metadata.d.ts","./node_modules/next/dist/lib/framework/boundary-components.d.ts","./node_modules/next/dist/server/app-render/rsc/preloads.d.ts","./node_modules/next/dist/server/app-render/rsc/postpone.d.ts","./node_modules/next/dist/server/app-render/rsc/taint.d.ts","./node_modules/next/dist/shared/lib/segment-cache/segment-value-encoding.d.ts","./node_modules/next/dist/server/app-render/collect-segment-data.d.ts","./node_modules/next/dist/next-devtools/userspace/app/segment-explorer-node.d.ts","./node_modules/next/dist/server/app-render/entry-base.d.ts","./node_modules/next/dist/build/templates/app-page.d.ts","./node_modules/next/dist/build/rendering-mode.d.ts","./node_modules/@types/react/jsx-dev-runtime.d.ts","./node_modules/@types/react/compiler-runtime.d.ts","./node_modules/next/dist/server/route-modules/app-page/vendored/rsc/entrypoints.d.ts","./node_modules/@types/react-dom/client.d.ts","./node_modules/@types/react-dom/static.d.ts","./node_modules/@types/react-dom/server.d.ts","./node_modules/next/dist/server/route-modules/app-page/vendored/ssr/entrypoints.d.ts","./node_modules/next/dist/server/route-modules/app-page/module.d.ts","./node_modules/next/dist/server/route-modules/app-page/module.compiled.d.ts","./node_modules/next/dist/server/route-definitions/app-route-route-definition.d.ts","./node_modules/next/dist/server/async-storage/work-store.d.ts","./node_modules/next/dist/server/web/http.d.ts","./node_modules/next/dist/server/route-modules/app-route/shared-modules.d.ts","./node_modules/next/dist/client/components/redirect-status-code.d.ts","./node_modules/next/dist/client/components/redirect-error.d.ts","./node_modules/next/dist/build/templates/app-route.d.ts","./node_modules/next/dist/server/route-modules/app-route/module.d.ts","./node_modules/next/dist/server/route-modules/app-route/module.compiled.d.ts","./node_modules/next/dist/build/segment-config/app/app-segments.d.ts","./node_modules/next/dist/build/utils.d.ts","./node_modules/next/dist/server/lib/router-utils/build-prefetch-segment-data-route.d.ts","./node_modules/next/dist/build/turborepo-access-trace/types.d.ts","./node_modules/next/dist/build/turborepo-access-trace/result.d.ts","./node_modules/next/dist/build/turborepo-access-trace/helpers.d.ts","./node_modules/next/dist/build/turborepo-access-trace/index.d.ts","./node_modules/next/dist/export/routes/types.d.ts","./node_modules/next/dist/export/types.d.ts","./node_modules/next/dist/export/worker.d.ts","./node_modules/next/dist/build/worker.d.ts","./node_modules/next/dist/build/index.d.ts","./node_modules/next/dist/server/lib/incremental-cache/index.d.ts","./node_modules/next/dist/server/after/after.d.ts","./node_modules/next/dist/server/after/after-context.d.ts","./node_modules/next/dist/server/app-render/work-async-storage-instance.d.ts","./node_modules/next/dist/server/app-render/create-error-handler.d.ts","./node_modules/next/dist/shared/lib/action-revalidation-kind.d.ts","./node_modules/next/dist/server/app-render/work-async-storage.external.d.ts","./node_modules/next/dist/server/request/params.d.ts","./node_modules/next/dist/server/route-matches/route-match.d.ts","./node_modules/next/dist/server/request-meta.d.ts","./node_modules/next/dist/cli/next-test.d.ts","./node_modules/next/dist/server/config-shared.d.ts","./node_modules/next/dist/server/base-http/index.d.ts","./node_modules/next/dist/server/api-utils/index.d.ts","./node_modules/next/dist/build/adapter/build-complete.d.ts","./node_modules/next/dist/types.d.ts","./node_modules/next/dist/shared/lib/html-context.shared-runtime.d.ts","./node_modules/next/dist/shared/lib/utils.d.ts","./node_modules/next/dist/pages/_app.d.ts","./node_modules/next/app.d.ts","./node_modules/next/dist/server/web/spec-extension/unstable-cache.d.ts","./node_modules/next/dist/server/web/spec-extension/revalidate.d.ts","./node_modules/next/dist/server/web/spec-extension/unstable-no-store.d.ts","./node_modules/next/dist/server/use-cache/cache-tag.d.ts","./node_modules/next/cache.d.ts","./node_modules/next/dist/pages/_document.d.ts","./node_modules/next/document.d.ts","./node_modules/next/dist/shared/lib/dynamic.d.ts","./node_modules/next/dynamic.d.ts","./node_modules/next/dist/pages/_error.d.ts","./node_modules/next/error.d.ts","./node_modules/next/dist/shared/lib/head.d.ts","./node_modules/next/head.d.ts","./node_modules/next/dist/server/request/cookies.d.ts","./node_modules/next/dist/server/request/headers.d.ts","./node_modules/next/dist/server/request/draft-mode.d.ts","./node_modules/next/headers.d.ts","./node_modules/next/dist/shared/lib/get-img-props.d.ts","./node_modules/next/dist/client/image-component.d.ts","./node_modules/next/dist/shared/lib/image-external.d.ts","./node_modules/next/image.d.ts","./node_modules/next/dist/client/link.d.ts","./node_modules/next/link.d.ts","./node_modules/next/dist/client/components/unrecognized-action-error.d.ts","./node_modules/next/dist/client/components/redirect.d.ts","./node_modules/next/dist/client/components/not-found.d.ts","./node_modules/next/dist/client/components/forbidden.d.ts","./node_modules/next/dist/client/components/unauthorized.d.ts","./node_modules/next/dist/client/components/unstable-rethrow.server.d.ts","./node_modules/next/dist/client/components/unstable-rethrow.d.ts","./node_modules/next/dist/client/components/navigation.react-server.d.ts","./node_modules/next/dist/client/components/navigation.d.ts","./node_modules/next/navigation.d.ts","./node_modules/next/router.d.ts","./node_modules/next/dist/client/script.d.ts","./node_modules/next/script.d.ts","./node_modules/next/dist/server/web/spec-extension/user-agent.d.ts","./node_modules/next/dist/compiled/@edge-runtime/primitives/url.d.ts","./node_modules/next/dist/server/web/spec-extension/image-response.d.ts","./node_modules/next/dist/compiled/@vercel/og/satori/index.d.ts","./node_modules/next/dist/compiled/@vercel/og/emoji/index.d.ts","./node_modules/next/dist/compiled/@vercel/og/types.d.ts","./node_modules/next/dist/server/after/index.d.ts","./node_modules/next/dist/server/request/connection.d.ts","./node_modules/next/server.d.ts","./node_modules/next/types/global.d.ts","./node_modules/next/types/compiled.d.ts","./node_modules/next/types.d.ts","./node_modules/next/index.d.ts","./node_modules/next/image-types/global.d.ts","./.next/dev/types/routes.d.ts","./next-env.d.ts","./node_modules/next-intl/dist/types/extractor/types.d.ts","./node_modules/next-intl/dist/types/extractor/format/ExtractorCodec.d.ts","./node_modules/next-intl/dist/types/extractor/format/codecs/JSONCodec.d.ts","./node_modules/next-intl/dist/types/extractor/format/codecs/POCodec.d.ts","./node_modules/next-intl/dist/types/extractor/format/index.d.ts","./node_modules/next-intl/dist/types/extractor/format/types.d.ts","./node_modules/next-intl/dist/types/plugin/types.d.ts","./node_modules/next-intl/dist/types/plugin/createNextIntlPlugin.d.ts","./node_modules/next-intl/dist/types/plugin/index.d.ts","./node_modules/next-intl/dist/types/plugin.d.ts","./next.config.ts","./node_modules/dotenv/config.d.ts","./node_modules/@prisma/config/dist/index.d.ts","./node_modules/prisma/config.d.ts","./prisma.config.ts","./node_modules/next-intl/dist/types/routing/types.d.ts","./node_modules/next-intl/dist/types/routing/config.d.ts","./node_modules/next-intl/dist/types/middleware/middleware.d.ts","./node_modules/next-intl/dist/types/middleware/index.d.ts","./node_modules/next-intl/dist/types/middleware.d.ts","./node_modules/next-intl/dist/types/routing/defineRouting.d.ts","./node_modules/next-intl/dist/types/routing/index.d.ts","./node_modules/next-intl/dist/types/routing.d.ts","./node_modules/use-intl/dist/types/core/AbstractIntlMessages.d.ts","./node_modules/use-intl/dist/types/core/TranslationValues.d.ts","./node_modules/use-intl/dist/types/core/TimeZone.d.ts","./node_modules/use-intl/dist/types/core/DateTimeFormatOptions.d.ts","./node_modules/@formatjs/ecma402-abstract/CanonicalizeLocaleList.d.ts","./node_modules/@formatjs/ecma402-abstract/CanonicalizeTimeZoneName.d.ts","./node_modules/@formatjs/ecma402-abstract/CoerceOptionsToObject.d.ts","./node_modules/@formatjs/ecma402-abstract/GetNumberOption.d.ts","./node_modules/@formatjs/ecma402-abstract/GetOption.d.ts","./node_modules/@formatjs/ecma402-abstract/GetOptionsObject.d.ts","./node_modules/@formatjs/ecma402-abstract/GetStringOrBooleanOption.d.ts","./node_modules/@formatjs/ecma402-abstract/IsSanctionedSimpleUnitIdentifier.d.ts","./node_modules/@formatjs/ecma402-abstract/IsValidTimeZoneName.d.ts","./node_modules/@formatjs/ecma402-abstract/IsWellFormedCurrencyCode.d.ts","./node_modules/@formatjs/ecma402-abstract/IsWellFormedUnitIdentifier.d.ts","./node_modules/decimal.js/decimal.d.ts","./node_modules/@formatjs/ecma402-abstract/types/core.d.ts","./node_modules/@formatjs/ecma402-abstract/types/plural-rules.d.ts","./node_modules/@formatjs/ecma402-abstract/types/number.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/ApplyUnsignedRoundingMode.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/CollapseNumberRange.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/ComputeExponent.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/ComputeExponentForMagnitude.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/CurrencyDigits.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/format_to_parts.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/FormatApproximately.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/FormatNumeric.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/FormatNumericRange.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/FormatNumericRangeToParts.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/FormatNumericToParts.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/FormatNumericToString.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/GetUnsignedRoundingMode.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/InitializeNumberFormat.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/PartitionNumberPattern.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/PartitionNumberRangePattern.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/SetNumberFormatDigitOptions.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/SetNumberFormatUnitOptions.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/ToRawFixed.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/ToRawPrecision.d.ts","./node_modules/@formatjs/ecma402-abstract/PartitionPattern.d.ts","./node_modules/@formatjs/ecma402-abstract/SupportedLocales.d.ts","./node_modules/@formatjs/ecma402-abstract/utils.d.ts","./node_modules/@formatjs/ecma402-abstract/262.d.ts","./node_modules/@formatjs/ecma402-abstract/data.d.ts","./node_modules/@formatjs/ecma402-abstract/types/date-time.d.ts","./node_modules/@formatjs/ecma402-abstract/types/displaynames.d.ts","./node_modules/@formatjs/ecma402-abstract/types/list.d.ts","./node_modules/@formatjs/ecma402-abstract/types/relative-time.d.ts","./node_modules/@formatjs/ecma402-abstract/constants.d.ts","./node_modules/@formatjs/ecma402-abstract/ToIntlMathematicalValue.d.ts","./node_modules/@formatjs/ecma402-abstract/index.d.ts","./node_modules/@formatjs/icu-skeleton-parser/date-time.d.ts","./node_modules/@formatjs/icu-skeleton-parser/number.d.ts","./node_modules/@formatjs/icu-skeleton-parser/index.d.ts","./node_modules/@formatjs/icu-messageformat-parser/types.d.ts","./node_modules/@formatjs/icu-messageformat-parser/error.d.ts","./node_modules/@formatjs/icu-messageformat-parser/parser.d.ts","./node_modules/@formatjs/icu-messageformat-parser/manipulator.d.ts","./node_modules/@formatjs/icu-messageformat-parser/index.d.ts","./node_modules/intl-messageformat/src/formatters.d.ts","./node_modules/intl-messageformat/src/core.d.ts","./node_modules/intl-messageformat/src/error.d.ts","./node_modules/intl-messageformat/index.d.ts","./node_modules/use-intl/dist/types/core/NumberFormatOptions.d.ts","./node_modules/use-intl/dist/types/core/Formats.d.ts","./node_modules/use-intl/dist/types/core/AppConfig.d.ts","./node_modules/use-intl/dist/types/core/IntlErrorCode.d.ts","./node_modules/use-intl/dist/types/core/IntlError.d.ts","./node_modules/use-intl/dist/types/core/types.d.ts","./node_modules/use-intl/dist/types/core/IntlConfig.d.ts","./node_modules/@schummar/icu-type-parser/dist/index.d.ts","./node_modules/use-intl/dist/types/core/ICUArgs.d.ts","./node_modules/use-intl/dist/types/core/ICUTags.d.ts","./node_modules/use-intl/dist/types/core/MessageKeys.d.ts","./node_modules/use-intl/dist/types/core/formatters.d.ts","./node_modules/use-intl/dist/types/core/createTranslator.d.ts","./node_modules/use-intl/dist/types/core/RelativeTimeFormatOptions.d.ts","./node_modules/use-intl/dist/types/core/createFormatter.d.ts","./node_modules/use-intl/dist/types/core/initializeConfig.d.ts","./node_modules/use-intl/dist/types/core/hasLocale.d.ts","./node_modules/use-intl/dist/types/core/index.d.ts","./node_modules/use-intl/dist/types/core.d.ts","./node_modules/use-intl/dist/types/react/IntlProvider.d.ts","./node_modules/use-intl/dist/types/react/useTranslations.d.ts","./node_modules/use-intl/dist/types/react/useLocale.d.ts","./node_modules/use-intl/dist/types/react/useNow.d.ts","./node_modules/use-intl/dist/types/react/useTimeZone.d.ts","./node_modules/use-intl/dist/types/react/useMessages.d.ts","./node_modules/use-intl/dist/types/react/useFormatter.d.ts","./node_modules/use-intl/dist/types/react/useExtracted.d.ts","./node_modules/use-intl/dist/types/react/index.d.ts","./node_modules/use-intl/dist/types/react.d.ts","./node_modules/use-intl/dist/types/index.d.ts","./node_modules/next-intl/dist/types/navigation/shared/StrictParams.d.ts","./node_modules/next-intl/dist/types/navigation/shared/utils.d.ts","./node_modules/next-intl/dist/types/navigation/react-client/createNavigation.d.ts","./node_modules/next-intl/dist/types/navigation/react-client/index.d.ts","./node_modules/next-intl/dist/types/navigation.react-client.d.ts","./src/lib/i18n/routing.ts","./src/middleware.ts","./node_modules/next-auth/node_modules/@auth/core/lib/symbols.d.ts","./node_modules/next-auth/node_modules/@auth/core/lib/index.d.ts","./node_modules/next-auth/node_modules/@auth/core/lib/vendored/cookie.d.ts","./node_modules/oauth4webapi/build/index.d.ts","./node_modules/next-auth/node_modules/@auth/core/lib/utils/cookie.d.ts","./node_modules/next-auth/node_modules/@auth/core/warnings.d.ts","./node_modules/next-auth/node_modules/@auth/core/lib/utils/logger.d.ts","./node_modules/preact/src/jsx.d.ts","./node_modules/preact/src/index.d.ts","./node_modules/next-auth/node_modules/@auth/core/providers/credentials.d.ts","./node_modules/next-auth/node_modules/@auth/core/providers/provider-types.d.ts","./node_modules/next-auth/node_modules/@auth/core/providers/nodemailer.d.ts","./node_modules/next-auth/node_modules/@auth/core/providers/email.d.ts","./node_modules/next-auth/node_modules/@auth/core/providers/oauth.d.ts","./node_modules/next-auth/node_modules/@auth/core/providers/webauthn.d.ts","./node_modules/next-auth/node_modules/@auth/core/providers/index.d.ts","./node_modules/next-auth/node_modules/@auth/core/adapters.d.ts","./node_modules/next-auth/node_modules/@auth/core/lib/utils/webauthn-utils.d.ts","./node_modules/next-auth/node_modules/@auth/core/types.d.ts","./node_modules/next-auth/node_modules/@auth/core/lib/utils/env.d.ts","./node_modules/next-auth/node_modules/@auth/core/jwt.d.ts","./node_modules/next-auth/node_modules/@auth/core/lib/utils/actions.d.ts","./node_modules/next-auth/node_modules/@auth/core/index.d.ts","./node_modules/next-auth/lib/types.d.ts","./node_modules/next-auth/lib/index.d.ts","./node_modules/next-auth/node_modules/@auth/core/errors.d.ts","./node_modules/next-auth/index.d.ts","./node_modules/next-auth/providers/credentials.d.ts","./node_modules/bcryptjs/types.d.ts","./node_modules/bcryptjs/index.d.ts","./node_modules/@prisma/client-runtime-utils/dist/index.d.ts","./node_modules/@prisma/client/runtime/client.d.ts","./node_modules/.prisma/client/index.d.ts","./node_modules/.prisma/client/default.d.ts","./node_modules/@prisma/client/default.d.ts","./node_modules/@prisma/debug/dist/index.d.mts","./node_modules/@prisma/driver-adapter-utils/dist/index.d.mts","./node_modules/pg-types/index.d.ts","./node_modules/pg-protocol/dist/messages.d.ts","./node_modules/pg-protocol/dist/serializer.d.ts","./node_modules/pg-protocol/dist/parser.d.ts","./node_modules/pg-protocol/dist/index.d.ts","./node_modules/@types/pg/lib/type-overrides.d.ts","./node_modules/@types/pg/index.d.ts","./node_modules/@types/pg/index.d.mts","./node_modules/@prisma/adapter-pg/dist/index.d.mts","./src/lib/db/index.ts","./src/lib/auth/config.ts","./src/lib/auth/index.ts","./src/app/api/auth/[...nextauth]/route.ts","./node_modules/zod/v4/core/json-schema.d.cts","./node_modules/zod/v4/core/standard-schema.d.cts","./node_modules/zod/v4/core/registries.d.cts","./node_modules/zod/v4/core/to-json-schema.d.cts","./node_modules/zod/v4/core/util.d.cts","./node_modules/zod/v4/core/versions.d.cts","./node_modules/zod/v4/core/schemas.d.cts","./node_modules/zod/v4/core/checks.d.cts","./node_modules/zod/v4/core/errors.d.cts","./node_modules/zod/v4/core/core.d.cts","./node_modules/zod/v4/core/parse.d.cts","./node_modules/zod/v4/core/regexes.d.cts","./node_modules/zod/v4/locales/ar.d.cts","./node_modules/zod/v4/locales/az.d.cts","./node_modules/zod/v4/locales/be.d.cts","./node_modules/zod/v4/locales/bg.d.cts","./node_modules/zod/v4/locales/ca.d.cts","./node_modules/zod/v4/locales/cs.d.cts","./node_modules/zod/v4/locales/da.d.cts","./node_modules/zod/v4/locales/de.d.cts","./node_modules/zod/v4/locales/en.d.cts","./node_modules/zod/v4/locales/eo.d.cts","./node_modules/zod/v4/locales/es.d.cts","./node_modules/zod/v4/locales/fa.d.cts","./node_modules/zod/v4/locales/fi.d.cts","./node_modules/zod/v4/locales/fr.d.cts","./node_modules/zod/v4/locales/fr-CA.d.cts","./node_modules/zod/v4/locales/he.d.cts","./node_modules/zod/v4/locales/hu.d.cts","./node_modules/zod/v4/locales/hy.d.cts","./node_modules/zod/v4/locales/id.d.cts","./node_modules/zod/v4/locales/is.d.cts","./node_modules/zod/v4/locales/it.d.cts","./node_modules/zod/v4/locales/ja.d.cts","./node_modules/zod/v4/locales/ka.d.cts","./node_modules/zod/v4/locales/kh.d.cts","./node_modules/zod/v4/locales/km.d.cts","./node_modules/zod/v4/locales/ko.d.cts","./node_modules/zod/v4/locales/lt.d.cts","./node_modules/zod/v4/locales/mk.d.cts","./node_modules/zod/v4/locales/ms.d.cts","./node_modules/zod/v4/locales/nl.d.cts","./node_modules/zod/v4/locales/no.d.cts","./node_modules/zod/v4/locales/ota.d.cts","./node_modules/zod/v4/locales/ps.d.cts","./node_modules/zod/v4/locales/pl.d.cts","./node_modules/zod/v4/locales/pt.d.cts","./node_modules/zod/v4/locales/ru.d.cts","./node_modules/zod/v4/locales/sl.d.cts","./node_modules/zod/v4/locales/sv.d.cts","./node_modules/zod/v4/locales/ta.d.cts","./node_modules/zod/v4/locales/th.d.cts","./node_modules/zod/v4/locales/tr.d.cts","./node_modules/zod/v4/locales/ua.d.cts","./node_modules/zod/v4/locales/uk.d.cts","./node_modules/zod/v4/locales/ur.d.cts","./node_modules/zod/v4/locales/uz.d.cts","./node_modules/zod/v4/locales/vi.d.cts","./node_modules/zod/v4/locales/zh-CN.d.cts","./node_modules/zod/v4/locales/zh-TW.d.cts","./node_modules/zod/v4/locales/yo.d.cts","./node_modules/zod/v4/locales/index.d.cts","./node_modules/zod/v4/core/doc.d.cts","./node_modules/zod/v4/core/api.d.cts","./node_modules/zod/v4/core/json-schema-processors.d.cts","./node_modules/zod/v4/core/json-schema-generator.d.cts","./node_modules/zod/v4/core/index.d.cts","./node_modules/zod/v4/classic/errors.d.cts","./node_modules/zod/v4/classic/parse.d.cts","./node_modules/zod/v4/classic/schemas.d.cts","./node_modules/zod/v4/classic/checks.d.cts","./node_modules/zod/v4/classic/compat.d.cts","./node_modules/zod/v4/classic/from-json-schema.d.cts","./node_modules/zod/v4/classic/iso.d.cts","./node_modules/zod/v4/classic/coerce.d.cts","./node_modules/zod/v4/classic/external.d.cts","./node_modules/zod/index.d.cts","./src/app/api/auth/register/route.ts","./node_modules/clsx/clsx.d.mts","./node_modules/tailwind-merge/dist/types.d.ts","./src/lib/utils.ts","./src/lib/auth/permissions.ts","./src/lib/auth/rbac.ts","./src/lib/auth/types.ts","./node_modules/next-intl/dist/types/server/react-server/getRequestConfig.d.ts","./node_modules/next-intl/dist/types/server/react-server/getFormatter.d.ts","./node_modules/next-intl/dist/types/server/react-server/getNow.d.ts","./node_modules/next-intl/dist/types/server/react-server/getTimeZone.d.ts","./node_modules/next-intl/dist/types/server/react-server/getTranslations.d.ts","./node_modules/next-intl/dist/types/server/react-server/getServerExtractor.d.ts","./node_modules/next-intl/dist/types/server/react-server/getExtracted.d.ts","./node_modules/next-intl/dist/types/server/react-server/getConfig.d.ts","./node_modules/next-intl/dist/types/server/react-server/getMessages.d.ts","./node_modules/next-intl/dist/types/server/react-server/getLocale.d.ts","./node_modules/next-intl/dist/types/server/react-server/RequestLocaleCache.d.ts","./node_modules/next-intl/dist/types/server/react-server/index.d.ts","./node_modules/next-intl/dist/types/server.react-server.d.ts","./src/lib/i18n/request.ts","./src/lib/utils/cn.ts","./src/types/index.ts","./src/app/layout.tsx","./src/app/page.tsx","./node_modules/next-intl/dist/types/shared/NextIntlClientProvider.d.ts","./node_modules/next-intl/dist/types/react-client/index.d.ts","./node_modules/next-intl/dist/types/index.react-client.d.ts","./src/app/[locale]/layout.tsx","./src/app/[locale]/page.tsx","./src/app/[locale]/(auth)/layout.tsx","./node_modules/next-auth/lib/client.d.ts","./node_modules/next-auth/react.d.ts","./node_modules/react-hook-form/dist/constants.d.ts","./node_modules/react-hook-form/dist/utils/createSubject.d.ts","./node_modules/react-hook-form/dist/types/events.d.ts","./node_modules/react-hook-form/dist/types/path/common.d.ts","./node_modules/react-hook-form/dist/types/path/eager.d.ts","./node_modules/react-hook-form/dist/types/path/index.d.ts","./node_modules/react-hook-form/dist/types/fieldArray.d.ts","./node_modules/react-hook-form/dist/types/resolvers.d.ts","./node_modules/react-hook-form/dist/types/form.d.ts","./node_modules/react-hook-form/dist/types/utils.d.ts","./node_modules/react-hook-form/dist/types/fields.d.ts","./node_modules/react-hook-form/dist/types/errors.d.ts","./node_modules/react-hook-form/dist/types/validator.d.ts","./node_modules/react-hook-form/dist/types/controller.d.ts","./node_modules/react-hook-form/dist/types/watch.d.ts","./node_modules/react-hook-form/dist/types/index.d.ts","./node_modules/react-hook-form/dist/controller.d.ts","./node_modules/react-hook-form/dist/form.d.ts","./node_modules/react-hook-form/dist/formStateSubscribe.d.ts","./node_modules/react-hook-form/dist/logic/appendErrors.d.ts","./node_modules/react-hook-form/dist/logic/createFormControl.d.ts","./node_modules/react-hook-form/dist/logic/index.d.ts","./node_modules/react-hook-form/dist/useController.d.ts","./node_modules/react-hook-form/dist/useFieldArray.d.ts","./node_modules/react-hook-form/dist/useForm.d.ts","./node_modules/react-hook-form/dist/useFormContext.d.ts","./node_modules/react-hook-form/dist/useFormState.d.ts","./node_modules/react-hook-form/dist/useWatch.d.ts","./node_modules/react-hook-form/dist/utils/get.d.ts","./node_modules/react-hook-form/dist/utils/set.d.ts","./node_modules/react-hook-form/dist/utils/index.d.ts","./node_modules/react-hook-form/dist/watch.d.ts","./node_modules/react-hook-form/dist/index.d.ts","./node_modules/zod/v3/helpers/typeAliases.d.cts","./node_modules/zod/v3/helpers/util.d.cts","./node_modules/zod/v3/ZodError.d.cts","./node_modules/zod/v3/locales/en.d.cts","./node_modules/zod/v3/errors.d.cts","./node_modules/zod/v3/helpers/parseUtil.d.cts","./node_modules/zod/v3/helpers/enumUtil.d.cts","./node_modules/zod/v3/helpers/errorUtil.d.cts","./node_modules/zod/v3/helpers/partialUtil.d.cts","./node_modules/zod/v3/standard-schema.d.cts","./node_modules/zod/v3/types.d.cts","./node_modules/zod/v3/external.d.cts","./node_modules/zod/v3/index.d.cts","./node_modules/@hookform/resolvers/zod/dist/zod.d.ts","./node_modules/@hookform/resolvers/zod/dist/index.d.ts","./node_modules/@radix-ui/react-slot/dist/index.d.mts","./node_modules/class-variance-authority/dist/types.d.ts","./node_modules/class-variance-authority/dist/index.d.ts","./src/components/ui/button.tsx","./src/components/ui/input.tsx","./node_modules/@radix-ui/react-label/node_modules/@radix-ui/react-primitive/dist/index.d.mts","./node_modules/@radix-ui/react-label/dist/index.d.mts","./src/components/ui/label.tsx","./src/components/ui/card.tsx","./src/components/ui/alert.tsx","./node_modules/lucide-react/dist/lucide-react.d.ts","./src/app/[locale]/(auth)/login/page.tsx","./node_modules/@radix-ui/react-context/dist/index.d.mts","./node_modules/@radix-ui/react-primitive/dist/index.d.mts","./node_modules/@radix-ui/react-dismissable-layer/dist/index.d.mts","./node_modules/@radix-ui/react-focus-scope/dist/index.d.mts","./node_modules/@radix-ui/react-arrow/dist/index.d.mts","./node_modules/@radix-ui/rect/dist/index.d.mts","./node_modules/@radix-ui/react-popper/dist/index.d.mts","./node_modules/@radix-ui/react-portal/dist/index.d.mts","./node_modules/@radix-ui/react-select/dist/index.d.mts","./src/components/ui/select.tsx","./src/app/[locale]/(auth)/register/page.tsx","./src/app/[locale]/(auth)/unauthorized/page.tsx","./node_modules/@radix-ui/react-scroll-area/dist/index.d.mts","./src/components/ui/scroll-area.tsx","./src/components/layout/sidebar.tsx","./node_modules/@radix-ui/react-roving-focus/dist/index.d.mts","./node_modules/@radix-ui/react-menu/dist/index.d.mts","./node_modules/@radix-ui/react-dropdown-menu/dist/index.d.mts","./src/components/ui/dropdown-menu.tsx","./node_modules/@radix-ui/react-avatar/node_modules/@radix-ui/react-context/dist/index.d.mts","./node_modules/@radix-ui/react-avatar/node_modules/@radix-ui/react-primitive/dist/index.d.mts","./node_modules/@radix-ui/react-avatar/dist/index.d.mts","./src/components/ui/avatar.tsx","./src/components/ui/badge.tsx","./src/components/layout/header.tsx","./src/components/layout/app-shell.tsx","./src/app/[locale]/(dashboard)/layout.tsx","./src/app/[locale]/(dashboard)/dashboard/page.tsx","./node_modules/@radix-ui/react-dialog/dist/index.d.mts","./src/components/ui/dialog.tsx","./src/components/ui/form.tsx","./node_modules/@radix-ui/react-progress/node_modules/@radix-ui/react-context/dist/index.d.mts","./node_modules/@radix-ui/react-progress/node_modules/@radix-ui/react-primitive/dist/index.d.mts","./node_modules/@radix-ui/react-progress/dist/index.d.mts","./src/components/ui/progress.tsx","./node_modules/@radix-ui/react-separator/node_modules/@radix-ui/react-primitive/dist/index.d.mts","./node_modules/@radix-ui/react-separator/dist/index.d.mts","./src/components/ui/separator.tsx","./src/components/ui/sheet.tsx","./src/components/ui/skeleton.tsx","./node_modules/next-themes/dist/index.d.ts","./node_modules/sonner/dist/index.d.mts","./src/components/ui/sonner.tsx","./src/components/ui/table.tsx","./node_modules/@radix-ui/react-tabs/dist/index.d.mts","./src/components/ui/tabs.tsx","./node_modules/@radix-ui/react-tooltip/dist/index.d.mts","./src/components/ui/tooltip.tsx","./.next/types/routes.d.ts","./.next/types/validator.ts","./.next/dev/types/cache-life.d.ts","./.next/dev/types/validator.ts","./node_modules/@types/bcryptjs/index.d.ts","./node_modules/@types/d3-array/index.d.ts","./node_modules/@types/d3-color/index.d.ts","./node_modules/@types/d3-ease/index.d.ts","./node_modules/@types/d3-interpolate/index.d.ts","./node_modules/@types/d3-path/index.d.ts","./node_modules/@types/d3-time/index.d.ts","./node_modules/@types/d3-scale/index.d.ts","./node_modules/@types/d3-shape/index.d.ts","./node_modules/@types/d3-timer/index.d.ts","./node_modules/@types/estree/index.d.ts","./node_modules/@types/json-schema/index.d.ts","./node_modules/@types/json5/index.d.ts","./node_modules/@types/use-sync-external-store/index.d.ts"],"fileIdsList":[[97,143,459,460,461,462],[97,143],[97,143,269,503,506,509,683,761,784,785,789,790,791,853,864,865,880,881],[97,143,269,503,506,683,761,784,785,789,790,791,853,864,865,880,881,902],[97,143,507,508,509],[97,143,269,507,520],[97,143,666],[97,143,665],[97,143,549],[97,143,549,552],[97,143,552],[97,143,538,539,540,541,542,543,544,545,546,547,548,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583],[97,143,550],[97,143,549,550,551],[97,143,550,552],[97,143,550,551],[97,143,588],[97,143,588,590,591],[97,143,588,589],[97,143,584,587],[97,143,585,586],[97,143,584],[97,143,840],[97,143,750,826,839],[97,143,670,678],[97,143,667],[97,143,664],[97,143,669],[85,97,143,855],[85,97,143,847,873],[85,97,143],[85,97,143,854,855,856,857,861],[85,97,143,854,855,870],[85,97,143,847],[85,97,143,854,855,856,857,860,861,869],[85,97,143,854,855,858,859],[85,97,143,854,855],[85,97,143,854,855,856,857,860,861],[85,89,97,143,192,193,194,195,196,454,500],[85,97,143,854,855,869],[85,97,143,854,855,856,860,861],[97,143,908],[97,143,912],[97,143,911],[97,140,143],[97,142,143],[143],[97,143,148,176],[97,143,144,149,154,162,173,184],[97,143,144,145,154,162],[92,93,94,97,143],[97,143,146,185],[97,143,147,148,155,163],[97,143,148,173,181],[97,143,149,151,154,162],[97,142,143,150],[97,143,151,152],[97,143,153,154],[97,142,143,154],[97,143,154,155,156,173,184],[97,143,154,155,156,169,173,176],[97,143,151,154,157,162,173,184],[97,143,154,155,157,158,162,173,181,184],[97,143,157,159,173,181,184],[95,96,97,98,99,100,101,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190],[97,143,154,160],[97,143,161,184,189],[97,143,151,154,162,173],[97,143,163],[97,143,164],[97,142,143,165],[97,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190],[97,143,167],[97,143,168],[97,143,154,169,170],[97,143,169,171,185,187],[97,143,154,173,174,176],[97,143,175,176],[97,143,173,174],[97,143,176],[97,143,177],[97,140,143,173,178],[97,143,154,179,180],[97,143,179,180],[97,143,148,162,173,181],[97,143,182],[97,143,162,183],[97,143,157,168,184],[97,143,148,185],[97,143,173,186],[97,143,161,187],[97,143,188],[97,138,143],[97,138,143,154,156,165,173,176,184,187,189],[97,143,173,190],[97,143,677],[97,143,154,173,181,191,671,672,675,676,677],[85,89,97,143,192,193,194,196,454,500,842],[85,89,97,143,192,193,194,195,412,454,500,842],[85,89,97,143,192,193,195,196,454,500,842],[85,97,143,196,412,413],[85,97,143,196,412],[85,89,97,143,193,194,195,196,454,500,842],[85,89,97,143,192,194,195,196,454,500,842],[83,84,97,143],[97,143,662],[97,143,762,843],[97,143,762],[97,143,593,594,595],[97,143,592,593],[97,143,584,592],[97,143,503,507,649,652,656,657,658,659],[85,97,143,649,652,659],[97,143,503,507,652,656,657],[97,143,503],[97,143,649,652],[97,143,634,635,640,649,650,652,653,654,655],[97,143,640,652],[97,143,634],[97,143,652],[97,143,652,656],[97,143,639,656],[97,143,638,648,650,652],[97,143,642,649,652],[97,143,644,645,649,652],[97,143,643,646,647,648,652],[97,143,646,652],[97,143,634,637,644,649,652,656],[97,143,636,637,638,639,640,649,651,656],[97,143,643],[85,97,143,649,652,792],[97,143,511],[97,143,512],[97,143,512,513,514,516],[97,143,515],[97,143,516],[97,143,787],[97,143,529],[97,143,528],[97,143,503,526,527],[97,143,630],[85,97,143,184,314,491,526,527,626,627,628],[97,143,628,629],[97,143,168,184,526,527,626,627],[97,143,519],[97,143,507,517],[97,143,518],[97,143,615,625,626,786],[97,143,532],[97,143,503,526],[97,143,526,527],[97,143,526,527,531],[97,143,779],[97,143,626],[97,143,615],[97,143,615,773],[97,143,626,775],[97,143,615,625],[97,143,768,769,770,771,772,774,776,777,778],[85,97,143,269,625,626],[97,143,457],[97,143,201,203,207,218,408,438,450],[97,143,203,213,214,215,217,450],[97,143,203,250,252,254,255,258,450,452],[97,143,203,207,209,210,211,241,336,408,428,429,437,450,452],[97,143,450],[97,143,214,306,417,426,446],[97,143,203],[97,143,197,306,446],[97,143,260],[97,143,259,450],[97,143,157,406,417,505],[97,143,157,374,386,426,445],[97,143,157,317],[97,143,431],[97,143,430,431,432],[97,143,430],[91,97,143,157,197,203,207,210,212,214,218,219,232,233,260,336,347,427,438,450,454],[97,143,201,203,216,250,251,256,257,450,505],[97,143,216,505],[97,143,201,233,361,450,505],[97,143,505],[97,143,203,216,217,505],[97,143,253,505],[97,143,219,428,436],[97,143,168,269,446],[97,143,269,446],[85,97,143,269],[85,97,143,378],[97,143,304,314,315,446,482,489],[97,143,303,423,483,484,485,486,488],[97,143,422],[97,143,422,423],[97,143,241,306,307,311],[97,143,306],[97,143,306,310,312],[97,143,306,307,308,309],[97,143,487],[85,97,143,204,476],[85,97,143,184],[85,97,143,216,296],[85,97,143,216,438],[97,143,294,298],[85,97,143,295,456],[85,89,97,143,157,191,192,193,194,195,196,454,498,499,842],[97,143,157],[97,143,157,207,240,292,337,358,360,433,434,438,450,451],[97,143,232,435],[97,143,454],[97,143,202],[85,97,143,363,376,385,395,397,445],[97,143,168,363,376,394,395,396,445,504],[97,143,388,389,390,391,392,393],[97,143,390],[97,143,394],[97,143,267,268,269,271],[85,97,143,261,262,263,264,270],[97,143,267,270],[97,143,265],[97,143,266],[85,97,143,269,295,456],[85,97,143,269,455,456],[85,97,143,269,456],[97,143,337,440],[97,143,440],[97,143,157,451,456],[97,143,382],[97,142,143,381],[97,143,242,306,323,360,369,372,374,375,416,445,448,451],[97,143,288,306,403],[97,143,374,445],[85,97,143,374,379,380,382,383,384,385,386,387,398,399,400,401,402,404,405,445,446,505],[97,143,368],[97,143,157,168,204,240,243,264,289,290,337,347,358,359,416,439,450,451,452,454,505],[97,143,445],[97,142,143,214,290,347,371,439,441,442,443,444,451],[97,143,374],[97,142,143,240,277,323,364,365,366,367,368,369,370,372,373,445,446],[97,143,157,277,278,364,451,452],[97,143,214,337,347,360,439,445,451],[97,143,157,450,452],[97,143,157,173,448,451,452],[97,143,157,168,184,197,207,216,242,243,245,274,279,284,288,289,290,292,321,323,325,328,330,333,334,335,336,358,360,438,439,446,448,450,451,452],[97,143,157,173],[97,143,203,204,205,212,448,449,454,456,505],[97,143,201,450],[97,143,273],[97,143,157,173,184,235,258,260,261,262,263,264,271,272,505],[97,143,168,184,197,235,250,283,284,285,321,322,323,328,336,337,343,346,348,358,360,439,446,448,450],[97,143,212,219,232,336,347,439,450],[97,143,157,184,204,207,323,341,448,450],[97,143,362],[97,143,157,273,344,345,355],[97,143,448,450],[97,143,369,371],[97,143,290,323,438,456],[97,143,157,168,246,250,322,328,343,346,350,448],[97,143,157,219,232,250,351],[97,143,203,245,353,438,450],[97,143,157,184,264,450],[97,143,157,216,244,245,246,255,273,352,354,438,450],[91,97,143,157,290,357,454,456],[97,143,320,358],[97,143,157,168,184,207,218,219,232,242,243,279,283,284,285,289,321,322,323,325,337,338,340,342,358,360,438,439,446,447,448,456],[97,143,157,173,219,343,349,355,448],[97,143,222,223,224,225,226,227,228,229,230,231],[97,143,274,329],[97,143,331],[97,143,329],[97,143,331,332],[97,143,157,207,210,240,241,451],[97,143,157,168,202,204,242,288,289,290,291,319,358,448,452,454,456],[97,143,157,168,184,206,241,291,323,369,439,447,451],[97,143,364],[97,143,365],[97,143,306,336,416],[97,143,366],[97,143,234,238],[97,143,157,207,234,242],[97,143,237,238],[97,143,239],[97,143,234,235],[97,143,234,286],[97,143,234],[97,143,274,327,447],[97,143,326],[97,143,235,446,447],[97,143,324,447],[97,143,235,446],[97,143,416],[97,143,207,236,242,290,306,323,357,360,363,369,376,377,407,408,411,415,438,448,451],[97,143,299,302,304,305,314,315],[85,97,143,194,196,269,409,410],[85,97,143,194,196,269,409,410,414],[97,143,425],[97,143,214,278,290,357,360,374,382,386,418,419,420,421,423,424,427,438,445,450],[97,143,314],[97,143,157,319],[97,143,319],[97,143,157,242,287,292,316,318,357,448,454,456],[97,143,299,300,301,302,304,305,314,315,455],[91,97,143,157,168,184,234,235,243,289,290,323,355,356,358,438,439,448,450,451,454],[97,143,278,280,283,439],[97,143,157,274,450],[97,143,277,374],[97,143,276],[97,143,278,279],[97,143,275,277,450],[97,143,157,206,278,280,281,282,450,451],[85,97,143,306,313,446],[97,143,199,200],[85,97,143,204],[85,97,143,303,446],[85,91,97,143,289,290,454,456],[97,143,204,476,477],[85,97,143,298],[85,97,143,168,184,202,257,293,295,297,456],[97,143,216,446,451],[97,143,339,446],[85,97,143,155,157,168,201,202,252,298,454,455],[85,97,143,192,193,194,195,196,454,500,842],[85,86,87,88,89,97,143],[97,143,148],[97,143,247,248,249],[97,143,247],[85,89,97,143,157,159,168,191,192,193,194,195,196,197,202,243,350,394,452,453,456,500,842],[97,143,464],[97,143,466],[97,143,468],[97,143,470],[97,143,472,473,474],[97,143,478],[90,97,143,458,463,465,467,469,471,475,479,481,491,492,494,503,504,505,506],[97,143,480],[97,143,490],[97,143,295],[97,143,493],[97,142,143,278,280,281,283,495,496,497,500,501,502],[97,143,191],[97,143,191,672,673,674],[97,143,173,191,672],[97,143,641],[97,143,642],[97,143,523],[85,97,143,809],[97,143,809,810,811,812,815,816,817,818,819,820,821,824,825],[97,143,809],[97,143,813,814],[85,97,143,806,809],[97,143,803,804,806],[97,143,799,802,804,806],[97,143,803,806],[85,97,143,794,795,796,799,800,801,803,804,805,806],[97,143,796,799,800,801,802,803,804,805,806,807,808],[97,143,803],[97,143,797,803,804],[97,143,797,798],[97,143,802,804,805],[97,143,802],[97,143,794,799,804,805],[85,97,143,799,802,803,804],[97,143,822,823],[97,143,173,191],[97,110,114,143,184],[97,110,143,173,184],[97,105,143],[97,107,110,143,181,184],[97,143,162,181],[97,105,143,191],[97,107,110,143,162,184],[97,102,103,106,109,143,154,173,184],[97,110,117,143],[97,102,108,143],[97,110,131,132,143],[97,106,110,143,176,184,191],[97,131,143,191],[97,104,105,143,191],[97,110,143],[97,104,105,106,107,108,109,110,111,112,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,132,133,134,135,136,137,143],[97,110,125,143],[97,110,117,118,143],[97,108,110,118,119,143],[97,109,143],[97,102,105,110,143],[97,110,114,118,119,143],[97,114,143],[97,108,110,113,143,184],[97,102,107,110,117,143],[97,143,173],[97,105,110,131,143,189,191],[97,143,614],[97,143,536],[97,143,537,597],[97,143,604],[97,143,536,598,599,601,602],[97,143,600],[97,143,596],[85,97,143,536,537,597,598,599,601,608,610],[85,97,143,535,598,602,603,605,606,607,608],[97,143,599],[97,143,534,535,536,537,597,598,599,600,601,603,605,606,607,608,609,610,611,612,613],[97,143,601,603],[97,143,624],[85,97,143,269,603],[97,143,616,617,618,619,620,621,622,623],[85,97,143,535,609],[97,143,611],[97,143,599,607,609],[97,143,759],[97,143,827,828,839],[97,143,829,830],[97,143,827,828,829,831,832,837],[97,143,828,829],[97,143,837],[97,143,838],[97,143,829],[97,143,827,828,829,832,833,834,835,836],[97,143,750],[97,143,750,753],[97,143,745,748,750,751,752,753,754,755,756,757,758],[97,143,684,686,753],[97,143,750,751],[97,143,685,750,752],[97,143,686,688,690,691,692,693],[97,143,688,690,692,693],[97,143,688,690,692],[97,143,685,688,690,691,693],[97,143,684,686,687,688,689,690,691,692,693,694,695,745,746,747,748,749],[97,143,684,686,687,690],[97,143,686,687,690],[97,143,690,693],[97,143,684,685,687,688,689,691,692,693],[97,143,684,685,686,690,750],[97,143,690,691,692,693],[97,143,692],[97,143,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744],[97,143,269,522,524],[97,143,269],[85,97,143,269,481,491,760,788,793,826,841,845,846,849,850,851,852],[85,97,143,269,481,491,760,788,826,841,845,846,849,850,851,852,863],[97,143,269,481,845,850,852],[97,143,269,682,780,850,852],[97,143,269,491,682,879],[97,143,269,491,632,780,788],[97,143,269,481,788],[97,143,269,682],[97,143,269,503,663,680,760],[97,143,269,507],[97,143,269,479],[97,143,269,868,878],[97,143,269,481,491,788,793,845,852,872,876,877],[85,97,143,269,481,491,764,788,845,852,867],[85,97,143,269,764,844],[85,97,143,269,764,875],[85,97,143,269,764,842,844],[85,97,143,269,764],[85,97,143,269,764,852,882],[85,97,143,269,764,852,871],[85,97,143,269,764,826,842,848,849],[85,97,143,269,764,848],[85,97,143,269,764,887],[85,97,143,269,764,866],[85,97,143,269,764,852,862],[85,97,143,269,764,890],[97,143,269,764],[97,143,269,852,894,895],[85,97,143,269,764,898],[85,97,143,269,764,900],[97,143,269,660,661,663,668,680,767],[97,143,269,660,681,767],[97,143,269,668],[97,143,269,491,682,765],[97,143,269,660,668,767],[97,143,269,668,678,679],[97,143,269,632,780],[97,143,269,533,631],[97,143,269,762,763],[97,143,269,530,632]],"fileInfos":[{"version":"c430d44666289dae81f30fa7b2edebf186ecc91a2d4c71266ea6ae76388792e1","affectsGlobalScope":true,"impliedFormat":1},{"version":"45b7ab580deca34ae9729e97c13cfd999df04416a79116c3bfb483804f85ded4","impliedFormat":1},{"version":"3facaf05f0c5fc569c5649dd359892c98a85557e3e0c847964caeb67076f4d75","impliedFormat":1},{"version":"e44bb8bbac7f10ecc786703fe0a6a4b952189f908707980ba8f3c8975a760962","impliedFormat":1},{"version":"5e1c4c362065a6b95ff952c0eab010f04dcd2c3494e813b493ecfd4fcb9fc0d8","impliedFormat":1},{"version":"68d73b4a11549f9c0b7d352d10e91e5dca8faa3322bfb77b661839c42b1ddec7","impliedFormat":1},{"version":"5efce4fc3c29ea84e8928f97adec086e3dc876365e0982cc8479a07954a3efd4","impliedFormat":1},{"version":"feecb1be483ed332fad555aff858affd90a48ab19ba7272ee084704eb7167569","impliedFormat":1},{"version":"ee7bad0c15b58988daa84371e0b89d313b762ab83cb5b31b8a2d1162e8eb41c2","impliedFormat":1},{"version":"27bdc30a0e32783366a5abeda841bc22757c1797de8681bbe81fbc735eeb1c10","impliedFormat":1},{"version":"8fd575e12870e9944c7e1d62e1f5a73fcf23dd8d3a321f2a2c74c20d022283fe","impliedFormat":1},{"version":"2ab096661c711e4a81cc464fa1e6feb929a54f5340b46b0a07ac6bbf857471f0","impliedFormat":1},{"version":"080941d9f9ff9307f7e27a83bcd888b7c8270716c39af943532438932ec1d0b9","affectsGlobalScope":true,"impliedFormat":1},{"version":"2e80ee7a49e8ac312cc11b77f1475804bee36b3b2bc896bead8b6e1266befb43","affectsGlobalScope":true,"impliedFormat":1},{"version":"c57796738e7f83dbc4b8e65132f11a377649c00dd3eee333f672b8f0a6bea671","affectsGlobalScope":true,"impliedFormat":1},{"version":"dc2df20b1bcdc8c2d34af4926e2c3ab15ffe1160a63e58b7e09833f616efff44","affectsGlobalScope":true,"impliedFormat":1},{"version":"515d0b7b9bea2e31ea4ec968e9edd2c39d3eebf4a2d5cbd04e88639819ae3b71","affectsGlobalScope":true,"impliedFormat":1},{"version":"0559b1f683ac7505ae451f9a96ce4c3c92bdc71411651ca6ddb0e88baaaad6a3","affectsGlobalScope":true,"impliedFormat":1},{"version":"0dc1e7ceda9b8b9b455c3a2d67b0412feab00bd2f66656cd8850e8831b08b537","affectsGlobalScope":true,"impliedFormat":1},{"version":"ce691fb9e5c64efb9547083e4a34091bcbe5bdb41027e310ebba8f7d96a98671","affectsGlobalScope":true,"impliedFormat":1},{"version":"8d697a2a929a5fcb38b7a65594020fcef05ec1630804a33748829c5ff53640d0","affectsGlobalScope":true,"impliedFormat":1},{"version":"4ff2a353abf8a80ee399af572debb8faab2d33ad38c4b4474cff7f26e7653b8d","affectsGlobalScope":true,"impliedFormat":1},{"version":"fb0f136d372979348d59b3f5020b4cdb81b5504192b1cacff5d1fbba29378aa1","affectsGlobalScope":true,"impliedFormat":1},{"version":"d15bea3d62cbbdb9797079416b8ac375ae99162a7fba5de2c6c505446486ac0a","affectsGlobalScope":true,"impliedFormat":1},{"version":"68d18b664c9d32a7336a70235958b8997ebc1c3b8505f4f1ae2b7e7753b87618","affectsGlobalScope":true,"impliedFormat":1},{"version":"eb3d66c8327153d8fa7dd03f9c58d351107fe824c79e9b56b462935176cdf12a","affectsGlobalScope":true,"impliedFormat":1},{"version":"38f0219c9e23c915ef9790ab1d680440d95419ad264816fa15009a8851e79119","affectsGlobalScope":true,"impliedFormat":1},{"version":"69ab18c3b76cd9b1be3d188eaf8bba06112ebbe2f47f6c322b5105a6fbc45a2e","affectsGlobalScope":true,"impliedFormat":1},{"version":"a680117f487a4d2f30ea46f1b4b7f58bef1480456e18ba53ee85c2746eeca012","affectsGlobalScope":true,"impliedFormat":1},{"version":"2f11ff796926e0832f9ae148008138ad583bd181899ab7dd768a2666700b1893","affectsGlobalScope":true,"impliedFormat":1},{"version":"4de680d5bb41c17f7f68e0419412ca23c98d5749dcaaea1896172f06435891fc","affectsGlobalScope":true,"impliedFormat":1},{"version":"954296b30da6d508a104a3a0b5d96b76495c709785c1d11610908e63481ee667","affectsGlobalScope":true,"impliedFormat":1},{"version":"ac9538681b19688c8eae65811b329d3744af679e0bdfa5d842d0e32524c73e1c","affectsGlobalScope":true,"impliedFormat":1},{"version":"0a969edff4bd52585473d24995c5ef223f6652d6ef46193309b3921d65dd4376","affectsGlobalScope":true,"impliedFormat":1},{"version":"9e9fbd7030c440b33d021da145d3232984c8bb7916f277e8ffd3dc2e3eae2bdb","affectsGlobalScope":true,"impliedFormat":1},{"version":"811ec78f7fefcabbda4bfa93b3eb67d9ae166ef95f9bff989d964061cbf81a0c","affectsGlobalScope":true,"impliedFormat":1},{"version":"717937616a17072082152a2ef351cb51f98802fb4b2fdabd32399843875974ca","affectsGlobalScope":true,"impliedFormat":1},{"version":"d7e7d9b7b50e5f22c915b525acc5a49a7a6584cf8f62d0569e557c5cfc4b2ac2","affectsGlobalScope":true,"impliedFormat":1},{"version":"71c37f4c9543f31dfced6c7840e068c5a5aacb7b89111a4364b1d5276b852557","affectsGlobalScope":true,"impliedFormat":1},{"version":"576711e016cf4f1804676043e6a0a5414252560eb57de9faceee34d79798c850","affectsGlobalScope":true,"impliedFormat":1},{"version":"89c1b1281ba7b8a96efc676b11b264de7a8374c5ea1e6617f11880a13fc56dc6","affectsGlobalScope":true,"impliedFormat":1},{"version":"74f7fa2d027d5b33eb0471c8e82a6c87216223181ec31247c357a3e8e2fddc5b","affectsGlobalScope":true,"impliedFormat":1},{"version":"d6d7ae4d1f1f3772e2a3cde568ed08991a8ae34a080ff1151af28b7f798e22ca","affectsGlobalScope":true,"impliedFormat":1},{"version":"063600664504610fe3e99b717a1223f8b1900087fab0b4cad1496a114744f8df","affectsGlobalScope":true,"impliedFormat":1},{"version":"934019d7e3c81950f9a8426d093458b65d5aff2c7c1511233c0fd5b941e608ab","affectsGlobalScope":true,"impliedFormat":1},{"version":"52ada8e0b6e0482b728070b7639ee42e83a9b1c22d205992756fe020fd9f4a47","affectsGlobalScope":true,"impliedFormat":1},{"version":"3bdefe1bfd4d6dee0e26f928f93ccc128f1b64d5d501ff4a8cf3c6371200e5e6","affectsGlobalScope":true,"impliedFormat":1},{"version":"59fb2c069260b4ba00b5643b907ef5d5341b167e7d1dbf58dfd895658bda2867","affectsGlobalScope":true,"impliedFormat":1},{"version":"639e512c0dfc3fad96a84caad71b8834d66329a1f28dc95e3946c9b58176c73a","affectsGlobalScope":true,"impliedFormat":1},{"version":"368af93f74c9c932edd84c58883e736c9e3d53cec1fe24c0b0ff451f529ceab1","affectsGlobalScope":true,"impliedFormat":1},{"version":"af3dd424cf267428f30ccfc376f47a2c0114546b55c44d8c0f1d57d841e28d74","affectsGlobalScope":true,"impliedFormat":1},{"version":"995c005ab91a498455ea8dfb63aa9f83fa2ea793c3d8aa344be4a1678d06d399","affectsGlobalScope":true,"impliedFormat":1},{"version":"959d36cddf5e7d572a65045b876f2956c973a586da58e5d26cde519184fd9b8a","affectsGlobalScope":true,"impliedFormat":1},{"version":"965f36eae237dd74e6cca203a43e9ca801ce38824ead814728a2807b1910117d","affectsGlobalScope":true,"impliedFormat":1},{"version":"3925a6c820dcb1a06506c90b1577db1fdbf7705d65b62b99dce4be75c637e26b","affectsGlobalScope":true,"impliedFormat":1},{"version":"0a3d63ef2b853447ec4f749d3f368ce642264246e02911fcb1590d8c161b8005","affectsGlobalScope":true,"impliedFormat":1},{"version":"8cdf8847677ac7d20486e54dd3fcf09eda95812ac8ace44b4418da1bbbab6eb8","affectsGlobalScope":true,"impliedFormat":1},{"version":"8444af78980e3b20b49324f4a16ba35024fef3ee069a0eb67616ea6ca821c47a","affectsGlobalScope":true,"impliedFormat":1},{"version":"3287d9d085fbd618c3971944b65b4be57859f5415f495b33a6adc994edd2f004","affectsGlobalScope":true,"impliedFormat":1},{"version":"b4b67b1a91182421f5df999988c690f14d813b9850b40acd06ed44691f6727ad","affectsGlobalScope":true,"impliedFormat":1},{"version":"df83c2a6c73228b625b0beb6669c7ee2a09c914637e2d35170723ad49c0f5cd4","affectsGlobalScope":true,"impliedFormat":1},{"version":"436aaf437562f276ec2ddbee2f2cdedac7664c1e4c1d2c36839ddd582eeb3d0a","affectsGlobalScope":true,"impliedFormat":1},{"version":"8e3c06ea092138bf9fa5e874a1fdbc9d54805d074bee1de31b99a11e2fec239d","affectsGlobalScope":true,"impliedFormat":1},{"version":"87dc0f382502f5bbce5129bdc0aea21e19a3abbc19259e0b43ae038a9fc4e326","affectsGlobalScope":true,"impliedFormat":1},{"version":"b1cb28af0c891c8c96b2d6b7be76bd394fddcfdb4709a20ba05a7c1605eea0f9","affectsGlobalScope":true,"impliedFormat":1},{"version":"2fef54945a13095fdb9b84f705f2b5994597640c46afeb2ce78352fab4cb3279","affectsGlobalScope":true,"impliedFormat":1},{"version":"ac77cb3e8c6d3565793eb90a8373ee8033146315a3dbead3bde8db5eaf5e5ec6","affectsGlobalScope":true,"impliedFormat":1},{"version":"56e4ed5aab5f5920980066a9409bfaf53e6d21d3f8d020c17e4de584d29600ad","affectsGlobalScope":true,"impliedFormat":1},{"version":"4ece9f17b3866cc077099c73f4983bddbcb1dc7ddb943227f1ec070f529dedd1","affectsGlobalScope":true,"impliedFormat":1},{"version":"0a6282c8827e4b9a95f4bf4f5c205673ada31b982f50572d27103df8ceb8013c","affectsGlobalScope":true,"impliedFormat":1},{"version":"1c9319a09485199c1f7b0498f2988d6d2249793ef67edda49d1e584746be9032","affectsGlobalScope":true,"impliedFormat":1},{"version":"e3a2a0cee0f03ffdde24d89660eba2685bfbdeae955a6c67e8c4c9fd28928eeb","affectsGlobalScope":true,"impliedFormat":1},{"version":"811c71eee4aa0ac5f7adf713323a5c41b0cf6c4e17367a34fbce379e12bbf0a4","affectsGlobalScope":true,"impliedFormat":1},{"version":"51ad4c928303041605b4d7ae32e0c1ee387d43a24cd6f1ebf4a2699e1076d4fa","affectsGlobalScope":true,"impliedFormat":1},{"version":"60037901da1a425516449b9a20073aa03386cce92f7a1fd902d7602be3a7c2e9","affectsGlobalScope":true,"impliedFormat":1},{"version":"d4b1d2c51d058fc21ec2629fff7a76249dec2e36e12960ea056e3ef89174080f","affectsGlobalScope":true,"impliedFormat":1},{"version":"22adec94ef7047a6c9d1af3cb96be87a335908bf9ef386ae9fd50eeb37f44c47","affectsGlobalScope":true,"impliedFormat":1},{"version":"196cb558a13d4533a5163286f30b0509ce0210e4b316c56c38d4c0fd2fb38405","affectsGlobalScope":true,"impliedFormat":1},{"version":"73f78680d4c08509933daf80947902f6ff41b6230f94dd002ae372620adb0f60","affectsGlobalScope":true,"impliedFormat":1},{"version":"c5239f5c01bcfa9cd32f37c496cf19c61d69d37e48be9de612b541aac915805b","affectsGlobalScope":true,"impliedFormat":1},{"version":"8e7f8264d0fb4c5339605a15daadb037bf238c10b654bb3eee14208f860a32ea","affectsGlobalScope":true,"impliedFormat":1},{"version":"782dec38049b92d4e85c1585fbea5474a219c6984a35b004963b00beb1aab538","affectsGlobalScope":true,"impliedFormat":1},{"version":"170d4db14678c68178ee8a3d5a990d5afb759ecb6ec44dbd885c50f6da6204f6","affectsGlobalScope":true,"impliedFormat":1},{"version":"ac51dd7d31333793807a6abaa5ae168512b6131bd41d9c5b98477fc3b7800f9f","impliedFormat":1},{"version":"cf8db38686dfd74567ea692266fe44fbb32fa0e25fc0888ad6fc40e65873607e","impliedFormat":1},{"version":"acd8fd5090ac73902278889c38336ff3f48af6ba03aa665eb34a75e7ba1dccc4","impliedFormat":1},{"version":"d6258883868fb2680d2ca96bc8b1352cab69874581493e6d52680c5ffecdb6cc","impliedFormat":1},{"version":"1b61d259de5350f8b1e5db06290d31eaebebc6baafd5f79d314b5af9256d7153","impliedFormat":1},{"version":"f258e3960f324a956fc76a3d3d9e964fff2244ff5859dcc6ce5951e5413ca826","impliedFormat":1},{"version":"643f7232d07bf75e15bd8f658f664d6183a0efaca5eb84b48201c7671a266979","impliedFormat":1},{"version":"21da358700a3893281ce0c517a7a30cbd46be020d9f0c3f2834d0a8ad1f5fc75","impliedFormat":1},{"version":"70521b6ab0dcba37539e5303104f29b721bfb2940b2776da4cc818c07e1fefc1","affectsGlobalScope":true,"impliedFormat":1},{"version":"ab41ef1f2cdafb8df48be20cd969d875602483859dc194e9c97c8a576892c052","affectsGlobalScope":true,"impliedFormat":1},{"version":"d153a11543fd884b596587ccd97aebbeed950b26933ee000f94009f1ab142848","affectsGlobalScope":true,"impliedFormat":1},{"version":"21d819c173c0cf7cc3ce57c3276e77fd9a8a01d35a06ad87158781515c9a438a","impliedFormat":1},{"version":"98cffbf06d6bab333473c70a893770dbe990783904002c4f1a960447b4b53dca","affectsGlobalScope":true,"impliedFormat":1},{"version":"ba481bca06f37d3f2c137ce343c7d5937029b2468f8e26111f3c9d9963d6568d","affectsGlobalScope":true,"impliedFormat":1},{"version":"6d9ef24f9a22a88e3e9b3b3d8c40ab1ddb0853f1bfbd5c843c37800138437b61","affectsGlobalScope":true,"impliedFormat":1},{"version":"1db0b7dca579049ca4193d034d835f6bfe73096c73663e5ef9a0b5779939f3d0","affectsGlobalScope":true,"impliedFormat":1},{"version":"9798340ffb0d067d69b1ae5b32faa17ab31b82466a3fc00d8f2f2df0c8554aaa","affectsGlobalScope":true,"impliedFormat":1},{"version":"f26b11d8d8e4b8028f1c7d618b22274c892e4b0ef5b3678a8ccbad85419aef43","affectsGlobalScope":true,"impliedFormat":1},{"version":"5929864ce17fba74232584d90cb721a89b7ad277220627cc97054ba15a98ea8f","impliedFormat":1},{"version":"763fe0f42b3d79b440a9b6e51e9ba3f3f91352469c1e4b3b67bfa4ff6352f3f4","impliedFormat":1},{"version":"25c8056edf4314820382a5fdb4bb7816999acdcb929c8f75e3f39473b87e85bc","impliedFormat":1},{"version":"c464d66b20788266e5353b48dc4aa6bc0dc4a707276df1e7152ab0c9ae21fad8","impliedFormat":1},{"version":"78d0d27c130d35c60b5e5566c9f1e5be77caf39804636bc1a40133919a949f21","impliedFormat":1},{"version":"c6fd2c5a395f2432786c9cb8deb870b9b0e8ff7e22c029954fabdd692bff6195","impliedFormat":1},{"version":"1d6e127068ea8e104a912e42fc0a110e2aa5a66a356a917a163e8cf9a65e4a75","impliedFormat":1},{"version":"5ded6427296cdf3b9542de4471d2aa8d3983671d4cac0f4bf9c637208d1ced43","impliedFormat":1},{"version":"7f182617db458e98fc18dfb272d40aa2fff3a353c44a89b2c0ccb3937709bfb5","impliedFormat":1},{"version":"cadc8aced301244057c4e7e73fbcae534b0f5b12a37b150d80e5a45aa4bebcbd","impliedFormat":1},{"version":"385aab901643aa54e1c36f5ef3107913b10d1b5bb8cbcd933d4263b80a0d7f20","impliedFormat":1},{"version":"9670d44354bab9d9982eca21945686b5c24a3f893db73c0dae0fd74217a4c219","impliedFormat":1},{"version":"0b8a9268adaf4da35e7fa830c8981cfa22adbbe5b3f6f5ab91f6658899e657a7","impliedFormat":1},{"version":"11396ed8a44c02ab9798b7dca436009f866e8dae3c9c25e8c1fbc396880bf1bb","impliedFormat":1},{"version":"ba7bc87d01492633cb5a0e5da8a4a42a1c86270e7b3d2dea5d156828a84e4882","impliedFormat":1},{"version":"4893a895ea92c85345017a04ed427cbd6a1710453338df26881a6019432febdd","impliedFormat":1},{"version":"c21dc52e277bcfc75fac0436ccb75c204f9e1b3fa5e12729670910639f27343e","impliedFormat":1},{"version":"13f6f39e12b1518c6650bbb220c8985999020fe0f21d818e28f512b7771d00f9","impliedFormat":1},{"version":"9b5369969f6e7175740bf51223112ff209f94ba43ecd3bb09eefff9fd675624a","impliedFormat":1},{"version":"4fe9e626e7164748e8769bbf74b538e09607f07ed17c2f20af8d680ee49fc1da","impliedFormat":1},{"version":"24515859bc0b836719105bb6cc3d68255042a9f02a6022b3187948b204946bd2","impliedFormat":1},{"version":"ea0148f897b45a76544ae179784c95af1bd6721b8610af9ffa467a518a086a43","impliedFormat":1},{"version":"24c6a117721e606c9984335f71711877293a9651e44f59f3d21c1ea0856f9cc9","impliedFormat":1},{"version":"dd3273ead9fbde62a72949c97dbec2247ea08e0c6952e701a483d74ef92d6a17","impliedFormat":1},{"version":"405822be75ad3e4d162e07439bac80c6bcc6dbae1929e179cf467ec0b9ee4e2e","impliedFormat":1},{"version":"0db18c6e78ea846316c012478888f33c11ffadab9efd1cc8bcc12daded7a60b6","impliedFormat":1},{"version":"e61be3f894b41b7baa1fbd6a66893f2579bfad01d208b4ff61daef21493ef0a8","impliedFormat":1},{"version":"bd0532fd6556073727d28da0edfd1736417a3f9f394877b6d5ef6ad88fba1d1a","impliedFormat":1},{"version":"89167d696a849fce5ca508032aabfe901c0868f833a8625d5a9c6e861ef935d2","impliedFormat":1},{"version":"615ba88d0128ed16bf83ef8ccbb6aff05c3ee2db1cc0f89ab50a4939bfc1943f","impliedFormat":1},{"version":"a4d551dbf8746780194d550c88f26cf937caf8d56f102969a110cfaed4b06656","impliedFormat":1},{"version":"8bd86b8e8f6a6aa6c49b71e14c4ffe1211a0e97c80f08d2c8cc98838006e4b88","impliedFormat":1},{"version":"317e63deeb21ac07f3992f5b50cdca8338f10acd4fbb7257ebf56735bf52ab00","impliedFormat":1},{"version":"4732aec92b20fb28c5fe9ad99521fb59974289ed1e45aecb282616202184064f","impliedFormat":1},{"version":"2e85db9e6fd73cfa3d7f28e0ab6b55417ea18931423bd47b409a96e4a169e8e6","impliedFormat":1},{"version":"c46e079fe54c76f95c67fb89081b3e399da2c7d109e7dca8e4b58d83e332e605","impliedFormat":1},{"version":"bf67d53d168abc1298888693338cb82854bdb2e69ef83f8a0092093c2d562107","impliedFormat":1},{"version":"2cbe0621042e2a68c7cbce5dfed3906a1862a16a7d496010636cdbdb91341c0f","affectsGlobalScope":true,"impliedFormat":1},{"version":"e2677634fe27e87348825bb041651e22d50a613e2fdf6a4a3ade971d71bac37e","impliedFormat":1},{"version":"7394959e5a741b185456e1ef5d64599c36c60a323207450991e7a42e08911419","impliedFormat":1},{"version":"8c0bcd6c6b67b4b503c11e91a1fb91522ed585900eab2ab1f61bba7d7caa9d6f","impliedFormat":1},{"version":"8cd19276b6590b3ebbeeb030ac271871b9ed0afc3074ac88a94ed2449174b776","affectsGlobalScope":true,"impliedFormat":1},{"version":"696eb8d28f5949b87d894b26dc97318ef944c794a9a4e4f62360cd1d1958014b","impliedFormat":1},{"version":"3f8fa3061bd7402970b399300880d55257953ee6d3cd408722cb9ac20126460c","impliedFormat":1},{"version":"35ec8b6760fd7138bbf5809b84551e31028fb2ba7b6dc91d95d098bf212ca8b4","affectsGlobalScope":true,"impliedFormat":1},{"version":"5524481e56c48ff486f42926778c0a3cce1cc85dc46683b92b1271865bcf015a","impliedFormat":1},{"version":"68bd56c92c2bd7d2339457eb84d63e7de3bd56a69b25f3576e1568d21a162398","affectsGlobalScope":true,"impliedFormat":1},{"version":"3e93b123f7c2944969d291b35fed2af79a6e9e27fdd5faa99748a51c07c02d28","impliedFormat":1},{"version":"9d19808c8c291a9010a6c788e8532a2da70f811adb431c97520803e0ec649991","impliedFormat":1},{"version":"87aad3dd9752067dc875cfaa466fc44246451c0c560b820796bdd528e29bef40","impliedFormat":1},{"version":"4aacb0dd020eeaef65426153686cc639a78ec2885dc72ad220be1d25f1a439df","impliedFormat":1},{"version":"f0bd7e6d931657b59605c44112eaf8b980ba7f957a5051ed21cb93d978cf2f45","impliedFormat":1},{"version":"8db0ae9cb14d9955b14c214f34dae1b9ef2baee2fe4ce794a4cd3ac2531e3255","affectsGlobalScope":true,"impliedFormat":1},{"version":"15fc6f7512c86810273af28f224251a5a879e4261b4d4c7e532abfbfc3983134","impliedFormat":1},{"version":"58adba1a8ab2d10b54dc1dced4e41f4e7c9772cbbac40939c0dc8ce2cdb1d442","impliedFormat":1},{"version":"2fd4c143eff88dabb57701e6a40e02a4dbc36d5eb1362e7964d32028056a782b","impliedFormat":1},{"version":"714435130b9015fae551788df2a88038471a5a11eb471f27c4ede86552842bc9","impliedFormat":1},{"version":"855cd5f7eb396f5f1ab1bc0f8580339bff77b68a770f84c6b254e319bbfd1ac7","impliedFormat":1},{"version":"5650cf3dace09e7c25d384e3e6b818b938f68f4e8de96f52d9c5a1b3db068e86","impliedFormat":1},{"version":"1354ca5c38bd3fd3836a68e0f7c9f91f172582ba30ab15bb8c075891b91502b7","affectsGlobalScope":true,"impliedFormat":1},{"version":"27fdb0da0daf3b337c5530c5f266efe046a6ceb606e395b346974e4360c36419","impliedFormat":1},{"version":"2d2fcaab481b31a5882065c7951255703ddbe1c0e507af56ea42d79ac3911201","impliedFormat":1},{"version":"a192fe8ec33f75edbc8d8f3ed79f768dfae11ff5735e7fe52bfa69956e46d78d","impliedFormat":1},{"version":"ca867399f7db82df981d6915bcbb2d81131d7d1ef683bc782b59f71dda59bc85","affectsGlobalScope":true,"impliedFormat":1},{"version":"6abe2fd8671c5f80c4c58a404f81ddf39cb7a69df1ad5c50c86debf0ea5ec8e9","affectsGlobalScope":true,"impliedFormat":1},{"version":"9e043a1bc8fbf2a255bccf9bf27e0f1caf916c3b0518ea34aa72357c0afd42ec","impliedFormat":1},{"version":"b4f70ec656a11d570e1a9edce07d118cd58d9760239e2ece99306ee9dfe61d02","impliedFormat":1},{"version":"3bc2f1e2c95c04048212c569ed38e338873f6a8593930cf5a7ef24ffb38fc3b6","impliedFormat":1},{"version":"6e70e9570e98aae2b825b533aa6292b6abd542e8d9f6e9475e88e1d7ba17c866","impliedFormat":1},{"version":"f9d9d753d430ed050dc1bf2667a1bab711ccbb1c1507183d794cc195a5b085cc","impliedFormat":1},{"version":"9eece5e586312581ccd106d4853e861aaaa1a39f8e3ea672b8c3847eedd12f6e","impliedFormat":1},{"version":"47ab634529c5955b6ad793474ae188fce3e6163e3a3fb5edd7e0e48f14435333","impliedFormat":1},{"version":"37ba7b45141a45ce6e80e66f2a96c8a5ab1bcef0fc2d0f56bb58df96ec67e972","impliedFormat":1},{"version":"45650f47bfb376c8a8ed39d4bcda5902ab899a3150029684ee4c10676d9fbaee","impliedFormat":1},{"version":"0225ecb9ed86bdb7a2c7fd01f1556906902929377b44483dc4b83e03b3ef227d","affectsGlobalScope":true,"impliedFormat":1},{"version":"74cf591a0f63db318651e0e04cb55f8791385f86e987a67fd4d2eaab8191f730","impliedFormat":1},{"version":"5eab9b3dc9b34f185417342436ec3f106898da5f4801992d8ff38ab3aff346b5","impliedFormat":1},{"version":"12ed4559eba17cd977aa0db658d25c4047067444b51acfdcbf38470630642b23","affectsGlobalScope":true,"impliedFormat":1},{"version":"f3ffabc95802521e1e4bcba4c88d8615176dc6e09111d920c7a213bdda6e1d65","impliedFormat":1},{"version":"ddc734b4fae82a01d247e9e342d020976640b5e93b4e9b3a1e30e5518883a060","impliedFormat":1},{"version":"ae56f65caf3be91108707bd8dfbccc2a57a91feb5daabf7165a06a945545ed26","impliedFormat":1},{"version":"a136d5de521da20f31631a0a96bf712370779d1c05b7015d7019a9b2a0446ca9","impliedFormat":1},{"version":"c3b41e74b9a84b88b1dca61ec39eee25c0dbc8e7d519ba11bb070918cfacf656","affectsGlobalScope":true,"impliedFormat":1},{"version":"4737a9dc24d0e68b734e6cfbcea0c15a2cfafeb493485e27905f7856988c6b29","affectsGlobalScope":true,"impliedFormat":1},{"version":"36d8d3e7506b631c9582c251a2c0b8a28855af3f76719b12b534c6edf952748d","impliedFormat":1},{"version":"1ca69210cc42729e7ca97d3a9ad48f2e9cb0042bada4075b588ae5387debd318","impliedFormat":1},{"version":"f5ebe66baaf7c552cfa59d75f2bfba679f329204847db3cec385acda245e574e","impliedFormat":1},{"version":"ed59add13139f84da271cafd32e2171876b0a0af2f798d0c663e8eeb867732cf","affectsGlobalScope":true,"impliedFormat":1},{"version":"05db535df8bdc30d9116fe754a3473d1b6479afbc14ae8eb18b605c62677d518","impliedFormat":1},{"version":"b1810689b76fd473bd12cc9ee219f8e62f54a7d08019a235d07424afbf074d25","impliedFormat":1},{"version":"24259d3dae14de55d22f8b3d3e96954e5175a925ab6a830dc05a1993d4794eda","impliedFormat":1},{"version":"27e046d30d55669e9b5a325788a9b4073b05ce62607867754d2918af559a0877","impliedFormat":1},{"version":"be1cc4d94ea60cbe567bc29ed479d42587bf1e6cba490f123d329976b0fe4ee5","impliedFormat":1},{"version":"42bc0e1a903408137c3df2b06dfd7e402cdab5bbfa5fcfb871b22ebfdb30bd0b","impliedFormat":1},{"version":"9894dafe342b976d251aac58e616ac6df8db91fb9d98934ff9dd103e9e82578f","impliedFormat":1},{"version":"413df52d4ea14472c2fa5bee62f7a40abd1eb49be0b9722ee01ee4e52e63beb2","impliedFormat":1},{"version":"db6d2d9daad8a6d83f281af12ce4355a20b9a3e71b82b9f57cddcca0a8964a96","impliedFormat":1},{"version":"446a50749b24d14deac6f8843e057a6355dd6437d1fac4f9e5ce4a5071f34bff","impliedFormat":1},{"version":"182e9fcbe08ac7c012e0a6e2b5798b4352470be29a64fdc114d23c2bab7d5106","impliedFormat":1},{"version":"5c9b31919ea1cb350a7ae5e71c9ced8f11723e4fa258a8cc8d16ae46edd623c7","impliedFormat":1},{"version":"4aa42ce8383b45823b3a1d3811c0fdd5f939f90254bc4874124393febbaf89f6","impliedFormat":1},{"version":"96ffa70b486207241c0fcedb5d9553684f7fa6746bc2b04c519e7ebf41a51205","impliedFormat":1},{"version":"5c24c66b3ba29ce9f2a79c719967e6e944131352a117a0bc43fa5b346b5562b3","impliedFormat":1},{"version":"a86f82d646a739041d6702101afa82dcb935c416dd93cbca7fd754fd0282ce1f","impliedFormat":1},{"version":"ad0d1d75d129b1c80f911be438d6b61bfa8703930a8ff2be2f0e1f8a91841c64","impliedFormat":1},{"version":"ce75b1aebb33d510ff28af960a9221410a3eaf7f18fc5f21f9404075fba77256","impliedFormat":1},{"version":"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855","impliedFormat":1},{"version":"02436d7e9ead85e09a2f8e27d5f47d9464bced31738dec138ca735390815c9f0","impliedFormat":1},{"version":"f4625edcb57b37b84506e8b276eb59ca30d31f88c6656d29d4e90e3bc58e69df","impliedFormat":1},{"version":"78a2869ad0cbf3f9045dda08c0d4562b7e1b2bfe07b19e0db072f5c3c56e9584","impliedFormat":1},{"version":"f8d5ff8eafd37499f2b6a98659dd9b45a321de186b8db6b6142faed0fea3de77","impliedFormat":1},{"version":"c86fe861cf1b4c46a0fb7d74dffe596cf679a2e5e8b1456881313170f092e3fa","impliedFormat":1},{"version":"c685d9f68c70fe11ce527287526585a06ea13920bb6c18482ca84945a4e433a7","impliedFormat":1},{"version":"540cc83ab772a2c6bc509fe1354f314825b5dba3669efdfbe4693ecd3048e34f","impliedFormat":1},{"version":"121b0696021ab885c570bbeb331be8ad82c6efe2f3b93a6e63874901bebc13e3","impliedFormat":1},{"version":"4e01846df98d478a2a626ec3641524964b38acaac13945c2db198bf9f3df22ee","impliedFormat":1},{"version":"678d6d4c43e5728bf66e92fc2269da9fa709cb60510fed988a27161473c3853f","impliedFormat":1},{"version":"ffa495b17a5ef1d0399586b590bd281056cee6ce3583e34f39926f8dcc6ecdb5","impliedFormat":1},{"version":"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855","impliedFormat":1},{"version":"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855","impliedFormat":1},{"version":"8e609bb71c20b858c77f0e9f90bb1319db8477b13f9f965f1a1e18524bf50881","impliedFormat":1},{"version":"8e609bb71c20b858c77f0e9f90bb1319db8477b13f9f965f1a1e18524bf50881","impliedFormat":1},{"version":"aa14cee20aa0db79f8df101fc027d929aec10feb5b8a8da3b9af3895d05b7ba2","impliedFormat":1},{"version":"493c700ac3bd317177b2eb913805c87fe60d4e8af4fb39c41f04ba81fae7e170","impliedFormat":1},{"version":"aeb554d876c6b8c818da2e118d8b11e1e559adbe6bf606cc9a611c1b6c09f670","impliedFormat":1},{"version":"acf5a2ac47b59ca07afa9abbd2b31d001bf7448b041927befae2ea5b1951d9f9","impliedFormat":1},{"version":"8e609bb71c20b858c77f0e9f90bb1319db8477b13f9f965f1a1e18524bf50881","impliedFormat":1},{"version":"d71291eff1e19d8762a908ba947e891af44749f3a2cbc5bd2ec4b72f72ea795f","impliedFormat":1},{"version":"c0480e03db4b816dff2682b347c95f2177699525c54e7e6f6aa8ded890b76be7","impliedFormat":1},{"version":"e2a37ac938c4bede5bb284b9d2d042da299528f1e61f6f57538f1bd37d760869","impliedFormat":1},{"version":"76def37aff8e3a051cf406e10340ffba0f28b6991c5d987474cc11137796e1eb","impliedFormat":1},{"version":"b620391fe8060cf9bedc176a4d01366e6574d7a71e0ac0ab344a4e76576fcbb8","impliedFormat":1},{"version":"3e7efde639c6a6c3edb9847b3f61e308bf7a69685b92f665048c45132f51c218","impliedFormat":1},{"version":"df45ca1176e6ac211eae7ddf51336dc075c5314bc5c253651bae639defd5eec5","impliedFormat":1},{"version":"106c6025f1d99fd468fd8bf6e5bda724e11e5905a4076c5d29790b6c3745e50c","impliedFormat":1},{"version":"ee8df1cb8d0faaca4013a1b442e99130769ce06f438d18d510fed95890067563","impliedFormat":1},{"version":"bfb7f8475428637bee12bdd31bd9968c1c8a1cc2c3e426c959e2f3a307f8936f","impliedFormat":1},{"version":"6f491d0108927478d3247bbbc489c78c2da7ef552fd5277f1ab6819986fdf0b1","impliedFormat":1},{"version":"0d8f2b8781c721170b87a6b662b3cb038fd1a721165ecca390352c818d425872","impliedFormat":1},{"version":"7cb0ee103671d1e201cd53dda12bc1cd0a35f1c63d6102720c6eeb322cb8e17e","impliedFormat":1},{"version":"15a234e5031b19c48a69ccc1607522d6e4b50f57d308ecb7fe863d44cd9f9eb3","impliedFormat":1},{"version":"148679c6d0f449210a96e7d2e562d589e56fcde87f843a92808b3ff103f1a774","impliedFormat":1},{"version":"6459054aabb306821a043e02b89d54da508e3a6966601a41e71c166e4ea1474f","impliedFormat":1},{"version":"2f9c89cbb29d362290531b48880a4024f258c6033aaeb7e59fbc62db26819650","impliedFormat":1},{"version":"bb37588926aba35c9283fe8d46ebf4e79ffe976343105f5c6d45f282793352b2","impliedFormat":1},{"version":"05c97cddbaf99978f83d96de2d8af86aded9332592f08ce4a284d72d0952c391","impliedFormat":1},{"version":"72179f9dd22a86deaad4cc3490eb0fe69ee084d503b686985965654013f1391b","impliedFormat":1},{"version":"2e6114a7dd6feeef85b2c80120fdbfb59a5529c0dcc5bfa8447b6996c97a69f5","impliedFormat":1},{"version":"7b6ff760c8a240b40dab6e4419b989f06a5b782f4710d2967e67c695ef3e93c4","impliedFormat":1},{"version":"c8f004e6036aa1c764ad4ec543cf89a5c1893a9535c80ef3f2b653e370de45e6","impliedFormat":1},{"version":"dd80b1e600d00f5c6a6ba23f455b84a7db121219e68f89f10552c54ba46e4dc9","impliedFormat":1},{"version":"b064c36f35de7387d71c599bfcf28875849a1dbc733e82bd26cae3d1cd060521","impliedFormat":1},{"version":"05c7280d72f3ed26f346cbe7cbbbb002fb7f15739197cbbee6ab3fd1a6cb9347","impliedFormat":1},{"version":"8de9fe97fa9e00ec00666fa77ab6e91b35d25af8ca75dabcb01e14ad3299b150","impliedFormat":1},{"version":"803cd2aaf1921c218916c2c7ee3fce653e852d767177eb51047ff15b5b253893","impliedFormat":1},{"version":"dba114fb6a32b355a9cfc26ca2276834d72fe0e94cd2c3494005547025015369","impliedFormat":1},{"version":"7ab12b2f1249187223d11a589f5789c75177a0b597b9eb7f8e2e42d045393347","impliedFormat":1},{"version":"ad37fb4be61c1035b68f532b7220f4e8236cf245381ce3b90ac15449ecfe7305","impliedFormat":1},{"version":"93436bd74c66baba229bfefe1314d122c01f0d4c1d9e35081a0c4f0470ac1a6c","impliedFormat":1},{"version":"f974e4a06953682a2c15d5bd5114c0284d5abf8bc0fe4da25cb9159427b70072","impliedFormat":1},{"version":"50256e9c31318487f3752b7ac12ff365c8949953e04568009c8705db802776fb","impliedFormat":1},{"version":"7d73b24e7bf31dfb8a931ca6c4245f6bb0814dfae17e4b60c9e194a631fe5f7b","impliedFormat":1},{"version":"d130c5f73768de51402351d5dc7d1b36eaec980ca697846e53156e4ea9911476","impliedFormat":1},{"version":"413586add0cfe7369b64979d4ec2ed56c3f771c0667fbde1bf1f10063ede0b08","impliedFormat":1},{"version":"06472528e998d152375ad3bd8ebcb69ff4694fd8d2effaf60a9d9f25a37a097a","impliedFormat":1},{"version":"50b5bc34ce6b12eccb76214b51aadfa56572aa6cc79c2b9455cdbb3d6c76af1d","impliedFormat":1},{"version":"b7e16ef7f646a50991119b205794ebfd3a4d8f8e0f314981ebbe991639023d0e","impliedFormat":1},{"version":"42c169fb8c2d42f4f668c624a9a11e719d5d07dacbebb63cbcf7ef365b0a75b3","impliedFormat":1},{"version":"a401617604fa1f6ce437b81689563dfdc377069e4c58465dbd8d16069aede0a5","impliedFormat":1},{"version":"6e9082e91370de5040e415cd9f24e595b490382e8c7402c4e938a8ce4bccc99f","impliedFormat":1},{"version":"8695dec09ad439b0ceef3776ea68a232e381135b516878f0901ed2ea114fd0fe","impliedFormat":1},{"version":"304b44b1e97dd4c94697c3313df89a578dca4930a104454c99863f1784a54357","impliedFormat":1},{"version":"d682336018141807fb602709e2d95a192828fcb8d5ba06dda3833a8ea98f69e3","impliedFormat":1},{"version":"6124e973eab8c52cabf3c07575204efc1784aca6b0a30c79eb85fe240a857efa","impliedFormat":1},{"version":"0d891735a21edc75df51f3eb995e18149e119d1ce22fd40db2b260c5960b914e","impliedFormat":1},{"version":"3b414b99a73171e1c4b7b7714e26b87d6c5cb03d200352da5342ab4088a54c85","impliedFormat":1},{"version":"4fbd3116e00ed3a6410499924b6403cc9367fdca303e34838129b328058ede40","impliedFormat":1},{"version":"b01bd582a6e41457bc56e6f0f9de4cb17f33f5f3843a7cf8210ac9c18472fb0f","impliedFormat":1},{"version":"0a437ae178f999b46b6153d79095b60c42c996bc0458c04955f1c996dc68b971","impliedFormat":1},{"version":"74b2a5e5197bd0f2e0077a1ea7c07455bbea67b87b0869d9786d55104006784f","impliedFormat":1},{"version":"4a7baeb6325920044f66c0f8e5e6f1f52e06e6d87588d837bdf44feb6f35c664","impliedFormat":1},{"version":"12d218a49dbe5655b911e6cc3c13b2c655e4c783471c3b0432137769c79e1b3c","impliedFormat":1},{"version":"7274fbffbd7c9589d8d0ffba68157237afd5cecff1e99881ea3399127e60572f","impliedFormat":1},{"version":"6b0fc04121360f752d196ba35b6567192f422d04a97b2840d7d85f8b79921c92","impliedFormat":1},{"version":"65a15fc47900787c0bd18b603afb98d33ede930bed1798fc984d5ebb78b26cf9","impliedFormat":1},{"version":"9d202701f6e0744adb6314d03d2eb8fc994798fc83d91b691b75b07626a69801","impliedFormat":1},{"version":"a365c4d3bed3be4e4e20793c999c51f5cd7e6792322f14650949d827fbcd170f","impliedFormat":1},{"version":"c5426dbfc1cf90532f66965a7aa8c1136a78d4d0f96d8180ecbfc11d7722f1a5","impliedFormat":1},{"version":"9c82171d836c47486074e4ca8e059735bf97b205e70b196535b5efd40cbe1bc5","impliedFormat":1},{"version":"f374cb24e93e7798c4d9e83ff872fa52d2cdb36306392b840a6ddf46cb925cb6","impliedFormat":1},{"version":"42b81043b00ff27c6bd955aea0f6e741545f2265978bf364b614702b72a027ab","impliedFormat":1},{"version":"de9d2df7663e64e3a91bf495f315a7577e23ba088f2949d5ce9ec96f44fba37d","impliedFormat":1},{"version":"c7af78a2ea7cb1cd009cfb5bdb48cd0b03dad3b54f6da7aab615c2e9e9d570c5","impliedFormat":1},{"version":"1ee45496b5f8bdee6f7abc233355898e5bf9bd51255db65f5ff7ede617ca0027","impliedFormat":1},{"version":"97e5ccc7bb88419005cbdf812243a5b3186cdef81b608540acabe1be163fc3e4","affectsGlobalScope":true,"impliedFormat":1},{"version":"3fbdd025f9d4d820414417eeb4107ffa0078d454a033b506e22d3a23bc3d9c41","affectsGlobalScope":true,"impliedFormat":1},{"version":"a8f8e6ab2fa07b45251f403548b78eaf2022f3c2254df3dc186cb2671fe4996d","affectsGlobalScope":true,"impliedFormat":1},{"version":"fa6c12a7c0f6b84d512f200690bfc74819e99efae69e4c95c4cd30f6884c526e","impliedFormat":1},{"version":"f1c32f9ce9c497da4dc215c3bc84b722ea02497d35f9134db3bb40a8d918b92b","impliedFormat":1},{"version":"b73c319af2cc3ef8f6421308a250f328836531ea3761823b4cabbd133047aefa","affectsGlobalScope":true,"impliedFormat":1},{"version":"e433b0337b8106909e7953015e8fa3f2d30797cea27141d1c5b135365bb975a6","impliedFormat":1},{"version":"9f9bb6755a8ce32d656ffa4763a8144aa4f274d6b69b59d7c32811031467216e","impliedFormat":1},{"version":"5c32bdfbd2d65e8fffbb9fbda04d7165e9181b08dad61154961852366deb7540","impliedFormat":1},{"version":"ddff7fc6edbdc5163a09e22bf8df7bef75f75369ebd7ecea95ba55c4386e2441","impliedFormat":1},{"version":"6b3453eebd474cc8acf6d759f1668e6ce7425a565e2996a20b644c72916ecf75","impliedFormat":1},{"version":"0c05e9842ec4f8b7bfebfd3ca61604bb8c914ba8da9b5337c4f25da427a005f2","impliedFormat":1},{"version":"89cd3444e389e42c56fd0d072afef31387e7f4107651afd2c03950f22dc36f77","impliedFormat":1},{"version":"7f2aa4d4989a82530aaac3f72b3dceca90e9c25bee0b1a327e8a08a1262435ad","impliedFormat":1},{"version":"e39a304f882598138a8022106cb8de332abbbb87f3fee71c5ca6b525c11c51fc","impliedFormat":1},{"version":"faed7a5153215dbd6ebe76dfdcc0af0cfe760f7362bed43284be544308b114cf","impliedFormat":1},{"version":"fcdf3e40e4a01b9a4b70931b8b51476b210c511924fcfe3f0dae19c4d52f1a54","impliedFormat":1},{"version":"345c4327b637d34a15aba4b7091eb068d6ab40a3dedaab9f00986253c9704e53","impliedFormat":1},{"version":"3a788c7fb7b1b1153d69a4d1d9e1d0dfbcf1127e703bdb02b6d12698e683d1fb","impliedFormat":1},{"version":"2e4f37ffe8862b14d8e24ae8763daaa8340c0df0b859d9a9733def0eee7562d9","impliedFormat":1},{"version":"d38530db0601215d6d767f280e3a3c54b2a83b709e8d9001acb6f61c67e965fc","impliedFormat":1},{"version":"6ac6715916fa75a1f7ebdfeacac09513b4d904b667d827b7535e84ff59679aff","impliedFormat":1},{"version":"4805f6161c2c8cefb8d3b8bd96a080c0fe8dbc9315f6ad2e53238f9a79e528a6","impliedFormat":1},{"version":"b83cb14474fa60c5f3ec660146b97d122f0735627f80d82dd03e8caa39b4388c","impliedFormat":1},{"version":"2b5b70d7782fe028487a80a1c214e67bd610532b9f978b78fa60f5b4a359f77e","impliedFormat":1},{"version":"7ee86fbb3754388e004de0ef9e6505485ddfb3be7640783d6d015711c03d302d","impliedFormat":1},{"version":"1a82deef4c1d39f6882f28d275cad4c01f907b9b39be9cbc472fcf2cf051e05b","impliedFormat":1},{"version":"162e071992b34bc36ca257d629547f93cb43728d6fe073ad18a237e4f7c52d7d","impliedFormat":1},{"version":"b73cbf0a72c8800cf8f96a9acfe94f3ad32ca71342a8908b8ae484d61113f647","impliedFormat":1},{"version":"bae6dd176832f6423966647382c0d7ba9e63f8c167522f09a982f086cd4e8b23","impliedFormat":1},{"version":"20865ac316b8893c1a0cc383ccfc1801443fbcc2a7255be166cf90d03fac88c9","impliedFormat":1},{"version":"c9958eb32126a3843deedda8c22fb97024aa5d6dd588b90af2d7f2bfac540f23","impliedFormat":1},{"version":"461d0ad8ae5f2ff981778af912ba71b37a8426a33301daa00f21c6ccb27f8156","impliedFormat":1},{"version":"e927c2c13c4eaf0a7f17e6022eee8519eb29ef42c4c13a31e81a611ab8c95577","impliedFormat":1},{"version":"fcafff163ca5e66d3b87126e756e1b6dfa8c526aa9cd2a2b0a9da837d81bbd72","impliedFormat":1},{"version":"70246ad95ad8a22bdfe806cb5d383a26c0c6e58e7207ab9c431f1cb175aca657","impliedFormat":1},{"version":"f00f3aa5d64ff46e600648b55a79dcd1333458f7a10da2ed594d9f0a44b76d0b","impliedFormat":1},{"version":"772d8d5eb158b6c92412c03228bd9902ccb1457d7a705b8129814a5d1a6308fc","impliedFormat":1},{"version":"802e797bcab5663b2c9f63f51bdf67eff7c41bc64c0fd65e6da3e7941359e2f7","impliedFormat":1},{"version":"8b4327413e5af38cd8cb97c59f48c3c866015d5d642f28518e3a891c469f240e","impliedFormat":1},{"version":"7e6ac205dcb9714f708354fd863bffa45cee90740706cc64b3b39b23ebb84744","impliedFormat":1},{"version":"61dc6e3ac78d64aa864eedd0a208b97b5887cc99c5ba65c03287bf57d83b1eb9","impliedFormat":1},{"version":"4b20fcf10a5413680e39f5666464859fc56b1003e7dfe2405ced82371ebd49b6","impliedFormat":1},{"version":"c06ef3b2569b1c1ad99fcd7fe5fba8d466e2619da5375dfa940a94e0feea899b","impliedFormat":1},{"version":"f7d628893c9fa52ba3ab01bcb5e79191636c4331ee5667ecc6373cbccff8ae12","impliedFormat":1},{"version":"1d879125d1ec570bf04bc1f362fdbe0cb538315c7ac4bcfcdf0c1e9670846aa6","impliedFormat":1},{"version":"8baa8dbdc393e3c6b26e8e31384b938756ce2effdc126648d43e58291ce9869b","impliedFormat":1},{"version":"933aee906d42ea2c53b6892192a8127745f2ec81a90695df4024308ba35a8ff4","impliedFormat":1},{"version":"d663134457d8d669ae0df34eabd57028bddc04fc444c4bc04bc5215afc91e1f4","impliedFormat":1},{"version":"985153f0deb9b4391110331a2f0c114019dbea90cba5ca68a4107700796e0d75","impliedFormat":1},{"version":"a3e3f0efcae272ab8ee3298e4e819f7d9dd9ff411101f45444877e77cfeca9a4","impliedFormat":1},{"version":"43e96a3d5d1411ab40ba2f61d6a3192e58177bcf3b133a80ad2a16591611726d","impliedFormat":1},{"version":"58659b06d33fa430bee1105b75cf876c0a35b2567207487c8578aec51ca2d977","impliedFormat":1},{"version":"71d9eb4c4e99456b78ae182fb20a5dfc20eb1667f091dbb9335b3c017dd1c783","impliedFormat":1},{"version":"cfa846a7b7847a1d973605fbb8c91f47f3a0f0643c18ac05c47077ebc72e71c7","impliedFormat":1},{"version":"30e6520444df1a004f46fdc8096f3fe06f7bbd93d09c53ada9dcdde59919ccca","impliedFormat":1},{"version":"6c800b281b9e89e69165fd11536195488de3ff53004e55905e6c0059a2d8591e","impliedFormat":1},{"version":"7d4254b4c6c67a29d5e7f65e67d72540480ac2cfb041ca484847f5ae70480b62","impliedFormat":1},{"version":"a58beefce74db00dbb60eb5a4bb0c6726fb94c7797c721f629142c0ae9c94306","impliedFormat":1},{"version":"41eeb453ccb75c5b2c3abef97adbbd741bd7e9112a2510e12f03f646dc9ad13d","impliedFormat":1},{"version":"502fa5863df08b806dbf33c54bee8c19f7e2ad466785c0fc35465d7c5ff80995","impliedFormat":1},{"version":"c91a2d08601a1547ffef326201be26db94356f38693bb18db622ae5e9b3d7c92","impliedFormat":1},{"version":"888cda0fa66d7f74e985a3f7b1af1f64b8ff03eb3d5e80d051c3cbdeb7f32ab7","impliedFormat":1},{"version":"60681e13f3545be5e9477acb752b741eae6eaf4cc01658a25ec05bff8b82a2ef","impliedFormat":1},{"version":"8b4b8ebc2d99ae651c5c4169ee8b24e2b0e02a3dfaef84e357d677b663c18fdf","impliedFormat":1},{"version":"a57b1802794433adec9ff3fed12aa79d671faed86c49b09e02e1ac41b4f1d33a","impliedFormat":1},{"version":"ad10d4f0517599cdeca7755b930f148804e3e0e5b5a3847adce0f1f71bbccd74","impliedFormat":1},{"version":"1042064ece5bb47d6aba91648fbe0635c17c600ebdf567588b4ca715602f0a9d","impliedFormat":1},{"version":"c49469a5349b3cc1965710b5b0f98ed6c028686aa8450bcb3796728873eb923e","impliedFormat":1},{"version":"4a889f2c763edb4d55cb624257272ac10d04a1cad2ed2948b10ed4a7fda2a428","impliedFormat":1},{"version":"7bb79aa2fead87d9d56294ef71e056487e848d7b550c9a367523ee5416c44cfa","impliedFormat":1},{"version":"d88ea80a6447d7391f52352ec97e56b52ebec934a4a4af6e2464cfd8b39c3ba8","impliedFormat":1},{"version":"55095860901097726220b6923e35a812afdd49242a1246d7b0942ee7eb34c6e4","impliedFormat":1},{"version":"96171c03c2e7f314d66d38acd581f9667439845865b7f85da8df598ff9617476","impliedFormat":1},{"version":"27ff4196654e6373c9af16b6165120e2dd2169f9ad6abb5c935af5abd8c7938c","impliedFormat":1},{"version":"bb8f2dbc03533abca2066ce4655c119bff353dd4514375beb93c08590c03e023","impliedFormat":1},{"version":"d193c8a86144b3a87b22bc1f5534b9c3e0f5a187873ec337c289a183973a58fe","impliedFormat":1},{"version":"1a6e6ba8a07b74e3ad237717c0299d453f9ceb795dbc2f697d1f2dd07cb782d2","impliedFormat":1},{"version":"58d70c38037fc0f949243388ff7ae20cf43321107152f14a9d36ca79311e0ada","impliedFormat":1},{"version":"f56bdc6884648806d34bc66d31cdb787c4718d04105ce2cd88535db214631f82","impliedFormat":1},{"version":"190da5eac6478d61ab9731ab2146fbc0164af2117a363013249b7e7992f1cccb","impliedFormat":1},{"version":"01479d9d5a5dda16d529b91811375187f61a06e74be294a35ecce77e0b9e8d6c","impliedFormat":1},{"version":"49f95e989b4632c6c2a578cc0078ee19a5831832d79cc59abecf5160ea71abad","impliedFormat":1},{"version":"9666533332f26e8995e4d6fe472bdeec9f15d405693723e6497bf94120c566c8","impliedFormat":1},{"version":"ce0df82a9ae6f914ba08409d4d883983cc08e6d59eb2df02d8e4d68309e7848b","impliedFormat":1},{"version":"796273b2edc72e78a04e86d7c58ae94d370ab93a0ddf40b1aa85a37a1c29ecd7","impliedFormat":1},{"version":"5df15a69187d737d6d8d066e189ae4f97e41f4d53712a46b2710ff9f8563ec9f","impliedFormat":1},{"version":"1a4dc28334a926d90ba6a2d811ba0ff6c22775fcc13679521f034c124269fd40","impliedFormat":1},{"version":"f05315ff85714f0b87cc0b54bcd3dde2716e5a6b99aedcc19cad02bf2403e08c","impliedFormat":1},{"version":"8a8c64dafaba11c806efa56f5c69f611276471bef80a1db1f71316ec4168acef","impliedFormat":1},{"version":"43ba4f2fa8c698f5c304d21a3ef596741e8e85a810b7c1f9b692653791d8d97a","impliedFormat":1},{"version":"5fad3b31fc17a5bc58095118a8b160f5260964787c52e7eb51e3d4fcf5d4a6f0","impliedFormat":1},{"version":"72105519d0390262cf0abe84cf41c926ade0ff475d35eb21307b2f94de985778","impliedFormat":1},{"version":"d0a4cac61fa080f2be5ebb68b82726be835689b35994ba0e22e3ed4d2bc45e3b","impliedFormat":1},{"version":"c857e0aae3f5f444abd791ec81206020fbcc1223e187316677e026d1c1d6fe08","impliedFormat":1},{"version":"ccf6dd45b708fb74ba9ed0f2478d4eb9195c9dfef0ff83a6092fa3cf2ff53b4f","impliedFormat":1},{"version":"2d7db1d73456e8c5075387d4240c29a2a900847f9c1bff106a2e490da8fbd457","impliedFormat":1},{"version":"2b15c805f48e4e970f8ec0b1915f22d13ca6212375e8987663e2ef5f0205e832","impliedFormat":1},{"version":"205a31b31beb7be73b8df18fcc43109cbc31f398950190a0967afc7a12cb478c","impliedFormat":1},{"version":"8fca3039857709484e5893c05c1f9126ab7451fa6c29e19bb8c2411a2e937345","impliedFormat":1},{"version":"35069c2c417bd7443ae7c7cafd1de02f665bf015479fec998985ffbbf500628c","impliedFormat":1},{"version":"dba6c7006e14a98ec82999c6f89fbbbfd1c642f41db148535f3b77b8018829b8","impliedFormat":1},{"version":"7f897b285f22a57a5c4dc14a27da2747c01084a542b4d90d33897216dceeea2e","impliedFormat":1},{"version":"7e0b7f91c5ab6e33f511efc640d36e6f933510b11be24f98836a20a2dc914c2d","impliedFormat":1},{"version":"045b752f44bf9bbdcaffd882424ab0e15cb8d11fa94e1448942e338c8ef19fba","impliedFormat":1},{"version":"2894c56cad581928bb37607810af011764a2f511f575d28c9f4af0f2ef02d1ab","impliedFormat":1},{"version":"0a72186f94215d020cb386f7dca81d7495ab6c17066eb07d0f44a5bf33c1b21a","impliedFormat":1},{"version":"d96b39301d0ded3f1a27b47759676a33a02f6f5049bfcbde81e533fd10f50dcb","impliedFormat":1},{"version":"2ded4f930d6abfaa0625cf55e58f565b7cbd4ab5b574dd2cb19f0a83a2f0be8b","impliedFormat":1},{"version":"0aedb02516baf3e66b2c1db9fef50666d6ed257edac0f866ea32f1aa05aa474f","impliedFormat":1},{"version":"ca0f4d9068d652bad47e326cf6ba424ac71ab866e44b24ddb6c2bd82d129586a","affectsGlobalScope":true,"impliedFormat":1},{"version":"04d36005fcbeac741ac50c421181f4e0316d57d148d37cc321a8ea285472462b","impliedFormat":1},{"version":"9e2739b32f741859263fdba0244c194ca8e96da49b430377930b8f721d77c000","impliedFormat":1},{"version":"56ccb49443bfb72e5952f7012f0de1a8679f9f75fc93a5c1ac0bafb28725fc5f","impliedFormat":1},{"version":"20fa37b636fdcc1746ea0738f733d0aed17890d1cd7cb1b2f37010222c23f13e","impliedFormat":1},{"version":"d90b9f1520366d713a73bd30c5a9eb0040d0fb6076aff370796bc776fd705943","impliedFormat":1},{"version":"bc03c3c352f689e38c0ddd50c39b1e65d59273991bfc8858a9e3c0ebb79c023b","impliedFormat":1},{"version":"19df3488557c2fc9b4d8f0bac0fd20fb59aa19dec67c81f93813951a81a867f8","affectsGlobalScope":true,"impliedFormat":1},{"version":"b25350193e103ae90423c5418ddb0ad1168dc9c393c9295ef34980b990030617","affectsGlobalScope":true,"impliedFormat":1},{"version":"bef86adb77316505c6b471da1d9b8c9e428867c2566270e8894d4d773a1c4dc2","impliedFormat":1},{"version":"a46dba563f70f32f9e45ae015f3de979225f668075d7a427f874e0f6db584991","impliedFormat":1},{"version":"6ac6715916fa75a1f7ebdfeacac09513b4d904b667d827b7535e84ff59679aff","impliedFormat":1},{"version":"2652448ac55a2010a1f71dd141f828b682298d39728f9871e1cdf8696ef443fd","impliedFormat":1},{"version":"02c4fc9e6bb27545fa021f6056e88ff5fdf10d9d9f1467f1d10536c6e749ac50","impliedFormat":1},{"version":"120599fd965257b1f4d0ff794bc696162832d9d8467224f4665f713a3119078b","impliedFormat":1},{"version":"5433f33b0a20300cca35d2f229a7fc20b0e8477c44be2affeb21cb464af60c76","impliedFormat":1},{"version":"db036c56f79186da50af66511d37d9fe77fa6793381927292d17f81f787bb195","impliedFormat":1},{"version":"bd4131091b773973ca5d2326c60b789ab1f5e02d8843b3587effe6e1ea7c9d86","impliedFormat":1},{"version":"c7f6485931085bf010fbaf46880a9b9ec1a285ad9dc8c695a9e936f5a48f34b4","impliedFormat":1},{"version":"14f6b927888a1112d662877a5966b05ac1bf7ed25d6c84386db4c23c95a5363b","impliedFormat":1},{"version":"6ac6715916fa75a1f7ebdfeacac09513b4d904b667d827b7535e84ff59679aff","impliedFormat":1},{"version":"622694a8522b46f6310c2a9b5d2530dde1e2854cb5829354e6d1ff8f371cf469","impliedFormat":1},{"version":"d24ff95760ea2dfcc7c57d0e269356984e7046b7e0b745c80fea71559f15bdd8","impliedFormat":1},{"version":"a9e6c0ff3f8186fccd05752cf75fc94e147c02645087ac6de5cc16403323d870","impliedFormat":1},{"version":"49c346823ba6d4b12278c12c977fb3a31c06b9ca719015978cb145eb86da1c61","impliedFormat":1},{"version":"bfac6e50eaa7e73bb66b7e052c38fdc8ccfc8dbde2777648642af33cf349f7f1","impliedFormat":1},{"version":"92f7c1a4da7fbfd67a2228d1687d5c2e1faa0ba865a94d3550a3941d7527a45d","impliedFormat":1},{"version":"f53b120213a9289d9a26f5af90c4c686dd71d91487a0aa5451a38366c70dc64b","impliedFormat":1},{"version":"83fe880c090afe485a5c02262c0b7cdd76a299a50c48d9bde02be8e908fb4ae6","impliedFormat":1},{"version":"13c1b657932e827a7ed510395d94fc8b743b9d053ab95b7cd829b2bc46fb06db","impliedFormat":1},{"version":"57d67b72e06059adc5e9454de26bbfe567d412b962a501d263c75c2db430f40e","impliedFormat":1},{"version":"6511e4503cf74c469c60aafd6589e4d14d5eb0a25f9bf043dcbecdf65f261972","impliedFormat":1},{"version":"078131f3a722a8ad3fc0b724cd3497176513cdcb41c80f96a3acbda2a143b58e","impliedFormat":1},{"version":"8c70ddc0c22d85e56011d49fddfaae3405eb53d47b59327b9dd589e82df672e7","impliedFormat":1},{"version":"a67b87d0281c97dfc1197ef28dfe397fc2c865ccd41f7e32b53f647184cc7307","impliedFormat":1},{"version":"771ffb773f1ddd562492a6b9aaca648192ac3f056f0e1d997678ff97dbb6bf9b","impliedFormat":1},{"version":"232f70c0cf2b432f3a6e56a8dc3417103eb162292a9fd376d51a3a9ea5fbbf6f","impliedFormat":1},{"version":"9e155d2255348d950b1f65643fb26c0f14f5109daf8bd9ee24a866ad0a743648","affectsGlobalScope":true,"impliedFormat":1},{"version":"0b103e9abfe82d14c0ad06a55d9f91d6747154ef7cacc73cf27ecad2bfb3afcf","impliedFormat":1},{"version":"7a883e9c84e720810f86ef4388f54938a65caa0f4d181a64e9255e847a7c9f51","impliedFormat":1},{"version":"a0ba218ac1baa3da0d5d9c1ec1a7c2f8676c284e6f5b920d6d049b13fa267377","impliedFormat":1},{"version":"8a0e762ceb20c7e72504feef83d709468a70af4abccb304f32d6b9bac1129b2c","impliedFormat":1},{"version":"d408d6f32de8d1aba2ff4a20f1aa6a6edd7d92c997f63b90f8ad3f9017cf5e46","impliedFormat":1},{"version":"9252d498a77517aab5d8d4b5eb9d71e4b225bbc7123df9713e08181de63180f6","impliedFormat":1},{"version":"221e915caef37c5cbaabd4946418f97dcc20591469e260732b31008321024dd8","impliedFormat":1},{"version":"35e6379c3f7cb27b111ad4c1aa69538fd8e788ab737b8ff7596a1b40e96f4f90","impliedFormat":1},{"version":"1fffe726740f9787f15b532e1dc870af3cd964dbe29e191e76121aa3dd8693f2","impliedFormat":1},{"version":"371bf6127c1d427836de95197155132501cb6b69ef8709176ce6e0b85d059264","impliedFormat":1},{"version":"2bafd700e617d3693d568e972d02b92224b514781f542f70d497a8fdf92d52a2","affectsGlobalScope":true,"impliedFormat":1},{"version":"5542d8a7ea13168cb573be0d1ba0d29460d59430fb12bb7bf4674efd5604e14c","impliedFormat":1},{"version":"af48e58339188d5737b608d41411a9c054685413d8ae88b8c1d0d9bfabdf6e7e","impliedFormat":1},{"version":"616775f16134fa9d01fc677ad3f76e68c051a056c22ab552c64cc281a9686790","impliedFormat":1},{"version":"65c24a8baa2cca1de069a0ba9fba82a173690f52d7e2d0f1f7542d59d5eb4db0","impliedFormat":1},{"version":"f9fe6af238339a0e5f7563acee3178f51db37f32a2e7c09f85273098cee7ec49","impliedFormat":1},{"version":"1de8c302fd35220d8f29dea378a4ae45199dc8ff83ca9923aca1400f2b28848a","impliedFormat":1},{"version":"77e71242e71ebf8528c5802993697878f0533db8f2299b4d36aa015bae08a79c","impliedFormat":1},{"version":"98a787be42bd92f8c2a37d7df5f13e5992da0d967fab794adbb7ee18370f9849","impliedFormat":1},{"version":"332248ee37cca52903572e66c11bef755ccc6e235835e63d3c3e60ddda3e9b93","impliedFormat":1},{"version":"94e8cc88ae2ef3d920bb3bdc369f48436db123aa2dc07f683309ad8c9968a1e1","impliedFormat":1},{"version":"4545c1a1ceca170d5d83452dd7c4994644c35cf676a671412601689d9a62da35","impliedFormat":1},{"version":"320f4091e33548b554d2214ce5fc31c96631b513dffa806e2e3a60766c8c49d9","impliedFormat":1},{"version":"a2d648d333cf67b9aeac5d81a1a379d563a8ffa91ddd61c6179f68de724260ff","impliedFormat":1},{"version":"d90d5f524de38889d1e1dbc2aeef00060d779f8688c02766ddb9ca195e4a713d","impliedFormat":1},{"version":"a3f41ed1b4f2fc3049394b945a68ae4fdefd49fa1739c32f149d32c0545d67f5","impliedFormat":1},{"version":"b0309e1eda99a9e76f87c18992d9c3689b0938266242835dd4611f2b69efe456","impliedFormat":1},{"version":"47699512e6d8bebf7be488182427189f999affe3addc1c87c882d36b7f2d0b0e","impliedFormat":1},{"version":"6ceb10ca57943be87ff9debe978f4ab73593c0c85ee802c051a93fc96aaf7a20","impliedFormat":1},{"version":"1de3ffe0cc28a9fe2ac761ece075826836b5a02f340b412510a59ba1d41a505a","impliedFormat":1},{"version":"e46d6cc08d243d8d0d83986f609d830991f00450fb234f5b2f861648c42dc0d8","impliedFormat":1},{"version":"1c0a98de1323051010ce5b958ad47bc1c007f7921973123c999300e2b7b0ecc0","impliedFormat":1},{"version":"ff863d17c6c659440f7c5c536e4db7762d8c2565547b2608f36b798a743606ca","impliedFormat":1},{"version":"5412ad0043cd60d1f1406fc12cb4fb987e9a734decbdd4db6f6acf71791e36fe","impliedFormat":1},{"version":"ad036a85efcd9e5b4f7dd5c1a7362c8478f9a3b6c3554654ca24a29aa850a9c5","impliedFormat":1},{"version":"fedebeae32c5cdd1a85b4e0504a01996e4a8adf3dfa72876920d3dd6e42978e7","impliedFormat":1},{"version":"b6c1f64158da02580f55e8a2728eda6805f79419aed46a930f43e68ad66a38fc","impliedFormat":1},{"version":"cdf21eee8007e339b1b9945abf4a7b44930b1d695cc528459e68a3adc39a622e","impliedFormat":1},{"version":"bc9ee0192f056b3d5527bcd78dc3f9e527a9ba2bdc0a2c296fbc9027147df4b2","impliedFormat":1},{"version":"330896c1a2b9693edd617be24fbf9e5895d6e18c7955d6c08f028f272b37314d","impliedFormat":1},{"version":"1d9c0a9a6df4e8f29dc84c25c5aa0bb1da5456ebede7a03e03df08bb8b27bae6","impliedFormat":1},{"version":"84380af21da938a567c65ef95aefb5354f676368ee1a1cbb4cae81604a4c7d17","impliedFormat":1},{"version":"1af3e1f2a5d1332e136f8b0b95c0e6c0a02aaabd5092b36b64f3042a03debf28","impliedFormat":1},{"version":"30d8da250766efa99490fc02801047c2c6d72dd0da1bba6581c7e80d1d8842a4","impliedFormat":1},{"version":"03566202f5553bd2d9de22dfab0c61aa163cabb64f0223c08431fb3fc8f70280","impliedFormat":1},{"version":"4c0a1233155afb94bd4d7518c75c84f98567cd5f13fc215d258de196cdb40d91","impliedFormat":1},{"version":"e7765aa8bcb74a38b3230d212b4547686eb9796621ffb4367a104451c3f9614f","impliedFormat":1},{"version":"1de80059b8078ea5749941c9f863aa970b4735bdbb003be4925c853a8b6b4450","impliedFormat":1},{"version":"1d079c37fa53e3c21ed3fa214a27507bda9991f2a41458705b19ed8c2b61173d","impliedFormat":1},{"version":"5bf5c7a44e779790d1eb54c234b668b15e34affa95e78eada73e5757f61ed76a","impliedFormat":1},{"version":"5835a6e0d7cd2738e56b671af0e561e7c1b4fb77751383672f4b009f4e161d70","impliedFormat":1},{"version":"5c634644d45a1b6bc7b05e71e05e52ec04f3d73d9ac85d5927f647a5f965181a","impliedFormat":1},{"version":"4b7f74b772140395e7af67c4841be1ab867c11b3b82a51b1aeb692822b76c872","impliedFormat":1},{"version":"27be6622e2922a1b412eb057faa854831b95db9db5035c3f6d4b677b902ab3b7","impliedFormat":1},{"version":"a68d4b3182e8d776cdede7ac9630c209a7bfbb59191f99a52479151816ef9f9e","impliedFormat":99},{"version":"39644b343e4e3d748344af8182111e3bbc594930fff0170256567e13bbdbebb0","impliedFormat":99},{"version":"ed7fd5160b47b0de3b1571c5c5578e8e7e3314e33ae0b8ea85a895774ee64749","impliedFormat":99},{"version":"63a7595a5015e65262557f883463f934904959da563b4f788306f699411e9bac","impliedFormat":1},{"version":"4ba137d6553965703b6b55fd2000b4e07ba365f8caeb0359162ad7247f9707a6","impliedFormat":1},{"version":"6de125ea94866c736c6d58d68eb15272cf7d1020a5b459fea1c660027eca9a90","affectsGlobalScope":true,"impliedFormat":1},{"version":"8fac4a15690b27612d8474fb2fc7cc00388df52d169791b78d1a3645d60b4c8b","affectsGlobalScope":true,"impliedFormat":1},{"version":"064ac1c2ac4b2867c2ceaa74bbdce0cb6a4c16e7c31a6497097159c18f74aa7c","impliedFormat":1},{"version":"3dc14e1ab45e497e5d5e4295271d54ff689aeae00b4277979fdd10fa563540ae","impliedFormat":1},{"version":"d3b315763d91265d6b0e7e7fa93cfdb8a80ce7cdd2d9f55ba0f37a22db00bdb8","impliedFormat":1},{"version":"b789bf89eb19c777ed1e956dbad0925ca795701552d22e68fd130a032008b9f9","impliedFormat":1},{"version":"e129b0d66d9b3ba6df7523f330bcee363dbf1e1f5570bcb797e3d3b55fa5d8d2","affectsGlobalScope":true},"7ad303e40d4fddf44f156129e397511953a71481c5cfd86b1862649aaaf240cc",{"version":"6678de633bd595628168da887a1d24e0caa5304f7586b2a92cb52499ab55eeb0","impliedFormat":99},{"version":"9db46d1322ca3b7e5c982a915070ca7c05212e55f277f4d02ac3f74ff8ece67c","impliedFormat":99},{"version":"f6fc0ed8b8811ad1b451511cc3ee3581f82c2227cc140a47a86c383a48b2f490","impliedFormat":99},{"version":"f6fc0ed8b8811ad1b451511cc3ee3581f82c2227cc140a47a86c383a48b2f490","impliedFormat":99},{"version":"c1d15bfb5df457b54922d3b9664796190d6cbe1faf0c892f4e873b45730c0447","impliedFormat":99},{"version":"d5d6b53334d846db54bc6f1a35d52202c5c19cee3cd3a0effba959381f7e2feb","impliedFormat":99},{"version":"e9bd3457d2cae491c4d26473c160431ce2be929865d147b3ee733ff73bb9481f","impliedFormat":99},{"version":"f3d73901e4383f84add3a98573a2738ac5d0cbc648697c302b69b26b75ee140f","impliedFormat":99},{"version":"4acccd722f80edbf731840b8363e17f18f679434a4578ee44f1d3b70c67d858c","impliedFormat":99},{"version":"b3fae73d7dd47d6be5831e14cfa75be9ad8ad5da6ca1f1777bb30be81d744d2b","impliedFormat":99},{"version":"7046e54e5c1d78dca3747c07294829e3bdb773ae5853d3f186ea3bba5b6feef7","signature":"9c0eeb8de8dfdfb63ebcef09564c84ae1f6b6187c8e8e274fc5b0ee0a2c8432b"},{"version":"8e609bb71c20b858c77f0e9f90bb1319db8477b13f9f965f1a1e18524bf50881","impliedFormat":1},{"version":"ce156ed1e82e1a9e4ceef49d98c510638bfa290142ec17ddd0a295871e58af17","impliedFormat":1},{"version":"2729bdb66a2d3d6dbb88c897cec50bf8e1cd0b63b9c3979d5c7691ce788354c0","impliedFormat":1},{"version":"381f1c97bad454d7579bd2283904d0f19b4398cc62ffc6d30eeae78a009e21cd","signature":"8c6629d3a6f36715b1324431569f1fa65e10d84dcc82e87967a1aa1c5f4a9da4"},{"version":"03981a348c4473a6a0bbaf606b651043860c8fc3efd7786bc02c4a1e05bf37b1","impliedFormat":99},{"version":"fb82344c312fd920a25c33ae4e0381023f46ef1432775cda1d9ab50077e639a8","impliedFormat":99},{"version":"e0037499acbd201cd60956a4d54ee45e4953cd60f80a2d8acb1bd13c9b134842","impliedFormat":99},{"version":"92339882b71c2ec1f48f82fe70d4ccd003822c4959169f0bab4f1ed0e99dd486","impliedFormat":99},{"version":"d627151917233bf28874a54e2478a6c5e15ef92b7aa8ed0500ca663d1510ce26","impliedFormat":99},{"version":"5fb1b2ce00b645b22fa28bb565b01bb87ba991e58bc6058a02fec611e7d727d8","impliedFormat":99},{"version":"a9b4b1235cc7b2ca1a3bf02e9ad19b7b0aa897b7fba1d138b9b4f8b7baba83fe","impliedFormat":99},{"version":"ba90eb33597e9d44217593b9a0c5753743445e1a4a9e4ce3e15c185f009d60b0","impliedFormat":99},{"version":"e3507ff969a7c1c9d55e0e6a7986d863433ac6fab17e27f5fa6c8d0fd79c15be","impliedFormat":99},{"version":"8bb642bc24d7a21e67124613f77174e377b053b4e50f08d3bb8b4b71c30da185","impliedFormat":99},{"version":"c043623180122dddecf5565e0809ea90426d6fc370454cd2ba1ab99ca3398248","impliedFormat":99},{"version":"70f20697bc3ed03af85920db61fb1e4388fffa37cd2e0c0d937e7608f5608bd1","impliedFormat":99},{"version":"5e35a2a3f0b62ee763fd1d1f13cdec015ea10fb1ed7a670989b1ba49b37ad287","impliedFormat":1},{"version":"b3b5aca751100320745c8bfd826202aed7d753d336448ce2265b9470dfa8a298","impliedFormat":1},{"version":"5fa35c6051059d5ed57cbda5479b593cec15d5405229542042bd583c1e680fb4","impliedFormat":1},{"version":"7df3932c1b8816845e1774538c4e921e196d396b3419e2e18bc973079b4064a3","impliedFormat":1},{"version":"c8a7131a27d7892f009ab03d78dc113582f819c429af2064280bec83c2e7c599","impliedFormat":1},{"version":"19629032a378771a07e93c0ab8253b92cb83e786446f1c0aed01d8f9b96a3fb6","impliedFormat":1},{"version":"fd4b51f120103d53cc03eea9d98d6a1c7e6c07f04847c0658ec925ceeb7667aa","impliedFormat":1},{"version":"53bacb19d6714c3ea41bebf01a34d35468a0ac0c9331d2ffdc411ce452444a2f","impliedFormat":1},{"version":"e2ce339ecc8f65810eda93bb801eb9278f616b653f5974135908df2c30acc5ae","impliedFormat":1},{"version":"234058398306e26bc917e6efba8fb26c9d9f2cfdfbaa17abfcb11138847de081","impliedFormat":1},{"version":"b3ff9aff54c18834bce9690184e69fd44fd5d57273a98a47fbf518b68cc4ec60","impliedFormat":1},{"version":"e6cfcf171b5f7ec0cb620eee4669739ad2711597d0ff7fdb79298dfc1118e66a","impliedFormat":1},{"version":"3dc40ead9c5ac3f164af434069561d6c660e64f77c71ab6ad405c5edc0724a94","impliedFormat":1},{"version":"d5fb34e3200ce13445c603012c0dfbd116317f8d5fef294e11f49d00a859a3d0","impliedFormat":1},{"version":"58fc843cdfd37a8b1ae2cbf3d6d3718d41cdafcbbf17e228bd6a7762a7235bf0","impliedFormat":1},{"version":"a4d0945318f81b27529abcae16d65612decf4164021a0d4d2ec19fbfcbaf1555","impliedFormat":1},{"version":"fbe57f37a07a627af9ae5922c86132677e58689427cc748866a549ef3862f859","impliedFormat":1},{"version":"8df750d51d498be760d538ac9818c7aebea597f21d4937a65fb2ebedd8a976e7","impliedFormat":1},{"version":"5b9c5efb469020fd6a8c6cb8c4b378ef3dc46ad97938ac900882f1d5f237bc91","impliedFormat":1},{"version":"83dc862cd9b7b1a929bcc03e9bbc8690cebc7e29b1edfa263f6fd11b737f19df","impliedFormat":1},{"version":"fffacebbcc213081096e101e64402c9fb772c5b4b36ad5e3d675e8d487c9e8af","impliedFormat":1},{"version":"1b243b5a51dff2bf70b7a6ce368fe7ff845c300027404b5a41a87ce5490cdad0","impliedFormat":1},{"version":"dfb119c12d7d177eb47b98c011677ca852dff82ddbe40ea571e31e04d2b84278","impliedFormat":1},{"version":"e0b50044596bf7b246a9ad7b804cc5ab521f02e89460a017981384895a468f23","impliedFormat":1},{"version":"b303a99933b69d9d6589ac24f215e5d987933782244251a10e62534f08852d94","impliedFormat":1},{"version":"e052b679185d44460040d5ce3d703d503e5f7108cd4e9d057323f307c6c0e42e","impliedFormat":1},{"version":"ddb79ad4350198a188ad3230d2646b4c67467941ddf4022ed01e4511a56d2cd9","impliedFormat":1},{"version":"8b3de2f727cfd97055765350c2e4d50ea322cabb517ff7aa3fa0ad74aab4826e","impliedFormat":1},{"version":"b3e584a57553f573aa01b34bf0d08c4dfefb2b9ede471c70d85207131f0f742f","impliedFormat":1},{"version":"23a24f7efe3c9186a1b05cd9a64a300818dd0716ffbd522d27178ec13dc1f620","impliedFormat":1},{"version":"6849f3dd56770a08b9783d61e3ba6e2d0ba82850a20ae97e1bdcaeb231d2f7fc","impliedFormat":1},{"version":"6fb23beb59f1f5c8dc97bfc012d5edac81ffca1c1b83a91381b4e130e7ce24f3","impliedFormat":1},{"version":"bc759b587b3e7213fc658fe78dbaf7b0e7c0a85f37626823b4bbef063759c406","impliedFormat":1},{"version":"04ed59801192608de22461e38b9f2e300953f1d6d6c05332f19e78e668d6a843","impliedFormat":1},{"version":"bf5cfc96bacabfe71962c32755df63ac499f732571368db3bdd7e144336c50f7","impliedFormat":1},{"version":"4c10770eca2ae9c1d5c97dad5c715b0c65def8699066231851a69fa58aaab3bf","impliedFormat":1},{"version":"c7e7d48913bfa205453911f699307e7ce630deb3c3e68326377bc2ba20abb1f9","impliedFormat":1},{"version":"4b78505d4f7ba7a80b24dae9b9808c2ec3ecb6171af03a4b86a7a0855d7a80c1","impliedFormat":1},{"version":"d09d8ac8da326eb4cf708d3a3937266180fe28e91c3a26e47218425b2ec1851d","impliedFormat":1},{"version":"50c0c2b5e76e48e1168355e3622ca22e939c09867e3deb9b7a260d5f4e8d890c","impliedFormat":1},{"version":"66491ea35e30cc8c11169e5580aef31e30fdf20b39bc22e0847c2c7994e2071b","impliedFormat":1},{"version":"35680fb7f25a165e31e93ea22d106220db4450b1270a135b73f731b66b3d4539","impliedFormat":1},{"version":"5865007a5331be0842d8f0aace163deda0a0672e95389fe6f87b61988478a626","impliedFormat":1},{"version":"dddc865f251a4993b9e23494a9ae0fb58997e0941b1ec774490a272d5a0b29bd","impliedFormat":1},{"version":"76d1f106ef20648708a7d410326b8ad90fc6f7d4cdf0e262edd6bd150676151b","impliedFormat":1},{"version":"6e974c9f7e02b1f1b7c9538619fe25d9d23e4eb5df3102f62f3bb0cb3d735d1a","impliedFormat":1},{"version":"18f3835257e2f87f8dc995c566217c5434d9bc14a6d18e7ca0e2afbfc2f1eca8","impliedFormat":1},{"version":"69055f4f0b1b2df9f0ca89231075c0578975518543100582dd37adb956ad6135","impliedFormat":1},{"version":"c3f85a0f71b64d78e7dfb27a12d10b0cd621745f40752b8e9fa61a7099d4290e","impliedFormat":1},{"version":"0b4b2424b5d19bbac7e7ad9366419746fff0f70001c1867b04440d0031b26991","impliedFormat":1},{"version":"e6d999c047721b80fc44a025370dbc02022390bfcf3c1e05cd200c53720c3f16","impliedFormat":1},{"version":"4fd695c068c325f2eb6effd7a2ed607d04f4ed24b1f7cc006b8325b3eb5bd595","impliedFormat":1},{"version":"c18fb9b8d4a7f41ae537512368ec9028d50b17e33e26c99f864912824b6e8c30","impliedFormat":1},{"version":"2b214fb1c919b0483175967f9cf0809e0ac595a7be41ba5566be27ce3d66cf86","impliedFormat":1},{"version":"ff8ece28a240cb8a29342a8c54efdaf124f93301081afa047bd1e7f6ec2a79e3","impliedFormat":1},{"version":"9b923be7ef4337bbddbd1713b13cf81da9a955034bdf657bb9e60a8fc9b20ac5","affectsGlobalScope":true,"impliedFormat":1},{"version":"527668d62da5909154a74b74a7a9ae59c41ab4a70da76c2f476765308efafb0f","impliedFormat":1},{"version":"e2974b2b0a7ba6384f5f3338d2a6a70170c3002112d6e05ce593d966100bf232","impliedFormat":1},{"version":"cc3738598b5fe875e341f701824403b3cac48c50472c72423d3e236b610fa977","impliedFormat":1},{"version":"f06e49e80942ebd4f352b1d52d51e749cb943e5b7e368cdf0ce15a169cfad5d0","impliedFormat":99},{"version":"adcbd1ed0d1621b7b2998cc3639871b57d85a3f862759d81c8634fbb6f3ec260","impliedFormat":99},{"version":"c982042c9614e12edd22a8ec0ba55c52fb31b41a513e841a0f3916fea6f775ca","impliedFormat":99},{"version":"28004f9370a7177104fe5c71381f4d2ddf8099066ba15ad0264df14135f0210a","impliedFormat":99},{"version":"0d85481bf9d4418ad633806d8d909777749291164161e87d3f76fb68ab1ae4b1","impliedFormat":99},{"version":"26474a5870247854706ee1a1b53846c464fa46d4f0fce6feca43516c6a565ece","impliedFormat":99},{"version":"499060fff17e6127887065c69309b9785808229fa4851185762b434fd191eb8f","impliedFormat":99},{"version":"e8b61ed76ce071a18c16b3d5145c9ec24a79afa4a40e4e70482d420988ad2e92","impliedFormat":99},{"version":"959c15065a76d4dc5e77e5c83dab8bcd52ebaa5779eb4d42fb43a5134c219eca","impliedFormat":99},{"version":"6aba2b87d07562e15164415aeb5ef55e544cfc4ead91c18982e0c5b70739c120","impliedFormat":99},{"version":"876324641782ef0d4123c39ce5b4fe59ddf3dcd8ef747bc06bd935aedf0a71c6","impliedFormat":99},{"version":"0716a38be84ad12588a2ffeb66977b960b6f9ec477473063b61b7fab971bbe4e","impliedFormat":99},{"version":"b735d2a2c8c350d82d158153e5335c3f4e444ffaef9cce20a19ba07671146d26","impliedFormat":99},{"version":"5cfb2066d3fe03aa5d6ffad84629bcb1eb4fe7cad46f874afca80aa459962b75","impliedFormat":99},{"version":"0a1b0a946c2dc3dbc3f7b41fab8ca5a3bb5f21fc3965dc07d1cb5af831a962d3","impliedFormat":99},{"version":"0e1a03168fbe0d48c1a558ce495ea48c922f9c2c98658092ef8361bb8c40536a","impliedFormat":99},{"version":"1204aa56ffbdf67afe38cd279d602ff1033fe9dc2110fc8fc219f1deb4b18a5e","impliedFormat":99},{"version":"4c1ff9f63a51c238c1fb1c86282d101c81677e46f155b12077e08ee57cffbf99","impliedFormat":99},{"version":"a06db219f83fd299973856c648293bcfca1f606a2617b7750f75b13dd28ca5fd","impliedFormat":99},{"version":"ebd64fdcbf908c363ab65ccb1ad9f26d82cd2bbb910fee5a955f3b75f937b1d2","impliedFormat":99},{"version":"608c0d45e9440b26e61a906bcd32ca23db396fa32aa29087db107bee281d70bf","impliedFormat":99},{"version":"c57ff70bc0ae1a2abe4f1a4c8fc8708f7cd99d0de97fac042e0ba9f4970c35db","impliedFormat":99},{"version":"cf5007ed1f1bdd4d9c696370c6fa698eddef590768bbb9807c7b9cb4000a9ec7","impliedFormat":99},{"version":"b96853f733fed9aa8ad28d397e1ec843792749dd8432e7f764edcb5231ec4160","impliedFormat":99},{"version":"6ee0d36f09cff8a99010c8761003a83b910149e5d7b39656f889b2bbbabe0f27","impliedFormat":99},{"version":"b9f6ae525124fa2244c7e5ae3d788d787db47c4dab1beda7809cfb6c47f74968","impliedFormat":99},{"version":"f8f75cca65070d998f57e0a8dc19901a1fb45d7f9a00d52bb58a110c5c1a1bbe","impliedFormat":99},{"version":"22f11a23b6a5fd4a2cad1fba0416cccd42b6a7b8cae4d4480184e0a43203309e","impliedFormat":99},{"version":"a1fc2559d90de9e703fab40ed46ff05a402113d164892c3c4ca192102f136c99","impliedFormat":99},{"version":"514167c3cc3640146a0ede53e59dc82c1d27ad1bc1e134912a0ea2cff69f997c","impliedFormat":99},{"version":"be3e007fce48e278f74ae65322d12b854ddbe43ad668f7029e694772f1b9b0c0","impliedFormat":99},{"version":"67bf109fbb2bc9c90d02cd32393577b411c99030a116c284baacaea07074b323","impliedFormat":99},{"version":"bceff386a896b398fd6277ebb87d37c96a2d5407d970875dd6f617fdf837758d","impliedFormat":99},{"version":"062b7306d2432bfafe9fa5912529a773da133187752fac6b1ec6ce0fe6654271","impliedFormat":99},{"version":"42aaa7efe249cb7c01cdb2a955efce8f2b309038da1edca6bf8e3738aebb8359","impliedFormat":99},{"version":"32d658d74465b471bf18f85fae438d5c9a836bf6e7d0f8df31c5763c2f134e15","signature":"72848fc7b988230e86a6b6cfcc6f46ace30f005647ab0877643ec201abd1a7d6"},{"version":"09797d041ad10147400cba24a0d60191af8bfa4ae2c53da56f4354f59155cb3d","signature":"bab033775301da076188b4d71da6fb70390e31b0957ed43d2af5fc30c43484eb"},{"version":"cc2958d8abd86edcdf05542bb1b40ba659db5bc5a2560720cde08e8950e63bc1","impliedFormat":99},{"version":"e44e0ea195d68c0aea951809bda325322085008c0622fc4ee44db5359f37b747","impliedFormat":99},{"version":"fa2c48fd724dd8f0e11dfb04f20d727a2595890bfa95419c83b21ed575ed77d1","impliedFormat":99},{"version":"6d23ffe7f1b73f16b08f5baeca430e6655b46fdc5862fd7bff1483b71fc6b28d","impliedFormat":99},{"version":"20be44c04e883d5fe7840d630a8d0656e95b00c2d6eebab9ab253275e7170534","impliedFormat":99},{"version":"3b674288fbdc0ff0ed2b7fc2839014c2ff209c84999fd06b6339347d0f976a85","impliedFormat":99},{"version":"87561cc8a2d7444adf4eed4b3f15bef8c6098cceb0e7617fba1cc45d187ac8c8","impliedFormat":99},{"version":"fd40c454d56e1d14e60ce13f3bc60c7fdb9bc70c6ef9c7bfafec1f0eb5d8075b","impliedFormat":1},{"version":"155ced96d70533d95c481061e2691802fae7cfb96869d7c85ac8622f53b51cb7","impliedFormat":1},{"version":"3689b6f599705380d2ceaccb4e58eec5c9439a7a5635d6e37c1ba66ed7c34b35","impliedFormat":99},{"version":"6cf0d3cc668cdbb01358ef7c2e41bbcc14d8d8e4ca424a1b6d2838d9a1cae8ce","impliedFormat":99},{"version":"b7bd70307671536c735389e0a1748555c438c392dfceb6f2ac3aa0a50ca82530","impliedFormat":99},{"version":"661c403f4c5bbf259e03f4fdc3a9e3f51ad562684f702e1b842e6c5336de0752","impliedFormat":99},{"version":"415dd92247ca21db682f75ba7e6289ab2d093cd34c6f471c6c789afd047ad4f3","impliedFormat":99},{"version":"b52f7568bb9b00bcee6c4929938226541c09d86b849b8ba8db2fe2a8bba46f49","impliedFormat":99},{"version":"39d80ec3c018d7ffe7c99ddd3a7b6844b3376c15e52937a7687d2c2828830fd0","impliedFormat":99},{"version":"828f8b38dff4e5c47b0112cb437da379c720f0360d40d392457c9775f30c8ae8","impliedFormat":99},{"version":"d42e1872d53ebb213e7bbe15e5fecdcaa9a490d2f2a2b035ee9cf4a6d3f1e44e","impliedFormat":99},{"version":"2262d96c02073dcb17a31ae8c738651ebff75f102522eae686f5462658b687a8","impliedFormat":99},{"version":"21053659ad72fe51b9dfbde4fa14dbbac0912359fa37c9a5aa75f188782b2ee8","impliedFormat":99},{"version":"e297bdcb7db008d8d7d0481f2c935a9f7f0a338f41b7e5d1cec6a7744140a4ff","impliedFormat":99},{"version":"ef816ad6735a271c4c8035a1914c3a9beaaa90b3c174da312d26bce8736e56ec","impliedFormat":99},{"version":"7202026e24c5e5b7b6e5fe6b99455a91058ef82e74a5cdf6a3a4136b7ae9c080","impliedFormat":99},{"version":"69dbe5d61d2f298046513598f55bd1e719c50dfd6af2f9feea6fc84f8aa3c4bf","impliedFormat":99},{"version":"6a78643fbbf1b0bd954a53d4edfa217b6a5f92d357fa9cdf8d2ee430f96b9472","impliedFormat":99},{"version":"2ebe2f0255b6f301ba7bc0e10c3dda289c6cf1876f289f7a8f6444613d988e5e","impliedFormat":99},{"version":"012b5083a47ccbe050763f8df2be89daa50c1606e9a0bb31f64276d508c02d78","impliedFormat":99},{"version":"fc7c3943608aec142abb8c28f5892a1faaf255d48e1137ff2b2e0be0afdd479e","impliedFormat":99},{"version":"07fcc9be98e12bd2f0f71a501a9bfbe2e53d38c50e8a5e84223fdd05bd8749c5","impliedFormat":99},{"version":"b887a4575db46263f82d7bde681bdc14526e4a2618a1172fef4206c467752d8f","impliedFormat":99},{"version":"85ee2513d76319ac025a0b70dfef3fbf52ca8fc96de4a0200e26f58c1c72ebfa","impliedFormat":1},{"version":"1ba4cb78a0ebc9ef6a3880ce88070f9e789584a0323de5592abe6a900fb61ba0","impliedFormat":1},{"version":"a9c864dcebc459b80b1834e12e149ebcc3fccec355e13fb6587bde0f9db977e3","impliedFormat":1},{"version":"d5eb5865d4cbaa9985cc3cfb920b230cdcf3363f1e70903a08dc4baab80b0ce1","impliedFormat":1},{"version":"51ebca098538b252953b1ef83c165f25b52271bfb6049cd09d197dddd4cd43c5","impliedFormat":1},{"version":"8aa255453712ce8df1652947a0406769415ee7113c54551310e36cf6ab9db99c","impliedFormat":99},{"version":"6ef2ac05da44657a9a2fc1cd47198d2474a0f25d8ea02dcbb9c4a1e45a96dd9d","impliedFormat":99},{"version":"f60e3e3060207ac982da13363181fd7ee4beecc19a7c569f0d6bb034331066c2","impliedFormat":1},{"version":"17230b34bb564a3a2e36f9d3985372ccab4ad1722df2c43f7c5c2b553f68e5db","impliedFormat":1},{"version":"6e5c9272f6b3783be7bdddaf207cccdb8e033be3d14c5beacc03ae9d27d50929","impliedFormat":1},{"version":"9b4f7ff9681448c72abe38ea8eefd7ffe0c3aefe495137f02012a08801373f71","impliedFormat":1},{"version":"0dfe35191a04e8f9dc7caeb9f52f2ee07402736563d12cbccd15fb5f31ac877f","impliedFormat":1},{"version":"798367363a3274220cbed839b883fe2f52ba7197b25e8cb2ac59c1e1fd8af6b7","impliedFormat":1},{"version":"3fa6aece30a44b769633651b07e0a0859e8194dfbbcfe0d7cda561bc521a5d7c","impliedFormat":1},{"version":"5aea76ab98173f2c230b1f78dc010da403da622c105c468ace9fe24e3b77883c","impliedFormat":99},{"version":"69f56d8b9be27fa77055e144ab75843b2c342f7e287d61770abfab9510e723da","impliedFormat":99},{"version":"42aa071346a5fab8aaa711a5e5419e7cce811e6c756b4bb9c5c987704b986b5b","signature":"8b3e6a0d30746c35ff7ab2a7179a1700bd199dcdf936804a1d4eae0017050f67"},{"version":"de1543ab5c6d5e3ab8fad5170d076dc37dba0f89ef3801694035917f101349f3","signature":"7680d128c01a02bd131fed5a76aa6879917fbb26d730b90ec15a25ded4318e8c"},"ed49870f21543a16bd5571f602cc74caed04a0f699c2b49e7e174f7d87b9014e","479b00a0d93d044a1eeeb9d1439a6fbd26cb478ace45a21b64f197caa93d81e4",{"version":"c1a2e05eb6d7ca8d7e4a7f4c93ccf0c2857e842a64c98eaee4d85841ee9855e6","impliedFormat":1},{"version":"835fb2909ce458740fb4a49fc61709896c6864f5ce3db7f0a88f06c720d74d02","impliedFormat":1},{"version":"6e5857f38aa297a859cab4ec891408659218a5a2610cd317b6dcbef9979459cc","impliedFormat":1},{"version":"ead8e39c2e11891f286b06ae2aa71f208b1802661fcdb2425cffa4f494a68854","impliedFormat":1},{"version":"82919acbb38870fcf5786ec1292f0f5afe490f9b3060123e48675831bd947192","impliedFormat":1},{"version":"e222701788ec77bd57c28facbbd142eadf5c749a74d586bc2f317db7e33544b1","impliedFormat":1},{"version":"09154713fae0ed7befacdad783e5bd1970c06fc41a5f866f7f933b96312ce764","impliedFormat":1},{"version":"8d67b13da77316a8a2fabc21d340866ddf8a4b99e76a6c951cc45189142df652","impliedFormat":1},{"version":"a91c8d28d10fee7fe717ddf3743f287b68770c813c98f796b6e38d5d164bd459","impliedFormat":1},{"version":"68add36d9632bc096d7245d24d6b0b8ad5f125183016102a3dad4c9c2438ccb0","impliedFormat":1},{"version":"3a819c2928ee06bbcc84e2797fd3558ae2ebb7e0ed8d87f71732fb2e2acc87b4","impliedFormat":1},{"version":"f6f827cd43e92685f194002d6b52a9408309cda1cec46fb7ca8489a95cbd2fd4","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"a270a1a893d1aee5a3c1c8c276cd2778aa970a2741ee2ccf29cc3210d7da80f5","impliedFormat":1},{"version":"add0ce7b77ba5b308492fa68f77f24d1ed1d9148534bdf05ac17c30763fc1a79","impliedFormat":1},{"version":"8926594ee895917e90701d8cbb5fdf77fc238b266ac540f929c7253f8ad6233d","impliedFormat":1},{"version":"2f67911e4bf4e0717dc2ded248ce2d5e4398d945ee13889a6852c1233ea41508","impliedFormat":1},{"version":"d8430c275b0f59417ea8e173cfb888a4477b430ec35b595bf734f3ec7a7d729f","impliedFormat":1},{"version":"69364df1c776372d7df1fb46a6cb3a6bf7f55e700f533a104e3f9d70a32bec18","impliedFormat":1},{"version":"6042774c61ece4ba77b3bf375f15942eb054675b7957882a00c22c0e4fe5865c","impliedFormat":1},{"version":"5a3bd57ed7a9d9afef74c75f77fce79ba3c786401af9810cdf45907c4e93f30e","impliedFormat":1},{"version":"ed8763205f02fb65e84eff7432155258df7f93b7d938f01785cb447d043d53f3","impliedFormat":1},{"version":"30db853bb2e60170ba11e39ab48bacecb32d06d4def89eedf17e58ebab762a65","impliedFormat":1},{"version":"e27451b24234dfed45f6cf22112a04955183a99c42a2691fb4936d63cfe42761","impliedFormat":1},{"version":"2316301dd223d31962d917999acf8e543e0119c5d24ec984c9f22cb23247160c","impliedFormat":1},{"version":"58d65a2803c3b6629b0e18c8bf1bc883a686fcf0333230dd0151ab6e85b74307","impliedFormat":1},{"version":"e818471014c77c103330aee11f00a7a00b37b35500b53ea6f337aefacd6174c9","impliedFormat":1},{"version":"d4a5b1d2ff02c37643e18db302488cd64c342b00e2786e65caac4e12bda9219b","impliedFormat":1},{"version":"29f823cbe0166e10e7176a94afe609a24b9e5af3858628c541ff8ce1727023cd","impliedFormat":1},"59226398b7e6a88962a5474bc7f2ab57c7bfc7329d1d2cf6386233588caf5db5",{"version":"c57b441e0c0a9cbdfa7d850dae1f8a387d6f81cbffbc3cd0465d530084c2417d","impliedFormat":99},{"version":"51954e948be6a5b728fcfaf561f12331b4f54f068934c77adfc8f70eea17d285","impliedFormat":1},{"version":"7c8c3dfc0cdd370d44932828eb067ef771c8fe7996693221d5d4b90af6d54f2d","signature":"512960c0e955a2324b34354dac25e3e4d431a1af4cd33077935eda5e95c8b7e1"},"b734ccfd6531a41f00fab38e42239df8d7195ae99e6a4bb7e705b6e228417c38","1bbaaed4b534b33878900d8e4ea87e4cea5922cd97942b87f6bce192718464b2",{"version":"b26d3b0c0202486445eb5509c4830a04da894213461c7b78e40482ae9e1ebb86","signature":"aa5d6e66a6a6ef273267cca3e20583391ac353e79b9e3428a411295fa6089225"},{"version":"8832937a4f608e96d8c7b53fd5c040fd1e2be78dea6ca926b9c16e235f114749","impliedFormat":99},{"version":"60fa62255c9a3fc917f4be2d8c23ded1f3e919f68db44af67f8c67b46014663a","impliedFormat":99},{"version":"10ce8a11a9beb91431a0246977d0c9342c9f530b6ddaf756a0ad6fef22818b9d","impliedFormat":99},{"version":"269ed3176766758542995bfab9612b921bb47c3b1efd382b3ec843d0e2dc147d","impliedFormat":99},{"version":"f3ec93a448c4bf491bd372962f4c9a402ba97a917ce905ac0251f16c2e03fb43","impliedFormat":99},{"version":"807dd7f06dcd9dd0af7574606188fcc2054498636022005390030d84957b92b8","impliedFormat":99},{"version":"62bed6305549eaa0ec8e7b75a13e6177987f9b24122babdc267cfe01a2a6cfa9","impliedFormat":99},{"version":"3c7869711e28e33bb715dedb6879707cb54bb91b0ea9e54c9e308ed23be6b8b4","impliedFormat":99},{"version":"abbd33f1c632b4e592fde62769716a5134831f960832d7007a6491e73e4ae109","impliedFormat":99},{"version":"f88a59d7650984e794b40b34303dcedc1c3802acf21429f110c832fedb529dc0","impliedFormat":99},{"version":"2e7ef180b0a117ec2edfc2e349b4ccea4ad63114ea41b0262aa3a6e01cb223f0","impliedFormat":99},{"version":"82fe93d8ca122c107336ef52f40c55790b50c9822b226ad4b5608cdcfc8d7a08","impliedFormat":99},{"version":"de94ac03f309847b4febab46e6a7de3ed68cf6d3a3faf50823def5d1309cbf47","impliedFormat":99},{"version":"072c70c2fca2a333c11ad438f6aa2c1e7f7a7ca63c3107ae81a4469124c96a4d","signature":"496cd22bb4f82c69d05d88ac924b20c9777a3232348707278cf5375b7a1ab576"},{"version":"4acbc7165a8d54738ff62b51414e772c08fe78434e524e6d8770180d3ba2925f","signature":"512960c0e955a2324b34354dac25e3e4d431a1af4cd33077935eda5e95c8b7e1"},{"version":"9e9800fd3d78773013da1c9f3aef3b3e7ab8caebb97121c960fcebd4642d70b8","signature":"65b6125d8ced57331b8086cc243a4126725ffc835c0bf1f42ec20b774d7c7e64"},{"version":"d7da25aab8e8481bea9d3d6fd80812a0c88df6e815bb0e16158cb4ad5fe28a82","signature":"a9407719e655207cc2663aba86e46eec06856649aa77809558ddb2f300dd373e"},{"version":"54cfdb1174c3b81046470a867a760bee44bf2b75527504a3d8b10f24ce856a23","signature":"ff6dfda5378fc7b1ffb6f75724fa0b04c32109d9459a9df45de1ae5186b44a1c"},{"version":"c13bc0c7c75bc996a9157a6319e3d007996d1389efc23e1417f0f42a3faf6045","impliedFormat":99},{"version":"3b4c53547dfca662aee2af553927fde9519b3d1ee13002c01cb7d3e0dd845cdf","impliedFormat":99},{"version":"5c1255a52052237b712730bd0da805b0a708262909e500479a321688c1d6d197","impliedFormat":99},{"version":"ed13622be2960d91a1d3d00fed267a422114eb1fcd2d77c06944fab5bf1db9f2","signature":"cfc2eca82bb1c8cab0b0ce6d34d23211f2aaa83f2a8e6f427cf22a99196322fe"},{"version":"2095b203bfd0a0acc7626f13c09e2f120769636bb7766a3c6191739107089e81","signature":"7b87720aae5dbfb749d597c437531239e4019502dc0e78633561735db617b6f3"},{"version":"a98886b45a4337a7f45862e2cb50b2ffd4a7572f9798f8dc6ffad1f28c364312","signature":"9eb291d4b463342f557d4858971e12ce86803d7c261db37c5b37fe250b95e133"},{"version":"d6056b480feb3370ff004ca083aed2b9dd36b391fc3cef6da7038574bcdb5577","impliedFormat":99},{"version":"d00b7ef279b5e11236738e99e985ced45d75dbf417eab19110519d7fcf029be9","impliedFormat":99},{"version":"91b4ce96f6ad631a0a6920eb0ab928159ff01a439ae0e266ecdc9ea83126a195","impliedFormat":1},{"version":"88efe27bebddb62da9655a9f093e0c27719647e96747f16650489dc9671075d6","impliedFormat":1},{"version":"e348f128032c4807ad9359a1fff29fcbc5f551c81be807bfa86db5a45649b7ba","impliedFormat":1},{"version":"8ee6b07974528da39b7835556e12dd3198c0a13e4a9de321217cd2044f3de22e","impliedFormat":1},{"version":"deefd8c43b40f9797c3921d78d3f9243959621a17b817be7f5d95c149f23a9dd","impliedFormat":1},{"version":"5f12132800d430adbe59b49c2c0354d85a71ada7d756e34250a655baa8ad4ae5","impliedFormat":1},{"version":"1996d1cd7d585a8359a35878f67abdd73cc35b1f675c9c6b147b202fdd8dfc3f","impliedFormat":1},{"version":"b16e757e4c35434065120a2b3bf13a518fc9e621dc9c2ed668f91635a9dc4e75","impliedFormat":1},{"version":"7c18088ccbca1cfe297c22f4cf598a3a36e798efe63f572e39442e9b6af7ccf9","impliedFormat":1},{"version":"d02ced7accb512e6198b796b8d284e7979abde0f089b0a77969747a5f27bfb23","impliedFormat":1},{"version":"4374cefdde5c6e9bad52b0436e887b8325b8f407c12035194ad02c28f1553a3a","impliedFormat":1},{"version":"9b70cad270593f676aecfe4d1611dc766464f0b8138527b0ebbf1ff773578d69","impliedFormat":1},{"version":"b4f85bfb7e831703ac81737361842f1ae4d924b42c5d1af2bff93cca521de4d1","impliedFormat":1},{"version":"ee933420aacba1f60aa70fb8ba47c5e69001b005073b71973114587089a13c7f","impliedFormat":1},{"version":"0a0714999d0a5bdfacd15c7b34cffbcc6f263f6cb0ccb42076cdc541c6987797","impliedFormat":1},{"version":"56584bfc655f9df64afc0f22f7d1122c29e5b74b342c203b891e19de9fa37de8","impliedFormat":1},{"version":"40ec58f0fadd0b3981b3d383e1c12fa0680115ae9f018387fc2cfc0bbcf23204","impliedFormat":1},{"version":"849b9e7283b7309a4556c9b90bb8e2dfc27751f157798065bbc513dcddb09a8c","impliedFormat":1},{"version":"76bba0c97594248c1be19af32d5799f7eff51cec2926d8e4dd59267d7636a0b4","impliedFormat":1},{"version":"10e109212c7be8a9f66e988e5d6c2a8900c9d14bf6beadf5fa70d32ada3425cf","impliedFormat":1},{"version":"2b821aeb31e690092f8eae671dd961a9d0fd598ff4883ce0a600c90e9e8fa716","impliedFormat":1},{"version":"26602933b613e4df3868a6c82e14fffa2393a08531cb333ed27b151923462981","impliedFormat":1},{"version":"f57a588d8f6b3ce5c8b494f2dc759a8885eaee18e80a4952df47de45403fedbe","impliedFormat":1},{"version":"34735727b3fe7a0ed0651a0f88d06449163d1989a2b2de7f047473adc7c1c383","impliedFormat":1},{"version":"a5b13abc88ab3186e713c445e59e2f6eee20c6167943517bc2f56985d89b8c55","impliedFormat":1},{"version":"c8a206a6ba4e32710ebb4a389187772423de0f4f6180b95a7ef1a5a1934c1be6","impliedFormat":1},{"version":"7ae65fe95b18205e241e6695cb2c61c0828d660aca7d08f68781b439a800e6b8","impliedFormat":1},{"version":"c2c8c166199d3a7bd093152437d1f6399d05e458a9ca9364456feecba920cda4","impliedFormat":1},{"version":"369b7270eeeb37982203b2cb18c7302947b89bf5818c1d3d2e95a0418f02b74e","impliedFormat":1},{"version":"94f95d223e2783b0aef4d15d7f6990a6a550fe17d099c501395f690337f7105e","impliedFormat":1},{"version":"039bd8d1e0d151570b66e75ee152877fb0e2f42eca43718632ac195e6884be34","impliedFormat":1},{"version":"d565d66b38d54de037c9d46dede1f12630010d9b45fd9c6b432c7a40b2e30502","impliedFormat":1},{"version":"d7386a1ebe9a3eae227a5561c898c10cacb61a49f941c5a18cdf593f979c693c","impliedFormat":1},{"version":"d3cfde44f8089768ebb08098c96d01ca260b88bccf238d55eee93f1c620ff5a5","impliedFormat":1},{"version":"293eadad9dead44c6fd1db6de552663c33f215c55a1bfa2802a1bceed88ff0ec","impliedFormat":1},{"version":"36eb5babc665b890786550d4a8cb20ef7105673a6d5551fbdd7012877bb26942","impliedFormat":1},{"version":"fec412ded391a7239ef58f455278154b62939370309c1fed322293d98c8796a6","impliedFormat":1},{"version":"e3498cf5e428e6c6b9e97bd88736f26d6cf147dedbfa5a8ad3ed8e05e059af8a","impliedFormat":1},{"version":"dba3f34531fd9b1b6e072928b6f885aa4d28dd6789cbd0e93563d43f4b62da53","impliedFormat":1},{"version":"f672c876c1a04a223cf2023b3d91e8a52bb1544c576b81bf64a8fec82be9969c","impliedFormat":1},{"version":"e4b03ddcf8563b1c0aee782a185286ed85a255ce8a30df8453aade2188bbc904","impliedFormat":1},{"version":"2329d90062487e1eaca87b5e06abcbbeeecf80a82f65f949fd332cfcf824b87b","impliedFormat":1},{"version":"25b3f581e12ede11e5739f57a86e8668fbc0124f6649506def306cad2c59d262","impliedFormat":1},{"version":"93c3e73824ad57f98fd23b39335dbdae2db0bd98199b0dc0b9ccc60bf3c5134a","impliedFormat":1},{"version":"a9ebb67d6bbead6044b43714b50dcb77b8f7541ffe803046fdec1714c1eba206","impliedFormat":1},{"version":"833e92c058d033cde3f29a6c7603f517001d1ddd8020bc94d2067a3bc69b2a8e","impliedFormat":1},{"version":"8e6427dd1a4321b0857499739c641b98657ea6dc7cc9a02c9b2c25a845c3c8e6","impliedFormat":1},{"version":"58da08d1fe876c79c47dcf88be37c5c3fab55d97b34c8c09a666599a2191208d","impliedFormat":1},{"version":"a346701ad6dcdaa58e388fe0995fc5304c09c395b8cba68ed872780f8c102004","impliedFormat":99},{"version":"2fbe402f0ee5aa8ab55367f88030f79d46211c0a0f342becaa9f648bf8534e9d","impliedFormat":1},{"version":"b94258ef37e67474ac5522e9c519489a55dcb3d4a8f645e335fc68ea2215fe88","impliedFormat":1},{"version":"5a5c4b8b60a8a80ba7b8b5d0319be2d3c61bfd2ce4fc2a645371dee9f6db0a77","signature":"5617b4039bfaf841355761a98a33aaf64daf6485fb0011aa9696b7088a4f20f4"},{"version":"56b7fd30208addbcc2468cfda4f5bc0a55342211deaab61ee35b1c352b1622f1","signature":"f774a7e8875649db68f5952801f001f3c316560ede472e5663af7a8c9c18f938"},{"version":"caf4af98bf464ad3e10c46cf7d340556f89197aab0f87f032c7b84eb8ddb24d9","impliedFormat":99},{"version":"71acd198e19fa38447a3cbc5c33f2f5a719d933fccf314aaff0e8b0593271324","impliedFormat":99},{"version":"9ec42c8a57e82311118b794318409ee02b2cebfa49ba6cce8457cff6448cd471","signature":"dbebb8bec7d542573751dfaaf4d26db5f11c7780d76ea9c3a7e2de472ad1681a"},{"version":"2040cdff27cd1ed771e0ebbd15abcd73d31f2f1e4be6664bd6816fffd2a87476","signature":"1a6115819fa1e86a8fdfdef41f15eb65ba315a1ab6079a7db3f018bf72f4c0c2"},{"version":"49d8311589b810b106aada8ef7b13f70b2b1f68cfce4e1458b7f31a191f420e9","signature":"99cced08956b46ddaaacfc9e62594334726e43031627301a08ce2b0650d0e0fe"},{"version":"1fd7bfea6c425ce8ec33a7d92edae59f10bc09f86ae01658447509d09ca663f1","impliedFormat":1},{"version":"ccab2a1e371ecf7462b950a6fb646b56d28cba01092966ff954e2fe84065b09c","signature":"3922ff69f55c419ae0566ff6f26871357d2ba9b20da1987f69769d3a7a8a704c"},{"version":"a9373d52584b48809ffd61d74f5b3dfd127da846e3c4ee3c415560386df3994b","impliedFormat":99},{"version":"caf4af98bf464ad3e10c46cf7d340556f89197aab0f87f032c7b84eb8ddb24d9","impliedFormat":99},{"version":"7ec047b73f621c526468517fea779fec2007dd05baa880989def59126c98ef79","impliedFormat":99},{"version":"8dd450de6d756cee0761f277c6dc58b0b5a66b8c274b980949318b8cad26d712","impliedFormat":99},{"version":"6b5f886fe41e2e767168e491fe6048398ed6439d44e006d9f51cc31265f08978","impliedFormat":99},{"version":"56a87e37f91f5625eb7d5f8394904f3f1e2a90fb08f347161dc94f1ae586bdd0","impliedFormat":99},{"version":"6b863463764ae572b9ada405bf77aac37b5e5089a3ab420d0862e4471051393b","impliedFormat":99},{"version":"904d6ad970b6bd825449480488a73d9b98432357ab38cf8d31ffd651ae376ff5","impliedFormat":99},{"version":"1179ef8174e0e4a09d35576199df04803b1db17c0fb35b9326442884bc0b0cce","impliedFormat":99},{"version":"71459423cd653def7dc3b55e2b5fd583955903ecc6c4a32889303c496e36f198","signature":"b79d4c431a053e075eaf2949dbf85259243acb49b26b66346f27009eb7719250"},{"version":"9d3ed12d47e8d74c398d1ecf52de07e69faea8e472bfb5a942f7438404c162e5","signature":"1a25aa9f077ddd9e7c3d1c22af77c2cbaf82625aa8046a2c0ff0dae7e210e37d"},{"version":"46294d8c5dcd538f005abae8cf8a66e4e0312e02ed6743c179369a453badb31c","signature":"185eb50ff87090bd8757dd1abcfbcacfb009fc9cc94e92fe51d4da416c17ece1"},{"version":"99d1a601593495371e798da1850b52877bf63d0678f15722d5f048e404f002e4","impliedFormat":99},{"version":"1c5d0b242d0513848f4bfa9b57ba7f438d9b1120617029941bfaa137196ecead","signature":"01ea6a3d10be8e840344854550edb1a46859d714767ab61e3a7b836ea2dd6410"},{"version":"b143dd87d2b93a252f1a50f8e085ead398f6469d8b7cda8bff651261876d5e00","signature":"7bd370591796faca667589bf2081b8738c77cf5eacb791c36299ddd615a31681"},{"version":"68b6a7501a56babd7bcd840e0d638ee7ec582f1e70b3c36ebf32e5e5836913c8","impliedFormat":99},{"version":"89783bd45ab35df55203b522f8271500189c3526976af533a599a86caaf31362","impliedFormat":99},{"version":"26e6c521a290630ea31f0205a46a87cab35faac96e2b30606f37bae7bcda4f9d","impliedFormat":99},{"version":"e1564b0912361081da39e1ee61d5759a75aa4e2e8d28a90f5e229921addb4083","signature":"075f3a4de810b091b4a6ebd47db566aaf010151d9cda7622f6711387f0a38ff7"},{"version":"a9373d52584b48809ffd61d74f5b3dfd127da846e3c4ee3c415560386df3994b","impliedFormat":99},{"version":"caf4af98bf464ad3e10c46cf7d340556f89197aab0f87f032c7b84eb8ddb24d9","impliedFormat":99},{"version":"8085954ba165e611c6230596078063627f3656fed3fb68ad1e36a414c4d7599a","impliedFormat":99},{"version":"e8672934f1c315f36cdae39380454ba8c2da62aca420dfb827d96693091419c4","signature":"5487019d46f80ed8da92d934729caab77c902a55fdf970831ca7ac1f980735c4"},{"version":"e7455feb113b38c59456ba29a9ec264b5ffa1daae8883866332ad637ffd57c31","signature":"7612537cfaddf7d94eadc71c476610562b58ad2919ff9c918789c1fcbe32b2d4"},{"version":"3057bbbc72fd8b2b80a92d4438eb9c7c69f1b1744b616cb2e2d9113ec64eaea4","signature":"4a04b984ab167b2e4a34188cee6291f135a71d76435f786fd531937f3b1e5079"},{"version":"d2c9b6d94c32a2e97c43023a195aa2b13765647883617bff27da9e8ed0231dfb","signature":"1b5568cba0e5453bb7891e59ad0508977bbbbda6fcdc6ab8880419f2f2c92ba6"},"094a921f2361c711289fc3282e946a0ab265cc4577c2bd7055f8f744e4033cb4","18c8232ecaab05bc65e2ebf8d4489796e1b7308cf64c9d25ff886bfbdba8c118",{"version":"dfcf16e716338e9fe8cf790ac7756f61c85b83b699861df970661e97bf482692","impliedFormat":99},{"version":"bd07164f172aafffb93861e4b1a3be4249f5a8739f24454864f2cf9c0c46758d","signature":"04c08108e382fd9865d254a7f2a0e59df26dfe981d977b34c4cd096f6e8df872"},{"version":"a12f73507ab613e9d797979b988a15e32d23458fc8dd4ba71b922aeee977a3b6","signature":"962b7ee724a1e057a07d808a18a92c4a5744fdfcae837e0c4f354477e9bfb312"},{"version":"a9373d52584b48809ffd61d74f5b3dfd127da846e3c4ee3c415560386df3994b","impliedFormat":99},{"version":"caf4af98bf464ad3e10c46cf7d340556f89197aab0f87f032c7b84eb8ddb24d9","impliedFormat":99},{"version":"cbfd5ef0c8fdb4983202252b5f5758a579f4500edc3b9ad413da60cffb5c3564","impliedFormat":99},{"version":"e7a89220fb49e18d6613956781cfd5eb38d5da36379e93f5fc90ccec127dc871","signature":"64073fe93e9bd17358918a585e5aeda241e7b6dc1dd4b745f49e1889c5935366"},{"version":"caf4af98bf464ad3e10c46cf7d340556f89197aab0f87f032c7b84eb8ddb24d9","impliedFormat":99},{"version":"9c580c6eae94f8c9a38373566e59d5c3282dc194aa266b23a50686fe10560159","impliedFormat":99},{"version":"e9dddbd8dbbc0eccd683306481b0f0bbc8e2b60ea97817416ebb9fe7fbbbdca8","signature":"dd8394b1eea2ba970a716e87af002b610d513280d6d8e521b5f3b2fd73e6c89f"},{"version":"3d6a560c635fd91094e43191ecf73b124ccb2537e6060f85d5d31fcf68150e74","signature":"6aea4b913e1f06f2e2aac93fc923f76d7acd4ce0f1ee3adbffab41ebc81f2a2f"},{"version":"f2aea81d8baf2b621945382aabac150e3db40f20d19ac1abea7aff805f1dc33c","signature":"b3ee5184dbf154ca01ff12e4703e5dc467ad7c79d8b16c98b8361118de54cea4"},{"version":"6c05d0fcee91437571513c404e62396ee798ff37a2d8bef2104accdc79deb9c0","impliedFormat":1},{"version":"6aa2859da46f726a22040725e684ea964d7469a6b26f1c0a6634bb65e79062b0","impliedFormat":99},{"version":"13ccc9b0fe4248e622f83a1d3b2f0566b72b5e04162d7d0c8db8945ecc71b55f","signature":"933fa1ee8f2a4d203589011944fc76d755d90af71b43ae3c1a174bbe7cac4cfa"},{"version":"7b8c7a952cf49e78aafe5f628c3bd90f7e01bd5602eb5d3650bef5727a8186d7","signature":"4700c4aaa2f5711d21a8cd9a22eef223fe7b80bd96a12d3467cb6f84c81a3f25"},{"version":"7a14bf21ae8a29d64c42173c08f026928daf418bed1b97b37ac4bb2aa197b89b","impliedFormat":99},{"version":"e8469e599381cf021ce751c27cca3d8cb06440a45665ca9c2ef2efb0acef1fd9","signature":"fca5bc9aaa54ea2e647742564317e79e2c5a52eb1301d25264e8b8c510a90585"},{"version":"233267a4a036c64aee95f66a0d31e3e0ef048cccc57dd66f9cf87582b38691e4","impliedFormat":99},{"version":"cbc12f4086448f8a307ed5fbb160f79467c84a44c48ca0dbd2c62e39a2db6f5d","signature":"1e37fc0a173ec758e50b02a497c85f176f9da989272fcb78594e7307278603ae"},{"version":"e129b0d66d9b3ba6df7523f330bcee363dbf1e1f5570bcb797e3d3b55fa5d8d2","affectsGlobalScope":true},"bd1361cbee46e78f1b77d19c0435d39637c83c74d7f71cd1a4b5e49b9efddea8","d1986184a09a52db8228cb2bb2a61a8c05c9354e5b93cec8e2628d8579c892d7","ca881d538aa6a152cdee227e13978f80b90ebb545cc1874a6a7f3c1131265ffa",{"version":"a3d3f704c5339a36da3ca8c62b29072f87e86c783b8452d235992142ec71aa2d","impliedFormat":1},{"version":"b1538a92b9bae8d230267210c5db38c2eb6bdb352128a3ce3aa8c6acf9fc9622","impliedFormat":1},{"version":"6fc1a4f64372593767a9b7b774e9b3b92bf04e8785c3f9ea98973aa9f4bbe490","impliedFormat":1},{"version":"ff09b6fbdcf74d8af4e131b8866925c5e18d225540b9b19ce9485ca93e574d84","impliedFormat":1},{"version":"d5895252efa27a50f134a9b580aa61f7def5ab73d0a8071f9b5bf9a317c01c2d","impliedFormat":1},{"version":"2c378d9368abcd2eba8c29b294d40909845f68557bc0b38117e4f04fc56e5f9c","impliedFormat":1},{"version":"56208c500dcb5f42be7e18e8cb578f257a1a89b94b3280c506818fed06391805","impliedFormat":1},{"version":"0c94c2e497e1b9bcfda66aea239d5d36cd980d12a6d9d59e66f4be1fa3da5d5a","impliedFormat":1},{"version":"9b048390bcffe88c023a4cd742a720b41d4cd7df83bc9270e6f2339bf38de278","affectsGlobalScope":true,"impliedFormat":1},{"version":"1f366bde16e0513fa7b64f87f86689c4d36efd85afce7eb24753e9c99b91c319","impliedFormat":1},{"version":"151ff381ef9ff8da2da9b9663ebf657eac35c4c9a19183420c05728f31a6761d","impliedFormat":1},{"version":"f3d8c757e148ad968f0d98697987db363070abada5f503da3c06aefd9d4248c1","impliedFormat":1},{"version":"96d14f21b7652903852eef49379d04dbda28c16ed36468f8c9fa08f7c14c9538","impliedFormat":1},{"version":"7fa8d75d229eeaee235a801758d9c694e94405013fe77d5d1dd8e3201fc414f1","impliedFormat":1}],"root":[509,510,521,525,632,633,[680,683],761,[764,767],[781,785],[789,791],845,846,[849,851],853,[863,865],867,868,872,[876,881],883,884,888,[891,893],896,897,899,[901,905]],"options":{"allowJs":true,"esModuleInterop":true,"jsx":4,"module":99,"skipLibCheck":true,"strict":true,"target":4},"referencedMap":[[904,1],[509,2],[905,3],[902,2],[903,4],[510,5],[521,6],[667,7],[666,8],[576,9],[538,2],[539,2],[540,2],[541,2],[542,2],[543,2],[544,2],[545,2],[546,2],[547,2],[548,2],[553,10],[554,11],[555,10],[556,10],[557,2],[559,11],[560,10],[561,10],[562,10],[563,10],[564,10],[565,11],[566,11],[567,10],[568,10],[569,11],[570,11],[571,10],[572,10],[558,10],[573,2],[574,2],[583,9],[582,9],[577,2],[584,12],[550,2],[578,2],[579,13],[580,13],[552,14],[551,15],[581,16],[575,2],[589,17],[592,18],[591,17],[590,19],[588,20],[585,2],[587,21],[586,22],[841,23],[840,24],[252,2],[679,25],[664,2],[668,26],[665,27],[523,2],[669,2],[670,28],[858,29],[875,30],[873,31],[874,31],[854,31],[882,32],[856,29],[871,33],[857,29],[848,34],[847,31],[870,35],[860,36],[861,29],[855,31],[887,30],[885,31],[886,31],[869,37],[866,37],[862,38],[890,34],[889,31],[842,39],[898,40],[900,41],[859,2],[604,2],[906,2],[907,2],[908,2],[909,2],[910,42],[911,2],[913,43],[914,44],[912,2],[915,2],[916,2],[917,2],[918,2],[140,45],[141,45],[142,46],[97,47],[143,48],[144,49],[145,50],[92,2],[95,51],[93,2],[94,2],[146,52],[147,53],[148,54],[149,55],[150,56],[151,57],[152,57],[153,58],[154,59],[155,60],[156,61],[98,2],[96,2],[157,62],[158,63],[159,64],[191,65],[160,66],[161,67],[162,68],[163,69],[164,70],[165,71],[166,72],[167,73],[168,74],[169,75],[170,75],[171,76],[172,2],[173,77],[175,78],[174,79],[176,80],[177,81],[178,82],[179,83],[180,84],[181,85],[182,86],[183,87],[184,88],[185,89],[186,90],[187,91],[188,92],[99,2],[100,2],[101,2],[139,93],[189,94],[190,95],[678,96],[677,97],[676,96],[195,98],[412,31],[196,99],[194,100],[414,101],[413,102],[192,103],[410,2],[193,104],[83,2],[85,105],[409,31],[269,31],[919,2],[663,106],[662,2],[844,107],[843,108],[762,2],[84,2],[549,2],[522,2],[596,109],[594,110],[595,2],[593,111],[852,31],[660,112],[792,113],[658,114],[657,115],[650,116],[659,2],[656,117],[654,118],[635,119],[634,2],[655,120],[638,120],[653,121],[640,122],[651,123],[636,2],[643,124],[646,125],[649,126],[645,127],[647,128],[644,2],[648,116],[652,129],[639,2],[661,130],[793,131],[512,132],[513,133],[514,133],[515,134],[516,135],[511,136],[788,137],[530,138],[529,139],[528,140],[631,141],[629,142],[630,143],[627,2],[628,144],[520,145],[518,146],[519,147],[517,136],[787,148],[533,149],[527,150],[531,151],[532,152],[526,2],[780,153],[778,154],[775,155],[774,156],[769,155],[777,154],[776,157],[770,154],[768,155],[773,158],[771,154],[772,155],[779,159],[786,160],[894,31],[458,161],[463,1],[453,162],[216,163],[256,164],[438,165],[251,166],[233,2],[408,2],[214,2],[427,167],[282,168],[215,2],[336,169],[259,170],[260,171],[407,172],[424,173],[318,174],[432,175],[433,176],[431,177],[430,2],[428,178],[258,179],[217,180],[361,2],[362,181],[288,182],[218,183],[289,182],[284,182],[205,182],[254,184],[253,2],[437,185],[449,2],[241,2],[383,186],[384,187],[378,31],[485,2],[386,2],[387,188],[379,189],[490,190],[489,191],[484,2],[303,2],[423,192],[422,2],[483,193],[380,31],[312,194],[308,195],[313,196],[311,2],[310,197],[309,2],[486,2],[482,2],[488,198],[487,2],[307,195],[477,199],[480,200],[297,201],[296,202],[295,203],[493,31],[294,204],[276,2],[496,2],[499,2],[498,31],[500,205],[198,2],[434,206],[435,207],[436,208],[211,2],[244,2],[210,209],[197,2],[399,31],[203,210],[398,211],[397,212],[388,2],[389,2],[396,2],[391,2],[394,213],[390,2],[392,214],[395,215],[393,214],[213,2],[208,2],[209,182],[264,2],[270,216],[271,217],[268,218],[266,219],[267,220],[262,2],[405,188],[291,188],[457,221],[464,222],[468,223],[441,224],[440,2],[279,2],[501,225],[452,226],[381,227],[382,228],[376,229],[367,2],[404,230],[443,31],[368,231],[406,232],[401,233],[400,2],[402,2],[373,2],[360,234],[442,235],[445,236],[370,237],[374,238],[365,239],[419,240],[451,241],[322,242],[337,243],[206,244],[450,245],[202,246],[272,247],[263,2],[273,248],[349,249],[261,2],[348,250],[91,2],[342,251],[243,2],[363,252],[338,2],[207,2],[237,2],[346,253],[212,2],[274,254],[372,255],[439,256],[371,2],[345,2],[265,2],[351,257],[352,258],[429,2],[354,259],[356,260],[355,261],[246,2],[344,244],[358,262],[321,263],[343,264],[350,265],[221,2],[225,2],[224,2],[223,2],[228,2],[222,2],[231,2],[230,2],[227,2],[226,2],[229,2],[232,266],[220,2],[330,267],[329,2],[334,268],[331,269],[333,270],[335,268],[332,269],[242,271],[292,272],[448,273],[502,2],[472,274],[474,275],[369,276],[473,277],[446,235],[385,235],[219,2],[323,278],[238,279],[239,280],[240,281],[236,282],[418,282],[286,282],[324,283],[287,283],[235,284],[234,2],[328,285],[327,286],[326,287],[325,288],[447,289],[417,290],[416,291],[377,292],[411,293],[415,294],[426,295],[425,296],[421,297],[320,298],[317,299],[319,300],[316,301],[357,302],[347,2],[462,2],[359,303],[420,2],[275,304],[366,206],[364,305],[277,306],[280,307],[497,2],[278,308],[281,308],[460,2],[459,2],[461,2],[495,2],[283,309],[444,2],[314,310],[306,31],[257,2],[201,311],[290,2],[466,31],[200,2],[476,312],[305,31],[470,188],[304,313],[455,314],[302,312],[204,2],[478,315],[300,31],[301,31],[293,2],[199,2],[299,316],[298,317],[245,318],[375,74],[285,74],[353,2],[340,319],[339,2],[403,195],[315,31],[456,320],[86,31],[89,321],[90,322],[87,31],[88,2],[255,323],[250,324],[249,2],[248,325],[247,2],[454,326],[465,327],[467,328],[469,329],[471,330],[475,331],[508,332],[479,332],[507,333],[481,334],[491,335],[492,336],[494,337],[503,338],[506,209],[505,2],[504,339],[637,2],[675,340],[672,339],[674,341],[673,2],[671,2],[642,342],[641,343],[524,344],[794,2],[810,345],[811,345],[812,345],[826,346],[813,347],[814,347],[815,348],[807,349],[805,350],[796,2],[800,351],[804,352],[802,353],[809,354],[797,355],[798,356],[799,357],[801,358],[803,359],[806,360],[808,361],[816,347],[817,347],[818,347],[819,345],[820,347],[821,347],[795,347],[822,2],[824,362],[823,347],[825,345],[341,363],[895,31],[763,2],[81,2],[82,2],[13,2],[14,2],[16,2],[15,2],[2,2],[17,2],[18,2],[19,2],[20,2],[21,2],[22,2],[23,2],[24,2],[3,2],[25,2],[26,2],[4,2],[27,2],[31,2],[28,2],[29,2],[30,2],[32,2],[33,2],[34,2],[5,2],[35,2],[36,2],[37,2],[38,2],[6,2],[42,2],[39,2],[40,2],[41,2],[43,2],[7,2],[44,2],[49,2],[50,2],[45,2],[46,2],[47,2],[48,2],[8,2],[54,2],[51,2],[52,2],[53,2],[55,2],[9,2],[56,2],[57,2],[58,2],[60,2],[59,2],[61,2],[62,2],[10,2],[63,2],[64,2],[65,2],[11,2],[66,2],[67,2],[68,2],[69,2],[70,2],[1,2],[71,2],[72,2],[12,2],[76,2],[74,2],[79,2],[78,2],[73,2],[77,2],[75,2],[80,2],[117,364],[127,365],[116,364],[137,366],[108,367],[107,368],[136,339],[130,369],[135,370],[110,371],[124,372],[109,373],[133,374],[105,375],[104,339],[134,376],[106,377],[111,378],[112,2],[115,378],[102,2],[138,379],[128,380],[119,381],[120,382],[122,383],[118,384],[121,385],[131,339],[113,386],[114,387],[123,388],[103,389],[126,380],[125,378],[129,2],[132,390],[615,391],[534,2],[599,2],[537,392],[598,393],[605,394],[606,2],[603,395],[601,396],[600,2],[607,2],[597,397],[610,2],[536,2],[535,31],[611,398],[609,399],[608,397],[613,400],[614,401],[612,402],[602,2],[626,158],[625,403],[616,404],[624,405],[623,406],[622,407],[618,155],[621,400],[619,2],[620,155],[617,408],[760,409],[829,410],[831,411],[838,412],[833,2],[834,2],[832,413],[835,414],[827,2],[828,2],[839,415],[830,416],[836,2],[837,417],[754,418],[758,419],[755,419],[751,418],[759,420],[756,421],[757,419],[752,422],[753,423],[747,424],[691,425],[693,426],[746,2],[692,427],[750,428],[749,429],[748,430],[684,2],[694,425],[695,2],[686,431],[690,432],[685,2],[687,433],[688,434],[689,2],[696,435],[697,435],[698,435],[699,435],[700,435],[701,435],[702,435],[703,435],[704,435],[705,435],[706,435],[707,435],[708,435],[710,435],[709,435],[711,435],[712,435],[713,435],[714,435],[745,436],[715,435],[716,435],[717,435],[718,435],[719,435],[720,435],[721,435],[722,435],[723,435],[724,435],[725,435],[726,435],[727,435],[729,435],[728,435],[730,435],[731,435],[732,435],[733,435],[734,435],[735,435],[736,435],[737,435],[738,435],[739,435],[740,435],[741,435],[744,435],[742,435],[743,435],[525,437],[791,438],[853,439],[864,440],[865,441],[881,442],[880,443],[789,444],[790,445],[683,446],[761,447],[784,448],[785,449],[879,450],[878,451],[868,452],[851,453],[876,454],[877,455],[845,455],[850,456],[883,457],[872,458],[884,459],[846,456],[849,460],[888,461],[867,462],[863,463],[891,464],[892,457],[893,465],[896,466],[897,456],[899,467],[901,468],[681,469],[682,470],[765,471],[766,472],[767,473],[680,474],[781,475],[632,476],[764,477],[782,477],[633,478],[783,438]],"affectedFilesPendingEmit":[905,903,521,525,791,853,864,865,881,880,789,790,683,761,784,785,879,878,868,851,876,877,845,850,883,872,884,846,849,888,867,863,891,892,893,896,897,899,901,681,682,765,766,767,680,781,632,764,782,633,783],"version":"5.9.3"}
\`\`\`


```

# components.json

```json
{
  "$schema": "https://ui.shadcn.com/schema.json",
  "style": "new-york",
  "rsc": true,
  "tsx": true,
  "tailwind": {
    "config": "",
    "css": "src/app/globals.css",
    "baseColor": "gray",
    "cssVariables": true,
    "prefix": ""
  },
  "iconLibrary": "lucide",
  "aliases": {
    "components": "@/components",
    "utils": "@/lib/utils",
    "ui": "@/components/ui",
    "lib": "@/lib",
    "hooks": "@/hooks"
  },
  "registries": {}
}

```

# docs/API.md

```md
# African ANSP Peer Review Platform - API Documentation

## Overview

The African ANSP Peer Review Platform uses tRPC for type-safe API endpoints. All APIs are accessed via the `/api/trpc` endpoint and are organized into routers by domain.

## Authentication

All API endpoints (except public endpoints) require authentication via NextAuth v5. The user session is automatically attached to the tRPC context.

\`\`\`typescript
// Client-side usage
import { trpc } from "@/lib/trpc/client";

// The session is automatically included in requests
const { data } = trpc.assessment.list.useQuery({ page: 1, limit: 20 });
\`\`\`

## API Routers

### Assessment Router (`assessment.*`)

Manages the full lifecycle of assessments from creation to completion.

#### `assessment.create`

Creates a new assessment for an organization.

**Input:**
\`\`\`typescript
{
  questionnaireId?: string;      // Optional: specific questionnaire ID
  questionnaireType?: "ANS_USOAP_CMA" | "SMS_CANSO_SOE"; // Or type to auto-select
  assessmentType: "SELF_ASSESSMENT" | "GAP_ANALYSIS" | "PRE_REVIEW" | "MOCK_REVIEW";
  title: string;                 // 3-200 characters
  description?: string;          // Max 2000 characters
  dueDate?: Date;
  scope?: string[];              // Audit areas or SMS components to include
}
\`\`\`

**Returns:** Created assessment with organization and questionnaire details.

**Authorization:** Requires `ASSESSMENT_MANAGER_ROLES` (SUPER_ADMIN, SYSTEM_ADMIN, PROGRAMME_COORDINATOR, ANSP_ADMIN, SAFETY_MANAGER, QUALITY_MANAGER)

---

#### `assessment.getById`

Retrieves a single assessment with full details.

**Input:**
\`\`\`typescript
{ id: string } // Assessment ID (CUID)
\`\`\`

**Returns:** Assessment with responses, organization, questionnaire, and progress info.

**Authorization:** Based on role and organization membership.

---

#### `assessment.list`

Lists assessments with filtering and pagination.

**Input:**
\`\`\`typescript
{
  organizationId?: string;
  questionnaireId?: string;
  questionnaireType?: "ANS_USOAP_CMA" | "SMS_CANSO_SOE";
  type?: "SELF_ASSESSMENT" | "GAP_ANALYSIS" | "PRE_REVIEW" | "MOCK_REVIEW";
  status?: AssessmentStatus | AssessmentStatus[];
  search?: string;               // Max 100 characters
  page?: number;                 // Default: 1
  limit?: number;                // 1-100, default: 20
  sortBy?: "createdAt" | "updatedAt" | "status" | "progress";
  sortOrder?: "asc" | "desc";
}
\`\`\`

**Returns:** Paginated list with total count and page info.

---

#### `assessment.submit`

Submits a completed assessment for review.

**Input:**
\`\`\`typescript
{
  id: string;
  submissionNotes?: string;      // Max 2000 characters
}
\`\`\`

**Validation:**
- All questions must be answered (100% progress)
- No "NOT_REVIEWED" responses for ANS assessments
- Calculates and stores EI score or SMS maturity level

**Returns:** Updated assessment with calculated scores and any warnings.

---

#### `assessment.startReview`

Moves a submitted assessment to "UNDER_REVIEW" status.

**Input:** `{ id: string }`

**Authorization:** SUPER_ADMIN, SYSTEM_ADMIN, PROGRAMME_COORDINATOR, LEAD_REVIEWER, PEER_REVIEWER

---

#### `assessment.complete`

Marks an assessment as completed after review.

**Input:**
\`\`\`typescript
{
  id: string;
  completionNotes?: string;
}
\`\`\`

**Authorization:** SUPER_ADMIN, SYSTEM_ADMIN, PROGRAMME_COORDINATOR, LEAD_REVIEWER

---

#### `assessment.reopen`

Reopens a submitted assessment for further editing.

**Input:**
\`\`\`typescript
{
  id: string;
  reason: string;                // 10-500 characters
}
\`\`\`

---

#### `assessment.saveResponse`

Saves a single response to a question.

**Input:**
\`\`\`typescript
{
  assessmentId: string;
  questionId: string;
  responseValue?: string | null;       // For ANS: SATISFACTORY, NOT_SATISFACTORY, NOT_APPLICABLE, NOT_REVIEWED
  maturityLevel?: "A" | "B" | "C" | "D" | "E" | null; // For SMS
  notes?: string;                      // Max 2000 characters
  evidenceUrls?: string[];
}
\`\`\`

**Returns:** Updated response with progress recalculation.

---

#### `assessment.saveResponses`

Bulk saves multiple responses.

**Input:**
\`\`\`typescript
{
  assessmentId: string;
  responses: Array<{
    questionId: string;
    responseValue?: string | null;
    maturityLevel?: "A" | "B" | "C" | "D" | "E" | null;
    notes?: string;
  }>;                            // 1-100 responses
}
\`\`\`

---

#### `assessment.getResponses`

Retrieves responses with filtering.

**Input:**
\`\`\`typescript
{
  assessmentId: string;
  categoryId?: string;
  auditArea?: string;
  criticalElement?: string;
  smsComponent?: string;
  studyArea?: string;
  onlyUnanswered?: boolean;
  page?: number;
  limit?: number;                // 1-100, default: 50
}
\`\`\`

---

#### `assessment.calculateScores`

Calculates current scores without saving.

**Input:** `{ assessmentId: string }`

**Returns:**
- For ANS: EI score breakdown by audit area and critical element
- For SMS: Maturity levels by component and study area

---

#### `assessment.export`

Exports assessment data.

**Input:**
\`\`\`typescript
{
  assessmentId: string;
  format: "JSON" | "CSV";
  includeEvidence?: boolean;     // Default: true
  includeNotes?: boolean;        // Default: true
}
\`\`\`

**Returns:** Formatted data with suggested filename.

---

### Response Router (`response.*`)

Manages individual assessment responses.

#### `response.save`

Saves or updates a response with full validation.

**Input:** Same as `assessment.saveResponse`

---

#### `response.getByAssessment`

Gets all responses for an assessment with question details.

**Input:**
\`\`\`typescript
{
  assessmentId: string;
  includeQuestion?: boolean;
  includeEvidence?: boolean;
}
\`\`\`

---

### Scoring Router (`scoring.*`)

Provides scoring calculations and analysis.

#### `scoring.calculateEI`

Calculates EI (Effective Implementation) score.

**Input:** `{ assessmentId: string }`

**Returns:**
\`\`\`typescript
{
  overallEI: number;             // 0-100
  totalApplicable: number;
  satisfactoryCount: number;
  notSatisfactoryCount: number;
  notApplicableCount: number;
  auditAreaScores: Record<USOAPAuditArea, { ei: number; ... }>;
  criticalElementScores: Record<CriticalElement, { ei: number; ... }>;
  priorityPQScore?: number;
}
\`\`\`

---

#### `scoring.calculateSMSMaturity`

Calculates SMS maturity score.

**Input:** `{ assessmentId: string }`

**Returns:**
\`\`\`typescript
{
  overallLevel: "A" | "B" | "C" | "D" | "E" | null;
  overallScore: number;          // 1-5 scale
  overallPercentage: number;     // 0-100
  componentLevels: Record<SMSComponent, {
    level: string;
    score: number;
    weight: number;
    weightedScore: number;
  }>;
  studyAreaLevels: Record<CANSOStudyArea, { level: string; score: number; }>;
  gapAreas: string[];            // Components below Level C
}
\`\`\`

---

### Progress Router (`progress.*`)

Tracks assessment progress and activity.

#### `progress.getAssessmentSummary`

Gets comprehensive progress summary.

**Input:** `{ assessmentId: string }`

**Returns:** Assessment details with progress stats and category breakdown.

---

#### `progress.getTimeline`

Gets activity timeline for an assessment.

**Input:**
\`\`\`typescript
{
  assessmentId: string;
  limit?: number;                // Default: 20
  offset?: number;               // Default: 0
}
\`\`\`

**Returns:** List of events with user info and metadata.

---

#### `progress.getDashboardStats`

Gets dashboard statistics.

**Input:** `{ organizationId?: string }`

**Returns:**
\`\`\`typescript
{
  assessments: {
    total: number;
    inProgress: number;
    completed: number;
    overdue: number;
  };
  documents: { total: number; thisWeek: number; };
  activity: Array<{ ... }>;
}
\`\`\`

---

#### `progress.getAssessmentsNeedingAttention`

Gets assessments that are overdue or stalled.

**Input:**
\`\`\`typescript
{
  organizationId?: string;
  limit?: number;
}
\`\`\`

**Returns:** List of assessments with reason ("overdue" | "stalled").

---

### Questionnaire Router (`questionnaire.*`)

Manages questionnaires and questions.

#### `questionnaire.list`

Lists available questionnaires.

**Input:**
\`\`\`typescript
{
  type?: "ANS_USOAP_CMA" | "SMS_CANSO_SOE";
  isActive?: boolean;
}
\`\`\`

---

#### `questionnaire.getById`

Gets questionnaire with categories and question counts.

**Input:** `{ id: string }`

---

#### `questionnaire.getQuestions`

Gets questions with filtering.

**Input:**
\`\`\`typescript
{
  questionnaireId: string;
  categoryId?: string;
  auditArea?: string;
  criticalElement?: string;
  smsComponent?: string;
  studyArea?: string;
  isPriorityPQ?: boolean;
  page?: number;
  limit?: number;
}
\`\`\`

---

### Evidence Router (`evidence.*`)

Manages evidence documents.

#### `evidence.upload`

Initiates file upload.

**Input:**
\`\`\`typescript
{
  assessmentId: string;
  questionId: string;
  fileName: string;
  fileType: string;
  fileSize: number;              // Max 10MB
}
\`\`\`

**Returns:** Signed upload URL.

---

#### `evidence.confirm`

Confirms successful upload.

**Input:**
\`\`\`typescript
{
  assessmentId: string;
  questionId: string;
  fileUrl: string;
  description?: string;
}
\`\`\`

---

#### `evidence.remove`

Removes evidence from a response.

**Input:**
\`\`\`typescript
{
  assessmentId: string;
  questionId: string;
  evidenceUrl: string;
}
\`\`\`

---

## Error Handling

All tRPC errors follow this structure:

\`\`\`typescript
{
  code: "NOT_FOUND" | "FORBIDDEN" | "BAD_REQUEST" | "UNAUTHORIZED" | "CONFLICT" | ...;
  message: string;
}
\`\`\`

### Common Error Codes

| Code | Description |
|------|-------------|
| `NOT_FOUND` | Resource does not exist |
| `FORBIDDEN` | User lacks permission |
| `BAD_REQUEST` | Invalid input or state |
| `UNAUTHORIZED` | Not authenticated |
| `CONFLICT` | Resource conflict (e.g., duplicate) |

---

## Status Transitions

### Valid Assessment Status Transitions

\`\`\`
DRAFT → SUBMITTED → UNDER_REVIEW → COMPLETED → ARCHIVED
         ↓              ↓
       DRAFT        SUBMITTED
\`\`\`

| From | Allowed To |
|------|-----------|
| DRAFT | SUBMITTED, ARCHIVED |
| SUBMITTED | UNDER_REVIEW, DRAFT (reopen) |
| UNDER_REVIEW | COMPLETED, SUBMITTED (return) |
| COMPLETED | ARCHIVED |
| ARCHIVED | (none) |

---

## Role-Based Access

### Assessment Access Matrix

| Role | View Own Org | View Other Org | Edit Own Org |
|------|-------------|----------------|--------------|
| SUPER_ADMIN | ✓ | ✓ | ✓ |
| SYSTEM_ADMIN | ✓ | ✓ | ✓ |
| PROGRAMME_COORDINATOR | ✓ | ✓ | ✓ |
| ANSP_ADMIN | ✓ | ✗ | ✓ |
| SAFETY_MANAGER | ✓ | ✗ | ✓ |
| QUALITY_MANAGER | ✓ | ✗ | ✓ |
| STAFF | ✓ | ✗ | ✗ |
| PEER_REVIEWER | ✓ | Submitted+ | ✗ |
| LEAD_REVIEWER | ✓ | Submitted+ | Review only |
| STEERING_COMMITTEE | ✓ | Completed only | ✗ |

---

## Scoring Formulas

### EI Score (ANS USOAP CMA)

\`\`\`
EI = (Satisfactory / (Satisfactory + Not Satisfactory)) × 100
\`\`\`

- NOT_APPLICABLE and NOT_REVIEWED are excluded from calculation
- Calculated per audit area and critical element

### SMS Maturity (CANSO SoE)

\`\`\`
Component Score = Average of question scores (1-5)
Overall Score = Weighted average of component scores
Overall Level = Lowest component level (per CANSO guidance)
\`\`\`

**Component Weights:**
- Safety Policy & Objectives: 25%
- Safety Risk Management: 30%
- Safety Assurance: 25%
- Safety Promotion: 20%

**Level Thresholds:**
| Level | Score Range | Percentage |
|-------|-------------|------------|
| A | 1.0 - 1.4 | 0-20% |
| B | 1.5 - 2.4 | 21-40% |
| C | 2.5 - 3.4 | 41-60% |
| D | 3.5 - 4.4 | 61-80% |
| E | 4.5 - 5.0 | 81-100% |

---

## Client Usage Examples

### React Query (via tRPC)

\`\`\`typescript
// Fetching assessments
const { data, isLoading, error } = trpc.assessment.list.useQuery({
  status: "DRAFT",
  page: 1,
  limit: 10,
});

// Creating an assessment
const createMutation = trpc.assessment.create.useMutation({
  onSuccess: (data) => {
    // Navigate to new assessment
    router.push(`/assessments/${data.id}`);
  },
});

createMutation.mutate({
  questionnaireType: "ANS_USOAP_CMA",
  assessmentType: "SELF_ASSESSMENT",
  title: "2024 ANS Self-Assessment",
});

// Saving a response
const saveMutation = trpc.assessment.saveResponse.useMutation();

saveMutation.mutate({
  assessmentId: "clx...",
  questionId: "clx...",
  responseValue: "SATISFACTORY",
  notes: "Evidence document attached.",
});
\`\`\`

### Server-Side Usage

\`\`\`typescript
// In a Server Component or API route
import { createCaller } from "@/server/trpc/routers/_app";
import { createContext } from "@/server/trpc/context";

const ctx = await createContext();
const caller = createCaller(ctx);

const assessments = await caller.assessment.list({
  status: "COMPLETED",
  limit: 5,
});
\`\`\`

---

## Internationalization

All API responses include bilingual fields where applicable:

\`\`\`typescript
interface BilingualField {
  nameEn: string;
  nameFr: string;
  // or
  titleEn: string;
  titleFr: string;
  // or
  descriptionEn: string;
  descriptionFr: string;
}
\`\`\`

Select the appropriate field based on user locale:
\`\`\`typescript
const label = locale === "fr" ? item.nameFr : item.nameEn;
\`\`\`

```

# docs/IMPORT_FORMAT.md

```md
# Import Format Specification

This document describes the JSON and CSV formats for importing questionnaire data into the African ANSP Peer Review Platform.

## Table of Contents

1. [ANS USOAP CMA Import Format](#ans-usoap-cma-import-format)
2. [SMS CANSO SoE Import Format](#sms-canso-soe-import-format)
3. [CSV Format Specification](#csv-format-specification)
4. [Validation Rules](#validation-rules)
5. [Example Files](#example-files)

---

## ANS USOAP CMA Import Format

### JSON Schema

\`\`\`json
{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "required": ["questionnaire", "categories", "questions"],
  "properties": {
    "questionnaire": {
      "type": "object",
      "required": ["code", "version", "titleEn", "titleFr", "effectiveDate"],
      "properties": {
        "code": {
          "type": "string",
          "description": "Unique questionnaire code",
          "example": "USOAP_CMA_2024"
        },
        "version": {
          "type": "string",
          "description": "Version identifier",
          "example": "2024.1"
        },
        "titleEn": {
          "type": "string",
          "description": "English title"
        },
        "titleFr": {
          "type": "string",
          "description": "French title"
        },
        "descriptionEn": {
          "type": "string",
          "description": "English description (optional)"
        },
        "descriptionFr": {
          "type": "string",
          "description": "French description (optional)"
        },
        "effectiveDate": {
          "type": "string",
          "format": "date",
          "description": "Effective date (ISO 8601)",
          "example": "2025-07-01"
        },
        "expiryDate": {
          "type": "string",
          "format": "date",
          "description": "Expiry date (optional)"
        }
      }
    },
    "categories": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/ANSCategory"
      }
    },
    "questions": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/ANSQuestion"
      }
    }
  },
  "definitions": {
    "ANSCategory": {
      "type": "object",
      "required": ["code", "auditArea", "nameEn", "nameFr", "sortOrder"],
      "properties": {
        "code": {
          "type": "string",
          "description": "Category code (e.g., 'AGA')"
        },
        "auditArea": {
          "type": "string",
          "enum": ["LEG", "ORG", "PEL", "OPS", "AIR", "AIG", "ANS", "AGA", "SSP"]
        },
        "nameEn": { "type": "string" },
        "nameFr": { "type": "string" },
        "descriptionEn": { "type": "string" },
        "descriptionFr": { "type": "string" },
        "sortOrder": { "type": "integer" }
      }
    },
    "ANSQuestion": {
      "type": "object",
      "required": ["pqNumber", "categoryCode", "auditArea", "criticalElement", "questionTextEn", "sortOrder"],
      "properties": {
        "pqNumber": {
          "type": "string",
          "pattern": "^[A-Z]{2,3}\\s\\d+\\.\\d{3}$",
          "description": "Protocol Question number (e.g., 'AGA 1.001')"
        },
        "categoryCode": {
          "type": "string",
          "description": "Reference to category code"
        },
        "auditArea": {
          "type": "string",
          "enum": ["LEG", "ORG", "PEL", "OPS", "AIR", "AIG", "ANS", "AGA", "SSP"]
        },
        "criticalElement": {
          "type": "string",
          "enum": ["CE_1", "CE_2", "CE_3", "CE_4", "CE_5", "CE_6", "CE_7", "CE_8"]
        },
        "isPriorityPQ": {
          "type": "boolean",
          "default": false
        },
        "requiresOnSite": {
          "type": "boolean",
          "default": false
        },
        "pqStatus": {
          "type": "string",
          "enum": ["NO_CHANGE", "REVISED", "NEW", "MERGED", "DELETED", "REFERENCE_REVISED"],
          "default": "NO_CHANGE"
        },
        "previousPqNumber": {
          "type": "string",
          "description": "Previous PQ number if merged/revised"
        },
        "questionTextEn": { "type": "string" },
        "questionTextFr": { "type": "string" },
        "guidanceEn": { "type": "string" },
        "guidanceFr": { "type": "string" },
        "weight": {
          "type": "number",
          "default": 1.0
        },
        "sortOrder": { "type": "integer" },
        "icaoReferences": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/ICAOReference"
          }
        }
      }
    },
    "ICAOReference": {
      "type": "object",
      "required": ["referenceType", "document"],
      "properties": {
        "referenceType": {
          "type": "string",
          "enum": ["CC", "STD", "RP", "PANS", "GM", "Cir", "SUPPS"]
        },
        "document": {
          "type": "string",
          "description": "Document identifier (e.g., 'Annex 14')"
        },
        "chapter": {
          "type": "string",
          "description": "Chapter/section reference"
        },
        "description": {
          "type": "string"
        }
      }
    }
  }
}
\`\`\`

### Example ANS JSON

\`\`\`json
{
  "questionnaire": {
    "code": "USOAP_CMA_2024",
    "version": "2024.1",
    "titleEn": "USOAP CMA 2024 Protocol Questions",
    "titleFr": "Questions de Protocole USOAP CMA 2024",
    "descriptionEn": "ICAO Universal Safety Oversight Audit Programme - Continuous Monitoring Approach",
    "descriptionFr": "Programme Universel d'Audit de Surveillance de la Sécurité de l'OACI",
    "effectiveDate": "2025-07-01"
  },
  "categories": [
    {
      "code": "AGA",
      "auditArea": "AGA",
      "nameEn": "Aerodromes and Ground Aids",
      "nameFr": "Aérodromes et Aides au Sol",
      "descriptionEn": "Certification and oversight of aerodromes",
      "descriptionFr": "Certification et surveillance des aérodromes",
      "sortOrder": 8
    }
  ],
  "questions": [
    {
      "pqNumber": "AGA 1.001",
      "categoryCode": "AGA",
      "auditArea": "AGA",
      "criticalElement": "CE_1",
      "isPriorityPQ": true,
      "requiresOnSite": false,
      "pqStatus": "NO_CHANGE",
      "questionTextEn": "Has the State promulgated national legislation for the certification of aerodromes?",
      "questionTextFr": "L'État a-t-il promulgué une législation nationale pour la certification des aérodromes?",
      "guidanceEn": "Review the primary aviation legislation to verify provisions for aerodrome certification.",
      "guidanceFr": "Examiner la législation aéronautique primaire pour vérifier les dispositions relatives à la certification des aérodromes.",
      "weight": 1.0,
      "sortOrder": 1,
      "icaoReferences": [
        {
          "referenceType": "STD",
          "document": "Annex 14",
          "chapter": "1.4",
          "description": "Aerodrome Certification"
        },
        {
          "referenceType": "GM",
          "document": "Doc 9774",
          "description": "Manual on Certification of Aerodromes"
        }
      ]
    }
  ]
}
\`\`\`

---

## SMS CANSO SoE Import Format

### JSON Schema

\`\`\`json
{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "required": ["questionnaire", "categories", "questions"],
  "properties": {
    "questionnaire": {
      "type": "object",
      "required": ["code", "version", "titleEn", "titleFr", "effectiveDate"],
      "properties": {
        "code": { "type": "string" },
        "version": { "type": "string" },
        "titleEn": { "type": "string" },
        "titleFr": { "type": "string" },
        "descriptionEn": { "type": "string" },
        "descriptionFr": { "type": "string" },
        "effectiveDate": { "type": "string", "format": "date" }
      }
    },
    "categories": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/SMSCategory"
      }
    },
    "questions": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/SMSQuestion"
      }
    }
  },
  "definitions": {
    "SMSCategory": {
      "type": "object",
      "required": ["code", "smsComponent", "studyArea", "nameEn", "nameFr", "sortOrder"],
      "properties": {
        "code": { "type": "string" },
        "smsComponent": {
          "type": "string",
          "enum": [
            "SAFETY_POLICY_OBJECTIVES",
            "SAFETY_RISK_MANAGEMENT",
            "SAFETY_ASSURANCE",
            "SAFETY_PROMOTION"
          ]
        },
        "studyArea": {
          "type": "string",
          "enum": [
            "SA_1_1", "SA_1_2", "SA_1_3", "SA_1_4", "SA_1_5",
            "SA_2_1", "SA_2_2",
            "SA_3_1", "SA_3_2", "SA_3_3",
            "SA_4_1", "SA_4_2"
          ]
        },
        "transversalArea": {
          "type": "string",
          "enum": ["SPM", "HP", "CI"],
          "description": "Optional cross-cutting area"
        },
        "nameEn": { "type": "string" },
        "nameFr": { "type": "string" },
        "sortOrder": { "type": "integer" }
      }
    },
    "SMSQuestion": {
      "type": "object",
      "required": ["categoryCode", "smsComponent", "studyArea", "maturityLevel", "questionTextEn", "sortOrder"],
      "properties": {
        "categoryCode": { "type": "string" },
        "smsComponent": {
          "type": "string",
          "enum": [
            "SAFETY_POLICY_OBJECTIVES",
            "SAFETY_RISK_MANAGEMENT",
            "SAFETY_ASSURANCE",
            "SAFETY_PROMOTION"
          ]
        },
        "studyArea": {
          "type": "string",
          "enum": [
            "SA_1_1", "SA_1_2", "SA_1_3", "SA_1_4", "SA_1_5",
            "SA_2_1", "SA_2_2",
            "SA_3_1", "SA_3_2", "SA_3_3",
            "SA_4_1", "SA_4_2"
          ]
        },
        "maturityLevel": {
          "type": "string",
          "enum": ["LEVEL_A", "LEVEL_B", "LEVEL_C", "LEVEL_D", "LEVEL_E"]
        },
        "transversalArea": {
          "type": "string",
          "enum": ["SPM", "HP", "CI"]
        },
        "questionTextEn": { "type": "string" },
        "questionTextFr": { "type": "string" },
        "guidanceEn": { "type": "string" },
        "guidanceFr": { "type": "string" },
        "weight": { "type": "number", "default": 1.0 },
        "sortOrder": { "type": "integer" }
      }
    }
  }
}
\`\`\`

### Example SMS JSON

\`\`\`json
{
  "questionnaire": {
    "code": "CANSO_SOE_2024",
    "version": "2024.1",
    "titleEn": "CANSO Standard of Excellence 2024",
    "titleFr": "Norme d'Excellence CANSO 2024",
    "effectiveDate": "2024-01-01"
  },
  "categories": [
    {
      "code": "SA_1_1",
      "smsComponent": "SAFETY_POLICY_OBJECTIVES",
      "studyArea": "SA_1_1",
      "nameEn": "Management Commitment and Responsibility",
      "nameFr": "Engagement et Responsabilité de la Direction",
      "sortOrder": 1
    }
  ],
  "questions": [
    {
      "categoryCode": "SA_1_1",
      "smsComponent": "SAFETY_POLICY_OBJECTIVES",
      "studyArea": "SA_1_1",
      "maturityLevel": "LEVEL_A",
      "questionTextEn": "Senior management has made an informal commitment to safety.",
      "questionTextFr": "La haute direction a pris un engagement informel envers la sécurité.",
      "guidanceEn": "Look for evidence of verbal commitment to safety by senior leaders.",
      "guidanceFr": "Rechercher des preuves d'engagement verbal envers la sécurité par les dirigeants.",
      "weight": 1.0,
      "sortOrder": 1
    },
    {
      "categoryCode": "SA_1_1",
      "smsComponent": "SAFETY_POLICY_OBJECTIVES",
      "studyArea": "SA_1_1",
      "maturityLevel": "LEVEL_E",
      "transversalArea": "CI",
      "questionTextEn": "The organization is recognized as an industry leader in safety management.",
      "questionTextFr": "L'organisation est reconnue comme leader de l'industrie en gestion de la sécurité.",
      "weight": 1.0,
      "sortOrder": 5
    }
  ]
}
\`\`\`

---

## CSV Format Specification

CSV files can be used as an alternative to JSON. The system auto-detects the format based on file extension.

### ANS CSV Format

| Column | Required | Description |
|--------|----------|-------------|
| pqNumber | Yes | Protocol Question number (e.g., "AGA 1.001") |
| auditArea | Yes | LEG, ORG, PEL, OPS, AIR, AIG, ANS, AGA, SSP |
| criticalElement | Yes | CE_1 through CE_8 |
| isPriorityPQ | No | TRUE/FALSE (default: FALSE) |
| requiresOnSite | No | TRUE/FALSE (default: FALSE) |
| pqStatus | No | NO_CHANGE, REVISED, NEW, MERGED, DELETED |
| previousPqNumber | No | Previous PQ if merged/revised |
| questionTextEn | Yes | English question text |
| questionTextFr | No | French question text |
| guidanceEn | No | English guidance |
| guidanceFr | No | French guidance |
| weight | No | Numeric weight (default: 1.0) |
| sortOrder | Yes | Numeric sort order |
| references | No | Pipe-separated references (see below) |

**Reference Format**: `TYPE:DOC:CHAPTER:DESC|TYPE:DOC:CHAPTER:DESC`

Example: `STD:Annex 14:1.4:Certification|GM:Doc 9774::Manual`

### SMS CSV Format

| Column | Required | Description |
|--------|----------|-------------|
| studyArea | Yes | SA_1_1 through SA_4_2 |
| smsComponent | Yes | SAFETY_POLICY_OBJECTIVES, etc. |
| maturityLevel | Yes | LEVEL_A through LEVEL_E |
| transversalArea | No | SPM, HP, CI |
| questionTextEn | Yes | English question text |
| questionTextFr | No | French question text |
| guidanceEn | No | English guidance |
| guidanceFr | No | French guidance |
| weight | No | Numeric weight (default: 1.0) |
| sortOrder | Yes | Numeric sort order |

### Example ANS CSV

\`\`\`csv
pqNumber,auditArea,criticalElement,isPriorityPQ,requiresOnSite,pqStatus,questionTextEn,questionTextFr,guidanceEn,guidanceFr,weight,sortOrder,references
AGA 1.001,AGA,CE_1,TRUE,FALSE,NO_CHANGE,"Has the State promulgated legislation for aerodrome certification?","L'État a-t-il promulgué une législation pour la certification des aérodromes?","Review primary aviation legislation","Examiner la législation aéronautique primaire",1.0,1,"STD:Annex 14:1.4:Certification|GM:Doc 9774::Manual"
AGA 1.002,AGA,CE_2,TRUE,FALSE,NEW,"Has the State adopted specific regulations for aerodrome design?","L'État a-t-il adopté des règlements spécifiques pour la conception des aérodromes?",,,,2,"STD:Annex 14:3.1:Physical Characteristics"
\`\`\`

---

## Validation Rules

### General Rules

1. **Encoding**: UTF-8 required for proper French character support (é, è, à, etc.)
2. **Required Fields**: All required fields must be non-empty
3. **Unique Identifiers**: PQ numbers must be unique within questionnaire
4. **Sort Order**: Must be positive integers, unique within category

### ANS-Specific Rules

1. **PQ Number Format**: Must match pattern `XXX N.NNN` (e.g., "AGA 1.001")
2. **Audit Area**: Must match category's audit area
3. **Critical Element**: Must be CE_1 through CE_8
4. **Amendment Status**: If MERGED or REVISED, `previousPqNumber` should be provided

### SMS-Specific Rules

1. **Study Area Mapping**: Study area must belong to correct SMS component:
   - Component 1: SA_1_1 through SA_1_5
   - Component 2: SA_2_1, SA_2_2
   - Component 3: SA_3_1 through SA_3_3
   - Component 4: SA_4_1, SA_4_2
2. **Maturity Level**: Questions should be ordered A → E for each study area
3. **Transversal Areas**: Optional, cross-cutting theme indicator

### Reference Rules

1. **Reference Type**: Must be valid ICAO reference type
2. **Document**: Required, identifies the source document
3. **Chapter**: Optional, specific section reference
4. **Description**: Optional, brief description of relevance

---

## Example Files

### Complete ANS Import File

See: `prisma/seed-data/ans-usoap-cma-2024.json`

### Complete SMS Import File

See: `prisma/seed-data/sms-canso-soe-2024.json`

### Sample Data for Testing

The system includes seed data for testing:
- 153 AGA Protocol Questions (complete AGA audit area)
- Full ICAO reference mappings
- Bilingual content (EN/FR)

---

## Import Process

### Step-by-Step

1. **Upload**: Select JSON or CSV file
2. **Parse**: System validates format and extracts data
3. **Preview**: Review parsed data with validation warnings
4. **Import**: Bulk insert with transaction rollback on error

### Error Handling

| Error Type | Description | Resolution |
|------------|-------------|------------|
| FORMAT_ERROR | Invalid JSON/CSV structure | Check file format |
| MISSING_FIELD | Required field is empty | Add missing data |
| INVALID_ENUM | Invalid enum value | Use correct value from list |
| DUPLICATE_PQ | PQ number already exists | Change PQ number or update existing |
| ENCODING_ERROR | Invalid characters | Save as UTF-8 |

### Bulk Operations

- Import supports up to 1000 questions per file
- Large imports are processed in batches of 100
- Progress is shown during import
- Rollback on any error in batch

---

## API Usage

### Validate Before Import

\`\`\`typescript
const result = await trpc.admin.questionnaire.validate.mutate({
  type: 'ANS_USOAP_CMA',
  data: jsonData,
});

if (result.errors.length > 0) {
  console.error('Validation errors:', result.errors);
}
\`\`\`

### Execute Import

\`\`\`typescript
const result = await trpc.admin.questionnaire.import.mutate({
  type: 'ANS_USOAP_CMA',
  data: jsonData,
});

console.log(`Imported ${result.questionsCount} questions`);
\`\`\`

```

# docs/QUESTIONNAIRE_SYSTEM.md

```md
# Questionnaire System Documentation

## Overview

The African ANSP Peer Review Platform implements a dual questionnaire system supporting two complementary assessment frameworks:

1. **ANS USOAP CMA 2024** - ICAO Universal Safety Oversight Audit Programme
2. **SMS CANSO SoE 2024** - CANSO Standard of Excellence for Safety Management Systems

Both frameworks are designed to assess and improve aviation safety oversight and management across African ANSPs.

## Architecture

### System Components

\`\`\`
┌─────────────────────────────────────────────────────────────────┐
│                        Frontend Layer                           │
├─────────────────────────────────────────────────────────────────┤
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────────────┐  │
│  │ ANS Browser  │  │ SMS Browser  │  │ Question Detail View │  │
│  └──────────────┘  └──────────────┘  └──────────────────────┘  │
│  ┌──────────────────────────────────────────────────────────┐  │
│  │              Admin Import Interface                       │  │
│  └──────────────────────────────────────────────────────────┘  │
├─────────────────────────────────────────────────────────────────┤
│                        API Layer (tRPC)                         │
├─────────────────────────────────────────────────────────────────┤
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────────────┐  │
│  │ questionnaire│  │   question   │  │        admin         │  │
│  │    router    │  │    router    │  │    questionnaire     │  │
│  └──────────────┘  └──────────────┘  └──────────────────────┘  │
├─────────────────────────────────────────────────────────────────┤
│                        Data Layer                               │
├─────────────────────────────────────────────────────────────────┤
│  ┌──────────────────────────────────────────────────────────┐  │
│  │                    Prisma ORM                             │  │
│  │  ┌─────────────┐ ┌─────────────┐ ┌───────────────────┐   │  │
│  │  │Questionnaire│ │  Question   │ │ ICAOReference     │   │  │
│  │  └─────────────┘ └─────────────┘ └───────────────────┘   │  │
│  │  ┌─────────────┐ ┌─────────────┐                         │  │
│  │  │  Category   │ │  Response   │                         │  │
│  │  └─────────────┘ └─────────────┘                         │  │
│  └──────────────────────────────────────────────────────────┘  │
├─────────────────────────────────────────────────────────────────┤
│                     PostgreSQL Database                         │
└─────────────────────────────────────────────────────────────────┘
\`\`\`

### File Structure

\`\`\`
src/
├── lib/questionnaire/
│   ├── constants.ts      # All static data (audit areas, CEs, SMS components)
│   ├── types.ts          # TypeScript interfaces and Zod schemas
│   └── import-parser.ts  # JSON/CSV import parsing logic
├── components/features/questionnaire/
│   ├── ans/              # ANS browser components
│   │   ├── ans-browser.tsx
│   │   ├── audit-area-filter.tsx
│   │   ├── critical-element-filter.tsx
│   │   └── pq-list.tsx
│   ├── sms/              # SMS browser components
│   │   ├── sms-browser.tsx
│   │   ├── component-tabs.tsx
│   │   ├── maturity-table.tsx
│   │   └── study-area-accordion.tsx
│   └── question-detail-modal.tsx
├── server/trpc/routers/
│   ├── questionnaire.ts  # Questionnaire CRUD operations
│   ├── question.ts       # Question queries with pagination
│   └── admin/
│       └── questionnaire.ts  # Admin import operations
└── app/[locale]/(dashboard)/
    ├── questionnaires/
    │   ├── page.tsx      # Questionnaire type selection
    │   ├── ans/page.tsx  # ANS browser page
    │   ├── sms/page.tsx  # SMS browser page
    │   └── question/[id]/page.tsx  # Question detail
    └── admin/questionnaires/
        ├── page.tsx      # Admin list view
        └── import/page.tsx  # Import wizard
\`\`\`

## Data Models

### Questionnaire

| Field | Type | Description |
|-------|------|-------------|
| id | String (CUID) | Primary key |
| code | String | Unique code (e.g., "USOAP_CMA_2024") |
| type | Enum | ANS_USOAP_CMA or SMS_CANSO_SOE |
| version | String | Version identifier |
| titleEn | String | English title |
| titleFr | String | French title |
| effectiveDate | DateTime | When questionnaire becomes effective |
| expiryDate | DateTime? | When questionnaire expires (optional) |
| isActive | Boolean | Whether questionnaire is active |

### QuestionnaireCategory

| Field | Type | Description |
|-------|------|-------------|
| id | String (CUID) | Primary key |
| questionnaireId | String | Foreign key to Questionnaire |
| code | String | Category code (e.g., "AGA") |
| nameEn | String | English name |
| nameFr | String | French name |
| auditArea | Enum? | For ANS: LEG, ORG, PEL, OPS, AIR, AIG, ANS, AGA, SSP |
| criticalElement | Enum? | For ANS: CE_1 through CE_8 |
| smsComponent | Enum? | For SMS: SAFETY_POLICY_OBJECTIVES, etc. |
| studyArea | Enum? | For SMS: SA_1_1, SA_1_2, etc. |
| sortOrder | Int | Display order |

### Question

| Field | Type | Description |
|-------|------|-------------|
| id | String (CUID) | Primary key |
| questionnaireId | String | Foreign key to Questionnaire |
| categoryId | String | Foreign key to Category |
| pqNumber | String? | Protocol Question number (e.g., "AGA 1.001") |
| questionTextEn | String | English question text |
| questionTextFr | String | French question text |
| guidanceEn | String? | English guidance for reviewers |
| guidanceFr | String? | French guidance for reviewers |
| auditArea | Enum? | Audit area (for ANS) |
| criticalElement | Enum? | Critical element (for ANS) |
| isPriorityPQ | Boolean | Is priority Protocol Question |
| requiresOnSite | Boolean | Requires on-site verification |
| pqStatus | Enum | NO_CHANGE, REVISED, NEW, MERGED, DELETED |
| smsComponent | Enum? | SMS component (for SMS) |
| studyArea | Enum? | Study area (for SMS) |
| maturityLevel | Enum? | Maturity level objective (for SMS) |
| responseType | Enum | SATISFACTORY_NOT, MATURITY_LEVEL, etc. |
| weight | Float | Question weight for scoring |
| sortOrder | Int | Display order |

### ICAOReference

| Field | Type | Description |
|-------|------|-------------|
| id | String (CUID) | Primary key |
| questionId | String | Foreign key to Question |
| referenceType | Enum | CC, STD, RP, PANS, GM, Cir, SUPPS |
| document | String | Document identifier (e.g., "Annex 14") |
| chapter | String? | Chapter/section reference |
| description | String? | Reference description |

## API Endpoints

### tRPC Routes

#### Questionnaire Router (`/api/trpc/questionnaire.*`)

| Procedure | Type | Description |
|-----------|------|-------------|
| `list` | Query | List all questionnaires with pagination |
| `getById` | Query | Get single questionnaire by ID |
| `getByCode` | Query | Get questionnaire by code |
| `getActive` | Query | Get all active questionnaires |
| `getStats` | Query | Get questionnaire statistics |

#### Question Router (`/api/trpc/question.*`)

| Procedure | Type | Description |
|-----------|------|-------------|
| `list` | Query | List questions with filters and pagination |
| `getById` | Query | Get single question with ICAO references |
| `getByPqNumber` | Query | Get question by PQ number |
| `getFiltered` | Query | Get filtered questions for export |

#### Admin Questionnaire Router (`/api/trpc/admin.questionnaire.*`)

| Procedure | Type | Description |
|-----------|------|-------------|
| `import` | Mutation | Import questionnaire from JSON/CSV |
| `validate` | Mutation | Validate import data before import |
| `delete` | Mutation | Soft delete (deactivate) questionnaire |
| `hardDelete` | Mutation | Permanently delete questionnaire |

### Query Parameters

#### Question List Filters

| Parameter | Type | Description |
|-----------|------|-------------|
| questionnaireId | String | Filter by questionnaire |
| auditArea | Enum | Filter by audit area |
| criticalElement | Enum | Filter by critical element |
| smsComponent | Enum | Filter by SMS component |
| studyArea | Enum | Filter by study area |
| isPriorityPQ | Boolean | Filter priority PQs only |
| requiresOnSite | Boolean | Filter on-site required only |
| pqStatus | Enum | Filter by amendment status |
| search | String | Full-text search on question text |
| page | Number | Page number (default: 1) |
| pageSize | Number | Items per page (1-100, default: 20) |

## Scoring Methods

### ANS USOAP CMA - Effective Implementation (EI)

The EI score is calculated as:

\`\`\`
EI = (Satisfactory PQs / Total Applicable PQs) × 100
\`\`\`

- Each Protocol Question has a binary result: Satisfactory (S) or Not Satisfactory (NS)
- Not Applicable (NA) questions are excluded from the calculation
- Priority PQs may be weighted differently

### SMS CANSO SoE - Maturity Scoring

The SMS score uses a weighted average across components:

\`\`\`
SMS Score = Σ (Component Score × Component Weight)
\`\`\`

| Component | Weight |
|-----------|--------|
| Safety Policy and Objectives | 25% |
| Safety Risk Management | 30% |
| Safety Assurance | 25% |
| Safety Promotion | 20% |

Each question is scored on a 5-level maturity scale:

| Level | Name | Score |
|-------|------|-------|
| A | Informal | 1 |
| B | Defined | 2 |
| C | Managed | 3 |
| D | Resilient | 4 |
| E | Excellence | 5 |

## Filtering and Search

### ANS Browser

The ANS browser supports:
- **Multi-select audit area filter**: Select one or more of 9 audit areas
- **Multi-select critical element filter**: Select one or more of 8 critical elements
- **Priority PQ toggle**: Show only priority Protocol Questions
- **On-site required toggle**: Show only questions requiring on-site verification
- **Full-text search**: Search by PQ number or question text
- **Amendment status badge**: Visual indicator for new/revised questions

### SMS Browser

The SMS browser supports:
- **Component tabs**: Navigate between 4 SMS components
- **Study area accordion**: Expand study areas within each component
- **Maturity level table**: View objectives by maturity level
- **Transversal area indicators**: SPM, HP, CI cross-cutting areas

## Internationalization

All content supports English (EN) and French (FR):
- Question text in both languages
- Guidance text in both languages
- Category and audit area names
- Critical element descriptions
- SMS component and study area names
- UI labels and navigation

Language is determined by:
1. URL locale parameter (`/en/` or `/fr/`)
2. User preference stored in profile
3. Browser language detection

## Admin Operations

### Import Workflow

1. **Select Type**: Choose ANS or SMS questionnaire type
2. **Upload File**: Upload JSON or CSV file
3. **Preview**: Review parsed data with validation
4. **Import**: Bulk insert into database

### Data Validation

The import process validates:
- Required fields present
- Valid enum values for areas/elements/components
- Unique PQ numbers
- Valid ICAO reference format
- UTF-8 encoding for bilingual text

### Bulk Operations

- **Deactivate**: Soft delete (preserves assessment data)
- **Delete**: Permanent removal (admin only)
- **Export**: Generate JSON/CSV for backup

## Performance Considerations

### Pagination

All list endpoints return paginated results:
- Default page size: 20
- Maximum page size: 100
- Cursor-based pagination for large datasets

### Indexing

Database indexes on:
- `questions.auditArea, criticalElement`
- `questions.smsComponent, studyArea`
- `questions.questionnaireId, pqNumber`
- `questions.questionTextEn, questionTextFr` (full-text)

### Caching

- Static constants cached at module level
- React Query caching for API responses
- Server-side rendering for initial data

## Testing

### Unit Tests

Location: `src/__tests__/questionnaire/`

- `constants.test.ts`: Tests for all static data
- `types.test.ts`: Tests for Zod validation schemas

### Running Tests

\`\`\`bash
# Run all tests
npm run test

# Run tests once
npm run test:run

# Run with coverage
npm run test:coverage
\`\`\`

## Related Documentation

- [Import Format Specification](./IMPORT_FORMAT.md)
- [API Reference](./API_REFERENCE.md)
- [Database Schema](./DATABASE_SCHEMA.md)

```

# eslint.config.mjs

```mjs
import { defineConfig, globalIgnores } from "eslint/config";
import nextVitals from "eslint-config-next/core-web-vitals";
import nextTs from "eslint-config-next/typescript";

const eslintConfig = defineConfig([
  ...nextVitals,
  ...nextTs,
  // Override default ignores of eslint-config-next.
  globalIgnores([
    // Default ignores of eslint-config-next:
    ".next/**",
    "out/**",
    "build/**",
    "next-env.d.ts",
  ]),
]);

export default eslintConfig;

```

# messages/en.json

```json
{
  "common": {
    "appName": "African ANSP Peer Review",
    "appTagline": "Collaborative Excellence in Aviation Safety",
    "actions": {
      "save": "Save",
      "cancel": "Cancel",
      "submit": "Submit",
      "delete": "Delete",
      "edit": "Edit",
      "view": "View",
      "close": "Close",
      "confirm": "Confirm",
      "back": "Back",
      "next": "Next",
      "profile": "Profile",
      "settings": "Settings",
      "logout": "Log out",
      "search": "Search",
      "filter": "Filter",
      "export": "Export",
      "import": "Import",
      "refresh": "Refresh",
      "loading": "Loading...",
      "retry": "Retry"
    },
    "submitting": "Submitting...",
    "status": {
      "active": "Active",
      "inactive": "Inactive",
      "pending": "Pending",
      "completed": "Completed",
      "draft": "Draft",
      "submitted": "Submitted",
      "inProgress": "In Progress",
      "archived": "Archived"
    },
    "validation": {
      "required": "This field is required",
      "invalidEmail": "Please enter a valid email address",
      "minLength": "Minimum {min} characters required",
      "maxLength": "Maximum {max} characters allowed"
    }
  },
  "navigation": {
    "dashboard": "Dashboard",
    "questionnaires": "Questionnaires",
    "assessments": "Assessments",
    "reviews": "Peer Reviews",
    "organizations": "Organizations",
    "reviewers": "Reviewers",
    "training": "Training",
    "settings": "Settings",
    "admin": "Administration"
  },
  "auth": {
    "login": {
      "title": "Welcome back",
      "subtitle": "Sign in to your account to continue",
      "signIn": "Sign in",
      "signingIn": "Signing in...",
      "forgotPassword": "Forgot password?",
      "noAccount": "Don't have an account?",
      "signUp": "Sign up"
    },
    "register": {
      "title": "Create an account",
      "subtitle": "Join the African ANSP Peer Review Program",
      "createAccount": "Create account",
      "creating": "Creating account...",
      "haveAccount": "Already have an account?",
      "signIn": "Sign in",
      "success": "Account created successfully!",
      "redirecting": "Redirecting to login...",
      "passwordRequirements": "Min 12 characters with uppercase, lowercase, number, and special character"
    },
    "fields": {
      "email": "Email",
      "password": "Password",
      "confirmPassword": "Confirm Password",
      "firstName": "First Name",
      "lastName": "Last Name",
      "language": "Preferred Language"
    },
    "errors": {
      "invalidCredentials": "Invalid email or password",
      "generic": "An error occurred. Please try again.",
      "sessionExpired": "Your session has expired. Please sign in again.",
      "unauthorized": "You are not authorized to access this resource.",
      "networkError": "Network error. Please check your connection."
    }
  },
  "dashboard": {
    "title": "Dashboard",
    "welcome": "Welcome back, {name}!",
    "subtitle": "Here's an overview of your peer review activities.",
    "newAssessment": "New Assessment",
    "stats": {
      "totalAssessments": "Total Assessments",
      "inProgress": "in progress",
      "completed": "Completed",
      "documents": "Documents",
      "thisWeek": "this week",
      "overdue": "Overdue"
    },
    "assessments": {
      "title": "Assessment Status",
      "overdue": "assessments overdue",
      "active": "active",
      "viewAll": "View All"
    },
    "activity": {
      "title": "Recent Activity",
      "empty": "No recent activity",
      "viewAll": "View All"
    },
    "attention": {
      "title": "Needs Attention",
      "allOnTrack": "All assessments are on track!",
      "overdue": "Overdue",
      "stalled": "Stalled",
      "viewAll": "View All"
    },
    "quickActions": {
      "title": "Quick Actions",
      "description": "Get started with common tasks",
      "newAssessment": "Start Self-Assessment",
      "newAssessmentDesc": "Begin a new ANS or SMS assessment",
      "questionnaires": "Browse Questionnaires",
      "questionnairesDesc": "Explore USOAP CMA and CANSO SoE frameworks",
      "training": "Training Modules",
      "trainingDesc": "Access peer reviewer training materials"
    }
  },
  "progress": {
    "loading": "Loading progress...",
    "refresh": "Refresh",
    "continue": "Continue Assessment",
    "error": {
      "title": "Error",
      "notFound": "Assessment not found",
      "back": "Back to Assessments"
    },
    "summary": {
      "progress": "Overall Progress",
      "questions": "questions",
      "status": "Status",
      "activity": "Events",
      "dueDate": "Due Date",
      "noDueDate": "No due date"
    },
    "tabs": {
      "progress": "Progress",
      "timeline": "Timeline"
    },
    "categories": {
      "title": "Progress by Category",
      "description": "Track your progress across all questionnaire categories",
      "overallProgress": "Overall Progress"
    },
    "timeline": {
      "title": "Activity Timeline",
      "description": "Track all activity on this assessment",
      "empty": "No activity recorded yet",
      "loadMore": "Load More"
    }
  },
  "assessment": {
    "title": "Self-Assessment",
    "subtitle": "Evaluate your organization against ICAO and CANSO standards",
    "list": {
      "title": "Assessments",
      "description": "Manage your self-assessments and track progress",
      "newAssessment": "New Assessment",
      "loading": "Loading assessments...",
      "updated": "Updated",
      "due": "Due",
      "progress": "Progress",
      "view": "View",
      "continue": "Continue",
      "empty": {
        "title": "No assessments yet",
        "description": "Start your first self-assessment to evaluate compliance with ICAO standards or SMS maturity.",
        "create": "Create Assessment"
      }
    },
    "stats": {
      "total": "Total Assessments",
      "inProgress": "In Progress",
      "completed": "Completed",
      "submitted": "Submitted"
    },
    "status": {
      "draft": "Draft",
      "inProgress": "In Progress",
      "submitted": "Submitted",
      "underReview": "Under Review",
      "completed": "Completed",
      "archived": "Archived",
      "DRAFT": "Draft",
      "IN_PROGRESS": "In Progress",
      "SUBMITTED": "Submitted",
      "UNDER_REVIEW": "Under Review",
      "COMPLETED": "Completed",
      "ARCHIVED": "Archived"
    },
    "statusDescription": {
      "DRAFT": "Assessment has been created but not started",
      "IN_PROGRESS": "Assessment is actively being completed",
      "SUBMITTED": "Assessment submitted for review",
      "UNDER_REVIEW": "Assessment is being reviewed",
      "COMPLETED": "Assessment has been finalized",
      "ARCHIVED": "Assessment has been archived"
    },
    "types": {
      "SELF_ASSESSMENT": "Self-Assessment",
      "GAP_ANALYSIS": "Gap Analysis",
      "PRE_REVIEW": "Pre-Review Assessment",
      "MOCK_REVIEW": "Mock Review"
    },
    "typeDescription": {
      "SELF_ASSESSMENT": "Initial self-evaluation against standards",
      "GAP_ANALYSIS": "Identify gaps between current state and requirements",
      "PRE_REVIEW": "Preparation assessment before formal peer review",
      "MOCK_REVIEW": "Practice assessment simulating peer review"
    },
    "responses": {
      "SATISFACTORY": "Satisfactory",
      "NOT_SATISFACTORY": "Not Satisfactory",
      "NOT_APPLICABLE": "Not Applicable",
      "NOT_REVIEWED": "Not Reviewed"
    },
    "responseDescription": {
      "SATISFACTORY": "Evidence confirms compliance with the protocol question requirements",
      "NOT_SATISFACTORY": "Evidence indicates non-compliance or insufficient implementation",
      "NOT_APPLICABLE": "Protocol question is not applicable to this organization",
      "NOT_REVIEWED": "Question has not been reviewed yet"
    },
    "maturity": {
      "A": "Level A - Informal",
      "B": "Level B - Defined",
      "C": "Level C - Managed",
      "D": "Level D - Assured",
      "E": "Level E - Excellence"
    },
    "maturityDescription": {
      "A": "Ad-hoc safety management. No systematic approach.",
      "B": "Safety processes are documented and implemented.",
      "C": "Safety processes are systematically applied and monitored.",
      "D": "Safety performance is measured against targets.",
      "E": "Continuous improvement and predictive safety management."
    },
    "evidence": {
      "types": {
        "DOCUMENT": "Document",
        "PROCEDURE": "Procedure",
        "RECORD": "Record",
        "INTERVIEW": "Interview",
        "OBSERVATION": "Observation",
        "OTHER": "Other"
      },
      "typeDescription": {
        "DOCUMENT": "Written documentation such as manuals, plans, or policies",
        "PROCEDURE": "Documented procedures, work instructions, or guidelines",
        "RECORD": "Records of activities, logs, or audit trails",
        "INTERVIEW": "Information gathered through interviews or discussions",
        "OBSERVATION": "Direct observation of activities or conditions",
        "OTHER": "Other types of evidence not fitting above categories"
      },
      "upload": "Upload Evidence",
      "attach": "Attach Evidence",
      "remove": "Remove Evidence",
      "verified": "Verified",
      "unverified": "Unverified",
      "validFrom": "Valid From",
      "validUntil": "Valid Until",
      "expired": "Expired"
    },
    "scoring": {
      "eiScore": "EI Score",
      "eiScoreDescription": "Effective Implementation score calculated as percentage of satisfactory questions",
      "smsMaturity": "SMS Maturity",
      "smsMaturityDescription": "Overall SMS maturity level based on CANSO Standard of Excellence",
      "overallScore": "Overall Score",
      "categoryScore": "Category Score",
      "componentScore": "Component Score",
      "weightedAverage": "Weighted Average",
      "lowestLevel": "Lowest Level",
      "targetNotMet": "Target Not Met",
      "targetMet": "Target Met",
      "exceededTarget": "Exceeded Target"
    },
    "progress": {
      "notStarted": "Not Started",
      "justStarted": "Just Started",
      "inProgress": "In Progress",
      "halfwayComplete": "Halfway Complete",
      "almostComplete": "Almost Complete",
      "complete": "Complete",
      "percentComplete": "{percent}% Complete",
      "questionsAnswered": "{answered} of {total} questions answered",
      "estimatedTime": "Estimated time remaining: {time}",
      "lastActivity": "Last activity: {date}"
    },
    "actions": {
      "start": "Start Assessment",
      "continue": "Continue Assessment",
      "submit": "Submit Assessment",
      "review": "Review Assessment",
      "complete": "Complete Assessment",
      "archive": "Archive Assessment",
      "export": "Export Assessment",
      "compare": "Compare Assessments"
    },
    "submitSuccess": "Assessment submitted successfully",
    "submitError": "Failed to submit assessment",
    "confirmSubmit": {
      "title": "Submit Assessment",
      "description": "Are you sure you want to submit this assessment? Once submitted, you will not be able to make changes until it is reopened."
    },
    "validation": {
      "incompleteQuestions": "{count} questions still need to be answered",
      "missingEvidence": "Only {percent}% of questions have supporting evidence",
      "incompleteCategories": "{count} categories have unanswered questions",
      "canSubmit": "Assessment is ready for submission",
      "cannotSubmit": "Assessment cannot be submitted yet"
    }
  },
  "questionnaire": {
    "title": "Questionnaires",
    "subtitle": "Browse USOAP CMA Protocol Questions and CANSO SoE assessments",
    "selectType": "Select questionnaire type",
    "ans": {
      "title": "ANS Questionnaire",
      "fullTitle": "USOAP CMA 2024 Protocol Questions",
      "description": "851 Protocol Questions across 9 audit areas aligned with ICAO standards for Air Navigation Services oversight",
      "effectiveDate": "Effective: July 1, 2025",
      "auditAreas": "Audit Areas",
      "criticalElements": "Critical Elements",
      "browse": "Browse Questions"
    },
    "sms": {
      "title": "SMS Questionnaire",
      "fullTitle": "CANSO Standard of Excellence 2024",
      "description": "Safety Management System maturity assessment across 4 components and 12 study areas",
      "components": "SMS Components",
      "studyAreas": "Study Areas",
      "maturityLevels": "Maturity Levels",
      "browse": "Assess Maturity"
    },
    "stats": {
      "totalQuestions": "Total Questions",
      "priorityQuestions": "Priority PQs",
      "newIn2024": "New in 2024"
    },
    "info": {
      "title": "About the Questionnaires",
      "ansDescription": "The ANS questionnaire is based on ICAO's Universal Safety Oversight Audit Programme (USOAP) Continuous Monitoring Approach. It evaluates State compliance with international standards across 8 Critical Elements.",
      "smsDescription": "The SMS questionnaire follows CANSO's Standard of Excellence framework to assess Safety Management System maturity. Organizations are rated from Level A (Informal) to Level E (Excellence)."
    }
  },
  "auditAreas": {
    "LEG": {
      "code": "LEG",
      "name": "Legislation",
      "fullName": "Primary Aviation Legislation",
      "description": "Legislation that provides the foundation for safety oversight and the establishment of a civil aviation authority"
    },
    "ORG": {
      "code": "ORG",
      "name": "Organization",
      "fullName": "Civil Aviation Organization",
      "description": "Establishment of a civil aviation authority with adequate staffing, resources and organizational structure"
    },
    "PEL": {
      "code": "PEL",
      "name": "Personnel Licensing",
      "fullName": "Personnel Licensing and Training",
      "description": "Licensing and certification of aviation personnel including pilots, air traffic controllers, and aircraft maintenance engineers"
    },
    "OPS": {
      "code": "OPS",
      "name": "Operations",
      "fullName": "Aircraft Operations",
      "description": "Operational requirements for aircraft operators including flight operations, cabin safety, and dangerous goods transport"
    },
    "AIR": {
      "code": "AIR",
      "name": "Airworthiness",
      "fullName": "Airworthiness of Aircraft",
      "description": "Certification and continuing airworthiness of aircraft including type certification and maintenance organizations"
    },
    "AIG": {
      "code": "AIG",
      "name": "Accident Investigation",
      "fullName": "Accident and Incident Investigation",
      "description": "Investigation of aircraft accidents and incidents to determine causes and formulate safety recommendations"
    },
    "ANS": {
      "code": "ANS",
      "name": "Air Navigation Services",
      "fullName": "Air Navigation Services",
      "description": "Provision of air traffic services, communications, navigation, surveillance, aeronautical information, and meteorology"
    },
    "AGA": {
      "code": "AGA",
      "name": "Aerodromes",
      "fullName": "Aerodromes and Ground Aids",
      "description": "Certification and oversight of aerodromes including physical characteristics, visual aids, and rescue and firefighting services"
    },
    "SSP": {
      "code": "SSP",
      "name": "State Safety Programme",
      "fullName": "State Safety Programme",
      "description": "Implementation of a State Safety Programme including safety policy, risk management, assurance, and promotion"
    }
  },
  "criticalElements": {
    "CE_1": {
      "code": "CE-1",
      "name": "Primary Aviation Legislation",
      "shortName": "Legislation",
      "description": "The provision of a comprehensive and effective aviation law consistent with the environment and complexity of the State's aviation activity, and compliant with the requirements of the Convention on International Civil Aviation"
    },
    "CE_2": {
      "code": "CE-2",
      "name": "Specific Operating Regulations",
      "shortName": "Regulations",
      "description": "The provision of adequate regulations to address, at a minimum, national requirements emanating from the primary aviation legislation and providing standardized operational procedures, equipment, and infrastructure in conformity with Standards and Recommended Practices"
    },
    "CE_3": {
      "code": "CE-3",
      "name": "State System and Functions",
      "shortName": "State System",
      "description": "The establishment of a state aviation system and state safety oversight functions to provide, at a minimum, the appropriate organizational structure, qualified technical personnel, defined responsibilities, and documented policies and procedures"
    },
    "CE_4": {
      "code": "CE-4",
      "name": "Qualified Technical Personnel",
      "shortName": "Technical Personnel",
      "description": "The availability of adequate and qualified technical personnel for the performance of state safety oversight functions. Technical personnel requirements include staffing, training, competency, and proficiency"
    },
    "CE_5": {
      "code": "CE-5",
      "name": "Guidance, Tools and Provision of Safety-critical Information",
      "shortName": "Guidance & Tools",
      "description": "The provision of technical guidance, tools, and safety-critical information to the aviation industry, and within the state aviation system, to enable them to meet the established requirements"
    },
    "CE_6": {
      "code": "CE-6",
      "name": "Licensing, Certification, Authorization and/or Approval Obligations",
      "shortName": "Licensing & Certification",
      "description": "The implementation of processes and procedures to ensure that aviation personnel and organizations meet the established requirements before they are allowed to perform their functions"
    },
    "CE_7": {
      "code": "CE-7",
      "name": "Surveillance Obligations",
      "shortName": "Surveillance",
      "description": "The implementation of processes, such as inspections, audits, and monitoring activities, to ensure that aviation licence, certificate, authorization, and approval holders continue to meet the established requirements"
    },
    "CE_8": {
      "code": "CE-8",
      "name": "Resolution of Safety Issues",
      "shortName": "Safety Issues",
      "description": "The implementation of processes and procedures to resolve identified safety issues that have an impact on aviation safety, including enforcement measures"
    }
  },
  "smsComponents": {
    "SAFETY_POLICY_OBJECTIVES": {
      "code": "1",
      "name": "Safety Policy and Objectives",
      "shortName": "Safety Policy",
      "description": "Management commitment, safety responsibilities, appointment of key safety personnel, SMS documentation, and safety policy communication",
      "weight": 20
    },
    "SAFETY_RISK_MANAGEMENT": {
      "code": "2",
      "name": "Safety Risk Management",
      "shortName": "Risk Management",
      "description": "Hazard identification, safety risk assessment and mitigation processes",
      "weight": 40
    },
    "SAFETY_ASSURANCE": {
      "code": "3",
      "name": "Safety Assurance",
      "shortName": "Assurance",
      "description": "Safety performance monitoring and measurement, change management, and continuous improvement",
      "weight": 30
    },
    "SAFETY_PROMOTION": {
      "code": "4",
      "name": "Safety Promotion",
      "shortName": "Promotion",
      "description": "Training and education, and safety communication",
      "weight": 10
    }
  },
  "studyAreas": {
    "SA_1_1": {
      "code": "1.1",
      "name": "Safety Policy",
      "component": "SAFETY_POLICY_OBJECTIVES",
      "description": "Management commitment and responsibility for safety, including the safety policy statement"
    },
    "SA_1_2": {
      "code": "1.2",
      "name": "Safety Accountabilities",
      "component": "SAFETY_POLICY_OBJECTIVES",
      "description": "Identification of the accountable executive and safety responsibilities of managers"
    },
    "SA_1_3": {
      "code": "1.3",
      "name": "Key Safety Personnel",
      "component": "SAFETY_POLICY_OBJECTIVES",
      "description": "Appointment of key safety personnel including the safety manager"
    },
    "SA_1_4": {
      "code": "1.4",
      "name": "Emergency Response Planning",
      "component": "SAFETY_POLICY_OBJECTIVES",
      "description": "Coordination of emergency response planning with appropriate organizations"
    },
    "SA_1_5": {
      "code": "1.5",
      "name": "SMS Documentation",
      "component": "SAFETY_POLICY_OBJECTIVES",
      "description": "SMS implementation plan, documentation, and records management"
    },
    "SA_2_1": {
      "code": "2.1",
      "name": "Hazard Identification",
      "component": "SAFETY_RISK_MANAGEMENT",
      "description": "Processes for identifying hazards through reactive, proactive, and predictive methods"
    },
    "SA_2_2": {
      "code": "2.2",
      "name": "Risk Assessment and Mitigation",
      "component": "SAFETY_RISK_MANAGEMENT",
      "description": "Safety risk assessment and development of risk controls and mitigation strategies"
    },
    "SA_3_1": {
      "code": "3.1",
      "name": "Safety Performance Monitoring",
      "component": "SAFETY_ASSURANCE",
      "description": "Monitoring and measurement of safety performance including SPIs and SPTs"
    },
    "SA_3_2": {
      "code": "3.2",
      "name": "Management of Change",
      "component": "SAFETY_ASSURANCE",
      "description": "Processes to manage safety risks associated with organizational or operational changes"
    },
    "SA_3_3": {
      "code": "3.3",
      "name": "Continuous Improvement",
      "component": "SAFETY_ASSURANCE",
      "description": "Internal evaluations, audits, and continuous improvement of the SMS"
    },
    "SA_4_1": {
      "code": "4.1",
      "name": "Training and Education",
      "component": "SAFETY_PROMOTION",
      "description": "Safety training programs for personnel at all levels"
    },
    "SA_4_2": {
      "code": "4.2",
      "name": "Safety Communication",
      "component": "SAFETY_PROMOTION",
      "description": "Communication of safety-critical information and promotion of safety culture"
    }
  },
  "maturityLevels": {
    "LEVEL_A": {
      "code": "A",
      "name": "Informal",
      "shortName": "Level A",
      "description": "Ad-hoc safety management activities. No systematic approach. Safety may be addressed reactively.",
      "color": "#DC2626"
    },
    "LEVEL_B": {
      "code": "B",
      "name": "Defined",
      "shortName": "Level B",
      "description": "Safety processes are documented and implemented. Basic compliance with regulatory requirements.",
      "color": "#F97316"
    },
    "LEVEL_C": {
      "code": "C",
      "name": "Managed",
      "shortName": "Level C",
      "description": "Safety processes are systematically applied and monitored. Safety data is collected and analyzed.",
      "color": "#EAB308"
    },
    "LEVEL_D": {
      "code": "D",
      "name": "Assured",
      "shortName": "Level D",
      "description": "Safety performance is measured against targets. Proactive hazard identification and risk management.",
      "color": "#22C55E"
    },
    "LEVEL_E": {
      "code": "E",
      "name": "Excellence",
      "shortName": "Level E",
      "description": "Continuous improvement and predictive safety management. Industry leader in safety culture.",
      "color": "#3B82F6"
    }
  },
  "transversalAreas": {
    "SPM": {
      "code": "SPM",
      "name": "Safety Performance Management",
      "description": "Cross-cutting area addressing how safety performance is measured and managed across all components"
    },
    "HP": {
      "code": "HP",
      "name": "Human Performance",
      "description": "Cross-cutting area addressing human factors and their impact on safety across all components"
    },
    "CI": {
      "code": "CI",
      "name": "Continuous Improvement",
      "description": "Cross-cutting area addressing how continuous improvement is embedded across all components"
    }
  },
  "ansBrowser": {
    "title": "ANS Protocol Questions",
    "subtitle": "USOAP CMA 2024 - 851 Protocol Questions across 9 Audit Areas",
    "breadcrumb": {
      "questionnaires": "Questionnaires",
      "ans": "ANS USOAP CMA"
    },
    "filters": {
      "title": "Filters",
      "search": "Search",
      "searchPlaceholder": "Search by PQ number or text...",
      "auditArea": "Audit Area",
      "criticalElement": "Critical Element",
      "additional": "Additional Filters",
      "priorityPQ": "Priority PQ",
      "requiresOnSite": "Requires On-Site",
      "selectAll": "Select All",
      "clear": "Clear",
      "clearAll": "Clear All Filters"
    },
    "results": {
      "showing": "Showing {from}-{to} of {total} questions",
      "page": "Page {current} of {total}"
    },
    "pq": {
      "priority": "Priority",
      "onSite": "On-Site",
      "newIn2024": "New in 2024",
      "revisedIn2024": "Revised in 2024",
      "guidance": "Guidance for Review of Evidence",
      "icaoReferences": "ICAO References"
    },
    "empty": {
      "title": "No questions found",
      "description": "Try adjusting your filters or search query to find Protocol Questions."
    },
    "error": {
      "title": "Error loading questions",
      "description": "There was a problem loading the questions. Please try again."
    }
  },
  "smsBrowser": {
    "title": "SMS Maturity Assessment",
    "subtitle": "CANSO Standard of Excellence 2024 - Safety Management System Assessment",
    "breadcrumb": {
      "questionnaires": "Questionnaires",
      "sms": "SMS CANSO SoE"
    },
    "components": {
      "1": {
        "short": "Component 1"
      },
      "2": {
        "short": "Component 2"
      },
      "3": {
        "short": "Component 3"
      },
      "4": {
        "short": "Component 4"
      },
      "title": "SMS Components",
      "selected": "Selected Component",
      "weight": "weight"
    },
    "studyArea": {
      "title": "Study Areas",
      "objectives": "{count} objectives"
    },
    "maturity": {
      "legend": "Maturity Level Guide",
      "objectivesTitle": "Maturity Objectives"
    },
    "transversal": {
      "SPM": "Safety Performance Management",
      "HP": "Human Performance",
      "CI": "Continuous Improvement"
    }
  },
  "questionDetail": {
    "title": "Question Detail",
    "question": "Question",
    "notFound": "Question not found",
    "breadcrumb": {
      "questionnaires": "Questionnaires"
    },
    "priority": "Priority",
    "onSite": "On-Site",
    "guidance": "Guidance for Review of Evidence",
    "icaoReferences": "ICAO References",
    "noReferences": "No ICAO references available",
    "relatedQuestions": "Related Questions",
    "auditArea": "Audit Area",
    "criticalElement": "Critical Element",
    "smsComponent": "SMS Component",
    "studyArea": "Study Area",
    "category": "Category",
    "metadata": "Question Metadata",
    "weight": "weight",
    "previous": "Previous",
    "next": "Next",
    "openInNewTab": "Open in new tab",
    "backToList": "Back to Questions",
    "share": "Share",
    "copied": "Copied!",
    "amendment": {
      "NO_CHANGE": "No Change",
      "REVISED": "Revised",
      "NEW": "New in 2024",
      "MERGED": "Merged",
      "DELETED": "Deleted",
      "REFERENCE_REVISED": "Ref. Updated",
      "from": "from",
      "was": "was"
    }
  },
  "admin": {
    "title": "Administration",
    "description": "Manage system settings, users, and questionnaire data",
    "questionnaires": {
      "title": "Questionnaire Management",
      "description": "Manage questionnaires, import data, and configure assessment frameworks",
      "refresh": "Refresh",
      "import": "Import Data",
      "active": "Active",
      "inactive": "Inactive",
      "stats": {
        "total": "Total Questionnaires",
        "active": "Active",
        "ansCount": "ANS Questionnaires",
        "smsCount": "SMS Questionnaires"
      },
      "table": {
        "type": "Type",
        "code": "Code",
        "title": "Title",
        "version": "Version",
        "effectiveDate": "Effective Date",
        "questions": "Questions",
        "assessments": "Assessments",
        "status": "Status"
      },
      "actions": {
        "view": "View Questionnaire",
        "edit": "Edit Details",
        "deactivate": "Deactivate",
        "delete": "Delete Permanently"
      },
      "empty": {
        "title": "No questionnaires found",
        "description": "Import your first questionnaire to get started.",
        "action": "Import Questionnaire"
      },
      "deleteDialog": {
        "softTitle": "Deactivate Questionnaire?",
        "softDescription": "This will mark the questionnaire as inactive. Existing assessments will be preserved.",
        "hardTitle": "Delete Questionnaire?",
        "hardDescription": "This will permanently delete the questionnaire and all associated questions. This action cannot be undone.",
        "cancel": "Cancel",
        "confirm": "Confirm",
        "deleting": "Deleting..."
      },
      "deleteSoftSuccess": "Questionnaire deactivated successfully",
      "deleteHardSuccess": "Questionnaire deleted permanently"
    },
    "import": {
      "pageTitle": "Import Questionnaire Data",
      "pageDescription": "Upload and import questionnaire data from JSON or CSV files",
      "backToList": "Back to Questionnaires",
      "step": "Step {current} of {total}",
      "back": "Back",
      "next": "Next",
      "import": "Import",
      "done": "Done",
      "step1": {
        "name": "Select Type",
        "title": "Select Questionnaire Type",
        "description": "Choose the type of questionnaire you want to import",
        "ansTitle": "ANS USOAP CMA",
        "ansDescription": "ICAO Universal Safety Oversight Audit Programme - Protocol Questions for Air Navigation Services",
        "smsTitle": "SMS CANSO SoE",
        "smsDescription": "CANSO Standard of Excellence - Safety Management System maturity assessment"
      },
      "step2": {
        "name": "Upload File",
        "title": "Upload Import File",
        "description": "Upload a JSON or CSV file containing the questionnaire data",
        "formatLabel": "File Format",
        "dropHere": "Drop file here",
        "orClickToUpload": "or click to upload",
        "fileUploaded": "File uploaded successfully",
        "validating": "Validating file..."
      },
      "step3": {
        "name": "Preview",
        "title": "Preview Import Data",
        "description": "Review the data before importing",
        "noData": "No data to preview",
        "warnings": "Warnings"
      },
      "step4": {
        "name": "Confirm",
        "importing": "Importing Data...",
        "pleaseWait": "Please wait while we import your data",
        "success": "Import Successful!",
        "successDescription": "Imported {categories} categories, {questions} questions, and {references} ICAO references",
        "error": "Import Failed",
        "ready": "Ready to Import",
        "readyDescription": "Click the Import button to start the import process"
      },
      "searchPlaceholder": "Search by PQ number or text...",
      "showing": "Showing {from}-{to} of {total}",
      "page": "Page {current} of {total}",
      "status": "Status",
      "pqNumber": "PQ Number",
      "auditArea": "Audit Area",
      "ce": "CE",
      "component": "Component",
      "studyArea": "Study Area",
      "questionText": "Question Text",
      "refs": "Refs",
      "actions": "Actions",
      "errors": "errors",
      "noMatchingResults": "No matching results",
      "noData": "No data",
      "editQuestion": "Edit Question",
      "questionTextEn": "Question Text (English)",
      "questionTextFr": "Question Text (French)",
      "cancel": "Cancel",
      "save": "Save",
      "questions": "Questions",
      "categories": "Categories",
      "references": "References",
      "warnings": "Warnings",
      "validationSuccess": "File validated successfully",
      "validationErrors": "Validation found {count} errors",
      "validationFailed": "Validation failed",
      "importSuccess": "Import completed successfully",
      "importFailed": "Import failed"
    }
  },
  "errors": {
    "generic": "An error occurred",
    "notFound": "Not found",
    "unauthorized": "Unauthorized access",
    "forbidden": "Access forbidden",
    "serverError": "Server error",
    "networkError": "Network error",
    "timeout": "Request timed out",
    "validation": "Validation error",
    "loadFailed": "Failed to load data",
    "saveFailed": "Failed to save data",
    "deleteFailed": "Failed to delete",
    "importFailed": "Import failed",
    "exportFailed": "Export failed",
    "tryAgain": "Please try again",
    "contactSupport": "If the problem persists, please contact support"
  },
  "success": {
    "saved": "Saved successfully",
    "deleted": "Deleted successfully",
    "imported": "Imported successfully",
    "exported": "Exported successfully",
    "updated": "Updated successfully",
    "created": "Created successfully",
    "submitted": "Submitted successfully",
    "copied": "Copied to clipboard"
  },
  "empty": {
    "noData": "No data available",
    "noResults": "No results found",
    "noQuestions": "No questions found",
    "noAssessments": "No assessments found",
    "noReviews": "No reviews found",
    "noOrganizations": "No organizations found",
    "noUsers": "No users found",
    "noDocuments": "No documents found",
    "noNotifications": "No notifications",
    "startSearch": "Start by searching or applying filters",
    "createFirst": "Create your first item to get started"
  },
  "pagination": {
    "previous": "Previous",
    "next": "Next",
    "first": "First",
    "last": "Last",
    "page": "Page",
    "of": "of",
    "showing": "Showing",
    "to": "to",
    "entries": "entries",
    "perPage": "per page"
  },
  "wizard": {
    "pageTitle": "New Assessment",
    "pageDescription": "Create a new self-assessment to evaluate your organization",
    "common": {
      "recommended": "Recommended"
    },
    "steps": {
      "questionnaireType": "Questionnaire",
      "questionnaireTypeDesc": "Select type",
      "assessmentType": "Assessment",
      "assessmentTypeDesc": "Choose purpose",
      "details": "Details",
      "detailsDesc": "Configure scope",
      "review": "Review",
      "reviewDesc": "Confirm & create",
      "stepOf": "Step {current} of {total}"
    },
    "questionnaireType": {
      "title": "Select Questionnaire Type",
      "description": "Choose the framework for your assessment",
      "helpText": "Not sure which to choose? ANS USOAP CMA is recommended for most organizations.",
      "ans": {
        "title": "ANS USOAP CMA",
        "subtitle": "ICAO Universal Safety Oversight Audit Programme",
        "description": "Evaluate compliance with ICAO standards across 9 audit areas using the Continuous Monitoring Approach protocol questions.",
        "feature1": "Protocol Questions",
        "feature2": "Audit Areas",
        "feature3": "Critical Elements",
        "keyDifference": "Best for: Compliance assessment against international aviation safety standards"
      },
      "sms": {
        "title": "SMS CANSO SoE",
        "subtitle": "CANSO Standard of Excellence",
        "description": "Assess Safety Management System maturity across 4 components using the CANSO framework with maturity levels A-E.",
        "feature1": "Maturity Levels",
        "feature2": "SMS Components",
        "feature3": "Study Areas",
        "keyDifference": "Best for: SMS maturity assessment and continuous improvement"
      }
    },
    "assessmentType": {
      "title": "Select Assessment Type",
      "description": "What is the purpose of this assessment?",
      "bestFor": "Best for",
      "types": {
        "self_assessment": {
          "title": "Self-Assessment",
          "short": "Self-Assessment",
          "description": "Standard internal evaluation against the selected framework requirements.",
          "bestFor": "Initial baseline evaluation and ongoing compliance monitoring"
        },
        "gap_analysis": {
          "title": "Gap Analysis",
          "short": "Gap Analysis",
          "description": "Identify gaps between current state and target requirements or maturity levels.",
          "bestFor": "Pre-improvement planning and identifying priority areas"
        },
        "peer_review": {
          "title": "Peer Review Preparation",
          "short": "Pre-Review",
          "description": "Prepare for an upcoming peer review by completing a thorough self-evaluation.",
          "bestFor": "Organizations preparing for external peer review"
        },
        "follow_up": {
          "title": "Follow-up Assessment",
          "short": "Follow-up",
          "description": "Track progress on previously identified findings and corrective actions.",
          "bestFor": "Monitoring improvement progress after initial assessment"
        }
      }
    },
    "details": {
      "title": "Assessment Details",
      "description": "Configure your assessment scope and timeline",
      "titleLabel": "Assessment Title",
      "titlePlaceholder": "Enter a descriptive title",
      "titleHint": "A clear title helps you identify this assessment later",
      "regenerateTitle": "Regenerate title",
      "descriptionLabel": "Description (Optional)",
      "descriptionPlaceholder": "Add any notes or objectives for this assessment...",
      "dueDateLabel": "Target Completion Date (Optional)",
      "dueDateHint": "Set a target date to help track progress",
      "scope": {
        "ansTitle": "Audit Areas",
        "ansDescription": "Select which ICAO audit areas to include in this assessment",
        "smsTitle": "SMS Components",
        "smsDescription": "Select which SMS components to assess",
        "selectAll": "Select All",
        "deselectAll": "Deselect All",
        "noneSelected": "No areas selected - please select at least one",
        "allSelected": "All areas selected",
        "someSelected": "{count} of {total} areas selected"
      }
    },
    "review": {
      "title": "Review & Confirm",
      "description": "Review your selections before creating the assessment",
      "summaryTitle": "Assessment Summary",
      "assessmentTitle": "Title",
      "descriptionLabel": "Description",
      "auditAreas": "Audit Areas",
      "smsComponents": "SMS Components",
      "estimatedQuestions": "Est. Questions",
      "estimatedTime": "Est. Time",
      "hours": "hrs",
      "targetDate": "Target Date",
      "noDueDate": "No target set",
      "tipsTitle": "Tips for a Successful Assessment",
      "tips": {
        "gather": "Gather relevant documentation and evidence before starting",
        "collaborate": "Involve key stakeholders from different departments",
        "evidence": "Document evidence for each response to support your findings",
        "honest": "Be honest in your responses - this assessment is for your improvement"
      },
      "confirmLabel": "I understand and am ready to create this assessment",
      "confirmDescription": "By confirming, a new assessment will be created with the settings above. You can begin answering questions immediately or return later.",
      "confirmRequired": "Please confirm to continue",
      "createButton": "Create Assessment"
    },
    "creating": {
      "title": "Creating Your Assessment",
      "description": "Please wait while we set up your assessment...",
      "button": "Creating..."
    },
    "success": {
      "title": "Assessment Created Successfully!",
      "description": "Your assessment is ready. You can start answering questions now or return later.",
      "created": "Assessment created successfully",
      "assessmentId": "Assessment ID",
      "assessmentTitle": "Title",
      "startAssessment": "Start Assessment",
      "viewDashboard": "View Dashboard",
      "createAnother": "Create Another Assessment"
    },
    "errors": {
      "createFailed": "Failed to create assessment. Please try again."
    }
  },
  "workspace": {
    "loading": "Loading assessment...",
    "error": {
      "title": "Error Loading Assessment",
      "description": "We couldn't load the assessment. Please try again.",
      "backButton": "Back to Assessments"
    },
    "header": {
      "backToAssessments": "Back to Assessments",
      "progress": "{answered} of {total} answered ({percent}%)",
      "help": "Help & Shortcuts",
      "settings": "Settings"
    },
    "sidebar": {
      "title": "Questions",
      "progress": "{answered} of {total} answered",
      "overallProgress": "Overall Progress",
      "searchPlaceholder": "Search questions...",
      "noQuestions": "No questions match your filters"
    },
    "filters": {
      "all": "All Questions",
      "unanswered": "Unanswered",
      "flagged": "Flagged for Review",
      "priority": "Priority Questions"
    },
    "shortcuts": {
      "prev": "Previous",
      "next": "Next",
      "flag": "Flag"
    },
    "panel": {
      "noQuestion": "No Question Selected",
      "selectQuestion": "Select a question from the sidebar to begin",
      "questionOf": "Question {current} of {total}",
      "saving": "Saving...",
      "saved": "Saved",
      "saveError": "Save failed",
      "save": "Save",
      "flag": "Flag for review",
      "unflag": "Remove flag",
      "guidance": "Guidance",
      "yourResponse": "Your Response",
      "ansInstructions": "Select the appropriate response based on your review of the evidence.",
      "smsInstructions": "Select the maturity level that best describes your organization's current state.",
      "notes": "Notes & Comments",
      "previous": "Previous",
      "next": "Next",
      "keyboardHint": "Use arrow keys to navigate",
      "priority": "Priority PQ"
    },
    "ansResponse": {
      "title": "Response",
      "protocol": "Protocol Question",
      "satisfactory": "Satisfactory",
      "satisfactoryDescription": "Meets requirements",
      "satisfactoryMessage": "Evidence confirms compliance with the protocol question requirements.",
      "notSatisfactory": "Not Satisfactory",
      "notSatisfactoryDescription": "Does not meet requirements",
      "notSatisfactoryMessage": "Evidence indicates non-compliance. Consider documenting findings.",
      "notApplicable": "Not Applicable",
      "notApplicableDescription": "Does not apply",
      "notApplicableMessage": "This question is not applicable to your organization.",
      "notReviewed": "Not Reviewed",
      "notReviewedDescription": "Not yet assessed"
    },
    "smsResponse": {
      "title": "Maturity Level",
      "cansoSoE": "CANSO SoE",
      "maturityScale": "Maturity:",
      "score": "Score: {score}",
      "selectedLevel": "Selected Level",
      "level": "Level",
      "levelA": "Informal",
      "levelADescription": "Ad-hoc safety management. No systematic approach.",
      "levelB": "Defined",
      "levelBDescription": "Safety processes are documented and implemented.",
      "levelC": "Managed",
      "levelCDescription": "Safety processes are systematically applied and monitored.",
      "levelD": "Assured",
      "levelDDescription": "Safety performance is measured against targets.",
      "levelE": "Excellence",
      "levelEDescription": "Continuous improvement and predictive safety management."
    },
    "comments": {
      "assessorNotes": "Assessor Notes",
      "assessorNotesDescription": "Notes visible to peer reviewers",
      "assessorNotesTooltip": "These notes will be shared with peer reviewers during the review process. Include any context that would help them understand your response.",
      "assessorNotesPlaceholder": "Add notes for reviewers about this response...",
      "internalNotes": "Internal Notes",
      "internalNotesDescription": "Private notes for your team",
      "internalNotesTooltip": "These notes are only visible to your organization's team and will not be shared with peer reviewers.",
      "internalNotesPlaceholder": "Add private notes for your team...",
      "hasContent": "Has content",
      "characters": "characters",
      "visibleToReviewers": "Visible to reviewers",
      "privateNote": "Private to your team",
      "tips": {
        "title": "Tips for Good Notes",
        "tip1": "Reference specific documents or procedures",
        "tip2": "Note any assumptions made in your response",
        "tip3": "Flag areas needing further investigation"
      }
    },
    "evidence": {
      "title": "Supporting Evidence",
      "description": "Provide evidence to support your response. Include document references, links, or descriptions.",
      "hasEvidence": "Evidence provided",
      "noEvidence": "No evidence yet",
      "descriptionLabel": "Evidence Description",
      "descriptionPlaceholder": "Describe the evidence supporting your response...",
      "descriptionHint": "Reference specific documents, procedures, or records",
      "linksLabel": "Document Links",
      "urlPlaceholder": "https://example.com/document",
      "errors": {
        "emptyUrl": "Please enter a URL",
        "invalidUrl": "Please enter a valid URL",
        "duplicateUrl": "This URL has already been added"
      },
      "removeDialog": {
        "title": "Remove Link?",
        "description": "Are you sure you want to remove this evidence link?",
        "cancel": "Cancel",
        "confirm": "Remove"
      },
      "dropzone": {
        "title": "Drop files here",
        "subtitle": "or click to browse your files",
        "button": "Upload Files"
      },
      "supportedFormats": "Supported: PDF, Word, Excel, images (max 10MB each)"
    }
  },
  "scoring": {
    "eiScore": "Effective Implementation Score",
    "smsMaturity": "SMS Maturity Level",
    "overallEI": "Overall EI",
    "overallScore": "Overall Score",
    "calculating": "Calculating scores...",
    "complete": "Complete",
    "incomplete": "Incomplete",
    "byAuditArea": "Score by Audit Area",
    "byCriticalElement": "Score by Critical Element",
    "byComponent": "Score by SMS Component",
    "byStudyArea": "Score by Study Area",
    "componentOverview": "Component Overview",
    "responseBreakdown": "Response Breakdown",
    "satisfactory": "Satisfactory",
    "notSatisfactory": "Not Satisfactory",
    "notApplicable": "Not Applicable",
    "notReviewed": "Not Reviewed",
    "incompleteAssessment": "Assessment incomplete - minimum {threshold}% required",
    "noResponses": "No responses recorded",
    "noData": "No data available",
    "level": "Level",
    "levels": "levels",
    "score": "Score",
    "weight": "Weight",
    "questionsAnswered": "questions answered",
    "questions": "questions",
    "scoreComparison": "Score Comparison",
    "maturityDistribution": "Maturity Level Distribution",
    "trend": {
      "improving": "Improving",
      "declining": "Declining",
      "stable": "Stable",
      "insufficientData": "Insufficient data for trend analysis"
    },
    "thresholds": {
      "excellent": "Excellent",
      "good": "Good",
      "satisfactory": "Satisfactory",
      "needsImprovement": "Needs Improvement",
      "poor": "Poor",
      "critical": "Critical"
    },
    "maturityLevels": {
      "A": {
        "name": "Initial/Ad-hoc",
        "description": "No formal processes. Safety may be addressed reactively."
      },
      "B": {
        "name": "Defined/Documented",
        "description": "Processes documented but not consistently applied."
      },
      "C": {
        "name": "Implemented/Measured",
        "description": "Processes implemented and measured."
      },
      "D": {
        "name": "Managed/Controlled",
        "description": "Processes managed with continuous monitoring."
      },
      "E": {
        "name": "Optimizing/Leading",
        "description": "Industry-leading practices, continuous improvement."
      }
    },
    "validation": {
      "valid": "Assessment ready for scoring",
      "canCalculate": "Scores can be calculated",
      "minCompletion": "Minimum {threshold}% completion required for official scoring",
      "statusWarning": "Assessment status is {status}. Consider submitting for official scoring."
    },
    "actions": {
      "calculate": "Calculate Scores",
      "recalculate": "Recalculate",
      "viewBreakdown": "View Breakdown",
      "exportReport": "Export Report",
      "compare": "Compare Assessments"
    }
  },
  "evidence": {
    "upload": {
      "title": "Upload Evidence",
      "dragDrop": "Drag and drop files here, or click to browse",
      "addUrl": "Add URL Reference",
      "urlPlaceholder": "Enter a URL to an external document",
      "uploading": "Uploading...",
      "uploadComplete": "Upload complete",
      "uploadFailed": "Upload failed",
      "maxSize": "Maximum file size: {size}MB",
      "allowedTypes": "Allowed: PDF, Images, Word, Excel",
      "maxFiles": "Maximum {count} files per question",
      "removeConfirm": "Remove this evidence?",
      "category": "Category",
      "description": "Description (optional)",
      "description_placeholder": "Add a description for this document"
    },
    "categories": {
      "POLICY": "Policy Document",
      "PROCEDURE": "Procedure",
      "RECORD": "Record/Log",
      "CERTIFICATE": "Certificate/License",
      "REPORT": "Report",
      "TRAINING": "Training Material",
      "EVIDENCE": "Evidence",
      "OTHER": "Other"
    },
    "library": {
      "title": "Document Library",
      "description": "Select documents from your organization's library",
      "searchPlaceholder": "Search documents...",
      "allCategories": "All Categories",
      "noResults": "No documents found",
      "empty": "No documents in library",
      "addSelected": "Add Selected"
    },
    "preview": {
      "download": "Download",
      "openInNewTab": "Open in new tab",
      "close": "Close",
      "noPreview": "Preview not available",
      "uploadedBy": "Uploaded by"
    }
  }
}
```

# messages/fr.json

```json
{
  "common": {
    "appName": "Revue par les Pairs ANSP Africains",
    "appTagline": "Excellence Collaborative en Sécurité Aéronautique",
    "actions": {
      "save": "Enregistrer",
      "cancel": "Annuler",
      "submit": "Soumettre",
      "delete": "Supprimer",
      "edit": "Modifier",
      "view": "Voir",
      "close": "Fermer",
      "confirm": "Confirmer",
      "back": "Retour",
      "next": "Suivant",
      "profile": "Profil",
      "settings": "Paramètres",
      "logout": "Déconnexion",
      "search": "Rechercher",
      "filter": "Filtrer",
      "export": "Exporter",
      "import": "Importer",
      "refresh": "Actualiser",
      "loading": "Chargement...",
      "retry": "Réessayer"
    },
    "submitting": "Soumission en cours...",
    "status": {
      "active": "Actif",
      "inactive": "Inactif",
      "pending": "En attente",
      "completed": "Terminé",
      "draft": "Brouillon",
      "submitted": "Soumis",
      "inProgress": "En cours",
      "archived": "Archivé"
    },
    "validation": {
      "required": "Ce champ est obligatoire",
      "invalidEmail": "Veuillez entrer une adresse e-mail valide",
      "minLength": "Minimum {min} caractères requis",
      "maxLength": "Maximum {max} caractères autorisés"
    }
  },
  "navigation": {
    "dashboard": "Tableau de bord",
    "questionnaires": "Questionnaires",
    "assessments": "Évaluations",
    "reviews": "Revues par les Pairs",
    "organizations": "Organisations",
    "reviewers": "Évaluateurs",
    "training": "Formation",
    "settings": "Paramètres",
    "admin": "Administration"
  },
  "auth": {
    "login": {
      "title": "Bon retour",
      "subtitle": "Connectez-vous à votre compte pour continuer",
      "signIn": "Se connecter",
      "signingIn": "Connexion...",
      "forgotPassword": "Mot de passe oublié?",
      "noAccount": "Vous n'avez pas de compte?",
      "signUp": "S'inscrire"
    },
    "register": {
      "title": "Créer un compte",
      "subtitle": "Rejoignez le Programme de Revue par les Pairs ANSP Africains",
      "createAccount": "Créer un compte",
      "creating": "Création du compte...",
      "haveAccount": "Vous avez déjà un compte?",
      "signIn": "Se connecter",
      "success": "Compte créé avec succès!",
      "redirecting": "Redirection vers la connexion...",
      "passwordRequirements": "Min 12 caractères avec majuscule, minuscule, chiffre et caractère spécial"
    },
    "fields": {
      "email": "E-mail",
      "password": "Mot de passe",
      "confirmPassword": "Confirmer le mot de passe",
      "firstName": "Prénom",
      "lastName": "Nom",
      "language": "Langue préférée"
    },
    "errors": {
      "invalidCredentials": "E-mail ou mot de passe invalide",
      "generic": "Une erreur s'est produite. Veuillez réessayer.",
      "sessionExpired": "Votre session a expiré. Veuillez vous reconnecter.",
      "unauthorized": "Vous n'êtes pas autorisé à accéder à cette ressource.",
      "networkError": "Erreur réseau. Veuillez vérifier votre connexion."
    }
  },
  "dashboard": {
    "title": "Tableau de bord",
    "welcome": "Bon retour, {name}!",
    "subtitle": "Voici un aperçu de vos activités de revue par les pairs.",
    "newAssessment": "Nouvelle évaluation",
    "stats": {
      "totalAssessments": "Total des évaluations",
      "inProgress": "en cours",
      "completed": "Terminées",
      "documents": "Documents",
      "thisWeek": "cette semaine",
      "overdue": "En retard"
    },
    "assessments": {
      "title": "État des évaluations",
      "overdue": "évaluations en retard",
      "active": "actives",
      "viewAll": "Voir tout"
    },
    "activity": {
      "title": "Activité récente",
      "empty": "Aucune activité récente",
      "viewAll": "Voir tout"
    },
    "attention": {
      "title": "Nécessite une attention",
      "allOnTrack": "Toutes les évaluations sont en bonne voie!",
      "overdue": "En retard",
      "stalled": "Bloqué",
      "viewAll": "Voir tout"
    },
    "quickActions": {
      "title": "Actions rapides",
      "description": "Commencez avec les tâches courantes",
      "newAssessment": "Commencer une auto-évaluation",
      "newAssessmentDesc": "Démarrer une nouvelle évaluation ANS ou SMS",
      "questionnaires": "Parcourir les questionnaires",
      "questionnairesDesc": "Explorer les cadres USOAP CMA et CANSO SoE",
      "training": "Modules de formation",
      "trainingDesc": "Accéder aux matériels de formation des évaluateurs"
    }
  },
  "progress": {
    "loading": "Chargement de la progression...",
    "refresh": "Actualiser",
    "continue": "Continuer l'évaluation",
    "error": {
      "title": "Erreur",
      "notFound": "Évaluation non trouvée",
      "back": "Retour aux évaluations"
    },
    "summary": {
      "progress": "Progression globale",
      "questions": "questions",
      "status": "Statut",
      "activity": "Événements",
      "dueDate": "Date limite",
      "noDueDate": "Pas de date limite"
    },
    "tabs": {
      "progress": "Progression",
      "timeline": "Chronologie"
    },
    "categories": {
      "title": "Progression par catégorie",
      "description": "Suivez votre progression dans toutes les catégories du questionnaire",
      "overallProgress": "Progression globale"
    },
    "timeline": {
      "title": "Chronologie des activités",
      "description": "Suivez toutes les activités de cette évaluation",
      "empty": "Aucune activité enregistrée",
      "loadMore": "Charger plus"
    }
  },
  "assessment": {
    "title": "Auto-évaluation",
    "subtitle": "Évaluez votre organisation selon les normes OACI et CANSO",
    "list": {
      "title": "Évaluations",
      "description": "Gérez vos auto-évaluations et suivez votre progression",
      "newAssessment": "Nouvelle évaluation",
      "loading": "Chargement des évaluations...",
      "updated": "Mis à jour",
      "due": "Échéance",
      "progress": "Progression",
      "view": "Voir",
      "continue": "Continuer",
      "empty": {
        "title": "Aucune évaluation",
        "description": "Commencez votre première auto-évaluation pour évaluer la conformité aux normes de l'OACI ou la maturité SMS.",
        "create": "Créer une évaluation"
      }
    },
    "stats": {
      "total": "Total des évaluations",
      "inProgress": "En cours",
      "completed": "Terminées",
      "submitted": "Soumises"
    },
    "status": {
      "draft": "Brouillon",
      "inProgress": "En cours",
      "submitted": "Soumis",
      "underReview": "En révision",
      "completed": "Terminé",
      "archived": "Archivé",
      "DRAFT": "Brouillon",
      "IN_PROGRESS": "En cours",
      "SUBMITTED": "Soumis",
      "UNDER_REVIEW": "En révision",
      "COMPLETED": "Terminé",
      "ARCHIVED": "Archivé"
    },
    "statusDescription": {
      "DRAFT": "L'évaluation a été créée mais pas encore commencée",
      "IN_PROGRESS": "L'évaluation est en cours de réalisation",
      "SUBMITTED": "L'évaluation a été soumise pour révision",
      "UNDER_REVIEW": "L'évaluation est en cours de révision",
      "COMPLETED": "L'évaluation a été finalisée",
      "ARCHIVED": "L'évaluation a été archivée"
    },
    "types": {
      "SELF_ASSESSMENT": "Auto-évaluation",
      "GAP_ANALYSIS": "Analyse des écarts",
      "PRE_REVIEW": "Évaluation pré-revue",
      "MOCK_REVIEW": "Revue simulée"
    },
    "typeDescription": {
      "SELF_ASSESSMENT": "Auto-évaluation initiale par rapport aux normes",
      "GAP_ANALYSIS": "Identifier les écarts entre l'état actuel et les exigences",
      "PRE_REVIEW": "Évaluation préparatoire avant la revue formelle par les pairs",
      "MOCK_REVIEW": "Évaluation pratique simulant une revue par les pairs"
    },
    "responses": {
      "SATISFACTORY": "Satisfaisant",
      "NOT_SATISFACTORY": "Non satisfaisant",
      "NOT_APPLICABLE": "Non applicable",
      "NOT_REVIEWED": "Non examiné"
    },
    "responseDescription": {
      "SATISFACTORY": "Les preuves confirment la conformité aux exigences de la question de protocole",
      "NOT_SATISFACTORY": "Les preuves indiquent une non-conformité ou une mise en œuvre insuffisante",
      "NOT_APPLICABLE": "La question de protocole n'est pas applicable à cette organisation",
      "NOT_REVIEWED": "La question n'a pas encore été examinée"
    },
    "maturity": {
      "A": "Niveau A - Informel",
      "B": "Niveau B - Défini",
      "C": "Niveau C - Géré",
      "D": "Niveau D - Assuré",
      "E": "Niveau E - Excellence"
    },
    "maturityDescription": {
      "A": "Gestion de la sécurité ad hoc. Pas d'approche systématique.",
      "B": "Les processus de sécurité sont documentés et mis en œuvre.",
      "C": "Les processus de sécurité sont systématiquement appliqués et surveillés.",
      "D": "Les performances de sécurité sont mesurées par rapport aux objectifs.",
      "E": "Amélioration continue et gestion prédictive de la sécurité."
    },
    "evidence": {
      "types": {
        "DOCUMENT": "Document",
        "PROCEDURE": "Procédure",
        "RECORD": "Enregistrement",
        "INTERVIEW": "Entretien",
        "OBSERVATION": "Observation",
        "OTHER": "Autre"
      },
      "typeDescription": {
        "DOCUMENT": "Documentation écrite telle que manuels, plans ou politiques",
        "PROCEDURE": "Procédures documentées, instructions de travail ou directives",
        "RECORD": "Enregistrements d'activités, journaux ou pistes d'audit",
        "INTERVIEW": "Informations recueillies lors d'entretiens ou de discussions",
        "OBSERVATION": "Observation directe des activités ou des conditions",
        "OTHER": "Autres types de preuves ne correspondant pas aux catégories ci-dessus"
      },
      "upload": "Télécharger une preuve",
      "attach": "Joindre une preuve",
      "remove": "Supprimer la preuve",
      "verified": "Vérifié",
      "unverified": "Non vérifié",
      "validFrom": "Valide à partir du",
      "validUntil": "Valide jusqu'au",
      "expired": "Expiré"
    },
    "scoring": {
      "eiScore": "Score EI",
      "eiScoreDescription": "Score de mise en œuvre effective calculé en pourcentage de questions satisfaisantes",
      "smsMaturity": "Maturité SGS",
      "smsMaturityDescription": "Niveau de maturité SGS global basé sur la Norme d'Excellence CANSO",
      "overallScore": "Score global",
      "categoryScore": "Score par catégorie",
      "componentScore": "Score par composante",
      "weightedAverage": "Moyenne pondérée",
      "lowestLevel": "Niveau le plus bas",
      "targetNotMet": "Objectif non atteint",
      "targetMet": "Objectif atteint",
      "exceededTarget": "Objectif dépassé"
    },
    "progress": {
      "notStarted": "Non commencé",
      "justStarted": "Tout juste commencé",
      "inProgress": "En cours",
      "halfwayComplete": "À moitié terminé",
      "almostComplete": "Presque terminé",
      "complete": "Terminé",
      "percentComplete": "{percent}% terminé",
      "questionsAnswered": "{answered} sur {total} questions répondues",
      "estimatedTime": "Temps restant estimé : {time}",
      "lastActivity": "Dernière activité : {date}"
    },
    "actions": {
      "start": "Commencer l'évaluation",
      "continue": "Continuer l'évaluation",
      "submit": "Soumettre l'évaluation",
      "review": "Réviser l'évaluation",
      "complete": "Terminer l'évaluation",
      "archive": "Archiver l'évaluation",
      "export": "Exporter l'évaluation",
      "compare": "Comparer les évaluations"
    },
    "submitSuccess": "Évaluation soumise avec succès",
    "submitError": "Échec de la soumission de l'évaluation",
    "confirmSubmit": {
      "title": "Soumettre l'évaluation",
      "description": "Êtes-vous sûr de vouloir soumettre cette évaluation ? Une fois soumise, vous ne pourrez plus la modifier jusqu'à sa réouverture."
    },
    "validation": {
      "incompleteQuestions": "{count} questions doivent encore être répondues",
      "missingEvidence": "Seulement {percent}% des questions ont des preuves à l'appui",
      "incompleteCategories": "{count} catégories ont des questions sans réponse",
      "canSubmit": "L'évaluation est prête à être soumise",
      "cannotSubmit": "L'évaluation ne peut pas encore être soumise"
    }
  },
  "questionnaire": {
    "title": "Questionnaires",
    "subtitle": "Parcourir les Questions de Protocole USOAP CMA et les évaluations CANSO SoE",
    "selectType": "Sélectionner le type de questionnaire",
    "ans": {
      "title": "Questionnaire ANS",
      "fullTitle": "Questions de Protocole USOAP CMA 2024",
      "description": "851 Questions de Protocole dans 9 domaines d'audit alignées sur les normes OACI pour la surveillance des Services de Navigation Aérienne",
      "effectiveDate": "En vigueur : 1er juillet 2025",
      "auditAreas": "Domaines d'Audit",
      "criticalElements": "Éléments Critiques",
      "browse": "Parcourir les Questions"
    },
    "sms": {
      "title": "Questionnaire SGS",
      "fullTitle": "Norme d'Excellence CANSO 2024",
      "description": "Évaluation de la maturité du Système de Gestion de la Sécurité à travers 4 composantes et 12 domaines d'étude",
      "components": "Composantes SGS",
      "studyAreas": "Domaines d'Étude",
      "maturityLevels": "Niveaux de Maturité",
      "browse": "Évaluer la Maturité"
    },
    "stats": {
      "totalQuestions": "Total Questions",
      "priorityQuestions": "QP Prioritaires",
      "newIn2024": "Nouveau en 2024"
    },
    "info": {
      "title": "À propos des Questionnaires",
      "ansDescription": "Le questionnaire ANS est basé sur le Programme Universel d'Audit de Surveillance de la Sécurité (USOAP) de l'OACI - Approche de Surveillance Continue. Il évalue la conformité des États aux normes internationales à travers 8 Éléments Critiques.",
      "smsDescription": "Le questionnaire SGS suit le cadre de la Norme d'Excellence CANSO pour évaluer la maturité du Système de Gestion de la Sécurité. Les organisations sont notées du Niveau A (Informel) au Niveau E (Excellence)."
    }
  },
  "auditAreas": {
    "LEG": {
      "code": "LEG",
      "name": "Législation",
      "fullName": "Législation aéronautique de base",
      "description": "Législation qui fournit le fondement de la supervision de la sécurité et la création d'une autorité de l'aviation civile"
    },
    "ORG": {
      "code": "ORG",
      "name": "Organisation",
      "fullName": "Organisation de l'aviation civile",
      "description": "Création d'une autorité de l'aviation civile avec un personnel adéquat, des ressources et une structure organisationnelle"
    },
    "PEL": {
      "code": "PEL",
      "name": "Licences du personnel",
      "fullName": "Licences et formation du personnel",
      "description": "Délivrance des licences et certification du personnel aéronautique incluant pilotes, contrôleurs de la circulation aérienne et techniciens de maintenance"
    },
    "OPS": {
      "code": "OPS",
      "name": "Exploitation",
      "fullName": "Exploitation technique des aéronefs",
      "description": "Exigences opérationnelles pour les exploitants d'aéronefs incluant les opérations de vol, la sécurité en cabine et le transport de marchandises dangereuses"
    },
    "AIR": {
      "code": "AIR",
      "name": "Navigabilité",
      "fullName": "Navigabilité des aéronefs",
      "description": "Certification et maintien de la navigabilité des aéronefs incluant la certification de type et les organismes de maintenance"
    },
    "AIG": {
      "code": "AIG",
      "name": "Enquêtes sur les accidents",
      "fullName": "Enquêtes sur les accidents et incidents d'aviation",
      "description": "Enquêtes sur les accidents et incidents d'aviation pour déterminer les causes et formuler des recommandations de sécurité"
    },
    "ANS": {
      "code": "ANS",
      "name": "Services de navigation aérienne",
      "fullName": "Services de navigation aérienne",
      "description": "Fourniture des services de circulation aérienne, communications, navigation, surveillance, information aéronautique et météorologie"
    },
    "AGA": {
      "code": "AGA",
      "name": "Aérodromes",
      "fullName": "Aérodromes et aides au sol",
      "description": "Certification et supervision des aérodromes incluant les caractéristiques physiques, les aides visuelles et les services de sauvetage et de lutte contre l'incendie"
    },
    "SSP": {
      "code": "SSP",
      "name": "Programme de sécurité de l'État",
      "fullName": "Programme de sécurité de l'État",
      "description": "Mise en œuvre d'un Programme de sécurité de l'État incluant la politique de sécurité, la gestion des risques, l'assurance et la promotion"
    }
  },
  "criticalElements": {
    "CE_1": {
      "code": "EC-1",
      "name": "Législation aéronautique de base",
      "shortName": "Législation",
      "description": "Mise en place d'une législation aéronautique complète et efficace, adaptée à l'environnement et à la complexité de l'activité aéronautique de l'État, et conforme aux dispositions de la Convention relative à l'aviation civile internationale"
    },
    "CE_2": {
      "code": "EC-2",
      "name": "Règlements d'exploitation spécifiques",
      "shortName": "Règlements",
      "description": "Mise en place de règlements adéquats pour répondre, au minimum, aux exigences nationales découlant de la législation aéronautique de base et fournissant des procédures d'exploitation normalisées, des équipements et des infrastructures conformes aux normes et pratiques recommandées"
    },
    "CE_3": {
      "code": "EC-3",
      "name": "Système et fonctions de l'État",
      "shortName": "Système de l'État",
      "description": "Établissement d'un système aéronautique de l'État et de fonctions de supervision de la sécurité pour fournir, au minimum, la structure organisationnelle appropriée, du personnel technique qualifié, des responsabilités définies et des politiques et procédures documentées"
    },
    "CE_4": {
      "code": "EC-4",
      "name": "Personnel technique qualifié",
      "shortName": "Personnel technique",
      "description": "Disponibilité d'un personnel technique adéquat et qualifié pour l'exercice des fonctions de supervision de la sécurité de l'État. Les exigences relatives au personnel technique comprennent les effectifs, la formation, la compétence et la qualification"
    },
    "CE_5": {
      "code": "EC-5",
      "name": "Éléments indicatifs, outils et fourniture d'informations critiques pour la sécurité",
      "shortName": "Éléments indicatifs et outils",
      "description": "Fourniture d'éléments indicatifs techniques, d'outils et d'informations critiques pour la sécurité à l'industrie aéronautique et au sein du système aéronautique de l'État, pour leur permettre de satisfaire aux exigences établies"
    },
    "CE_6": {
      "code": "EC-6",
      "name": "Obligations en matière de délivrance de licences, de certification, d'autorisation et/ou d'approbation",
      "shortName": "Délivrance de licences et certification",
      "description": "Mise en œuvre de processus et procédures pour s'assurer que le personnel et les organismes aéronautiques satisfont aux exigences établies avant d'être autorisés à exercer leurs fonctions"
    },
    "CE_7": {
      "code": "EC-7",
      "name": "Obligations en matière de surveillance",
      "shortName": "Surveillance",
      "description": "Mise en œuvre de processus, tels que les inspections, audits et activités de surveillance, pour s'assurer que les titulaires de licences, certificats, autorisations et approbations continuent de satisfaire aux exigences établies"
    },
    "CE_8": {
      "code": "EC-8",
      "name": "Résolution des problèmes de sécurité",
      "shortName": "Problèmes de sécurité",
      "description": "Mise en œuvre de processus et procédures pour résoudre les problèmes de sécurité identifiés qui ont un impact sur la sécurité de l'aviation, y compris les mesures d'application"
    }
  },
  "smsComponents": {
    "SAFETY_POLICY_OBJECTIVES": {
      "code": "1",
      "name": "Politique et objectifs de sécurité",
      "shortName": "Politique de sécurité",
      "description": "Engagement de la direction, responsabilités en matière de sécurité, nomination du personnel clé de sécurité, documentation du SGS et communication de la politique de sécurité",
      "weight": 20
    },
    "SAFETY_RISK_MANAGEMENT": {
      "code": "2",
      "name": "Gestion des risques de sécurité",
      "shortName": "Gestion des risques",
      "description": "Identification des dangers, évaluation des risques de sécurité et processus d'atténuation",
      "weight": 40
    },
    "SAFETY_ASSURANCE": {
      "code": "3",
      "name": "Assurance de la sécurité",
      "shortName": "Assurance",
      "description": "Surveillance et mesure des performances de sécurité, gestion du changement et amélioration continue",
      "weight": 30
    },
    "SAFETY_PROMOTION": {
      "code": "4",
      "name": "Promotion de la sécurité",
      "shortName": "Promotion",
      "description": "Formation et éducation, et communication en matière de sécurité",
      "weight": 10
    }
  },
  "studyAreas": {
    "SA_1_1": {
      "code": "1.1",
      "name": "Politique de sécurité",
      "component": "SAFETY_POLICY_OBJECTIVES",
      "description": "Engagement et responsabilité de la direction en matière de sécurité, y compris la déclaration de politique de sécurité"
    },
    "SA_1_2": {
      "code": "1.2",
      "name": "Responsabilités de sécurité",
      "component": "SAFETY_POLICY_OBJECTIVES",
      "description": "Identification du dirigeant responsable et des responsabilités de sécurité des gestionnaires"
    },
    "SA_1_3": {
      "code": "1.3",
      "name": "Personnel clé de sécurité",
      "component": "SAFETY_POLICY_OBJECTIVES",
      "description": "Nomination du personnel clé de sécurité, y compris le responsable de la sécurité"
    },
    "SA_1_4": {
      "code": "1.4",
      "name": "Planification des interventions d'urgence",
      "component": "SAFETY_POLICY_OBJECTIVES",
      "description": "Coordination de la planification des interventions d'urgence avec les organismes appropriés"
    },
    "SA_1_5": {
      "code": "1.5",
      "name": "Documentation du SGS",
      "component": "SAFETY_POLICY_OBJECTIVES",
      "description": "Plan de mise en œuvre du SGS, documentation et gestion des dossiers"
    },
    "SA_2_1": {
      "code": "2.1",
      "name": "Identification des dangers",
      "component": "SAFETY_RISK_MANAGEMENT",
      "description": "Processus d'identification des dangers par des méthodes réactives, proactives et prédictives"
    },
    "SA_2_2": {
      "code": "2.2",
      "name": "Évaluation et atténuation des risques",
      "component": "SAFETY_RISK_MANAGEMENT",
      "description": "Évaluation des risques de sécurité et développement de contrôles et stratégies d'atténuation"
    },
    "SA_3_1": {
      "code": "3.1",
      "name": "Surveillance des performances de sécurité",
      "component": "SAFETY_ASSURANCE",
      "description": "Surveillance et mesure des performances de sécurité, y compris les IPS et les OPS"
    },
    "SA_3_2": {
      "code": "3.2",
      "name": "Gestion du changement",
      "component": "SAFETY_ASSURANCE",
      "description": "Processus de gestion des risques de sécurité associés aux changements organisationnels ou opérationnels"
    },
    "SA_3_3": {
      "code": "3.3",
      "name": "Amélioration continue",
      "component": "SAFETY_ASSURANCE",
      "description": "Évaluations internes, audits et amélioration continue du SGS"
    },
    "SA_4_1": {
      "code": "4.1",
      "name": "Formation et éducation",
      "component": "SAFETY_PROMOTION",
      "description": "Programmes de formation à la sécurité pour le personnel à tous les niveaux"
    },
    "SA_4_2": {
      "code": "4.2",
      "name": "Communication de sécurité",
      "component": "SAFETY_PROMOTION",
      "description": "Communication d'informations critiques pour la sécurité et promotion de la culture de sécurité"
    }
  },
  "maturityLevels": {
    "LEVEL_A": {
      "code": "A",
      "name": "Informel",
      "shortName": "Niveau A",
      "description": "Activités de gestion de la sécurité ad hoc. Pas d'approche systématique. La sécurité peut être traitée de manière réactive.",
      "color": "#DC2626"
    },
    "LEVEL_B": {
      "code": "B",
      "name": "Défini",
      "shortName": "Niveau B",
      "description": "Les processus de sécurité sont documentés et mis en œuvre. Conformité de base aux exigences réglementaires.",
      "color": "#F97316"
    },
    "LEVEL_C": {
      "code": "C",
      "name": "Géré",
      "shortName": "Niveau C",
      "description": "Les processus de sécurité sont systématiquement appliqués et surveillés. Les données de sécurité sont collectées et analysées.",
      "color": "#EAB308"
    },
    "LEVEL_D": {
      "code": "D",
      "name": "Assuré",
      "shortName": "Niveau D",
      "description": "Les performances de sécurité sont mesurées par rapport aux objectifs. Identification proactive des dangers et gestion des risques.",
      "color": "#22C55E"
    },
    "LEVEL_E": {
      "code": "E",
      "name": "Excellence",
      "shortName": "Niveau E",
      "description": "Amélioration continue et gestion prédictive de la sécurité. Leader de l'industrie en matière de culture de sécurité.",
      "color": "#3B82F6"
    }
  },
  "transversalAreas": {
    "SPM": {
      "code": "GPS",
      "name": "Gestion des performances de sécurité",
      "description": "Domaine transversal abordant la façon dont les performances de sécurité sont mesurées et gérées dans toutes les composantes"
    },
    "HP": {
      "code": "PH",
      "name": "Performance humaine",
      "description": "Domaine transversal abordant les facteurs humains et leur impact sur la sécurité dans toutes les composantes"
    },
    "CI": {
      "code": "AC",
      "name": "Amélioration continue",
      "description": "Domaine transversal abordant la façon dont l'amélioration continue est intégrée dans toutes les composantes"
    }
  },
  "ansBrowser": {
    "title": "Questions de Protocole ANS",
    "subtitle": "USOAP CMA 2024 - 851 Questions de Protocole dans 9 Domaines d'Audit",
    "breadcrumb": {
      "questionnaires": "Questionnaires",
      "ans": "ANS USOAP CMA"
    },
    "filters": {
      "title": "Filtres",
      "search": "Rechercher",
      "searchPlaceholder": "Rechercher par numéro QP ou texte...",
      "auditArea": "Domaine d'Audit",
      "criticalElement": "Élément Critique",
      "additional": "Filtres Additionnels",
      "priorityPQ": "QP Prioritaire",
      "requiresOnSite": "Nécessite Sur Site",
      "selectAll": "Tout Sélectionner",
      "clear": "Effacer",
      "clearAll": "Effacer Tous les Filtres"
    },
    "results": {
      "showing": "Affichage {from}-{to} sur {total} questions",
      "page": "Page {current} sur {total}"
    },
    "pq": {
      "priority": "Prioritaire",
      "onSite": "Sur Site",
      "newIn2024": "Nouveau en 2024",
      "revisedIn2024": "Révisé en 2024",
      "guidance": "Orientations pour l'Examen des Preuves",
      "icaoReferences": "Références OACI"
    },
    "empty": {
      "title": "Aucune question trouvée",
      "description": "Essayez d'ajuster vos filtres ou votre recherche pour trouver des Questions de Protocole."
    },
    "error": {
      "title": "Erreur de chargement des questions",
      "description": "Un problème est survenu lors du chargement des questions. Veuillez réessayer."
    }
  },
  "smsBrowser": {
    "title": "Évaluation de la Maturité SGS",
    "subtitle": "Norme d'Excellence CANSO 2024 - Évaluation du Système de Gestion de la Sécurité",
    "breadcrumb": {
      "questionnaires": "Questionnaires",
      "sms": "SGS CANSO SoE"
    },
    "components": {
      "1": {
        "short": "Composante 1"
      },
      "2": {
        "short": "Composante 2"
      },
      "3": {
        "short": "Composante 3"
      },
      "4": {
        "short": "Composante 4"
      },
      "title": "Composantes SGS",
      "selected": "Composante Sélectionnée",
      "weight": "pondération"
    },
    "studyArea": {
      "title": "Domaines d'Étude",
      "objectives": "{count} objectifs"
    },
    "maturity": {
      "legend": "Guide des Niveaux de Maturité",
      "objectivesTitle": "Objectifs de Maturité"
    },
    "transversal": {
      "SPM": "Gestion des Performances de Sécurité",
      "HP": "Performance Humaine",
      "CI": "Amélioration Continue"
    }
  },
  "questionDetail": {
    "title": "Détail de la Question",
    "question": "Question",
    "notFound": "Question non trouvée",
    "breadcrumb": {
      "questionnaires": "Questionnaires"
    },
    "priority": "Prioritaire",
    "onSite": "Sur Site",
    "guidance": "Orientations pour l'Examen des Preuves",
    "icaoReferences": "Références OACI",
    "noReferences": "Aucune référence OACI disponible",
    "relatedQuestions": "Questions Connexes",
    "auditArea": "Domaine d'Audit",
    "criticalElement": "Élément Critique",
    "smsComponent": "Composante SGS",
    "studyArea": "Domaine d'Étude",
    "category": "Catégorie",
    "metadata": "Métadonnées de la Question",
    "weight": "pondération",
    "previous": "Précédent",
    "next": "Suivant",
    "openInNewTab": "Ouvrir dans un nouvel onglet",
    "backToList": "Retour aux Questions",
    "share": "Partager",
    "copied": "Copié!",
    "amendment": {
      "NO_CHANGE": "Inchangé",
      "REVISED": "Révisé",
      "NEW": "Nouveau en 2024",
      "MERGED": "Fusionné",
      "DELETED": "Supprimé",
      "REFERENCE_REVISED": "Réf. Mise à jour",
      "from": "de",
      "was": "était"
    }
  },
  "admin": {
    "title": "Administration",
    "description": "Gérer les paramètres système, les utilisateurs et les données des questionnaires",
    "questionnaires": {
      "title": "Gestion des Questionnaires",
      "description": "Gérer les questionnaires, importer des données et configurer les cadres d'évaluation",
      "refresh": "Actualiser",
      "import": "Importer",
      "active": "Actif",
      "inactive": "Inactif",
      "stats": {
        "total": "Total des Questionnaires",
        "active": "Actifs",
        "ansCount": "Questionnaires ANS",
        "smsCount": "Questionnaires SGS"
      },
      "table": {
        "type": "Type",
        "code": "Code",
        "title": "Titre",
        "version": "Version",
        "effectiveDate": "Date d'Effet",
        "questions": "Questions",
        "assessments": "Évaluations",
        "status": "Statut"
      },
      "actions": {
        "view": "Voir le Questionnaire",
        "edit": "Modifier les Détails",
        "deactivate": "Désactiver",
        "delete": "Supprimer Définitivement"
      },
      "empty": {
        "title": "Aucun questionnaire trouvé",
        "description": "Importez votre premier questionnaire pour commencer.",
        "action": "Importer un Questionnaire"
      },
      "deleteDialog": {
        "softTitle": "Désactiver le Questionnaire?",
        "softDescription": "Cela marquera le questionnaire comme inactif. Les évaluations existantes seront préservées.",
        "hardTitle": "Supprimer le Questionnaire?",
        "hardDescription": "Cela supprimera définitivement le questionnaire et toutes les questions associées. Cette action est irréversible.",
        "cancel": "Annuler",
        "confirm": "Confirmer",
        "deleting": "Suppression..."
      },
      "deleteSoftSuccess": "Questionnaire désactivé avec succès",
      "deleteHardSuccess": "Questionnaire supprimé définitivement"
    },
    "import": {
      "pageTitle": "Importer des Données de Questionnaire",
      "pageDescription": "Télécharger et importer des données de questionnaire depuis des fichiers JSON ou CSV",
      "backToList": "Retour aux Questionnaires",
      "step": "Étape {current} sur {total}",
      "back": "Retour",
      "next": "Suivant",
      "import": "Importer",
      "done": "Terminé",
      "step1": {
        "name": "Type",
        "title": "Sélectionner le Type de Questionnaire",
        "description": "Choisissez le type de questionnaire que vous souhaitez importer",
        "ansTitle": "ANS USOAP CMA",
        "ansDescription": "Programme Universel d'Audit de Surveillance de la Sécurité de l'OACI - Questions de Protocole pour les Services de Navigation Aérienne",
        "smsTitle": "SGS CANSO SoE",
        "smsDescription": "Norme d'Excellence CANSO - Évaluation de la maturité du Système de Gestion de la Sécurité"
      },
      "step2": {
        "name": "Fichier",
        "title": "Télécharger le Fichier d'Import",
        "description": "Téléchargez un fichier JSON ou CSV contenant les données du questionnaire",
        "formatLabel": "Format de Fichier",
        "dropHere": "Déposez le fichier ici",
        "orClickToUpload": "ou cliquez pour télécharger",
        "fileUploaded": "Fichier téléchargé avec succès",
        "validating": "Validation du fichier..."
      },
      "step3": {
        "name": "Aperçu",
        "title": "Aperçu des Données d'Import",
        "description": "Vérifiez les données avant l'importation",
        "noData": "Aucune donnée à afficher",
        "warnings": "Avertissements"
      },
      "step4": {
        "name": "Confirmer",
        "importing": "Importation des Données...",
        "pleaseWait": "Veuillez patienter pendant l'importation",
        "success": "Importation Réussie!",
        "successDescription": "Importé {categories} catégories, {questions} questions et {references} références OACI",
        "error": "Échec de l'Importation",
        "ready": "Prêt à Importer",
        "readyDescription": "Cliquez sur le bouton Importer pour démarrer le processus d'importation"
      },
      "searchPlaceholder": "Rechercher par numéro QP ou texte...",
      "showing": "Affichage {from}-{to} sur {total}",
      "page": "Page {current} sur {total}",
      "status": "Statut",
      "pqNumber": "Numéro QP",
      "auditArea": "Domaine d'Audit",
      "ce": "EC",
      "component": "Composante",
      "studyArea": "Domaine d'Étude",
      "questionText": "Texte de la Question",
      "refs": "Réfs",
      "actions": "Actions",
      "errors": "erreurs",
      "noMatchingResults": "Aucun résultat correspondant",
      "noData": "Aucune donnée",
      "editQuestion": "Modifier la Question",
      "questionTextEn": "Texte de la Question (Anglais)",
      "questionTextFr": "Texte de la Question (Français)",
      "cancel": "Annuler",
      "save": "Enregistrer",
      "questions": "Questions",
      "categories": "Catégories",
      "references": "Références",
      "warnings": "Avertissements",
      "validationSuccess": "Fichier validé avec succès",
      "validationErrors": "La validation a trouvé {count} erreurs",
      "validationFailed": "Échec de la validation",
      "importSuccess": "Importation terminée avec succès",
      "importFailed": "Échec de l'importation"
    }
  },
  "errors": {
    "generic": "Une erreur s'est produite",
    "notFound": "Non trouvé",
    "unauthorized": "Accès non autorisé",
    "forbidden": "Accès interdit",
    "serverError": "Erreur serveur",
    "networkError": "Erreur réseau",
    "timeout": "Délai d'attente dépassé",
    "validation": "Erreur de validation",
    "loadFailed": "Échec du chargement des données",
    "saveFailed": "Échec de l'enregistrement des données",
    "deleteFailed": "Échec de la suppression",
    "importFailed": "Échec de l'importation",
    "exportFailed": "Échec de l'exportation",
    "tryAgain": "Veuillez réessayer",
    "contactSupport": "Si le problème persiste, veuillez contacter le support"
  },
  "success": {
    "saved": "Enregistré avec succès",
    "deleted": "Supprimé avec succès",
    "imported": "Importé avec succès",
    "exported": "Exporté avec succès",
    "updated": "Mis à jour avec succès",
    "created": "Créé avec succès",
    "submitted": "Soumis avec succès",
    "copied": "Copié dans le presse-papier"
  },
  "empty": {
    "noData": "Aucune donnée disponible",
    "noResults": "Aucun résultat trouvé",
    "noQuestions": "Aucune question trouvée",
    "noAssessments": "Aucune évaluation trouvée",
    "noReviews": "Aucune revue trouvée",
    "noOrganizations": "Aucune organisation trouvée",
    "noUsers": "Aucun utilisateur trouvé",
    "noDocuments": "Aucun document trouvé",
    "noNotifications": "Aucune notification",
    "startSearch": "Commencez par rechercher ou appliquer des filtres",
    "createFirst": "Créez votre premier élément pour commencer"
  },
  "pagination": {
    "previous": "Précédent",
    "next": "Suivant",
    "first": "Premier",
    "last": "Dernier",
    "page": "Page",
    "of": "sur",
    "showing": "Affichage de",
    "to": "à",
    "entries": "entrées",
    "perPage": "par page"
  },
  "wizard": {
    "pageTitle": "Nouvelle évaluation",
    "pageDescription": "Créez une nouvelle auto-évaluation pour évaluer votre organisation",
    "common": {
      "recommended": "Recommandé"
    },
    "steps": {
      "questionnaireType": "Questionnaire",
      "questionnaireTypeDesc": "Choisir le type",
      "assessmentType": "Évaluation",
      "assessmentTypeDesc": "Choisir l'objectif",
      "details": "Détails",
      "detailsDesc": "Configurer le périmètre",
      "review": "Révision",
      "reviewDesc": "Confirmer et créer",
      "stepOf": "Étape {current} sur {total}"
    },
    "questionnaireType": {
      "title": "Sélectionner le type de questionnaire",
      "description": "Choisissez le cadre de référence pour votre évaluation",
      "helpText": "Vous ne savez pas lequel choisir ? ANS USOAP CMA est recommandé pour la plupart des organisations.",
      "ans": {
        "title": "ANS USOAP CMA",
        "subtitle": "Programme universel d'audit de supervision de la sécurité de l'OACI",
        "description": "Évaluez la conformité aux normes de l'OACI dans 9 domaines d'audit en utilisant les questions du protocole de l'approche de surveillance continue.",
        "feature1": "Questions du protocole",
        "feature2": "Domaines d'audit",
        "feature3": "Éléments critiques",
        "keyDifference": "Idéal pour : Évaluation de conformité aux normes internationales de sécurité aérienne"
      },
      "sms": {
        "title": "SMS CANSO SoE",
        "subtitle": "Standard d'excellence CANSO",
        "description": "Évaluez la maturité du système de gestion de la sécurité dans 4 composantes en utilisant le cadre CANSO avec des niveaux de maturité A-E.",
        "feature1": "Niveaux de maturité",
        "feature2": "Composantes SMS",
        "feature3": "Domaines d'étude",
        "keyDifference": "Idéal pour : Évaluation de la maturité SMS et amélioration continue"
      }
    },
    "assessmentType": {
      "title": "Sélectionner le type d'évaluation",
      "description": "Quel est l'objectif de cette évaluation ?",
      "bestFor": "Idéal pour",
      "types": {
        "self_assessment": {
          "title": "Auto-évaluation",
          "short": "Auto-évaluation",
          "description": "Évaluation interne standard par rapport aux exigences du cadre sélectionné.",
          "bestFor": "Évaluation initiale de référence et suivi continu de la conformité"
        },
        "gap_analysis": {
          "title": "Analyse des écarts",
          "short": "Analyse écarts",
          "description": "Identifier les écarts entre l'état actuel et les exigences ou niveaux de maturité cibles.",
          "bestFor": "Planification pré-amélioration et identification des domaines prioritaires"
        },
        "peer_review": {
          "title": "Préparation à la revue par les pairs",
          "short": "Pré-revue",
          "description": "Préparez-vous à une prochaine revue par les pairs en effectuant une auto-évaluation approfondie.",
          "bestFor": "Organisations se préparant à une revue externe par les pairs"
        },
        "follow_up": {
          "title": "Évaluation de suivi",
          "short": "Suivi",
          "description": "Suivre les progrès sur les constatations précédemment identifiées et les actions correctives.",
          "bestFor": "Suivi des progrès d'amélioration après l'évaluation initiale"
        }
      }
    },
    "details": {
      "title": "Détails de l'évaluation",
      "description": "Configurez le périmètre et le calendrier de votre évaluation",
      "titleLabel": "Titre de l'évaluation",
      "titlePlaceholder": "Entrez un titre descriptif",
      "titleHint": "Un titre clair vous aide à identifier cette évaluation plus tard",
      "regenerateTitle": "Régénérer le titre",
      "descriptionLabel": "Description (Optionnel)",
      "descriptionPlaceholder": "Ajoutez des notes ou objectifs pour cette évaluation...",
      "dueDateLabel": "Date cible d'achèvement (Optionnel)",
      "dueDateHint": "Définissez une date cible pour aider à suivre les progrès",
      "scope": {
        "ansTitle": "Domaines d'audit",
        "ansDescription": "Sélectionnez les domaines d'audit OACI à inclure dans cette évaluation",
        "smsTitle": "Composantes SMS",
        "smsDescription": "Sélectionnez les composantes SMS à évaluer",
        "selectAll": "Tout sélectionner",
        "deselectAll": "Tout désélectionner",
        "noneSelected": "Aucun domaine sélectionné - veuillez en sélectionner au moins un",
        "allSelected": "Tous les domaines sélectionnés",
        "someSelected": "{count} sur {total} domaines sélectionnés"
      }
    },
    "review": {
      "title": "Révision et confirmation",
      "description": "Vérifiez vos sélections avant de créer l'évaluation",
      "summaryTitle": "Résumé de l'évaluation",
      "assessmentTitle": "Titre",
      "descriptionLabel": "Description",
      "auditAreas": "Domaines d'audit",
      "smsComponents": "Composantes SMS",
      "estimatedQuestions": "Questions estimées",
      "estimatedTime": "Temps estimé",
      "hours": "heures",
      "targetDate": "Date cible",
      "noDueDate": "Aucune cible définie",
      "tipsTitle": "Conseils pour une évaluation réussie",
      "tips": {
        "gather": "Rassemblez la documentation et les preuves pertinentes avant de commencer",
        "collaborate": "Impliquez les principales parties prenantes de différents départements",
        "evidence": "Documentez les preuves pour chaque réponse pour étayer vos conclusions",
        "honest": "Soyez honnête dans vos réponses - cette évaluation est pour votre amélioration"
      },
      "confirmLabel": "Je comprends et suis prêt à créer cette évaluation",
      "confirmDescription": "En confirmant, une nouvelle évaluation sera créée avec les paramètres ci-dessus. Vous pouvez commencer à répondre aux questions immédiatement ou revenir plus tard.",
      "confirmRequired": "Veuillez confirmer pour continuer",
      "createButton": "Créer l'évaluation"
    },
    "creating": {
      "title": "Création de votre évaluation",
      "description": "Veuillez patienter pendant que nous configurons votre évaluation...",
      "button": "Création..."
    },
    "success": {
      "title": "Évaluation créée avec succès !",
      "description": "Votre évaluation est prête. Vous pouvez commencer à répondre aux questions maintenant ou revenir plus tard.",
      "created": "Évaluation créée avec succès",
      "assessmentId": "ID de l'évaluation",
      "assessmentTitle": "Titre",
      "startAssessment": "Commencer l'évaluation",
      "viewDashboard": "Voir le tableau de bord",
      "createAnother": "Créer une autre évaluation"
    },
    "errors": {
      "createFailed": "Échec de la création de l'évaluation. Veuillez réessayer."
    }
  },
  "workspace": {
    "loading": "Chargement de l'évaluation...",
    "error": {
      "title": "Erreur de chargement de l'évaluation",
      "description": "Nous n'avons pas pu charger l'évaluation. Veuillez réessayer.",
      "backButton": "Retour aux évaluations"
    },
    "header": {
      "backToAssessments": "Retour aux évaluations",
      "progress": "{answered} sur {total} répondues ({percent}%)",
      "help": "Aide et raccourcis",
      "settings": "Paramètres"
    },
    "sidebar": {
      "title": "Questions",
      "progress": "{answered} sur {total} répondues",
      "overallProgress": "Progression globale",
      "searchPlaceholder": "Rechercher des questions...",
      "noQuestions": "Aucune question ne correspond à vos filtres"
    },
    "filters": {
      "all": "Toutes les questions",
      "unanswered": "Non répondues",
      "flagged": "Marquées pour révision",
      "priority": "Questions prioritaires"
    },
    "shortcuts": {
      "prev": "Précédent",
      "next": "Suivant",
      "flag": "Marquer"
    },
    "panel": {
      "noQuestion": "Aucune question sélectionnée",
      "selectQuestion": "Sélectionnez une question dans la barre latérale pour commencer",
      "questionOf": "Question {current} sur {total}",
      "saving": "Enregistrement...",
      "saved": "Enregistré",
      "saveError": "Échec de l'enregistrement",
      "save": "Enregistrer",
      "flag": "Marquer pour révision",
      "unflag": "Retirer le marquage",
      "guidance": "Orientations",
      "yourResponse": "Votre réponse",
      "ansInstructions": "Sélectionnez la réponse appropriée en fonction de votre examen des preuves.",
      "smsInstructions": "Sélectionnez le niveau de maturité qui décrit le mieux l'état actuel de votre organisation.",
      "notes": "Notes et commentaires",
      "previous": "Précédent",
      "next": "Suivant",
      "keyboardHint": "Utilisez les touches fléchées pour naviguer",
      "priority": "QP prioritaire"
    },
    "ansResponse": {
      "title": "Réponse",
      "protocol": "Question de protocole",
      "satisfactory": "Satisfaisant",
      "satisfactoryDescription": "Répond aux exigences",
      "satisfactoryMessage": "Les preuves confirment la conformité aux exigences de la question de protocole.",
      "notSatisfactory": "Non satisfaisant",
      "notSatisfactoryDescription": "Ne répond pas aux exigences",
      "notSatisfactoryMessage": "Les preuves indiquent une non-conformité. Envisagez de documenter les constatations.",
      "notApplicable": "Non applicable",
      "notApplicableDescription": "Ne s'applique pas",
      "notApplicableMessage": "Cette question n'est pas applicable à votre organisation.",
      "notReviewed": "Non examiné",
      "notReviewedDescription": "Pas encore évalué"
    },
    "smsResponse": {
      "title": "Niveau de maturité",
      "cansoSoE": "CANSO SoE",
      "maturityScale": "Maturité :",
      "score": "Score : {score}",
      "selectedLevel": "Niveau sélectionné",
      "level": "Niveau",
      "levelA": "Informel",
      "levelADescription": "Gestion de la sécurité ad hoc. Pas d'approche systématique.",
      "levelB": "Défini",
      "levelBDescription": "Les processus de sécurité sont documentés et mis en œuvre.",
      "levelC": "Géré",
      "levelCDescription": "Les processus de sécurité sont systématiquement appliqués et surveillés.",
      "levelD": "Assuré",
      "levelDDescription": "Les performances de sécurité sont mesurées par rapport aux objectifs.",
      "levelE": "Excellence",
      "levelEDescription": "Amélioration continue et gestion prédictive de la sécurité."
    },
    "comments": {
      "assessorNotes": "Notes de l'évaluateur",
      "assessorNotesDescription": "Notes visibles par les réviseurs",
      "assessorNotesTooltip": "Ces notes seront partagées avec les réviseurs pendant le processus de révision. Incluez tout contexte qui les aiderait à comprendre votre réponse.",
      "assessorNotesPlaceholder": "Ajoutez des notes pour les réviseurs concernant cette réponse...",
      "internalNotes": "Notes internes",
      "internalNotesDescription": "Notes privées pour votre équipe",
      "internalNotesTooltip": "Ces notes ne sont visibles que par l'équipe de votre organisation et ne seront pas partagées avec les réviseurs.",
      "internalNotesPlaceholder": "Ajoutez des notes privées pour votre équipe...",
      "hasContent": "Contenu présent",
      "characters": "caractères",
      "visibleToReviewers": "Visible par les réviseurs",
      "privateNote": "Privé pour votre équipe",
      "tips": {
        "title": "Conseils pour de bonnes notes",
        "tip1": "Référencez des documents ou procédures spécifiques",
        "tip2": "Notez les hypothèses faites dans votre réponse",
        "tip3": "Signalez les domaines nécessitant une investigation plus approfondie"
      }
    },
    "evidence": {
      "title": "Preuves à l'appui",
      "description": "Fournissez des preuves pour appuyer votre réponse. Incluez des références de documents, des liens ou des descriptions.",
      "hasEvidence": "Preuves fournies",
      "noEvidence": "Pas encore de preuves",
      "descriptionLabel": "Description des preuves",
      "descriptionPlaceholder": "Décrivez les preuves appuyant votre réponse...",
      "descriptionHint": "Référencez des documents, procédures ou dossiers spécifiques",
      "linksLabel": "Liens vers les documents",
      "urlPlaceholder": "https://exemple.com/document",
      "errors": {
        "emptyUrl": "Veuillez entrer une URL",
        "invalidUrl": "Veuillez entrer une URL valide",
        "duplicateUrl": "Cette URL a déjà été ajoutée"
      },
      "removeDialog": {
        "title": "Supprimer le lien ?",
        "description": "Êtes-vous sûr de vouloir supprimer ce lien de preuve ?",
        "cancel": "Annuler",
        "confirm": "Supprimer"
      },
      "dropzone": {
        "title": "Déposez les fichiers ici",
        "subtitle": "ou cliquez pour parcourir vos fichiers",
        "button": "Télécharger des fichiers"
      },
      "supportedFormats": "Supportés : PDF, Word, Excel, images (max 10 Mo chacun)"
    }
  },
  "scoring": {
    "eiScore": "Score de Mise en Œuvre Effective",
    "smsMaturity": "Niveau de Maturité SGS",
    "overallEI": "EI Global",
    "overallScore": "Score Global",
    "calculating": "Calcul des scores...",
    "complete": "Complet",
    "incomplete": "Incomplet",
    "byAuditArea": "Score par Domaine d'Audit",
    "byCriticalElement": "Score par Élément Critique",
    "byComponent": "Score par Composante SGS",
    "byStudyArea": "Score par Domaine d'Étude",
    "componentOverview": "Aperçu des Composantes",
    "responseBreakdown": "Répartition des Réponses",
    "satisfactory": "Satisfaisant",
    "notSatisfactory": "Non Satisfaisant",
    "notApplicable": "Non Applicable",
    "notReviewed": "Non Examiné",
    "incompleteAssessment": "Évaluation incomplète - minimum {threshold}% requis",
    "noResponses": "Aucune réponse enregistrée",
    "noData": "Aucune donnée disponible",
    "level": "Niveau",
    "levels": "niveaux",
    "score": "Score",
    "weight": "Poids",
    "questionsAnswered": "questions répondues",
    "questions": "questions",
    "scoreComparison": "Comparaison des Scores",
    "maturityDistribution": "Distribution des Niveaux de Maturité",
    "trend": {
      "improving": "En amélioration",
      "declining": "En déclin",
      "stable": "Stable",
      "insufficientData": "Données insuffisantes pour l'analyse de tendance"
    },
    "thresholds": {
      "excellent": "Excellent",
      "good": "Bon",
      "satisfactory": "Satisfaisant",
      "needsImprovement": "À améliorer",
      "poor": "Faible",
      "critical": "Critique"
    },
    "maturityLevels": {
      "A": {
        "name": "Initial/Ad-hoc",
        "description": "Aucun processus formel. La sécurité peut être traitée de manière réactive."
      },
      "B": {
        "name": "Défini/Documenté",
        "description": "Processus documentés mais pas appliqués de manière cohérente."
      },
      "C": {
        "name": "Mis en œuvre/Mesuré",
        "description": "Processus mis en œuvre et mesurés."
      },
      "D": {
        "name": "Géré/Contrôlé",
        "description": "Processus gérés avec surveillance continue."
      },
      "E": {
        "name": "Optimisé/Leader",
        "description": "Pratiques de pointe, amélioration continue."
      }
    },
    "validation": {
      "valid": "Évaluation prête pour la notation",
      "canCalculate": "Les scores peuvent être calculés",
      "minCompletion": "Minimum {threshold}% de complétion requis pour la notation officielle",
      "statusWarning": "Le statut de l'évaluation est {status}. Envisagez de soumettre pour la notation officielle."
    },
    "actions": {
      "calculate": "Calculer les Scores",
      "recalculate": "Recalculer",
      "viewBreakdown": "Voir le Détail",
      "exportReport": "Exporter le Rapport",
      "compare": "Comparer les Évaluations"
    }
  },
  "evidence": {
    "upload": {
      "title": "Télécharger des Preuves",
      "dragDrop": "Glissez-déposez les fichiers ici, ou cliquez pour parcourir",
      "addUrl": "Ajouter une Référence URL",
      "urlPlaceholder": "Entrez l'URL d'un document externe",
      "uploading": "Téléchargement...",
      "uploadComplete": "Téléchargement terminé",
      "uploadFailed": "Échec du téléchargement",
      "maxSize": "Taille maximale du fichier : {size} Mo",
      "allowedTypes": "Autorisés : PDF, Images, Word, Excel",
      "maxFiles": "Maximum {count} fichiers par question",
      "removeConfirm": "Supprimer cette preuve ?",
      "category": "Catégorie",
      "description": "Description (optionnelle)",
      "description_placeholder": "Ajoutez une description pour ce document"
    },
    "categories": {
      "POLICY": "Document de Politique",
      "PROCEDURE": "Procédure",
      "RECORD": "Enregistrement/Journal",
      "CERTIFICATE": "Certificat/Licence",
      "REPORT": "Rapport",
      "TRAINING": "Matériel de Formation",
      "EVIDENCE": "Preuve",
      "OTHER": "Autre"
    },
    "library": {
      "title": "Bibliothèque de Documents",
      "description": "Sélectionnez des documents de la bibliothèque de votre organisation",
      "searchPlaceholder": "Rechercher des documents...",
      "allCategories": "Toutes les Catégories",
      "noResults": "Aucun document trouvé",
      "empty": "Aucun document dans la bibliothèque",
      "addSelected": "Ajouter la Sélection"
    },
    "preview": {
      "download": "Télécharger",
      "openInNewTab": "Ouvrir dans un nouvel onglet",
      "close": "Fermer",
      "noPreview": "Aperçu non disponible",
      "uploadedBy": "Téléchargé par"
    }
  }
}
```

# next-env.d.ts

```ts
/// <reference types="next" />
/// <reference types="next/image-types/global" />
import "./.next/dev/types/routes.d.ts";

// NOTE: This file should not be edited
// see https://nextjs.org/docs/app/api-reference/config/typescript for more information.

```

# next.config.ts

```ts
import type { NextConfig } from "next";
import createNextIntlPlugin from "next-intl/plugin";

const withNextIntl = createNextIntlPlugin("./src/lib/i18n/request.ts");

const nextConfig: NextConfig = {
  /* config options here */
};

export default withNextIntl(nextConfig);

```

# package.json

```json
{
  "name": "african-ansp-peer-review",
  "version": "0.1.0",
  "private": true,
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "eslint",
    "typecheck": "tsc --noEmit",
    "test": "vitest",
    "test:run": "vitest run",
    "test:coverage": "vitest run --coverage",
    "prisma:generate": "prisma generate",
    "prisma:migrate": "prisma migrate dev",
    "prisma:push": "prisma db push",
    "prisma:seed": "npx tsx prisma/seed.ts",
    "prisma:seed:users": "npx tsx prisma/seed-dev-users.ts",
    "prisma:reset": "prisma migrate reset",
    "db:seed": "npx tsx prisma/seed.ts",
    "db:seed:users": "npx tsx prisma/seed-dev-users.ts",
    "db:seed:demo": "npx tsx prisma/seed-demo.ts",
    "db:seed:all": "npx tsx prisma/seed.ts && npx tsx prisma/seed-dev-users.ts"
  },
  "dependencies": {
    "@auth/prisma-adapter": "^2.11.1",
    "@hookform/resolvers": "^5.2.2",
    "@prisma/adapter-pg": "^7.2.0",
    "@prisma/client": "^7.2.0",
    "@radix-ui/react-accordion": "^1.2.12",
    "@radix-ui/react-alert-dialog": "^1.1.15",
    "@radix-ui/react-avatar": "^1.1.11",
    "@radix-ui/react-checkbox": "^1.3.3",
    "@radix-ui/react-collapsible": "^1.1.12",
    "@radix-ui/react-dialog": "^1.1.15",
    "@radix-ui/react-dropdown-menu": "^2.1.16",
    "@radix-ui/react-label": "^2.1.8",
    "@radix-ui/react-popover": "^1.1.15",
    "@radix-ui/react-progress": "^1.1.8",
    "@radix-ui/react-radio-group": "^1.3.8",
    "@radix-ui/react-scroll-area": "^1.2.10",
    "@radix-ui/react-select": "^2.2.6",
    "@radix-ui/react-separator": "^1.1.8",
    "@radix-ui/react-slot": "^1.2.4",
    "@radix-ui/react-switch": "^1.2.6",
    "@radix-ui/react-tabs": "^1.1.13",
    "@radix-ui/react-toast": "^1.2.15",
    "@radix-ui/react-tooltip": "^1.2.8",
    "@tanstack/react-query": "^5.90.16",
    "@trpc/client": "^11.8.1",
    "@trpc/next": "^11.8.1",
    "@trpc/react-query": "^11.8.1",
    "@trpc/server": "^11.8.1",
    "bcryptjs": "^3.0.3",
    "class-variance-authority": "^0.7.1",
    "clsx": "^2.1.1",
    "date-fns": "^4.1.0",
    "framer-motion": "^12.26.2",
    "lucide-react": "^0.562.0",
    "nanoid": "^5.1.6",
    "next": "16.1.1",
    "next-auth": "^5.0.0-beta.30",
    "next-intl": "^4.7.0",
    "next-themes": "^0.4.6",
    "pg": "^8.16.3",
    "prisma": "^7.2.0",
    "react": "19.2.3",
    "react-dom": "19.2.3",
    "react-hook-form": "^7.71.1",
    "recharts": "^3.6.0",
    "sonner": "^2.0.7",
    "superjson": "^2.2.6",
    "tailwind-merge": "^3.4.0",
    "zod": "^4.3.5",
    "zustand": "^5.0.10"
  },
  "devDependencies": {
    "@tailwindcss/postcss": "^4",
    "@types/bcryptjs": "^2.4.6",
    "@types/node": "^20",
    "@types/pg": "^8.16.0",
    "@types/react": "^19",
    "@types/react-dom": "^19",
    "@vitest/coverage-v8": "^4.0.17",
    "dotenv": "^17.2.3",
    "eslint": "^9",
    "eslint-config-next": "16.1.1",
    "tailwindcss": "^4",
    "tailwindcss-animate": "^1.0.7",
    "tsx": "^4.19.4",
    "tw-animate-css": "^1.4.0",
    "typescript": "^5",
    "vitest": "^4.0.17"
  },
  "prisma": {
    "seed": "npx tsx prisma/seed.ts"
  }
}

```

# postcss.config.mjs

```mjs
const config = {
  plugins: {
    "@tailwindcss/postcss": {},
  },
};

export default config;

```

# prisma.config.ts

```ts
import "dotenv/config";
import { defineConfig } from "prisma/config";

export default defineConfig({
  schema: "prisma/schema.prisma",
  migrations: {
    path: "prisma/migrations",
  },
  datasource: {
    url: process.env.DATABASE_URL!,
  },
});
```

# prisma/schema.prisma

```prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model Organization {
  id               String           @id @default(cuid())
  nameEn           String           @map("name_en")
  nameFr           String           @map("name_fr")
  icaoCode         String?          @unique @map("icao_code")
  country          String
  region           AfricanRegion
  city             String?
  peerReviewTeam   Int?             @map("peer_review_team")
  membershipStatus MembershipStatus @default(PENDING)
  joinedAt         DateTime?        @map("joined_at")
  createdAt        DateTime         @default(now()) @map("created_at")
  updatedAt        DateTime         @updatedAt @map("updated_at")
  assessments      Assessment[]
  documents        Document[]
  findings         Finding[]
  reviewsAsHost    Review[]         @relation("HostANSP")
  users            User[]

  @@map("organizations")
}

model User {
  id                  String                 @id @default(cuid())
  email               String                 @unique
  passwordHash        String?                @map("password_hash")
  emailVerified       DateTime?              @map("email_verified")
  firstName           String                 @map("first_name")
  lastName            String                 @map("last_name")
  title               String?
  phone               String?
  locale              Locale                 @default(EN)
  timezone            String                 @default("UTC")
  theme               Theme                  @default(SYSTEM)
  role                UserRole               @default(STAFF)
  organizationId      String?                @map("organization_id")
  lastLoginAt         DateTime?              @map("last_login_at")
  isActive            Boolean                @default(true) @map("is_active")
  createdAt           DateTime               @default(now()) @map("created_at")
  updatedAt           DateTime               @updatedAt @map("updated_at")
  assessmentResponses    AssessmentResponse[]
  auditLogs              AuditLog[]
  assignedCAPs           CorrectiveActionPlan[]  @relation("AssignedTo")
  assignedFindings       Finding[]               @relation("AssignedTo")
  notifications          Notification[]
  reviewTeamMembers      ReviewTeamMember[]
  reviewerProfile        ReviewerProfile?
  organization           Organization?           @relation(fields: [organizationId], references: [id])
  uploadedDocuments      Document[]              @relation("UploadedDocuments")
  addedResponseDocuments ResponseDocument[]      @relation("AddedResponseDocuments")
  assessmentEvents       AssessmentEvent[]

  @@map("users")
}

model Questionnaire {
  id            String                  @id @default(cuid())
  code          String                  @unique
  type          QuestionnaireType
  version       String
  titleEn       String                  @map("title_en")
  titleFr       String                  @map("title_fr")
  descriptionEn String?                 @map("description_en")
  descriptionFr String?                 @map("description_fr")
  effectiveDate DateTime                @map("effective_date")
  expiryDate    DateTime?               @map("expiry_date")
  isActive      Boolean                 @default(true) @map("is_active")
  createdAt     DateTime                @default(now()) @map("created_at")
  updatedAt     DateTime                @updatedAt @map("updated_at")
  assessments   Assessment[]
  categories    QuestionnaireCategory[]
  questions     Question[]

  @@map("questionnaires")
}

model QuestionnaireCategory {
  id              String           @id @default(cuid())
  questionnaireId String           @map("questionnaire_id")
  code            String
  sortOrder       Int              @map("sort_order")
  nameEn          String           @map("name_en")
  nameFr          String           @map("name_fr")
  descriptionEn   String?          @map("description_en")
  descriptionFr   String?          @map("description_fr")
  auditArea       USOAPAuditArea?  @map("audit_area")
  criticalElement CriticalElement? @map("critical_element")
  smsComponent    SMSComponent?    @map("sms_component")
  studyArea       CANSOStudyArea?  @map("study_area")
  transversalArea TransversalArea? @map("transversal_area")
  createdAt       DateTime         @default(now()) @map("created_at")
  updatedAt       DateTime         @updatedAt @map("updated_at")
  questionnaire   Questionnaire    @relation(fields: [questionnaireId], references: [id])
  questions       Question[]

  @@unique([questionnaireId, code])
  @@map("questionnaire_categories")
}

model Question {
  id               String                @id @default(cuid())
  questionnaireId  String                @map("questionnaire_id")
  categoryId       String                @map("category_id")
  pqNumber         String?               @map("pq_number")
  auditArea        USOAPAuditArea?       @map("audit_area")
  criticalElement  CriticalElement?      @map("critical_element")
  isPriorityPQ     Boolean               @default(false) @map("is_priority_pq")
  requiresOnSite   Boolean               @default(false) @map("requires_on_site")
  pqStatus         PQAmendmentStatus     @default(NO_CHANGE) @map("pq_status")
  previousPqNumber String?               @map("previous_pq_number")
  smsComponent     SMSComponent?         @map("sms_component")
  studyArea        CANSOStudyArea?       @map("study_area")
  maturityLevel    MaturityLevel?        @map("maturity_level")
  questionTextEn   String                @map("question_text_en")
  questionTextFr   String                @map("question_text_fr")
  guidanceEn       String?               @map("guidance_en")
  guidanceFr       String?               @map("guidance_fr")
  responseType     ResponseType          @default(SATISFACTORY_NOT)
  requiredEvidence String[]              @default([])
  weight           Float                 @default(1.0)
  maxScore         Float                 @default(1.0) @map("max_score")
  sortOrder        Int                   @map("sort_order")
  isActive         Boolean               @default(true) @map("is_active")
  createdAt        DateTime              @default(now()) @map("created_at")
  updatedAt        DateTime              @updatedAt @map("updated_at")
  responses        AssessmentResponse[]
  findings         Finding[]
  icaoReferences   ICAOReference[]
  category         QuestionnaireCategory @relation(fields: [categoryId], references: [id])
  questionnaire    Questionnaire         @relation(fields: [questionnaireId], references: [id])

  @@unique([questionnaireId, pqNumber])
  @@index([auditArea, criticalElement])
  @@index([smsComponent, studyArea])
  @@map("questions")
}

model ICAOReference {
  id            String            @id @default(cuid())
  questionId    String            @map("question_id")
  referenceType ICAOReferenceType @map("reference_type")
  document      String
  chapter       String?
  description   String?
  question      Question          @relation(fields: [questionId], references: [id])

  @@map("icao_references")
}

model ReviewerProfile {
  id                    String                  @id @default(cuid())
  userId                String                  @unique @map("user_id")
  organizationId        String                  @map("organization_id")
  status                ReviewerStatus          @default(NOMINATED)
  nominatedAt           DateTime?               @map("nominated_at")
  selectedAt            DateTime?               @map("selected_at")
  certifiedAt           DateTime?               @map("certified_at")
  currentPosition       String                  @map("current_position")
  yearsExperience       Int                     @map("years_experience")
  biography             String?
  biographyFr           String?                 @map("biography_fr")
  expertiseAreas        ExpertiseArea[]         @default([])
  specializations       String[]                @default([])
  reviewsCompleted      Int                     @default(0) @map("reviews_completed")
  reviewsAsLead         Int                     @default(0) @map("reviews_as_lead")
  lastReviewDate        DateTime?               @map("last_review_date")
  isAvailable           Boolean                 @default(true) @map("is_available")
  availableFrom         DateTime?               @map("available_from")
  availableTo           DateTime?               @map("available_to")
  conflictOrganizations String[]                @default([]) @map("conflict_organizations")
  averageRating         Float?                  @map("average_rating")
  feedbackCount         Int                     @default(0) @map("feedback_count")
  createdAt             DateTime                @default(now()) @map("created_at")
  updatedAt             DateTime                @updatedAt @map("updated_at")
  teamAssignments       ReviewTeamMember[]
  certifications        ReviewerCertification[]
  languages             ReviewerLanguage[]
  user                  User                    @relation(fields: [userId], references: [id])
  trainingRecords       ReviewerTraining[]

  @@map("reviewer_profiles")
}

model ReviewerLanguage {
  id                String              @id @default(cuid())
  reviewerProfileId String              @map("reviewer_profile_id")
  language          Language
  proficiency       LanguageProficiency
  isNative          Boolean             @default(false) @map("is_native")
  reviewerProfile   ReviewerProfile     @relation(fields: [reviewerProfileId], references: [id])

  @@unique([reviewerProfileId, language])
  @@map("reviewer_languages")
}

model ReviewerCertification {
  id                String            @id @default(cuid())
  reviewerProfileId String            @map("reviewer_profile_id")
  type              CertificationType
  name              String
  issuingBody       String            @map("issuing_body")
  certificateNumber String?           @map("certificate_number")
  issuedDate        DateTime          @map("issued_date")
  expiryDate        DateTime?         @map("expiry_date")
  isValid           Boolean           @default(true) @map("is_valid")
  documentUrl       String?           @map("document_url")
  reviewerProfile   ReviewerProfile   @relation(fields: [reviewerProfileId], references: [id])

  @@map("reviewer_certifications")
}

model ReviewerTraining {
  id                String          @id @default(cuid())
  reviewerProfileId String          @map("reviewer_profile_id")
  trainingType      TrainingType    @map("training_type")
  courseName        String          @map("course_name")
  courseNameFr      String?         @map("course_name_fr")
  provider          String
  startDate         DateTime        @map("start_date")
  completionDate    DateTime?       @map("completion_date")
  status            TrainingStatus  @default(IN_PROGRESS)
  grade             String?
  location          String?
  isOnline          Boolean         @default(false) @map("is_online")
  certificateUrl    String?         @map("certificate_url")
  createdAt         DateTime        @default(now()) @map("created_at")
  reviewerProfile   ReviewerProfile @relation(fields: [reviewerProfileId], references: [id])

  @@map("reviewer_trainings")
}

model Assessment {
  id              String               @id @default(cuid())
  type            AssessmentType       @default(SELF_ASSESSMENT)
  title           String
  description     String?
  questionnaireId String               @map("questionnaire_id")
  organizationId  String               @map("organization_id")
  status          AssessmentStatus     @default(DRAFT)
  progress        Float                @default(0)
  dueDate         DateTime?            @map("due_date")
  startedAt       DateTime?            @map("started_at")
  submittedAt     DateTime?            @map("submitted_at")
  completedAt     DateTime?            @map("completed_at")
  overallScore    Float?               @map("overall_score")
  maturityLevel   MaturityLevel?       @map("maturity_level")
  eiScore         Float?               @map("ei_score")
  categoryScores  Json?                @map("category_scores")
  reviewId        String?              @map("review_id")
  createdAt       DateTime             @default(now()) @map("created_at")
  updatedAt       DateTime             @updatedAt @map("updated_at")
  responses       AssessmentResponse[]
  events          AssessmentEvent[]
  organization    Organization         @relation(fields: [organizationId], references: [id])
  questionnaire   Questionnaire        @relation(fields: [questionnaireId], references: [id])
  review          Review?              @relation(fields: [reviewId], references: [id])
  documents       Document[]

  @@index([organizationId, questionnaireId])
  @@map("assessments")
}

model AssessmentEvent {
  id           String     @id @default(cuid())
  assessmentId String     @map("assessment_id")
  type         EventType
  description  String
  metadata     Json?
  userId       String     @map("user_id")
  createdAt    DateTime   @default(now()) @map("created_at")

  // Relations
  assessment   Assessment @relation(fields: [assessmentId], references: [id], onDelete: Cascade)
  user         User       @relation(fields: [userId], references: [id])

  @@index([assessmentId, createdAt])
  @@map("assessment_events")
}

model AssessmentResponse {
  id            String             @id @default(cuid())
  assessmentId  String             @map("assessment_id")
  questionId    String             @map("question_id")
  responseValue String?            @map("response_value")
  maturityLevel MaturityLevel?     @map("maturity_level")
  score         Float?
  notes         String?
  evidenceUrls  String[]           @default([]) @map("evidence_urls")
  respondedById String?            @map("responded_by_id")
  respondedAt   DateTime?          @map("responded_at")
  createdAt     DateTime           @default(now()) @map("created_at")
  updatedAt     DateTime           @updatedAt @map("updated_at")

  // Relations
  assessment    Assessment         @relation(fields: [assessmentId], references: [id])
  question      Question           @relation(fields: [questionId], references: [id])
  respondedBy   User?              @relation(fields: [respondedById], references: [id])
  documents     ResponseDocument[]

  @@unique([assessmentId, questionId])
  @@map("assessment_responses")
}

model Review {
  id                    String             @id @default(cuid())
  referenceNumber       String             @unique @map("reference_number")
  reviewType            ReviewType         @default(FULL)
  hostOrganizationId    String             @map("host_organization_id")
  status                ReviewStatus       @default(REQUESTED)
  phase                 ReviewPhase        @default(PLANNING)
  requestedDate         DateTime           @map("requested_date")
  plannedStartDate      DateTime?          @map("planned_start_date")
  plannedEndDate        DateTime?          @map("planned_end_date")
  actualStartDate       DateTime?          @map("actual_start_date")
  actualEndDate         DateTime?          @map("actual_end_date")
  questionnairesInScope String[]           @default([]) @map("questionnaires_in_scope")
  areasInScope          String[]           @default([]) @map("areas_in_scope")
  createdAt             DateTime           @default(now()) @map("created_at")
  updatedAt             DateTime           @updatedAt @map("updated_at")
  assessments           Assessment[]
  documents             Document[]
  findings              Finding[]
  report                ReviewReport?
  teamMembers           ReviewTeamMember[]
  hostOrganization      Organization       @relation("HostANSP", fields: [hostOrganizationId], references: [id])

  @@map("reviews")
}

model ReviewTeamMember {
  id                String           @id @default(cuid())
  reviewId          String           @map("review_id")
  userId            String           @map("user_id")
  reviewerProfileId String?          @map("reviewer_profile_id")
  role              TeamRole         @default(REVIEWER)
  assignedAreas     String[]         @default([]) @map("assigned_areas")
  confirmedAt       DateTime?        @map("confirmed_at")
  declinedAt        DateTime?        @map("declined_at")
  declineReason     String?          @map("decline_reason")
  createdAt         DateTime         @default(now()) @map("created_at")
  review            Review           @relation(fields: [reviewId], references: [id])
  reviewerProfile   ReviewerProfile? @relation(fields: [reviewerProfileId], references: [id])
  user              User             @relation(fields: [userId], references: [id])

  @@unique([reviewId, userId])
  @@map("review_team_members")
}

model ReviewReport {
  id                 String         @id @default(cuid())
  reviewId           String         @unique @map("review_id")
  titleEn            String         @map("title_en")
  titleFr            String         @map("title_fr")
  executiveSummaryEn String?        @map("executive_summary_en")
  executiveSummaryFr String?        @map("executive_summary_fr")
  overallMaturity    MaturityLevel? @map("overall_maturity")
  overallEI          Float?         @map("overall_ei")
  status             String         @default("DRAFT")
  draftedAt          DateTime?      @map("drafted_at")
  reviewedAt         DateTime?      @map("reviewed_at")
  finalizedAt        DateTime?      @map("finalized_at")
  pdfUrl             String?        @map("pdf_url")
  createdAt          DateTime       @default(now()) @map("created_at")
  updatedAt          DateTime       @updatedAt @map("updated_at")
  review             Review         @relation(fields: [reviewId], references: [id])

  @@map("review_reports")
}

model Finding {
  id                   String                @id @default(cuid())
  reviewId             String                @map("review_id")
  organizationId       String                @map("organization_id")
  questionId           String?               @map("question_id")
  referenceNumber      String                @unique @map("reference_number")
  findingType          FindingType           @default(OBSERVATION)
  severity             FindingSeverity       @default(MINOR)
  titleEn              String                @map("title_en")
  titleFr              String                @map("title_fr")
  descriptionEn        String                @map("description_en")
  descriptionFr        String                @map("description_fr")
  evidenceEn           String?               @map("evidence_en")
  evidenceFr           String?               @map("evidence_fr")
  icaoReference        String?               @map("icao_reference")
  criticalElement      CriticalElement?      @map("critical_element")
  status               FindingStatus         @default(OPEN)
  assignedToId         String?               @map("assigned_to_id")
  capRequired          Boolean               @default(true) @map("cap_required")
  identifiedAt         DateTime              @default(now()) @map("identified_at")
  targetCloseDate      DateTime?             @map("target_close_date")
  closedAt             DateTime?             @map("closed_at")
  createdAt            DateTime              @default(now()) @map("created_at")
  updatedAt            DateTime              @updatedAt @map("updated_at")
  correctiveActionPlan CorrectiveActionPlan?
  documents            Document[]
  assignedTo           User?                 @relation("AssignedTo", fields: [assignedToId], references: [id])
  organization         Organization          @relation(fields: [organizationId], references: [id])
  question             Question?             @relation(fields: [questionId], references: [id])
  review               Review                @relation(fields: [reviewId], references: [id])

  @@index([reviewId, status])
  @@index([organizationId, status])
  @@map("findings")
}

model CorrectiveActionPlan {
  id                 String     @id @default(cuid())
  findingId          String     @unique @map("finding_id")
  rootCauseEn        String     @map("root_cause_en")
  rootCauseFr        String     @map("root_cause_fr")
  correctiveActionEn String     @map("corrective_action_en")
  correctiveActionFr String     @map("corrective_action_fr")
  preventiveActionEn String?    @map("preventive_action_en")
  preventiveActionFr String?    @map("preventive_action_fr")
  status             CAPStatus  @default(DRAFT)
  assignedToId       String?    @map("assigned_to_id")
  submittedAt        DateTime?  @map("submitted_at")
  acceptedAt         DateTime?  @map("accepted_at")
  dueDate            DateTime   @map("due_date")
  completedAt        DateTime?  @map("completed_at")
  verifiedAt         DateTime?  @map("verified_at")
  verificationMethod String?    @map("verification_method")
  verificationNotes  String?    @map("verification_notes")
  verifiedById       String?    @map("verified_by_id")
  createdAt          DateTime   @default(now()) @map("created_at")
  updatedAt          DateTime   @updatedAt @map("updated_at")
  assignedTo         User?      @relation("AssignedTo", fields: [assignedToId], references: [id])
  finding            Finding    @relation(fields: [findingId], references: [id])
  documents          Document[]

  @@map("corrective_action_plans")
}

model TrainingModule {
  id            String             @id @default(cuid())
  moduleNumber  Int                @map("module_number")
  code          String             @unique
  titleEn       String             @map("title_en")
  titleFr       String             @map("title_fr")
  descriptionEn String             @map("description_en")
  descriptionFr String             @map("description_fr")
  objectivesEn  String[]           @default([]) @map("objectives_en")
  objectivesFr  String[]           @default([]) @map("objectives_fr")
  iconName      String?            @map("icon_name")
  sortOrder     Int                @map("sort_order")
  isActive      Boolean            @default(true) @map("is_active")
  isEnabled     Boolean            @default(true) @map("is_enabled")
  enabledUntil  DateTime?          @map("enabled_until")
  createdAt     DateTime           @default(now()) @map("created_at")
  updatedAt     DateTime           @updatedAt @map("updated_at")
  resources     TrainingResource[]
  topics        TrainingTopic[]

  @@map("training_modules")
}

model TrainingTopic {
  id                String           @id @default(cuid())
  moduleId          String           @map("module_id")
  titleEn           String           @map("title_en")
  titleFr           String           @map("title_fr")
  contentEn         String           @map("content_en")
  contentFr         String           @map("content_fr")
  relatedPQs        String[]         @default([]) @map("related_pqs")
  relatedStudyAreas CANSOStudyArea[] @default([]) @map("related_study_areas")
  sortOrder         Int              @map("sort_order")
  module            TrainingModule   @relation(fields: [moduleId], references: [id])

  @@map("training_topics")
}

model TrainingResource {
  id           String         @id @default(cuid())
  moduleId     String         @map("module_id")
  titleEn      String         @map("title_en")
  titleFr      String         @map("title_fr")
  resourceType ResourceType   @map("resource_type")
  url          String?
  fileUrl      String?        @map("file_url")
  sortOrder    Int            @map("sort_order")
  module       TrainingModule @relation(fields: [moduleId], references: [id])

  @@map("training_resources")
}

model Document {
  id             String                @id @default(cuid())
  name           String
  originalName   String?               @map("original_name")
  description    String?
  fileUrl        String                @map("file_url")
  fileType       String                @map("file_type")
  fileSize       Int                   @map("file_size")
  category       DocumentCategory      @default(EVIDENCE)
  tags           String[]              @default([])
  language       Locale?
  organizationId String?               @map("organization_id")
  assessmentId   String?               @map("assessment_id")
  reviewId       String?               @map("review_id")
  findingId      String?               @map("finding_id")
  capId          String?               @map("cap_id")
  uploadedById   String                @map("uploaded_by_id")
  uploadedAt     DateTime              @default(now()) @map("uploaded_at")
  isDeleted      Boolean               @default(false) @map("is_deleted")
  deletedAt      DateTime?             @map("deleted_at")
  createdAt      DateTime              @default(now()) @map("created_at")
  updatedAt      DateTime              @updatedAt @map("updated_at")

  // Relations
  assessment     Assessment?           @relation(fields: [assessmentId], references: [id])
  cap            CorrectiveActionPlan? @relation(fields: [capId], references: [id])
  finding        Finding?              @relation(fields: [findingId], references: [id])
  organization   Organization?         @relation(fields: [organizationId], references: [id])
  review         Review?               @relation(fields: [reviewId], references: [id])
  uploadedBy     User                  @relation("UploadedDocuments", fields: [uploadedById], references: [id])
  responses      ResponseDocument[]

  @@index([organizationId, isDeleted])
  @@index([assessmentId])
  @@map("documents")
}

model ResponseDocument {
  id         String             @id @default(cuid())
  responseId String             @map("response_id")
  documentId String             @map("document_id")
  notes      String?
  addedAt    DateTime           @default(now()) @map("added_at")
  addedById  String             @map("added_by_id")

  // Relations
  response   AssessmentResponse @relation(fields: [responseId], references: [id], onDelete: Cascade)
  document   Document           @relation(fields: [documentId], references: [id], onDelete: Cascade)
  addedBy    User               @relation("AddedResponseDocuments", fields: [addedById], references: [id])

  @@unique([responseId, documentId])
  @@index([documentId])
  @@map("response_documents")
}

model Notification {
  id          String    @id @default(cuid())
  userId      String    @map("user_id")
  type        String
  titleEn     String    @map("title_en")
  titleFr     String    @map("title_fr")
  messageEn   String    @map("message_en")
  messageFr   String    @map("message_fr")
  link        String?
  data        Json?
  readAt      DateTime? @map("read_at")
  emailSentAt DateTime? @map("email_sent_at")
  createdAt   DateTime  @default(now()) @map("created_at")
  user        User      @relation(fields: [userId], references: [id])

  @@index([userId, readAt])
  @@map("notifications")
}

model AuditLog {
  id           String   @id @default(cuid())
  userId       String?  @map("user_id")
  action       String
  entityType   String   @map("entity_type")
  entityId     String   @map("entity_id")
  previousData Json?    @map("previous_data")
  newData      Json?    @map("new_data")
  ipAddress    String?  @map("ip_address")
  userAgent    String?  @map("user_agent")
  createdAt    DateTime @default(now()) @map("created_at")
  user         User?    @relation(fields: [userId], references: [id])

  @@index([entityType, entityId])
  @@index([userId, createdAt])
  @@map("audit_logs")
}

enum Locale {
  EN
  FR
}

enum Theme {
  LIGHT
  DARK
  SYSTEM
}

enum UserRole {
  SUPER_ADMIN
  SYSTEM_ADMIN
  STEERING_COMMITTEE
  PROGRAMME_COORDINATOR
  LEAD_REVIEWER
  PEER_REVIEWER
  OBSERVER
  ANSP_ADMIN
  SAFETY_MANAGER
  QUALITY_MANAGER
  STAFF
}

enum AfricanRegion {
  WACAF
  ESAF
  NORTHERN
}

enum MembershipStatus {
  PENDING
  ACTIVE
  SUSPENDED
  INACTIVE
}

enum QuestionnaireType {
  ANS_USOAP_CMA
  SMS_CANSO_SOE
}

enum USOAPAuditArea {
  LEG
  ORG
  PEL
  OPS
  AIR
  AIG
  ANS
  AGA
  SSP
}

enum CriticalElement {
  CE_1
  CE_2
  CE_3
  CE_4
  CE_5
  CE_6
  CE_7
  CE_8
}

enum SMSComponent {
  SAFETY_POLICY_OBJECTIVES
  SAFETY_RISK_MANAGEMENT
  SAFETY_ASSURANCE
  SAFETY_PROMOTION
}

enum CANSOStudyArea {
  SA_1_1
  SA_1_2
  SA_1_3
  SA_1_4
  SA_1_5
  SA_2_1
  SA_2_2
  SA_3_1
  SA_3_2
  SA_3_3
  SA_4_1
  SA_4_2
}

enum TransversalArea {
  SPM
  HP
  CI
}

enum MaturityLevel {
  LEVEL_A
  LEVEL_B
  LEVEL_C
  LEVEL_D
  LEVEL_E
}

enum PQAmendmentStatus {
  NO_CHANGE
  REVISED
  NEW
  MERGED
  DELETED
  REFERENCE_REVISED
}

enum ResponseType {
  SATISFACTORY_NOT
  MATURITY_LEVEL
  YES_NO
  SCALE_1_5
  TEXT
  MULTI_SELECT
}

enum ICAOReferenceType {
  CC
  STD
  RP
  PANS
  GM
  Cir
  SUPPS
}

enum ReviewerStatus {
  NOMINATED
  SELECTED
  IN_TRAINING
  CERTIFIED
  LEAD_QUALIFIED
  INACTIVE
  RETIRED
}

enum ExpertiseArea {
  ATS
  AIM_AIS
  MET
  CNS
  PANS_OPS
  SAR
  SMS_POLICY
  SMS_RISK
  SMS_ASSURANCE
  SMS_PROMOTION
  AERODROME
  RFF
  ENGINEERING
  QMS
  TRAINING
  HUMAN_FACTORS
}

enum Language {
  EN
  FR
  AR
  PT
  ES
}

enum LanguageProficiency {
  BASIC
  INTERMEDIATE
  ADVANCED
  NATIVE
}

enum CertificationType {
  PEER_REVIEWER
  LEAD_REVIEWER
  SMS_ASSESSOR
  ICAO_AUDITOR
  CANSO_TRAINER
  ATC_LICENSE
  OTHER
}

enum TrainingType {
  INITIAL_REVIEWER
  REFRESHER
  LEAD_REVIEWER
  SMS_ASSESSMENT
  USOAP_CMA
  CANSO_SOE
  SPECIALIZED
}

enum TrainingStatus {
  SCHEDULED
  IN_PROGRESS
  COMPLETED
  INCOMPLETE
  CANCELLED
}

enum AssessmentType {
  SELF_ASSESSMENT
  PEER_REVIEW
  GAP_ANALYSIS
  FOLLOW_UP
}

enum AssessmentStatus {
  DRAFT
  SUBMITTED
  UNDER_REVIEW
  COMPLETED
  ARCHIVED
}

enum ReviewType {
  FULL
  FOCUSED
  FOLLOW_UP
  SURVEILLANCE
}

enum ReviewStatus {
  REQUESTED
  APPROVED
  PLANNING
  SCHEDULED
  IN_PROGRESS
  REPORT_DRAFTING
  REPORT_REVIEW
  COMPLETED
  CANCELLED
}

enum ReviewPhase {
  PLANNING
  PREPARATION
  ON_SITE
  REPORTING
  FOLLOW_UP
  CLOSED
}

enum TeamRole {
  LEAD_REVIEWER
  REVIEWER
  TECHNICAL_EXPERT
  OBSERVER
  TRAINEE
}

enum FindingType {
  NON_CONFORMITY
  OBSERVATION
  RECOMMENDATION
  GOOD_PRACTICE
  CONCERN
}

enum FindingSeverity {
  CRITICAL
  MAJOR
  MINOR
  OBSERVATION
}

enum FindingStatus {
  OPEN
  CAP_REQUIRED
  CAP_SUBMITTED
  CAP_ACCEPTED
  IN_PROGRESS
  VERIFICATION
  CLOSED
  DEFERRED
}

enum CAPStatus {
  DRAFT
  SUBMITTED
  UNDER_REVIEW
  ACCEPTED
  REJECTED
  IN_PROGRESS
  COMPLETED
  VERIFIED
  CLOSED
}

enum ResourceType {
  DOCUMENT
  VIDEO
  PRESENTATION
  CHECKLIST
  TEMPLATE
  EXTERNAL_LINK
}

enum DocumentCategory {
  POLICY
  PROCEDURE
  RECORD
  CERTIFICATE
  REPORT
  TRAINING
  EVIDENCE
  OTHER
}

enum EventType {
  CREATED
  STARTED
  RESPONSE_SAVED
  EVIDENCE_ADDED
  EVIDENCE_REMOVED
  STATUS_CHANGED
  SUBMITTED
  REVIEWED
  COMPLETED
  REOPENED
  COMMENT_ADDED
}

```

# prisma/schema.prisma.backup

```backup
// African ANSP Peer Review Program - Database Schema
// Aligned with 2024 USOAP CMA Protocol Questions & CANSO SoE 2024
// Last Updated: January 2026

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

// =============================================================================
// ENUMS
// =============================================================================

enum Locale {
  EN
  FR
}

enum Theme {
  LIGHT
  DARK
  SYSTEM
}

enum UserRole {
  SUPER_ADMIN
  SYSTEM_ADMIN
  STEERING_COMMITTEE
  PROGRAMME_COORDINATOR
  LEAD_REVIEWER
  PEER_REVIEWER
  OBSERVER
  ANSP_ADMIN
  SAFETY_MANAGER
  QUALITY_MANAGER
  STAFF
}

enum AfricanRegion {
  WACAF
  ESAF
  NORTHERN
}

enum MembershipStatus {
  PENDING
  ACTIVE
  SUSPENDED
  INACTIVE
}

enum QuestionnaireType {
  ANS_USOAP_CMA
  SMS_CANSO_SOE
}

enum USOAPAuditArea {
  LEG
  ORG
  PEL
  OPS
  AIR
  AIG
  ANS
  AGA
  SSP
}

enum CriticalElement {
  CE_1
  CE_2
  CE_3
  CE_4
  CE_5
  CE_6
  CE_7
  CE_8
}

enum SMSComponent {
  SAFETY_POLICY_OBJECTIVES
  SAFETY_RISK_MANAGEMENT
  SAFETY_ASSURANCE
  SAFETY_PROMOTION
}

enum CANSOStudyArea {
  SA_1_1
  SA_1_2
  SA_1_3
  SA_1_4
  SA_1_5
  SA_2_1
  SA_2_2
  SA_3_1
  SA_3_2
  SA_3_3
  SA_4_1
  SA_4_2
}

enum TransversalArea {
  SPM
  HP
  CI
}

enum MaturityLevel {
  LEVEL_A
  LEVEL_B
  LEVEL_C
  LEVEL_D
  LEVEL_E
}

enum PQAmendmentStatus {
  NO_CHANGE
  REVISED
  NEW
  MERGED
  DELETED
  REFERENCE_REVISED
}

enum ResponseType {
  SATISFACTORY_NOT
  MATURITY_LEVEL
  YES_NO
  SCALE_1_5
  TEXT
  MULTI_SELECT
}

enum ICAOReferenceType {
  CC
  STD
  RP
  PANS
  GM
  Cir
  SUPPS
}

enum ReviewerStatus {
  NOMINATED
  SELECTED
  IN_TRAINING
  CERTIFIED
  LEAD_QUALIFIED
  INACTIVE
  RETIRED
}

enum ExpertiseArea {
  ATS
  AIM_AIS
  MET
  CNS
  PANS_OPS
  SAR
  SMS_POLICY
  SMS_RISK
  SMS_ASSURANCE
  SMS_PROMOTION
  AERODROME
  RFF
  ENGINEERING
  QMS
  TRAINING
  HUMAN_FACTORS
}

enum Language {
  EN
  FR
  AR
  PT
  ES
}

enum LanguageProficiency {
  BASIC
  INTERMEDIATE
  ADVANCED
  NATIVE
}

enum CertificationType {
  PEER_REVIEWER
  LEAD_REVIEWER
  SMS_ASSESSOR
  ICAO_AUDITOR
  CANSO_TRAINER
  ATC_LICENSE
  OTHER
}

enum TrainingType {
  INITIAL_REVIEWER
  REFRESHER
  LEAD_REVIEWER
  SMS_ASSESSMENT
  USOAP_CMA
  CANSO_SOE
  SPECIALIZED
}

enum TrainingStatus {
  SCHEDULED
  IN_PROGRESS
  COMPLETED
  INCOMPLETE
  CANCELLED
}

enum AssessmentType {
  SELF_ASSESSMENT
  PEER_REVIEW
  GAP_ANALYSIS
  FOLLOW_UP
}

enum AssessmentStatus {
  DRAFT
  SUBMITTED
  UNDER_REVIEW
  COMPLETED
  ARCHIVED
}

enum ReviewType {
  FULL
  FOCUSED
  FOLLOW_UP
  SURVEILLANCE
}

enum ReviewStatus {
  REQUESTED
  APPROVED
  PLANNING
  SCHEDULED
  IN_PROGRESS
  REPORT_DRAFTING
  REPORT_REVIEW
  COMPLETED
  CANCELLED
}

enum ReviewPhase {
  PLANNING
  PREPARATION
  ON_SITE
  REPORTING
  FOLLOW_UP
  CLOSED
}

enum TeamRole {
  LEAD_REVIEWER
  REVIEWER
  TECHNICAL_EXPERT
  OBSERVER
  TRAINEE
}

enum FindingType {
  NON_CONFORMITY
  OBSERVATION
  RECOMMENDATION
  GOOD_PRACTICE
  CONCERN
}

enum FindingSeverity {
  CRITICAL
  MAJOR
  MINOR
  OBSERVATION
}

enum FindingStatus {
  OPEN
  CAP_REQUIRED
  CAP_SUBMITTED
  CAP_ACCEPTED
  IN_PROGRESS
  VERIFICATION
  CLOSED
  DEFERRED
}

enum CAPStatus {
  DRAFT
  SUBMITTED
  UNDER_REVIEW
  ACCEPTED
  REJECTED
  IN_PROGRESS
  COMPLETED
  VERIFIED
  CLOSED
}

enum ResourceType {
  DOCUMENT
  VIDEO
  PRESENTATION
  CHECKLIST
  TEMPLATE
  EXTERNAL_LINK
}

// =============================================================================
// CORE MODELS
// =============================================================================

model Organization {
  id                String              @id @default(cuid())
  nameEn            String              @map("name_en")
  nameFr            String              @map("name_fr")
  icaoCode          String?             @unique @map("icao_code")
  country           String
  region            AfricanRegion
  city              String?
  membershipStatus  MembershipStatus    @default(PENDING)
  joinedAt          DateTime?           @map("joined_at")
  users             User[]
  assessments       Assessment[]
  reviewsAsHost     Review[]            @relation("HostANSP")
  findings          Finding[]
  documents         Document[]
  createdAt         DateTime            @default(now()) @map("created_at")
  updatedAt         DateTime            @updatedAt @map("updated_at")
  @@map("organizations")
}

model User {
  id                  String              @id @default(cuid())
  email               String              @unique
  passwordHash        String?             @map("password_hash")
  emailVerified       DateTime?           @map("email_verified")
  firstName           String              @map("first_name")
  lastName            String              @map("last_name")
  title               String?
  phone               String?
  locale              Locale              @default(EN)
  timezone            String              @default("UTC")
  theme               Theme               @default(SYSTEM)
  role                UserRole            @default(STAFF)
  organizationId      String?             @map("organization_id")
  organization        Organization?       @relation(fields: [organizationId], references: [id])
  reviewerProfile     ReviewerProfile?
  lastLoginAt         DateTime?           @map("last_login_at")
  isActive            Boolean             @default(true) @map("is_active")
  assessmentResponses AssessmentResponse[]
  reviewTeamMembers   ReviewTeamMember[]
  assignedFindings    Finding[]           @relation("AssignedTo")
  assignedCAPs        CorrectiveActionPlan[] @relation("AssignedTo")
  notifications       Notification[]
  auditLogs           AuditLog[]
  createdAt           DateTime            @default(now()) @map("created_at")
  updatedAt           DateTime            @updatedAt @map("updated_at")
  @@map("users")
}

// =============================================================================
// QUESTIONNAIRE SYSTEM
// =============================================================================

model Questionnaire {
  id                String              @id @default(cuid())
  code              String              @unique
  type              QuestionnaireType
  version           String
  titleEn           String              @map("title_en")
  titleFr           String              @map("title_fr")
  descriptionEn     String?             @map("description_en")
  descriptionFr     String?             @map("description_fr")
  categories        QuestionnaireCategory[]
  questions         Question[]
  effectiveDate     DateTime            @map("effective_date")
  expiryDate        DateTime?           @map("expiry_date")
  isActive          Boolean             @default(true) @map("is_active")
  assessments       Assessment[]
  createdAt         DateTime            @default(now()) @map("created_at")
  updatedAt         DateTime            @updatedAt @map("updated_at")
  @@map("questionnaires")
}

model QuestionnaireCategory {
  id                String              @id @default(cuid())
  questionnaireId   String              @map("questionnaire_id")
  questionnaire     Questionnaire       @relation(fields: [questionnaireId], references: [id])
  code              String
  sortOrder         Int                 @map("sort_order")
  nameEn            String              @map("name_en")
  nameFr            String              @map("name_fr")
  descriptionEn     String?             @map("description_en")
  descriptionFr     String?             @map("description_fr")
  auditArea         USOAPAuditArea?     @map("audit_area")
  criticalElement   CriticalElement?    @map("critical_element")
  smsComponent      SMSComponent?       @map("sms_component")
  studyArea         CANSOStudyArea?     @map("study_area")
  transversalArea   TransversalArea?    @map("transversal_area")
  questions         Question[]
  createdAt         DateTime            @default(now()) @map("created_at")
  updatedAt         DateTime            @updatedAt @map("updated_at")
  @@unique([questionnaireId, code])
  @@map("questionnaire_categories")
}

model Question {
  id                  String              @id @default(cuid())
  questionnaireId     String              @map("questionnaire_id")
  questionnaire       Questionnaire       @relation(fields: [questionnaireId], references: [id])
  categoryId          String              @map("category_id")
  category            QuestionnaireCategory @relation(fields: [categoryId], references: [id])
  pqNumber            String?             @map("pq_number")
  auditArea           USOAPAuditArea?     @map("audit_area")
  criticalElement     CriticalElement?    @map("critical_element")
  isPriorityPQ        Boolean             @default(false) @map("is_priority_pq")
  requiresOnSite      Boolean             @default(false) @map("requires_on_site")
  pqStatus            PQAmendmentStatus   @default(NO_CHANGE) @map("pq_status")
  previousPqNumber    String?             @map("previous_pq_number")
  smsComponent        SMSComponent?       @map("sms_component")
  studyArea           CANSOStudyArea?     @map("study_area")
  maturityLevel       MaturityLevel?      @map("maturity_level")
  questionTextEn      String              @map("question_text_en")
  questionTextFr      String              @map("question_text_fr")
  guidanceEn          String?             @map("guidance_en") @db.Text
  guidanceFr          String?             @map("guidance_fr") @db.Text
  icaoReferences      ICAOReference[]
  responseType        ResponseType        @default(SATISFACTORY_NOT)
  requiredEvidence    String[]            @default([])
  weight              Float               @default(1.0)
  maxScore            Float               @default(1.0) @map("max_score")
  sortOrder           Int                 @map("sort_order")
  isActive            Boolean             @default(true) @map("is_active")
  responses           AssessmentResponse[]
  findings            Finding[]
  createdAt           DateTime            @default(now()) @map("created_at")
  updatedAt           DateTime            @updatedAt @map("updated_at")
  @@unique([questionnaireId, pqNumber])
  @@index([auditArea, criticalElement])
  @@index([smsComponent, studyArea])
  @@map("questions")
}

model ICAOReference {
  id                String              @id @default(cuid())
  questionId        String              @map("question_id")
  question          Question            @relation(fields: [questionId], references: [id])
  referenceType     ICAOReferenceType   @map("reference_type")
  document          String
  chapter           String?
  description       String?
  @@map("icao_references")
}

// =============================================================================
// REVIEWER PROFILES
// =============================================================================

model ReviewerProfile {
  id                    String              @id @default(cuid())
  userId                String              @unique @map("user_id")
  user                  User                @relation(fields: [userId], references: [id])
  organizationId        String              @map("organization_id")
  status                ReviewerStatus      @default(NOMINATED)
  nominatedAt           DateTime?           @map("nominated_at")
  selectedAt            DateTime?           @map("selected_at")
  certifiedAt           DateTime?           @map("certified_at")
  currentPosition       String              @map("current_position")
  yearsExperience       Int                 @map("years_experience")
  biography             String?             @db.Text
  biographyFr           String?             @map("biography_fr") @db.Text
  expertiseAreas        ExpertiseArea[]     @default([])
  specializations       String[]            @default([])
  languages             ReviewerLanguage[]
  certifications        ReviewerCertification[]
  trainingRecords       ReviewerTraining[]
  reviewsCompleted      Int                 @default(0) @map("reviews_completed")
  reviewsAsLead         Int                 @default(0) @map("reviews_as_lead")
  lastReviewDate        DateTime?           @map("last_review_date")
  isAvailable           Boolean             @default(true) @map("is_available")
  availableFrom         DateTime?           @map("available_from")
  availableTo           DateTime?           @map("available_to")
  conflictOrganizations String[]            @default([]) @map("conflict_organizations")
  averageRating         Float?              @map("average_rating")
  feedbackCount         Int                 @default(0) @map("feedback_count")
  teamAssignments       ReviewTeamMember[]
  createdAt             DateTime            @default(now()) @map("created_at")
  updatedAt             DateTime            @updatedAt @map("updated_at")
  @@map("reviewer_profiles")
}

model ReviewerLanguage {
  id                  String              @id @default(cuid())
  reviewerProfileId   String              @map("reviewer_profile_id")
  reviewerProfile     ReviewerProfile     @relation(fields: [reviewerProfileId], references: [id])
  language            Language
  proficiency         LanguageProficiency
  isNative            Boolean             @default(false) @map("is_native")
  @@unique([reviewerProfileId, language])
  @@map("reviewer_languages")
}

model ReviewerCertification {
  id                  String              @id @default(cuid())
  reviewerProfileId   String              @map("reviewer_profile_id")
  reviewerProfile     ReviewerProfile     @relation(fields: [reviewerProfileId], references: [id])
  type                CertificationType
  name                String
  issuingBody         String              @map("issuing_body")
  certificateNumber   String?             @map("certificate_number")
  issuedDate          DateTime            @map("issued_date")
  expiryDate          DateTime?           @map("expiry_date")
  isValid             Boolean             @default(true) @map("is_valid")
  documentUrl         String?             @map("document_url")
  @@map("reviewer_certifications")
}

model ReviewerTraining {
  id                  String              @id @default(cuid())
  reviewerProfileId   String              @map("reviewer_profile_id")
  reviewerProfile     ReviewerProfile     @relation(fields: [reviewerProfileId], references: [id])
  trainingType        TrainingType        @map("training_type")
  courseName          String              @map("course_name")
  courseNameFr        String?             @map("course_name_fr")
  provider            String
  startDate           DateTime            @map("start_date")
  completionDate      DateTime?           @map("completion_date")
  status              TrainingStatus      @default(IN_PROGRESS)
  grade               String?
  location            String?
  isOnline            Boolean             @default(false) @map("is_online")
  certificateUrl      String?             @map("certificate_url")
  createdAt           DateTime            @default(now()) @map("created_at")
  @@map("reviewer_trainings")
}

// =============================================================================
// ASSESSMENT & REVIEW
// =============================================================================

model Assessment {
  id                  String              @id @default(cuid())
  type                AssessmentType      @default(SELF_ASSESSMENT)
  questionnaireId     String              @map("questionnaire_id")
  questionnaire       Questionnaire       @relation(fields: [questionnaireId], references: [id])
  organizationId      String              @map("organization_id")
  organization        Organization        @relation(fields: [organizationId], references: [id])
  status              AssessmentStatus    @default(DRAFT)
  progress            Float               @default(0)
  startedAt           DateTime?           @map("started_at")
  submittedAt         DateTime?           @map("submitted_at")
  completedAt         DateTime?           @map("completed_at")
  overallScore        Float?              @map("overall_score")
  maturityLevel       MaturityLevel?      @map("maturity_level")
  eiScore             Float?              @map("ei_score")
  categoryScores      Json?               @map("category_scores")
  reviewId            String?             @map("review_id")
  review              Review?             @relation(fields: [reviewId], references: [id])
  responses           AssessmentResponse[]
  documents           Document[]
  createdAt           DateTime            @default(now()) @map("created_at")
  updatedAt           DateTime            @updatedAt @map("updated_at")
  @@index([organizationId, questionnaireId])
  @@map("assessments")
}

model AssessmentResponse {
  id                  String              @id @default(cuid())
  assessmentId        String              @map("assessment_id")
  assessment          Assessment          @relation(fields: [assessmentId], references: [id])
  questionId          String              @map("question_id")
  question            Question            @relation(fields: [questionId], references: [id])
  responseValue       String?             @map("response_value")
  maturityLevel       MaturityLevel?      @map("maturity_level")
  score               Float?
  notes               String?             @db.Text
  evidenceUrls        String[]            @default([]) @map("evidence_urls")
  respondedById       String?             @map("responded_by_id")
  respondedBy         User?               @relation(fields: [respondedById], references: [id])
  respondedAt         DateTime?           @map("responded_at")
  createdAt           DateTime            @default(now()) @map("created_at")
  updatedAt           DateTime            @updatedAt @map("updated_at")
  @@unique([assessmentId, questionId])
  @@map("assessment_responses")
}

model Review {
  id                  String              @id @default(cuid())
  referenceNumber     String              @unique @map("reference_number")
  reviewType          ReviewType          @default(FULL)
  hostOrganizationId  String              @map("host_organization_id")
  hostOrganization    Organization        @relation("HostANSP", fields: [hostOrganizationId], references: [id])
  status              ReviewStatus        @default(REQUESTED)
  phase               ReviewPhase         @default(PLANNING)
  requestedDate       DateTime            @map("requested_date")
  plannedStartDate    DateTime?           @map("planned_start_date")
  plannedEndDate      DateTime?           @map("planned_end_date")
  actualStartDate     DateTime?           @map("actual_start_date")
  actualEndDate       DateTime?           @map("actual_end_date")
  questionnairesInScope String[]          @default([]) @map("questionnaires_in_scope")
  areasInScope        String[]            @default([]) @map("areas_in_scope")
  teamMembers         ReviewTeamMember[]
  assessments         Assessment[]
  findings            Finding[]
  report              ReviewReport?
  documents           Document[]
  createdAt           DateTime            @default(now()) @map("created_at")
  updatedAt           DateTime            @updatedAt @map("updated_at")
  @@map("reviews")
}

model ReviewTeamMember {
  id                  String              @id @default(cuid())
  reviewId            String              @map("review_id")
  review              Review              @relation(fields: [reviewId], references: [id])
  userId              String              @map("user_id")
  user                User                @relation(fields: [userId], references: [id])
  reviewerProfileId   String?             @map("reviewer_profile_id")
  reviewerProfile     ReviewerProfile?    @relation(fields: [reviewerProfileId], references: [id])
  role                TeamRole            @default(REVIEWER)
  assignedAreas       String[]            @default([]) @map("assigned_areas")
  confirmedAt         DateTime?           @map("confirmed_at")
  declinedAt          DateTime?           @map("declined_at")
  declineReason       String?             @map("decline_reason")
  createdAt           DateTime            @default(now()) @map("created_at")
  @@unique([reviewId, userId])
  @@map("review_team_members")
}

model ReviewReport {
  id                  String              @id @default(cuid())
  reviewId            String              @unique @map("review_id")
  review              Review              @relation(fields: [reviewId], references: [id])
  titleEn             String              @map("title_en")
  titleFr             String              @map("title_fr")
  executiveSummaryEn  String?             @map("executive_summary_en") @db.Text
  executiveSummaryFr  String?             @map("executive_summary_fr") @db.Text
  overallMaturity     MaturityLevel?      @map("overall_maturity")
  overallEI           Float?              @map("overall_ei")
  status              String              @default("DRAFT")
  draftedAt           DateTime?           @map("drafted_at")
  reviewedAt          DateTime?           @map("reviewed_at")
  finalizedAt         DateTime?           @map("finalized_at")
  pdfUrl              String?             @map("pdf_url")
  createdAt           DateTime            @default(now()) @map("created_at")
  updatedAt           DateTime            @updatedAt @map("updated_at")
  @@map("review_reports")
}

// =============================================================================
// FINDINGS & CAP
// =============================================================================

model Finding {
  id                   String              @id @default(cuid())
  reviewId             String              @map("review_id")
  review               Review              @relation(fields: [reviewId], references: [id])
  organizationId       String              @map("organization_id")
  organization         Organization        @relation(fields: [organizationId], references: [id])
  questionId           String?             @map("question_id")
  question             Question?           @relation(fields: [questionId], references: [id])
  referenceNumber      String              @unique @map("reference_number")
  findingType          FindingType         @default(OBSERVATION)
  severity             FindingSeverity     @default(MINOR)
  titleEn              String              @map("title_en")
  titleFr              String              @map("title_fr")
  descriptionEn        String              @map("description_en") @db.Text
  descriptionFr        String              @map("description_fr") @db.Text
  evidenceEn           String?             @map("evidence_en") @db.Text
  evidenceFr           String?             @map("evidence_fr") @db.Text
  icaoReference        String?             @map("icao_reference")
  criticalElement      CriticalElement?    @map("critical_element")
  status               FindingStatus       @default(OPEN)
  assignedToId         String?             @map("assigned_to_id")
  assignedTo           User?               @relation("AssignedTo", fields: [assignedToId], references: [id])
  capRequired          Boolean             @default(true) @map("cap_required")
  correctiveActionPlan CorrectiveActionPlan?
  identifiedAt         DateTime            @default(now()) @map("identified_at")
  targetCloseDate      DateTime?           @map("target_close_date")
  closedAt             DateTime?           @map("closed_at")
  documents            Document[]
  createdAt            DateTime            @default(now()) @map("created_at")
  updatedAt            DateTime            @updatedAt @map("updated_at")
  @@index([reviewId, status])
  @@index([organizationId, status])
  @@map("findings")
}

model CorrectiveActionPlan {
  id                  String              @id @default(cuid())
  findingId           String              @unique @map("finding_id")
  finding             Finding             @relation(fields: [findingId], references: [id])
  rootCauseEn         String              @map("root_cause_en") @db.Text
  rootCauseFr         String              @map("root_cause_fr") @db.Text
  correctiveActionEn  String              @map("corrective_action_en") @db.Text
  correctiveActionFr  String              @map("corrective_action_fr") @db.Text
  preventiveActionEn  String?             @map("preventive_action_en") @db.Text
  preventiveActionFr  String?             @map("preventive_action_fr") @db.Text
  status              CAPStatus           @default(DRAFT)
  assignedToId        String?             @map("assigned_to_id")
  assignedTo          User?               @relation("AssignedTo", fields: [assignedToId], references: [id])
  submittedAt         DateTime?           @map("submitted_at")
  acceptedAt          DateTime?           @map("accepted_at")
  dueDate             DateTime            @map("due_date")
  completedAt         DateTime?           @map("completed_at")
  verifiedAt          DateTime?           @map("verified_at")
  verificationMethod  String?             @map("verification_method")
  verificationNotes   String?             @map("verification_notes") @db.Text
  verifiedById        String?             @map("verified_by_id")
  documents           Document[]
  createdAt           DateTime            @default(now()) @map("created_at")
  updatedAt           DateTime            @updatedAt @map("updated_at")
  @@map("corrective_action_plans")
}

// =============================================================================
// TRAINING MODULE
// =============================================================================

model TrainingModule {
  id                  String              @id @default(cuid())
  moduleNumber        Int                 @map("module_number")
  code                String              @unique
  titleEn             String              @map("title_en")
  titleFr             String              @map("title_fr")
  descriptionEn       String              @map("description_en") @db.Text
  descriptionFr       String              @map("description_fr") @db.Text
  objectivesEn        String[]            @default([]) @map("objectives_en")
  objectivesFr        String[]            @default([]) @map("objectives_fr")
  topics              TrainingTopic[]
  resources           TrainingResource[]
  iconName            String?             @map("icon_name")
  sortOrder           Int                 @map("sort_order")
  isActive            Boolean             @default(true) @map("is_active")
  isEnabled           Boolean             @default(true) @map("is_enabled")
  enabledUntil        DateTime?           @map("enabled_until")
  createdAt           DateTime            @default(now()) @map("created_at")
  updatedAt           DateTime            @updatedAt @map("updated_at")
  @@map("training_modules")
}

model TrainingTopic {
  id                  String              @id @default(cuid())
  moduleId            String              @map("module_id")
  module              TrainingModule      @relation(fields: [moduleId], references: [id])
  titleEn             String              @map("title_en")
  titleFr             String              @map("title_fr")
  contentEn           String              @map("content_en") @db.Text
  contentFr           String              @map("content_fr") @db.Text
  relatedPQs          String[]            @default([]) @map("related_pqs")
  relatedStudyAreas   CANSOStudyArea[]    @default([]) @map("related_study_areas")
  sortOrder           Int                 @map("sort_order")
  @@map("training_topics")
}

model TrainingResource {
  id                  String              @id @default(cuid())
  moduleId            String              @map("module_id")
  module              TrainingModule      @relation(fields: [moduleId], references: [id])
  titleEn             String              @map("title_en")
  titleFr             String              @map("title_fr")
  resourceType        ResourceType        @map("resource_type")
  url                 String?
  fileUrl             String?             @map("file_url")
  sortOrder           Int                 @map("sort_order")
  @@map("training_resources")
}

// =============================================================================
// DOCUMENTS & SUPPORT
// =============================================================================

model Document {
  id                  String              @id @default(cuid())
  name                String
  description         String?
  fileUrl             String              @map("file_url")
  fileType            String              @map("file_type")
  fileSize            Int                 @map("file_size")
  category            String?
  tags                String[]            @default([])
  organizationId      String?             @map("organization_id")
  organization        Organization?       @relation(fields: [organizationId], references: [id])
  assessmentId        String?             @map("assessment_id")
  assessment          Assessment?         @relation(fields: [assessmentId], references: [id])
  reviewId            String?             @map("review_id")
  review              Review?             @relation(fields: [reviewId], references: [id])
  findingId           String?             @map("finding_id")
  finding             Finding?            @relation(fields: [findingId], references: [id])
  capId               String?             @map("cap_id")
  cap                 CorrectiveActionPlan? @relation(fields: [capId], references: [id])
  uploadedById        String              @map("uploaded_by_id")
  uploadedAt          DateTime            @default(now()) @map("uploaded_at")
  createdAt           DateTime            @default(now()) @map("created_at")
  updatedAt           DateTime            @updatedAt @map("updated_at")
  @@map("documents")
}

model Notification {
  id                  String              @id @default(cuid())
  userId              String              @map("user_id")
  user                User                @relation(fields: [userId], references: [id])
  type                String
  titleEn             String              @map("title_en")
  titleFr             String              @map("title_fr")
  messageEn           String              @map("message_en")
  messageFr           String              @map("message_fr")
  link                String?
  data                Json?
  readAt              DateTime?           @map("read_at")
  emailSentAt         DateTime?           @map("email_sent_at")
  createdAt           DateTime            @default(now()) @map("created_at")
  @@index([userId, readAt])
  @@map("notifications")
}

model AuditLog {
  id                  String              @id @default(cuid())
  userId              String?             @map("user_id")
  user                User?               @relation(fields: [userId], references: [id])
  action              String
  entityType          String              @map("entity_type")
  entityId            String              @map("entity_id")
  previousData        Json?               @map("previous_data")
  newData             Json?               @map("new_data")
  ipAddress           String?             @map("ip_address")
  userAgent           String?             @map("user_agent")
  createdAt           DateTime            @default(now()) @map("created_at")
  @@index([entityType, entityId])
  @@index([userId, createdAt])
  @@map("audit_logs")
}

```

# prisma/seed-client.ts

```ts
import { PrismaClient } from "@prisma/client";

const prisma = new PrismaClient();

export default prisma;

```

# prisma/seed-data/ans-usoap-2024.json

```json
{
  "questionnaire": {
    "code": "USOAP-CMA-2024",
    "type": "ANS_USOAP_CMA",
    "version": "2024",
    "titleEn": "ICAO USOAP CMA Protocol Questions 2024",
    "titleFr": "Questions de Protocole USOAP CMA de l'OACI 2024",
    "descriptionEn": "The ICAO Universal Safety Oversight Audit Programme Continuous Monitoring Approach (USOAP CMA) Protocol Questions are used to assess States' safety oversight capabilities across 8 Critical Elements and 9 Audit Areas.",
    "descriptionFr": "Les Questions de Protocole USOAP CMA de l'OACI sont utilisées pour évaluer les capacités de surveillance de la sécurité des États à travers 8 Éléments Critiques et 9 Domaines d'Audit.",
    "effectiveDate": "2025-07-01"
  },
  "categories": [
    {
      "code": "AGA-CE2",
      "sortOrder": 1,
      "nameEn": "AGA - Primary Aviation Legislation and Specific Operating Regulations",
      "nameFr": "AGA - Législation Aéronautique Primaire et Règlements d'Exploitation Spécifiques",
      "descriptionEn": "Protocol Questions assessing whether the State has promulgated regulations to transpose ICAO Annex 14 provisions and established certification requirements for aerodromes.",
      "descriptionFr": "Questions de Protocole évaluant si l'État a promulgué des règlements pour transposer les dispositions de l'Annexe 14 de l'OACI et établi des exigences de certification pour les aérodromes.",
      "auditArea": "AGA",
      "criticalElement": "CE_2"
    },
    {
      "code": "AGA-CE3",
      "sortOrder": 2,
      "nameEn": "AGA - State Civil Aviation System and Safety Oversight Functions",
      "nameFr": "AGA - Système d'Aviation Civile de l'État et Fonctions de Surveillance de la Sécurité",
      "descriptionEn": "Protocol Questions assessing the organizational structure, separation of authority, and defined responsibilities of the aerodrome regulatory authority.",
      "descriptionFr": "Questions de Protocole évaluant la structure organisationnelle, la séparation des autorités et les responsabilités définies de l'autorité de réglementation des aérodromes.",
      "auditArea": "AGA",
      "criticalElement": "CE_3"
    },
    {
      "code": "AGA-CE4",
      "sortOrder": 3,
      "nameEn": "AGA - Technical Personnel Qualification and Training",
      "nameFr": "AGA - Qualification et Formation du Personnel Technique",
      "descriptionEn": "Protocol Questions assessing minimum qualification requirements and ongoing training programmes for aerodrome regulatory authority technical staff.",
      "descriptionFr": "Questions de Protocole évaluant les exigences minimales de qualification et les programmes de formation continue pour le personnel technique de l'autorité de réglementation des aérodromes.",
      "auditArea": "AGA",
      "criticalElement": "CE_4"
    },
    {
      "code": "AGA-CE5",
      "sortOrder": 4,
      "nameEn": "AGA - Technical Guidance, Tools and Provision of Safety-Critical Information",
      "nameFr": "AGA - Orientations Techniques, Outils et Fourniture d'Informations Critiques pour la Sécurité",
      "descriptionEn": "Protocol Questions assessing the availability of technical guidance material and procedures for aerodrome certification and oversight activities.",
      "descriptionFr": "Questions de Protocole évaluant la disponibilité du matériel d'orientation technique et des procédures pour la certification des aérodromes et les activités de surveillance.",
      "auditArea": "AGA",
      "criticalElement": "CE_5"
    },
    {
      "code": "AGA-CE6",
      "sortOrder": 5,
      "nameEn": "AGA - Licensing, Certification, Authorization and Approval Obligations",
      "nameFr": "AGA - Obligations de Licence, Certification, Autorisation et Approbation",
      "descriptionEn": "Protocol Questions assessing the implementation of aerodrome certification systems, approval processes, and exemption procedures.",
      "descriptionFr": "Questions de Protocole évaluant la mise en œuvre des systèmes de certification des aérodromes, des processus d'approbation et des procédures d'exemption.",
      "auditArea": "AGA",
      "criticalElement": "CE_6"
    },
    {
      "code": "AGA-CE7",
      "sortOrder": 6,
      "nameEn": "AGA - Surveillance Obligations",
      "nameFr": "AGA - Obligations de Surveillance",
      "descriptionEn": "Protocol Questions assessing the implementation of surveillance programmes, inspection activities, and continuous monitoring of certified aerodromes.",
      "descriptionFr": "Questions de Protocole évaluant la mise en œuvre des programmes de surveillance, des activités d'inspection et du suivi continu des aérodromes certifiés.",
      "auditArea": "AGA",
      "criticalElement": "CE_7"
    },
    {
      "code": "AGA-CE8",
      "sortOrder": 7,
      "nameEn": "AGA - Resolution of Safety Concerns",
      "nameFr": "AGA - Résolution des Problèmes de Sécurité",
      "descriptionEn": "Protocol Questions assessing the procedures and mechanisms for identifying and resolving safety concerns at certified aerodromes.",
      "descriptionFr": "Questions de Protocole évaluant les procédures et mécanismes pour identifier et résoudre les problèmes de sécurité dans les aérodromes certifiés.",
      "auditArea": "AGA",
      "criticalElement": "CE_8"
    }
  ],
  "questions": [
    {
      "pqNumber": "AGA-8.001",
      "questionTextEn": "Has the State promulgated specific operating regulations to transpose the provisions of Annex 14?",
      "questionTextFr": "L'État a-t-il promulgué des règlements d'exploitation spécifiques pour transposer les dispositions de l'Annexe 14?",
      "auditArea": "AGA",
      "criticalElement": "CE_2",
      "isPriorityPQ": true,
      "requiresOnSite": false,
      "pqStatus": "NO_CHANGE",
      "sortOrder": 1,
      "guidanceEn": "Review the State's primary aviation legislation and specific operating regulations related to aerodromes. Verify that the regulations address the Standards and Recommended Practices (SARPs) contained in ICAO Annex 14, Volumes I and II. Check that the regulations cover aerodrome design, operations, certification requirements, and safety management.",
      "guidanceFr": "Examiner la législation aéronautique primaire de l'État et les règlements d'exploitation spécifiques relatifs aux aérodromes. Vérifier que les règlements traitent des Normes et Pratiques Recommandées (SARP) contenues dans l'Annexe 14 de l'OACI, Volumes I et II. Vérifier que les règlements couvrent la conception des aérodromes, les opérations, les exigences de certification et la gestion de la sécurité.",
      "responseType": "SATISFACTORY_NOT",
      "icaoReferences": [
        {
          "referenceType": "CC",
          "document": "Chicago Convention",
          "chapter": "Article 37",
          "description": "Adoption of international standards and procedures"
        },
        {
          "referenceType": "STD",
          "document": "Annex 14, Vol I",
          "chapter": "Chapter 1",
          "description": "General - Aerodrome certification"
        },
        {
          "referenceType": "STD",
          "document": "Annex 14, Vol II",
          "chapter": "Chapter 1",
          "description": "General - Heliport certification"
        }
      ]
    },
    {
      "pqNumber": "AGA-8.003",
      "questionTextEn": "Has the State implemented procedures for the amendment of its specific regulations, taking into consideration ICAO provisions and their amendments?",
      "questionTextFr": "L'État a-t-il mis en place des procédures pour la modification de ses règlements spécifiques, en tenant compte des dispositions de l'OACI et de leurs amendements?",
      "auditArea": "AGA",
      "criticalElement": "CE_2",
      "isPriorityPQ": true,
      "requiresOnSite": false,
      "pqStatus": "NO_CHANGE",
      "sortOrder": 2,
      "guidanceEn": "Verify that the State has established a formal process to review and amend its aerodrome regulations when ICAO amends Annex 14 or related documents. Check that there is a documented procedure with defined timelines and responsibilities for updating national regulations.",
      "guidanceFr": "Vérifier que l'État a établi un processus formel pour examiner et modifier ses règlements d'aérodrome lorsque l'OACI modifie l'Annexe 14 ou les documents connexes. Vérifier qu'il existe une procédure documentée avec des délais et des responsabilités définis pour la mise à jour des règlements nationaux.",
      "responseType": "SATISFACTORY_NOT",
      "icaoReferences": [
        {
          "referenceType": "CC",
          "document": "Chicago Convention",
          "chapter": "Article 38",
          "description": "Departures from international standards and procedures"
        },
        {
          "referenceType": "GM",
          "document": "Doc 9734",
          "chapter": "Part A, Chapter 3",
          "description": "Safety Oversight Manual - Specific operating regulations"
        }
      ]
    },
    {
      "pqNumber": "AGA-8.005",
      "questionTextEn": "Has the State promulgated regulations for the certification of aerodromes?",
      "questionTextFr": "L'État a-t-il promulgué des règlements pour la certification des aérodromes?",
      "auditArea": "AGA",
      "criticalElement": "CE_2",
      "isPriorityPQ": true,
      "requiresOnSite": false,
      "pqStatus": "NO_CHANGE",
      "sortOrder": 3,
      "guidanceEn": "Review the regulations to confirm they include requirements for aerodrome certification. The regulations should address the certification process, conditions for granting certificates, certificate validity, renewal procedures, and grounds for suspension or revocation.",
      "guidanceFr": "Examiner les règlements pour confirmer qu'ils incluent des exigences pour la certification des aérodromes. Les règlements doivent traiter du processus de certification, des conditions d'octroi des certificats, de la validité des certificats, des procédures de renouvellement et des motifs de suspension ou de révocation.",
      "responseType": "SATISFACTORY_NOT",
      "icaoReferences": [
        {
          "referenceType": "STD",
          "document": "Annex 14, Vol I",
          "chapter": "Chapter 1, 1.4",
          "description": "Aerodrome certification"
        },
        {
          "referenceType": "GM",
          "document": "Doc 9774",
          "chapter": "Chapter 2",
          "description": "Manual on Certification of Aerodromes"
        }
      ]
    },
    {
      "pqNumber": "AGA-8.007",
      "questionTextEn": "Do the aerodrome regulations include requirements for the establishment and implementation of a safety management system (SMS) by the aerodrome operator?",
      "questionTextFr": "Les règlements d'aérodrome incluent-ils des exigences pour l'établissement et la mise en œuvre d'un système de gestion de la sécurité (SGS) par l'exploitant d'aérodrome?",
      "auditArea": "AGA",
      "criticalElement": "CE_2",
      "isPriorityPQ": true,
      "requiresOnSite": false,
      "pqStatus": "REVISED",
      "sortOrder": 4,
      "guidanceEn": "Verify that the State's aerodrome regulations require certified aerodromes to implement a safety management system. The SMS requirements should be consistent with ICAO Annex 19 and address all four SMS components: safety policy, safety risk management, safety assurance, and safety promotion.",
      "guidanceFr": "Vérifier que les règlements d'aérodrome de l'État exigent que les aérodromes certifiés mettent en œuvre un système de gestion de la sécurité. Les exigences du SGS doivent être conformes à l'Annexe 19 de l'OACI et traiter des quatre composantes du SGS: politique de sécurité, gestion des risques de sécurité, assurance de la sécurité et promotion de la sécurité.",
      "responseType": "SATISFACTORY_NOT",
      "icaoReferences": [
        {
          "referenceType": "STD",
          "document": "Annex 14, Vol I",
          "chapter": "Chapter 1, 1.4.6",
          "description": "Safety management system requirements"
        },
        {
          "referenceType": "STD",
          "document": "Annex 19",
          "chapter": "Chapter 4",
          "description": "Service providers' safety management"
        }
      ]
    },
    {
      "pqNumber": "AGA-8.009",
      "questionTextEn": "Do the aerodrome regulations include requirements for rescue and fire fighting (RFF) services at certified aerodromes?",
      "questionTextFr": "Les règlements d'aérodrome incluent-ils des exigences pour les services de sauvetage et de lutte contre l'incendie (SSLI) dans les aérodromes certifiés?",
      "auditArea": "AGA",
      "criticalElement": "CE_2",
      "isPriorityPQ": true,
      "requiresOnSite": false,
      "pqStatus": "NO_CHANGE",
      "sortOrder": 5,
      "guidanceEn": "Review the regulations to verify they include comprehensive RFF requirements including level of protection, response time objectives, extinguishing agents, equipment, personnel training, and emergency planning. Requirements should be consistent with Annex 14, Chapter 9.",
      "guidanceFr": "Examiner les règlements pour vérifier qu'ils comprennent des exigences complètes en matière de SSLI, notamment le niveau de protection, les objectifs de temps de réponse, les agents extincteurs, l'équipement, la formation du personnel et la planification des urgences. Les exigences doivent être conformes au Chapitre 9 de l'Annexe 14.",
      "responseType": "SATISFACTORY_NOT",
      "icaoReferences": [
        {
          "referenceType": "STD",
          "document": "Annex 14, Vol I",
          "chapter": "Chapter 9",
          "description": "Aerodrome emergency planning and rescue and fire fighting"
        },
        {
          "referenceType": "GM",
          "document": "Doc 9137",
          "chapter": "Part 1",
          "description": "Airport Services Manual - Rescue and Fire Fighting"
        }
      ]
    },
    {
      "pqNumber": "AGA-8.011",
      "questionTextEn": "If the State is involved in the provision of aerodrome facilities and services, is there a clear separation of authority between the State operators and the State regulatory authority?",
      "questionTextFr": "Si l'État est impliqué dans la fourniture d'installations et de services d'aérodrome, existe-t-il une séparation claire des autorités entre les opérateurs de l'État et l'autorité de réglementation de l'État?",
      "auditArea": "AGA",
      "criticalElement": "CE_3",
      "isPriorityPQ": true,
      "requiresOnSite": false,
      "pqStatus": "NO_CHANGE",
      "sortOrder": 6,
      "guidanceEn": "If the State owns or operates aerodromes, verify that there is a clear functional and organizational separation between the aerodrome operator functions and the regulatory oversight functions. Review organizational charts and documentation demonstrating independent decision-making authority for certification and surveillance activities.",
      "guidanceFr": "Si l'État possède ou exploite des aérodromes, vérifier qu'il existe une séparation fonctionnelle et organisationnelle claire entre les fonctions d'exploitation d'aérodrome et les fonctions de surveillance réglementaire. Examiner les organigrammes et la documentation démontrant l'autorité de décision indépendante pour les activités de certification et de surveillance.",
      "responseType": "SATISFACTORY_NOT",
      "icaoReferences": [
        {
          "referenceType": "STD",
          "document": "Annex 14, Vol I",
          "chapter": "Chapter 1, 1.4.1",
          "description": "Certification framework"
        },
        {
          "referenceType": "GM",
          "document": "Doc 9734",
          "chapter": "Part A, Chapter 2",
          "description": "Safety oversight responsibilities"
        }
      ]
    },
    {
      "pqNumber": "AGA-8.015",
      "questionTextEn": "Has the State implemented procedures for identifying and notifying differences, if any, to ICAO?",
      "questionTextFr": "L'État a-t-il mis en œuvre des procédures pour identifier et notifier les différences, le cas échéant, à l'OACI?",
      "auditArea": "AGA",
      "criticalElement": "CE_2",
      "isPriorityPQ": false,
      "requiresOnSite": false,
      "pqStatus": "NO_CHANGE",
      "sortOrder": 7,
      "guidanceEn": "Verify that the State has established procedures for identifying differences between national regulations and ICAO SARPs in Annex 14. Check that the State has notified any significant differences to ICAO through the appropriate means (EFOD system) and that the differences are published in the State's AIP.",
      "guidanceFr": "Vérifier que l'État a établi des procédures pour identifier les différences entre les règlements nationaux et les SARP de l'OACI dans l'Annexe 14. Vérifier que l'État a notifié toute différence significative à l'OACI par les moyens appropriés (système EFOD) et que les différences sont publiées dans l'AIP de l'État.",
      "responseType": "SATISFACTORY_NOT",
      "icaoReferences": [
        {
          "referenceType": "CC",
          "document": "Chicago Convention",
          "chapter": "Article 38",
          "description": "Notification of differences"
        },
        {
          "referenceType": "STD",
          "document": "Annex 15",
          "chapter": "Chapter 5",
          "description": "NOTAM and AIP supplements"
        }
      ]
    },
    {
      "pqNumber": "AGA-8.017",
      "questionTextEn": "Has the State established regulations addressing aerodrome physical characteristics requirements?",
      "questionTextFr": "L'État a-t-il établi des règlements traitant des exigences relatives aux caractéristiques physiques des aérodromes?",
      "auditArea": "AGA",
      "criticalElement": "CE_2",
      "isPriorityPQ": false,
      "requiresOnSite": false,
      "pqStatus": "NO_CHANGE",
      "sortOrder": 8,
      "guidanceEn": "Review the regulations to verify they include requirements for aerodrome physical characteristics such as runway dimensions, runway strips, clearways, stopways, taxiways, aprons, and obstacle limitation surfaces consistent with Annex 14, Chapters 3 and 4.",
      "guidanceFr": "Examiner les règlements pour vérifier qu'ils comprennent des exigences relatives aux caractéristiques physiques des aérodromes telles que les dimensions des pistes, les bandes de piste, les prolongements dégagés, les prolongements d'arrêt, les voies de circulation, les aires de trafic et les surfaces de limitation d'obstacles conformément aux Chapitres 3 et 4 de l'Annexe 14.",
      "responseType": "SATISFACTORY_NOT",
      "icaoReferences": [
        {
          "referenceType": "STD",
          "document": "Annex 14, Vol I",
          "chapter": "Chapter 3",
          "description": "Physical characteristics"
        },
        {
          "referenceType": "STD",
          "document": "Annex 14, Vol I",
          "chapter": "Chapter 4",
          "description": "Obstacle restriction and removal"
        }
      ]
    },
    {
      "pqNumber": "AGA-8.019",
      "questionTextEn": "Has the State established regulations addressing visual aids requirements at aerodromes?",
      "questionTextFr": "L'État a-t-il établi des règlements traitant des exigences relatives aux aides visuelles dans les aérodromes?",
      "auditArea": "AGA",
      "criticalElement": "CE_2",
      "isPriorityPQ": false,
      "requiresOnSite": false,
      "pqStatus": "NO_CHANGE",
      "sortOrder": 9,
      "guidanceEn": "Review the regulations for requirements related to visual aids including markings, lights, signs, and markers. Verify coverage of runway lighting systems, taxiway lighting, approach lighting, and visual approach slope indicator systems consistent with Annex 14, Chapter 5.",
      "guidanceFr": "Examiner les règlements pour les exigences relatives aux aides visuelles, y compris les marquages, les feux, les panneaux et les balises. Vérifier la couverture des systèmes d'éclairage de piste, de l'éclairage des voies de circulation, de l'éclairage d'approche et des systèmes indicateurs de pente d'approche visuels conformément au Chapitre 5 de l'Annexe 14.",
      "responseType": "SATISFACTORY_NOT",
      "icaoReferences": [
        {
          "referenceType": "STD",
          "document": "Annex 14, Vol I",
          "chapter": "Chapter 5",
          "description": "Visual aids for navigation"
        },
        {
          "referenceType": "GM",
          "document": "Doc 9157",
          "chapter": "Part 4",
          "description": "Aerodrome Design Manual - Visual Aids"
        }
      ]
    },
    {
      "pqNumber": "AGA-8.021",
      "questionTextEn": "Has the State established regulations for aerodrome maintenance requirements?",
      "questionTextFr": "L'État a-t-il établi des règlements pour les exigences de maintenance des aérodromes?",
      "auditArea": "AGA",
      "criticalElement": "CE_2",
      "isPriorityPQ": false,
      "requiresOnSite": false,
      "pqStatus": "NO_CHANGE",
      "sortOrder": 10,
      "guidanceEn": "Review the regulations for maintenance requirements including pavement maintenance, visual aids maintenance, drainage systems, and electrical systems. Verify that maintenance programmes are required to be documented and approved as part of the aerodrome certification process.",
      "guidanceFr": "Examiner les règlements pour les exigences de maintenance, y compris la maintenance des chaussées, des aides visuelles, des systèmes de drainage et des systèmes électriques. Vérifier que les programmes de maintenance doivent être documentés et approuvés dans le cadre du processus de certification de l'aérodrome.",
      "responseType": "SATISFACTORY_NOT",
      "icaoReferences": [
        {
          "referenceType": "STD",
          "document": "Annex 14, Vol I",
          "chapter": "Chapter 10",
          "description": "Aerodrome maintenance"
        },
        {
          "referenceType": "GM",
          "document": "Doc 9137",
          "chapter": "Part 9",
          "description": "Airport Services Manual - Aerodrome Maintenance Practices"
        }
      ]
    },
    {
      "pqNumber": "AGA-8.031",
      "questionTextEn": "Has the State established an organizational structure for airport certification and surveillance activities?",
      "questionTextFr": "L'État a-t-il établi une structure organisationnelle pour les activités de certification et de surveillance des aéroports?",
      "auditArea": "AGA",
      "criticalElement": "CE_3",
      "isPriorityPQ": false,
      "requiresOnSite": false,
      "pqStatus": "NO_CHANGE",
      "sortOrder": 11,
      "guidanceEn": "Review the organizational structure of the aerodrome regulatory authority. Verify that a dedicated unit or section exists for aerodrome certification and surveillance with clearly defined reporting lines and authorities.",
      "guidanceFr": "Examiner la structure organisationnelle de l'autorité de réglementation des aérodromes. Vérifier qu'une unité ou section dédiée existe pour la certification et la surveillance des aérodromes avec des lignes hiérarchiques et des autorités clairement définies.",
      "responseType": "SATISFACTORY_NOT",
      "icaoReferences": [
        {
          "referenceType": "GM",
          "document": "Doc 9734",
          "chapter": "Part A, Chapter 3",
          "description": "State civil aviation system"
        },
        {
          "referenceType": "GM",
          "document": "Doc 9774",
          "chapter": "Chapter 2",
          "description": "Certification organization structure"
        }
      ]
    },
    {
      "pqNumber": "AGA-8.033",
      "questionTextEn": "Are all the functions and responsibilities of the aerodrome regulatory authority clearly defined?",
      "questionTextFr": "Toutes les fonctions et responsabilités de l'autorité de réglementation des aérodromes sont-elles clairement définies?",
      "auditArea": "AGA",
      "criticalElement": "CE_3",
      "isPriorityPQ": false,
      "requiresOnSite": false,
      "pqStatus": "NO_CHANGE",
      "sortOrder": 12,
      "guidanceEn": "Review documented functions and responsibilities of the aerodrome regulatory authority. Verify that responsibilities include regulation development, certification, surveillance, enforcement actions, and coordination with other relevant authorities.",
      "guidanceFr": "Examiner les fonctions et responsabilités documentées de l'autorité de réglementation des aérodromes. Vérifier que les responsabilités incluent l'élaboration de règlements, la certification, la surveillance, les actions d'application et la coordination avec d'autres autorités concernées.",
      "responseType": "SATISFACTORY_NOT",
      "icaoReferences": [
        {
          "referenceType": "GM",
          "document": "Doc 9734",
          "chapter": "Part A, Chapter 3",
          "description": "Safety oversight functions"
        }
      ]
    },
    {
      "pqNumber": "AGA-8.035",
      "questionTextEn": "Have job descriptions been developed for technical staff and key management personnel of the aerodrome regulatory authority?",
      "questionTextFr": "Des descriptions de poste ont-elles été élaborées pour le personnel technique et le personnel de direction clé de l'autorité de réglementation des aérodromes?",
      "auditArea": "AGA",
      "criticalElement": "CE_3",
      "isPriorityPQ": false,
      "requiresOnSite": false,
      "pqStatus": "NO_CHANGE",
      "sortOrder": 13,
      "guidanceEn": "Review job descriptions for aerodrome inspectors and key management positions. Verify that job descriptions include required qualifications, experience, responsibilities, and reporting relationships.",
      "guidanceFr": "Examiner les descriptions de poste pour les inspecteurs d'aérodrome et les postes de direction clés. Vérifier que les descriptions de poste incluent les qualifications requises, l'expérience, les responsabilités et les relations hiérarchiques.",
      "responseType": "SATISFACTORY_NOT",
      "icaoReferences": [
        {
          "referenceType": "GM",
          "document": "Doc 9734",
          "chapter": "Part A, Chapter 4",
          "description": "Technical personnel qualification"
        }
      ]
    },
    {
      "pqNumber": "AGA-8.037",
      "questionTextEn": "Has the State established procedures for cooperation between the aerodrome regulatory authority and other relevant State authorities?",
      "questionTextFr": "L'État a-t-il établi des procédures de coopération entre l'autorité de réglementation des aérodromes et d'autres autorités étatiques concernées?",
      "auditArea": "AGA",
      "criticalElement": "CE_3",
      "isPriorityPQ": false,
      "requiresOnSite": false,
      "pqStatus": "NO_CHANGE",
      "sortOrder": 14,
      "guidanceEn": "Review coordination procedures and agreements between the aerodrome authority and other relevant authorities such as ATS providers, meteorological services, AIS, security agencies, and environmental agencies. Verify that formal coordination mechanisms exist.",
      "guidanceFr": "Examiner les procédures de coordination et les accords entre l'autorité des aérodromes et d'autres autorités concernées telles que les fournisseurs de services ATS, les services météorologiques, l'AIS, les agences de sécurité et les agences environnementales. Vérifier que des mécanismes de coordination formels existent.",
      "responseType": "SATISFACTORY_NOT",
      "icaoReferences": [
        {
          "referenceType": "GM",
          "document": "Doc 9734",
          "chapter": "Part A, Chapter 3",
          "description": "State civil aviation system coordination"
        }
      ]
    },
    {
      "pqNumber": "AGA-8.039",
      "questionTextEn": "Does the aerodrome regulatory authority have sufficient human resources to carry out its functions and mandate?",
      "questionTextFr": "L'autorité de réglementation des aérodromes dispose-t-elle de ressources humaines suffisantes pour remplir ses fonctions et son mandat?",
      "auditArea": "AGA",
      "criticalElement": "CE_3",
      "isPriorityPQ": true,
      "requiresOnSite": true,
      "pqStatus": "NO_CHANGE",
      "sortOrder": 15,
      "guidanceEn": "Review the staffing levels of the aerodrome regulatory authority against the scope of certification and surveillance activities required. Assess whether the number of qualified inspectors is adequate to conduct initial certifications, renewals, and routine surveillance of all certified aerodromes.",
      "guidanceFr": "Examiner les niveaux de dotation en personnel de l'autorité de réglementation des aérodromes par rapport à l'étendue des activités de certification et de surveillance requises. Évaluer si le nombre d'inspecteurs qualifiés est adéquat pour effectuer les certifications initiales, les renouvellements et la surveillance de routine de tous les aérodromes certifiés.",
      "responseType": "SATISFACTORY_NOT",
      "icaoReferences": [
        {
          "referenceType": "GM",
          "document": "Doc 9734",
          "chapter": "Part A, Chapter 3",
          "description": "Adequate resources for safety oversight"
        }
      ]
    },
    {
      "pqNumber": "AGA-8.040",
      "questionTextEn": "Has the State established appropriate minimum qualification and experience requirements for the technical staff?",
      "questionTextFr": "L'État a-t-il établi des exigences minimales appropriées de qualification et d'expérience pour le personnel technique?",
      "auditArea": "AGA",
      "criticalElement": "CE_4",
      "isPriorityPQ": false,
      "requiresOnSite": false,
      "pqStatus": "NO_CHANGE",
      "sortOrder": 16,
      "guidanceEn": "Review the minimum qualification requirements for aerodrome inspectors including educational background, technical knowledge, and relevant experience in aerodrome operations or engineering. Requirements should include familiarity with ICAO SARPs and national regulations.",
      "guidanceFr": "Examiner les exigences minimales de qualification pour les inspecteurs d'aérodrome, y compris la formation académique, les connaissances techniques et l'expérience pertinente dans les opérations ou l'ingénierie aéroportuaire. Les exigences devraient inclure la familiarité avec les SARP de l'OACI et les règlements nationaux.",
      "responseType": "SATISFACTORY_NOT",
      "icaoReferences": [
        {
          "referenceType": "GM",
          "document": "Doc 9734",
          "chapter": "Part A, Chapter 4",
          "description": "Qualification requirements for technical personnel"
        }
      ]
    },
    {
      "pqNumber": "AGA-8.042",
      "questionTextEn": "Does the State ensure that the established minimum qualification and experience requirements are met by all technical staff?",
      "questionTextFr": "L'État s'assure-t-il que les exigences minimales établies en matière de qualification et d'expérience sont respectées par tout le personnel technique?",
      "auditArea": "AGA",
      "criticalElement": "CE_4",
      "isPriorityPQ": false,
      "requiresOnSite": true,
      "pqStatus": "NO_CHANGE",
      "sortOrder": 17,
      "guidanceEn": "Review personnel records of aerodrome inspectors to verify compliance with minimum qualification requirements. Check that qualifications are verified during recruitment and maintained throughout employment.",
      "guidanceFr": "Examiner les dossiers du personnel des inspecteurs d'aérodrome pour vérifier la conformité aux exigences minimales de qualification. Vérifier que les qualifications sont vérifiées lors du recrutement et maintenues tout au long de l'emploi.",
      "responseType": "SATISFACTORY_NOT",
      "icaoReferences": [
        {
          "referenceType": "GM",
          "document": "Doc 9734",
          "chapter": "Part A, Chapter 4",
          "description": "Verification of personnel qualifications"
        }
      ]
    },
    {
      "pqNumber": "AGA-8.045",
      "questionTextEn": "Has the State established an initial training programme for aerodrome inspectors?",
      "questionTextFr": "L'État a-t-il établi un programme de formation initiale pour les inspecteurs d'aérodrome?",
      "auditArea": "AGA",
      "criticalElement": "CE_4",
      "isPriorityPQ": false,
      "requiresOnSite": false,
      "pqStatus": "NO_CHANGE",
      "sortOrder": 18,
      "guidanceEn": "Review the initial training programme for new aerodrome inspectors. The programme should cover ICAO SARPs, national regulations, certification procedures, inspection techniques, and surveillance methodologies. Training records should document completion of required modules.",
      "guidanceFr": "Examiner le programme de formation initiale pour les nouveaux inspecteurs d'aérodrome. Le programme devrait couvrir les SARP de l'OACI, les règlements nationaux, les procédures de certification, les techniques d'inspection et les méthodologies de surveillance. Les dossiers de formation devraient documenter l'achèvement des modules requis.",
      "responseType": "SATISFACTORY_NOT",
      "icaoReferences": [
        {
          "referenceType": "GM",
          "document": "Doc 9734",
          "chapter": "Part A, Chapter 4",
          "description": "Training programmes for technical personnel"
        }
      ]
    },
    {
      "pqNumber": "AGA-8.047",
      "questionTextEn": "Has the State established a recurrent training programme for aerodrome inspectors?",
      "questionTextFr": "L'État a-t-il établi un programme de formation périodique pour les inspecteurs d'aérodrome?",
      "auditArea": "AGA",
      "criticalElement": "CE_4",
      "isPriorityPQ": false,
      "requiresOnSite": false,
      "pqStatus": "NO_CHANGE",
      "sortOrder": 19,
      "guidanceEn": "Review the recurrent training programme for aerodrome inspectors including frequency requirements and content. The programme should address updates to ICAO provisions, changes to national regulations, lessons learned from audits, and emerging safety issues.",
      "guidanceFr": "Examiner le programme de formation périodique pour les inspecteurs d'aérodrome, y compris les exigences de fréquence et le contenu. Le programme devrait traiter des mises à jour des dispositions de l'OACI, des changements aux règlements nationaux, des leçons tirées des audits et des problèmes de sécurité émergents.",
      "responseType": "SATISFACTORY_NOT",
      "icaoReferences": [
        {
          "referenceType": "GM",
          "document": "Doc 9734",
          "chapter": "Part A, Chapter 4",
          "description": "Recurrent training requirements"
        }
      ]
    },
    {
      "pqNumber": "AGA-8.049",
      "questionTextEn": "Does the State maintain training records for aerodrome regulatory authority technical staff?",
      "questionTextFr": "L'État tient-il des dossiers de formation pour le personnel technique de l'autorité de réglementation des aérodromes?",
      "auditArea": "AGA",
      "criticalElement": "CE_4",
      "isPriorityPQ": false,
      "requiresOnSite": true,
      "pqStatus": "NO_CHANGE",
      "sortOrder": 20,
      "guidanceEn": "Review training records for aerodrome inspectors to verify that initial and recurrent training has been completed. Records should include training dates, course content, and any certifications or authorizations granted.",
      "guidanceFr": "Examiner les dossiers de formation des inspecteurs d'aérodrome pour vérifier que la formation initiale et périodique a été effectuée. Les dossiers devraient inclure les dates de formation, le contenu des cours et toute certification ou autorisation accordée.",
      "responseType": "SATISFACTORY_NOT",
      "icaoReferences": [
        {
          "referenceType": "GM",
          "document": "Doc 9734",
          "chapter": "Part A, Chapter 4",
          "description": "Training records maintenance"
        }
      ]
    },
    {
      "pqNumber": "AGA-8.061",
      "questionTextEn": "Has the State developed technical guidance material for aerodrome certification?",
      "questionTextFr": "L'État a-t-il élaboré du matériel d'orientation technique pour la certification des aérodromes?",
      "auditArea": "AGA",
      "criticalElement": "CE_5",
      "isPriorityPQ": false,
      "requiresOnSite": false,
      "pqStatus": "NO_CHANGE",
      "sortOrder": 21,
      "guidanceEn": "Review technical guidance material available to aerodrome inspectors and operators. This should include guidance on certification requirements, acceptable means of compliance, and interpretation of standards. Material should be consistent with ICAO guidance documents.",
      "guidanceFr": "Examiner le matériel d'orientation technique disponible pour les inspecteurs d'aérodrome et les exploitants. Cela devrait inclure des orientations sur les exigences de certification, les moyens acceptables de conformité et l'interprétation des normes. Le matériel devrait être conforme aux documents d'orientation de l'OACI.",
      "responseType": "SATISFACTORY_NOT",
      "icaoReferences": [
        {
          "referenceType": "GM",
          "document": "Doc 9774",
          "chapter": "Chapter 3",
          "description": "Technical guidance for certification"
        },
        {
          "referenceType": "GM",
          "document": "Doc 9157",
          "chapter": "Parts 1-6",
          "description": "Aerodrome Design Manual"
        }
      ]
    },
    {
      "pqNumber": "AGA-8.063",
      "questionTextEn": "Has the State developed procedures and checklists for aerodrome certification inspections?",
      "questionTextFr": "L'État a-t-il élaboré des procédures et des listes de contrôle pour les inspections de certification des aérodromes?",
      "auditArea": "AGA",
      "criticalElement": "CE_5",
      "isPriorityPQ": false,
      "requiresOnSite": false,
      "pqStatus": "NO_CHANGE",
      "sortOrder": 22,
      "guidanceEn": "Review inspection procedures and checklists used during aerodrome certification. These should systematically address all certification requirements including physical characteristics, visual aids, RFF services, emergency planning, and SMS implementation.",
      "guidanceFr": "Examiner les procédures d'inspection et les listes de contrôle utilisées lors de la certification des aérodromes. Celles-ci devraient aborder systématiquement toutes les exigences de certification, y compris les caractéristiques physiques, les aides visuelles, les services SSLI, la planification d'urgence et la mise en œuvre du SGS.",
      "responseType": "SATISFACTORY_NOT",
      "icaoReferences": [
        {
          "referenceType": "GM",
          "document": "Doc 9774",
          "chapter": "Chapter 4",
          "description": "Certification inspection procedures"
        }
      ]
    },
    {
      "pqNumber": "AGA-8.065",
      "questionTextEn": "Has the State developed procedures and checklists for aerodrome surveillance inspections?",
      "questionTextFr": "L'État a-t-il élaboré des procédures et des listes de contrôle pour les inspections de surveillance des aérodromes?",
      "auditArea": "AGA",
      "criticalElement": "CE_5",
      "isPriorityPQ": false,
      "requiresOnSite": false,
      "pqStatus": "NO_CHANGE",
      "sortOrder": 23,
      "guidanceEn": "Review surveillance inspection procedures and checklists. These should address routine inspections, special inspections, and follow-up inspections. Checklists should cover all aspects of aerodrome operations requiring continuous monitoring.",
      "guidanceFr": "Examiner les procédures d'inspection de surveillance et les listes de contrôle. Celles-ci devraient aborder les inspections de routine, les inspections spéciales et les inspections de suivi. Les listes de contrôle devraient couvrir tous les aspects des opérations d'aérodrome nécessitant une surveillance continue.",
      "responseType": "SATISFACTORY_NOT",
      "icaoReferences": [
        {
          "referenceType": "GM",
          "document": "Doc 9774",
          "chapter": "Chapter 5",
          "description": "Surveillance procedures"
        }
      ]
    },
    {
      "pqNumber": "AGA-8.081",
      "questionTextEn": "Has the State established a system for the certification of aerodromes used for international operations?",
      "questionTextFr": "L'État a-t-il établi un système de certification des aérodromes utilisés pour les opérations internationales?",
      "auditArea": "AGA",
      "criticalElement": "CE_6",
      "isPriorityPQ": true,
      "requiresOnSite": false,
      "pqStatus": "NO_CHANGE",
      "sortOrder": 24,
      "guidanceEn": "Verify that the State has implemented a comprehensive aerodrome certification system as required by Annex 14. The system should include application procedures, assessment criteria, certificate issuance, validity periods, and renewal procedures.",
      "guidanceFr": "Vérifier que l'État a mis en place un système complet de certification des aérodromes comme l'exige l'Annexe 14. Le système devrait inclure les procédures de demande, les critères d'évaluation, la délivrance des certificats, les périodes de validité et les procédures de renouvellement.",
      "responseType": "SATISFACTORY_NOT",
      "icaoReferences": [
        {
          "referenceType": "STD",
          "document": "Annex 14, Vol I",
          "chapter": "Chapter 1, 1.4",
          "description": "Aerodrome certification requirement"
        },
        {
          "referenceType": "GM",
          "document": "Doc 9774",
          "chapter": "Chapter 2",
          "description": "Certification system establishment"
        }
      ]
    },
    {
      "pqNumber": "AGA-8.083",
      "questionTextEn": "Does the State ensure that all aerodromes open to public use and used for international operations are certified?",
      "questionTextFr": "L'État s'assure-t-il que tous les aérodromes ouverts à l'usage public et utilisés pour les opérations internationales sont certifiés?",
      "auditArea": "AGA",
      "criticalElement": "CE_6",
      "isPriorityPQ": true,
      "requiresOnSite": true,
      "pqStatus": "NO_CHANGE",
      "sortOrder": 25,
      "guidanceEn": "Review the list of certified aerodromes against the list of aerodromes used for international operations. Verify that all required aerodromes hold valid aerodrome certificates and that the certification process was properly completed.",
      "guidanceFr": "Comparer la liste des aérodromes certifiés avec la liste des aérodromes utilisés pour les opérations internationales. Vérifier que tous les aérodromes requis détiennent des certificats d'aérodrome valides et que le processus de certification a été correctement effectué.",
      "responseType": "SATISFACTORY_NOT",
      "icaoReferences": [
        {
          "referenceType": "STD",
          "document": "Annex 14, Vol I",
          "chapter": "Chapter 1, 1.4.1",
          "description": "Certification of international aerodromes"
        }
      ]
    },
    {
      "pqNumber": "AGA-8.085",
      "questionTextEn": "Does the aerodrome certificate include all the necessary information and conditions?",
      "questionTextFr": "Le certificat d'aérodrome inclut-il toutes les informations et conditions nécessaires?",
      "auditArea": "AGA",
      "criticalElement": "CE_6",
      "isPriorityPQ": false,
      "requiresOnSite": true,
      "pqStatus": "NO_CHANGE",
      "sortOrder": 26,
      "guidanceEn": "Review sample aerodrome certificates to verify they include all required information: certificate holder, aerodrome location, reference code, types of operations authorized, special limitations, validity period, and any conditions attached to the certificate.",
      "guidanceFr": "Examiner des échantillons de certificats d'aérodrome pour vérifier qu'ils incluent toutes les informations requises: titulaire du certificat, emplacement de l'aérodrome, code de référence, types d'opérations autorisées, limitations spéciales, période de validité et toutes conditions attachées au certificat.",
      "responseType": "SATISFACTORY_NOT",
      "icaoReferences": [
        {
          "referenceType": "STD",
          "document": "Annex 14, Vol I",
          "chapter": "Chapter 1, 1.4.3",
          "description": "Certificate contents"
        },
        {
          "referenceType": "GM",
          "document": "Doc 9774",
          "chapter": "Chapter 3",
          "description": "Certificate format and content"
        }
      ]
    },
    {
      "pqNumber": "AGA-8.087",
      "questionTextEn": "Does the State require the aerodrome operator to develop and maintain an aerodrome manual?",
      "questionTextFr": "L'État exige-t-il que l'exploitant d'aérodrome élabore et maintienne un manuel d'aérodrome?",
      "auditArea": "AGA",
      "criticalElement": "CE_6",
      "isPriorityPQ": false,
      "requiresOnSite": false,
      "pqStatus": "NO_CHANGE",
      "sortOrder": 27,
      "guidanceEn": "Verify that regulations require certified aerodromes to maintain an aerodrome manual. Review requirements for manual content, approval procedures, and update mechanisms. The manual should document all operational procedures and compliance with certification requirements.",
      "guidanceFr": "Vérifier que les règlements exigent que les aérodromes certifiés maintiennent un manuel d'aérodrome. Examiner les exigences relatives au contenu du manuel, aux procédures d'approbation et aux mécanismes de mise à jour. Le manuel devrait documenter toutes les procédures opérationnelles et la conformité aux exigences de certification.",
      "responseType": "SATISFACTORY_NOT",
      "icaoReferences": [
        {
          "referenceType": "STD",
          "document": "Annex 14, Vol I",
          "chapter": "Chapter 1, 1.4.4",
          "description": "Aerodrome manual requirement"
        },
        {
          "referenceType": "GM",
          "document": "Doc 9774",
          "chapter": "Chapter 4",
          "description": "Aerodrome manual contents"
        }
      ]
    },
    {
      "pqNumber": "AGA-8.091",
      "questionTextEn": "Has the State established procedures for granting exemptions from aerodrome certification requirements?",
      "questionTextFr": "L'État a-t-il établi des procédures pour accorder des exemptions aux exigences de certification des aérodromes?",
      "auditArea": "AGA",
      "criticalElement": "CE_6",
      "isPriorityPQ": false,
      "requiresOnSite": false,
      "pqStatus": "NO_CHANGE",
      "sortOrder": 28,
      "guidanceEn": "Review the exemption process including application requirements, assessment criteria, risk mitigation measures, time limitations, and approval authority. Exemptions should only be granted when an equivalent level of safety can be demonstrated.",
      "guidanceFr": "Examiner le processus d'exemption, y compris les exigences de demande, les critères d'évaluation, les mesures d'atténuation des risques, les limitations de temps et l'autorité d'approbation. Les exemptions ne devraient être accordées que lorsqu'un niveau de sécurité équivalent peut être démontré.",
      "responseType": "SATISFACTORY_NOT",
      "icaoReferences": [
        {
          "referenceType": "GM",
          "document": "Doc 9774",
          "chapter": "Chapter 6",
          "description": "Exemptions and deviations"
        }
      ]
    },
    {
      "pqNumber": "AGA-8.111",
      "questionTextEn": "Has the State established a surveillance programme for certified aerodromes?",
      "questionTextFr": "L'État a-t-il établi un programme de surveillance pour les aérodromes certifiés?",
      "auditArea": "AGA",
      "criticalElement": "CE_7",
      "isPriorityPQ": true,
      "requiresOnSite": false,
      "pqStatus": "NO_CHANGE",
      "sortOrder": 29,
      "guidanceEn": "Review the State's surveillance programme for certified aerodromes. The programme should define inspection types, frequencies, scope, and resources required. It should include provisions for both routine and unannounced inspections.",
      "guidanceFr": "Examiner le programme de surveillance de l'État pour les aérodromes certifiés. Le programme devrait définir les types d'inspection, les fréquences, la portée et les ressources requises. Il devrait inclure des dispositions pour les inspections de routine et les inspections inopinées.",
      "responseType": "SATISFACTORY_NOT",
      "icaoReferences": [
        {
          "referenceType": "STD",
          "document": "Annex 14, Vol I",
          "chapter": "Chapter 1, 1.4",
          "description": "Ongoing surveillance requirements"
        },
        {
          "referenceType": "GM",
          "document": "Doc 9774",
          "chapter": "Chapter 5",
          "description": "Surveillance programme establishment"
        }
      ]
    },
    {
      "pqNumber": "AGA-8.113",
      "questionTextEn": "Does the State conduct periodic surveillance inspections of certified aerodromes?",
      "questionTextFr": "L'État effectue-t-il des inspections de surveillance périodiques des aérodromes certifiés?",
      "auditArea": "AGA",
      "criticalElement": "CE_7",
      "isPriorityPQ": true,
      "requiresOnSite": true,
      "pqStatus": "NO_CHANGE",
      "sortOrder": 30,
      "guidanceEn": "Review surveillance inspection records to verify that periodic inspections are being conducted according to the established programme. Check that all certified aerodromes are included in the surveillance schedule and that inspections are documented.",
      "guidanceFr": "Examiner les dossiers d'inspection de surveillance pour vérifier que des inspections périodiques sont effectuées conformément au programme établi. Vérifier que tous les aérodromes certifiés sont inclus dans le calendrier de surveillance et que les inspections sont documentées.",
      "responseType": "SATISFACTORY_NOT",
      "icaoReferences": [
        {
          "referenceType": "GM",
          "document": "Doc 9774",
          "chapter": "Chapter 5",
          "description": "Periodic surveillance inspections"
        }
      ]
    },
    {
      "pqNumber": "AGA-8.115",
      "questionTextEn": "Does the State surveillance programme include verification of the aerodrome operator's SMS?",
      "questionTextFr": "Le programme de surveillance de l'État inclut-il la vérification du SGS de l'exploitant d'aérodrome?",
      "auditArea": "AGA",
      "criticalElement": "CE_7",
      "isPriorityPQ": true,
      "requiresOnSite": true,
      "pqStatus": "REVISED",
      "sortOrder": 31,
      "guidanceEn": "Verify that the surveillance programme includes assessment of the aerodrome operator's SMS implementation and effectiveness. Review inspection procedures for SMS evaluation including safety policy, risk management processes, safety assurance activities, and safety promotion.",
      "guidanceFr": "Vérifier que le programme de surveillance inclut l'évaluation de la mise en œuvre et de l'efficacité du SGS de l'exploitant d'aérodrome. Examiner les procédures d'inspection pour l'évaluation du SGS, y compris la politique de sécurité, les processus de gestion des risques, les activités d'assurance de la sécurité et la promotion de la sécurité.",
      "responseType": "SATISFACTORY_NOT",
      "icaoReferences": [
        {
          "referenceType": "STD",
          "document": "Annex 19",
          "chapter": "Chapter 3",
          "description": "State safety oversight of service providers' SMS"
        },
        {
          "referenceType": "GM",
          "document": "Doc 9859",
          "chapter": "Chapter 9",
          "description": "SMS oversight by the State"
        }
      ]
    },
    {
      "pqNumber": "AGA-8.117",
      "questionTextEn": "Does the State maintain records of surveillance inspections?",
      "questionTextFr": "L'État tient-il des registres des inspections de surveillance?",
      "auditArea": "AGA",
      "criticalElement": "CE_7",
      "isPriorityPQ": false,
      "requiresOnSite": true,
      "pqStatus": "NO_CHANGE",
      "sortOrder": 32,
      "guidanceEn": "Review the system for maintaining surveillance inspection records. Records should include inspection dates, inspectors assigned, areas inspected, findings, and follow-up actions required. Verify that records are retained for an appropriate period.",
      "guidanceFr": "Examiner le système de maintien des registres d'inspection de surveillance. Les registres devraient inclure les dates d'inspection, les inspecteurs assignés, les zones inspectées, les constatations et les actions de suivi requises. Vérifier que les registres sont conservés pendant une période appropriée.",
      "responseType": "SATISFACTORY_NOT",
      "icaoReferences": [
        {
          "referenceType": "GM",
          "document": "Doc 9774",
          "chapter": "Chapter 5",
          "description": "Record keeping requirements"
        }
      ]
    },
    {
      "pqNumber": "AGA-8.141",
      "questionTextEn": "Has the State established procedures for identifying and resolving safety concerns at certified aerodromes?",
      "questionTextFr": "L'État a-t-il établi des procédures pour identifier et résoudre les problèmes de sécurité dans les aérodromes certifiés?",
      "auditArea": "AGA",
      "criticalElement": "CE_8",
      "isPriorityPQ": true,
      "requiresOnSite": false,
      "pqStatus": "NO_CHANGE",
      "sortOrder": 33,
      "guidanceEn": "Review procedures for identifying and addressing safety deficiencies found during surveillance activities. Procedures should include mechanisms for documenting findings, requiring corrective actions, setting timelines, and verifying implementation.",
      "guidanceFr": "Examiner les procédures pour identifier et traiter les déficiences de sécurité constatées lors des activités de surveillance. Les procédures devraient inclure des mécanismes pour documenter les constatations, exiger des actions correctives, fixer des délais et vérifier la mise en œuvre.",
      "responseType": "SATISFACTORY_NOT",
      "icaoReferences": [
        {
          "referenceType": "GM",
          "document": "Doc 9734",
          "chapter": "Part A, Chapter 8",
          "description": "Resolution of safety concerns"
        },
        {
          "referenceType": "GM",
          "document": "Doc 9774",
          "chapter": "Chapter 7",
          "description": "Enforcement procedures"
        }
      ]
    },
    {
      "pqNumber": "AGA-8.143",
      "questionTextEn": "Does the State have enforcement procedures for non-compliance with aerodrome certification requirements?",
      "questionTextFr": "L'État dispose-t-il de procédures d'application pour le non-respect des exigences de certification des aérodromes?",
      "auditArea": "AGA",
      "criticalElement": "CE_8",
      "isPriorityPQ": true,
      "requiresOnSite": false,
      "pqStatus": "NO_CHANGE",
      "sortOrder": 34,
      "guidanceEn": "Review enforcement procedures available to the aerodrome regulatory authority including warnings, conditions on certificates, suspension, and revocation. Procedures should be proportionate to the severity of non-compliance and include due process provisions.",
      "guidanceFr": "Examiner les procédures d'application disponibles pour l'autorité de réglementation des aérodromes, y compris les avertissements, les conditions sur les certificats, la suspension et la révocation. Les procédures devraient être proportionnées à la gravité du non-respect et inclure des dispositions de procédure régulière.",
      "responseType": "SATISFACTORY_NOT",
      "icaoReferences": [
        {
          "referenceType": "GM",
          "document": "Doc 9774",
          "chapter": "Chapter 7",
          "description": "Enforcement actions"
        }
      ]
    },
    {
      "pqNumber": "AGA-8.145",
      "questionTextEn": "Does the State track corrective actions required of aerodrome operators to closure?",
      "questionTextFr": "L'État suit-il les actions correctives requises des exploitants d'aérodrome jusqu'à leur clôture?",
      "auditArea": "AGA",
      "criticalElement": "CE_8",
      "isPriorityPQ": false,
      "requiresOnSite": true,
      "pqStatus": "NO_CHANGE",
      "sortOrder": 35,
      "guidanceEn": "Review the tracking system for corrective actions. Verify that the State monitors the implementation of required corrective actions, conducts follow-up inspections when necessary, and maintains records of closure status for all identified deficiencies.",
      "guidanceFr": "Examiner le système de suivi des actions correctives. Vérifier que l'État surveille la mise en œuvre des actions correctives requises, effectue des inspections de suivi si nécessaire et maintient des registres de l'état de clôture pour toutes les déficiences identifiées.",
      "responseType": "SATISFACTORY_NOT",
      "icaoReferences": [
        {
          "referenceType": "GM",
          "document": "Doc 9734",
          "chapter": "Part A, Chapter 8",
          "description": "Corrective action follow-up"
        }
      ]
    }
  ]
}

```

# prisma/seed-data/sms-canso-2024.json

```json
{
  "questionnaire": {
    "code": "CANSO-SOE-2024",
    "type": "SMS_CANSO_SOE",
    "version": "2024",
    "titleEn": "CANSO Standard of Excellence in Safety Management Systems 2024",
    "titleFr": "Norme d'Excellence CANSO en Systèmes de Gestion de la Sécurité 2024",
    "descriptionEn": "The CANSO Standard of Excellence (SoE) provides a framework for assessing the maturity of Safety Management Systems in Air Navigation Service Providers. Organizations are rated from Level A (Informal) to Level E (Excellence) across 4 SMS components and 12 study areas.",
    "descriptionFr": "La Norme d'Excellence (SoE) de CANSO fournit un cadre pour évaluer la maturité des Systèmes de Gestion de la Sécurité chez les Fournisseurs de Services de Navigation Aérienne. Les organisations sont notées du Niveau A (Informel) au Niveau E (Excellence) à travers 4 composantes SGS et 12 domaines d'étude.",
    "effectiveDate": "2024-01-01"
  },
  "categories": [
    {
      "code": "SMS-C1",
      "sortOrder": 1,
      "nameEn": "Component 1: Safety Policy and Objectives",
      "nameFr": "Composante 1: Politique et Objectifs de Sécurité",
      "descriptionEn": "Safety policy, accountabilities, coordination, SMS documentation, and management commitment. This component establishes the foundation for the SMS including the safety culture enabler.",
      "descriptionFr": "Politique de sécurité, responsabilités, coordination, documentation SGS et engagement de la direction. Cette composante établit les fondements du SGS, y compris le catalyseur de culture de sécurité.",
      "smsComponent": "SAFETY_POLICY_OBJECTIVES"
    },
    {
      "code": "SMS-C1-SA1.1",
      "sortOrder": 2,
      "nameEn": "Study Area 1.1: Safety Culture Enabler",
      "nameFr": "Domaine d'Étude 1.1: Catalyseur de Culture de Sécurité",
      "descriptionEn": "Assessment of the organization's safety culture maturity as a foundation for effective SMS implementation.",
      "descriptionFr": "Évaluation de la maturité de la culture de sécurité de l'organisation comme fondement pour une mise en œuvre efficace du SGS.",
      "smsComponent": "SAFETY_POLICY_OBJECTIVES",
      "studyArea": "SA_1_1"
    },
    {
      "code": "SMS-C1-SA1.2",
      "sortOrder": 3,
      "nameEn": "Study Area 1.2: Safety Policy (ICAO Element 1.1)",
      "nameFr": "Domaine d'Étude 1.2: Politique de Sécurité (Élément OACI 1.1)",
      "descriptionEn": "Management commitment to safety, allocation of resources, and establishment of safety policy statement.",
      "descriptionFr": "Engagement de la direction envers la sécurité, allocation des ressources et établissement de la déclaration de politique de sécurité.",
      "smsComponent": "SAFETY_POLICY_OBJECTIVES",
      "studyArea": "SA_1_2"
    },
    {
      "code": "SMS-C1-SA1.3",
      "sortOrder": 4,
      "nameEn": "Study Area 1.3: Safety Accountabilities (ICAO Elements 1.2 & 1.3)",
      "nameFr": "Domaine d'Étude 1.3: Responsabilités de Sécurité (Éléments OACI 1.2 & 1.3)",
      "descriptionEn": "Definition of accountabilities and responsibilities for safety management, including the accountable executive.",
      "descriptionFr": "Définition des responsabilités pour la gestion de la sécurité, y compris le dirigeant responsable.",
      "smsComponent": "SAFETY_POLICY_OBJECTIVES",
      "studyArea": "SA_1_3"
    },
    {
      "code": "SMS-C1-SA1.4",
      "sortOrder": 5,
      "nameEn": "Study Area 1.4: Coordination of Emergency Response Planning (ICAO Element 1.4)",
      "nameFr": "Domaine d'Étude 1.4: Coordination de la Planification des Interventions d'Urgence (Élément OACI 1.4)",
      "descriptionEn": "Emergency response planning coordination with relevant organizations and stakeholders.",
      "descriptionFr": "Coordination de la planification des interventions d'urgence avec les organisations et parties prenantes concernées.",
      "smsComponent": "SAFETY_POLICY_OBJECTIVES",
      "studyArea": "SA_1_4"
    },
    {
      "code": "SMS-C1-SA1.5",
      "sortOrder": 6,
      "nameEn": "Study Area 1.5: SMS Documentation (ICAO Element 1.5)",
      "nameFr": "Domaine d'Étude 1.5: Documentation SGS (Élément OACI 1.5)",
      "descriptionEn": "Documentation of SMS components, processes, and procedures in a comprehensive SMS manual.",
      "descriptionFr": "Documentation des composantes, processus et procédures du SGS dans un manuel SGS complet.",
      "smsComponent": "SAFETY_POLICY_OBJECTIVES",
      "studyArea": "SA_1_5"
    },
    {
      "code": "SMS-C2",
      "sortOrder": 7,
      "nameEn": "Component 2: Safety Risk Management",
      "nameFr": "Composante 2: Gestion des Risques de Sécurité",
      "descriptionEn": "Hazard identification, risk assessment, and risk mitigation processes. This component ensures systematic identification and management of safety risks.",
      "descriptionFr": "Identification des dangers, évaluation des risques et processus d'atténuation des risques. Cette composante assure l'identification et la gestion systématiques des risques de sécurité.",
      "smsComponent": "SAFETY_RISK_MANAGEMENT"
    },
    {
      "code": "SMS-C2-SA2.1",
      "sortOrder": 8,
      "nameEn": "Study Area 2.1: Hazard Identification (ICAO Element 2.1)",
      "nameFr": "Domaine d'Étude 2.1: Identification des Dangers (Élément OACI 2.1)",
      "descriptionEn": "Processes for identifying hazards in operations, including reactive, proactive, and predictive methods.",
      "descriptionFr": "Processus d'identification des dangers dans les opérations, y compris les méthodes réactives, proactives et prédictives.",
      "smsComponent": "SAFETY_RISK_MANAGEMENT",
      "studyArea": "SA_2_1"
    },
    {
      "code": "SMS-C2-SA2.2",
      "sortOrder": 9,
      "nameEn": "Study Area 2.2: Risk Assessment and Mitigation (ICAO Element 2.2)",
      "nameFr": "Domaine d'Étude 2.2: Évaluation et Atténuation des Risques (Élément OACI 2.2)",
      "descriptionEn": "Assessment of safety risks and development of risk mitigation strategies to acceptable levels.",
      "descriptionFr": "Évaluation des risques de sécurité et développement de stratégies d'atténuation des risques à des niveaux acceptables.",
      "smsComponent": "SAFETY_RISK_MANAGEMENT",
      "studyArea": "SA_2_2"
    },
    {
      "code": "SMS-C3",
      "sortOrder": 10,
      "nameEn": "Component 3: Safety Assurance",
      "nameFr": "Composante 3: Assurance de la Sécurité",
      "descriptionEn": "Safety performance monitoring, change management, and continuous improvement. This component ensures the SMS effectiveness is continuously monitored and improved.",
      "descriptionFr": "Suivi des performances de sécurité, gestion du changement et amélioration continue. Cette composante assure que l'efficacité du SGS est continuellement surveillée et améliorée.",
      "smsComponent": "SAFETY_ASSURANCE"
    },
    {
      "code": "SMS-C3-SA3.1",
      "sortOrder": 11,
      "nameEn": "Study Area 3.1: Safety Performance Monitoring and Measurement (ICAO Element 3.1)",
      "nameFr": "Domaine d'Étude 3.1: Suivi et Mesure des Performances de Sécurité (Élément OACI 3.1)",
      "descriptionEn": "Monitoring of safety performance indicators and targets, safety reporting and investigation processes.",
      "descriptionFr": "Suivi des indicateurs et objectifs de performance de sécurité, processus de signalement et d'enquête sur la sécurité.",
      "smsComponent": "SAFETY_ASSURANCE",
      "studyArea": "SA_3_1"
    },
    {
      "code": "SMS-C3-SA3.2",
      "sortOrder": 12,
      "nameEn": "Study Area 3.2: Management of Change (ICAO Element 3.2)",
      "nameFr": "Domaine d'Étude 3.2: Gestion du Changement (Élément OACI 3.2)",
      "descriptionEn": "Processes for managing changes to the organization, operations, or systems that may affect safety.",
      "descriptionFr": "Processus de gestion des changements organisationnels, opérationnels ou systémiques pouvant affecter la sécurité.",
      "smsComponent": "SAFETY_ASSURANCE",
      "studyArea": "SA_3_2"
    },
    {
      "code": "SMS-C3-SA3.3",
      "sortOrder": 13,
      "nameEn": "Study Area 3.3: Continuous Improvement of the SMS (ICAO Element 3.3)",
      "nameFr": "Domaine d'Étude 3.3: Amélioration Continue du SGS (Élément OACI 3.3)",
      "descriptionEn": "Processes for continuous improvement of SMS effectiveness through internal evaluations and external audits.",
      "descriptionFr": "Processus d'amélioration continue de l'efficacité du SGS par des évaluations internes et des audits externes.",
      "smsComponent": "SAFETY_ASSURANCE",
      "studyArea": "SA_3_3"
    },
    {
      "code": "SMS-C4",
      "sortOrder": 14,
      "nameEn": "Component 4: Safety Promotion",
      "nameFr": "Composante 4: Promotion de la Sécurité",
      "descriptionEn": "Training, education, and safety communication. This component ensures personnel competency and organization-wide safety awareness.",
      "descriptionFr": "Formation, éducation et communication de sécurité. Cette composante assure la compétence du personnel et la sensibilisation à la sécurité dans toute l'organisation.",
      "smsComponent": "SAFETY_PROMOTION"
    },
    {
      "code": "SMS-C4-SA4.1",
      "sortOrder": 15,
      "nameEn": "Study Area 4.1: Training and Education (ICAO Element 4.1)",
      "nameFr": "Domaine d'Étude 4.1: Formation et Éducation (Élément OACI 4.1)",
      "descriptionEn": "SMS training programmes and competency development for all personnel involved in safety management.",
      "descriptionFr": "Programmes de formation SGS et développement des compétences pour tout le personnel impliqué dans la gestion de la sécurité.",
      "smsComponent": "SAFETY_PROMOTION",
      "studyArea": "SA_4_1"
    },
    {
      "code": "SMS-C4-SA4.2",
      "sortOrder": 16,
      "nameEn": "Study Area 4.2: Safety Communication (ICAO Element 4.2)",
      "nameFr": "Domaine d'Étude 4.2: Communication de Sécurité (Élément OACI 4.2)",
      "descriptionEn": "Communication of safety information throughout the organization and with external stakeholders.",
      "descriptionFr": "Communication des informations de sécurité dans toute l'organisation et avec les parties prenantes externes.",
      "smsComponent": "SAFETY_PROMOTION",
      "studyArea": "SA_4_2"
    }
  ],
  "questions": [
    {
      "smsComponent": "SAFETY_POLICY_OBJECTIVES",
      "studyArea": "SA_1_1",
      "questionTextEn": "Safety Culture: Leadership demonstrates visible commitment to safety through actions, decisions, and resource allocation.",
      "questionTextFr": "Culture de Sécurité: La direction démontre un engagement visible envers la sécurité par ses actions, décisions et l'allocation des ressources.",
      "sortOrder": 1,
      "maturityLevel": null,
      "responseType": "MATURITY_LEVEL",
      "guidanceEn": "Level A (Informal): Safety is not explicitly addressed by leadership; decisions are primarily operational/commercial.\nLevel B (Defined): Leadership verbally supports safety but actions are inconsistent.\nLevel C (Implemented): Leadership regularly demonstrates commitment through decisions and resource allocation.\nLevel D (Managed): Safety leadership is embedded in organizational governance; safety considerations influence strategic decisions.\nLevel E (Excellence): Leadership proactively drives safety innovation; safety excellence is a core organizational value visible in all decisions.",
      "guidanceFr": "Niveau A (Informel): La sécurité n'est pas explicitement abordée par la direction; les décisions sont principalement opérationnelles/commerciales.\nNiveau B (Défini): La direction soutient verbalement la sécurité mais les actions sont incohérentes.\nNiveau C (Mis en œuvre): La direction démontre régulièrement son engagement par des décisions et l'allocation des ressources.\nNiveau D (Géré): Le leadership en sécurité est intégré à la gouvernance organisationnelle; les considérations de sécurité influencent les décisions stratégiques.\nNiveau E (Excellence): La direction impulse proactivement l'innovation en matière de sécurité; l'excellence en sécurité est une valeur organisationnelle fondamentale visible dans toutes les décisions.",
      "weight": 2.0,
      "maxScore": 5.0,
      "icaoReferences": []
    },
    {
      "smsComponent": "SAFETY_POLICY_OBJECTIVES",
      "studyArea": "SA_1_1",
      "questionTextEn": "Safety Culture: A just culture environment exists where staff feel comfortable reporting safety concerns without fear of blame.",
      "questionTextFr": "Culture de Sécurité: Un environnement de culture juste existe où le personnel se sent à l'aise de signaler les problèmes de sécurité sans crainte de blâme.",
      "sortOrder": 2,
      "maturityLevel": null,
      "responseType": "MATURITY_LEVEL",
      "guidanceEn": "Level A (Informal): Punitive culture; staff reluctant to report issues; blame is common.\nLevel B (Defined): Just culture policy exists but implementation is inconsistent; some fear persists.\nLevel C (Implemented): Just culture is generally practiced; most staff comfortable reporting; clear distinction between acceptable and unacceptable behavior.\nLevel D (Managed): Strong just culture; high reporting rates; systematic review of reported events without blame.\nLevel E (Excellence): Just culture is deeply embedded; staff actively participate in safety; reporting is seen as professional duty and is encouraged.",
      "guidanceFr": "Niveau A (Informel): Culture punitive; personnel réticent à signaler les problèmes; le blâme est courant.\nNiveau B (Défini): Une politique de culture juste existe mais la mise en œuvre est incohérente; une certaine crainte persiste.\nNiveau C (Mis en œuvre): La culture juste est généralement pratiquée; la plupart du personnel est à l'aise pour signaler; distinction claire entre comportement acceptable et inacceptable.\nNiveau D (Géré): Culture juste forte; taux de signalement élevés; examen systématique des événements signalés sans blâme.\nNiveau E (Excellence): La culture juste est profondément ancrée; le personnel participe activement à la sécurité; le signalement est perçu comme un devoir professionnel et est encouragé.",
      "weight": 2.0,
      "maxScore": 5.0,
      "icaoReferences": []
    },
    {
      "smsComponent": "SAFETY_POLICY_OBJECTIVES",
      "studyArea": "SA_1_2",
      "questionTextEn": "Safety Policy: A documented safety policy statement exists that reflects management's commitment to safety.",
      "questionTextFr": "Politique de Sécurité: Une déclaration de politique de sécurité documentée existe et reflète l'engagement de la direction envers la sécurité.",
      "sortOrder": 3,
      "maturityLevel": null,
      "responseType": "MATURITY_LEVEL",
      "guidanceEn": "Level A (Informal): No formal safety policy document exists.\nLevel B (Defined): Safety policy document exists but is generic or not specific to the organization.\nLevel C (Implemented): Safety policy is documented, organization-specific, signed by the accountable executive, and communicated to staff.\nLevel D (Managed): Safety policy is regularly reviewed, updated, and integrated with other organizational policies.\nLevel E (Excellence): Safety policy is a living document that drives organizational behavior; staff can articulate policy content and its implications for their work.",
      "guidanceFr": "Niveau A (Informel): Aucun document de politique de sécurité formel n'existe.\nNiveau B (Défini): Un document de politique de sécurité existe mais est générique ou non spécifique à l'organisation.\nNiveau C (Mis en œuvre): La politique de sécurité est documentée, spécifique à l'organisation, signée par le dirigeant responsable et communiquée au personnel.\nNiveau D (Géré): La politique de sécurité est régulièrement révisée, mise à jour et intégrée aux autres politiques organisationnelles.\nNiveau E (Excellence): La politique de sécurité est un document vivant qui guide le comportement organisationnel; le personnel peut articuler le contenu de la politique et ses implications pour leur travail.",
      "weight": 1.5,
      "maxScore": 5.0,
      "icaoReferences": [
        {
          "referenceType": "STD",
          "document": "Annex 19",
          "chapter": "Appendix 2, 1.1",
          "description": "Management commitment and responsibility - Safety policy"
        }
      ]
    },
    {
      "smsComponent": "SAFETY_POLICY_OBJECTIVES",
      "studyArea": "SA_1_2",
      "questionTextEn": "Safety Policy: Adequate resources (financial, human, technical) are allocated to safety management activities.",
      "questionTextFr": "Politique de Sécurité: Des ressources adéquates (financières, humaines, techniques) sont allouées aux activités de gestion de la sécurité.",
      "sortOrder": 4,
      "maturityLevel": null,
      "responseType": "MATURITY_LEVEL",
      "guidanceEn": "Level A (Informal): No dedicated resources for safety management; safety activities are ad hoc.\nLevel B (Defined): Some resources allocated but insufficient for systematic safety management.\nLevel C (Implemented): Adequate resources allocated; dedicated safety personnel; safety budget identified.\nLevel D (Managed): Resource allocation is based on risk assessment; resources are reviewed and adjusted based on safety performance.\nLevel E (Excellence): Resources are proactively allocated for safety improvement initiatives; investment in safety tools and technologies.",
      "guidanceFr": "Niveau A (Informel): Pas de ressources dédiées à la gestion de la sécurité; les activités de sécurité sont ad hoc.\nNiveau B (Défini): Quelques ressources allouées mais insuffisantes pour une gestion systématique de la sécurité.\nNiveau C (Mis en œuvre): Ressources adéquates allouées; personnel de sécurité dédié; budget de sécurité identifié.\nNiveau D (Géré): L'allocation des ressources est basée sur l'évaluation des risques; les ressources sont révisées et ajustées en fonction des performances de sécurité.\nNiveau E (Excellence): Les ressources sont proactivement allouées aux initiatives d'amélioration de la sécurité; investissement dans les outils et technologies de sécurité.",
      "weight": 1.5,
      "maxScore": 5.0,
      "icaoReferences": [
        {
          "referenceType": "STD",
          "document": "Annex 19",
          "chapter": "Appendix 2, 1.1",
          "description": "Allocation of resources for safety"
        }
      ]
    },
    {
      "smsComponent": "SAFETY_POLICY_OBJECTIVES",
      "studyArea": "SA_1_3",
      "questionTextEn": "Safety Accountabilities: An accountable executive is identified with ultimate responsibility for the SMS and safety performance.",
      "questionTextFr": "Responsabilités de Sécurité: Un dirigeant responsable est identifié avec la responsabilité ultime du SGS et des performances de sécurité.",
      "sortOrder": 5,
      "maturityLevel": null,
      "responseType": "MATURITY_LEVEL",
      "guidanceEn": "Level A (Informal): No clearly identified accountable executive for safety.\nLevel B (Defined): Accountable executive is nominally identified but role is not clearly understood or exercised.\nLevel C (Implemented): Accountable executive is identified, understands responsibilities, and actively engages with safety management.\nLevel D (Managed): Accountable executive leads safety governance; regularly reviews safety performance; ensures adequate resources.\nLevel E (Excellence): Accountable executive is a visible safety champion; drives safety culture; personally engaged in safety improvement.",
      "guidanceFr": "Niveau A (Informel): Pas de dirigeant responsable clairement identifié pour la sécurité.\nNiveau B (Défini): Le dirigeant responsable est nominalement identifié mais le rôle n'est pas clairement compris ou exercé.\nNiveau C (Mis en œuvre): Le dirigeant responsable est identifié, comprend ses responsabilités et s'engage activement dans la gestion de la sécurité.\nNiveau D (Géré): Le dirigeant responsable dirige la gouvernance de la sécurité; examine régulièrement les performances de sécurité; assure des ressources adéquates.\nNiveau E (Excellence): Le dirigeant responsable est un champion de la sécurité visible; impulse la culture de sécurité; personnellement engagé dans l'amélioration de la sécurité.",
      "weight": 1.5,
      "maxScore": 5.0,
      "icaoReferences": [
        {
          "referenceType": "STD",
          "document": "Annex 19",
          "chapter": "Appendix 2, 1.2",
          "description": "Safety accountabilities - Accountable executive"
        }
      ]
    },
    {
      "smsComponent": "SAFETY_POLICY_OBJECTIVES",
      "studyArea": "SA_1_3",
      "questionTextEn": "Safety Accountabilities: Safety responsibilities are defined for managers, supervisors, and operational personnel.",
      "questionTextFr": "Responsabilités de Sécurité: Les responsabilités de sécurité sont définies pour les gestionnaires, superviseurs et le personnel opérationnel.",
      "sortOrder": 6,
      "maturityLevel": null,
      "responseType": "MATURITY_LEVEL",
      "guidanceEn": "Level A (Informal): Safety responsibilities are not defined beyond general expectations.\nLevel B (Defined): Safety responsibilities are documented but not consistently communicated or understood.\nLevel C (Implemented): Safety responsibilities are clearly defined in job descriptions and understood by all levels.\nLevel D (Managed): Safety responsibilities are integrated into performance management; managers are held accountable for safety.\nLevel E (Excellence): Safety responsibilities are embraced at all levels; staff proactively contribute to safety beyond defined responsibilities.",
      "guidanceFr": "Niveau A (Informel): Les responsabilités de sécurité ne sont pas définies au-delà des attentes générales.\nNiveau B (Défini): Les responsabilités de sécurité sont documentées mais pas communiquées ou comprises de manière cohérente.\nNiveau C (Mis en œuvre): Les responsabilités de sécurité sont clairement définies dans les descriptions de poste et comprises à tous les niveaux.\nNiveau D (Géré): Les responsabilités de sécurité sont intégrées à la gestion des performances; les gestionnaires sont responsables de la sécurité.\nNiveau E (Excellence): Les responsabilités de sécurité sont adoptées à tous les niveaux; le personnel contribue proactivement à la sécurité au-delà des responsabilités définies.",
      "weight": 1.0,
      "maxScore": 5.0,
      "icaoReferences": [
        {
          "referenceType": "STD",
          "document": "Annex 19",
          "chapter": "Appendix 2, 1.3",
          "description": "Appointment of key safety personnel"
        }
      ]
    },
    {
      "smsComponent": "SAFETY_POLICY_OBJECTIVES",
      "studyArea": "SA_1_5",
      "questionTextEn": "SMS Documentation: An SMS Manual documents all aspects of the organization's safety management system.",
      "questionTextFr": "Documentation SGS: Un Manuel SGS documente tous les aspects du système de gestion de la sécurité de l'organisation.",
      "sortOrder": 7,
      "maturityLevel": null,
      "responseType": "MATURITY_LEVEL",
      "guidanceEn": "Level A (Informal): No SMS documentation exists.\nLevel B (Defined): Some SMS documentation exists but is incomplete or fragmented.\nLevel C (Implemented): Comprehensive SMS Manual exists covering all SMS components and processes.\nLevel D (Managed): SMS Manual is regularly reviewed and updated; integrated with other management system documentation.\nLevel E (Excellence): SMS documentation is user-friendly, accessible, and actively used; staff reference it regularly in their work.",
      "guidanceFr": "Niveau A (Informel): Aucune documentation SGS n'existe.\nNiveau B (Défini): Une certaine documentation SGS existe mais est incomplète ou fragmentée.\nNiveau C (Mis en œuvre): Un Manuel SGS complet existe couvrant toutes les composantes et processus du SGS.\nNiveau D (Géré): Le Manuel SGS est régulièrement révisé et mis à jour; intégré à la documentation des autres systèmes de gestion.\nNiveau E (Excellence): La documentation SGS est conviviale, accessible et activement utilisée; le personnel s'y réfère régulièrement dans son travail.",
      "weight": 1.0,
      "maxScore": 5.0,
      "icaoReferences": [
        {
          "referenceType": "STD",
          "document": "Annex 19",
          "chapter": "Appendix 2, 1.5",
          "description": "SMS documentation"
        }
      ]
    },
    {
      "smsComponent": "SAFETY_RISK_MANAGEMENT",
      "studyArea": "SA_2_1",
      "questionTextEn": "Hazard Identification: Reactive processes exist to identify hazards from safety reports, incidents, and accidents.",
      "questionTextFr": "Identification des Dangers: Des processus réactifs existent pour identifier les dangers à partir des rapports de sécurité, incidents et accidents.",
      "sortOrder": 8,
      "maturityLevel": null,
      "responseType": "MATURITY_LEVEL",
      "guidanceEn": "Level A (Informal): No systematic process for hazard identification from events.\nLevel B (Defined): Some reactive hazard identification occurs but is ad hoc and inconsistent.\nLevel C (Implemented): Systematic process exists for identifying hazards from reported events; hazard register maintained.\nLevel D (Managed): Hazard identification is linked to risk assessment; trends are analyzed; hazards are prioritized.\nLevel E (Excellence): Comprehensive reactive system with integration across departments; benchmarking with industry; lessons learned shared externally.",
      "guidanceFr": "Niveau A (Informel): Aucun processus systématique d'identification des dangers à partir des événements.\nNiveau B (Défini): Une certaine identification réactive des dangers se produit mais est ad hoc et incohérente.\nNiveau C (Mis en œuvre): Un processus systématique existe pour identifier les dangers à partir des événements signalés; registre des dangers maintenu.\nNiveau D (Géré): L'identification des dangers est liée à l'évaluation des risques; les tendances sont analysées; les dangers sont priorisés.\nNiveau E (Excellence): Système réactif complet avec intégration entre les départements; comparaison avec l'industrie; leçons apprises partagées à l'externe.",
      "weight": 1.5,
      "maxScore": 5.0,
      "icaoReferences": [
        {
          "referenceType": "STD",
          "document": "Annex 19",
          "chapter": "Appendix 2, 2.1",
          "description": "Hazard identification - Reactive processes"
        }
      ]
    },
    {
      "smsComponent": "SAFETY_RISK_MANAGEMENT",
      "studyArea": "SA_2_1",
      "questionTextEn": "Hazard Identification: Proactive processes exist to identify hazards before they result in incidents or accidents.",
      "questionTextFr": "Identification des Dangers: Des processus proactifs existent pour identifier les dangers avant qu'ils ne provoquent des incidents ou accidents.",
      "sortOrder": 9,
      "maturityLevel": null,
      "responseType": "MATURITY_LEVEL",
      "guidanceEn": "Level A (Informal): No proactive hazard identification processes.\nLevel B (Defined): Some proactive activities occur (e.g., safety surveys) but not systematically.\nLevel C (Implemented): Systematic proactive processes exist including safety assessments, audits, and operational monitoring.\nLevel D (Managed): Proactive hazard identification is integrated into operational planning; staff actively identify hazards.\nLevel E (Excellence): Predictive methods used (data analytics, trend analysis); organization anticipates future hazards.",
      "guidanceFr": "Niveau A (Informel): Aucun processus proactif d'identification des dangers.\nNiveau B (Défini): Certaines activités proactives se produisent (par ex., enquêtes de sécurité) mais pas de manière systématique.\nNiveau C (Mis en œuvre): Des processus proactifs systématiques existent, y compris des évaluations de sécurité, des audits et une surveillance opérationnelle.\nNiveau D (Géré): L'identification proactive des dangers est intégrée à la planification opérationnelle; le personnel identifie activement les dangers.\nNiveau E (Excellence): Méthodes prédictives utilisées (analyse de données, analyse des tendances); l'organisation anticipe les dangers futurs.",
      "weight": 1.5,
      "maxScore": 5.0,
      "icaoReferences": [
        {
          "referenceType": "STD",
          "document": "Annex 19",
          "chapter": "Appendix 2, 2.1",
          "description": "Hazard identification - Proactive processes"
        }
      ]
    },
    {
      "smsComponent": "SAFETY_RISK_MANAGEMENT",
      "studyArea": "SA_2_2",
      "questionTextEn": "Risk Assessment: A documented risk assessment methodology is used to assess safety risks.",
      "questionTextFr": "Évaluation des Risques: Une méthodologie d'évaluation des risques documentée est utilisée pour évaluer les risques de sécurité.",
      "sortOrder": 10,
      "maturityLevel": null,
      "responseType": "MATURITY_LEVEL",
      "guidanceEn": "Level A (Informal): No formal risk assessment methodology.\nLevel B (Defined): Risk assessment methodology exists but is not consistently applied.\nLevel C (Implemented): Documented methodology consistently applied; risk matrix used; probability and severity assessed.\nLevel D (Managed): Risk assessment methodology is refined based on experience; multiple techniques used as appropriate.\nLevel E (Excellence): Advanced risk assessment techniques used; quantitative analysis where applicable; integration with operational decision-making.",
      "guidanceFr": "Niveau A (Informel): Pas de méthodologie formelle d'évaluation des risques.\nNiveau B (Défini): Une méthodologie d'évaluation des risques existe mais n'est pas appliquée de manière cohérente.\nNiveau C (Mis en œuvre): Méthodologie documentée appliquée de manière cohérente; matrice de risques utilisée; probabilité et gravité évaluées.\nNiveau D (Géré): La méthodologie d'évaluation des risques est affinée en fonction de l'expérience; plusieurs techniques utilisées selon les besoins.\nNiveau E (Excellence): Techniques avancées d'évaluation des risques utilisées; analyse quantitative si applicable; intégration avec la prise de décision opérationnelle.",
      "weight": 1.5,
      "maxScore": 5.0,
      "icaoReferences": [
        {
          "referenceType": "STD",
          "document": "Annex 19",
          "chapter": "Appendix 2, 2.2",
          "description": "Safety risk assessment and mitigation"
        },
        {
          "referenceType": "GM",
          "document": "Doc 9859",
          "chapter": "Chapter 5",
          "description": "Safety risk management"
        }
      ]
    },
    {
      "smsComponent": "SAFETY_RISK_MANAGEMENT",
      "studyArea": "SA_2_2",
      "questionTextEn": "Risk Mitigation: Risk mitigation measures are implemented and tracked to reduce risks to acceptable levels.",
      "questionTextFr": "Atténuation des Risques: Des mesures d'atténuation des risques sont mises en œuvre et suivies pour réduire les risques à des niveaux acceptables.",
      "sortOrder": 11,
      "maturityLevel": null,
      "responseType": "MATURITY_LEVEL",
      "guidanceEn": "Level A (Informal): No systematic approach to risk mitigation.\nLevel B (Defined): Some mitigation measures implemented but tracking is limited.\nLevel C (Implemented): Mitigation measures are systematically identified, implemented, and tracked; effectiveness reviewed.\nLevel D (Managed): Risk mitigation is integrated into operational management; residual risk is monitored; mitigation ownership assigned.\nLevel E (Excellence): Continuous optimization of mitigation strategies; proactive identification of new mitigations; learning from industry best practices.",
      "guidanceFr": "Niveau A (Informel): Pas d'approche systématique de l'atténuation des risques.\nNiveau B (Défini): Certaines mesures d'atténuation mises en œuvre mais le suivi est limité.\nNiveau C (Mis en œuvre): Les mesures d'atténuation sont systématiquement identifiées, mises en œuvre et suivies; l'efficacité est examinée.\nNiveau D (Géré): L'atténuation des risques est intégrée à la gestion opérationnelle; le risque résiduel est surveillé; la propriété de l'atténuation est assignée.\nNiveau E (Excellence): Optimisation continue des stratégies d'atténuation; identification proactive de nouvelles atténuations; apprentissage des meilleures pratiques de l'industrie.",
      "weight": 1.5,
      "maxScore": 5.0,
      "icaoReferences": [
        {
          "referenceType": "STD",
          "document": "Annex 19",
          "chapter": "Appendix 2, 2.2",
          "description": "Safety risk mitigation"
        }
      ]
    },
    {
      "smsComponent": "SAFETY_ASSURANCE",
      "studyArea": "SA_3_1",
      "questionTextEn": "Safety Reporting: A voluntary and confidential safety reporting system exists for staff to report hazards and safety concerns.",
      "questionTextFr": "Signalement de Sécurité: Un système de signalement de sécurité volontaire et confidentiel existe pour que le personnel signale les dangers et les préoccupations de sécurité.",
      "sortOrder": 12,
      "maturityLevel": null,
      "responseType": "MATURITY_LEVEL",
      "guidanceEn": "Level A (Informal): No voluntary safety reporting system; only mandatory reports submitted.\nLevel B (Defined): Voluntary reporting system exists but usage is low; confidentiality concerns.\nLevel C (Implemented): Active voluntary reporting system with good participation; reports are investigated and feedback provided.\nLevel D (Managed): High reporting rates; reports drive safety improvements; reporters receive timely feedback.\nLevel E (Excellence): Reporting culture is embedded; staff proactively report; system captures leading indicators; external benchmarking of reporting metrics.",
      "guidanceFr": "Niveau A (Informel): Pas de système de signalement volontaire de sécurité; seuls les rapports obligatoires sont soumis.\nNiveau B (Défini): Un système de signalement volontaire existe mais l'utilisation est faible; préoccupations de confidentialité.\nNiveau C (Mis en œuvre): Système de signalement volontaire actif avec bonne participation; les rapports sont examinés et un retour d'information est fourni.\nNiveau D (Géré): Taux de signalement élevés; les rapports conduisent à des améliorations de sécurité; les signaleurs reçoivent un retour d'information en temps opportun.\nNiveau E (Excellence): La culture du signalement est ancrée; le personnel signale proactivement; le système capture les indicateurs avancés; comparaison externe des métriques de signalement.",
      "weight": 1.5,
      "maxScore": 5.0,
      "icaoReferences": [
        {
          "referenceType": "STD",
          "document": "Annex 19",
          "chapter": "Appendix 2, 3.1",
          "description": "Safety performance monitoring - Internal safety reporting"
        }
      ]
    },
    {
      "smsComponent": "SAFETY_ASSURANCE",
      "studyArea": "SA_3_1",
      "questionTextEn": "Safety Investigation: Safety events are investigated to identify root causes and contributing factors.",
      "questionTextFr": "Enquête de Sécurité: Les événements de sécurité sont étudiés pour identifier les causes profondes et les facteurs contributifs.",
      "sortOrder": 13,
      "maturityLevel": null,
      "responseType": "MATURITY_LEVEL",
      "guidanceEn": "Level A (Informal): Investigations focus on blame; only major events investigated.\nLevel B (Defined): Some investigations conducted but methodology is inconsistent; focus on immediate causes.\nLevel C (Implemented): Systematic investigation process; root cause analysis conducted; recommendations tracked.\nLevel D (Managed): Investigation findings drive systemic improvements; human factors considered; organizational factors analyzed.\nLevel E (Excellence): Comprehensive investigation methodology; integration with industry learning; investigation quality reviewed.",
      "guidanceFr": "Niveau A (Informel): Les enquêtes se concentrent sur le blâme; seuls les événements majeurs sont étudiés.\nNiveau B (Défini): Certaines enquêtes sont menées mais la méthodologie est incohérente; accent sur les causes immédiates.\nNiveau C (Mis en œuvre): Processus d'enquête systématique; analyse des causes profondes effectuée; recommandations suivies.\nNiveau D (Géré): Les résultats des enquêtes conduisent à des améliorations systémiques; les facteurs humains sont considérés; les facteurs organisationnels sont analysés.\nNiveau E (Excellence): Méthodologie d'enquête complète; intégration avec l'apprentissage de l'industrie; qualité des enquêtes examinée.",
      "weight": 1.5,
      "maxScore": 5.0,
      "icaoReferences": [
        {
          "referenceType": "STD",
          "document": "Annex 19",
          "chapter": "Appendix 2, 3.1",
          "description": "Safety performance monitoring - Investigation"
        }
      ]
    },
    {
      "smsComponent": "SAFETY_ASSURANCE",
      "studyArea": "SA_3_1",
      "questionTextEn": "Safety Performance Indicators: Safety performance indicators (SPIs) and safety performance targets (SPTs) are established and monitored.",
      "questionTextFr": "Indicateurs de Performance de Sécurité: Des indicateurs de performance de sécurité (IPS) et des objectifs de performance de sécurité (OPS) sont établis et surveillés.",
      "sortOrder": 14,
      "maturityLevel": null,
      "responseType": "MATURITY_LEVEL",
      "guidanceEn": "Level A (Informal): No SPIs or SPTs defined.\nLevel B (Defined): Some indicators exist but are limited to lagging indicators (accident/incident rates).\nLevel C (Implemented): Comprehensive SPIs including leading and lagging indicators; SPTs established; regular monitoring.\nLevel D (Managed): SPIs drive management decisions; trends analyzed; targets reviewed and adjusted based on performance.\nLevel E (Excellence): Advanced performance measurement; predictive indicators; benchmarking with industry leaders; safety performance linked to business performance.",
      "guidanceFr": "Niveau A (Informel): Aucun IPS ou OPS défini.\nNiveau B (Défini): Certains indicateurs existent mais sont limités aux indicateurs rétrospectifs (taux d'accidents/incidents).\nNiveau C (Mis en œuvre): IPS complets incluant indicateurs avancés et rétrospectifs; OPS établis; surveillance régulière.\nNiveau D (Géré): Les IPS guident les décisions de gestion; tendances analysées; objectifs révisés et ajustés en fonction des performances.\nNiveau E (Excellence): Mesure de performance avancée; indicateurs prédictifs; comparaison avec les leaders de l'industrie; performance de sécurité liée à la performance de l'entreprise.",
      "weight": 1.5,
      "maxScore": 5.0,
      "icaoReferences": [
        {
          "referenceType": "STD",
          "document": "Annex 19",
          "chapter": "Appendix 2, 3.1",
          "description": "Safety performance monitoring - SPIs and SPTs"
        },
        {
          "referenceType": "GM",
          "document": "Doc 9859",
          "chapter": "Chapter 6",
          "description": "Safety performance indicators and targets"
        }
      ]
    },
    {
      "smsComponent": "SAFETY_ASSURANCE",
      "studyArea": "SA_3_2",
      "questionTextEn": "Management of Change: A formal process exists to manage changes that may affect safety.",
      "questionTextFr": "Gestion du Changement: Un processus formel existe pour gérer les changements pouvant affecter la sécurité.",
      "sortOrder": 15,
      "maturityLevel": null,
      "responseType": "MATURITY_LEVEL",
      "guidanceEn": "Level A (Informal): No formal change management process for safety.\nLevel B (Defined): Change management process exists but safety is not systematically considered.\nLevel C (Implemented): Formal MOC process requires safety assessment for significant changes; approval authority defined.\nLevel D (Managed): MOC integrated into project management; safety risks from changes are tracked and mitigated.\nLevel E (Excellence): Comprehensive MOC covering all aspects (technical, organizational, operational); lessons learned from changes feed back into process.",
      "guidanceFr": "Niveau A (Informel): Pas de processus formel de gestion du changement pour la sécurité.\nNiveau B (Défini): Un processus de gestion du changement existe mais la sécurité n'est pas systématiquement considérée.\nNiveau C (Mis en œuvre): Un processus formel de MOC exige une évaluation de sécurité pour les changements significatifs; autorité d'approbation définie.\nNiveau D (Géré): MOC intégré à la gestion de projet; les risques de sécurité des changements sont suivis et atténués.\nNiveau E (Excellence): MOC complet couvrant tous les aspects (technique, organisationnel, opérationnel); les leçons tirées des changements alimentent le processus.",
      "weight": 1.5,
      "maxScore": 5.0,
      "icaoReferences": [
        {
          "referenceType": "STD",
          "document": "Annex 19",
          "chapter": "Appendix 2, 3.2",
          "description": "The management of change"
        }
      ]
    },
    {
      "smsComponent": "SAFETY_ASSURANCE",
      "studyArea": "SA_3_3",
      "questionTextEn": "Continuous Improvement: Internal SMS evaluations and audits are conducted to assess SMS effectiveness.",
      "questionTextFr": "Amélioration Continue: Des évaluations et audits internes du SGS sont effectués pour évaluer l'efficacité du SGS.",
      "sortOrder": 16,
      "maturityLevel": null,
      "responseType": "MATURITY_LEVEL",
      "guidanceEn": "Level A (Informal): No internal SMS evaluations conducted.\nLevel B (Defined): Some informal reviews of SMS elements but not systematic.\nLevel C (Implemented): Periodic internal SMS audits/evaluations conducted; findings documented and tracked.\nLevel D (Managed): Comprehensive evaluation programme; findings drive SMS improvements; management review of SMS performance.\nLevel E (Excellence): Continuous SMS improvement embedded in culture; external benchmarking; SMS maturity assessment used.",
      "guidanceFr": "Niveau A (Informel): Aucune évaluation interne du SGS effectuée.\nNiveau B (Défini): Quelques revues informelles des éléments du SGS mais pas systématiques.\nNiveau C (Mis en œuvre): Audits/évaluations internes périodiques du SGS effectués; constatations documentées et suivies.\nNiveau D (Géré): Programme d'évaluation complet; les constatations conduisent à des améliorations du SGS; revue de direction des performances du SGS.\nNiveau E (Excellence): L'amélioration continue du SGS est ancrée dans la culture; comparaison externe; évaluation de la maturité du SGS utilisée.",
      "weight": 1.5,
      "maxScore": 5.0,
      "icaoReferences": [
        {
          "referenceType": "STD",
          "document": "Annex 19",
          "chapter": "Appendix 2, 3.3",
          "description": "Continuous improvement of the SMS"
        }
      ]
    },
    {
      "smsComponent": "SAFETY_PROMOTION",
      "studyArea": "SA_4_1",
      "questionTextEn": "Training and Education: SMS training programmes exist for personnel at all levels.",
      "questionTextFr": "Formation et Éducation: Des programmes de formation SGS existent pour le personnel à tous les niveaux.",
      "sortOrder": 17,
      "maturityLevel": null,
      "responseType": "MATURITY_LEVEL",
      "guidanceEn": "Level A (Informal): No specific SMS training provided.\nLevel B (Defined): Some SMS awareness training exists but is not comprehensive or mandatory.\nLevel C (Implemented): Systematic SMS training programme; initial and recurrent training; role-specific content; training records maintained.\nLevel D (Managed): Training effectiveness evaluated; training needs analysis conducted; competency-based approach.\nLevel E (Excellence): Comprehensive training covering advanced SMS concepts; simulation-based training; external courses for key personnel; continuous learning culture.",
      "guidanceFr": "Niveau A (Informel): Aucune formation SGS spécifique fournie.\nNiveau B (Défini): Une certaine formation de sensibilisation au SGS existe mais n'est pas complète ou obligatoire.\nNiveau C (Mis en œuvre): Programme de formation SGS systématique; formation initiale et périodique; contenu spécifique au rôle; dossiers de formation maintenus.\nNiveau D (Géré): L'efficacité de la formation est évaluée; analyse des besoins de formation effectuée; approche basée sur les compétences.\nNiveau E (Excellence): Formation complète couvrant les concepts avancés du SGS; formation basée sur la simulation; cours externes pour le personnel clé; culture d'apprentissage continu.",
      "weight": 1.5,
      "maxScore": 5.0,
      "icaoReferences": [
        {
          "referenceType": "STD",
          "document": "Annex 19",
          "chapter": "Appendix 2, 4.1",
          "description": "Training and education"
        }
      ]
    },
    {
      "smsComponent": "SAFETY_PROMOTION",
      "studyArea": "SA_4_2",
      "questionTextEn": "Safety Communication: Safety information is communicated throughout the organization.",
      "questionTextFr": "Communication de Sécurité: Les informations de sécurité sont communiquées dans toute l'organisation.",
      "sortOrder": 18,
      "maturityLevel": null,
      "responseType": "MATURITY_LEVEL",
      "guidanceEn": "Level A (Informal): No systematic safety communication; information shared ad hoc.\nLevel B (Defined): Some safety communication exists but is not coordinated or comprehensive.\nLevel C (Implemented): Systematic safety communication programme; safety meetings, bulletins, briefings; lessons learned shared.\nLevel D (Managed): Two-way communication; staff input sought and valued; safety communication effectiveness measured.\nLevel E (Excellence): Safety communication embedded in culture; multiple channels used; external safety information actively incorporated; safety knowledge management system.",
      "guidanceFr": "Niveau A (Informel): Pas de communication de sécurité systématique; informations partagées de manière ad hoc.\nNiveau B (Défini): Une certaine communication de sécurité existe mais n'est pas coordonnée ou complète.\nNiveau C (Mis en œuvre): Programme de communication de sécurité systématique; réunions de sécurité, bulletins, briefings; leçons apprises partagées.\nNiveau D (Géré): Communication bidirectionnelle; l'avis du personnel est sollicité et valorisé; l'efficacité de la communication de sécurité est mesurée.\nNiveau E (Excellence): La communication de sécurité est ancrée dans la culture; plusieurs canaux utilisés; informations de sécurité externes activement incorporées; système de gestion des connaissances de sécurité.",
      "weight": 1.5,
      "maxScore": 5.0,
      "icaoReferences": [
        {
          "referenceType": "STD",
          "document": "Annex 19",
          "chapter": "Appendix 2, 4.2",
          "description": "Safety communication"
        }
      ]
    },
    {
      "smsComponent": "SAFETY_ASSURANCE",
      "studyArea": "SA_3_1",
      "transversalArea": "SPM",
      "questionTextEn": "Safety Performance Management (Transversal): Safety performance is systematically monitored, measured, and managed across the organization.",
      "questionTextFr": "Gestion des Performances de Sécurité (Transversal): Les performances de sécurité sont systématiquement surveillées, mesurées et gérées dans toute l'organisation.",
      "sortOrder": 19,
      "maturityLevel": null,
      "responseType": "MATURITY_LEVEL",
      "guidanceEn": "Level A: No systematic safety performance management.\nLevel B: Basic metrics tracked reactively.\nLevel C: SPIs monitored; performance reviewed regularly.\nLevel D: Performance management integrated into governance; data-driven decisions.\nLevel E: Advanced analytics; predictive performance management; continuous optimization.",
      "guidanceFr": "Niveau A: Pas de gestion systématique des performances de sécurité.\nNiveau B: Métriques de base suivies de manière réactive.\nNiveau C: IPS surveillés; performances examinées régulièrement.\nNiveau D: Gestion des performances intégrée à la gouvernance; décisions basées sur les données.\nNiveau E: Analytique avancée; gestion prédictive des performances; optimisation continue.",
      "weight": 1.0,
      "maxScore": 5.0,
      "icaoReferences": []
    },
    {
      "smsComponent": "SAFETY_PROMOTION",
      "studyArea": "SA_4_1",
      "transversalArea": "HP",
      "questionTextEn": "Human Performance (Transversal): Human factors are systematically considered in safety management activities.",
      "questionTextFr": "Performance Humaine (Transversal): Les facteurs humains sont systématiquement pris en compte dans les activités de gestion de la sécurité.",
      "sortOrder": 20,
      "maturityLevel": null,
      "responseType": "MATURITY_LEVEL",
      "guidanceEn": "Level A: Human factors not considered; focus on procedural compliance.\nLevel B: Basic awareness of human factors exists.\nLevel C: Human factors integrated into hazard identification and investigation.\nLevel D: Human performance expertise available; HF principles in design and procedures.\nLevel E: Comprehensive HF programme; positive human performance culture; system designed for human capabilities.",
      "guidanceFr": "Niveau A: Facteurs humains non considérés; accent sur la conformité procédurale.\nNiveau B: Sensibilisation de base aux facteurs humains existe.\nNiveau C: Facteurs humains intégrés à l'identification des dangers et aux enquêtes.\nNiveau D: Expertise en performance humaine disponible; principes FH dans la conception et les procédures.\nNiveau E: Programme FH complet; culture positive de performance humaine; système conçu pour les capacités humaines.",
      "weight": 1.0,
      "maxScore": 5.0,
      "icaoReferences": [
        {
          "referenceType": "GM",
          "document": "Doc 9859",
          "chapter": "Chapter 4",
          "description": "Human performance in safety management"
        }
      ]
    },
    {
      "smsComponent": "SAFETY_ASSURANCE",
      "studyArea": "SA_3_3",
      "transversalArea": "CI",
      "questionTextEn": "Continuous Improvement (Transversal): The organization demonstrates a commitment to continuous improvement in safety.",
      "questionTextFr": "Amélioration Continue (Transversal): L'organisation démontre un engagement envers l'amélioration continue de la sécurité.",
      "sortOrder": 21,
      "maturityLevel": null,
      "responseType": "MATURITY_LEVEL",
      "guidanceEn": "Level A: No systematic improvement efforts.\nLevel B: Improvements occur in response to major events.\nLevel C: Regular improvement initiatives based on audits and reviews.\nLevel D: Continuous improvement embedded in processes; improvement targets set.\nLevel E: Innovation culture; proactive improvement; industry leadership in safety practices.",
      "guidanceFr": "Niveau A: Pas d'efforts d'amélioration systématiques.\nNiveau B: Des améliorations se produisent en réponse aux événements majeurs.\nNiveau C: Initiatives d'amélioration régulières basées sur les audits et revues.\nNiveau D: Amélioration continue ancrée dans les processus; objectifs d'amélioration fixés.\nNiveau E: Culture d'innovation; amélioration proactive; leadership industriel dans les pratiques de sécurité.",
      "weight": 1.0,
      "maxScore": 5.0,
      "icaoReferences": []
    }
  ]
}

```

# prisma/seed-demo.ts

```ts
/**
 * Demo Data Generator
 *
 * Generates realistic sample data for demonstrations, including:
 * - African ANSPs with realistic ICAO codes
 * - Sample users with various roles
 * - Assessments in different stages
 * - Responses with realistic distributions
 *
 * Usage: npx ts-node prisma/seed-demo.ts
 */

import "dotenv/config";
import { Pool } from "pg";
import { PrismaPg } from "@prisma/adapter-pg";
import { PrismaClient } from "@prisma/client";
import type {
  AssessmentStatus,
  AssessmentType,
  QuestionnaireType,
  UserRole,
  MaturityLevel,
  MembershipStatus,
  Locale,
} from "@prisma/client";

const pool = new Pool({ connectionString: process.env.DATABASE_URL });
const adapter = new PrismaPg(pool);
const prisma = new PrismaClient({ adapter });

// =============================================================================
// AFRICAN ANSP DATA
// =============================================================================

interface ANSPData {
  nameEn: string;
  nameFr: string;
  icaoCode: string;
  country: string;
  region: "WACAF" | "ESAF";
  membershipStatus: MembershipStatus;
}

const AFRICAN_ANSPS: ANSPData[] = [
  // West and Central Africa (WACAF)
  {
    nameEn: "Agency for Aerial Navigation Safety in Africa and Madagascar",
    nameFr: "Agence pour la Sécurité de la Navigation Aérienne en Afrique et à Madagascar",
    icaoCode: "ASECNA",
    country: "Senegal (HQ)",
    region: "WACAF",
    membershipStatus: "ACTIVE",
  },
  {
    nameEn: "Nigerian Airspace Management Agency",
    nameFr: "Agence Nigériane de Gestion de l'Espace Aérien",
    icaoCode: "NAMA",
    country: "Nigeria",
    region: "WACAF",
    membershipStatus: "ACTIVE",
  },
  {
    nameEn: "Ghana Civil Aviation Authority",
    nameFr: "Autorité de l'Aviation Civile du Ghana",
    icaoCode: "GCAA",
    country: "Ghana",
    region: "WACAF",
    membershipStatus: "ACTIVE",
  },
  {
    nameEn: "Roberts Flight Information Region",
    nameFr: "Région d'Information de Vol Roberts",
    icaoCode: "RFIR",
    country: "Liberia",
    region: "WACAF",
    membershipStatus: "PENDING",
  },
  {
    nameEn: "Sierra Leone Civil Aviation Authority",
    nameFr: "Autorité de l'Aviation Civile de Sierra Leone",
    icaoCode: "SLCAA",
    country: "Sierra Leone",
    region: "WACAF",
    membershipStatus: "PENDING",
  },
  // Eastern and Southern Africa (ESAF)
  {
    nameEn: "Kenya Civil Aviation Authority",
    nameFr: "Autorité de l'Aviation Civile du Kenya",
    icaoCode: "KCAA",
    country: "Kenya",
    region: "ESAF",
    membershipStatus: "ACTIVE",
  },
  {
    nameEn: "South African Civil Aviation Authority",
    nameFr: "Autorité de l'Aviation Civile Sud-Africaine",
    icaoCode: "SACAA",
    country: "South Africa",
    region: "ESAF",
    membershipStatus: "ACTIVE",
  },
  {
    nameEn: "Tanzania Civil Aviation Authority",
    nameFr: "Autorité de l'Aviation Civile de Tanzanie",
    icaoCode: "TCAA",
    country: "Tanzania",
    region: "ESAF",
    membershipStatus: "ACTIVE",
  },
  {
    nameEn: "Ethiopian Civil Aviation Authority",
    nameFr: "Autorité de l'Aviation Civile Éthiopienne",
    icaoCode: "ECAA",
    country: "Ethiopia",
    region: "ESAF",
    membershipStatus: "ACTIVE",
  },
  {
    nameEn: "Uganda Civil Aviation Authority",
    nameFr: "Autorité de l'Aviation Civile de l'Ouganda",
    icaoCode: "UCAA",
    country: "Uganda",
    region: "ESAF",
    membershipStatus: "ACTIVE",
  },
  {
    nameEn: "Rwanda Civil Aviation Authority",
    nameFr: "Autorité de l'Aviation Civile du Rwanda",
    icaoCode: "RCAA",
    country: "Rwanda",
    region: "ESAF",
    membershipStatus: "ACTIVE",
  },
  {
    nameEn: "Namibia Civil Aviation Authority",
    nameFr: "Autorité de l'Aviation Civile de Namibie",
    icaoCode: "NCAA",
    country: "Namibia",
    region: "ESAF",
    membershipStatus: "PENDING",
  },
];

// =============================================================================
// USER DATA
// =============================================================================

interface UserData {
  email: string;
  firstName: string;
  lastName: string;
  role: UserRole;
  locale: Locale;
  isOrgUser: boolean; // Whether this user belongs to an org
}

const DEMO_USERS: UserData[] = [
  // Programme Staff (no org)
  {
    email: "admin@aaprp.org",
    firstName: "System",
    lastName: "Administrator",
    role: "SUPER_ADMIN",
    locale: "EN",
    isOrgUser: false,
  },
  {
    email: "coordinator@aaprp.org",
    firstName: "Jean",
    lastName: "Mbeki",
    role: "PROGRAMME_COORDINATOR",
    locale: "FR",
    isOrgUser: false,
  },
  {
    email: "lead.reviewer@aaprp.org",
    firstName: "Sarah",
    lastName: "Okonkwo",
    role: "LEAD_REVIEWER",
    locale: "EN",
    isOrgUser: false,
  },
  {
    email: "reviewer1@aaprp.org",
    firstName: "Ahmed",
    lastName: "Hassan",
    role: "PEER_REVIEWER",
    locale: "EN",
    isOrgUser: false,
  },
  {
    email: "reviewer2@aaprp.org",
    firstName: "Marie",
    lastName: "Kouassi",
    role: "PEER_REVIEWER",
    locale: "FR",
    isOrgUser: false,
  },
  {
    email: "steering@aaprp.org",
    firstName: "David",
    lastName: "Nkrumah",
    role: "STEERING_COMMITTEE",
    locale: "EN",
    isOrgUser: false,
  },
  // Org users (template - will be created per organization)
];

const ORG_USER_TEMPLATES: Omit<UserData, "email" | "isOrgUser">[] = [
  { firstName: "Org", lastName: "Admin", role: "ANSP_ADMIN", locale: "EN" },
  { firstName: "Safety", lastName: "Manager", role: "SAFETY_MANAGER", locale: "EN" },
  { firstName: "Quality", lastName: "Manager", role: "QUALITY_MANAGER", locale: "EN" },
  { firstName: "Staff", lastName: "Member", role: "STAFF", locale: "EN" },
];

// =============================================================================
// RESPONSE GENERATION
// =============================================================================

type ANSResponseValue = "SATISFACTORY" | "NOT_SATISFACTORY" | "NOT_APPLICABLE";

function generateANSResponse(index: number, distribution?: {
  satisfactory: number;
  notSatisfactory: number;
  notApplicable: number;
}): ANSResponseValue {
  const dist = distribution ?? { satisfactory: 70, notSatisfactory: 20, notApplicable: 10 };
  const total = dist.satisfactory + dist.notSatisfactory + dist.notApplicable;
  const rand = (index * 7 + 13) % total; // Deterministic pseudo-random

  if (rand < dist.satisfactory) return "SATISFACTORY";
  if (rand < dist.satisfactory + dist.notSatisfactory) return "NOT_SATISFACTORY";
  return "NOT_APPLICABLE";
}

function generateSMSMaturityLevel(index: number, distribution?: {
  A: number;
  B: number;
  C: number;
  D: number;
  E: number;
}): MaturityLevel {
  const dist = distribution ?? { A: 5, B: 15, C: 40, D: 30, E: 10 };
  const total = dist.A + dist.B + dist.C + dist.D + dist.E;
  const rand = (index * 7 + 13) % total;

  const levelMap: Record<string, MaturityLevel> = {
    A: "LEVEL_A",
    B: "LEVEL_B",
    C: "LEVEL_C",
    D: "LEVEL_D",
    E: "LEVEL_E",
  };

  if (rand < dist.A) return levelMap.A;
  if (rand < dist.A + dist.B) return levelMap.B;
  if (rand < dist.A + dist.B + dist.C) return levelMap.C;
  if (rand < dist.A + dist.B + dist.C + dist.D) return levelMap.D;
  return levelMap.E;
}

// =============================================================================
// SEEDING FUNCTIONS
// =============================================================================

async function seedOrganizations(): Promise<Map<string, string>> {
  console.log("\n📦 Seeding organizations...");
  const orgMap = new Map<string, string>();

  for (const ansp of AFRICAN_ANSPS) {
    const org = await prisma.organization.upsert({
      where: { icaoCode: ansp.icaoCode },
      update: {
        nameEn: ansp.nameEn,
        nameFr: ansp.nameFr,
        country: ansp.country,
        region: ansp.region,
        membershipStatus: ansp.membershipStatus,
      },
      create: {
        nameEn: ansp.nameEn,
        nameFr: ansp.nameFr,
        icaoCode: ansp.icaoCode,
        country: ansp.country,
        region: ansp.region,
        membershipStatus: ansp.membershipStatus,
      },
    });

    orgMap.set(ansp.icaoCode, org.id);
    console.log(`  ✓ ${ansp.icaoCode} - ${ansp.country}`);
  }

  return orgMap;
}

async function seedUsers(orgMap: Map<string, string>): Promise<Map<string, string>> {
  console.log("\n👥 Seeding users...");
  const userMap = new Map<string, string>();

  // Create programme-level users (no org)
  for (const userData of DEMO_USERS) {
    const user = await prisma.user.upsert({
      where: { email: userData.email },
      update: {
        firstName: userData.firstName,
        lastName: userData.lastName,
        role: userData.role,
        locale: userData.locale,
        isActive: true,
      },
      create: {
        email: userData.email,
        firstName: userData.firstName,
        lastName: userData.lastName,
        role: userData.role,
        locale: userData.locale,
        isActive: true,
      },
    });

    userMap.set(userData.email, user.id);
    console.log(`  ✓ ${userData.role}: ${userData.firstName} ${userData.lastName}`);
  }

  // Create org users for each organization
  console.log("\n  Creating organization users...");
  let orgUserCount = 0;

  for (const [icaoCode, orgId] of orgMap.entries()) {
    // Create one admin user per org
    const adminTemplate = ORG_USER_TEMPLATES[0];
    const adminEmail = `admin@${icaoCode.toLowerCase()}.example`;

    const adminUser = await prisma.user.upsert({
      where: { email: adminEmail },
      update: {
        firstName: adminTemplate.firstName,
        lastName: `${adminTemplate.lastName} (${icaoCode})`,
        role: adminTemplate.role,
        locale: adminTemplate.locale,
        organizationId: orgId,
        isActive: true,
      },
      create: {
        email: adminEmail,
        firstName: adminTemplate.firstName,
        lastName: `${adminTemplate.lastName} (${icaoCode})`,
        role: adminTemplate.role,
        locale: adminTemplate.locale,
        organizationId: orgId,
        isActive: true,
      },
    });

    userMap.set(adminEmail, adminUser.id);
    orgUserCount++;

    // Create safety manager for some orgs
    if (["ASECNA", "NAMA", "KCAA", "SACAA", "ECAA"].includes(icaoCode)) {
      const safetyTemplate = ORG_USER_TEMPLATES[1];
      const safetyEmail = `safety@${icaoCode.toLowerCase()}.example`;

      const safetyUser = await prisma.user.upsert({
        where: { email: safetyEmail },
        update: {
          firstName: safetyTemplate.firstName,
          lastName: `${safetyTemplate.lastName} (${icaoCode})`,
          role: safetyTemplate.role,
          locale: safetyTemplate.locale,
          organizationId: orgId,
          isActive: true,
        },
        create: {
          email: safetyEmail,
          firstName: safetyTemplate.firstName,
          lastName: `${safetyTemplate.lastName} (${icaoCode})`,
          role: safetyTemplate.role,
          locale: safetyTemplate.locale,
          organizationId: orgId,
          isActive: true,
        },
      });

      userMap.set(safetyEmail, safetyUser.id);
      orgUserCount++;
    }
  }

  console.log(`  ✓ Created ${orgUserCount} organization users`);
  return userMap;
}

async function seedAssessments(
  orgMap: Map<string, string>,
  // eslint-disable-next-line @typescript-eslint/no-unused-vars
  _userMap: Map<string, string>
): Promise<void> {
  console.log("\n📋 Seeding assessments...");

  // Get questionnaires
  const ansQuestionnaire = await prisma.questionnaire.findFirst({
    where: { type: "ANS_USOAP_CMA", isActive: true },
    include: { questions: { select: { id: true } } },
  });

  const smsQuestionnaire = await prisma.questionnaire.findFirst({
    where: { type: "SMS_CANSO_SOE", isActive: true },
    include: { questions: { select: { id: true } } },
  });

  if (!ansQuestionnaire || !smsQuestionnaire) {
    console.log("  ⚠ Questionnaires not found. Run seed.ts first.");
    return;
  }

  console.log(`  Found ANS questionnaire with ${ansQuestionnaire.questions.length} questions`);
  console.log(`  Found SMS questionnaire with ${smsQuestionnaire.questions.length} questions`);

  // Define assessment scenarios
  interface AssessmentScenario {
    orgCode: string;
    type: AssessmentType;
    questionnaireType: QuestionnaireType;
    status: AssessmentStatus;
    progress: number;
    responseDistribution?: {
      satisfactory?: number;
      notSatisfactory?: number;
      notApplicable?: number;
    } | {
      A?: number;
      B?: number;
      C?: number;
      D?: number;
      E?: number;
    };
    daysAgo: number;
    dueInDays?: number;
  }

  const scenarios: AssessmentScenario[] = [
    // Completed assessments
    {
      orgCode: "ASECNA",
      type: "SELF_ASSESSMENT",
      questionnaireType: "ANS_USOAP_CMA",
      status: "COMPLETED",
      progress: 100,
      responseDistribution: { satisfactory: 85, notSatisfactory: 10, notApplicable: 5 },
      daysAgo: 30,
    },
    {
      orgCode: "ASECNA",
      type: "SELF_ASSESSMENT",
      questionnaireType: "SMS_CANSO_SOE",
      status: "COMPLETED",
      progress: 100,
      responseDistribution: { A: 2, B: 8, C: 30, D: 45, E: 15 },
      daysAgo: 25,
    },
    {
      orgCode: "NAMA",
      type: "SELF_ASSESSMENT",
      questionnaireType: "ANS_USOAP_CMA",
      status: "COMPLETED",
      progress: 100,
      responseDistribution: { satisfactory: 75, notSatisfactory: 20, notApplicable: 5 },
      daysAgo: 45,
    },
    // Under review
    {
      orgCode: "KCAA",
      type: "SELF_ASSESSMENT",
      questionnaireType: "ANS_USOAP_CMA",
      status: "UNDER_REVIEW",
      progress: 100,
      responseDistribution: { satisfactory: 80, notSatisfactory: 15, notApplicable: 5 },
      daysAgo: 10,
    },
    {
      orgCode: "SACAA",
      type: "SELF_ASSESSMENT",
      questionnaireType: "SMS_CANSO_SOE",
      status: "UNDER_REVIEW",
      progress: 100,
      responseDistribution: { A: 5, B: 10, C: 35, D: 40, E: 10 },
      daysAgo: 7,
    },
    // Submitted
    {
      orgCode: "ECAA",
      type: "SELF_ASSESSMENT",
      questionnaireType: "ANS_USOAP_CMA",
      status: "SUBMITTED",
      progress: 100,
      responseDistribution: { satisfactory: 70, notSatisfactory: 25, notApplicable: 5 },
      daysAgo: 3,
    },
    {
      orgCode: "TCAA",
      type: "GAP_ANALYSIS",
      questionnaireType: "SMS_CANSO_SOE",
      status: "SUBMITTED",
      progress: 100,
      responseDistribution: { A: 10, B: 20, C: 40, D: 25, E: 5 },
      daysAgo: 5,
    },
    // In progress
    {
      orgCode: "GCAA",
      type: "SELF_ASSESSMENT",
      questionnaireType: "ANS_USOAP_CMA",
      status: "DRAFT",
      progress: 65,
      responseDistribution: { satisfactory: 60, notSatisfactory: 30, notApplicable: 10 },
      daysAgo: 14,
      dueInDays: 21,
    },
    {
      orgCode: "UCAA",
      type: "SELF_ASSESSMENT",
      questionnaireType: "SMS_CANSO_SOE",
      status: "DRAFT",
      progress: 40,
      responseDistribution: { A: 8, B: 15, C: 40, D: 30, E: 7 },
      daysAgo: 20,
      dueInDays: 14,
    },
    {
      orgCode: "RCAA",
      type: "PEER_REVIEW",
      questionnaireType: "ANS_USOAP_CMA",
      status: "DRAFT",
      progress: 25,
      responseDistribution: { satisfactory: 50, notSatisfactory: 40, notApplicable: 10 },
      daysAgo: 7,
      dueInDays: 45,
    },
    // Just started
    {
      orgCode: "NAMA",
      type: "GAP_ANALYSIS",
      questionnaireType: "SMS_CANSO_SOE",
      status: "DRAFT",
      progress: 10,
      daysAgo: 2,
      dueInDays: 60,
    },
    {
      orgCode: "KCAA",
      type: "FOLLOW_UP",
      questionnaireType: "SMS_CANSO_SOE",
      status: "DRAFT",
      progress: 5,
      daysAgo: 1,
      dueInDays: 30,
    },
  ];

  let assessmentCount = 0;
  let responseCount = 0;

  for (const scenario of scenarios) {
    const orgId = orgMap.get(scenario.orgCode);
    if (!orgId) {
      console.log(`  ⚠ Organization ${scenario.orgCode} not found, skipping`);
      continue;
    }

    const questionnaire = scenario.questionnaireType === "ANS_USOAP_CMA"
      ? ansQuestionnaire
      : smsQuestionnaire;

    // Calculate dates
    const createdAt = new Date();
    createdAt.setDate(createdAt.getDate() - scenario.daysAgo);

    const dueDate = scenario.dueInDays
      ? new Date(Date.now() + scenario.dueInDays * 24 * 60 * 60 * 1000)
      : null;

    // Create assessment
    const assessment = await prisma.assessment.create({
      data: {
        type: scenario.type,
        title: `${scenario.type.replace(/_/g, " ")} - ${scenario.orgCode} ${questionnaire.type === "ANS_USOAP_CMA" ? "ANS" : "SMS"} ${new Date().getFullYear()}`,
        description: `${scenario.type.replace(/_/g, " ")} using ${questionnaire.titleEn}`,
        questionnaireId: questionnaire.id,
        organizationId: orgId,
        status: scenario.status,
        progress: scenario.progress,
        startedAt: createdAt,
        submittedAt: ["SUBMITTED", "UNDER_REVIEW", "COMPLETED"].includes(scenario.status)
          ? new Date(createdAt.getTime() + 7 * 24 * 60 * 60 * 1000)
          : null,
        completedAt: scenario.status === "COMPLETED"
          ? new Date(createdAt.getTime() + 14 * 24 * 60 * 60 * 1000)
          : null,
        dueDate,
        createdAt,
      },
    });

    assessmentCount++;

    // Create responses based on progress
    const totalQuestions = questionnaire.questions.length;
    const questionsToAnswer = Math.floor((scenario.progress / 100) * totalQuestions);

    for (let i = 0; i < questionsToAnswer; i++) {
      const question = questionnaire.questions[i];

      if (questionnaire.type === "ANS_USOAP_CMA") {
        const responseValue = generateANSResponse(
          i,
          scenario.responseDistribution as { satisfactory: number; notSatisfactory: number; notApplicable: number }
        );

        await prisma.assessmentResponse.create({
          data: {
            assessmentId: assessment.id,
            questionId: question.id,
            responseValue,
            notes: i % 5 === 0 ? `Sample evidence note for question ${i + 1}` : null,
            respondedAt: createdAt,
          },
        });
      } else {
        const maturityLevel = generateSMSMaturityLevel(
          i,
          scenario.responseDistribution as { A: number; B: number; C: number; D: number; E: number }
        );

        const scoreMap: Record<MaturityLevel, number> = {
          LEVEL_A: 1,
          LEVEL_B: 2,
          LEVEL_C: 3,
          LEVEL_D: 4,
          LEVEL_E: 5,
        };

        await prisma.assessmentResponse.create({
          data: {
            assessmentId: assessment.id,
            questionId: question.id,
            maturityLevel,
            score: scoreMap[maturityLevel],
            notes: i % 5 === 0 ? `Sample evidence note for question ${i + 1}` : null,
            respondedAt: createdAt,
          },
        });
      }

      responseCount++;
    }

    // Create remaining empty responses
    for (let i = questionsToAnswer; i < totalQuestions; i++) {
      const question = questionnaire.questions[i];

      await prisma.assessmentResponse.create({
        data: {
          assessmentId: assessment.id,
          questionId: question.id,
        },
      });

      responseCount++;
    }

    // Calculate and update scores for completed/submitted assessments
    if (scenario.progress === 100 && ["SUBMITTED", "UNDER_REVIEW", "COMPLETED"].includes(scenario.status)) {
      // Recalculate scores
      const responses = await prisma.assessmentResponse.findMany({
        where: { assessmentId: assessment.id },
        include: { question: true },
      });

      if (questionnaire.type === "ANS_USOAP_CMA") {
        const satisfactory = responses.filter(r => r.responseValue === "SATISFACTORY").length;
        const notSatisfactory = responses.filter(r => r.responseValue === "NOT_SATISFACTORY").length;
        const applicable = satisfactory + notSatisfactory;
        const eiScore = applicable > 0 ? Math.round((satisfactory / applicable) * 100 * 100) / 100 : 0;

        await prisma.assessment.update({
          where: { id: assessment.id },
          data: {
            eiScore,
            overallScore: eiScore,
          },
        });
      } else {
        const scoredResponses = responses.filter(r => r.maturityLevel !== null);
        const totalScore = scoredResponses.reduce((sum, r) => sum + (r.score ?? 0), 0);
        const avgScore = scoredResponses.length > 0 ? totalScore / scoredResponses.length : 0;
        const overallScore = Math.round((avgScore / 5) * 100);

        const getLevel = (score: number): MaturityLevel => {
          if (score >= 4.5) return "LEVEL_E";
          if (score >= 3.5) return "LEVEL_D";
          if (score >= 2.5) return "LEVEL_C";
          if (score >= 1.5) return "LEVEL_B";
          return "LEVEL_A";
        };

        await prisma.assessment.update({
          where: { id: assessment.id },
          data: {
            maturityLevel: getLevel(avgScore),
            overallScore,
          },
        });
      }
    }

    console.log(`  ✓ ${scenario.orgCode} ${scenario.questionnaireType === "ANS_USOAP_CMA" ? "ANS" : "SMS"} - ${scenario.status} (${scenario.progress}%)`);
  }

  console.log(`\n  Summary: ${assessmentCount} assessments, ${responseCount} responses`);
}

async function seedAuditLogs(userMap: Map<string, string>): Promise<void> {
  console.log("\n📝 Seeding audit logs...");

  const adminUserId = userMap.get("admin@aaprp.org");
  if (!adminUserId) {
    console.log("  ⚠ Admin user not found, skipping audit logs");
    return;
  }

  // Get some assessments
  const assessments = await prisma.assessment.findMany({
    take: 5,
    orderBy: { createdAt: "desc" },
  });

  for (const assessment of assessments) {
    await prisma.auditLog.create({
      data: {
        userId: adminUserId,
        action: "VIEW",
        entityType: "Assessment",
        entityId: assessment.id,
        createdAt: new Date(),
      },
    });
  }

  console.log(`  ✓ Created ${assessments.length} audit log entries`);
}

// =============================================================================
// MAIN
// =============================================================================

async function main() {
  console.log("🚀 Starting demo data generation...");
  console.log("═".repeat(50));

  try {
    // 1. Seed organizations
    const orgMap = await seedOrganizations();
    console.log(`\n  Total organizations: ${orgMap.size}`);

    // 2. Seed users
    const userMap = await seedUsers(orgMap);
    console.log(`\n  Total users: ${userMap.size}`);

    // 3. Seed assessments
    await seedAssessments(orgMap, userMap);

    // 4. Seed audit logs
    await seedAuditLogs(userMap);

    console.log("\n═".repeat(50));
    console.log("✅ Demo data generation completed successfully!");
    console.log("\n📊 Summary:");
    console.log(`  • ${orgMap.size} organizations (African ANSPs)`);
    console.log(`  • ${userMap.size} users across all roles`);
    console.log(`  • Multiple assessments in various stages`);
    console.log(`  • Realistic response distributions`);

    console.log("\n🔑 Test Accounts:");
    console.log("  • admin@aaprp.org (Super Admin)");
    console.log("  • coordinator@aaprp.org (Programme Coordinator)");
    console.log("  • lead.reviewer@aaprp.org (Lead Reviewer)");
    console.log("  • admin@asecna.example (ASECNA Admin)");
    console.log("  • admin@nama.example (NAMA Admin)");
    console.log("  • admin@kcaa.example (KCAA Admin)");

  } catch (error) {
    console.error("\n❌ Demo data generation failed:", error);
    throw error;
  }
}

main()
  .catch((e) => {
    console.error(e);
    process.exit(1);
  })
  .finally(async () => {
    await prisma.$disconnect();
    await pool.end();
  });

```

# prisma/seed-dev-users.ts

```ts
/**
 * Development Users Seed Script
 *
 * Creates test organizations and users for development.
 * DO NOT run in production!
 *
 * Usage: npx tsx prisma/seed-dev-users.ts
 *
 * =============================================================================
 * AFRICAN ANSP PEER REVIEW PROGRAMME - TEAM STRUCTURE
 * =============================================================================
 *
 * The programme organizes 22 African ANSPs into 5 peer review teams:
 *
 * Team 1 (Southern Africa - ESAF):
 *   - ASECNA (Steering Committee Chair)
 *   - ATNS (Steering Committee Vice-Chair)
 *   - Botswana CAA
 *   - Eswatini CAA
 *
 * Team 2 (East Africa - ESAF):
 *   - Uganda CAA
 *   - Tanzania CAA
 *   - Burundi CAA
 *   - Rwanda CAA
 *   - Kenya CAA
 *
 * Team 3 (West Africa - WACAF):
 *   - NAMA (Nigeria)
 *   - GCAA (Ghana)
 *   - Roberts FIR (Guinea/Liberia/Sierra Leone)
 *
 * Team 4 (Southern/Eastern Africa - ESAF):
 *   - Mozambique Airports (ADM)
 *   - Malawi DCA
 *   - ADEMA (Madagascar)
 *   - CAAZ (Zimbabwe)
 *   - ZACL (Zambia)
 *
 * Team 5 (North Africa - NORTHERN):
 *   - ONDA (Morocco)
 *   - OACA (Tunisia)
 *   - ENNA (Algeria)
 *
 * Programme Bodies:
 *   - CANSO Africa Secretariat (Johannesburg)
 *
 * =============================================================================
 * PRODUCTION ONBOARDING FLOW (TODO: Implement)
 * =============================================================================
 *
 * The African ANSP Peer Review Programme follows a controlled access model:
 *
 * 1. ORGANIZATION REGISTRATION
 *    - CANSO Africa Secretariat (Super Admin) creates Organizations
 *    - Organizations represent member ANSPs participating in the programme
 *    - Each ANSP is identified by their ICAO designator
 *    - Organization details include: name, country, ICAO code, contact info
 *
 * 2. USER INVITATION FLOW
 *    Step 1: Super Admin creates Organization
 *    Step 2: Super Admin or Programme Coordinator invites initial Org Admin
 *            - System generates secure invitation token
 *            - Email sent with registration link: /register?token=xxx
 *    Step 3: Org Admin clicks link, completes registration
 *            - Email is pre-verified (came from invitation)
 *            - Sets password, profile info
 *            - Automatically assigned to organization with ANSP_ADMIN role
 *    Step 4: Org Admin invites their team members
 *            - Can invite: SAFETY_MANAGER, QUALITY_MANAGER, STAFF
 *            - Same invitation flow
 *    Step 5: Programme Coordinator assigns external reviewers
 *            - Reviewers are users from OTHER organizations
 *            - Assigned PEER_REVIEWER role for specific reviews
 *
 * 3. ROLE HIERARCHY & PERMISSIONS
 *
 *    SUPER_ADMIN (CANSO Secretariat)
 *    ├── Full system access
 *    ├── Create/manage organizations
 *    ├── Assign Programme Coordinators
 *    └── Override any action
 *
 *    SYSTEM_ADMIN (Technical)
 *    ├── System configuration
 *    ├── User management
 *    └── Audit logs access
 *
 *    PROGRAMME_COORDINATOR (CANSO Staff)
 *    ├── Create/manage peer reviews
 *    ├── Assign reviewers to reviews
 *    ├── View all assessments
 *    └── Generate programme reports
 *
 *    ANSP_ADMIN (Organization Focal Point)
 *    ├── Manage own organization's users
 *    ├── Invite team members
 *    ├── View all org assessments
 *    └── Submit assessments for review
 *
 *    SAFETY_MANAGER (Organization)
 *    ├── Create/lead assessments
 *    ├── Assign questions to staff
 *    ├── Review team responses
 *    └── Finalize for submission
 *
 *    QUALITY_MANAGER (Organization)
 *    ├── Review assessment quality
 *    ├── Approve before submission
 *    └── Track corrective actions
 *
 *    STAFF (Organization)
 *    ├── Answer assigned questions
 *    ├── Upload evidence
 *    └── Add notes/comments
 *
 *    PEER_REVIEWER (Cross-Organization)
 *    ├── Review submitted assessments
 *    ├── Provide findings/recommendations
 *    └── Access limited to assigned reviews
 *
 *    OBSERVER (Read-Only)
 *    ├── View dashboards
 *    └── No edit permissions
 *
 * =============================================================================
 */

import "dotenv/config";
import { Pool } from "pg";
import { PrismaPg } from "@prisma/adapter-pg";
import { PrismaClient, UserRole, AfricanRegion, MembershipStatus } from "@prisma/client";
import { hash } from "bcryptjs";

const pool = new Pool({ connectionString: process.env.DATABASE_URL });
const adapter = new PrismaPg(pool);
const prisma = new PrismaClient({ adapter });

// =============================================================================
// DEVELOPMENT TEST DATA
// =============================================================================

const DEV_PASSWORD = "DevPassword123!"; // ONLY for development!

/**
 * All African ANSPs in the Peer Review Programme
 * Organized by peer review team (1-5)
 */
const ORGANIZATIONS: Array<{
  nameEn: string;
  nameFr: string;
  icaoCode: string;
  country: string;
  city: string;
  region: AfricanRegion;
  peerReviewTeam: number | null;
  membershipStatus: MembershipStatus;
}> = [
  // ==========================================================================
  // PROGRAMME SECRETARIAT (No team assignment)
  // ==========================================================================
  {
    nameEn: "CANSO Africa Secretariat",
    nameFr: "Secrétariat CANSO Afrique",
    icaoCode: "CANSO",
    country: "South Africa",
    city: "Johannesburg",
    region: "ESAF",
    peerReviewTeam: null,
    membershipStatus: "ACTIVE",
  },

  // ==========================================================================
  // TEAM 1 - Southern Africa (ESAF)
  // ==========================================================================
  {
    nameEn: "ASECNA - Agency for Aerial Navigation Safety in Africa and Madagascar",
    nameFr: "ASECNA - Agence pour la Sécurité de la Navigation Aérienne en Afrique et à Madagascar",
    icaoCode: "ASEC",
    country: "Senegal",
    city: "Dakar",
    region: "WACAF", // HQ in WACAF but serves multiple regions
    peerReviewTeam: 1,
    membershipStatus: "ACTIVE",
  },
  {
    nameEn: "ATNS - Air Traffic and Navigation Services",
    nameFr: "ATNS - Services de Circulation Aérienne et de Navigation",
    icaoCode: "FAJA",
    country: "South Africa",
    city: "Johannesburg",
    region: "ESAF",
    peerReviewTeam: 1,
    membershipStatus: "ACTIVE",
  },
  {
    nameEn: "Civil Aviation Authority of Botswana",
    nameFr: "Autorité de l'Aviation Civile du Botswana",
    icaoCode: "FBSK",
    country: "Botswana",
    city: "Gaborone",
    region: "ESAF",
    peerReviewTeam: 1,
    membershipStatus: "ACTIVE",
  },
  {
    nameEn: "Eswatini Civil Aviation Authority",
    nameFr: "Autorité de l'Aviation Civile d'Eswatini",
    icaoCode: "FDSK",
    country: "Eswatini",
    city: "Mbabane",
    region: "ESAF",
    peerReviewTeam: 1,
    membershipStatus: "ACTIVE",
  },

  // ==========================================================================
  // TEAM 2 - East Africa (ESAF)
  // ==========================================================================
  {
    nameEn: "Uganda Civil Aviation Authority",
    nameFr: "Autorité de l'Aviation Civile de l'Ouganda",
    icaoCode: "HUEN",
    country: "Uganda",
    city: "Kampala",
    region: "ESAF",
    peerReviewTeam: 2,
    membershipStatus: "ACTIVE",
  },
  {
    nameEn: "Tanzania Civil Aviation Authority",
    nameFr: "Autorité de l'Aviation Civile de la Tanzanie",
    icaoCode: "HTDA",
    country: "Tanzania",
    city: "Dar es Salaam",
    region: "ESAF",
    peerReviewTeam: 2,
    membershipStatus: "ACTIVE",
  },
  {
    nameEn: "Burundi Civil Aviation Authority",
    nameFr: "Autorité de l'Aviation Civile du Burundi",
    icaoCode: "HBBA",
    country: "Burundi",
    city: "Bujumbura",
    region: "ESAF",
    peerReviewTeam: 2,
    membershipStatus: "ACTIVE",
  },
  {
    nameEn: "Rwanda Civil Aviation Authority",
    nameFr: "Autorité de l'Aviation Civile du Rwanda",
    icaoCode: "HRYR",
    country: "Rwanda",
    city: "Kigali",
    region: "ESAF",
    peerReviewTeam: 2,
    membershipStatus: "ACTIVE",
  },
  {
    nameEn: "Kenya Civil Aviation Authority",
    nameFr: "Autorité de l'Aviation Civile du Kenya",
    icaoCode: "HKJK",
    country: "Kenya",
    city: "Nairobi",
    region: "ESAF",
    peerReviewTeam: 2,
    membershipStatus: "ACTIVE",
  },

  // ==========================================================================
  // TEAM 3 - West Africa (WACAF)
  // ==========================================================================
  {
    nameEn: "Nigerian Airspace Management Agency",
    nameFr: "Agence Nigériane de Gestion de l'Espace Aérien",
    icaoCode: "NAMA",
    country: "Nigeria",
    city: "Lagos",
    region: "WACAF",
    peerReviewTeam: 3,
    membershipStatus: "ACTIVE",
  },
  {
    nameEn: "Ghana Civil Aviation Authority",
    nameFr: "Autorité de l'Aviation Civile du Ghana",
    icaoCode: "DGAA",
    country: "Ghana",
    city: "Accra",
    region: "WACAF",
    peerReviewTeam: 3,
    membershipStatus: "ACTIVE",
  },
  {
    nameEn: "Roberts FIR",
    nameFr: "FIR Roberts",
    icaoCode: "GLRB",
    country: "Liberia",
    city: "Robertsfield",
    region: "WACAF",
    peerReviewTeam: 3,
    membershipStatus: "ACTIVE",
  },

  // ==========================================================================
  // TEAM 4 - Southern/Eastern Africa (ESAF)
  // ==========================================================================
  {
    nameEn: "Aeroportos de Moçambique",
    nameFr: "Aéroports du Mozambique",
    icaoCode: "FQMA",
    country: "Mozambique",
    city: "Maputo",
    region: "ESAF",
    peerReviewTeam: 4,
    membershipStatus: "ACTIVE",
  },
  {
    nameEn: "Department of Civil Aviation - Malawi",
    nameFr: "Département de l'Aviation Civile - Malawi",
    icaoCode: "FWLI",
    country: "Malawi",
    city: "Lilongwe",
    region: "ESAF",
    peerReviewTeam: 4,
    membershipStatus: "ACTIVE",
  },
  {
    nameEn: "ADEMA - Aéroports de Madagascar",
    nameFr: "ADEMA - Aéroports de Madagascar",
    icaoCode: "FMMI",
    country: "Madagascar",
    city: "Antananarivo",
    region: "ESAF",
    peerReviewTeam: 4,
    membershipStatus: "ACTIVE",
  },
  {
    nameEn: "Civil Aviation Authority of Zimbabwe",
    nameFr: "Autorité de l'Aviation Civile du Zimbabwe",
    icaoCode: "FVHA",
    country: "Zimbabwe",
    city: "Harare",
    region: "ESAF",
    peerReviewTeam: 4,
    membershipStatus: "ACTIVE",
  },
  {
    nameEn: "Zambia Airports Corporation Limited",
    nameFr: "Société des Aéroports de Zambie",
    icaoCode: "FLLS",
    country: "Zambia",
    city: "Lusaka",
    region: "ESAF",
    peerReviewTeam: 4,
    membershipStatus: "ACTIVE",
  },

  // ==========================================================================
  // TEAM 5 - North Africa (NORTHERN)
  // ==========================================================================
  {
    nameEn: "ONDA - Office National des Aéroports",
    nameFr: "ONDA - Office National des Aéroports",
    icaoCode: "GMMN",
    country: "Morocco",
    city: "Casablanca",
    region: "NORTHERN",
    peerReviewTeam: 5,
    membershipStatus: "ACTIVE",
  },
  {
    nameEn: "OACA - Office de l'Aviation Civile et des Aéroports",
    nameFr: "OACA - Office de l'Aviation Civile et des Aéroports",
    icaoCode: "DTTA",
    country: "Tunisia",
    city: "Tunis",
    region: "NORTHERN",
    peerReviewTeam: 5,
    membershipStatus: "ACTIVE",
  },
  {
    nameEn: "ENNA - Établissement National de la Navigation Aérienne",
    nameFr: "ENNA - Établissement National de la Navigation Aérienne",
    icaoCode: "DAAG",
    country: "Algeria",
    city: "Algiers",
    region: "NORTHERN",
    peerReviewTeam: 5,
    membershipStatus: "ACTIVE",
  },
];

/**
 * Test users with various roles across organizations
 */
const USERS: Array<{
  email: string;
  firstName: string;
  lastName: string;
  role: UserRole;
  orgCode: string;
  title: string;
}> = [
  // ==========================================================================
  // CANSO SECRETARIAT - Programme Administration
  // ==========================================================================
  {
    email: "superadmin@aaprp.org",
    firstName: "System",
    lastName: "Administrator",
    role: UserRole.SUPER_ADMIN,
    orgCode: "CANSO",
    title: "System Administrator",
  },
  {
    email: "coordinator@aaprp.org",
    firstName: "Pauline",
    lastName: "Runghen",
    role: UserRole.PROGRAMME_COORDINATOR,
    orgCode: "CANSO",
    title: "Programme Coordinator",
  },
  {
    email: "coordinator2@aaprp.org",
    firstName: "Michael",
    lastName: "Ouma",
    role: UserRole.PROGRAMME_COORDINATOR,
    orgCode: "CANSO",
    title: "Regional Coordinator - East Africa",
  },

  // ==========================================================================
  // TEAM 1 - ASECNA (Steering Committee Chair)
  // ==========================================================================
  {
    email: "admin@asecna.aero",
    firstName: "Amadou",
    lastName: "Diallo",
    role: UserRole.ANSP_ADMIN,
    orgCode: "ASEC",
    title: "ANSP Focal Point",
  },
  {
    email: "safety@asecna.aero",
    firstName: "Marie",
    lastName: "Ndiaye",
    role: UserRole.SAFETY_MANAGER,
    orgCode: "ASEC",
    title: "Safety Manager",
  },
  {
    email: "quality@asecna.aero",
    firstName: "Ibrahim",
    lastName: "Toure",
    role: UserRole.QUALITY_MANAGER,
    orgCode: "ASEC",
    title: "Quality Manager",
  },
  {
    email: "staff@asecna.aero",
    firstName: "Fatou",
    lastName: "Diop",
    role: UserRole.STAFF,
    orgCode: "ASEC",
    title: "Safety Officer",
  },

  // ==========================================================================
  // TEAM 1 - ATNS (Steering Committee Vice-Chair)
  // ==========================================================================
  {
    email: "admin@atns.co.za",
    firstName: "Thabo",
    lastName: "Molefe",
    role: UserRole.ANSP_ADMIN,
    orgCode: "FAJA",
    title: "ANSP Focal Point",
  },
  {
    email: "safety@atns.co.za",
    firstName: "Nomvula",
    lastName: "Ndlovu",
    role: UserRole.SAFETY_MANAGER,
    orgCode: "FAJA",
    title: "Safety Manager",
  },

  // ==========================================================================
  // TEAM 1 - Botswana CAA
  // ==========================================================================
  {
    email: "admin@caab.gov.bw",
    firstName: "Kagiso",
    lastName: "Moeng",
    role: UserRole.ANSP_ADMIN,
    orgCode: "FBSK",
    title: "ANSP Focal Point",
  },

  // ==========================================================================
  // TEAM 1 - Eswatini CAA
  // ==========================================================================
  {
    email: "admin@ecaa.org.sz",
    firstName: "Sibusiso",
    lastName: "Dlamini",
    role: UserRole.ANSP_ADMIN,
    orgCode: "FDSK",
    title: "ANSP Focal Point",
  },

  // ==========================================================================
  // TEAM 2 - Uganda CAA
  // ==========================================================================
  {
    email: "admin@caa.go.ug",
    firstName: "Samuel",
    lastName: "Okello",
    role: UserRole.ANSP_ADMIN,
    orgCode: "HUEN",
    title: "ANSP Focal Point",
  },
  {
    email: "safety@caa.go.ug",
    firstName: "Grace",
    lastName: "Nakimuli",
    role: UserRole.SAFETY_MANAGER,
    orgCode: "HUEN",
    title: "Safety Manager",
  },

  // ==========================================================================
  // TEAM 2 - Tanzania CAA
  // ==========================================================================
  {
    email: "admin@tcaa.go.tz",
    firstName: "Joseph",
    lastName: "Mwakasege",
    role: UserRole.ANSP_ADMIN,
    orgCode: "HTDA",
    title: "ANSP Focal Point",
  },

  // ==========================================================================
  // TEAM 2 - Burundi CAA
  // ==========================================================================
  {
    email: "admin@aacb.bi",
    firstName: "Jean-Pierre",
    lastName: "Ndayisaba",
    role: UserRole.ANSP_ADMIN,
    orgCode: "HBBA",
    title: "ANSP Focal Point",
  },

  // ==========================================================================
  // TEAM 2 - Rwanda CAA
  // ==========================================================================
  {
    email: "admin@rcaa.gov.rw",
    firstName: "Emmanuel",
    lastName: "Uwimana",
    role: UserRole.ANSP_ADMIN,
    orgCode: "HRYR",
    title: "ANSP Focal Point",
  },

  // ==========================================================================
  // TEAM 2 - Kenya CAA
  // ==========================================================================
  {
    email: "admin@kcaa.or.ke",
    firstName: "James",
    lastName: "Mwangi",
    role: UserRole.ANSP_ADMIN,
    orgCode: "HKJK",
    title: "ANSP Focal Point",
  },
  {
    email: "safety@kcaa.or.ke",
    firstName: "Grace",
    lastName: "Wanjiku",
    role: UserRole.SAFETY_MANAGER,
    orgCode: "HKJK",
    title: "Safety Manager",
  },

  // ==========================================================================
  // TEAM 3 - NAMA (Nigeria)
  // ==========================================================================
  {
    email: "admin@nama.gov.ng",
    firstName: "Chukwuemeka",
    lastName: "Okonkwo",
    role: UserRole.ANSP_ADMIN,
    orgCode: "NAMA",
    title: "ANSP Focal Point",
  },
  {
    email: "safety@nama.gov.ng",
    firstName: "Amina",
    lastName: "Bello",
    role: UserRole.SAFETY_MANAGER,
    orgCode: "NAMA",
    title: "Director of Safety",
  },
  {
    email: "staff@nama.gov.ng",
    firstName: "Oluwaseun",
    lastName: "Adeyemi",
    role: UserRole.STAFF,
    orgCode: "NAMA",
    title: "Safety Analyst",
  },

  // ==========================================================================
  // TEAM 3 - GCAA (Ghana)
  // ==========================================================================
  {
    email: "admin@gcaa.gov.gh",
    firstName: "Kwame",
    lastName: "Asante",
    role: UserRole.ANSP_ADMIN,
    orgCode: "DGAA",
    title: "ANSP Focal Point",
  },
  {
    email: "safety@gcaa.gov.gh",
    firstName: "Akua",
    lastName: "Mensah",
    role: UserRole.SAFETY_MANAGER,
    orgCode: "DGAA",
    title: "Safety Manager",
  },

  // ==========================================================================
  // TEAM 3 - Roberts FIR (Guinea/Liberia/Sierra Leone)
  // ==========================================================================
  {
    email: "bsdiallo@robertsfir.org",
    firstName: "Boubacar",
    lastName: "Diallo",
    role: UserRole.ANSP_ADMIN,
    orgCode: "GLRB",
    title: "ANSP Focal Point",
  },
  {
    email: "safety@robertsfir.aero",
    firstName: "Mohamed",
    lastName: "Kamara",
    role: UserRole.SAFETY_MANAGER,
    orgCode: "GLRB",
    title: "Safety Manager",
  },
  {
    email: "quality@robertsfir.aero",
    firstName: "Aminata",
    lastName: "Koroma",
    role: UserRole.QUALITY_MANAGER,
    orgCode: "GLRB",
    title: "Quality Manager",
  },

  // ==========================================================================
  // TEAM 4 - Mozambique Airports (ADM)
  // ==========================================================================
  {
    email: "admin@adm.gov.mz",
    firstName: "António",
    lastName: "Machava",
    role: UserRole.ANSP_ADMIN,
    orgCode: "FQMA",
    title: "ANSP Focal Point",
  },

  // ==========================================================================
  // TEAM 4 - Malawi DCA
  // ==========================================================================
  {
    email: "admin@dca.gov.mw",
    firstName: "Chisomo",
    lastName: "Banda",
    role: UserRole.ANSP_ADMIN,
    orgCode: "FWLI",
    title: "ANSP Focal Point",
  },

  // ==========================================================================
  // TEAM 4 - ADEMA (Madagascar)
  // ==========================================================================
  {
    email: "admin@adema.mg",
    firstName: "Andry",
    lastName: "Rakotondrainibe",
    role: UserRole.ANSP_ADMIN,
    orgCode: "FMMI",
    title: "ANSP Focal Point",
  },

  // ==========================================================================
  // TEAM 4 - CAAZ (Zimbabwe)
  // ==========================================================================
  {
    email: "admin@caaz.co.zw",
    firstName: "Tendai",
    lastName: "Moyo",
    role: UserRole.ANSP_ADMIN,
    orgCode: "FVHA",
    title: "ANSP Focal Point",
  },

  // ==========================================================================
  // TEAM 4 - ZACL (Zambia)
  // ==========================================================================
  {
    email: "admin@zacl.co.zm",
    firstName: "Mwamba",
    lastName: "Chilufya",
    role: UserRole.ANSP_ADMIN,
    orgCode: "FLLS",
    title: "ANSP Focal Point",
  },

  // ==========================================================================
  // TEAM 5 - ONDA (Morocco)
  // ==========================================================================
  {
    email: "admin@onda.ma",
    firstName: "Hassan",
    lastName: "El Mansouri",
    role: UserRole.ANSP_ADMIN,
    orgCode: "GMMN",
    title: "ANSP Focal Point",
  },
  {
    email: "safety@onda.ma",
    firstName: "Fatima",
    lastName: "Benali",
    role: UserRole.SAFETY_MANAGER,
    orgCode: "GMMN",
    title: "Safety Manager",
  },

  // ==========================================================================
  // TEAM 5 - OACA (Tunisia)
  // ==========================================================================
  {
    email: "admin@oaca.tn",
    firstName: "Mohamed",
    lastName: "Ben Ahmed",
    role: UserRole.ANSP_ADMIN,
    orgCode: "DTTA",
    title: "ANSP Focal Point",
  },

  // ==========================================================================
  // TEAM 5 - ENNA (Algeria)
  // ==========================================================================
  {
    email: "admin@enna.dz",
    firstName: "Karim",
    lastName: "Boudiaf",
    role: UserRole.ANSP_ADMIN,
    orgCode: "DAAG",
    title: "ANSP Focal Point",
  },
];

// =============================================================================
// SEED FUNCTIONS
// =============================================================================

async function seedOrganizations() {
  console.log("\n🏢 Seeding organizations (22 ANSPs + CANSO Secretariat)...\n");

  const results: { id: string; icaoCode: string | null }[] = [];

  // Group by team for display
  const teams = new Map<number | null, typeof ORGANIZATIONS>();
  for (const org of ORGANIZATIONS) {
    const team = org.peerReviewTeam;
    if (!teams.has(team)) {
      teams.set(team, []);
    }
    teams.get(team)!.push(org);
  }

  // Seed by team
  const teamOrder = [null, 1, 2, 3, 4, 5];
  for (const team of teamOrder) {
    const orgs = teams.get(team) || [];
    if (orgs.length === 0) continue;

    if (team === null) {
      console.log("   📋 Programme Secretariat:");
    } else {
      console.log(`\n   📋 Team ${team}:`);
    }

    for (const org of orgs) {
      const created = await prisma.organization.upsert({
        where: { icaoCode: org.icaoCode },
        update: {
          nameEn: org.nameEn,
          nameFr: org.nameFr,
          country: org.country,
          city: org.city,
          region: org.region,
          peerReviewTeam: org.peerReviewTeam,
          membershipStatus: org.membershipStatus,
        },
        create: {
          nameEn: org.nameEn,
          nameFr: org.nameFr,
          icaoCode: org.icaoCode,
          country: org.country,
          city: org.city,
          region: org.region,
          peerReviewTeam: org.peerReviewTeam,
          membershipStatus: org.membershipStatus,
        },
      });

      results.push({ id: created.id, icaoCode: created.icaoCode });
      console.log(`      ✓ ${org.icaoCode.padEnd(6)} - ${org.nameEn.substring(0, 50)}${org.nameEn.length > 50 ? "..." : ""}`);
    }
  }

  return results;
}

async function seedUsers(
  organizations: { id: string; icaoCode: string | null }[]
) {
  console.log("\n👥 Seeding users...\n");

  const hashedPassword = await hash(DEV_PASSWORD, 12);
  const orgMap = new Map(organizations.map((o) => [o.icaoCode, o.id]));

  const roleOrder: UserRole[] = [
    UserRole.SUPER_ADMIN,
    UserRole.PROGRAMME_COORDINATOR,
    UserRole.ANSP_ADMIN,
    UserRole.SAFETY_MANAGER,
    UserRole.QUALITY_MANAGER,
    UserRole.STAFF,
  ];

  // Sort users by role for nicer output
  const sortedUsers = [...USERS].sort(
    (a, b) => roleOrder.indexOf(a.role as UserRole) - roleOrder.indexOf(b.role as UserRole)
  );

  let currentRole = "";

  for (const user of sortedUsers) {
    const organizationId = orgMap.get(user.orgCode);

    if (!organizationId) {
      console.warn(`   ⚠ Org not found: ${user.orgCode} for ${user.email}`);
      continue;
    }

    // Print role header
    if (user.role !== currentRole) {
      currentRole = user.role;
      console.log(`\n   ${currentRole}:`);
    }

    await prisma.user.upsert({
      where: { email: user.email },
      update: {
        firstName: user.firstName,
        lastName: user.lastName,
        role: user.role,
        organizationId,
        isActive: true,
      },
      create: {
        email: user.email,
        passwordHash: hashedPassword,
        firstName: user.firstName,
        lastName: user.lastName,
        role: user.role,
        organizationId,
        emailVerified: new Date(), // Skip verification in dev
        isActive: true,
      },
    });

    console.log(`      ${user.email.padEnd(35)} - ${user.firstName} ${user.lastName}`);
  }
}

// =============================================================================
// MAIN
// =============================================================================

async function main() {
  console.log("═".repeat(75));
  console.log("  🌍 AFRICAN ANSP PEER REVIEW PROGRAMME - Development Seed");
  console.log("═".repeat(75));
  console.log("\n  ⚠️  WARNING: This creates test data for DEVELOPMENT only!\n");

  try {
    const organizations = await seedOrganizations();
    await seedUsers(organizations);

    console.log("\n" + "═".repeat(75));
    console.log("  ✅ Seed completed successfully!");
    console.log("═".repeat(75));

    console.log("\n  📊 Summary:");
    console.log("     ──────────────────────────────────────────────────────────────");
    console.log(`     Organizations created: ${ORGANIZATIONS.length}`);
    console.log(`     Users created: ${USERS.length}`);
    console.log("     ──────────────────────────────────────────────────────────────");

    console.log("\n  📝 TEST CREDENTIALS:\n");
    console.log(`     Password (all users): ${DEV_PASSWORD}`);
    console.log("\n     Quick access accounts:");
    console.log("     ──────────────────────────────────────────────────────────────");
    console.log("     superadmin@aaprp.org         - Full system access (CANSO)");
    console.log("     coordinator@aaprp.org        - Programme management (CANSO)");
    console.log("     admin@asecna.aero            - ASECNA org admin (Team 1 Chair)");
    console.log("     admin@atns.co.za             - ATNS org admin (Team 1 Vice-Chair)");
    console.log("     bsdiallo@robertsfir.org     - Roberts FIR admin (Team 3)");
    console.log("     admin@nama.gov.ng            - NAMA org admin (Team 3)");
    console.log("     admin@onda.ma                - ONDA org admin (Team 5)");
    console.log("     ──────────────────────────────────────────────────────────────");

    console.log("\n  🌍 Team Overview:");
    console.log("     ──────────────────────────────────────────────────────────────");
    console.log("     Team 1 (ESAF):     ASECNA, ATNS, Botswana, Eswatini");
    console.log("     Team 2 (ESAF):     Uganda, Tanzania, Burundi, Rwanda, Kenya");
    console.log("     Team 3 (WACAF):    NAMA, GCAA, Roberts FIR");
    console.log("     Team 4 (ESAF):     Mozambique, Malawi, Madagascar, Zimbabwe, Zambia");
    console.log("     Team 5 (NORTHERN): ONDA, OACA, ENNA");
    console.log("     ──────────────────────────────────────────────────────────────\n");

  } catch (error) {
    console.error("\n❌ Seed failed:", error);
    throw error;
  }
}

main()
  .catch((e) => {
    console.error(e);
    process.exit(1);
  })
  .finally(async () => {
    await prisma.$disconnect();
    await pool.end();
  });

```

# prisma/seed.ts

```ts
import "dotenv/config";
import { Pool } from "pg";
import { PrismaPg } from "@prisma/adapter-pg";
import { PrismaClient } from "@prisma/client";
import type {
  QuestionnaireType,
  USOAPAuditArea,
  CriticalElement,
  SMSComponent,
  CANSOStudyArea,
  TransversalArea,
  PQAmendmentStatus,
  ResponseType,
  ICAOReferenceType,
} from "@prisma/client";
import * as fs from "fs";
import * as path from "path";

const pool = new Pool({ connectionString: process.env.DATABASE_URL });
const adapter = new PrismaPg(pool);
const prisma = new PrismaClient({ adapter });

// Type definitions for seed data
interface ICAOReferenceData {
  referenceType: ICAOReferenceType;
  document: string;
  chapter?: string | null;
  description?: string | null;
}

interface ANSQuestionData {
  pqNumber: string;
  questionTextEn: string;
  questionTextFr: string;
  auditArea: USOAPAuditArea;
  criticalElement: CriticalElement;
  isPriorityPQ?: boolean;
  requiresOnSite?: boolean;
  pqStatus?: PQAmendmentStatus;
  previousPqNumber?: string | null;
  sortOrder: number;
  guidanceEn?: string | null;
  guidanceFr?: string | null;
  responseType?: ResponseType;
  weight?: number;
  maxScore?: number;
  icaoReferences?: ICAOReferenceData[];
}

interface SMSQuestionData {
  smsComponent: SMSComponent;
  studyArea: CANSOStudyArea;
  transversalArea?: TransversalArea | null;
  questionTextEn: string;
  questionTextFr: string;
  sortOrder: number;
  maturityLevel?: string | null;
  guidanceEn?: string | null;
  guidanceFr?: string | null;
  responseType?: ResponseType;
  weight?: number;
  maxScore?: number;
  icaoReferences?: ICAOReferenceData[];
}

interface CategoryData {
  code: string;
  sortOrder: number;
  nameEn: string;
  nameFr: string;
  descriptionEn?: string | null;
  descriptionFr?: string | null;
  auditArea?: USOAPAuditArea | null;
  criticalElement?: CriticalElement | null;
  smsComponent?: SMSComponent | null;
  studyArea?: CANSOStudyArea | null;
  transversalArea?: TransversalArea | null;
}

interface QuestionnaireData {
  code: string;
  type: QuestionnaireType;
  version: string;
  titleEn: string;
  titleFr: string;
  descriptionEn?: string | null;
  descriptionFr?: string | null;
  effectiveDate: string;
}

interface ANSSeedData {
  questionnaire: QuestionnaireData;
  categories: CategoryData[];
  questions: ANSQuestionData[];
}

interface SMSSeedData {
  questionnaire: QuestionnaireData;
  categories: CategoryData[];
  questions: SMSQuestionData[];
}

async function seedANSQuestionnaire() {
  console.log("Seeding ANS USOAP CMA 2024 questionnaire...");

  const seedDataPath = path.join(__dirname, "seed-data", "ans-usoap-2024.json");
  const seedData: ANSSeedData = JSON.parse(fs.readFileSync(seedDataPath, "utf-8"));

  // Create or update questionnaire
  const questionnaire = await prisma.questionnaire.upsert({
    where: { code: seedData.questionnaire.code },
    update: {
      version: seedData.questionnaire.version,
      titleEn: seedData.questionnaire.titleEn,
      titleFr: seedData.questionnaire.titleFr,
      descriptionEn: seedData.questionnaire.descriptionEn,
      descriptionFr: seedData.questionnaire.descriptionFr,
      effectiveDate: new Date(seedData.questionnaire.effectiveDate),
      isActive: true,
    },
    create: {
      code: seedData.questionnaire.code,
      type: seedData.questionnaire.type,
      version: seedData.questionnaire.version,
      titleEn: seedData.questionnaire.titleEn,
      titleFr: seedData.questionnaire.titleFr,
      descriptionEn: seedData.questionnaire.descriptionEn,
      descriptionFr: seedData.questionnaire.descriptionFr,
      effectiveDate: new Date(seedData.questionnaire.effectiveDate),
      isActive: true,
    },
  });

  console.log(`  Created/updated questionnaire: ${questionnaire.code}`);

  // Create or update categories
  const categoryMap = new Map<string, string>();

  for (const categoryData of seedData.categories) {
    const category = await prisma.questionnaireCategory.upsert({
      where: {
        questionnaireId_code: {
          questionnaireId: questionnaire.id,
          code: categoryData.code,
        },
      },
      update: {
        sortOrder: categoryData.sortOrder,
        nameEn: categoryData.nameEn,
        nameFr: categoryData.nameFr,
        descriptionEn: categoryData.descriptionEn,
        descriptionFr: categoryData.descriptionFr,
        auditArea: categoryData.auditArea,
        criticalElement: categoryData.criticalElement,
      },
      create: {
        questionnaireId: questionnaire.id,
        code: categoryData.code,
        sortOrder: categoryData.sortOrder,
        nameEn: categoryData.nameEn,
        nameFr: categoryData.nameFr,
        descriptionEn: categoryData.descriptionEn,
        descriptionFr: categoryData.descriptionFr,
        auditArea: categoryData.auditArea,
        criticalElement: categoryData.criticalElement,
      },
    });

    categoryMap.set(categoryData.code, category.id);
    console.log(`  Created/updated category: ${category.code}`);
  }

  // Create or update questions
  let questionCount = 0;
  for (const questionData of seedData.questions) {
    // Find the appropriate category based on audit area and critical element
    const categoryCode = `AGA-${questionData.criticalElement.replace("_", "")}`;
    const categoryId = categoryMap.get(categoryCode);

    if (!categoryId) {
      console.warn(`  Warning: Category not found for ${categoryCode}, skipping question ${questionData.pqNumber}`);
      continue;
    }

    // Upsert the question
    const question = await prisma.question.upsert({
      where: {
        questionnaireId_pqNumber: {
          questionnaireId: questionnaire.id,
          pqNumber: questionData.pqNumber,
        },
      },
      update: {
        categoryId,
        questionTextEn: questionData.questionTextEn,
        questionTextFr: questionData.questionTextFr,
        auditArea: questionData.auditArea,
        criticalElement: questionData.criticalElement,
        isPriorityPQ: questionData.isPriorityPQ ?? false,
        requiresOnSite: questionData.requiresOnSite ?? false,
        pqStatus: questionData.pqStatus ?? "NO_CHANGE",
        previousPqNumber: questionData.previousPqNumber,
        guidanceEn: questionData.guidanceEn,
        guidanceFr: questionData.guidanceFr,
        responseType: questionData.responseType ?? "SATISFACTORY_NOT",
        weight: questionData.weight ?? 1.0,
        maxScore: questionData.maxScore ?? 1.0,
        sortOrder: questionData.sortOrder,
        isActive: true,
      },
      create: {
        questionnaireId: questionnaire.id,
        categoryId,
        pqNumber: questionData.pqNumber,
        questionTextEn: questionData.questionTextEn,
        questionTextFr: questionData.questionTextFr,
        auditArea: questionData.auditArea,
        criticalElement: questionData.criticalElement,
        isPriorityPQ: questionData.isPriorityPQ ?? false,
        requiresOnSite: questionData.requiresOnSite ?? false,
        pqStatus: questionData.pqStatus ?? "NO_CHANGE",
        previousPqNumber: questionData.previousPqNumber,
        guidanceEn: questionData.guidanceEn,
        guidanceFr: questionData.guidanceFr,
        responseType: questionData.responseType ?? "SATISFACTORY_NOT",
        weight: questionData.weight ?? 1.0,
        maxScore: questionData.maxScore ?? 1.0,
        sortOrder: questionData.sortOrder,
        isActive: true,
      },
    });

    // Delete existing ICAO references and recreate
    await prisma.iCAOReference.deleteMany({
      where: { questionId: question.id },
    });

    // Create ICAO references
    if (questionData.icaoReferences && questionData.icaoReferences.length > 0) {
      for (const refData of questionData.icaoReferences) {
        await prisma.iCAOReference.create({
          data: {
            questionId: question.id,
            referenceType: refData.referenceType,
            document: refData.document,
            chapter: refData.chapter,
            description: refData.description,
          },
        });
      }
    }

    questionCount++;
  }

  console.log(`  Created/updated ${questionCount} questions with ICAO references`);
  return { questionnaire, categoryCount: categoryMap.size, questionCount };
}

async function seedSMSQuestionnaire() {
  console.log("Seeding SMS CANSO SoE 2024 questionnaire...");

  const seedDataPath = path.join(__dirname, "seed-data", "sms-canso-2024.json");
  const seedData: SMSSeedData = JSON.parse(fs.readFileSync(seedDataPath, "utf-8"));

  // Create or update questionnaire
  const questionnaire = await prisma.questionnaire.upsert({
    where: { code: seedData.questionnaire.code },
    update: {
      version: seedData.questionnaire.version,
      titleEn: seedData.questionnaire.titleEn,
      titleFr: seedData.questionnaire.titleFr,
      descriptionEn: seedData.questionnaire.descriptionEn,
      descriptionFr: seedData.questionnaire.descriptionFr,
      effectiveDate: new Date(seedData.questionnaire.effectiveDate),
      isActive: true,
    },
    create: {
      code: seedData.questionnaire.code,
      type: seedData.questionnaire.type,
      version: seedData.questionnaire.version,
      titleEn: seedData.questionnaire.titleEn,
      titleFr: seedData.questionnaire.titleFr,
      descriptionEn: seedData.questionnaire.descriptionEn,
      descriptionFr: seedData.questionnaire.descriptionFr,
      effectiveDate: new Date(seedData.questionnaire.effectiveDate),
      isActive: true,
    },
  });

  console.log(`  Created/updated questionnaire: ${questionnaire.code}`);

  // Create or update categories
  const categoryMap = new Map<string, string>();

  for (const categoryData of seedData.categories) {
    const category = await prisma.questionnaireCategory.upsert({
      where: {
        questionnaireId_code: {
          questionnaireId: questionnaire.id,
          code: categoryData.code,
        },
      },
      update: {
        sortOrder: categoryData.sortOrder,
        nameEn: categoryData.nameEn,
        nameFr: categoryData.nameFr,
        descriptionEn: categoryData.descriptionEn,
        descriptionFr: categoryData.descriptionFr,
        smsComponent: categoryData.smsComponent,
        studyArea: categoryData.studyArea,
        transversalArea: categoryData.transversalArea,
      },
      create: {
        questionnaireId: questionnaire.id,
        code: categoryData.code,
        sortOrder: categoryData.sortOrder,
        nameEn: categoryData.nameEn,
        nameFr: categoryData.nameFr,
        descriptionEn: categoryData.descriptionEn,
        descriptionFr: categoryData.descriptionFr,
        smsComponent: categoryData.smsComponent,
        studyArea: categoryData.studyArea,
        transversalArea: categoryData.transversalArea,
      },
    });

    categoryMap.set(categoryData.code, category.id);

    // Also map by study area for question assignment
    if (categoryData.studyArea) {
      categoryMap.set(categoryData.studyArea, category.id);
    }

    console.log(`  Created/updated category: ${category.code}`);
  }

  // Create or update questions
  let questionCount = 0;
  for (const questionData of seedData.questions) {
    // Find the appropriate category based on study area
    let categoryId = categoryMap.get(questionData.studyArea);

    if (!categoryId) {
      // Fall back to component-level category
      const componentCode = `SMS-C${questionData.smsComponent === "SAFETY_POLICY_OBJECTIVES" ? "1" :
        questionData.smsComponent === "SAFETY_RISK_MANAGEMENT" ? "2" :
        questionData.smsComponent === "SAFETY_ASSURANCE" ? "3" : "4"}`;
      categoryId = categoryMap.get(componentCode);
    }

    if (!categoryId) {
      console.warn(`  Warning: Category not found for study area ${questionData.studyArea}, skipping question`);
      continue;
    }

    // Generate a unique identifier for SMS questions (they don't have PQ numbers)
    const smsQuestionId = `SMS-${questionData.studyArea}-${questionData.sortOrder}`;

    // Upsert the question
    const question = await prisma.question.upsert({
      where: {
        questionnaireId_pqNumber: {
          questionnaireId: questionnaire.id,
          pqNumber: smsQuestionId,
        },
      },
      update: {
        categoryId,
        questionTextEn: questionData.questionTextEn,
        questionTextFr: questionData.questionTextFr,
        smsComponent: questionData.smsComponent,
        studyArea: questionData.studyArea,
        guidanceEn: questionData.guidanceEn,
        guidanceFr: questionData.guidanceFr,
        responseType: questionData.responseType ?? "MATURITY_LEVEL",
        weight: questionData.weight ?? 1.0,
        maxScore: questionData.maxScore ?? 5.0,
        sortOrder: questionData.sortOrder,
        isActive: true,
      },
      create: {
        questionnaireId: questionnaire.id,
        categoryId,
        pqNumber: smsQuestionId,
        questionTextEn: questionData.questionTextEn,
        questionTextFr: questionData.questionTextFr,
        smsComponent: questionData.smsComponent,
        studyArea: questionData.studyArea,
        guidanceEn: questionData.guidanceEn,
        guidanceFr: questionData.guidanceFr,
        responseType: questionData.responseType ?? "MATURITY_LEVEL",
        weight: questionData.weight ?? 1.0,
        maxScore: questionData.maxScore ?? 5.0,
        sortOrder: questionData.sortOrder,
        isActive: true,
      },
    });

    // Delete existing ICAO references and recreate
    await prisma.iCAOReference.deleteMany({
      where: { questionId: question.id },
    });

    // Create ICAO references
    if (questionData.icaoReferences && questionData.icaoReferences.length > 0) {
      for (const refData of questionData.icaoReferences) {
        await prisma.iCAOReference.create({
          data: {
            questionId: question.id,
            referenceType: refData.referenceType,
            document: refData.document,
            chapter: refData.chapter,
            description: refData.description,
          },
        });
      }
    }

    questionCount++;
  }

  console.log(`  Created/updated ${questionCount} questions with ICAO references`);
  return { questionnaire, categoryCount: categoryMap.size, questionCount };
}

async function main() {
  console.log("Starting database seed...\n");

  try {
    // Seed ANS USOAP CMA questionnaire
    const ansResult = await seedANSQuestionnaire();
    console.log(`\nANS Questionnaire Summary:`);
    console.log(`  - Code: ${ansResult.questionnaire.code}`);
    console.log(`  - Categories: ${ansResult.categoryCount}`);
    console.log(`  - Questions: ${ansResult.questionCount}`);

    // Seed SMS CANSO SoE questionnaire
    const smsResult = await seedSMSQuestionnaire();
    console.log(`\nSMS Questionnaire Summary:`);
    console.log(`  - Code: ${smsResult.questionnaire.code}`);
    console.log(`  - Categories: ${smsResult.categoryCount}`);
    console.log(`  - Questions: ${smsResult.questionCount}`);

    console.log("\n✓ Database seed completed successfully!");
  } catch (error) {
    console.error("\n✗ Database seed failed:", error);
    throw error;
  }
}

main()
  .catch((e) => {
    console.error(e);
    process.exit(1);
  })
  .finally(async () => {
    await prisma.$disconnect();
  });

```

# public/file.svg

This is a file of the type: SVG Image

# public/globe.svg

This is a file of the type: SVG Image

# public/next.svg

This is a file of the type: SVG Image

# public/vercel.svg

This is a file of the type: SVG Image

# public/window.svg

This is a file of the type: SVG Image

# README.md

```md
This is a [Next.js](https://nextjs.org) project bootstrapped with [`create-next-app`](https://nextjs.org/docs/app/api-reference/cli/create-next-app).

## Getting Started

First, run the development server:

\`\`\`bash
npm run dev
# or
yarn dev
# or
pnpm dev
# or
bun dev
\`\`\`

Open [http://localhost:3000](http://localhost:3000) with your browser to see the result.

You can start editing the page by modifying `app/page.tsx`. The page auto-updates as you edit the file.

This project uses [`next/font`](https://nextjs.org/docs/app/building-your-application/optimizing/fonts) to automatically optimize and load [Geist](https://vercel.com/font), a new font family for Vercel.

## Learn More

To learn more about Next.js, take a look at the following resources:

- [Next.js Documentation](https://nextjs.org/docs) - learn about Next.js features and API.
- [Learn Next.js](https://nextjs.org/learn) - an interactive Next.js tutorial.

You can check out [the Next.js GitHub repository](https://github.com/vercel/next.js) - your feedback and contributions are welcome!

## Deploy on Vercel

The easiest way to deploy your Next.js app is to use the [Vercel Platform](https://vercel.com/new?utm_medium=default-template&filter=next.js&utm_source=create-next-app&utm_campaign=create-next-app-readme) from the creators of Next.js.

Check out our [Next.js deployment documentation](https://nextjs.org/docs/app/building-your-application/deploying) for more details.

```

# src/__tests__/helpers/index.ts

```ts
/**
 * Test Helpers
 *
 * Utility functions for creating test data and managing test state.
 */

import type {
  User,
  Organization,
  Assessment,
  Questionnaire,
  Question,
  QuestionnaireCategory,
  UserRole,
  QuestionnaireType,
  AssessmentType,
  AssessmentStatus,
  ResponseType,
  MaturityLevel,
} from "@prisma/client";

// =============================================================================
// MOCK DATA GENERATORS
// =============================================================================

let idCounter = 0;

export function generateId(): string {
  return `test_${++idCounter}_${Date.now()}`;
}

export function resetIdCounter(): void {
  idCounter = 0;
}

// =============================================================================
// MOCK USER
// =============================================================================

export interface MockUserOptions {
  role?: UserRole;
  organizationId?: string;
  locale?: "EN" | "FR";
}

export function createMockUser(options: MockUserOptions = {}): Partial<User> {
  const id = generateId();
  return {
    id,
    email: `user_${id}@test.com`,
    firstName: "Test",
    lastName: "User",
    role: options.role ?? "STAFF",
    organizationId: options.organizationId ?? null,
    locale: options.locale ?? "EN",
    isActive: true,
    createdAt: new Date(),
    updatedAt: new Date(),
  };
}

// =============================================================================
// MOCK ORGANIZATION
// =============================================================================

export function createMockOrganization(): Partial<Organization> {
  const id = generateId();
  return {
    id,
    nameEn: `Test Organization ${id}`,
    nameFr: `Organisation Test ${id}`,
    icaoCode: `TST${id.slice(-3).toUpperCase()}`,
    country: "Test Country",
    region: "WACAF",
    membershipStatus: "ACTIVE",
    createdAt: new Date(),
    updatedAt: new Date(),
  };
}

// =============================================================================
// MOCK QUESTIONNAIRE
// =============================================================================

export interface MockQuestionnaireOptions {
  type?: QuestionnaireType;
  questionCount?: number;
  categoryCount?: number;
}

export function createMockQuestionnaire(
  options: MockQuestionnaireOptions = {}
): Partial<Questionnaire> {
  const id = generateId();
  const type = options.type ?? "ANS_USOAP_CMA";
  return {
    id,
    code: type === "ANS_USOAP_CMA" ? "ANS_2024" : "SMS_2024",
    type,
    version: "2024",
    titleEn:
      type === "ANS_USOAP_CMA"
        ? "USOAP CMA Protocol Questions"
        : "CANSO Standard of Excellence",
    titleFr:
      type === "ANS_USOAP_CMA"
        ? "Questions du protocole USOAP CMA"
        : "Norme d'excellence CANSO",
    descriptionEn: "Test questionnaire description",
    descriptionFr: "Description du questionnaire de test",
    effectiveDate: new Date("2024-07-01"),
    isActive: true,
    createdAt: new Date(),
    updatedAt: new Date(),
  };
}

// =============================================================================
// MOCK CATEGORY
// =============================================================================

export interface MockCategoryOptions {
  questionnaireId: string;
  code?: string;
  sortOrder?: number;
}

export function createMockCategory(
  options: MockCategoryOptions
): Partial<QuestionnaireCategory> {
  const id = generateId();
  return {
    id,
    questionnaireId: options.questionnaireId,
    code: options.code ?? `CAT_${id}`,
    sortOrder: options.sortOrder ?? 1,
    nameEn: `Test Category ${options.code ?? id}`,
    nameFr: `Catégorie Test ${options.code ?? id}`,
    descriptionEn: "Test category description",
    descriptionFr: "Description de la catégorie de test",
    createdAt: new Date(),
    updatedAt: new Date(),
  };
}

// =============================================================================
// MOCK QUESTION
// =============================================================================

export interface MockQuestionOptions {
  questionnaireId: string;
  categoryId: string;
  pqNumber?: string;
  responseType?: ResponseType;
  auditArea?: string;
  criticalElement?: string;
  smsComponent?: string;
  studyArea?: string;
  isPriorityPQ?: boolean;
  sortOrder?: number;
}

export function createMockQuestion(
  options: MockQuestionOptions
): Partial<Question> {
  const id = generateId();
  return {
    id,
    questionnaireId: options.questionnaireId,
    categoryId: options.categoryId,
    pqNumber: options.pqNumber ?? `PQ_${id}`,
    questionTextEn: `Test question ${options.pqNumber ?? id}?`,
    questionTextFr: `Question de test ${options.pqNumber ?? id}?`,
    guidanceEn: "Test guidance for this question.",
    guidanceFr: "Guide de test pour cette question.",
    responseType: options.responseType ?? "SATISFACTORY_NOT",
    requiredEvidence: [],
    weight: 1.0,
    maxScore: 1.0,
    sortOrder: options.sortOrder ?? 1,
    isPriorityPQ: options.isPriorityPQ ?? false,
    requiresOnSite: false,
    isActive: true,
    createdAt: new Date(),
    updatedAt: new Date(),
  };
}

// =============================================================================
// MOCK ASSESSMENT
// =============================================================================

export interface MockAssessmentOptions {
  organizationId: string;
  questionnaireId: string;
  type?: AssessmentType;
  status?: AssessmentStatus;
  progress?: number;
}

export function createMockAssessment(
  options: MockAssessmentOptions
): Partial<Assessment> {
  const id = generateId();
  return {
    id,
    organizationId: options.organizationId,
    questionnaireId: options.questionnaireId,
    type: options.type ?? "SELF_ASSESSMENT",
    title: `Test Assessment ${id}`,
    description: "Test assessment description",
    status: options.status ?? "DRAFT",
    progress: options.progress ?? 0,
    createdAt: new Date(),
    updatedAt: new Date(),
  };
}

// =============================================================================
// MOCK RESPONSES
// =============================================================================

export type ANSResponseValue =
  | "SATISFACTORY"
  | "NOT_SATISFACTORY"
  | "NOT_APPLICABLE"
  | "NOT_REVIEWED";

export type SMSResponseValue =
  | "LEVEL_A"
  | "LEVEL_B"
  | "LEVEL_C"
  | "LEVEL_D"
  | "LEVEL_E";

export interface MockANSResponse {
  questionId: string;
  value: ANSResponseValue;
}

export interface MockSMSResponse {
  questionId: string;
  value: SMSResponseValue;
}

/**
 * Generate random ANS responses with distribution
 */
export function generateANSResponses(
  questionIds: string[],
  distribution?: {
    satisfactory?: number;
    notSatisfactory?: number;
    notApplicable?: number;
    notReviewed?: number;
  }
): MockANSResponse[] {
  const dist = {
    satisfactory: distribution?.satisfactory ?? 60,
    notSatisfactory: distribution?.notSatisfactory ?? 20,
    notApplicable: distribution?.notApplicable ?? 10,
    notReviewed: distribution?.notReviewed ?? 10,
  };

  const total =
    dist.satisfactory +
    dist.notSatisfactory +
    dist.notApplicable +
    dist.notReviewed;

  return questionIds.map((questionId, index) => {
    const rand = (index * 7) % total; // Deterministic pseudo-random
    let value: ANSResponseValue;

    if (rand < dist.satisfactory) {
      value = "SATISFACTORY";
    } else if (rand < dist.satisfactory + dist.notSatisfactory) {
      value = "NOT_SATISFACTORY";
    } else if (
      rand <
      dist.satisfactory + dist.notSatisfactory + dist.notApplicable
    ) {
      value = "NOT_APPLICABLE";
    } else {
      value = "NOT_REVIEWED";
    }

    return { questionId, value };
  });
}

/**
 * Generate random SMS responses with distribution
 */
export function generateSMSResponses(
  questionIds: string[],
  distribution?: {
    levelA?: number;
    levelB?: number;
    levelC?: number;
    levelD?: number;
    levelE?: number;
  }
): MockSMSResponse[] {
  const dist = {
    levelA: distribution?.levelA ?? 5,
    levelB: distribution?.levelB ?? 15,
    levelC: distribution?.levelC ?? 40,
    levelD: distribution?.levelD ?? 30,
    levelE: distribution?.levelE ?? 10,
  };

  const total =
    dist.levelA + dist.levelB + dist.levelC + dist.levelD + dist.levelE;

  return questionIds.map((questionId, index) => {
    const rand = (index * 7) % total; // Deterministic pseudo-random
    let value: SMSResponseValue;

    if (rand < dist.levelA) {
      value = "LEVEL_A";
    } else if (rand < dist.levelA + dist.levelB) {
      value = "LEVEL_B";
    } else if (rand < dist.levelA + dist.levelB + dist.levelC) {
      value = "LEVEL_C";
    } else if (
      rand <
      dist.levelA + dist.levelB + dist.levelC + dist.levelD
    ) {
      value = "LEVEL_D";
    } else {
      value = "LEVEL_E";
    }

    return { questionId, value };
  });
}

// =============================================================================
// SCORING HELPERS
// =============================================================================

/**
 * Calculate expected EI score from responses
 */
export function calculateExpectedEI(responses: MockANSResponse[]): number {
  const satisfactory = responses.filter(
    (r) => r.value === "SATISFACTORY"
  ).length;
  const notSatisfactory = responses.filter(
    (r) => r.value === "NOT_SATISFACTORY"
  ).length;
  const applicable = satisfactory + notSatisfactory;

  if (applicable === 0) return 0;
  return (satisfactory / applicable) * 100;
}

/**
 * Calculate expected SMS maturity score from responses
 */
export function calculateExpectedSMSScore(
  responses: MockSMSResponse[]
): number {
  if (responses.length === 0) return 0;

  const levelValues: Record<SMSResponseValue, number> = {
    LEVEL_A: 1,
    LEVEL_B: 2,
    LEVEL_C: 3,
    LEVEL_D: 4,
    LEVEL_E: 5,
  };

  const total = responses.reduce(
    (sum, r) => sum + levelValues[r.value],
    0
  );
  return total / responses.length;
}

/**
 * Convert numeric score to maturity level
 */
export function scoreToMaturityLevel(score: number): MaturityLevel {
  if (score < 1.5) return "LEVEL_A";
  if (score < 2.5) return "LEVEL_B";
  if (score < 3.5) return "LEVEL_C";
  if (score < 4.5) return "LEVEL_D";
  return "LEVEL_E";
}

// =============================================================================
// ASSERTION HELPERS
// =============================================================================

/**
 * Assert that a number is within tolerance of expected value
 */
export function expectCloseTo(
  actual: number,
  expected: number,
  tolerance = 0.01
): void {
  if (Math.abs(actual - expected) > tolerance) {
    throw new Error(
      `Expected ${actual} to be close to ${expected} (tolerance: ${tolerance})`
    );
  }
}

/**
 * Assert that arrays contain same elements (order-independent)
 */
export function expectSameElements<T>(
  actual: T[],
  expected: T[]
): void {
  if (actual.length !== expected.length) {
    throw new Error(
      `Arrays have different lengths: ${actual.length} vs ${expected.length}`
    );
  }

  const sortedActual = [...actual].sort();
  const sortedExpected = [...expected].sort();

  for (let i = 0; i < sortedActual.length; i++) {
    if (sortedActual[i] !== sortedExpected[i]) {
      throw new Error(
        `Arrays differ at index ${i}: ${sortedActual[i]} vs ${sortedExpected[i]}`
      );
    }
  }
}

```

# src/__tests__/integration/assessment-workflow.test.ts

```ts
/**
 * Assessment Workflow Integration Tests
 *
 * Tests for the complete assessment lifecycle from creation to completion.
 * These tests verify the workflow, status transitions, and data integrity.
 */

import { describe, it, expect } from "vitest";
import type { AssessmentStatus, AssessmentType, QuestionnaireType, UserRole } from "@prisma/client";

// =============================================================================
// MOCK TYPES
// =============================================================================

interface MockUser {
  id: string;
  role: UserRole;
  organizationId: string | null;
}

interface MockAssessment {
  id: string;
  type: AssessmentType;
  status: AssessmentStatus;
  progress: number;
  organizationId: string;
  questionnaireId: string;
  title: string;
  description: string | null;
  startedAt: Date | null;
  submittedAt: Date | null;
  completedAt: Date | null;
  overallScore: number | null;
  eiScore: number | null;
  maturityLevel: string | null;
  questionnaire: {
    id: string;
    type: QuestionnaireType;
    code: string;
    titleEn: string;
    titleFr: string;
  };
  organization: {
    id: string;
    nameEn: string;
    nameFr: string;
  };
}

// =============================================================================
// STATUS TRANSITION CONFIGURATION
// =============================================================================

const STATUS_TRANSITIONS: Record<AssessmentStatus, AssessmentStatus[]> = {
  DRAFT: ["SUBMITTED", "ARCHIVED"],
  SUBMITTED: ["UNDER_REVIEW", "DRAFT"],
  UNDER_REVIEW: ["COMPLETED", "SUBMITTED"],
  COMPLETED: ["ARCHIVED"],
  ARCHIVED: [],
};

const ASSESSMENT_MANAGER_ROLES: UserRole[] = [
  "SUPER_ADMIN",
  "SYSTEM_ADMIN",
  "PROGRAMME_COORDINATOR",
  "ANSP_ADMIN",
  "SAFETY_MANAGER",
  "QUALITY_MANAGER",
];

// =============================================================================
// HELPER FUNCTIONS
// =============================================================================

function canTransition(from: AssessmentStatus, to: AssessmentStatus): boolean {
  return STATUS_TRANSITIONS[from].includes(to);
}

function canAccessAssessment(
  user: MockUser,
  assessment: MockAssessment,
  requireWrite: boolean = false
): { hasAccess: boolean; reason?: string } {
  // Super admins and system admins have full access
  if (["SUPER_ADMIN", "SYSTEM_ADMIN", "PROGRAMME_COORDINATOR"].includes(user.role)) {
    return { hasAccess: true };
  }

  // Check organization membership
  if (user.organizationId !== assessment.organizationId) {
    // Peer reviewers can view submitted assessments
    if (
      ["PEER_REVIEWER", "LEAD_REVIEWER"].includes(user.role) &&
      ["SUBMITTED", "UNDER_REVIEW", "COMPLETED"].includes(assessment.status) &&
      !requireWrite
    ) {
      return { hasAccess: true };
    }

    // Steering committee can view all completed assessments
    if (
      user.role === "STEERING_COMMITTEE" &&
      assessment.status === "COMPLETED" &&
      !requireWrite
    ) {
      return { hasAccess: true };
    }

    return {
      hasAccess: false,
      reason: "You do not have access to this organization's assessments",
    };
  }

  // Organization members - check role for write access
  if (requireWrite && !ASSESSMENT_MANAGER_ROLES.includes(user.role)) {
    return {
      hasAccess: false,
      reason: "You do not have permission to modify assessments",
    };
  }

  return { hasAccess: true };
}

function createMockAssessment(overrides: Partial<MockAssessment> = {}): MockAssessment {
  return {
    id: `assessment_${Math.random().toString(36).slice(2)}`,
    type: "SELF_ASSESSMENT",
    status: "DRAFT",
    progress: 0,
    organizationId: "org_123",
    questionnaireId: "questionnaire_123",
    title: "Test Assessment",
    description: null,
    startedAt: null,
    submittedAt: null,
    completedAt: null,
    overallScore: null,
    eiScore: null,
    maturityLevel: null,
    questionnaire: {
      id: "questionnaire_123",
      type: "ANS_USOAP_CMA",
      code: "ANS_2024",
      titleEn: "ANS USOAP CMA Protocol",
      titleFr: "Protocole ANS USOAP CMA",
    },
    organization: {
      id: "org_123",
      nameEn: "Test ANSP",
      nameFr: "ANSP de test",
    },
    ...overrides,
  };
}

function createMockUser(overrides: Partial<MockUser> = {}): MockUser {
  return {
    id: `user_${Math.random().toString(36).slice(2)}`,
    role: "ANSP_ADMIN",
    organizationId: "org_123",
    ...overrides,
  };
}

// =============================================================================
// WORKFLOW TESTS
// =============================================================================

describe("Assessment Workflow", () => {
  describe("Assessment Lifecycle", () => {
    it("should follow complete ANS assessment lifecycle", async () => {
      // Stage 1: Create assessment in DRAFT status
      const assessment = createMockAssessment({
        type: "SELF_ASSESSMENT",
        status: "DRAFT",
        questionnaire: {
          id: "questionnaire_ans",
          type: "ANS_USOAP_CMA",
          code: "ANS_2024",
          titleEn: "ANS Protocol",
          titleFr: "Protocole ANS",
        },
      });

      expect(assessment.status).toBe("DRAFT");
      expect(assessment.progress).toBe(0);
      expect(assessment.startedAt).toBeNull();

      // Stage 2: Start assessment
      assessment.startedAt = new Date();
      expect(assessment.startedAt).toBeInstanceOf(Date);

      // Stage 3: Save responses and update progress
      assessment.progress = 50;
      expect(assessment.progress).toBe(50);

      // Stage 4: Complete all responses
      assessment.progress = 100;
      expect(assessment.progress).toBe(100);

      // Stage 5: Submit assessment
      expect(canTransition("DRAFT", "SUBMITTED")).toBe(true);
      assessment.status = "SUBMITTED";
      assessment.submittedAt = new Date();
      assessment.overallScore = 85.5;
      assessment.eiScore = 85.5;

      expect(assessment.status).toBe("SUBMITTED");
      expect(assessment.submittedAt).toBeInstanceOf(Date);
      expect(assessment.overallScore).toBe(85.5);

      // Stage 6: Start review
      expect(canTransition("SUBMITTED", "UNDER_REVIEW")).toBe(true);
      assessment.status = "UNDER_REVIEW";
      expect(assessment.status).toBe("UNDER_REVIEW");

      // Stage 7: Complete assessment
      expect(canTransition("UNDER_REVIEW", "COMPLETED")).toBe(true);
      assessment.status = "COMPLETED";
      assessment.completedAt = new Date();

      expect(assessment.status).toBe("COMPLETED");
      expect(assessment.completedAt).toBeInstanceOf(Date);
    });

    it("should follow complete SMS assessment lifecycle", async () => {
      const assessment = createMockAssessment({
        type: "SELF_ASSESSMENT",
        status: "DRAFT",
        questionnaire: {
          id: "questionnaire_sms",
          type: "SMS_CANSO_SOE",
          code: "SMS_2024",
          titleEn: "SMS SoE Protocol",
          titleFr: "Protocole SMS SoE",
        },
      });

      // Complete the lifecycle
      assessment.startedAt = new Date();
      assessment.progress = 100;

      // Submit with SMS-specific scoring
      assessment.status = "SUBMITTED";
      assessment.submittedAt = new Date();
      assessment.overallScore = 72; // Percentage
      assessment.maturityLevel = "LEVEL_D"; // SMS maturity level

      expect(assessment.overallScore).toBe(72);
      expect(assessment.maturityLevel).toBe("LEVEL_D");

      // Complete
      assessment.status = "UNDER_REVIEW";
      assessment.status = "COMPLETED";
      assessment.completedAt = new Date();

      expect(assessment.status).toBe("COMPLETED");
    });
  });

  describe("Status Transitions", () => {
    it("should allow valid DRAFT transitions", () => {
      expect(canTransition("DRAFT", "SUBMITTED")).toBe(true);
      expect(canTransition("DRAFT", "ARCHIVED")).toBe(true);
      expect(canTransition("DRAFT", "UNDER_REVIEW")).toBe(false);
      expect(canTransition("DRAFT", "COMPLETED")).toBe(false);
    });

    it("should allow valid SUBMITTED transitions", () => {
      expect(canTransition("SUBMITTED", "UNDER_REVIEW")).toBe(true);
      expect(canTransition("SUBMITTED", "DRAFT")).toBe(true); // Reopen
      expect(canTransition("SUBMITTED", "COMPLETED")).toBe(false);
      expect(canTransition("SUBMITTED", "ARCHIVED")).toBe(false);
    });

    it("should allow valid UNDER_REVIEW transitions", () => {
      expect(canTransition("UNDER_REVIEW", "COMPLETED")).toBe(true);
      expect(canTransition("UNDER_REVIEW", "SUBMITTED")).toBe(true); // Return for revision
      expect(canTransition("UNDER_REVIEW", "DRAFT")).toBe(false);
      expect(canTransition("UNDER_REVIEW", "ARCHIVED")).toBe(false);
    });

    it("should allow valid COMPLETED transitions", () => {
      expect(canTransition("COMPLETED", "ARCHIVED")).toBe(true);
      expect(canTransition("COMPLETED", "DRAFT")).toBe(false);
      expect(canTransition("COMPLETED", "SUBMITTED")).toBe(false);
      expect(canTransition("COMPLETED", "UNDER_REVIEW")).toBe(false);
    });

    it("should not allow any transitions from ARCHIVED", () => {
      expect(canTransition("ARCHIVED", "DRAFT")).toBe(false);
      expect(canTransition("ARCHIVED", "SUBMITTED")).toBe(false);
      expect(canTransition("ARCHIVED", "UNDER_REVIEW")).toBe(false);
      expect(canTransition("ARCHIVED", "COMPLETED")).toBe(false);
    });
  });

  describe("Assessment Types", () => {
    const assessmentTypes: AssessmentType[] = [
      "SELF_ASSESSMENT",
      "GAP_ANALYSIS",
      "PEER_REVIEW",
      "FOLLOW_UP",
    ];

    it.each(assessmentTypes)("should create %s type assessment", (type) => {
      const assessment = createMockAssessment({ type });
      expect(assessment.type).toBe(type);
    });

    it("should support both questionnaire types for any assessment type", () => {
      const ansAssessment = createMockAssessment({
        type: "GAP_ANALYSIS",
        questionnaire: {
          id: "q1",
          type: "ANS_USOAP_CMA",
          code: "ANS_2024",
          titleEn: "ANS",
          titleFr: "ANS",
        },
      });

      const smsAssessment = createMockAssessment({
        type: "GAP_ANALYSIS",
        questionnaire: {
          id: "q2",
          type: "SMS_CANSO_SOE",
          code: "SMS_2024",
          titleEn: "SMS",
          titleFr: "SMS",
        },
      });

      expect(ansAssessment.questionnaire.type).toBe("ANS_USOAP_CMA");
      expect(smsAssessment.questionnaire.type).toBe("SMS_CANSO_SOE");
    });
  });
});

// =============================================================================
// AUTHORIZATION TESTS
// =============================================================================

describe("Assessment Authorization", () => {
  describe("Role-Based Access Control", () => {
    describe("Admin Roles", () => {
      const adminRoles: UserRole[] = ["SUPER_ADMIN", "SYSTEM_ADMIN", "PROGRAMME_COORDINATOR"];

      it.each(adminRoles)("%s should have full access to any assessment", (role) => {
        const user = createMockUser({ role, organizationId: "different_org" });
        const assessment = createMockAssessment({ organizationId: "org_123" });

        const { hasAccess } = canAccessAssessment(user, assessment, true);
        expect(hasAccess).toBe(true);
      });
    });

    describe("Organization Management Roles", () => {
      const managerRoles: UserRole[] = [
        "ANSP_ADMIN",
        "SAFETY_MANAGER",
        "QUALITY_MANAGER",
      ];

      it.each(managerRoles)("%s should have write access to own org's assessments", (role) => {
        const user = createMockUser({ role, organizationId: "org_123" });
        const assessment = createMockAssessment({ organizationId: "org_123" });

        const { hasAccess } = canAccessAssessment(user, assessment, true);
        expect(hasAccess).toBe(true);
      });

      it.each(managerRoles)("%s should not have access to other org's assessments", (role) => {
        const user = createMockUser({ role, organizationId: "org_123" });
        const assessment = createMockAssessment({ organizationId: "other_org" });

        const { hasAccess } = canAccessAssessment(user, assessment, false);
        expect(hasAccess).toBe(false);
      });
    });

    describe("Staff Role", () => {
      it("STAFF should have read access to own org's assessments", () => {
        const user = createMockUser({ role: "STAFF", organizationId: "org_123" });
        const assessment = createMockAssessment({ organizationId: "org_123" });

        const { hasAccess } = canAccessAssessment(user, assessment, false);
        expect(hasAccess).toBe(true);
      });

      it("STAFF should not have write access", () => {
        const user = createMockUser({ role: "STAFF", organizationId: "org_123" });
        const assessment = createMockAssessment({ organizationId: "org_123" });

        const { hasAccess } = canAccessAssessment(user, assessment, true);
        expect(hasAccess).toBe(false);
      });
    });

    describe("Peer Reviewer Roles", () => {
      const reviewerRoles: UserRole[] = ["PEER_REVIEWER", "LEAD_REVIEWER"];

      it.each(reviewerRoles)("%s should view submitted assessments from other orgs", (role) => {
        const user = createMockUser({ role, organizationId: "reviewer_org" });

        const submittedAssessment = createMockAssessment({
          organizationId: "assessed_org",
          status: "SUBMITTED",
        });

        const { hasAccess } = canAccessAssessment(user, submittedAssessment, false);
        expect(hasAccess).toBe(true);
      });

      it.each(reviewerRoles)("%s should not view draft assessments from other orgs", (role) => {
        const user = createMockUser({ role, organizationId: "reviewer_org" });

        const draftAssessment = createMockAssessment({
          organizationId: "assessed_org",
          status: "DRAFT",
        });

        const { hasAccess } = canAccessAssessment(user, draftAssessment, false);
        expect(hasAccess).toBe(false);
      });

      it.each(reviewerRoles)("%s should not have write access to other org's assessments", (role) => {
        const user = createMockUser({ role, organizationId: "reviewer_org" });

        const submittedAssessment = createMockAssessment({
          organizationId: "assessed_org",
          status: "SUBMITTED",
        });

        const { hasAccess } = canAccessAssessment(user, submittedAssessment, true);
        expect(hasAccess).toBe(false);
      });
    });

    describe("Steering Committee", () => {
      it("should view completed assessments from any org", () => {
        const user = createMockUser({
          role: "STEERING_COMMITTEE",
          organizationId: "committee_org",
        });

        const completedAssessment = createMockAssessment({
          organizationId: "any_org",
          status: "COMPLETED",
        });

        const { hasAccess } = canAccessAssessment(user, completedAssessment, false);
        expect(hasAccess).toBe(true);
      });

      it("should not view non-completed assessments from other orgs", () => {
        const user = createMockUser({
          role: "STEERING_COMMITTEE",
          organizationId: "committee_org",
        });

        const statuses: AssessmentStatus[] = ["DRAFT", "SUBMITTED", "UNDER_REVIEW"];

        for (const status of statuses) {
          const assessment = createMockAssessment({
            organizationId: "other_org",
            status,
          });

          const { hasAccess } = canAccessAssessment(user, assessment, false);
          expect(hasAccess).toBe(false);
        }
      });
    });

    describe("Users without Organization", () => {
      it("should not access any assessments without organization", () => {
        const user = createMockUser({
          role: "STAFF",
          organizationId: null,
        });

        const assessment = createMockAssessment({ organizationId: "org_123" });

        const { hasAccess } = canAccessAssessment(user, assessment, false);
        expect(hasAccess).toBe(false);
      });
    });
  });

  describe("Status-Based Restrictions", () => {
    it("should only allow editing DRAFT assessments", () => {
      // const _user = createMockUser({ role: "ANSP_ADMIN" });

      const editableStatuses: AssessmentStatus[] = ["DRAFT"];
      const nonEditableStatuses: AssessmentStatus[] = [
        "SUBMITTED",
        "UNDER_REVIEW",
        "COMPLETED",
        "ARCHIVED",
      ];

      for (const status of editableStatuses) {
        const assessment = createMockAssessment({ status });
        expect(assessment.status).toBe("DRAFT");
        // Editing should be allowed for draft
      }

      for (const status of nonEditableStatuses) {
        const assessment = createMockAssessment({ status });
        // Editing should be blocked for non-draft
        expect(["SUBMITTED", "UNDER_REVIEW", "COMPLETED", "ARCHIVED"]).toContain(assessment.status);
      }
    });

    it("should track workflow timestamps correctly", () => {
      const assessment = createMockAssessment();

      // Initially all timestamps should be null
      expect(assessment.startedAt).toBeNull();
      expect(assessment.submittedAt).toBeNull();
      expect(assessment.completedAt).toBeNull();

      // Start
      const startTime = new Date();
      assessment.startedAt = startTime;
      expect(assessment.startedAt).toEqual(startTime);

      // Submit
      assessment.status = "SUBMITTED";
      const submitTime = new Date();
      assessment.submittedAt = submitTime;
      expect(assessment.submittedAt).toEqual(submitTime);
      expect(assessment.startedAt).not.toBeNull();

      // Complete
      assessment.status = "UNDER_REVIEW";
      assessment.status = "COMPLETED";
      const completeTime = new Date();
      assessment.completedAt = completeTime;
      expect(assessment.completedAt).toEqual(completeTime);
      expect(assessment.submittedAt).not.toBeNull();
      expect(assessment.startedAt).not.toBeNull();
    });
  });
});

// =============================================================================
// RESPONSE HANDLING TESTS
// =============================================================================

describe("Response Handling", () => {
  describe("ANS Responses", () => {
    const validANSResponses = [
      "SATISFACTORY",
      "NOT_SATISFACTORY",
      "NOT_APPLICABLE",
      "NOT_REVIEWED",
    ];

    it.each(validANSResponses)("should accept %s as valid ANS response", (response) => {
      expect(validANSResponses).toContain(response);
    });

    it("should track response progress correctly", () => {
      const totalQuestions = 100;

      // No responses
      expect(0 / totalQuestions * 100).toBe(0);

      // 25% complete
      expect(25 / totalQuestions * 100).toBe(25);

      // 50% complete
      expect(50 / totalQuestions * 100).toBe(50);

      // 100% complete
      expect(100 / totalQuestions * 100).toBe(100);
    });
  });

  describe("SMS Responses", () => {
    const validSMSLevels = ["A", "B", "C", "D", "E"];
    const maturityLevelScores: Record<string, number> = {
      A: 1,
      B: 2,
      C: 3,
      D: 4,
      E: 5,
    };

    it.each(validSMSLevels)("should accept %s as valid SMS maturity level", (level) => {
      expect(validSMSLevels).toContain(level);
      expect(maturityLevelScores[level]).toBeDefined();
    });

    it("should map maturity levels to correct numeric scores", () => {
      expect(maturityLevelScores["A"]).toBe(1);
      expect(maturityLevelScores["B"]).toBe(2);
      expect(maturityLevelScores["C"]).toBe(3);
      expect(maturityLevelScores["D"]).toBe(4);
      expect(maturityLevelScores["E"]).toBe(5);
    });
  });

  describe("Evidence Handling", () => {
    it("should support multiple evidence URLs per response", () => {
      const evidenceUrls = [
        "https://storage.example.com/doc1.pdf",
        "https://storage.example.com/doc2.pdf",
        "https://storage.example.com/doc3.pdf",
      ];

      expect(evidenceUrls.length).toBe(3);
      evidenceUrls.forEach(url => {
        expect(url).toMatch(/^https?:\/\/.+/);
      });
    });

    it("should validate evidence URL format", () => {
      const validUrls = [
        "https://storage.example.com/file.pdf",
        "http://localhost:3000/uploads/doc.pdf",
        "https://s3.amazonaws.com/bucket/key",
      ];

      const invalidUrls = [
        "not-a-url",
        "ftp://server/file",
        "",
      ];

      validUrls.forEach(url => {
        expect(url).toMatch(/^https?:\/\/.+/);
      });

      invalidUrls.forEach(url => {
        expect(url).not.toMatch(/^https?:\/\/.+$/);
      });
    });
  });
});

// =============================================================================
// SUBMISSION VALIDATION TESTS
// =============================================================================

describe("Submission Validation", () => {
  describe("ANS Assessment Submission", () => {
    it("should require all questions to be answered", () => {
      const totalQuestions = 100;
      const answeredQuestions = 95;

      const isComplete = answeredQuestions >= totalQuestions;
      expect(isComplete).toBe(false);

      const allAnswered = 100;
      expect(allAnswered >= totalQuestions).toBe(true);
    });

    it("should not allow NOT_REVIEWED responses at submission", () => {
      const responses = [
        { value: "SATISFACTORY" },
        { value: "NOT_SATISFACTORY" },
        { value: "NOT_REVIEWED" }, // Invalid
      ];

      const hasNotReviewed = responses.some(r => r.value === "NOT_REVIEWED");
      expect(hasNotReviewed).toBe(true);

      const validResponses = responses.filter(r => r.value !== "NOT_REVIEWED");
      const isValid = validResponses.length === responses.length;
      expect(isValid).toBe(false);
    });

    it("should calculate EI score correctly at submission", () => {
      const responses = {
        satisfactory: 80,
        notSatisfactory: 15,
        notApplicable: 5,
      };

      const applicable = responses.satisfactory + responses.notSatisfactory;
      const eiScore = (responses.satisfactory / applicable) * 100;

      expect(eiScore).toBeCloseTo(84.21, 1);
    });

    it("should warn if evidence coverage is below threshold", () => {
      const totalQuestions = 100;
      const questionsWithEvidence = 70;
      const minEvidenceThreshold = 80;

      const evidencePercentage = (questionsWithEvidence / totalQuestions) * 100;
      const needsWarning = evidencePercentage < minEvidenceThreshold;

      expect(needsWarning).toBe(true);
    });
  });

  describe("SMS Assessment Submission", () => {
    it("should require all questions to have maturity levels", () => {
      const totalQuestions = 50;
      const questionsWithLevel = 50;

      const isComplete = questionsWithLevel === totalQuestions;
      expect(isComplete).toBe(true);
    });

    it("should calculate overall maturity correctly", () => {
      // const _levelScores = { A: 1, B: 2, C: 3, D: 4, E: 5 };
      const responses = [
        { level: "C", score: 3 },
        { level: "D", score: 4 },
        { level: "C", score: 3 },
        { level: "D", score: 4 },
        { level: "E", score: 5 },
      ];

      const avgScore = responses.reduce((sum, r) => sum + r.score, 0) / responses.length;
      expect(avgScore).toBe(3.8);

      // Convert to overall level
      const getLevel = (score: number) => {
        if (score >= 4.5) return "E";
        if (score >= 3.5) return "D";
        if (score >= 2.5) return "C";
        if (score >= 1.5) return "B";
        return "A";
      };

      expect(getLevel(avgScore)).toBe("D");
    });

    it("should use lowest component level as overall level per CANSO guidance", () => {
      const componentLevels = {
        SAFETY_POLICY_OBJECTIVES: "D",
        SAFETY_RISK_MANAGEMENT: "B", // Lowest
        SAFETY_ASSURANCE: "C",
        SAFETY_PROMOTION: "D",
      };

      const levels = Object.values(componentLevels);
      const levelOrder = ["A", "B", "C", "D", "E"];

      const lowestLevel = levels.reduce((lowest, current) => {
        return levelOrder.indexOf(current) < levelOrder.indexOf(lowest) ? current : lowest;
      });

      expect(lowestLevel).toBe("B");
    });
  });
});

// =============================================================================
// PROGRESS TRACKING TESTS
// =============================================================================

describe("Progress Tracking", () => {
  describe("Overall Progress Calculation", () => {
    it("should calculate progress as percentage of answered questions", () => {
      const testCases = [
        { answered: 0, total: 100, expected: 0 },
        { answered: 25, total: 100, expected: 25 },
        { answered: 50, total: 100, expected: 50 },
        { answered: 75, total: 100, expected: 75 },
        { answered: 100, total: 100, expected: 100 },
        { answered: 33, total: 100, expected: 33 },
        { answered: 67, total: 100, expected: 67 },
      ];

      testCases.forEach(({ answered, total, expected }) => {
        const progress = Math.round((answered / total) * 100);
        expect(progress).toBe(expected);
      });
    });

    it("should handle edge case of zero questions", () => {
      const answered = 0;
      const total = 0;

      const progress = total > 0 ? Math.round((answered / total) * 100) : 0;
      expect(progress).toBe(0);
    });
  });

  describe("Category Progress", () => {
    it("should track progress by category", () => {
      const categories = [
        { id: "cat1", totalQuestions: 20, answered: 15 },
        { id: "cat2", totalQuestions: 30, answered: 30 },
        { id: "cat3", totalQuestions: 50, answered: 25 },
      ];

      const categoryProgress = categories.map(cat => ({
        categoryId: cat.id,
        progress: Math.round((cat.answered / cat.totalQuestions) * 100),
      }));

      expect(categoryProgress[0].progress).toBe(75);
      expect(categoryProgress[1].progress).toBe(100);
      expect(categoryProgress[2].progress).toBe(50);
    });

    it("should identify incomplete categories", () => {
      const categories = [
        { id: "cat1", progress: 100 },
        { id: "cat2", progress: 75 },
        { id: "cat3", progress: 50 },
      ];

      const incompleteCategories = categories.filter(c => c.progress < 100);
      expect(incompleteCategories.length).toBe(2);
      expect(incompleteCategories.map(c => c.id)).toContain("cat2");
      expect(incompleteCategories.map(c => c.id)).toContain("cat3");
    });
  });

  describe("Progress Updates", () => {
    it("should update assessment progress when response is saved", () => {
      const assessment = {
        progress: 50,
        totalQuestions: 100,
        answeredQuestions: 50,
      };

      // Save new response
      assessment.answeredQuestions++;
      assessment.progress = Math.round((assessment.answeredQuestions / assessment.totalQuestions) * 100);

      expect(assessment.progress).toBe(51);
    });

    it("should decrement progress when response is cleared", () => {
      const assessment = {
        progress: 50,
        totalQuestions: 100,
        answeredQuestions: 50,
      };

      // Clear response
      assessment.answeredQuestions--;
      assessment.progress = Math.round((assessment.answeredQuestions / assessment.totalQuestions) * 100);

      expect(assessment.progress).toBe(49);
    });
  });
});

// =============================================================================
// CONCURRENT OPERATIONS TESTS
// =============================================================================

describe("Concurrent Operations", () => {
  it("should handle bulk response saves", async () => {
    const responsesToSave = 50;
    const responses = Array.from({ length: responsesToSave }, (_, i) => ({
      questionId: `q_${i}`,
      responseValue: i % 2 === 0 ? "SATISFACTORY" : "NOT_SATISFACTORY",
    }));

    expect(responses.length).toBe(50);

    // Simulate bulk update success
    const savedCount = responses.length;
    expect(savedCount).toBe(responsesToSave);
  });

  it("should maintain data consistency during updates", () => {
    // Simulate optimistic locking scenario
    // const _assessment = createMockAssessment({ progress: 50 });
    const updatedAt1 = new Date("2024-01-01T10:00:00Z");
    const updatedAt2 = new Date("2024-01-01T10:00:01Z");

    // Stale update should be rejected
    const isStaleUpdate = updatedAt1 < updatedAt2;
    expect(isStaleUpdate).toBe(true);
  });
});

// =============================================================================
// ERROR HANDLING TESTS
// =============================================================================

describe("Error Handling", () => {
  describe("Invalid State Transitions", () => {
    it("should reject invalid status transitions with appropriate error", () => {
      const invalidTransitions: Array<[AssessmentStatus, AssessmentStatus]> = [
        ["DRAFT", "COMPLETED"],
        ["DRAFT", "UNDER_REVIEW"],
        ["SUBMITTED", "COMPLETED"],
        ["ARCHIVED", "DRAFT"],
        ["COMPLETED", "DRAFT"],
      ];

      invalidTransitions.forEach(([from, to]) => {
        expect(canTransition(from, to)).toBe(false);
      });
    });
  });

  describe("Authorization Errors", () => {
    it("should reject unauthorized access with specific reason", () => {
      const user = createMockUser({ role: "STAFF", organizationId: "org_a" });
      const assessment = createMockAssessment({ organizationId: "org_b" });

      const { hasAccess, reason } = canAccessAssessment(user, assessment, false);

      expect(hasAccess).toBe(false);
      expect(reason).toBeDefined();
    });

    it("should reject write access for read-only roles", () => {
      const user = createMockUser({ role: "STAFF", organizationId: "org_123" });
      const assessment = createMockAssessment({ organizationId: "org_123" });

      const { hasAccess, reason } = canAccessAssessment(user, assessment, true);

      expect(hasAccess).toBe(false);
      expect(reason).toContain("permission");
    });
  });

  describe("Validation Errors", () => {
    it("should reject submission of incomplete assessment", () => {
      const assessment = {
        progress: 80,
        status: "DRAFT" as AssessmentStatus,
      };

      const canSubmit = assessment.progress === 100;
      expect(canSubmit).toBe(false);
    });

    it("should reject editing non-draft assessment", () => {
      const nonEditableStatuses: AssessmentStatus[] = [
        "SUBMITTED",
        "UNDER_REVIEW",
        "COMPLETED",
        "ARCHIVED",
      ];

      nonEditableStatuses.forEach(status => {
        const canEdit = status === "DRAFT";
        expect(canEdit).toBe(false);
      });
    });
  });
});

```

# src/__tests__/questionnaire/constants.test.ts

```ts
import { describe, it, expect } from "vitest";
import {
  USOAP_AUDIT_AREAS,
  CRITICAL_ELEMENTS,
  SMS_COMPONENTS,
  CANSO_STUDY_AREAS,
  MATURITY_LEVELS,
  TRANSVERSAL_AREAS,
  ICAO_REFERENCE_TYPES,
  TOTAL_USOAP_PQ_COUNT,
  QUESTIONNAIRE_METADATA,
  getAuditAreasArray,
  getCriticalElementsArray,
  getSMSComponentsArray,
  getStudyAreasArray,
  getStudyAreasByComponent,
  getMaturityLevelsArray,
  getTransversalAreasArray,
  getICAOReferenceTypesArray,
  getMaturityLevelFromScore,
  calculateWeightedSMSScore,
  calculateEIScore,
} from "@/lib/questionnaire/constants";

describe("USOAP Audit Areas", () => {
  it("should have exactly 9 audit areas", () => {
    expect(Object.keys(USOAP_AUDIT_AREAS)).toHaveLength(9);
  });

  it("should include all required audit area codes", () => {
    const expectedCodes = ["LEG", "ORG", "PEL", "OPS", "AIR", "AIG", "ANS", "AGA", "SSP"];
    const actualCodes = Object.keys(USOAP_AUDIT_AREAS);
    expect(actualCodes).toEqual(expect.arrayContaining(expectedCodes));
  });

  it("should have bilingual labels (EN/FR) for all audit areas", () => {
    Object.values(USOAP_AUDIT_AREAS).forEach((area) => {
      expect(area.name).toHaveProperty("en");
      expect(area.name).toHaveProperty("fr");
      expect(area.description).toHaveProperty("en");
      expect(area.description).toHaveProperty("fr");
      expect(area.name.en.length).toBeGreaterThan(0);
      expect(area.name.fr.length).toBeGreaterThan(0);
      expect(area.description.en.length).toBeGreaterThan(0);
      expect(area.description.fr.length).toBeGreaterThan(0);
    });
  });

  it("should have valid pqCount for all areas", () => {
    Object.values(USOAP_AUDIT_AREAS).forEach((area) => {
      expect(area.pqCount).toBeGreaterThan(0);
      expect(Number.isInteger(area.pqCount)).toBe(true);
    });
  });

  it("should sum to 851 total PQs", () => {
    expect(TOTAL_USOAP_PQ_COUNT).toBe(851);
  });

  it("should have unique sortOrder values", () => {
    const sortOrders = Object.values(USOAP_AUDIT_AREAS).map((a) => a.sortOrder);
    const uniqueSortOrders = new Set(sortOrders);
    expect(uniqueSortOrders.size).toBe(sortOrders.length);
  });
});

describe("Critical Elements", () => {
  it("should have exactly 8 critical elements", () => {
    expect(Object.keys(CRITICAL_ELEMENTS)).toHaveLength(8);
  });

  it("should include CE-1 through CE-8", () => {
    const expectedCodes = ["CE_1", "CE_2", "CE_3", "CE_4", "CE_5", "CE_6", "CE_7", "CE_8"];
    const actualCodes = Object.keys(CRITICAL_ELEMENTS);
    expect(actualCodes).toEqual(expect.arrayContaining(expectedCodes));
  });

  it("should have bilingual labels for all critical elements", () => {
    Object.values(CRITICAL_ELEMENTS).forEach((ce) => {
      expect(ce.name).toHaveProperty("en");
      expect(ce.name).toHaveProperty("fr");
      expect(ce.description).toHaveProperty("en");
      expect(ce.description).toHaveProperty("fr");
    });
  });

  it("should have correct number mappings", () => {
    expect(CRITICAL_ELEMENTS.CE_1.number).toBe(1);
    expect(CRITICAL_ELEMENTS.CE_8.number).toBe(8);
  });
});

describe("SMS Components", () => {
  it("should have exactly 4 SMS components", () => {
    expect(Object.keys(SMS_COMPONENTS)).toHaveLength(4);
  });

  it("should include all required component codes", () => {
    const expectedCodes = [
      "SAFETY_POLICY_OBJECTIVES",
      "SAFETY_RISK_MANAGEMENT",
      "SAFETY_ASSURANCE",
      "SAFETY_PROMOTION",
    ];
    const actualCodes = Object.keys(SMS_COMPONENTS);
    expect(actualCodes).toEqual(expect.arrayContaining(expectedCodes));
  });

  it("should have bilingual labels for all components", () => {
    Object.values(SMS_COMPONENTS).forEach((component) => {
      expect(component.name).toHaveProperty("en");
      expect(component.name).toHaveProperty("fr");
      expect(component.description).toHaveProperty("en");
      expect(component.description).toHaveProperty("fr");
    });
  });

  it("should have weights that sum to 1.0", () => {
    const totalWeight = Object.values(SMS_COMPONENTS).reduce(
      (sum, c) => sum + c.weight,
      0
    );
    expect(Math.abs(totalWeight - 1.0)).toBeLessThan(0.001);
  });

  it("should have valid component numbers", () => {
    expect(SMS_COMPONENTS.SAFETY_POLICY_OBJECTIVES.number).toBe(1);
    expect(SMS_COMPONENTS.SAFETY_RISK_MANAGEMENT.number).toBe(2);
    expect(SMS_COMPONENTS.SAFETY_ASSURANCE.number).toBe(3);
    expect(SMS_COMPONENTS.SAFETY_PROMOTION.number).toBe(4);
  });
});

describe("CANSO Study Areas", () => {
  it("should have exactly 12 study areas", () => {
    expect(Object.keys(CANSO_STUDY_AREAS)).toHaveLength(12);
  });

  it("should have bilingual labels for all study areas", () => {
    Object.values(CANSO_STUDY_AREAS).forEach((sa) => {
      expect(sa.name).toHaveProperty("en");
      expect(sa.name).toHaveProperty("fr");
      expect(sa.description).toHaveProperty("en");
      expect(sa.description).toHaveProperty("fr");
    });
  });

  it("should have correct component mappings", () => {
    // Component 1: 5 study areas
    const component1Areas = Object.values(CANSO_STUDY_AREAS).filter(
      (sa) => sa.componentNumber === 1
    );
    expect(component1Areas).toHaveLength(5);

    // Component 2: 2 study areas
    const component2Areas = Object.values(CANSO_STUDY_AREAS).filter(
      (sa) => sa.componentNumber === 2
    );
    expect(component2Areas).toHaveLength(2);

    // Component 3: 3 study areas
    const component3Areas = Object.values(CANSO_STUDY_AREAS).filter(
      (sa) => sa.componentNumber === 3
    );
    expect(component3Areas).toHaveLength(3);

    // Component 4: 2 study areas
    const component4Areas = Object.values(CANSO_STUDY_AREAS).filter(
      (sa) => sa.componentNumber === 4
    );
    expect(component4Areas).toHaveLength(2);
  });
});

describe("Maturity Levels", () => {
  it("should have exactly 5 maturity levels", () => {
    expect(Object.keys(MATURITY_LEVELS)).toHaveLength(5);
  });

  it("should include levels A through E", () => {
    const expectedCodes = ["LEVEL_A", "LEVEL_B", "LEVEL_C", "LEVEL_D", "LEVEL_E"];
    const actualCodes = Object.keys(MATURITY_LEVELS);
    expect(actualCodes).toEqual(expect.arrayContaining(expectedCodes));
  });

  it("should have bilingual labels for all levels", () => {
    Object.values(MATURITY_LEVELS).forEach((level) => {
      expect(level.name).toHaveProperty("en");
      expect(level.name).toHaveProperty("fr");
      expect(level.description).toHaveProperty("en");
      expect(level.description).toHaveProperty("fr");
    });
  });

  it("should have scores from 1 to 5", () => {
    expect(MATURITY_LEVELS.LEVEL_A.score).toBe(1);
    expect(MATURITY_LEVELS.LEVEL_B.score).toBe(2);
    expect(MATURITY_LEVELS.LEVEL_C.score).toBe(3);
    expect(MATURITY_LEVELS.LEVEL_D.score).toBe(4);
    expect(MATURITY_LEVELS.LEVEL_E.score).toBe(5);
  });

  it("should have correct level letters", () => {
    expect(MATURITY_LEVELS.LEVEL_A.level).toBe("A");
    expect(MATURITY_LEVELS.LEVEL_E.level).toBe("E");
  });
});

describe("Transversal Areas", () => {
  it("should have exactly 3 transversal areas", () => {
    expect(Object.keys(TRANSVERSAL_AREAS)).toHaveLength(3);
  });

  it("should include SPM, HP, CI", () => {
    expect(TRANSVERSAL_AREAS).toHaveProperty("SPM");
    expect(TRANSVERSAL_AREAS).toHaveProperty("HP");
    expect(TRANSVERSAL_AREAS).toHaveProperty("CI");
  });

  it("should have bilingual labels", () => {
    Object.values(TRANSVERSAL_AREAS).forEach((area) => {
      expect(area.name).toHaveProperty("en");
      expect(area.name).toHaveProperty("fr");
    });
  });
});

describe("ICAO Reference Types", () => {
  it("should have exactly 7 reference types", () => {
    expect(Object.keys(ICAO_REFERENCE_TYPES)).toHaveLength(7);
  });

  it("should include all required types", () => {
    const expectedTypes = ["CC", "STD", "RP", "PANS", "GM", "Cir", "SUPPS"];
    const actualTypes = Object.keys(ICAO_REFERENCE_TYPES);
    expect(actualTypes).toEqual(expect.arrayContaining(expectedTypes));
  });

  it("should have bilingual labels", () => {
    Object.values(ICAO_REFERENCE_TYPES).forEach((type) => {
      expect(type.name).toHaveProperty("en");
      expect(type.name).toHaveProperty("fr");
    });
  });
});

describe("Questionnaire Metadata", () => {
  it("should have ANS_USOAP_CMA metadata", () => {
    expect(QUESTIONNAIRE_METADATA).toHaveProperty("ANS_USOAP_CMA");
    expect(QUESTIONNAIRE_METADATA.ANS_USOAP_CMA.totalQuestions).toBe(851);
    expect(QUESTIONNAIRE_METADATA.ANS_USOAP_CMA.auditAreas).toBe(9);
    expect(QUESTIONNAIRE_METADATA.ANS_USOAP_CMA.criticalElements).toBe(8);
  });

  it("should have SMS_CANSO_SOE metadata", () => {
    expect(QUESTIONNAIRE_METADATA).toHaveProperty("SMS_CANSO_SOE");
    expect(QUESTIONNAIRE_METADATA.SMS_CANSO_SOE.components).toBe(4);
    expect(QUESTIONNAIRE_METADATA.SMS_CANSO_SOE.studyAreas).toBe(12);
    expect(QUESTIONNAIRE_METADATA.SMS_CANSO_SOE.maturityLevels).toBe(5);
  });
});

describe("Helper Functions", () => {
  describe("getAuditAreasArray", () => {
    it("should return sorted array of audit areas", () => {
      const areas = getAuditAreasArray();
      expect(areas).toHaveLength(9);
      expect(areas[0].code).toBe("LEG");
      expect(areas[8].code).toBe("SSP");
    });
  });

  describe("getCriticalElementsArray", () => {
    it("should return sorted array of critical elements", () => {
      const elements = getCriticalElementsArray();
      expect(elements).toHaveLength(8);
      expect(elements[0].number).toBe(1);
      expect(elements[7].number).toBe(8);
    });
  });

  describe("getSMSComponentsArray", () => {
    it("should return sorted array of SMS components", () => {
      const components = getSMSComponentsArray();
      expect(components).toHaveLength(4);
      expect(components[0].number).toBe(1);
      expect(components[3].number).toBe(4);
    });
  });

  describe("getStudyAreasArray", () => {
    it("should return sorted array of study areas", () => {
      const areas = getStudyAreasArray();
      expect(areas).toHaveLength(12);
      expect(areas[0].sortOrder).toBe(1);
    });
  });

  describe("getStudyAreasByComponent", () => {
    it("should return study areas for component 1", () => {
      const areas = getStudyAreasByComponent(1);
      expect(areas).toHaveLength(5);
      areas.forEach((area) => {
        expect(area.componentNumber).toBe(1);
      });
    });

    it("should return study areas for component 2", () => {
      const areas = getStudyAreasByComponent(2);
      expect(areas).toHaveLength(2);
    });
  });

  describe("getMaturityLevelsArray", () => {
    it("should return sorted array of maturity levels", () => {
      const levels = getMaturityLevelsArray();
      expect(levels).toHaveLength(5);
      expect(levels[0].level).toBe("A");
      expect(levels[4].level).toBe("E");
    });
  });

  describe("getTransversalAreasArray", () => {
    it("should return sorted array of transversal areas", () => {
      const areas = getTransversalAreasArray();
      expect(areas).toHaveLength(3);
    });
  });

  describe("getICAOReferenceTypesArray", () => {
    it("should return sorted array of ICAO reference types", () => {
      const types = getICAOReferenceTypesArray();
      expect(types).toHaveLength(7);
    });
  });

  describe("getMaturityLevelFromScore", () => {
    it("should return LEVEL_A for scores below 1.5", () => {
      expect(getMaturityLevelFromScore(1.0)).toBe("LEVEL_A");
      expect(getMaturityLevelFromScore(1.4)).toBe("LEVEL_A");
    });

    it("should return LEVEL_B for scores 1.5-2.49", () => {
      expect(getMaturityLevelFromScore(1.5)).toBe("LEVEL_B");
      expect(getMaturityLevelFromScore(2.4)).toBe("LEVEL_B");
    });

    it("should return LEVEL_C for scores 2.5-3.49", () => {
      expect(getMaturityLevelFromScore(2.5)).toBe("LEVEL_C");
      expect(getMaturityLevelFromScore(3.4)).toBe("LEVEL_C");
    });

    it("should return LEVEL_D for scores 3.5-4.49", () => {
      expect(getMaturityLevelFromScore(3.5)).toBe("LEVEL_D");
      expect(getMaturityLevelFromScore(4.4)).toBe("LEVEL_D");
    });

    it("should return LEVEL_E for scores 4.5 and above", () => {
      expect(getMaturityLevelFromScore(4.5)).toBe("LEVEL_E");
      expect(getMaturityLevelFromScore(5.0)).toBe("LEVEL_E");
    });
  });

  describe("calculateWeightedSMSScore", () => {
    it("should calculate weighted score correctly", () => {
      const componentScores = {
        SAFETY_POLICY_OBJECTIVES: 4.0,
        SAFETY_RISK_MANAGEMENT: 3.0,
        SAFETY_ASSURANCE: 3.5,
        SAFETY_PROMOTION: 4.5,
      };
      const weighted = calculateWeightedSMSScore(componentScores);
      // 4.0*0.25 + 3.0*0.30 + 3.5*0.25 + 4.5*0.20 = 1.0 + 0.9 + 0.875 + 0.9 = 3.675
      expect(weighted).toBeCloseTo(3.675, 2);
    });

    it("should return 5.0 for all Level E scores", () => {
      const componentScores = {
        SAFETY_POLICY_OBJECTIVES: 5.0,
        SAFETY_RISK_MANAGEMENT: 5.0,
        SAFETY_ASSURANCE: 5.0,
        SAFETY_PROMOTION: 5.0,
      };
      const weighted = calculateWeightedSMSScore(componentScores);
      expect(weighted).toBe(5.0);
    });
  });

  describe("calculateEIScore", () => {
    it("should calculate EI score correctly", () => {
      expect(calculateEIScore(80, 100)).toBe(80);
      expect(calculateEIScore(50, 100)).toBe(50);
      expect(calculateEIScore(0, 100)).toBe(0);
    });

    it("should return 0 when no applicable questions", () => {
      expect(calculateEIScore(0, 0)).toBe(0);
    });

    it("should return 100 for perfect score", () => {
      expect(calculateEIScore(100, 100)).toBe(100);
    });
  });
});

```

# src/__tests__/questionnaire/types.test.ts

```ts
import { describe, it, expect } from "vitest";
import {
  QuestionnaireFiltersSchema,
  QuestionFiltersSchema,
  PaginationSchema,
} from "@/lib/questionnaire/types";

describe("Zod Validation Schemas", () => {
  describe("QuestionnaireFiltersSchema", () => {
    it("should validate valid questionnaire filters", () => {
      const validFilters = {
        type: "ANS_USOAP_CMA",
        isActive: true,
        search: "audit",
      };
      const result = QuestionnaireFiltersSchema.safeParse(validFilters);
      expect(result.success).toBe(true);
    });

    it("should validate SMS questionnaire type", () => {
      const filters = { type: "SMS_CANSO_SOE" };
      const result = QuestionnaireFiltersSchema.safeParse(filters);
      expect(result.success).toBe(true);
    });

    it("should reject invalid questionnaire type", () => {
      const invalidFilters = { type: "INVALID_TYPE" };
      const result = QuestionnaireFiltersSchema.safeParse(invalidFilters);
      expect(result.success).toBe(false);
    });

    it("should validate date filters", () => {
      const filters = {
        effectiveDateFrom: "2024-01-01",
        effectiveDateTo: "2024-12-31",
      };
      const result = QuestionnaireFiltersSchema.safeParse(filters);
      expect(result.success).toBe(true);
    });

    it("should validate empty filters", () => {
      const result = QuestionnaireFiltersSchema.safeParse({});
      expect(result.success).toBe(true);
    });

    it("should enforce search max length", () => {
      const filters = { search: "a".repeat(101) };
      const result = QuestionnaireFiltersSchema.safeParse(filters);
      expect(result.success).toBe(false);
    });

    it("should accept search within max length", () => {
      const filters = { search: "a".repeat(100) };
      const result = QuestionnaireFiltersSchema.safeParse(filters);
      expect(result.success).toBe(true);
    });
  });

  describe("QuestionFiltersSchema", () => {
    it("should validate valid question filters", () => {
      const validFilters = {
        auditArea: "ANS",
        criticalElement: "CE_1",
        isPriorityPQ: true,
        requiresOnSite: false,
      };
      const result = QuestionFiltersSchema.safeParse(validFilters);
      expect(result.success).toBe(true);
    });

    it("should validate all audit areas", () => {
      const auditAreas = ["LEG", "ORG", "PEL", "OPS", "AIR", "AIG", "ANS", "AGA", "SSP"];
      auditAreas.forEach((area) => {
        const result = QuestionFiltersSchema.safeParse({ auditArea: area });
        expect(result.success).toBe(true);
      });
    });

    it("should reject invalid audit area", () => {
      const result = QuestionFiltersSchema.safeParse({ auditArea: "INVALID" });
      expect(result.success).toBe(false);
    });

    it("should validate all critical elements", () => {
      const elements = ["CE_1", "CE_2", "CE_3", "CE_4", "CE_5", "CE_6", "CE_7", "CE_8"];
      elements.forEach((ce) => {
        const result = QuestionFiltersSchema.safeParse({ criticalElement: ce });
        expect(result.success).toBe(true);
      });
    });

    it("should reject invalid critical element", () => {
      const result = QuestionFiltersSchema.safeParse({ criticalElement: "CE_9" });
      expect(result.success).toBe(false);
    });

    it("should validate all SMS components", () => {
      const components = [
        "SAFETY_POLICY_OBJECTIVES",
        "SAFETY_RISK_MANAGEMENT",
        "SAFETY_ASSURANCE",
        "SAFETY_PROMOTION",
      ];
      components.forEach((component) => {
        const result = QuestionFiltersSchema.safeParse({ smsComponent: component });
        expect(result.success).toBe(true);
      });
    });

    it("should validate all study areas", () => {
      const studyAreas = [
        "SA_1_1", "SA_1_2", "SA_1_3", "SA_1_4", "SA_1_5",
        "SA_2_1", "SA_2_2",
        "SA_3_1", "SA_3_2", "SA_3_3",
        "SA_4_1", "SA_4_2",
      ];
      studyAreas.forEach((sa) => {
        const result = QuestionFiltersSchema.safeParse({ studyArea: sa });
        expect(result.success).toBe(true);
      });
    });

    it("should validate all maturity levels", () => {
      const levels = ["LEVEL_A", "LEVEL_B", "LEVEL_C", "LEVEL_D", "LEVEL_E"];
      levels.forEach((level) => {
        const result = QuestionFiltersSchema.safeParse({ maturityLevel: level });
        expect(result.success).toBe(true);
      });
    });

    it("should validate transversal areas", () => {
      const areas = ["SPM", "HP", "CI"];
      areas.forEach((area) => {
        const result = QuestionFiltersSchema.safeParse({ transversalArea: area });
        expect(result.success).toBe(true);
      });
    });

    it("should validate PQ amendment statuses", () => {
      const statuses = [
        "NO_CHANGE",
        "REVISED",
        "NEW",
        "MERGED",
        "DELETED",
        "REFERENCE_REVISED",
      ];
      statuses.forEach((status) => {
        const result = QuestionFiltersSchema.safeParse({ pqStatus: status });
        expect(result.success).toBe(true);
      });
    });

    it("should validate response types", () => {
      const types = [
        "SATISFACTORY_NOT",
        "MATURITY_LEVEL",
        "YES_NO",
        "SCALE_1_5",
        "TEXT",
        "MULTI_SELECT",
      ];
      types.forEach((type) => {
        const result = QuestionFiltersSchema.safeParse({ responseType: type });
        expect(result.success).toBe(true);
      });
    });

    it("should validate combined filters", () => {
      const filters = {
        auditArea: "ANS",
        criticalElement: "CE_1",
        isPriorityPQ: true,
        requiresOnSite: true,
        pqStatus: "NEW",
        search: "air traffic",
      };
      const result = QuestionFiltersSchema.safeParse(filters);
      expect(result.success).toBe(true);
    });

    it("should validate CUID format for questionnaireId", () => {
      // Valid CUID
      const validCuid = { questionnaireId: "clh3am1hk0000cjt1f4n5m8o9" };
      const result = QuestionFiltersSchema.safeParse(validCuid);
      expect(result.success).toBe(true);
    });

    it("should enforce search max length of 200", () => {
      const filters = { search: "a".repeat(201) };
      const result = QuestionFiltersSchema.safeParse(filters);
      expect(result.success).toBe(false);
    });
  });

  describe("PaginationSchema", () => {
    it("should provide default values", () => {
      const result = PaginationSchema.parse({});
      expect(result.page).toBe(1);
      expect(result.pageSize).toBe(20);
    });

    it("should validate positive page numbers", () => {
      const result = PaginationSchema.safeParse({ page: 5 });
      expect(result.success).toBe(true);
      expect(result.data?.page).toBe(5);
    });

    it("should reject zero or negative page numbers", () => {
      const zeroResult = PaginationSchema.safeParse({ page: 0 });
      expect(zeroResult.success).toBe(false);

      const negativeResult = PaginationSchema.safeParse({ page: -1 });
      expect(negativeResult.success).toBe(false);
    });

    it("should validate pageSize within range (1-100)", () => {
      const validResult = PaginationSchema.safeParse({ pageSize: 50 });
      expect(validResult.success).toBe(true);

      const minResult = PaginationSchema.safeParse({ pageSize: 1 });
      expect(minResult.success).toBe(true);

      const maxResult = PaginationSchema.safeParse({ pageSize: 100 });
      expect(maxResult.success).toBe(true);
    });

    it("should reject pageSize outside range", () => {
      const tooSmallResult = PaginationSchema.safeParse({ pageSize: 0 });
      expect(tooSmallResult.success).toBe(false);

      const tooLargeResult = PaginationSchema.safeParse({ pageSize: 101 });
      expect(tooLargeResult.success).toBe(false);
    });

    it("should coerce string numbers", () => {
      const result = PaginationSchema.parse({ page: "3", pageSize: "25" });
      expect(result.page).toBe(3);
      expect(result.pageSize).toBe(25);
    });
  });
});

describe("Type Interfaces", () => {
  describe("BilingualLabel", () => {
    it("should have en and fr properties", () => {
      // Type-checking test - this tests the structure
      const label = { en: "English", fr: "Français" };
      expect(label).toHaveProperty("en");
      expect(label).toHaveProperty("fr");
      expect(typeof label.en).toBe("string");
      expect(typeof label.fr).toBe("string");
    });
  });

  describe("PaginationMeta", () => {
    it("should have required pagination properties", () => {
      const meta = {
        page: 1,
        pageSize: 20,
        totalItems: 100,
        totalPages: 5,
        hasNextPage: true,
        hasPreviousPage: false,
      };
      expect(meta.page).toBeGreaterThan(0);
      expect(meta.pageSize).toBeGreaterThan(0);
      expect(meta.totalItems).toBeGreaterThanOrEqual(0);
      expect(meta.totalPages).toBeGreaterThanOrEqual(0);
      expect(typeof meta.hasNextPage).toBe("boolean");
      expect(typeof meta.hasPreviousPage).toBe("boolean");
    });
  });
});

```

# src/__tests__/unit/bilingual.test.ts

```ts
/**
 * Bilingual Support Tests
 *
 * Tests for ensuring proper support for English and French translations
 * across all assessment constants, labels, and UI text.
 */

import { describe, it, expect } from "vitest";
import {
  ASSESSMENT_STATUSES,
  ASSESSMENT_TYPES,
  ANS_RESPONSE_VALUES,
  SMS_MATURITY_LEVELS,
  EVIDENCE_TYPES,
  EI_SCORE_THRESHOLDS,
  getAssessmentStatusArray,
  getAssessmentTypesArray,
  getANSResponseValuesArray,
  getSMSMaturityLevelsArray,
  getEvidenceTypesArray,
} from "@/lib/assessment/constants";
import {
  CRITICAL_ELEMENTS,
  AUDIT_AREAS,
  SMS_COMPONENTS,
  SMS_STUDY_AREAS,
  MATURITY_LEVEL_VALUES,
} from "@/lib/constants/scoring";

// =============================================================================
// HELPER TYPES
// =============================================================================

interface BilingualLabel {
  en: string;
  fr: string;
}

// =============================================================================
// HELPER FUNCTIONS
// =============================================================================

function hasBothLanguages(label: BilingualLabel): boolean {
  return (
    typeof label.en === "string" &&
    typeof label.fr === "string" &&
    label.en.length > 0 &&
    label.fr.length > 0
  );
}

// eslint-disable-next-line @typescript-eslint/no-unused-vars
function _hasValidBilingualProperty(obj: unknown, propertyNames: string[]): boolean {
  if (typeof obj !== "object" || obj === null) return false;
  const record = obj as Record<string, unknown>;

  for (const prop of propertyNames) {
    const value = record[prop];
    if (value && typeof value === "object") {
      const bilingualValue = value as BilingualLabel;
      if (!hasBothLanguages(bilingualValue)) {
        return false;
      }
    }
  }
  return true;
}

// =============================================================================
// ASSESSMENT STATUSES BILINGUAL TESTS
// =============================================================================

describe("Assessment Statuses Bilingual Support", () => {
  const statuses = Object.entries(ASSESSMENT_STATUSES);

  it.each(statuses)("status %s should have bilingual label", (status, config) => {
    expect(config.label).toBeDefined();
    expect(hasBothLanguages(config.label)).toBe(true);
  });

  it.each(statuses)("status %s should have bilingual description", (status, config) => {
    expect(config.description).toBeDefined();
    expect(hasBothLanguages(config.description)).toBe(true);
  });

  it("should have unique English labels for all statuses", () => {
    const englishLabels = Object.values(ASSESSMENT_STATUSES).map(s => s.label.en);
    const uniqueLabels = new Set(englishLabels);
    expect(uniqueLabels.size).toBe(englishLabels.length);
  });

  it("should have unique French labels for all statuses", () => {
    const frenchLabels = Object.values(ASSESSMENT_STATUSES).map(s => s.label.fr);
    const uniqueLabels = new Set(frenchLabels);
    expect(uniqueLabels.size).toBe(frenchLabels.length);
  });

  it("getAssessmentStatusArray should return all statuses with bilingual data", () => {
    const statuses = getAssessmentStatusArray();

    expect(statuses.length).toBe(Object.keys(ASSESSMENT_STATUSES).length);
    statuses.forEach(status => {
      expect(hasBothLanguages(status.label)).toBe(true);
      expect(hasBothLanguages(status.description)).toBe(true);
    });
  });
});

// =============================================================================
// ASSESSMENT TYPES BILINGUAL TESTS
// =============================================================================

describe("Assessment Types Bilingual Support", () => {
  const types = Object.entries(ASSESSMENT_TYPES);

  it.each(types)("type %s should have bilingual label", (type, config) => {
    expect(config.label).toBeDefined();
    expect(hasBothLanguages(config.label)).toBe(true);
  });

  it.each(types)("type %s should have bilingual description", (type, config) => {
    expect(config.description).toBeDefined();
    expect(hasBothLanguages(config.description)).toBe(true);
  });

  it("getAssessmentTypesArray should return all types with bilingual data", () => {
    const types = getAssessmentTypesArray();

    expect(types.length).toBe(Object.keys(ASSESSMENT_TYPES).length);
    types.forEach(type => {
      expect(hasBothLanguages(type.label)).toBe(true);
      expect(hasBothLanguages(type.description)).toBe(true);
    });
  });
});

// =============================================================================
// ANS RESPONSE VALUES BILINGUAL TESTS
// =============================================================================

describe("ANS Response Values Bilingual Support", () => {
  const responses = Object.entries(ANS_RESPONSE_VALUES);

  it.each(responses)("response %s should have bilingual label", (response, config) => {
    expect(config.label).toBeDefined();
    expect(hasBothLanguages(config.label)).toBe(true);
  });

  it.each(responses)("response %s should have bilingual description", (response, config) => {
    expect(config.description).toBeDefined();
    expect(hasBothLanguages(config.description)).toBe(true);
  });

  it("should cover all expected ANS response values", () => {
    const expectedResponses = [
      "SATISFACTORY",
      "NOT_SATISFACTORY",
      "NOT_APPLICABLE",
      "NOT_REVIEWED",
    ];

    expectedResponses.forEach(response => {
      expect(ANS_RESPONSE_VALUES[response as keyof typeof ANS_RESPONSE_VALUES]).toBeDefined();
    });
  });

  it("getANSResponseValuesArray should return all responses with bilingual data", () => {
    const responses = getANSResponseValuesArray();

    expect(responses.length).toBe(Object.keys(ANS_RESPONSE_VALUES).length);
    responses.forEach(response => {
      expect(hasBothLanguages(response.label)).toBe(true);
      expect(hasBothLanguages(response.description)).toBe(true);
    });
  });
});

// =============================================================================
// SMS MATURITY LEVELS BILINGUAL TESTS
// =============================================================================

describe("SMS Maturity Levels Bilingual Support", () => {
  const levels = Object.entries(SMS_MATURITY_LEVELS);

  it.each(levels)("level %s should have bilingual label", (level, config) => {
    expect(config.label).toBeDefined();
    expect(hasBothLanguages(config.label)).toBe(true);
  });

  it.each(levels)("level %s should have bilingual description", (level, config) => {
    expect(config.description).toBeDefined();
    expect(hasBothLanguages(config.description)).toBe(true);
  });

  it.each(levels)("level %s should have bilingual characteristics", (level, config) => {
    expect(config.characteristics).toBeDefined();
    expect(hasBothLanguages(config.characteristics)).toBe(true);
  });

  it("should cover all maturity levels A through E", () => {
    const expectedLevels = ["A", "B", "C", "D", "E"];
    expectedLevels.forEach(level => {
      expect(SMS_MATURITY_LEVELS[level as keyof typeof SMS_MATURITY_LEVELS]).toBeDefined();
    });
  });

  it("getSMSMaturityLevelsArray should return all levels with bilingual data", () => {
    const levels = getSMSMaturityLevelsArray();

    expect(levels.length).toBe(Object.keys(SMS_MATURITY_LEVELS).length);
    levels.forEach(level => {
      expect(hasBothLanguages(level.label)).toBe(true);
      expect(hasBothLanguages(level.description)).toBe(true);
      expect(hasBothLanguages(level.characteristics)).toBe(true);
    });
  });

  it("levels should be in correct order by scoreValue", () => {
    const levels = getSMSMaturityLevelsArray();
    const scores = levels.map(l => l.scoreValue);

    for (let i = 1; i < scores.length; i++) {
      expect(scores[i]).toBeGreaterThan(scores[i - 1]);
    }
  });
});

// =============================================================================
// EVIDENCE TYPES BILINGUAL TESTS
// =============================================================================

describe("Evidence Types Bilingual Support", () => {
  const evidenceTypes = Object.entries(EVIDENCE_TYPES);

  it.each(evidenceTypes)("evidence type %s should have bilingual label", (type, config) => {
    expect(config.label).toBeDefined();
    expect(hasBothLanguages(config.label)).toBe(true);
  });

  it.each(evidenceTypes)("evidence type %s should have bilingual description", (type, config) => {
    expect(config.description).toBeDefined();
    expect(hasBothLanguages(config.description)).toBe(true);
  });

  it("should cover all expected evidence types", () => {
    const expectedTypes = [
      "DOCUMENT",
      "PROCEDURE",
      "RECORD",
      "INTERVIEW",
      "OBSERVATION",
      "OTHER",
    ];

    expectedTypes.forEach(type => {
      expect(EVIDENCE_TYPES[type as keyof typeof EVIDENCE_TYPES]).toBeDefined();
    });
  });

  it("getEvidenceTypesArray should return all types with bilingual data", () => {
    const types = getEvidenceTypesArray();

    expect(types.length).toBe(Object.keys(EVIDENCE_TYPES).length);
    types.forEach(type => {
      expect(hasBothLanguages(type.label)).toBe(true);
      expect(hasBothLanguages(type.description)).toBe(true);
    });
  });
});

// =============================================================================
// EI SCORE THRESHOLDS BILINGUAL TESTS
// =============================================================================

describe("EI Score Thresholds Bilingual Support", () => {
  const thresholds = Object.entries(EI_SCORE_THRESHOLDS);

  it.each(thresholds)("threshold %s should have bilingual label", (threshold, config) => {
    expect(config.label).toBeDefined();
    expect(hasBothLanguages(config.label)).toBe(true);
  });

  it("should have thresholds in correct order", () => {
    const orderedThresholds = [
      "EXCELLENT",
      "GOOD",
      "SATISFACTORY",
      "NEEDS_IMPROVEMENT",
      "CRITICAL",
    ];

    const minValues = orderedThresholds.map(
      t => EI_SCORE_THRESHOLDS[t as keyof typeof EI_SCORE_THRESHOLDS].min
    );

    // Should be in descending order
    for (let i = 1; i < minValues.length; i++) {
      expect(minValues[i]).toBeLessThan(minValues[i - 1]);
    }
  });
});

// =============================================================================
// ICAO CRITICAL ELEMENTS BILINGUAL TESTS
// =============================================================================

describe("ICAO Critical Elements Bilingual Support", () => {
  const elements = Object.entries(CRITICAL_ELEMENTS);

  it.each(elements)("critical element %s should have bilingual names", (code, info) => {
    expect(info.nameEn).toBeDefined();
    expect(info.nameFr).toBeDefined();
    expect(info.nameEn.length).toBeGreaterThan(0);
    expect(info.nameFr.length).toBeGreaterThan(0);
  });

  it("should have all 8 critical elements", () => {
    expect(Object.keys(CRITICAL_ELEMENTS).length).toBe(8);

    const expectedCEs = ["CE_1", "CE_2", "CE_3", "CE_4", "CE_5", "CE_6", "CE_7", "CE_8"];
    expectedCEs.forEach(ce => {
      expect(CRITICAL_ELEMENTS[ce as keyof typeof CRITICAL_ELEMENTS]).toBeDefined();
    });
  });
});

// =============================================================================
// USOAP AUDIT AREAS BILINGUAL TESTS
// =============================================================================

describe("USOAP Audit Areas Bilingual Support", () => {
  const areas = Object.entries(AUDIT_AREAS);

  it.each(areas)("audit area %s should have bilingual names", (code, info) => {
    expect(info.nameEn).toBeDefined();
    expect(info.nameFr).toBeDefined();
    expect(info.nameEn.length).toBeGreaterThan(0);
    expect(info.nameFr.length).toBeGreaterThan(0);
  });

  it("should have all 9 audit areas", () => {
    expect(Object.keys(AUDIT_AREAS).length).toBe(9);

    const expectedAreas = ["LEG", "ORG", "PEL", "OPS", "AIR", "AIG", "ANS", "AGA", "SSP"];
    expectedAreas.forEach(area => {
      expect(AUDIT_AREAS[area as keyof typeof AUDIT_AREAS]).toBeDefined();
    });
  });

  it("ANS audit area should have appropriate protocol question count", () => {
    expect(AUDIT_AREAS.ANS.pqCount).toBeGreaterThan(0);
    expect(AUDIT_AREAS.ANS.pqCount).toBe(128);
  });
});

// =============================================================================
// SMS COMPONENTS BILINGUAL TESTS
// =============================================================================

describe("SMS Components Bilingual Support", () => {
  const components = Object.entries(SMS_COMPONENTS);

  it.each(components)("SMS component %s should have bilingual names", (code, info) => {
    expect(info.nameEn).toBeDefined();
    expect(info.nameFr).toBeDefined();
    expect(info.nameEn.length).toBeGreaterThan(0);
    expect(info.nameFr.length).toBeGreaterThan(0);
  });

  it("should have all 4 SMS components", () => {
    expect(Object.keys(SMS_COMPONENTS).length).toBe(4);

    const expectedComponents = [
      "SAFETY_POLICY_OBJECTIVES",
      "SAFETY_RISK_MANAGEMENT",
      "SAFETY_ASSURANCE",
      "SAFETY_PROMOTION",
    ];
    expectedComponents.forEach(comp => {
      expect(SMS_COMPONENTS[comp as keyof typeof SMS_COMPONENTS]).toBeDefined();
    });
  });

  it("component weights should sum to 1.0", () => {
    const totalWeight = Object.values(SMS_COMPONENTS).reduce(
      (sum, comp) => sum + comp.weight,
      0
    );
    expect(totalWeight).toBeCloseTo(1.0, 5);
  });
});

// =============================================================================
// SMS STUDY AREAS BILINGUAL TESTS
// =============================================================================

describe("SMS Study Areas Bilingual Support", () => {
  const studyAreas = Object.entries(SMS_STUDY_AREAS);

  it.each(studyAreas)("study area %s should have bilingual names", (code, info) => {
    expect(info.nameEn).toBeDefined();
    expect(info.nameFr).toBeDefined();
    expect(info.nameEn.length).toBeGreaterThan(0);
    expect(info.nameFr.length).toBeGreaterThan(0);
  });

  it("should have all 12 study areas", () => {
    expect(Object.keys(SMS_STUDY_AREAS).length).toBe(12);
  });

  it("each study area should belong to a valid component", () => {
    const validComponents = Object.keys(SMS_COMPONENTS);

    Object.values(SMS_STUDY_AREAS).forEach(studyArea => {
      expect(validComponents).toContain(studyArea.component);
    });
  });
});

// =============================================================================
// MATURITY LEVEL VALUES BILINGUAL TESTS
// =============================================================================

describe("Maturity Level Values Bilingual Support", () => {
  const levels = Object.entries(MATURITY_LEVEL_VALUES);

  it.each(levels)("maturity level %s should have bilingual names", (code, info) => {
    expect(info.nameEn).toBeDefined();
    expect(info.nameFr).toBeDefined();
    expect(info.nameEn.length).toBeGreaterThan(0);
    expect(info.nameFr.length).toBeGreaterThan(0);
  });

  it("should have all 5 maturity levels", () => {
    const expectedLevels = ["LEVEL_A", "LEVEL_B", "LEVEL_C", "LEVEL_D", "LEVEL_E"];

    expectedLevels.forEach(level => {
      expect(MATURITY_LEVEL_VALUES[level as keyof typeof MATURITY_LEVEL_VALUES]).toBeDefined();
    });
  });

  it("numeric values should be in correct order", () => {
    const levels = [
      MATURITY_LEVEL_VALUES.LEVEL_A,
      MATURITY_LEVEL_VALUES.LEVEL_B,
      MATURITY_LEVEL_VALUES.LEVEL_C,
      MATURITY_LEVEL_VALUES.LEVEL_D,
      MATURITY_LEVEL_VALUES.LEVEL_E,
    ];

    for (let i = 1; i < levels.length; i++) {
      expect(levels[i].numeric).toBeGreaterThan(levels[i - 1].numeric);
    }
  });
});

// =============================================================================
// TRANSLATION CONSISTENCY TESTS
// =============================================================================

describe("Translation Consistency", () => {
  it("French translations should be different from English for all statuses", () => {
    Object.values(ASSESSMENT_STATUSES).forEach(status => {
      // Some terms might be the same in both languages (e.g., "Document")
      // but labels and descriptions should generally differ
      expect(status.label.en).not.toBe(status.label.fr);
    });
  });

  it("French translations should be different from English for assessment types", () => {
    Object.values(ASSESSMENT_TYPES).forEach(type => {
      expect(type.label.en).not.toBe(type.label.fr);
    });
  });

  it("French translations should be different from English for ANS responses", () => {
    Object.values(ANS_RESPONSE_VALUES).forEach(response => {
      expect(response.label.en).not.toBe(response.label.fr);
    });
  });

  it("should not have empty translations", () => {
    const allBilingualLabels: BilingualLabel[] = [
      ...Object.values(ASSESSMENT_STATUSES).map(s => s.label),
      ...Object.values(ASSESSMENT_STATUSES).map(s => s.description),
      ...Object.values(ASSESSMENT_TYPES).map(t => t.label),
      ...Object.values(ASSESSMENT_TYPES).map(t => t.description),
      ...Object.values(ANS_RESPONSE_VALUES).map(r => r.label),
      ...Object.values(ANS_RESPONSE_VALUES).map(r => r.description),
      ...Object.values(SMS_MATURITY_LEVELS).map(l => l.label),
      ...Object.values(SMS_MATURITY_LEVELS).map(l => l.description),
      ...Object.values(EI_SCORE_THRESHOLDS).map(t => t.label),
    ];

    allBilingualLabels.forEach(label => {
      expect(label.en.trim().length).toBeGreaterThan(0);
      expect(label.fr.trim().length).toBeGreaterThan(0);
    });
  });
});

// =============================================================================
// LOCALE SWITCHING TESTS
// =============================================================================

describe("Locale Switching Support", () => {
  type Locale = "en" | "fr";

  const getLabel = (bilingualLabel: BilingualLabel, locale: Locale): string => {
    return bilingualLabel[locale];
  };

  it("should return correct language based on locale", () => {
    const label: BilingualLabel = {
      en: "Draft",
      fr: "Brouillon",
    };

    expect(getLabel(label, "en")).toBe("Draft");
    expect(getLabel(label, "fr")).toBe("Brouillon");
  });

  it("should support dynamic locale switching for statuses", () => {
    const locales: Locale[] = ["en", "fr"];

    locales.forEach(locale => {
      Object.values(ASSESSMENT_STATUSES).forEach(status => {
        const label = getLabel(status.label, locale);
        expect(label.length).toBeGreaterThan(0);
      });
    });
  });

  it("should support dynamic locale switching for all constants", () => {
    const locales: Locale[] = ["en", "fr"];

    locales.forEach(locale => {
      // Assessment types
      Object.values(ASSESSMENT_TYPES).forEach(type => {
        expect(getLabel(type.label, locale).length).toBeGreaterThan(0);
      });

      // ANS responses
      Object.values(ANS_RESPONSE_VALUES).forEach(response => {
        expect(getLabel(response.label, locale).length).toBeGreaterThan(0);
      });

      // SMS maturity levels
      Object.values(SMS_MATURITY_LEVELS).forEach(level => {
        expect(getLabel(level.label, locale).length).toBeGreaterThan(0);
      });

      // Evidence types
      Object.values(EVIDENCE_TYPES).forEach(type => {
        expect(getLabel(type.label, locale).length).toBeGreaterThan(0);
      });
    });
  });
});

// =============================================================================
// SPECIAL CHARACTERS AND ENCODING TESTS
// =============================================================================

describe("Special Characters and Encoding", () => {
  it("French translations should properly include accented characters", () => {
    const frenchTexts = [
      ...Object.values(ASSESSMENT_STATUSES).map(s => s.label.fr),
      ...Object.values(ASSESSMENT_STATUSES).map(s => s.description.fr),
      ...Object.values(ASSESSMENT_TYPES).map(t => t.label.fr),
      ...Object.values(ANS_RESPONSE_VALUES).map(r => r.label.fr),
      ...Object.values(SMS_MATURITY_LEVELS).map(l => l.label.fr),
    ];

    const hasAccentedCharacters = frenchTexts.some(text =>
      /[àâäéèêëïîôùûüç]/i.test(text)
    );

    expect(hasAccentedCharacters).toBe(true);
  });

  it("should handle French apostrophes correctly", () => {
    // French often uses apostrophes (l', d', qu', etc.)
    const frenchDescriptions = [
      ...Object.values(ASSESSMENT_STATUSES).map(s => s.description.fr),
      ...Object.values(ASSESSMENT_TYPES).map(t => t.description.fr),
    ];

    const hasApostrophes = frenchDescriptions.some(text =>
      text.includes("'") || text.includes("'")
    );

    // This is expected in French text
    expect(hasApostrophes).toBe(true);
  });
});

// =============================================================================
// DATABASE ENTITY BILINGUAL FIELDS TESTS
// =============================================================================

describe("Database Entity Bilingual Fields", () => {
  it("Question entity should support bilingual question text", () => {
    const mockQuestion = {
      questionTextEn: "What is the state of your safety policy?",
      questionTextFr: "Quel est l'état de votre politique de sécurité?",
    };

    expect(mockQuestion.questionTextEn).toBeDefined();
    expect(mockQuestion.questionTextFr).toBeDefined();
    expect(mockQuestion.questionTextEn.length).toBeGreaterThan(0);
    expect(mockQuestion.questionTextFr.length).toBeGreaterThan(0);
  });

  it("Question entity should support bilingual guidance", () => {
    const mockQuestion = {
      guidanceEn: "Review the safety policy document and verify...",
      guidanceFr: "Examinez le document de politique de sécurité et vérifiez...",
    };

    expect(mockQuestion.guidanceEn).toBeDefined();
    expect(mockQuestion.guidanceFr).toBeDefined();
  });

  it("Organization entity should support bilingual names", () => {
    const mockOrganization = {
      nameEn: "National Air Navigation Services",
      nameFr: "Services Nationaux de Navigation Aérienne",
    };

    expect(mockOrganization.nameEn).toBeDefined();
    expect(mockOrganization.nameFr).toBeDefined();
    expect(mockOrganization.nameEn.length).toBeGreaterThan(0);
    expect(mockOrganization.nameFr.length).toBeGreaterThan(0);
  });

  it("Questionnaire entity should support bilingual titles", () => {
    const mockQuestionnaire = {
      titleEn: "ANS USOAP CMA Protocol Questions 2024",
      titleFr: "Questions du protocole ANS USOAP CMA 2024",
      descriptionEn: "Protocol questions for ANS safety oversight assessment",
      descriptionFr: "Questions de protocole pour l'évaluation de la surveillance de la sécurité ANS",
    };

    expect(mockQuestionnaire.titleEn).toBeDefined();
    expect(mockQuestionnaire.titleFr).toBeDefined();
    expect(mockQuestionnaire.descriptionEn).toBeDefined();
    expect(mockQuestionnaire.descriptionFr).toBeDefined();
  });

  it("Category entity should support bilingual names and descriptions", () => {
    const mockCategory = {
      nameEn: "Safety Policy and Objectives",
      nameFr: "Politique et objectifs de sécurité",
      descriptionEn: "Questions related to safety policy documentation and objectives",
      descriptionFr: "Questions relatives à la documentation de la politique de sécurité et aux objectifs",
    };

    expect(mockCategory.nameEn).toBeDefined();
    expect(mockCategory.nameFr).toBeDefined();
    expect(mockCategory.descriptionEn).toBeDefined();
    expect(mockCategory.descriptionFr).toBeDefined();
  });
});

```

# src/__tests__/unit/scoring.test.ts

```ts
/**
 * Scoring Engine Unit Tests
 *
 * Tests for ICAO USOAP CMA EI score calculation and CANSO SoE SMS maturity scoring.
 */

import { describe, it, expect } from "vitest";
import {
  calculateEIScore,
  calculateSimpleEIScore,
  calculateSMSMaturity,
  maturityLevelToScore,
  getLowestMaturityLevel,
  calculateCategoryScores,
  compareScores,
  identifyImprovementAreas,
  validateAssessmentForSubmission,
} from "@/lib/assessment/scoring";
import {
  getMaturityLevelFromScore,
  getEIScoreCategory,
  calculateWeightedSMSScore,
} from "@/lib/assessment/constants";
import type { AssessmentResponseWithQuestion, AssessmentResponse } from "@/lib/assessment/types";
import type { USOAPAuditArea, CriticalElement, SMSComponent, CANSOStudyArea } from "@prisma/client";

// =============================================================================
// HELPER FUNCTIONS FOR CREATING TEST DATA
// =============================================================================

function createMockANSResponse(
  responseValue: "SATISFACTORY" | "NOT_SATISFACTORY" | "NOT_APPLICABLE" | "NOT_REVIEWED",
  options: {
    auditArea?: string;
    criticalElement?: string;
    isPriorityPQ?: boolean;
  } = {}
): AssessmentResponseWithQuestion {
  return {
    id: `resp_${Math.random().toString(36).slice(2)}`,
    assessmentId: "test_assessment",
    questionId: `q_${Math.random().toString(36).slice(2)}`,
    responseValue,
    maturityLevel: null,
    evidenceDescription: undefined,
    evidenceUrls: [],
    isComplete: false,
    needsReview: false,
    respondedById: "test_user",
    respondedAt: new Date(),
    lastModifiedAt: new Date(),
    question: {
      id: `q_${Math.random().toString(36).slice(2)}`,
      pqNumber: `PQ_${Math.random().toString(36).slice(2)}`,
      questionTextEn: "Test question?",
      questionTextFr: "Question de test?",
      weight: 1.0,
      isPriorityPQ: options.isPriorityPQ ?? false,
      auditArea: options.auditArea as USOAPAuditArea | undefined,
      criticalElement: options.criticalElement as CriticalElement | undefined,
      smsComponent: undefined,
      studyArea: undefined,
      requiresOnSite: false,
    },
  };
}

function createMockSMSResponse(
  maturityLevel: "A" | "B" | "C" | "D" | "E" | null,
  options: {
    smsComponent?: string;
    studyArea?: string;
  } = {}
): AssessmentResponseWithQuestion {
  return {
    id: `resp_${Math.random().toString(36).slice(2)}`,
    assessmentId: "test_assessment",
    questionId: `q_${Math.random().toString(36).slice(2)}`,
    responseValue: null,
    maturityLevel,
    evidenceDescription: undefined,
    evidenceUrls: [],
    isComplete: false,
    needsReview: false,
    respondedById: "test_user",
    respondedAt: new Date(),
    lastModifiedAt: new Date(),
    question: {
      id: `q_${Math.random().toString(36).slice(2)}`,
      pqNumber: `PQ_${Math.random().toString(36).slice(2)}`,
      questionTextEn: "Test SMS question?",
      questionTextFr: "Question SMS de test?",
      weight: 1.0,
      isPriorityPQ: false,
      auditArea: undefined,
      criticalElement: undefined,
      smsComponent: options.smsComponent as SMSComponent | undefined,
      studyArea: options.studyArea as CANSOStudyArea | undefined,
      requiresOnSite: false,
    },
  };
}

// =============================================================================
// EI SCORE CALCULATION TESTS
// =============================================================================

describe("EI Score Calculation", () => {
  describe("calculateEIScore", () => {
    it("should calculate 100% EI when all responses are Satisfactory", () => {
      const responses = [
        createMockANSResponse("SATISFACTORY"),
        createMockANSResponse("SATISFACTORY"),
        createMockANSResponse("SATISFACTORY"),
        createMockANSResponse("SATISFACTORY"),
        createMockANSResponse("SATISFACTORY"),
      ];

      const result = calculateEIScore(responses);

      expect(result.overallEI).toBe(100);
      expect(result.satisfactoryCount).toBe(5);
      expect(result.notSatisfactoryCount).toBe(0);
      expect(result.totalApplicable).toBe(5);
    });

    it("should calculate 0% EI when all responses are Not Satisfactory", () => {
      const responses = [
        createMockANSResponse("NOT_SATISFACTORY"),
        createMockANSResponse("NOT_SATISFACTORY"),
        createMockANSResponse("NOT_SATISFACTORY"),
        createMockANSResponse("NOT_SATISFACTORY"),
        createMockANSResponse("NOT_SATISFACTORY"),
      ];

      const result = calculateEIScore(responses);

      expect(result.overallEI).toBe(0);
      expect(result.satisfactoryCount).toBe(0);
      expect(result.notSatisfactoryCount).toBe(5);
      expect(result.totalApplicable).toBe(5);
    });

    it("should exclude N/A from calculation", () => {
      const responses = [
        createMockANSResponse("SATISFACTORY"),
        createMockANSResponse("SATISFACTORY"),
        createMockANSResponse("NOT_APPLICABLE"),
        createMockANSResponse("NOT_APPLICABLE"),
        createMockANSResponse("NOT_APPLICABLE"),
      ];

      const result = calculateEIScore(responses);

      expect(result.overallEI).toBe(100);
      expect(result.satisfactoryCount).toBe(2);
      expect(result.notApplicableCount).toBe(3);
      expect(result.totalApplicable).toBe(2);
    });

    it("should exclude Not Reviewed from calculation", () => {
      const responses = [
        createMockANSResponse("SATISFACTORY"),
        createMockANSResponse("NOT_SATISFACTORY"),
        createMockANSResponse("NOT_REVIEWED"),
        createMockANSResponse("NOT_REVIEWED"),
      ];

      const result = calculateEIScore(responses);

      expect(result.overallEI).toBe(50);
      expect(result.satisfactoryCount).toBe(1);
      expect(result.notSatisfactoryCount).toBe(1);
      expect(result.notReviewedCount).toBe(2);
      expect(result.totalApplicable).toBe(2);
    });

    it("should calculate correct EI for mixed responses", () => {
      const responses = [
        createMockANSResponse("SATISFACTORY"),
        createMockANSResponse("SATISFACTORY"),
        createMockANSResponse("SATISFACTORY"),
        createMockANSResponse("NOT_SATISFACTORY"),
        createMockANSResponse("NOT_SATISFACTORY"),
        createMockANSResponse("NOT_APPLICABLE"),
        createMockANSResponse("NOT_REVIEWED"),
      ];

      const result = calculateEIScore(responses);

      // 3 Satisfactory, 2 Not Satisfactory = 3/5 = 60%
      expect(result.overallEI).toBe(60);
      expect(result.satisfactoryCount).toBe(3);
      expect(result.notSatisfactoryCount).toBe(2);
      expect(result.notApplicableCount).toBe(1);
      expect(result.notReviewedCount).toBe(1);
      expect(result.totalApplicable).toBe(5);
    });

    it("should handle empty responses", () => {
      const result = calculateEIScore([]);

      expect(result.overallEI).toBe(0);
      expect(result.totalApplicable).toBe(0);
    });

    it("should handle all N/A responses", () => {
      const responses = [
        createMockANSResponse("NOT_APPLICABLE"),
        createMockANSResponse("NOT_APPLICABLE"),
        createMockANSResponse("NOT_APPLICABLE"),
      ];

      const result = calculateEIScore(responses);

      expect(result.overallEI).toBe(0);
      expect(result.totalApplicable).toBe(0);
      expect(result.notApplicableCount).toBe(3);
    });

    it("should calculate EI by audit area", () => {
      const responses = [
        createMockANSResponse("SATISFACTORY", { auditArea: "ANS" }),
        createMockANSResponse("SATISFACTORY", { auditArea: "ANS" }),
        createMockANSResponse("NOT_SATISFACTORY", { auditArea: "ANS" }),
        createMockANSResponse("SATISFACTORY", { auditArea: "AGA" }),
        createMockANSResponse("NOT_SATISFACTORY", { auditArea: "AGA" }),
      ];

      const result = calculateEIScore(responses);

      // ANS: 2/3 = 66.67%, AGA: 1/2 = 50%
      expect(result.auditAreaScores["ANS"].ei).toBeCloseTo(66.67, 1);
      expect(result.auditAreaScores["ANS"].satisfactory).toBe(2);
      expect(result.auditAreaScores["ANS"].notSatisfactory).toBe(1);

      expect(result.auditAreaScores["AGA"].ei).toBe(50);
      expect(result.auditAreaScores["AGA"].satisfactory).toBe(1);
      expect(result.auditAreaScores["AGA"].notSatisfactory).toBe(1);
    });

    it("should calculate EI by critical element", () => {
      const responses = [
        createMockANSResponse("SATISFACTORY", { criticalElement: "CE_1" }),
        createMockANSResponse("SATISFACTORY", { criticalElement: "CE_1" }),
        createMockANSResponse("NOT_SATISFACTORY", { criticalElement: "CE_1" }),
        createMockANSResponse("SATISFACTORY", { criticalElement: "CE_2" }),
      ];

      const result = calculateEIScore(responses);

      // CE_1: 2/3 = 66.67%, CE_2: 1/1 = 100%
      expect(result.criticalElementScores["CE_1"].ei).toBeCloseTo(66.67, 1);
      expect(result.criticalElementScores["CE_2"].ei).toBe(100);
    });

    it("should calculate priority PQ score separately", () => {
      const responses = [
        createMockANSResponse("SATISFACTORY", { isPriorityPQ: true }),
        createMockANSResponse("SATISFACTORY", { isPriorityPQ: true }),
        createMockANSResponse("NOT_SATISFACTORY", { isPriorityPQ: true }),
        createMockANSResponse("SATISFACTORY", { isPriorityPQ: false }),
        createMockANSResponse("NOT_SATISFACTORY", { isPriorityPQ: false }),
      ];

      const result = calculateEIScore(responses);

      // Priority: 2/3 = 66.67%
      // Overall: 3/5 = 60%
      expect(result.priorityPQScore).toBeCloseTo(66.67, 1);
      expect(result.overallEI).toBe(60);
    });
  });

  describe("calculateSimpleEIScore", () => {
    it("should calculate EI from simple counts", () => {
      expect(calculateSimpleEIScore(80, 20)).toBe(80);
      expect(calculateSimpleEIScore(50, 50)).toBe(50);
      expect(calculateSimpleEIScore(100, 0)).toBe(100);
      expect(calculateSimpleEIScore(0, 100)).toBe(0);
    });

    it("should return 0 when no applicable responses", () => {
      expect(calculateSimpleEIScore(0, 0)).toBe(0);
    });

    it("should round to 2 decimal places", () => {
      expect(calculateSimpleEIScore(1, 2)).toBeCloseTo(33.33, 2);
      expect(calculateSimpleEIScore(2, 3)).toBe(40);
    });
  });
});

// =============================================================================
// SMS MATURITY CALCULATION TESTS
// =============================================================================

describe("SMS Maturity Calculation", () => {
  describe("maturityLevelToScore", () => {
    it("should convert maturity levels to correct numeric scores", () => {
      expect(maturityLevelToScore("A")).toBe(1);
      expect(maturityLevelToScore("B")).toBe(2);
      expect(maturityLevelToScore("C")).toBe(3);
      expect(maturityLevelToScore("D")).toBe(4);
      expect(maturityLevelToScore("E")).toBe(5);
    });
  });

  describe("getMaturityLevelFromScore", () => {
    it("should convert numeric scores to correct maturity levels", () => {
      expect(getMaturityLevelFromScore(1)).toBe("A");
      expect(getMaturityLevelFromScore(1.4)).toBe("A");
      expect(getMaturityLevelFromScore(1.5)).toBe("B");
      expect(getMaturityLevelFromScore(2)).toBe("B");
      expect(getMaturityLevelFromScore(2.5)).toBe("C");
      expect(getMaturityLevelFromScore(3)).toBe("C");
      expect(getMaturityLevelFromScore(3.5)).toBe("D");
      expect(getMaturityLevelFromScore(4)).toBe("D");
      expect(getMaturityLevelFromScore(4.5)).toBe("E");
      expect(getMaturityLevelFromScore(5)).toBe("E");
    });
  });

  describe("getLowestMaturityLevel", () => {
    it("should return the lowest level from an array", () => {
      expect(getLowestMaturityLevel(["A", "B", "C"])).toBe("A");
      expect(getLowestMaturityLevel(["B", "C", "D"])).toBe("B");
      expect(getLowestMaturityLevel(["C", "D", "E"])).toBe("C");
      expect(getLowestMaturityLevel(["D", "E"])).toBe("D");
      expect(getLowestMaturityLevel(["E"])).toBe("E");
    });

    it("should handle null values", () => {
      expect(getLowestMaturityLevel(["B", null, "D"])).toBe("B");
      expect(getLowestMaturityLevel([null, "C", null])).toBe("C");
    });

    it("should return null for empty or all-null arrays", () => {
      expect(getLowestMaturityLevel([])).toBe(null);
      expect(getLowestMaturityLevel([null, null])).toBe(null);
    });
  });

  describe("calculateSMSMaturity", () => {
    it("should calculate overall maturity from uniform responses", () => {
      const responses = [
        createMockSMSResponse("C", { smsComponent: "SAFETY_POLICY_OBJECTIVES" }),
        createMockSMSResponse("C", { smsComponent: "SAFETY_POLICY_OBJECTIVES" }),
        createMockSMSResponse("C", { smsComponent: "SAFETY_RISK_MANAGEMENT" }),
        createMockSMSResponse("C", { smsComponent: "SAFETY_RISK_MANAGEMENT" }),
        createMockSMSResponse("C", { smsComponent: "SAFETY_ASSURANCE" }),
        createMockSMSResponse("C", { smsComponent: "SAFETY_PROMOTION" }),
      ];

      const result = calculateSMSMaturity(responses);

      expect(result.overallLevel).toBe("C");
      expect(result.overallScore).toBe(3);
    });

    it("should use lowest component level as overall level", () => {
      const responses = [
        createMockSMSResponse("E", { smsComponent: "SAFETY_POLICY_OBJECTIVES" }),
        createMockSMSResponse("E", { smsComponent: "SAFETY_POLICY_OBJECTIVES" }),
        createMockSMSResponse("A", { smsComponent: "SAFETY_RISK_MANAGEMENT" }), // Lowest
        createMockSMSResponse("D", { smsComponent: "SAFETY_ASSURANCE" }),
        createMockSMSResponse("D", { smsComponent: "SAFETY_PROMOTION" }),
      ];

      const result = calculateSMSMaturity(responses);

      // Overall level should be A (lowest component)
      expect(result.overallLevel).toBe("A");
    });

    it("should calculate component-level scores correctly", () => {
      const responses = [
        createMockSMSResponse("D", { smsComponent: "SAFETY_POLICY_OBJECTIVES" }),
        createMockSMSResponse("E", { smsComponent: "SAFETY_POLICY_OBJECTIVES" }),
        createMockSMSResponse("C", { smsComponent: "SAFETY_RISK_MANAGEMENT" }),
        createMockSMSResponse("C", { smsComponent: "SAFETY_RISK_MANAGEMENT" }),
      ];

      const result = calculateSMSMaturity(responses);

      // SAFETY_POLICY_OBJECTIVES: (4+5)/2 = 4.5 -> Level E
      expect(result.componentLevels["SAFETY_POLICY_OBJECTIVES"].score).toBe(4.5);
      expect(result.componentLevels["SAFETY_POLICY_OBJECTIVES"].level).toBe("E");

      // SAFETY_RISK_MANAGEMENT: (3+3)/2 = 3 -> Level C
      expect(result.componentLevels["SAFETY_RISK_MANAGEMENT"].score).toBe(3);
      expect(result.componentLevels["SAFETY_RISK_MANAGEMENT"].level).toBe("C");
    });

    it("should calculate study area scores", () => {
      const responses = [
        createMockSMSResponse("D", { studyArea: "SA_1_1" }),
        createMockSMSResponse("D", { studyArea: "SA_1_1" }),
        createMockSMSResponse("B", { studyArea: "SA_2_1" }),
        createMockSMSResponse("C", { studyArea: "SA_2_1" }),
      ];

      const result = calculateSMSMaturity(responses);

      // SA_1_1: (4+4)/2 = 4 -> Level D
      expect(result.studyAreaLevels["SA_1_1"].score).toBe(4);
      expect(result.studyAreaLevels["SA_1_1"].level).toBe("D");

      // SA_2_1: (2+3)/2 = 2.5 -> Level C
      expect(result.studyAreaLevels["SA_2_1"].score).toBe(2.5);
      expect(result.studyAreaLevels["SA_2_1"].level).toBe("C");
    });

    it("should track maturity distribution", () => {
      const responses = [
        createMockSMSResponse("A", { smsComponent: "SAFETY_POLICY_OBJECTIVES" }),
        createMockSMSResponse("B", { smsComponent: "SAFETY_POLICY_OBJECTIVES" }),
        createMockSMSResponse("B", { smsComponent: "SAFETY_RISK_MANAGEMENT" }),
        createMockSMSResponse("C", { smsComponent: "SAFETY_ASSURANCE" }),
        createMockSMSResponse("C", { smsComponent: "SAFETY_PROMOTION" }),
        createMockSMSResponse("C", { smsComponent: "SAFETY_PROMOTION" }),
      ];

      const result = calculateSMSMaturity(responses);

      expect(result.maturityDistribution["A"]).toBe(1);
      expect(result.maturityDistribution["B"]).toBe(2);
      expect(result.maturityDistribution["C"]).toBe(3);
      expect(result.maturityDistribution["D"]).toBe(0);
      expect(result.maturityDistribution["E"]).toBe(0);
    });

    it("should identify gap areas (below Level C)", () => {
      const responses = [
        createMockSMSResponse("A", { smsComponent: "SAFETY_POLICY_OBJECTIVES" }),
        createMockSMSResponse("B", { smsComponent: "SAFETY_RISK_MANAGEMENT" }),
        createMockSMSResponse("C", { smsComponent: "SAFETY_ASSURANCE" }),
        createMockSMSResponse("D", { smsComponent: "SAFETY_PROMOTION" }),
      ];

      const result = calculateSMSMaturity(responses);

      expect(result.gapAreas).toContain("SAFETY_POLICY_OBJECTIVES");
      expect(result.gapAreas).toContain("SAFETY_RISK_MANAGEMENT");
      expect(result.gapAreas).not.toContain("SAFETY_ASSURANCE");
      expect(result.gapAreas).not.toContain("SAFETY_PROMOTION");
    });

    it("should handle empty responses", () => {
      const result = calculateSMSMaturity([]);

      expect(result.overallLevel).toBe(null);
      expect(result.overallScore).toBe(0);
    });

    it("should handle null maturity levels", () => {
      const responses = [
        createMockSMSResponse(null, { smsComponent: "SAFETY_POLICY_OBJECTIVES" }),
        createMockSMSResponse("C", { smsComponent: "SAFETY_RISK_MANAGEMENT" }),
      ];

      const result = calculateSMSMaturity(responses);

      expect(result.maturityDistribution["null"]).toBe(1);
      expect(result.componentLevels["SAFETY_RISK_MANAGEMENT"].score).toBe(3);
    });

    it("should apply component weights correctly", () => {
      const responses = [
        createMockSMSResponse("D", { smsComponent: "SAFETY_POLICY_OBJECTIVES" }), // 0.25 weight
        createMockSMSResponse("D", { smsComponent: "SAFETY_RISK_MANAGEMENT" }), // 0.30 weight
        createMockSMSResponse("D", { smsComponent: "SAFETY_ASSURANCE" }), // 0.25 weight
        createMockSMSResponse("D", { smsComponent: "SAFETY_PROMOTION" }), // 0.20 weight
      ];

      const result = calculateSMSMaturity(responses);

      // All D (score 4), so weighted average should be 4
      expect(result.overallScore).toBe(4);
      expect(result.componentLevels["SAFETY_POLICY_OBJECTIVES"].weight).toBe(0.25);
      expect(result.componentLevels["SAFETY_RISK_MANAGEMENT"].weight).toBe(0.30);
    });
  });

  describe("calculateWeightedSMSScore", () => {
    it("should calculate weighted average correctly", () => {
      const scores = {
        SAFETY_POLICY_OBJECTIVES: 4, // 0.25 weight
        SAFETY_RISK_MANAGEMENT: 3,  // 0.30 weight
        SAFETY_ASSURANCE: 4,        // 0.25 weight
        SAFETY_PROMOTION: 5,        // 0.20 weight
      };

      // (4*0.25 + 3*0.30 + 4*0.25 + 5*0.20) / (0.25+0.30+0.25+0.20)
      // = (1 + 0.9 + 1 + 1) / 1 = 3.9
      const result = calculateWeightedSMSScore(scores);
      expect(result).toBeCloseTo(3.9, 1);
    });

    it("should handle partial component scores", () => {
      const scores = {
        SAFETY_POLICY_OBJECTIVES: 4,
        SAFETY_RISK_MANAGEMENT: 3,
      };

      const result = calculateWeightedSMSScore(scores);
      // (4*0.25 + 3*0.30) / (0.25 + 0.30) = (1 + 0.9) / 0.55 = 3.45
      expect(result).toBeCloseTo(3.45, 1);
    });

    it("should return 0 for empty scores", () => {
      const result = calculateWeightedSMSScore({});
      expect(result).toBe(0);
    });
  });
});

// =============================================================================
// EI SCORE CATEGORY TESTS
// =============================================================================

describe("EI Score Categories", () => {
  describe("getEIScoreCategory", () => {
    it("should categorize scores correctly", () => {
      expect(getEIScoreCategory(95)).toBe("EXCELLENT");
      expect(getEIScoreCategory(90)).toBe("EXCELLENT");
      expect(getEIScoreCategory(89)).toBe("GOOD");
      expect(getEIScoreCategory(75)).toBe("GOOD");
      expect(getEIScoreCategory(74)).toBe("SATISFACTORY");
      expect(getEIScoreCategory(60)).toBe("SATISFACTORY");
      expect(getEIScoreCategory(59)).toBe("NEEDS_IMPROVEMENT");
      expect(getEIScoreCategory(40)).toBe("NEEDS_IMPROVEMENT");
      expect(getEIScoreCategory(39)).toBe("CRITICAL");
      expect(getEIScoreCategory(0)).toBe("CRITICAL");
    });
  });
});

// =============================================================================
// CATEGORY SCORING TESTS
// =============================================================================

describe("Category Scoring", () => {
  describe("calculateCategoryScores", () => {
    it("should calculate ANS category scores by audit area", () => {
      const responses = [
        createMockANSResponse("SATISFACTORY", { auditArea: "ANS" }),
        createMockANSResponse("SATISFACTORY", { auditArea: "ANS" }),
        createMockANSResponse("NOT_SATISFACTORY", { auditArea: "ANS" }),
        createMockANSResponse("SATISFACTORY", { auditArea: "AGA" }),
        createMockANSResponse("SATISFACTORY", { auditArea: "AGA" }),
      ];

      const result = calculateCategoryScores(responses, "ANS_USOAP_CMA");

      // ANS: 2/3 = 66.67%
      expect(result["ANS"]).toBeCloseTo(66.67, 1);
      // AGA: 2/2 = 100%
      expect(result["AGA"]).toBe(100);
    });

    it("should calculate SMS category scores by component", () => {
      const responses = [
        createMockSMSResponse("D", { smsComponent: "SAFETY_POLICY_OBJECTIVES" }),
        createMockSMSResponse("E", { smsComponent: "SAFETY_POLICY_OBJECTIVES" }),
        createMockSMSResponse("C", { smsComponent: "SAFETY_RISK_MANAGEMENT" }),
      ];

      const result = calculateCategoryScores(responses, "SMS_CANSO_SOE");

      // SAFETY_POLICY_OBJECTIVES: (4+5)/2 = 4.5, converted to percentage: 4.5/5*100 = 90%
      expect(result["SAFETY_POLICY_OBJECTIVES"]).toBe(90);
      // SAFETY_RISK_MANAGEMENT: 3/5*100 = 60%
      expect(result["SAFETY_RISK_MANAGEMENT"]).toBe(60);
    });
  });
});

// =============================================================================
// COMPARISON UTILITIES TESTS
// =============================================================================

describe("Score Comparison", () => {
  describe("compareScores", () => {
    it("should identify improving trend", () => {
      const result = compareScores(80, 70);

      expect(result.delta).toBe(10);
      expect(result.percentageChange).toBeCloseTo(14.29, 1);
      expect(result.trend).toBe("IMPROVING");
    });

    it("should identify declining trend", () => {
      const result = compareScores(60, 75);

      expect(result.delta).toBe(-15);
      expect(result.percentageChange).toBe(-20);
      expect(result.trend).toBe("DECLINING");
    });

    it("should identify stable trend for small changes", () => {
      const result = compareScores(75.5, 75);

      expect(result.delta).toBe(0.5);
      expect(result.trend).toBe("STABLE");
    });

    it("should handle zero previous score", () => {
      const result = compareScores(50, 0);

      expect(result.delta).toBe(50);
      expect(result.percentageChange).toBe(100);
      expect(result.trend).toBe("IMPROVING");
    });
  });

  describe("identifyImprovementAreas", () => {
    it("should identify improved categories", () => {
      const current = { ANS: 80, AGA: 60, SSP: 70 };
      const previous = { ANS: 70, AGA: 65, SSP: 60 };

      const result = identifyImprovementAreas(current, previous);

      expect(result.improved).toContain("ANS");
      expect(result.improved).toContain("SSP");
      expect(result.declined).toContain("AGA");
    });

    it("should identify unchanged categories within threshold", () => {
      const current = { ANS: 72 };
      const previous = { ANS: 70 };

      const result = identifyImprovementAreas(current, previous, 5);

      expect(result.unchanged).toContain("ANS");
    });

    it("should handle new categories", () => {
      const current = { ANS: 80, NEW: 60 };
      const previous = { ANS: 70 };

      const result = identifyImprovementAreas(current, previous);

      expect(result.improved).toContain("ANS");
      expect(result.improved).toContain("NEW");
    });

    it("should handle removed categories", () => {
      const current = { ANS: 80 };
      const previous = { ANS: 70, OLD: 60 };

      const result = identifyImprovementAreas(current, previous);

      expect(result.improved).toContain("ANS");
      expect(result.declined).toContain("OLD");
    });
  });
});

// =============================================================================
// VALIDATION TESTS
// =============================================================================

describe("Assessment Validation", () => {
  describe("validateAssessmentForSubmission", () => {
    it("should validate complete ANS assessment", () => {
      const responses: AssessmentResponse[] = [
        {
          id: "1",
          assessmentId: "test",
          questionId: "q1",
          responseValue: "SATISFACTORY",
          maturityLevel: null,
          evidenceDescription: "Evidence provided",
          evidenceUrls: [],
          isComplete: true,
          needsReview: false,
          respondedById: "user1",
          respondedAt: new Date(),
          lastModifiedAt: new Date(),
        },
        {
          id: "2",
          assessmentId: "test",
          questionId: "q2",
          responseValue: "NOT_SATISFACTORY",
          maturityLevel: null,
          evidenceDescription: "Evidence provided",
          evidenceUrls: [],
          isComplete: true,
          needsReview: false,
          respondedById: "user1",
          respondedAt: new Date(),
          lastModifiedAt: new Date(),
        },
      ];

      const result = validateAssessmentForSubmission(
        responses,
        2,
        "ANS_USOAP_CMA"
      );

      expect(result.isValid).toBe(true);
      expect(result.errors).toHaveLength(0);
    });

    it("should reject incomplete ANS assessment", () => {
      const responses: AssessmentResponse[] = [
        {
          id: "1",
          assessmentId: "test",
          questionId: "q1",
          responseValue: "SATISFACTORY",
          maturityLevel: null,
          evidenceDescription: undefined,
          evidenceUrls: [],
          isComplete: false,
          needsReview: false,
          respondedById: "user1",
          respondedAt: new Date(),
          lastModifiedAt: new Date(),
        },
      ];

      const result = validateAssessmentForSubmission(
        responses,
        5, // 5 total questions but only 1 answered
        "ANS_USOAP_CMA"
      );

      expect(result.isValid).toBe(false);
      expect(result.errors.length).toBeGreaterThan(0);
    });

    it("should reject ANS assessment with NOT_REVIEWED responses", () => {
      const responses: AssessmentResponse[] = [
        {
          id: "1",
          assessmentId: "test",
          questionId: "q1",
          responseValue: "NOT_REVIEWED",
          maturityLevel: null,
          evidenceDescription: undefined,
          evidenceUrls: [],
          isComplete: false,
          needsReview: false,
          respondedById: "user1",
          respondedAt: new Date(),
          lastModifiedAt: new Date(),
        },
      ];

      const result = validateAssessmentForSubmission(
        responses,
        1,
        "ANS_USOAP_CMA"
      );

      expect(result.isValid).toBe(false);
      expect(result.errors.some(e => e.includes("Not Reviewed"))).toBe(true);
    });

    it("should warn about low evidence percentage", () => {
      const responses: AssessmentResponse[] = [
        {
          id: "1",
          assessmentId: "test",
          questionId: "q1",
          responseValue: "SATISFACTORY",
          maturityLevel: null,
          evidenceDescription: undefined, // No evidence
          evidenceUrls: [],
          isComplete: false,
          needsReview: false,
          respondedById: "user1",
          respondedAt: new Date(),
          lastModifiedAt: new Date(),
        },
        {
          id: "2",
          assessmentId: "test",
          questionId: "q2",
          responseValue: "SATISFACTORY",
          maturityLevel: null,
          evidenceDescription: undefined, // No evidence
          evidenceUrls: [],
          isComplete: false,
          needsReview: false,
          respondedById: "user1",
          respondedAt: new Date(),
          lastModifiedAt: new Date(),
        },
      ];

      const result = validateAssessmentForSubmission(
        responses,
        2,
        "ANS_USOAP_CMA"
      );

      expect(result.warnings.length).toBeGreaterThan(0);
      expect(result.warnings.some(w => w.includes("evidence"))).toBe(true);
    });

    it("should validate complete SMS assessment", () => {
      const responses: AssessmentResponse[] = [
        {
          id: "1",
          assessmentId: "test",
          questionId: "q1",
          responseValue: null,
          maturityLevel: "C",
          evidenceDescription: "Evidence provided",
          evidenceUrls: [],
          isComplete: true,
          needsReview: false,
          respondedById: "user1",
          respondedAt: new Date(),
          lastModifiedAt: new Date(),
        },
      ];

      const result = validateAssessmentForSubmission(
        responses,
        1,
        "SMS_CANSO_SOE"
      );

      expect(result.isValid).toBe(true);
    });
  });
});

// =============================================================================
// EDGE CASES AND BOUNDARY TESTS
// =============================================================================

describe("Edge Cases", () => {
  it("should handle single response correctly", () => {
    const satisfactoryResponses = [createMockANSResponse("SATISFACTORY")];
    const notSatisfactoryResponses = [createMockANSResponse("NOT_SATISFACTORY")];

    expect(calculateEIScore(satisfactoryResponses).overallEI).toBe(100);
    expect(calculateEIScore(notSatisfactoryResponses).overallEI).toBe(0);
  });

  it("should handle large number of responses", () => {
    const responses: AssessmentResponseWithQuestion[] = [];
    for (let i = 0; i < 1000; i++) {
      responses.push(
        createMockANSResponse(i % 2 === 0 ? "SATISFACTORY" : "NOT_SATISFACTORY")
      );
    }

    const result = calculateEIScore(responses);

    expect(result.overallEI).toBe(50);
    expect(result.totalApplicable).toBe(1000);
  });

  it("should handle precision correctly for decimal percentages", () => {
    const responses = [
      createMockANSResponse("SATISFACTORY"),
      createMockANSResponse("SATISFACTORY"),
      createMockANSResponse("NOT_SATISFACTORY"),
    ];

    const result = calculateEIScore(responses);

    // 2/3 = 66.666... should be rounded to 66.67
    expect(result.overallEI).toBeCloseTo(66.67, 2);
  });
});

```

# src/app/[locale]/(auth)/layout.tsx

```tsx
interface AuthLayoutProps {
  children: React.ReactNode;
}

export default function AuthLayout({ children }: AuthLayoutProps) {
  return <>{children}</>;
}

```

# src/app/[locale]/(auth)/login/page.tsx

```tsx
"use client";

import { useState, use } from "react";
import { signIn } from "next-auth/react";
import { useRouter, useSearchParams } from "next/navigation";
import { useTranslations } from "next-intl";
import Link from "next/link";
import { useForm } from "react-hook-form";
import { zodResolver } from "@hookform/resolvers/zod";
import { z } from "zod";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from "@/components/ui/card";
import { Alert, AlertDescription } from "@/components/ui/alert";
import { Loader2, AlertCircle } from "lucide-react";

const loginSchema = z.object({
  email: z.string().email("Invalid email address"),
  password: z.string().min(1, "Password is required"),
});

type LoginForm = z.infer<typeof loginSchema>;

export default function LoginPage({ params }: { params: Promise<{ locale: string }> }) {
  const { locale } = use(params);
  const router = useRouter();
  const searchParams = useSearchParams();
  const t = useTranslations("auth");
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  const callbackUrl = searchParams.get("callbackUrl") || `/${locale}/dashboard`;

  const { register, handleSubmit, formState: { errors } } = useForm<LoginForm>({
    resolver: zodResolver(loginSchema),
  });

  const onSubmit = async (data: LoginForm) => {
    setIsLoading(true);
    setError(null);

    try {
      const result = await signIn("credentials", {
        email: data.email,
        password: data.password,
        redirect: false,
      });

      if (result?.error) {
        setError(t("errors.invalidCredentials"));
      } else {
        router.push(callbackUrl);
        router.refresh();
      }
    } catch {
      setError(t("errors.generic"));
    } finally {
      setIsLoading(false);
    }
  };

  return (
    <div className="min-h-screen flex items-center justify-center bg-muted/30 px-4">
      <Card className="w-full max-w-md">
        <CardHeader className="text-center">
          <div className="flex justify-center mb-4">
            <div className="flex h-12 w-12 items-center justify-center rounded-lg bg-primary text-primary-foreground text-xl font-bold">A</div>
          </div>
          <CardTitle className="text-2xl">{t("login.title")}</CardTitle>
          <CardDescription>{t("login.subtitle")}</CardDescription>
        </CardHeader>
        <form onSubmit={handleSubmit(onSubmit)}>
          <CardContent className="space-y-4">
            {error && (
              <Alert variant="destructive">
                <AlertCircle className="h-4 w-4" />
                <AlertDescription>{error}</AlertDescription>
              </Alert>
            )}
            <div className="space-y-2">
              <Label htmlFor="email">{t("fields.email")}</Label>
              <Input id="email" type="email" placeholder="name@example.com" {...register("email")} disabled={isLoading} />
              {errors.email && <p className="text-sm text-destructive">{errors.email.message}</p>}
            </div>
            <div className="space-y-2">
              <div className="flex items-center justify-between">
                <Label htmlFor="password">{t("fields.password")}</Label>
                <Link href={`/${locale}/forgot-password`} className="text-sm text-primary hover:underline">{t("login.forgotPassword")}</Link>
              </div>
              <Input id="password" type="password" {...register("password")} disabled={isLoading} />
              {errors.password && <p className="text-sm text-destructive">{errors.password.message}</p>}
            </div>
          </CardContent>
          <CardFooter className="flex flex-col gap-4">
            <Button type="submit" className="w-full" disabled={isLoading}>
              {isLoading ? <><Loader2 className="mr-2 h-4 w-4 animate-spin" />{t("login.signingIn")}</> : t("login.signIn")}
            </Button>
            <p className="text-sm text-muted-foreground text-center">
              {t("login.noAccount")} <Link href={`/${locale}/register`} className="text-primary hover:underline">{t("login.signUp")}</Link>
            </p>
          </CardFooter>
        </form>
      </Card>
    </div>
  );
}

```

# src/app/[locale]/(auth)/register/page.tsx

```tsx
"use client";

import { useState, use } from "react";
import { useRouter } from "next/navigation";
import { useTranslations } from "next-intl";
import Link from "next/link";
import { useForm } from "react-hook-form";
import { zodResolver } from "@hookform/resolvers/zod";
import { z } from "zod";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from "@/components/ui/card";
import { Alert, AlertDescription } from "@/components/ui/alert";
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/ui/select";
import { Loader2, AlertCircle, CheckCircle } from "lucide-react";

const registerSchema = z.object({
  firstName: z.string().min(2, "First name must be at least 2 characters"),
  lastName: z.string().min(2, "Last name must be at least 2 characters"),
  email: z.string().email("Invalid email address"),
  password: z.string()
    .min(12, "Password must be at least 12 characters")
    .regex(/[A-Z]/, "Must contain uppercase")
    .regex(/[a-z]/, "Must contain lowercase")
    .regex(/[0-9]/, "Must contain number")
    .regex(/[^A-Za-z0-9]/, "Must contain special character"),
  confirmPassword: z.string(),
  locale: z.enum(["EN", "FR"]),
}).refine((data) => data.password === data.confirmPassword, {
  message: "Passwords don't match",
  path: ["confirmPassword"],
});

type RegisterForm = z.infer<typeof registerSchema>;

export default function RegisterPage({ params }: { params: Promise<{ locale: string }> }) {
  const { locale } = use(params);
  const router = useRouter();
  const t = useTranslations("auth");
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const [success, setSuccess] = useState(false);

  const { register, handleSubmit, setValue, formState: { errors } } = useForm<RegisterForm>({
    resolver: zodResolver(registerSchema),
    defaultValues: { locale: locale.toUpperCase() as "EN" | "FR" },
  });

  const onSubmit = async (data: RegisterForm) => {
    setIsLoading(true);
    setError(null);

    try {
      const response = await fetch("/api/auth/register", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          firstName: data.firstName,
          lastName: data.lastName,
          email: data.email,
          password: data.password,
          locale: data.locale,
        }),
      });

      const result = await response.json();

      if (!response.ok) {
        setError(result.error || t("errors.generic"));
      } else {
        setSuccess(true);
        setTimeout(() => router.push(`/${locale}/login`), 2000);
      }
    } catch {
      setError(t("errors.generic"));
    } finally {
      setIsLoading(false);
    }
  };

  if (success) {
    return (
      <div className="min-h-screen flex items-center justify-center bg-muted/30 px-4">
        <Card className="w-full max-w-md">
          <CardContent className="pt-6">
            <div className="flex flex-col items-center text-center">
              <CheckCircle className="h-12 w-12 text-green-500 mb-4" />
              <h2 className="text-xl font-semibold mb-2">{t("register.success")}</h2>
              <p className="text-muted-foreground">{t("register.redirecting")}</p>
            </div>
          </CardContent>
        </Card>
      </div>
    );
  }

  return (
    <div className="min-h-screen flex items-center justify-center bg-muted/30 px-4 py-8">
      <Card className="w-full max-w-md">
        <CardHeader className="text-center">
          <div className="flex justify-center mb-4">
            <div className="flex h-12 w-12 items-center justify-center rounded-lg bg-primary text-primary-foreground text-xl font-bold">A</div>
          </div>
          <CardTitle className="text-2xl">{t("register.title")}</CardTitle>
          <CardDescription>{t("register.subtitle")}</CardDescription>
        </CardHeader>
        <form onSubmit={handleSubmit(onSubmit)}>
          <CardContent className="space-y-4">
            {error && (
              <Alert variant="destructive">
                <AlertCircle className="h-4 w-4" />
                <AlertDescription>{error}</AlertDescription>
              </Alert>
            )}
            <div className="grid grid-cols-2 gap-4">
              <div className="space-y-2">
                <Label htmlFor="firstName">{t("fields.firstName")}</Label>
                <Input id="firstName" {...register("firstName")} disabled={isLoading} />
                {errors.firstName && <p className="text-xs text-destructive">{errors.firstName.message}</p>}
              </div>
              <div className="space-y-2">
                <Label htmlFor="lastName">{t("fields.lastName")}</Label>
                <Input id="lastName" {...register("lastName")} disabled={isLoading} />
                {errors.lastName && <p className="text-xs text-destructive">{errors.lastName.message}</p>}
              </div>
            </div>
            <div className="space-y-2">
              <Label htmlFor="email">{t("fields.email")}</Label>
              <Input id="email" type="email" placeholder="name@example.com" {...register("email")} disabled={isLoading} />
              {errors.email && <p className="text-sm text-destructive">{errors.email.message}</p>}
            </div>
            <div className="space-y-2">
              <Label htmlFor="password">{t("fields.password")}</Label>
              <Input id="password" type="password" {...register("password")} disabled={isLoading} />
              {errors.password && <p className="text-sm text-destructive">{errors.password.message}</p>}
              <p className="text-xs text-muted-foreground">{t("register.passwordRequirements")}</p>
            </div>
            <div className="space-y-2">
              <Label htmlFor="confirmPassword">{t("fields.confirmPassword")}</Label>
              <Input id="confirmPassword" type="password" {...register("confirmPassword")} disabled={isLoading} />
              {errors.confirmPassword && <p className="text-sm text-destructive">{errors.confirmPassword.message}</p>}
            </div>
            <div className="space-y-2">
              <Label htmlFor="locale">{t("fields.language")}</Label>
              <Select defaultValue={locale.toUpperCase()} onValueChange={(value) => setValue("locale", value as "EN" | "FR")} disabled={isLoading}>
                <SelectTrigger><SelectValue /></SelectTrigger>
                <SelectContent>
                  <SelectItem value="EN">English</SelectItem>
                  <SelectItem value="FR">Français</SelectItem>
                </SelectContent>
              </Select>
            </div>
          </CardContent>
          <CardFooter className="flex flex-col gap-4">
            <Button type="submit" className="w-full" disabled={isLoading}>
              {isLoading ? <><Loader2 className="mr-2 h-4 w-4 animate-spin" />{t("register.creating")}</> : t("register.createAccount")}
            </Button>
            <p className="text-sm text-muted-foreground text-center">
              {t("register.haveAccount")} <Link href={`/${locale}/login`} className="text-primary hover:underline">{t("register.signIn")}</Link>
            </p>
          </CardFooter>
        </form>
      </Card>
    </div>
  );
}

```

# src/app/[locale]/(auth)/unauthorized/page.tsx

```tsx
import Link from "next/link";
import { Button } from "@/components/ui/button";
import { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from "@/components/ui/card";
import { ShieldX } from "lucide-react";

export default async function UnauthorizedPage({ params }: { params: Promise<{ locale: string }> }) {
  const { locale } = await params;

  return (
    <div className="min-h-screen flex items-center justify-center bg-muted/30 px-4">
      <Card className="w-full max-w-md text-center">
        <CardHeader>
          <div className="flex justify-center mb-4">
            <ShieldX className="h-16 w-16 text-destructive" />
          </div>
          <CardTitle className="text-2xl">Access Denied</CardTitle>
          <CardDescription>You don&apos;t have permission to access this page.</CardDescription>
        </CardHeader>
        <CardContent>
          <p className="text-sm text-muted-foreground">If you believe this is an error, please contact your administrator.</p>
        </CardContent>
        <CardFooter className="flex justify-center">
          <Button asChild>
            <Link href={`/${locale}/dashboard`}>Return to Dashboard</Link>
          </Button>
        </CardFooter>
      </Card>
    </div>
  );
}

```

# src/app/[locale]/(dashboard)/admin/questionnaires/import/page.tsx

```tsx
import { redirect } from "next/navigation";
import Link from "next/link";
import { getTranslations } from "next-intl/server";
import { auth } from "@/lib/auth";
import { Button } from "@/components/ui/button";
import { ChevronLeft } from "lucide-react";
import { QuestionnaireImportWizard } from "@/components/features/admin/questionnaire-import-wizard";

interface ImportPageProps {
  params: Promise<{
    locale: string;
  }>;
}

// Admin roles that can access this page
const ADMIN_ROLES = ["SUPER_ADMIN", "SYSTEM_ADMIN", "PROGRAMME_COORDINATOR"];

export async function generateMetadata({ params }: ImportPageProps) {
  const { locale } = await params;
  const t = await getTranslations({ locale, namespace: "admin.import" });

  return {
    title: t("pageTitle"),
    description: t("pageDescription"),
  };
}

export default async function ImportPage({ params }: ImportPageProps) {
  const { locale } = await params;
  const session = await auth();

  // Check authentication
  if (!session?.user) {
    redirect(`/${locale}/login`);
  }

  // Check authorization
  if (!ADMIN_ROLES.includes(session.user.role)) {
    redirect(`/${locale}/unauthorized`);
  }

  const t = await getTranslations({ locale, namespace: "admin.import" });

  return (
    <div className="container mx-auto py-6 px-4 max-w-4xl">
      {/* Back Button */}
      <Button variant="ghost" asChild className="mb-4">
        <Link href={`/${locale}/admin/questionnaires`}>
          <ChevronLeft className="h-4 w-4 mr-2" />
          {t("backToList")}
        </Link>
      </Button>

      {/* Page Header */}
      <div className="mb-8">
        <h1 className="text-2xl font-bold tracking-tight">{t("pageTitle")}</h1>
        <p className="text-muted-foreground">{t("pageDescription")}</p>
      </div>

      {/* Import Wizard */}
      <QuestionnaireImportWizard locale={locale} />
    </div>
  );
}

```

# src/app/[locale]/(dashboard)/admin/questionnaires/page.tsx

```tsx
import { Suspense } from "react";
import { redirect } from "next/navigation";
import { getTranslations } from "next-intl/server";
import { auth } from "@/lib/auth";
import { QuestionnaireListContent } from "./questionnaire-list-content";
import { QuestionnaireListSkeleton } from "./questionnaire-list-skeleton";

interface AdminQuestionnairesPageProps {
  params: Promise<{
    locale: string;
  }>;
}

// Admin roles that can access this page
const ADMIN_ROLES = ["SUPER_ADMIN", "SYSTEM_ADMIN", "PROGRAMME_COORDINATOR"];

export async function generateMetadata({ params }: AdminQuestionnairesPageProps) {
  const { locale } = await params;
  const t = await getTranslations({ locale, namespace: "admin.questionnaires" });

  return {
    title: t("title"),
    description: t("description"),
  };
}

export default async function AdminQuestionnairesPage({
  params,
}: AdminQuestionnairesPageProps) {
  const { locale } = await params;
  const session = await auth();

  // Check authentication
  if (!session?.user) {
    redirect(`/${locale}/login`);
  }

  // Check authorization
  if (!ADMIN_ROLES.includes(session.user.role)) {
    redirect(`/${locale}/unauthorized`);
  }

  return (
    <div className="container mx-auto py-6 px-4 max-w-7xl">
      <Suspense fallback={<QuestionnaireListSkeleton />}>
        <QuestionnaireListContent locale={locale} />
      </Suspense>
    </div>
  );
}

```

# src/app/[locale]/(dashboard)/admin/questionnaires/questionnaire-list-content.tsx

```tsx
"use client";

import { useState } from "react";
import Link from "next/link";
import { useRouter } from "next/navigation";
import { useTranslations } from "next-intl";
import { toast } from "sonner";
import { format } from "date-fns";
import { cn } from "@/lib/utils";
import { Button } from "@/components/ui/button";
import { Badge } from "@/components/ui/badge";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import {
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableHeader,
  TableRow,
} from "@/components/ui/table";
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuSeparator,
  DropdownMenuTrigger,
} from "@/components/ui/dropdown-menu";
import {
  AlertDialog,
  AlertDialogAction,
  AlertDialogCancel,
  AlertDialogContent,
  AlertDialogDescription,
  AlertDialogFooter,
  AlertDialogHeader,
  AlertDialogTitle,
} from "@/components/ui/alert-dialog";
import {
  Upload,
  MoreHorizontal,
  Eye,
  Edit,
  Trash2,
  FileText,
  Shield,
  Calendar,
  Hash,
  RefreshCw,
  Settings,
} from "lucide-react";
import { trpc } from "@/lib/trpc/client";

interface QuestionnaireListContentProps {
  locale: string;
}

export function QuestionnaireListContent({
  locale,
}: QuestionnaireListContentProps) {
  const t = useTranslations("admin.questionnaires");
  const router = useRouter();

  // State
  const [deleteId, setDeleteId] = useState<string | null>(null);
  const [hardDelete, setHardDelete] = useState(false);

  // Fetch questionnaires
  const { data: questionnaires, isLoading, refetch } = trpc.admin.questionnaire.list.useQuery({
    includeInactive: true,
  });

  // Delete mutation
  const deleteMutation = trpc.admin.questionnaire.delete.useMutation({
    onSuccess: (result) => {
      toast.success(
        result.hard ? t("deleteHardSuccess") : t("deleteSoftSuccess")
      );
      refetch();
      setDeleteId(null);
    },
    onError: (error) => {
      toast.error(error.message);
    },
  });

  const handleDelete = (id: string, hard: boolean) => {
    setDeleteId(id);
    setHardDelete(hard);
  };

  const confirmDelete = () => {
    if (deleteId) {
      deleteMutation.mutate({ id: deleteId, hardDelete });
    }
  };

  if (isLoading) {
    return <QuestionnaireListSkeleton />;
  }

  return (
    <div className="space-y-6">
      {/* Header */}
      <div className="flex items-center justify-between">
        <div>
          <h1 className="text-2xl font-bold tracking-tight flex items-center gap-2">
            <Settings className="h-6 w-6" />
            {t("title")}
          </h1>
          <p className="text-muted-foreground">{t("description")}</p>
        </div>

        <div className="flex items-center gap-2">
          <Button variant="outline" onClick={() => refetch()}>
            <RefreshCw className="h-4 w-4 mr-2" />
            {t("refresh")}
          </Button>
          <Button asChild>
            <Link href={`/${locale}/admin/questionnaires/import`}>
              <Upload className="h-4 w-4 mr-2" />
              {t("import")}
            </Link>
          </Button>
        </div>
      </div>

      {/* Stats Cards */}
      <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
        <Card>
          <CardHeader className="pb-2">
            <CardTitle className="text-sm font-medium text-muted-foreground">
              {t("stats.total")}
            </CardTitle>
          </CardHeader>
          <CardContent>
            <p className="text-2xl font-bold">{questionnaires?.length || 0}</p>
          </CardContent>
        </Card>
        <Card>
          <CardHeader className="pb-2">
            <CardTitle className="text-sm font-medium text-muted-foreground">
              {t("stats.active")}
            </CardTitle>
          </CardHeader>
          <CardContent>
            <p className="text-2xl font-bold text-emerald-600">
              {questionnaires?.filter((q) => q.isActive).length || 0}
            </p>
          </CardContent>
        </Card>
        <Card>
          <CardHeader className="pb-2">
            <CardTitle className="text-sm font-medium text-muted-foreground">
              {t("stats.ansCount")}
            </CardTitle>
          </CardHeader>
          <CardContent>
            <p className="text-2xl font-bold text-blue-600">
              {questionnaires?.filter((q) => q.type === "ANS_USOAP_CMA").length || 0}
            </p>
          </CardContent>
        </Card>
        <Card>
          <CardHeader className="pb-2">
            <CardTitle className="text-sm font-medium text-muted-foreground">
              {t("stats.smsCount")}
            </CardTitle>
          </CardHeader>
          <CardContent>
            <p className="text-2xl font-bold text-emerald-600">
              {questionnaires?.filter((q) => q.type === "SMS_CANSO_SOE").length || 0}
            </p>
          </CardContent>
        </Card>
      </div>

      {/* Questionnaire Table */}
      <Card>
        <CardContent className="pt-6">
          {questionnaires && questionnaires.length > 0 ? (
            <Table>
              <TableHeader>
                <TableRow>
                  <TableHead>{t("table.type")}</TableHead>
                  <TableHead>{t("table.code")}</TableHead>
                  <TableHead>{t("table.title")}</TableHead>
                  <TableHead>{t("table.version")}</TableHead>
                  <TableHead>{t("table.effectiveDate")}</TableHead>
                  <TableHead>{t("table.questions")}</TableHead>
                  <TableHead>{t("table.assessments")}</TableHead>
                  <TableHead>{t("table.status")}</TableHead>
                  <TableHead className="w-12"></TableHead>
                </TableRow>
              </TableHeader>
              <TableBody>
                {questionnaires.map((q) => (
                  <TableRow key={q.id} className={cn(!q.isActive && "opacity-60")}>
                    <TableCell>
                      <Badge
                        variant="outline"
                        className={cn(
                          q.type === "ANS_USOAP_CMA"
                            ? "bg-blue-50 text-blue-700 border-blue-200 dark:bg-blue-900/20 dark:text-blue-400"
                            : "bg-emerald-50 text-emerald-700 border-emerald-200 dark:bg-emerald-900/20 dark:text-emerald-400"
                        )}
                      >
                        {q.type === "ANS_USOAP_CMA" ? (
                          <FileText className="h-3 w-3 mr-1" />
                        ) : (
                          <Shield className="h-3 w-3 mr-1" />
                        )}
                        {q.type === "ANS_USOAP_CMA" ? "ANS" : "SMS"}
                      </Badge>
                    </TableCell>
                    <TableCell className="font-mono text-sm">{q.code}</TableCell>
                    <TableCell>
                      <div>
                        <p className="font-medium">{q.titleEn}</p>
                        <p className="text-xs text-muted-foreground">{q.titleFr}</p>
                      </div>
                    </TableCell>
                    <TableCell>
                      <Badge variant="secondary">{q.version}</Badge>
                    </TableCell>
                    <TableCell className="text-sm">
                      <div className="flex items-center gap-1">
                        <Calendar className="h-3 w-3 text-muted-foreground" />
                        {format(new Date(q.effectiveDate), "MMM d, yyyy")}
                      </div>
                    </TableCell>
                    <TableCell>
                      <div className="flex items-center gap-1">
                        <Hash className="h-3 w-3 text-muted-foreground" />
                        {q._count.questions}
                      </div>
                    </TableCell>
                    <TableCell>
                      <Badge variant="outline">{q._count.assessments}</Badge>
                    </TableCell>
                    <TableCell>
                      {q.isActive ? (
                        <Badge className="bg-emerald-100 text-emerald-700 dark:bg-emerald-900/50 dark:text-emerald-400">
                          {t("active")}
                        </Badge>
                      ) : (
                        <Badge variant="secondary">{t("inactive")}</Badge>
                      )}
                    </TableCell>
                    <TableCell>
                      <DropdownMenu>
                        <DropdownMenuTrigger asChild>
                          <Button variant="ghost" size="icon" className="h-8 w-8">
                            <MoreHorizontal className="h-4 w-4" />
                          </Button>
                        </DropdownMenuTrigger>
                        <DropdownMenuContent align="end">
                          <DropdownMenuItem
                            onClick={() =>
                              router.push(
                                `/${locale}/questionnaires/${q.type === "ANS_USOAP_CMA" ? "ans" : "sms"}`
                              )
                            }
                          >
                            <Eye className="h-4 w-4 mr-2" />
                            {t("actions.view")}
                          </DropdownMenuItem>
                          <DropdownMenuItem
                            onClick={() =>
                              router.push(`/${locale}/admin/questionnaires/${q.id}/edit`)
                            }
                          >
                            <Edit className="h-4 w-4 mr-2" />
                            {t("actions.edit")}
                          </DropdownMenuItem>
                          <DropdownMenuSeparator />
                          <DropdownMenuItem
                            onClick={() => handleDelete(q.id, false)}
                            className="text-amber-600"
                          >
                            <Trash2 className="h-4 w-4 mr-2" />
                            {t("actions.deactivate")}
                          </DropdownMenuItem>
                          {q._count.assessments === 0 && (
                            <DropdownMenuItem
                              onClick={() => handleDelete(q.id, true)}
                              className="text-destructive"
                            >
                              <Trash2 className="h-4 w-4 mr-2" />
                              {t("actions.delete")}
                            </DropdownMenuItem>
                          )}
                        </DropdownMenuContent>
                      </DropdownMenu>
                    </TableCell>
                  </TableRow>
                ))}
              </TableBody>
            </Table>
          ) : (
            <div className="text-center py-12">
              <FileText className="h-12 w-12 text-muted-foreground mx-auto mb-4" />
              <h3 className="text-lg font-medium">{t("empty.title")}</h3>
              <p className="text-sm text-muted-foreground mt-1">
                {t("empty.description")}
              </p>
              <Button asChild className="mt-4">
                <Link href={`/${locale}/admin/questionnaires/import`}>
                  <Upload className="h-4 w-4 mr-2" />
                  {t("empty.action")}
                </Link>
              </Button>
            </div>
          )}
        </CardContent>
      </Card>

      {/* Delete Confirmation Dialog */}
      <AlertDialog open={deleteId !== null} onOpenChange={() => setDeleteId(null)}>
        <AlertDialogContent>
          <AlertDialogHeader>
            <AlertDialogTitle>
              {hardDelete ? t("deleteDialog.hardTitle") : t("deleteDialog.softTitle")}
            </AlertDialogTitle>
            <AlertDialogDescription>
              {hardDelete
                ? t("deleteDialog.hardDescription")
                : t("deleteDialog.softDescription")}
            </AlertDialogDescription>
          </AlertDialogHeader>
          <AlertDialogFooter>
            <AlertDialogCancel>{t("deleteDialog.cancel")}</AlertDialogCancel>
            <AlertDialogAction
              onClick={confirmDelete}
              className={cn(
                hardDelete && "bg-destructive text-destructive-foreground hover:bg-destructive/90"
              )}
            >
              {deleteMutation.isPending ? t("deleteDialog.deleting") : t("deleteDialog.confirm")}
            </AlertDialogAction>
          </AlertDialogFooter>
        </AlertDialogContent>
      </AlertDialog>
    </div>
  );
}

// Skeleton component
function QuestionnaireListSkeleton() {
  return (
    <div className="space-y-6">
      <div className="flex items-center justify-between">
        <div className="space-y-2">
          <div className="h-8 w-64 bg-muted rounded animate-pulse" />
          <div className="h-4 w-96 bg-muted rounded animate-pulse" />
        </div>
        <div className="flex gap-2">
          <div className="h-10 w-24 bg-muted rounded animate-pulse" />
          <div className="h-10 w-24 bg-muted rounded animate-pulse" />
        </div>
      </div>

      <div className="grid grid-cols-4 gap-4">
        {[1, 2, 3, 4].map((i) => (
          <Card key={i}>
            <CardContent className="pt-6">
              <div className="h-4 w-20 bg-muted rounded animate-pulse mb-2" />
              <div className="h-8 w-12 bg-muted rounded animate-pulse" />
            </CardContent>
          </Card>
        ))}
      </div>

      <Card>
        <CardContent className="pt-6">
          <div className="space-y-4">
            {[1, 2, 3, 4].map((i) => (
              <div key={i} className="h-16 bg-muted rounded animate-pulse" />
            ))}
          </div>
        </CardContent>
      </Card>
    </div>
  );
}

export { QuestionnaireListSkeleton };

```

# src/app/[locale]/(dashboard)/admin/questionnaires/questionnaire-list-skeleton.tsx

```tsx
"use client";

import { Card, CardContent } from "@/components/ui/card";
import { Skeleton } from "@/components/ui/skeleton";

export function QuestionnaireListSkeleton() {
  return (
    <div className="space-y-6">
      {/* Header */}
      <div className="flex items-center justify-between">
        <div className="space-y-2">
          <Skeleton className="h-8 w-64" />
          <Skeleton className="h-4 w-96" />
        </div>
        <div className="flex gap-2">
          <Skeleton className="h-10 w-24" />
          <Skeleton className="h-10 w-24" />
        </div>
      </div>

      {/* Stats */}
      <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
        {[1, 2, 3, 4].map((i) => (
          <Card key={i}>
            <CardContent className="pt-6">
              <Skeleton className="h-4 w-20 mb-2" />
              <Skeleton className="h-8 w-12" />
            </CardContent>
          </Card>
        ))}
      </div>

      {/* Table */}
      <Card>
        <CardContent className="pt-6">
          <div className="space-y-4">
            <div className="grid grid-cols-9 gap-4">
              {[1, 2, 3, 4, 5, 6, 7, 8, 9].map((i) => (
                <Skeleton key={i} className="h-4" />
              ))}
            </div>
            {[1, 2, 3, 4, 5].map((i) => (
              <div key={i} className="grid grid-cols-9 gap-4">
                {[1, 2, 3, 4, 5, 6, 7, 8, 9].map((j) => (
                  <Skeleton key={j} className="h-10" />
                ))}
              </div>
            ))}
          </div>
        </CardContent>
      </Card>
    </div>
  );
}

```

# src/app/[locale]/(dashboard)/assessments/[id]/page.tsx

```tsx
"use client";

import { useTranslations } from "next-intl";
import { use } from "react";
import { motion } from "framer-motion";
import { ArrowLeft, Settings, HelpCircle, Loader2 } from "lucide-react";
import Link from "next/link";
import { Button } from "@/components/ui/button";
import { Badge } from "@/components/ui/badge";
import {
  Tooltip,
  TooltipContent,
  TooltipProvider,
  TooltipTrigger,
} from "@/components/ui/tooltip";
import {
  AssessmentWorkspaceProvider,
  useAssessmentWorkspace,
} from "@/components/features/assessment/assessment-workspace-context";
import { QuestionNavigationSidebar } from "@/components/features/assessment/question-navigation-sidebar";
import { QuestionResponsePanel } from "@/components/features/assessment/question-response-panel";

interface PageProps {
  params: Promise<{ id: string; locale: string }>;
}

function WorkspaceHeader() {
  const t = useTranslations("workspace");
  const { assessment, progressPercent, answeredCount, totalCount } =
    useAssessmentWorkspace();

  if (!assessment) return null;

  return (
    <header className="flex items-center justify-between border-b px-4 py-3 bg-background">
      <div className="flex items-center gap-4">
        <TooltipProvider>
          <Tooltip>
            <TooltipTrigger asChild>
              <Button variant="ghost" size="icon" asChild>
                <Link href="/assessments">
                  <ArrowLeft className="h-4 w-4" />
                </Link>
              </Button>
            </TooltipTrigger>
            <TooltipContent>
              <p>{t("header.backToAssessments")}</p>
            </TooltipContent>
          </Tooltip>
        </TooltipProvider>

        <div>
          <div className="flex items-center gap-2">
            <h1 className="font-semibold text-lg">{assessment.title}</h1>
            <Badge
              variant={
                assessment.questionnaireType === "ANS_USOAP_CMA"
                  ? "default"
                  : "secondary"
              }
            >
              {assessment.questionnaireType === "ANS_USOAP_CMA" ? "ANS" : "SMS"}
            </Badge>
            <Badge variant="outline">{assessment.status}</Badge>
          </div>
          <p className="text-sm text-muted-foreground">
            {t("header.progress", {
              answered: answeredCount,
              total: totalCount,
              percent: progressPercent,
            })}
          </p>
        </div>
      </div>

      <div className="flex items-center gap-2">
        <TooltipProvider>
          <Tooltip>
            <TooltipTrigger asChild>
              <Button variant="ghost" size="icon">
                <HelpCircle className="h-4 w-4" />
              </Button>
            </TooltipTrigger>
            <TooltipContent>
              <p>{t("header.help")}</p>
            </TooltipContent>
          </Tooltip>
        </TooltipProvider>

        <TooltipProvider>
          <Tooltip>
            <TooltipTrigger asChild>
              <Button variant="ghost" size="icon">
                <Settings className="h-4 w-4" />
              </Button>
            </TooltipTrigger>
            <TooltipContent>
              <p>{t("header.settings")}</p>
            </TooltipContent>
          </Tooltip>
        </TooltipProvider>
      </div>
    </header>
  );
}

function WorkspaceContent() {
  const { isLoading, error } = useAssessmentWorkspace();
  const t = useTranslations("workspace");

  if (isLoading) {
    return (
      <div className="flex items-center justify-center h-full">
        <div className="text-center">
          <Loader2 className="h-8 w-8 animate-spin mx-auto text-primary mb-4" />
          <p className="text-muted-foreground">{t("loading")}</p>
        </div>
      </div>
    );
  }

  if (error) {
    return (
      <div className="flex items-center justify-center h-full">
        <div className="text-center">
          <h2 className="text-xl font-semibold text-destructive mb-2">
            {t("error.title")}
          </h2>
          <p className="text-muted-foreground mb-4">{t("error.description")}</p>
          <Button variant="outline" asChild>
            <Link href="/assessments">{t("error.backButton")}</Link>
          </Button>
        </div>
      </div>
    );
  }

  return (
    <div className="flex flex-1 overflow-hidden">
      {/* Left Sidebar - Question Navigation */}
      <QuestionNavigationSidebar />

      {/* Main Content - Question Response */}
      <motion.main
        initial={{ opacity: 0 }}
        animate={{ opacity: 1 }}
        className="flex-1 overflow-hidden"
      >
        <QuestionResponsePanel />
      </motion.main>
    </div>
  );
}

export default function AssessmentWorkspacePage({ params }: PageProps) {
  const { id } = use(params);

  return (
    <AssessmentWorkspaceProvider assessmentId={id}>
      <div className="flex flex-col h-screen bg-background">
        <WorkspaceHeader />
        <WorkspaceContent />
      </div>
    </AssessmentWorkspaceProvider>
  );
}

```

# src/app/[locale]/(dashboard)/assessments/[id]/progress/page.tsx

```tsx
"use client";

import { use, useState } from "react";
import { useTranslations } from "next-intl";
import Link from "next/link";
import { useRouter } from "next/navigation";
import {
  ArrowLeft,
  Play,
  FileText,
  Clock,
  Calendar,
  Loader2,
  RefreshCw,
} from "lucide-react";
import { format } from "date-fns";
import { Button } from "@/components/ui/button";
import { Badge } from "@/components/ui/badge";
import {
  Card,
  CardContent,
  CardDescription,
  CardHeader,
  CardTitle,
} from "@/components/ui/card";
import { Tabs, TabsContent, TabsList, TabsTrigger } from "@/components/ui/tabs";
import { CircularProgress } from "@/components/features/progress/ProgressBar";
import { CategoryProgress } from "@/components/features/progress/CategoryProgress";
import { ActivityTimeline } from "@/components/features/progress/ActivityTimeline";
import { trpc } from "@/lib/trpc/client";

// =============================================================================
// TYPES
// =============================================================================

interface PageProps {
  params: Promise<{ id: string; locale: string }>;
}

// =============================================================================
// COMPONENT
// =============================================================================

export default function AssessmentProgressPage({ params }: PageProps) {
  const { id } = use(params);
  const t = useTranslations("progress");
  const router = useRouter();
  const [timelineOffset, setTimelineOffset] = useState(0);

  // Fetch assessment summary with progress
  const {
    data: summary,
    isLoading: summaryLoading,
    refetch: refetchSummary,
  } = trpc.progress.getAssessmentSummary.useQuery({ assessmentId: id });

  // Fetch timeline events
  const {
    data: timeline,
    isLoading: timelineLoading,
    refetch: refetchTimeline,
  } = trpc.progress.getTimeline.useQuery({
    assessmentId: id,
    limit: 20,
    offset: timelineOffset,
  });

  // Handle refresh
  const handleRefresh = () => {
    refetchSummary();
    refetchTimeline();
  };

  // Handle category click - navigate to that category
  const handleCategoryClick = (categoryId: string) => {
    router.push(`/assessments/${id}?category=${categoryId}`);
  };

  // Handle load more timeline events
  const handleLoadMore = () => {
    setTimelineOffset((prev) => prev + 20);
  };

  // Loading state
  if (summaryLoading) {
    return (
      <div className="flex items-center justify-center h-screen">
        <div className="text-center">
          <Loader2 className="h-8 w-8 animate-spin mx-auto text-primary mb-4" />
          <p className="text-muted-foreground">{t("loading")}</p>
        </div>
      </div>
    );
  }

  // Error state
  if (!summary) {
    return (
      <div className="flex items-center justify-center h-screen">
        <div className="text-center">
          <h2 className="text-xl font-semibold text-destructive mb-2">
            {t("error.title")}
          </h2>
          <p className="text-muted-foreground mb-4">{t("error.notFound")}</p>
          <Button variant="outline" asChild>
            <Link href="/assessments">{t("error.back")}</Link>
          </Button>
        </div>
      </div>
    );
  }

  const assessment = summary;
  const progress = summary.progressStats;

  return (
    <div className="min-h-screen bg-muted/30">
      {/* Header */}
      <header className="bg-background border-b sticky top-0 z-10">
        <div className="container mx-auto px-4 py-4">
          <div className="flex items-center justify-between">
            <div className="flex items-center gap-4">
              <Button variant="ghost" size="icon" asChild>
                <Link href={`/assessments/${id}`}>
                  <ArrowLeft className="h-4 w-4" />
                </Link>
              </Button>
              <div>
                <h1 className="font-semibold text-lg">{assessment.title}</h1>
                <div className="flex items-center gap-2 mt-0.5">
                  <Badge variant="outline">{assessment.status}</Badge>
                  <Badge variant="secondary">
                    {assessment.questionnaire.type === "ANS_USOAP_CMA"
                      ? "ANS"
                      : "SMS"}
                  </Badge>
                </div>
              </div>
            </div>

            <div className="flex items-center gap-2">
              <Button variant="outline" size="sm" onClick={handleRefresh}>
                <RefreshCw className="h-4 w-4 mr-2" />
                {t("refresh")}
              </Button>
              <Button asChild>
                <Link href={`/assessments/${id}`}>
                  <Play className="h-4 w-4 mr-2" />
                  {t("continue")}
                </Link>
              </Button>
            </div>
          </div>
        </div>
      </header>

      {/* Content */}
      <main className="container mx-auto px-4 py-6">
        {/* Summary Cards */}
        <div className="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
          {/* Overall Progress */}
          <Card>
            <CardContent className="p-6">
              <div className="flex items-center justify-between">
                <div>
                  <p className="text-sm text-muted-foreground">
                    {t("summary.progress")}
                  </p>
                  <p className="text-2xl font-bold mt-1">
                    {progress.percentComplete}%
                  </p>
                  <p className="text-xs text-muted-foreground mt-1">
                    {progress.answeredQuestions} / {progress.totalQuestions}{" "}
                    {t("summary.questions")}
                  </p>
                </div>
                <CircularProgress
                  value={progress.percentComplete}
                  size={60}
                  strokeWidth={6}
                  showLabel={false}
                />
              </div>
            </CardContent>
          </Card>

          {/* Status */}
          <Card>
            <CardContent className="p-6">
              <div className="flex items-center gap-3">
                <div className="p-3 rounded-lg bg-blue-100">
                  <FileText className="h-5 w-5 text-blue-600" />
                </div>
                <div>
                  <p className="text-sm text-muted-foreground">
                    {t("summary.status")}
                  </p>
                  <p className="font-semibold">{assessment.status}</p>
                </div>
              </div>
            </CardContent>
          </Card>

          {/* Activity */}
          <Card>
            <CardContent className="p-6">
              <div className="flex items-center gap-3">
                <div className="p-3 rounded-lg bg-purple-100">
                  <Clock className="h-5 w-5 text-purple-600" />
                </div>
                <div>
                  <p className="text-sm text-muted-foreground">
                    {t("summary.activity")}
                  </p>
                  <p className="font-semibold">{assessment._count.events}</p>
                </div>
              </div>
            </CardContent>
          </Card>

          {/* Due Date */}
          <Card>
            <CardContent className="p-6">
              <div className="flex items-center gap-3">
                <div className="p-3 rounded-lg bg-orange-100">
                  <Calendar className="h-5 w-5 text-orange-600" />
                </div>
                <div>
                  <p className="text-sm text-muted-foreground">
                    {t("summary.dueDate")}
                  </p>
                  <p className="font-semibold">
                    {assessment.dueDate
                      ? format(new Date(assessment.dueDate), "MMM d, yyyy")
                      : t("summary.noDueDate")}
                  </p>
                </div>
              </div>
            </CardContent>
          </Card>
        </div>

        {/* Tabs */}
        <Tabs defaultValue="progress" className="space-y-4">
          <TabsList>
            <TabsTrigger value="progress">{t("tabs.progress")}</TabsTrigger>
            <TabsTrigger value="timeline">{t("tabs.timeline")}</TabsTrigger>
          </TabsList>

          {/* Progress Tab */}
          <TabsContent value="progress">
            <Card>
              <CardHeader>
                <CardTitle>{t("categories.title")}</CardTitle>
                <CardDescription>{t("categories.description")}</CardDescription>
              </CardHeader>
              <CardContent>
                <CategoryProgress
                  categories={progress.byCategory}
                  onCategoryClick={handleCategoryClick}
                  showDetails
                />
              </CardContent>
            </Card>
          </TabsContent>

          {/* Timeline Tab */}
          <TabsContent value="timeline">
            <Card>
              <CardHeader>
                <CardTitle>{t("timeline.title")}</CardTitle>
                <CardDescription>{t("timeline.description")}</CardDescription>
              </CardHeader>
              <CardContent>
                {timelineLoading && timelineOffset === 0 ? (
                  <div className="flex items-center justify-center py-8">
                    <Loader2 className="h-6 w-6 animate-spin text-muted-foreground" />
                  </div>
                ) : timeline ? (
                  <ActivityTimeline
                    events={timeline.events}
                    totalCount={timeline.totalCount}
                    hasMore={timeline.hasMore}
                    onLoadMore={handleLoadMore}
                    isLoadingMore={timelineLoading && timelineOffset > 0}
                    maxHeight="500px"
                  />
                ) : (
                  <p className="text-center text-muted-foreground py-8">
                    {t("timeline.empty")}
                  </p>
                )}
              </CardContent>
            </Card>
          </TabsContent>
        </Tabs>
      </main>
    </div>
  );
}

```

# src/app/[locale]/(dashboard)/assessments/[id]/take/page.tsx

```tsx
"use client";

import { use } from "react";
import { useTranslations, useLocale } from "next-intl";
import { useRouter } from "next/navigation";
import { motion } from "framer-motion";
import {
  ArrowLeft,
  Settings,
  HelpCircle,
  Loader2,
  Maximize2,
  Minimize2,
  Send,
  AlertTriangle,
  CheckCircle2,
} from "lucide-react";
import Link from "next/link";
import { useState } from "react";
import { Button } from "@/components/ui/button";
import { Badge } from "@/components/ui/badge";
import { Progress } from "@/components/ui/progress";
import {
  Tooltip,
  TooltipContent,
  TooltipProvider,
  TooltipTrigger,
} from "@/components/ui/tooltip";
import {
  AlertDialog,
  AlertDialogAction,
  AlertDialogCancel,
  AlertDialogContent,
  AlertDialogDescription,
  AlertDialogFooter,
  AlertDialogHeader,
  AlertDialogTitle,
  AlertDialogTrigger,
} from "@/components/ui/alert-dialog";
import {
  AssessmentWorkspaceProvider,
  useAssessmentWorkspace,
} from "@/components/features/assessment/assessment-workspace-context";
import { QuestionNavigationSidebar } from "@/components/features/assessment/question-navigation-sidebar";
import { QuestionResponsePanel } from "@/components/features/assessment/question-response-panel";
import { trpc } from "@/lib/trpc/client";
import { toast } from "sonner";

interface PageProps {
  params: Promise<{ id: string; locale: string }>;
}

function WorkspaceHeader() {
  const t = useTranslations("workspace");
  const tAssessment = useTranslations("assessment");
  const tCommon = useTranslations("common");
  const locale = useLocale();
  const router = useRouter();
  const [isFullscreen, setIsFullscreen] = useState(false);
  const {
    assessment,
    progressPercent,
    answeredCount,
    totalCount,
    saveStatus,
  } = useAssessmentWorkspace();

  // Submit mutation
  const submitMutation = trpc.assessment.submit.useMutation({
    onSuccess: () => {
      toast.success(tAssessment("submitSuccess"));
      router.push(`/${locale}/assessments`);
    },
    onError: (error) => {
      toast.error(error.message || tAssessment("submitError"));
    },
  });

  if (!assessment) return null;

  const handleFullscreenToggle = () => {
    if (!document.fullscreenElement) {
      document.documentElement.requestFullscreen();
      setIsFullscreen(true);
    } else {
      document.exitFullscreen();
      setIsFullscreen(false);
    }
  };

  const handleSubmit = async () => {
    if (!assessment?.id) return;
    await submitMutation.mutateAsync({ id: assessment.id });
  };

  const canSubmit = progressPercent === 100;
  const isSubmitting = submitMutation.isPending;

  const questionnaireTitle =
    locale === "fr"
      ? assessment.questionnaire.titleFr
      : assessment.questionnaire.titleEn;

  const orgName =
    locale === "fr"
      ? assessment.organization.nameFr
      : assessment.organization.nameEn;

  return (
    <header className="flex items-center justify-between border-b px-4 py-3 bg-background shrink-0">
      <div className="flex items-center gap-4">
        <TooltipProvider>
          <Tooltip>
            <TooltipTrigger asChild>
              <Button variant="ghost" size="icon" asChild>
                <Link href={`/assessments/${assessment.id}`}>
                  <ArrowLeft className="h-4 w-4" />
                </Link>
              </Button>
            </TooltipTrigger>
            <TooltipContent>
              <p>{t("header.backToAssessments")}</p>
            </TooltipContent>
          </Tooltip>
        </TooltipProvider>

        <div>
          <div className="flex items-center gap-2 flex-wrap">
            <h1 className="font-semibold text-lg">{orgName}</h1>
            <Badge
              variant={
                assessment.questionnaireType === "ANS_USOAP_CMA"
                  ? "default"
                  : "secondary"
              }
            >
              {assessment.questionnaireType === "ANS_USOAP_CMA" ? "ANS" : "SMS"}
            </Badge>
            <Badge variant="outline">
              {tAssessment(`status.${assessment.status}`)}
            </Badge>
            {saveStatus === "saving" && (
              <Badge variant="secondary" className="animate-pulse">
                {t("panel.saving")}
              </Badge>
            )}
            {saveStatus === "saved" && (
              <Badge variant="outline" className="text-green-600 border-green-200">
                {t("panel.saved")}
              </Badge>
            )}
          </div>
          <p className="text-sm text-muted-foreground">{questionnaireTitle}</p>
        </div>
      </div>

      {/* Progress indicator in header */}
      <div className="hidden md:flex items-center gap-4 flex-1 max-w-md mx-8">
        <Progress value={progressPercent} className="flex-1" />
        <span className="text-sm font-medium whitespace-nowrap">
          {answeredCount}/{totalCount}
        </span>
      </div>

      <div className="flex items-center gap-2">
        {/* Submit button */}
        <AlertDialog>
          <AlertDialogTrigger asChild>
            <Button
              variant={canSubmit ? "default" : "outline"}
              size="sm"
              disabled={!canSubmit || isSubmitting}
            >
              {isSubmitting ? (
                <Loader2 className="h-4 w-4 mr-2 animate-spin" />
              ) : (
                <Send className="h-4 w-4 mr-2" />
              )}
              {isSubmitting ? tCommon("submitting") : tAssessment("actions.submit")}
            </Button>
          </AlertDialogTrigger>
          <AlertDialogContent>
            <AlertDialogHeader>
              <AlertDialogTitle className="flex items-center gap-2">
                {canSubmit ? (
                  <CheckCircle2 className="h-5 w-5 text-green-500" />
                ) : (
                  <AlertTriangle className="h-5 w-5 text-amber-500" />
                )}
                {tAssessment("confirmSubmit.title")}
              </AlertDialogTitle>
              <AlertDialogDescription>
                {tAssessment("confirmSubmit.description")}
              </AlertDialogDescription>
            </AlertDialogHeader>
            <div className="py-4">
              <div className="flex items-center justify-between mb-2">
                <span className="text-sm">{tAssessment("progress.percentComplete", { percent: progressPercent })}</span>
                <span className="text-sm font-medium">{answeredCount}/{totalCount}</span>
              </div>
              <Progress value={progressPercent} className="h-2" />
              {canSubmit && (
                <p className="text-sm text-green-600 mt-2 flex items-center gap-1">
                  <CheckCircle2 className="h-4 w-4" />
                  {tAssessment("validation.canSubmit")}
                </p>
              )}
            </div>
            <AlertDialogFooter>
              <AlertDialogCancel disabled={isSubmitting}>
                {tCommon("actions.cancel")}
              </AlertDialogCancel>
              <AlertDialogAction
                onClick={handleSubmit}
                disabled={!canSubmit || isSubmitting}
                className="bg-primary"
              >
                {isSubmitting ? (
                  <>
                    <Loader2 className="h-4 w-4 mr-2 animate-spin" />
                    {tCommon("submitting")}
                  </>
                ) : (
                  tCommon("actions.submit")
                )}
              </AlertDialogAction>
            </AlertDialogFooter>
          </AlertDialogContent>
        </AlertDialog>

        {/* Fullscreen toggle */}
        <TooltipProvider>
          <Tooltip>
            <TooltipTrigger asChild>
              <Button
                variant="ghost"
                size="icon"
                onClick={handleFullscreenToggle}
              >
                {isFullscreen ? (
                  <Minimize2 className="h-4 w-4" />
                ) : (
                  <Maximize2 className="h-4 w-4" />
                )}
              </Button>
            </TooltipTrigger>
            <TooltipContent>
              <p>{isFullscreen ? "Exit fullscreen" : "Fullscreen"}</p>
            </TooltipContent>
          </Tooltip>
        </TooltipProvider>

        {/* Help button */}
        <TooltipProvider>
          <Tooltip>
            <TooltipTrigger asChild>
              <Button variant="ghost" size="icon">
                <HelpCircle className="h-4 w-4" />
              </Button>
            </TooltipTrigger>
            <TooltipContent>
              <p>{t("header.help")}</p>
            </TooltipContent>
          </Tooltip>
        </TooltipProvider>

        {/* Settings button */}
        <TooltipProvider>
          <Tooltip>
            <TooltipTrigger asChild>
              <Button variant="ghost" size="icon">
                <Settings className="h-4 w-4" />
              </Button>
            </TooltipTrigger>
            <TooltipContent>
              <p>{t("header.settings")}</p>
            </TooltipContent>
          </Tooltip>
        </TooltipProvider>
      </div>
    </header>
  );
}

function WorkspaceContent() {
  const { isLoading, error } = useAssessmentWorkspace();
  const t = useTranslations("workspace");

  if (isLoading) {
    return (
      <div className="flex items-center justify-center h-full">
        <div className="text-center">
          <Loader2 className="h-8 w-8 animate-spin mx-auto text-primary mb-4" />
          <p className="text-muted-foreground">{t("loading")}</p>
        </div>
      </div>
    );
  }

  if (error) {
    return (
      <div className="flex items-center justify-center h-full">
        <div className="text-center">
          <h2 className="text-xl font-semibold text-destructive mb-2">
            {t("error.title")}
          </h2>
          <p className="text-muted-foreground mb-4">{t("error.description")}</p>
          <Button variant="outline" asChild>
            <Link href="/assessments">{t("error.backButton")}</Link>
          </Button>
        </div>
      </div>
    );
  }

  return (
    <div className="flex flex-1 overflow-hidden">
      {/* Left Sidebar - Question Navigation */}
      <QuestionNavigationSidebar />

      {/* Main Content - Question Response */}
      <motion.main
        initial={{ opacity: 0 }}
        animate={{ opacity: 1 }}
        className="flex-1 overflow-hidden"
      >
        <QuestionResponsePanel />
      </motion.main>
    </div>
  );
}

export default function AssessmentTakePage({ params }: PageProps) {
  const { id } = use(params);

  return (
    <AssessmentWorkspaceProvider assessmentId={id}>
      <div className="flex flex-col h-screen bg-background">
        <WorkspaceHeader />
        <WorkspaceContent />
      </div>
    </AssessmentWorkspaceProvider>
  );
}

```

# src/app/[locale]/(dashboard)/assessments/new/page.tsx

```tsx
import { getTranslations } from "next-intl/server";
import { AssessmentWizard } from "@/components/features/assessment/assessment-wizard";

interface PageProps {
  params: Promise<{ locale: string }>;
}

export async function generateMetadata({ params }: PageProps) {
  const { locale } = await params;
  const t = await getTranslations({ locale, namespace: "wizard" });
  return {
    title: t("pageTitle"),
    description: t("pageDescription"),
  };
}

export default async function NewAssessmentPage({ params }: PageProps) {
  const { locale } = await params;
  const t = await getTranslations({ locale, namespace: "wizard" });

  return (
    <div className="container max-w-4xl mx-auto py-8">
      {/* Page Header */}
      <div className="mb-8 text-center">
        <h1 className="text-3xl font-bold tracking-tight">{t("pageTitle")}</h1>
        <p className="mt-2 text-muted-foreground">{t("pageDescription")}</p>
      </div>

      {/* Wizard Component */}
      <AssessmentWizard />
    </div>
  );
}

```

# src/app/[locale]/(dashboard)/assessments/page.tsx

```tsx
"use client";

import { useTranslations, useLocale } from "next-intl";
import { Link } from "@/lib/i18n/routing";
import { Button } from "@/components/ui/button";
import { Card, CardContent, CardDescription, CardHeader } from "@/components/ui/card";
import { Plus, ClipboardList, Clock, CheckCircle2, FileText, Loader2, PlayCircle } from "lucide-react";
import { trpc } from "@/lib/trpc/client";
import { Progress } from "@/components/ui/progress";
import { Badge } from "@/components/ui/badge";
import { formatDistanceToNow } from "date-fns";
import { fr, enUS } from "date-fns/locale";
import type { AssessmentStatus } from "@prisma/client";

export default function AssessmentsPage() {
  const t = useTranslations("assessment");
  const locale = useLocale();
  const dateLocale = locale === "fr" ? fr : enUS;

  const { data, isLoading, error } = trpc.assessment.list.useQuery({});
  
  const assessments = data?.assessments ?? [];

  // Calculate stats
  const stats = {
    total: assessments.length,
    inProgress: assessments.filter(a => a.status === "DRAFT").length,
    completed: assessments.filter(a => a.status === "COMPLETED").length,
    submitted: assessments.filter(a => a.status === "SUBMITTED" || a.status === "UNDER_REVIEW").length,
  };

  const getStatusBadge = (status: AssessmentStatus) => {
    const variants: Record<string, { variant: "default" | "secondary" | "destructive" | "outline"; label: string }> = {
      DRAFT: { variant: "secondary", label: t("status.draft") },
      SUBMITTED: { variant: "outline", label: t("status.submitted") },
      UNDER_REVIEW: { variant: "outline", label: t("status.underReview") },
      COMPLETED: { variant: "default", label: t("status.completed") },
      ARCHIVED: { variant: "secondary", label: t("status.archived") },
    };
    const config = variants[status] ?? { variant: "secondary" as const, label: status };
    return <Badge variant={config.variant}>{config.label}</Badge>;
  };

  return (
    <div className="container py-6 space-y-6">
      {/* Header */}
      <div className="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
        <div>
          <h1 className="text-3xl font-bold">{t("list.title")}</h1>
          <p className="text-muted-foreground">{t("list.description")}</p>
        </div>
        <Button asChild>
          <Link href="/assessments/new">
            <Plus className="h-4 w-4 mr-2" />
            {t("list.newAssessment")}
          </Link>
        </Button>
      </div>

      {/* Stats Cards */}
      <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
        <Card>
          <CardHeader className="pb-2">
            <CardDescription>{t("stats.total")}</CardDescription>
          </CardHeader>
          <CardContent>
            <div className="flex items-center gap-2">
              <ClipboardList className="h-5 w-5 text-muted-foreground" />
              <span className="text-2xl font-bold">{stats.total}</span>
            </div>
          </CardContent>
        </Card>
        <Card>
          <CardHeader className="pb-2">
            <CardDescription>{t("stats.inProgress")}</CardDescription>
          </CardHeader>
          <CardContent>
            <div className="flex items-center gap-2">
              <Clock className="h-5 w-5 text-blue-500" />
              <span className="text-2xl font-bold">{stats.inProgress}</span>
            </div>
          </CardContent>
        </Card>
        <Card>
          <CardHeader className="pb-2">
            <CardDescription>{t("stats.completed")}</CardDescription>
          </CardHeader>
          <CardContent>
            <div className="flex items-center gap-2">
              <CheckCircle2 className="h-5 w-5 text-green-500" />
              <span className="text-2xl font-bold">{stats.completed}</span>
            </div>
          </CardContent>
        </Card>
        <Card>
          <CardHeader className="pb-2">
            <CardDescription>{t("stats.submitted")}</CardDescription>
          </CardHeader>
          <CardContent>
            <div className="flex items-center gap-2">
              <FileText className="h-5 w-5 text-purple-500" />
              <span className="text-2xl font-bold">{stats.submitted}</span>
            </div>
          </CardContent>
        </Card>
      </div>

      {/* Loading State */}
      {isLoading && (
        <Card className="py-12">
          <CardContent className="flex flex-col items-center justify-center">
            <Loader2 className="h-8 w-8 animate-spin text-muted-foreground" />
            <p className="mt-4 text-muted-foreground">{t("list.loading")}</p>
          </CardContent>
        </Card>
      )}

      {/* Error State */}
      {error && (
        <Card className="py-12 border-destructive">
          <CardContent className="flex flex-col items-center justify-center text-center">
            <p className="text-destructive">{error.message}</p>
          </CardContent>
        </Card>
      )}

      {/* Assessment List */}
      {!isLoading && !error && assessments.length > 0 && (
        <div className="space-y-4">
          {assessments.map((assessment) => (
            <Card key={assessment.id} className="hover:shadow-md transition-shadow">
              <CardContent className="p-6">
                <div className="flex flex-col md:flex-row md:items-center justify-between gap-4">
                  <div className="space-y-2 flex-1">
                    <div className="flex items-center gap-2">
                      <h3 className="font-semibold text-lg">{assessment.title}</h3>
                      {getStatusBadge(assessment.status)}
                    </div>
                    <p className="text-sm text-muted-foreground">
                      {locale === "fr" 
                        ? assessment.questionnaire.titleFr 
                        : assessment.questionnaire.titleEn}
                    </p>
                    <div className="flex items-center gap-4 text-sm text-muted-foreground">
                      <span>
                        {t("list.updated")} {formatDistanceToNow(new Date(assessment.updatedAt), { 
                          addSuffix: true, 
                          locale: dateLocale 
                        })}
                      </span>
                      {assessment.dueDate && (
                        <span>
                          {t("list.due")}: {new Date(assessment.dueDate).toLocaleDateString(locale)}
                        </span>
                      )}
                    </div>
                  </div>
                  
                  <div className="flex flex-col items-end gap-2 min-w-[200px]">
                    <div className="w-full">
                      <div className="flex justify-between text-sm mb-1">
                        <span>{t("list.progress")}</span>
                        <span>{assessment.progress}%</span>
                      </div>
                      <Progress value={assessment.progress} className="h-2" />
                    </div>
                    <div className="flex gap-2">
                      <Button variant="outline" size="sm" asChild>
                        <Link href={`/assessments/${assessment.id}`}>
                          {t("list.view")}
                        </Link>
                      </Button>
                      {assessment.status === "DRAFT" && (
                        <Button size="sm" asChild>
                          <Link href={`/assessments/${assessment.id}`}>
                            <PlayCircle className="h-4 w-4 mr-1" />
                            {t("list.continue")}
                          </Link>
                        </Button>
                      )}
                    </div>
                  </div>
                </div>
              </CardContent>
            </Card>
          ))}
        </div>
      )}

      {/* Empty State */}
      {!isLoading && !error && assessments.length === 0 && (
        <Card className="py-12">
          <CardContent className="flex flex-col items-center justify-center text-center">
            <div className="rounded-full bg-muted p-6 mb-4">
              <ClipboardList className="h-12 w-12 text-muted-foreground" />
            </div>
            <h3 className="text-lg font-medium">{t("list.empty.title")}</h3>
            <p className="text-muted-foreground max-w-sm mt-2">
              {t("list.empty.description")}
            </p>
            <Button className="mt-6" asChild>
              <Link href="/assessments/new">
                <Plus className="h-4 w-4 mr-2" />
                {t("list.empty.create")}
              </Link>
            </Button>
          </CardContent>
        </Card>
      )}
    </div>
  );
}

```

# src/app/[locale]/(dashboard)/dashboard/dashboard-content.tsx

```tsx
"use client";

import { useTranslations } from "next-intl";
import Link from "next/link";
import { useRouter } from "next/navigation";
import {
  ClipboardList,
  FileCheck,
  FileText,
  AlertTriangle,
  Plus,
  BookOpen,
  GraduationCap,
  ArrowRight,
} from "lucide-react";
import {
  Card,
  CardContent,
  CardDescription,
  CardHeader,
  CardTitle,
} from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Skeleton } from "@/components/ui/skeleton";
import { StatsCard, StatsGrid } from "@/components/features/dashboard/StatsCard";
import { AssessmentStatusWidget } from "@/components/features/dashboard/AssessmentStatusWidget";
import { RecentActivityWidget } from "@/components/features/dashboard/RecentActivityWidget";
import { AttentionRequiredWidget } from "@/components/features/dashboard/AttentionRequiredWidget";
import { trpc } from "@/lib/trpc/client";

// =============================================================================
// TYPES
// =============================================================================

interface DashboardContentProps {
  userName: string;
  organizationId?: string;
}

// =============================================================================
// LOADING SKELETON
// =============================================================================

function DashboardSkeleton() {
  return (
    <div className="space-y-6">
      <div>
        <Skeleton className="h-8 w-64 mb-2" />
        <Skeleton className="h-4 w-96" />
      </div>
      <div className="grid gap-4 md:grid-cols-2 lg:grid-cols-4">
        {[1, 2, 3, 4].map((i) => (
          <Skeleton key={i} className="h-32" />
        ))}
      </div>
      <div className="grid gap-6 md:grid-cols-2">
        <Skeleton className="h-80" />
        <Skeleton className="h-80" />
      </div>
    </div>
  );
}

// =============================================================================
// COMPONENT
// =============================================================================

export function DashboardContent({
  userName,
  organizationId,
}: DashboardContentProps) {
  const t = useTranslations("dashboard");
  const router = useRouter();

  // Fetch dashboard stats
  const { data: stats, isLoading: statsLoading } =
    trpc.progress.getDashboardStats.useQuery({
      organizationId,
    });

  // Fetch assessments needing attention
  const { data: attentionItems } =
    trpc.progress.getAssessmentsNeedingAttention.useQuery({
      organizationId,
      limit: 5,
    });

  // Handle navigation
  const handleViewAllAssessments = () => {
    router.push("/assessments");
  };

  const handleViewAllActivity = () => {
    router.push("/assessments");
  };

  const handleAssessmentClick = (id: string) => {
    router.push(`/assessments/${id}`);
  };

  // Loading state
  if (statsLoading) {
    return <DashboardSkeleton />;
  }

  // Default stats if none loaded
  const assessmentStats = stats?.assessments ?? {
    total: 0,
    inProgress: 0,
    completed: 0,
    overdue: 0,
  };

  const byStatus = {
    DRAFT: assessmentStats.inProgress,
    SUBMITTED: 0,
    UNDER_REVIEW: 0,
    COMPLETED: assessmentStats.completed,
    ARCHIVED: 0,
  };

  return (
    <div className="space-y-6">
      {/* Header */}
      <div className="flex items-center justify-between">
        <div>
          <h1 className="text-2xl font-bold tracking-tight">
            {t("welcome", { name: userName })}
          </h1>
          <p className="text-muted-foreground">{t("subtitle")}</p>
        </div>
        <Button asChild>
          <Link href="/assessments/new">
            <Plus className="h-4 w-4 mr-2" />
            {t("newAssessment")}
          </Link>
        </Button>
      </div>

      {/* Stats Grid */}
      <StatsGrid columns={4}>
        <StatsCard
          title={t("stats.totalAssessments")}
          value={assessmentStats.total}
          subtitle={`${assessmentStats.inProgress} ${t("stats.inProgress")}`}
          icon={ClipboardList}
          iconColor="text-blue-600"
        />
        <StatsCard
          title={t("stats.completed")}
          value={assessmentStats.completed}
          icon={FileCheck}
          iconColor="text-green-600"
        />
        <StatsCard
          title={t("stats.documents")}
          value={stats?.documents?.total ?? 0}
          subtitle={`${stats?.documents?.thisWeek ?? 0} ${t("stats.thisWeek")}`}
          icon={FileText}
          iconColor="text-purple-600"
        />
        <StatsCard
          title={t("stats.overdue")}
          value={assessmentStats.overdue}
          icon={AlertTriangle}
          iconColor={
            assessmentStats.overdue > 0 ? "text-red-600" : "text-muted-foreground"
          }
        />
      </StatsGrid>

      {/* Main Content Grid */}
      <div className="grid gap-6 md:grid-cols-2">
        {/* Left Column */}
        <div className="space-y-6">
          {/* Assessment Status */}
          <AssessmentStatusWidget
            byStatus={byStatus}
            overdueCount={assessmentStats.overdue}
            onViewAll={handleViewAllAssessments}
          />

          {/* Attention Required */}
          <AttentionRequiredWidget
            assessments={attentionItems ?? []}
            onViewAll={handleViewAllAssessments}
            onAssessmentClick={handleAssessmentClick}
          />
        </div>

        {/* Right Column */}
        <div className="space-y-6">
          {/* Recent Activity */}
          <RecentActivityWidget
            activities={stats?.activity ?? []}
            onViewAll={handleViewAllActivity}
          />

          {/* Quick Actions */}
          <Card>
            <CardHeader>
              <CardTitle>{t("quickActions.title")}</CardTitle>
              <CardDescription>{t("quickActions.description")}</CardDescription>
            </CardHeader>
            <CardContent className="grid gap-3">
              <Link
                href="/assessments/new"
                className="flex items-center justify-between rounded-lg border p-4 hover:bg-muted/50 transition-colors"
              >
                <div className="flex items-center gap-3">
                  <div className="p-2 rounded-lg bg-blue-100">
                    <Plus className="h-4 w-4 text-blue-600" />
                  </div>
                  <div>
                    <h3 className="font-medium">{t("quickActions.newAssessment")}</h3>
                    <p className="text-sm text-muted-foreground">
                      {t("quickActions.newAssessmentDesc")}
                    </p>
                  </div>
                </div>
                <ArrowRight className="h-4 w-4 text-muted-foreground" />
              </Link>

              <Link
                href="/questionnaires"
                className="flex items-center justify-between rounded-lg border p-4 hover:bg-muted/50 transition-colors"
              >
                <div className="flex items-center gap-3">
                  <div className="p-2 rounded-lg bg-purple-100">
                    <BookOpen className="h-4 w-4 text-purple-600" />
                  </div>
                  <div>
                    <h3 className="font-medium">{t("quickActions.questionnaires")}</h3>
                    <p className="text-sm text-muted-foreground">
                      {t("quickActions.questionnairesDesc")}
                    </p>
                  </div>
                </div>
                <ArrowRight className="h-4 w-4 text-muted-foreground" />
              </Link>

              <Link
                href="/training"
                className="flex items-center justify-between rounded-lg border p-4 hover:bg-muted/50 transition-colors"
              >
                <div className="flex items-center gap-3">
                  <div className="p-2 rounded-lg bg-green-100">
                    <GraduationCap className="h-4 w-4 text-green-600" />
                  </div>
                  <div>
                    <h3 className="font-medium">{t("quickActions.training")}</h3>
                    <p className="text-sm text-muted-foreground">
                      {t("quickActions.trainingDesc")}
                    </p>
                  </div>
                </div>
                <ArrowRight className="h-4 w-4 text-muted-foreground" />
              </Link>
            </CardContent>
          </Card>
        </div>
      </div>
    </div>
  );
}

export default DashboardContent;

```

# src/app/[locale]/(dashboard)/dashboard/page.tsx

```tsx
import { getTranslations } from "next-intl/server";
import { auth } from "@/lib/auth";
import { DashboardContent } from "./dashboard-content";

export async function generateMetadata({ params }: { params: Promise<{ locale: string }> }) {
  const { locale } = await params;
  const t = await getTranslations({ locale, namespace: "dashboard" });
  return { title: t("title") };
}

export default async function DashboardPage() {
  const session = await auth();
  const firstName = session?.user?.firstName || "User";
  const organizationId = session?.user?.organizationId;

  return (
    <DashboardContent
      userName={firstName}
      organizationId={organizationId ?? undefined}
    />
  );
}

```

# src/app/[locale]/(dashboard)/layout.tsx

```tsx
import { redirect } from "next/navigation";
import { auth } from "@/lib/auth";
import { AppShell } from "@/components/layout/app-shell";
import { DashboardProviders } from "@/components/providers/dashboard-providers";

interface DashboardLayoutProps {
  children: React.ReactNode;
  params: Promise<{ locale: string }>;
}

export default async function DashboardLayout({
  children,
  params,
}: DashboardLayoutProps) {
  const { locale } = await params;
  const session = await auth();

  if (!session?.user) {
    redirect(`/${locale}/login`);
  }

  const user = {
    firstName: session.user.firstName,
    lastName: session.user.lastName,
    email: session.user.email || "",
    role: session.user.role,
  };

  return (
    <DashboardProviders>
      <AppShell locale={locale} user={user}>
        {children}
      </AppShell>
    </DashboardProviders>
  );
}

```

# src/app/[locale]/(dashboard)/questionnaires/ans/loading.tsx

```tsx
import { ANSBrowserSkeleton } from "@/components/features/questionnaire/ans/ans-browser-skeleton";

export default function ANSQuestionnaireLoading() {
  return <ANSBrowserSkeleton />;
}

```

# src/app/[locale]/(dashboard)/questionnaires/ans/page.tsx

```tsx
import { Suspense } from "react";
import { getTranslations } from "next-intl/server";
import { ANSBrowser } from "@/components/features/questionnaire/ans/ans-browser";
import { ANSBrowserSkeleton } from "@/components/features/questionnaire/ans/ans-browser-skeleton";

interface PageProps {
  params: Promise<{ locale: string }>;
  searchParams: Promise<{
    auditArea?: string;
    criticalElement?: string;
    isPriority?: string;
    requiresOnSite?: string;
    search?: string;
    page?: string;
  }>;
}

export async function generateMetadata({ params }: PageProps) {
  const { locale } = await params;
  const t = await getTranslations({ locale, namespace: "ansBrowser" });
  return {
    title: t("title"),
    description: t("subtitle"),
  };
}

export default async function ANSQuestionnairePage({
  params,
  searchParams,
}: PageProps) {
  const { locale } = await params;
  const filters = await searchParams;

  return (
    <Suspense fallback={<ANSBrowserSkeleton />}>
      <ANSBrowser locale={locale} initialFilters={filters} />
    </Suspense>
  );
}

```

# src/app/[locale]/(dashboard)/questionnaires/layout.tsx

```tsx
interface QuestionnairesLayoutProps {
  children: React.ReactNode;
}

export default function QuestionnairesLayout({
  children,
}: QuestionnairesLayoutProps) {
  return <>{children}</>;
}

```

# src/app/[locale]/(dashboard)/questionnaires/loading.tsx

```tsx
import { Skeleton } from "@/components/ui/skeleton";
import { Card, CardContent, CardFooter, CardHeader } from "@/components/ui/card";

function QuestionnaireCardSkeleton() {
  return (
    <Card className="relative overflow-hidden">
      {/* Top bar skeleton */}
      <div className="absolute top-0 left-0 right-0 h-1 bg-muted" />

      <CardHeader className="pb-3">
        <div className="flex items-start justify-between">
          <Skeleton className="h-12 w-12 rounded-lg" />
          <Skeleton className="h-5 w-12 rounded-full" />
        </div>

        <div className="space-y-2 pt-3">
          <Skeleton className="h-6 w-40" />
          <Skeleton className="h-4 w-56" />
        </div>

        <div className="space-y-2 pt-2">
          <Skeleton className="h-4 w-full" />
          <Skeleton className="h-4 w-3/4" />
        </div>

        <Skeleton className="h-3 w-32 mt-1" />
      </CardHeader>

      <CardContent className="pb-4">
        <div className="grid grid-cols-2 gap-3">
          {[1, 2, 3, 4].map((i) => (
            <div key={i} className="rounded-lg bg-muted/50 p-3">
              <Skeleton className="h-8 w-16 mb-1" />
              <Skeleton className="h-3 w-20" />
            </div>
          ))}
        </div>
      </CardContent>

      <CardFooter className="pt-0">
        <Skeleton className="h-10 w-full rounded-md" />
      </CardFooter>
    </Card>
  );
}

export default function QuestionnairesLoading() {
  return (
    <div className="space-y-6">
      {/* Page Header Skeleton */}
      <div>
        <Skeleton className="h-8 w-48 mb-2" />
        <Skeleton className="h-4 w-96" />
      </div>

      {/* Type Selection Skeleton */}
      <div className="space-y-4">
        <Skeleton className="h-6 w-56" />

        <div className="grid gap-6 md:grid-cols-2">
          <QuestionnaireCardSkeleton />
          <QuestionnaireCardSkeleton />
        </div>
      </div>

      {/* Quick Info Section Skeleton */}
      <div className="rounded-lg border bg-muted/30 p-6">
        <Skeleton className="h-5 w-40 mb-3" />
        <div className="grid gap-4 md:grid-cols-2">
          <div className="space-y-2">
            <Skeleton className="h-4 w-32" />
            <Skeleton className="h-4 w-full" />
            <Skeleton className="h-4 w-3/4" />
          </div>
          <div className="space-y-2">
            <Skeleton className="h-4 w-32" />
            <Skeleton className="h-4 w-full" />
            <Skeleton className="h-4 w-3/4" />
          </div>
        </div>
      </div>
    </div>
  );
}

```

# src/app/[locale]/(dashboard)/questionnaires/page.tsx

```tsx
import { getTranslations } from "next-intl/server";
import { BookOpen, Layers, Target, Award, BarChart3 } from "lucide-react";
import { QuestionnaireTypeCard } from "@/components/features/questionnaire/questionnaire-type-card";
import {
  TOTAL_USOAP_PQ_COUNT,
  QUESTIONNAIRE_METADATA,
} from "@/lib/questionnaire/constants";

interface PageProps {
  params: Promise<{ locale: string }>;
}

export async function generateMetadata({ params }: PageProps) {
  const { locale } = await params;
  const t = await getTranslations({ locale, namespace: "questionnaire" });
  return {
    title: t("title"),
    description: t("subtitle"),
  };
}

export default async function QuestionnairesPage({ params }: PageProps) {
  const { locale } = await params;
  const t = await getTranslations({ locale, namespace: "questionnaire" });

  return (
    <div className="space-y-6">
      {/* Page Header */}
      <div>
        <h1 className="text-2xl font-bold tracking-tight">{t("title")}</h1>
        <p className="text-muted-foreground">{t("subtitle")}</p>
      </div>

      {/* Type Selection */}
      <div className="space-y-4">
        <h2 className="text-lg font-semibold">{t("selectType")}</h2>

        <div className="grid gap-6 md:grid-cols-2">
          {/* ANS USOAP CMA Card */}
          <QuestionnaireTypeCard
            type="ans"
            title={t("ans.title")}
            fullTitle={t("ans.fullTitle")}
            description={t("ans.description")}
            effectiveDate={t("ans.effectiveDate")}
            browseLabel={t("ans.browse")}
            href="/questionnaires/ans"
            locale={locale}
            isNew
            stats={[
              {
                label: t("stats.totalQuestions"),
                value: TOTAL_USOAP_PQ_COUNT,
                icon: <BookOpen className="h-4 w-4" />,
              },
              {
                label: t("ans.auditAreas"),
                value: QUESTIONNAIRE_METADATA.ANS_USOAP_CMA.auditAreas,
                icon: <Layers className="h-4 w-4" />,
              },
              {
                label: t("ans.criticalElements"),
                value: QUESTIONNAIRE_METADATA.ANS_USOAP_CMA.criticalElements,
                icon: <Target className="h-4 w-4" />,
              },
              {
                label: t("stats.priorityQuestions"),
                value: "128",
                icon: <BarChart3 className="h-4 w-4" />,
              },
            ]}
          />

          {/* SMS CANSO SoE Card */}
          <QuestionnaireTypeCard
            type="sms"
            title={t("sms.title")}
            fullTitle={t("sms.fullTitle")}
            description={t("sms.description")}
            browseLabel={t("sms.browse")}
            href="/questionnaires/sms"
            locale={locale}
            isNew
            stats={[
              {
                label: t("sms.components"),
                value: QUESTIONNAIRE_METADATA.SMS_CANSO_SOE.components,
                icon: <Layers className="h-4 w-4" />,
              },
              {
                label: t("sms.studyAreas"),
                value: QUESTIONNAIRE_METADATA.SMS_CANSO_SOE.studyAreas,
                icon: <Target className="h-4 w-4" />,
              },
              {
                label: t("sms.maturityLevels"),
                value: QUESTIONNAIRE_METADATA.SMS_CANSO_SOE.maturityLevels,
                icon: <Award className="h-4 w-4" />,
              },
              {
                label: t("stats.totalQuestions"),
                value: QUESTIONNAIRE_METADATA.SMS_CANSO_SOE.totalQuestions,
                icon: <BookOpen className="h-4 w-4" />,
              },
            ]}
          />
        </div>
      </div>

      {/* Quick Info Section */}
      <div className="rounded-lg border bg-muted/30 p-6">
        <h3 className="font-semibold mb-3">{t("info.title")}</h3>
        <div className="grid gap-4 md:grid-cols-2">
          <div>
            <h4 className="text-sm font-medium text-blue-600 dark:text-blue-400 mb-2">
              {t("ans.title")}
            </h4>
            <p className="text-sm text-muted-foreground">
              {t("info.ansDescription")}
            </p>
          </div>
          <div>
            <h4 className="text-sm font-medium text-emerald-600 dark:text-emerald-400 mb-2">
              {t("sms.title")}
            </h4>
            <p className="text-sm text-muted-foreground">
              {t("info.smsDescription")}
            </p>
          </div>
        </div>
      </div>
    </div>
  );
}

```

# src/app/[locale]/(dashboard)/questionnaires/question/[id]/page.tsx

```tsx
import { Suspense } from "react";
import { notFound } from "next/navigation";
import Link from "next/link";
import { getTranslations } from "next-intl/server";
import { prisma } from "@/lib/db";
import { QuestionDetailView } from "./question-detail-view";
import { QuestionDetailSkeleton } from "./question-detail-skeleton";
import { ChevronRight, Home } from "lucide-react";

interface QuestionPageProps {
  params: Promise<{
    locale: string;
    id: string;
  }>;
}

async function getQuestion(id: string) {
  const question = await prisma.question.findUnique({
    where: { id },
    include: {
      icaoReferences: true,
      questionnaire: {
        select: {
          id: true,
          type: true,
          code: true,
          titleEn: true,
          titleFr: true,
        },
      },
      category: {
        select: {
          id: true,
          code: true,
          nameEn: true,
          nameFr: true,
        },
      },
    },
  });

  return question;
}

// Get related questions (same audit area or study area)
async function getRelatedQuestions(
  questionId: string,
  auditArea: string | null,
  studyArea: string | null,
  limit: number = 5
) {
  if (!auditArea && !studyArea) return [];

  const whereClause: Record<string, unknown> = {
    id: { not: questionId },
  };

  if (auditArea) {
    whereClause.auditArea = auditArea;
  } else if (studyArea) {
    whereClause.studyArea = studyArea;
  }

  const related = await prisma.question.findMany({
    where: whereClause,
    select: {
      id: true,
      pqNumber: true,
      questionTextEn: true,
    },
    take: limit,
    orderBy: { sortOrder: "asc" },
  });

  return related;
}

export async function generateMetadata({ params }: QuestionPageProps) {
  const { locale, id } = await params;
  const t = await getTranslations({ locale, namespace: "questionDetail" });
  const question = await getQuestion(id);

  if (!question) {
    return { title: t("notFound") };
  }

  const title = question.pqNumber
    ? `${question.pqNumber} - ${t("title")}`
    : t("title");

  return {
    title,
    description:
      locale === "fr"
        ? question.questionTextFr?.slice(0, 160)
        : question.questionTextEn?.slice(0, 160),
  };
}

export default async function QuestionPage({ params }: QuestionPageProps) {
  const { locale, id } = await params;
  const t = await getTranslations({ locale, namespace: "questionDetail" });

  const question = await getQuestion(id);

  if (!question) {
    notFound();
  }

  const relatedQuestions = await getRelatedQuestions(
    id,
    question.auditArea,
    question.studyArea
  );

  const questionWithRelated = {
    ...question,
    relatedQuestions,
  };

  // Determine breadcrumb path based on questionnaire type
  const isANS = question.questionnaire?.type === "ANS_USOAP_CMA";
  const questionnairePath = isANS ? "ans" : "sms";
  const questionnaireName = isANS ? "ANS USOAP CMA" : "SMS CANSO SoE";

  return (
    <div className="container mx-auto py-6 px-4 max-w-4xl">
      {/* Breadcrumb */}
      <nav className="flex items-center gap-1 text-sm text-muted-foreground mb-6">
        <Link
          href={`/${locale}/questionnaires`}
          className="hover:text-foreground transition-colors"
        >
          <Home className="h-4 w-4" />
        </Link>
        <ChevronRight className="h-4 w-4" />
        <Link
          href={`/${locale}/questionnaires`}
          className="hover:text-foreground transition-colors"
        >
          {t("breadcrumb.questionnaires")}
        </Link>
        <ChevronRight className="h-4 w-4" />
        <Link
          href={`/${locale}/questionnaires/${questionnairePath}`}
          className="hover:text-foreground transition-colors"
        >
          {questionnaireName}
        </Link>
        <ChevronRight className="h-4 w-4" />
        <span className="text-foreground font-medium">
          {question.pqNumber || t("question")}
        </span>
      </nav>

      <Suspense fallback={<QuestionDetailSkeleton />}>
        <QuestionDetailView
          question={questionWithRelated}
          locale={locale}
        />
      </Suspense>
    </div>
  );
}

```

# src/app/[locale]/(dashboard)/questionnaires/question/[id]/question-detail-skeleton.tsx

```tsx
"use client";

import { Card, CardContent, CardHeader } from "@/components/ui/card";
import { Skeleton } from "@/components/ui/skeleton";

export function QuestionDetailSkeleton() {
  return (
    <div className="space-y-6">
      {/* Header Card */}
      <Card>
        <CardHeader className="pb-4">
          <div className="flex items-start justify-between gap-4">
            <div className="flex-1">
              <div className="flex items-center gap-2 mb-4">
                <Skeleton className="h-8 w-24" />
                <Skeleton className="h-6 w-20" />
                <Skeleton className="h-6 w-16" />
              </div>
            </div>
            <div className="flex items-center gap-2">
              <Skeleton className="h-8 w-20" />
              <Skeleton className="h-8 w-24" />
            </div>
          </div>
        </CardHeader>
        <CardContent className="pt-0">
          <div className="space-y-2">
            <Skeleton className="h-5 w-full" />
            <Skeleton className="h-5 w-full" />
            <Skeleton className="h-5 w-3/4" />
          </div>
        </CardContent>
      </Card>

      {/* Metadata Card */}
      <Card>
        <CardHeader className="pb-3">
          <Skeleton className="h-5 w-24" />
        </CardHeader>
        <CardContent className="pt-0">
          <div className="grid gap-4 sm:grid-cols-2">
            {/* Audit Area / SMS Component */}
            <div className="space-y-2">
              <Skeleton className="h-4 w-20" />
              <Skeleton className="h-6 w-32" />
              <Skeleton className="h-4 w-48" />
            </div>
            {/* Critical Element / Study Area */}
            <div className="space-y-2">
              <Skeleton className="h-4 w-24" />
              <Skeleton className="h-6 w-28" />
              <Skeleton className="h-4 w-52" />
            </div>
          </div>
        </CardContent>
      </Card>

      {/* Guidance Card */}
      <Card>
        <CardHeader className="pb-3">
          <div className="flex items-center gap-2">
            <Skeleton className="h-5 w-5 rounded" />
            <Skeleton className="h-5 w-48" />
          </div>
        </CardHeader>
        <CardContent className="pt-0">
          <div className="rounded-lg border bg-muted/30 p-4 space-y-2">
            <Skeleton className="h-4 w-full" />
            <Skeleton className="h-4 w-full" />
            <Skeleton className="h-4 w-full" />
            <Skeleton className="h-4 w-2/3" />
          </div>
        </CardContent>
      </Card>

      {/* ICAO References Card */}
      <Card>
        <CardHeader className="pb-3">
          <div className="flex items-center gap-2">
            <Skeleton className="h-5 w-5 rounded" />
            <Skeleton className="h-5 w-32" />
          </div>
        </CardHeader>
        <CardContent className="pt-0 space-y-3">
          {[1, 2, 3].map((i) => (
            <div key={i} className="flex items-start gap-3 p-3 rounded-lg border">
              <Skeleton className="h-8 w-8 rounded-md shrink-0" />
              <div className="flex-1 space-y-2">
                <Skeleton className="h-4 w-48" />
                <Skeleton className="h-3 w-32" />
              </div>
            </div>
          ))}
        </CardContent>
      </Card>

      {/* Back Button */}
      <div className="pt-4">
        <Skeleton className="h-9 w-32" />
      </div>
    </div>
  );
}

```

# src/app/[locale]/(dashboard)/questionnaires/question/[id]/question-detail-view.tsx

```tsx
"use client";

import { useTranslations } from "next-intl";
import Link from "next/link";
import { Button } from "@/components/ui/button";
import { Badge } from "@/components/ui/badge";
import { Card, CardContent, CardHeader } from "@/components/ui/card";
import {
  Star,
  MapPin,
  BookOpen,
  Link2,
  FileText,
  Layers,
  Target,
  Shield,
  ArrowLeft,
  Share2,
  Check,
} from "lucide-react";
import { useState, useCallback } from "react";
import {
  LanguageToggle,
  useContentLanguage,
} from "@/components/features/questionnaire/language-toggle";
import { AmendmentIndicators } from "@/components/features/questionnaire/amendment-badge";
import { ICAOReferenceList } from "@/components/features/questionnaire/icao-reference-list";
import {
  USOAP_AUDIT_AREAS,
  CRITICAL_ELEMENTS,
  SMS_COMPONENTS,
  CANSO_STUDY_AREAS,
} from "@/lib/questionnaire/constants";
import type {
  Question,
  ICAOReference,
  Questionnaire,
  QuestionnaireCategory,
  PQAmendmentStatus,
} from "@prisma/client";

interface QuestionWithRelations extends Question {
  icaoReferences: ICAOReference[];
  questionnaire: Pick<
    Questionnaire,
    "id" | "type" | "code" | "titleEn" | "titleFr"
  > | null;
  category: Pick<
    QuestionnaireCategory,
    "id" | "code" | "nameEn" | "nameFr"
  > | null;
  relatedQuestions?: {
    id: string;
    pqNumber: string | null;
    questionTextEn: string | null;
  }[];
}

interface QuestionDetailViewProps {
  question: QuestionWithRelations;
  locale: string;
}

export function QuestionDetailView({
  question,
  locale,
}: QuestionDetailViewProps) {
  const t = useTranslations("questionDetail");
  const { contentLanguage, setContentLanguage, getBilingualText } =
    useContentLanguage({ defaultLocale: locale });

  const [copied, setCopied] = useState(false);

  const handleCopyLink = useCallback(async () => {
    try {
      await navigator.clipboard.writeText(window.location.href);
      setCopied(true);
      setTimeout(() => setCopied(false), 2000);
    } catch (err) {
      console.error("Failed to copy:", err);
    }
  }, []);

  const isANS = question.questionnaire?.type === "ANS_USOAP_CMA";
  const isSMS = question.questionnaire?.type === "SMS_CANSO_SOE";
  const questionnairePath = isANS ? "ans" : "sms";

  // Get metadata labels
  const auditAreaMeta = question.auditArea
    ? USOAP_AUDIT_AREAS[question.auditArea]
    : null;
  const criticalElementMeta = question.criticalElement
    ? CRITICAL_ELEMENTS[question.criticalElement]
    : null;
  const smsComponentMeta = question.smsComponent
    ? SMS_COMPONENTS[question.smsComponent]
    : null;
  const studyAreaMeta = question.studyArea
    ? CANSO_STUDY_AREAS[question.studyArea]
    : null;

  return (
    <div className="space-y-6">
      {/* Header Card */}
      <Card>
        <CardHeader className="pb-4">
          <div className="flex items-start justify-between gap-4">
            <div className="flex-1">
              {/* Question Number and Badges */}
              <div className="flex flex-wrap items-center gap-2 mb-4">
                {question.pqNumber && (
                  <h1 className="font-mono text-2xl font-bold">
                    {question.pqNumber}
                  </h1>
                )}

                {/* Status Badges */}
                {question.isPriorityPQ && (
                  <Badge
                    variant="secondary"
                    className="bg-amber-100 text-amber-700 dark:bg-amber-900/50 dark:text-amber-400 gap-1"
                  >
                    <Star className="h-3.5 w-3.5" />
                    {t("priority")}
                  </Badge>
                )}
                {question.requiresOnSite && (
                  <Badge
                    variant="secondary"
                    className="bg-blue-100 text-blue-700 dark:bg-blue-900/50 dark:text-blue-400 gap-1"
                  >
                    <MapPin className="h-3.5 w-3.5" />
                    {t("onSite")}
                  </Badge>
                )}
                <AmendmentIndicators
                  status={question.pqStatus as PQAmendmentStatus}
                  previousPQNumber={question.previousPqNumber}
                />
              </div>
            </div>

            {/* Actions */}
            <div className="flex items-center gap-2 shrink-0">
              <LanguageToggle
                currentLanguage={contentLanguage}
                onChange={setContentLanguage}
              />
              <Button
                variant="outline"
                size="sm"
                onClick={handleCopyLink}
                className="gap-1.5"
              >
                {copied ? (
                  <>
                    <Check className="h-4 w-4" />
                    {t("copied")}
                  </>
                ) : (
                  <>
                    <Share2 className="h-4 w-4" />
                    {t("share")}
                  </>
                )}
              </Button>
            </div>
          </div>
        </CardHeader>

        <CardContent className="pt-0">
          {/* Question Text */}
          <p className="text-lg leading-relaxed">
            {getBilingualText(question.questionTextEn, question.questionTextFr)}
          </p>
        </CardContent>
      </Card>

      {/* Metadata Card */}
      <Card>
        <CardHeader className="pb-3">
          <h2 className="font-semibold">{t("metadata")}</h2>
        </CardHeader>
        <CardContent className="pt-0">
          <div className="grid gap-4 sm:grid-cols-2">
            {/* ANS Metadata */}
            {isANS && (
              <>
                {auditAreaMeta && (
                  <div className="space-y-1.5">
                    <div className="flex items-center gap-1.5 text-sm text-muted-foreground">
                      <FileText className="h-4 w-4" />
                      {t("auditArea")}
                    </div>
                    <div className="flex items-center gap-2">
                      <Badge variant="outline" className="text-sm font-mono">
                        {question.auditArea}
                      </Badge>
                      <span className="text-sm">
                        {auditAreaMeta.name[contentLanguage]}
                      </span>
                    </div>
                    <p className="text-xs text-muted-foreground">
                      {auditAreaMeta.description[contentLanguage]}
                    </p>
                  </div>
                )}

                {criticalElementMeta && (
                  <div className="space-y-1.5">
                    <div className="flex items-center gap-1.5 text-sm text-muted-foreground">
                      <Target className="h-4 w-4" />
                      {t("criticalElement")}
                    </div>
                    <div className="flex items-center gap-2">
                      <Badge variant="outline" className="text-sm font-mono">
                        CE-{criticalElementMeta.number}
                      </Badge>
                      <span className="text-sm">
                        {criticalElementMeta.name[contentLanguage]}
                      </span>
                    </div>
                    <p className="text-xs text-muted-foreground">
                      {criticalElementMeta.description[contentLanguage]}
                    </p>
                  </div>
                )}
              </>
            )}

            {/* SMS Metadata */}
            {isSMS && (
              <>
                {smsComponentMeta && (
                  <div className="space-y-1.5">
                    <div className="flex items-center gap-1.5 text-sm text-muted-foreground">
                      <Shield className="h-4 w-4" />
                      {t("smsComponent")}
                    </div>
                    <div className="flex items-center gap-2">
                      <Badge
                        variant="outline"
                        className="text-sm bg-emerald-50 dark:bg-emerald-900/20"
                      >
                        {Math.round(smsComponentMeta.weight * 100)}%{" "}
                        {t("weight")}
                      </Badge>
                      <span className="text-sm">
                        {smsComponentMeta.name[contentLanguage]}
                      </span>
                    </div>
                    <p className="text-xs text-muted-foreground">
                      {smsComponentMeta.description[contentLanguage]}
                    </p>
                  </div>
                )}

                {studyAreaMeta && (
                  <div className="space-y-1.5">
                    <div className="flex items-center gap-1.5 text-sm text-muted-foreground">
                      <Layers className="h-4 w-4" />
                      {t("studyArea")}
                    </div>
                    <div className="flex items-center gap-2">
                      <Badge variant="outline" className="text-sm font-mono">
                        SA {studyAreaMeta.componentNumber}.
                        {studyAreaMeta.areaNumber}
                      </Badge>
                      <span className="text-sm">
                        {studyAreaMeta.name[contentLanguage]}
                      </span>
                    </div>
                    <p className="text-xs text-muted-foreground">
                      {studyAreaMeta.description[contentLanguage]}
                    </p>
                  </div>
                )}
              </>
            )}

            {/* Category */}
            {question.category && (
              <div className="space-y-1.5">
                <div className="flex items-center gap-1.5 text-sm text-muted-foreground">
                  <Layers className="h-4 w-4" />
                  {t("category")}
                </div>
                <Badge variant="secondary" className="text-sm">
                  {question.category.code}
                </Badge>
                <p className="text-xs text-muted-foreground">
                  {getBilingualText(
                    question.category.nameEn,
                    question.category.nameFr
                  )}
                </p>
              </div>
            )}
          </div>
        </CardContent>
      </Card>

      {/* Guidance Card */}
      {(question.guidanceEn || question.guidanceFr) && (
        <Card>
          <CardHeader className="pb-3">
            <div className="flex items-center gap-2">
              <BookOpen className="h-5 w-5 text-muted-foreground" />
              <h2 className="font-semibold">{t("guidance")}</h2>
            </div>
          </CardHeader>
          <CardContent className="pt-0">
            <div className="rounded-lg border bg-muted/30 p-4">
              <p className="text-sm whitespace-pre-wrap leading-relaxed">
                {getBilingualText(question.guidanceEn, question.guidanceFr)}
              </p>
            </div>
          </CardContent>
        </Card>
      )}

      {/* ICAO References Card */}
      {question.icaoReferences && question.icaoReferences.length > 0 && (
        <Card>
          <CardHeader className="pb-3">
            <div className="flex items-center gap-2">
              <FileText className="h-5 w-5 text-muted-foreground" />
              <h2 className="font-semibold">
                {t("icaoReferences")} ({question.icaoReferences.length})
              </h2>
            </div>
          </CardHeader>
          <CardContent className="pt-0">
            <ICAOReferenceList
              references={question.icaoReferences}
              contentLanguage={contentLanguage}
            />
          </CardContent>
        </Card>
      )}

      {/* Related Questions Card */}
      {question.relatedQuestions && question.relatedQuestions.length > 0 && (
        <Card>
          <CardHeader className="pb-3">
            <div className="flex items-center gap-2">
              <Link2 className="h-5 w-5 text-muted-foreground" />
              <h2 className="font-semibold">
                {t("relatedQuestions")} ({question.relatedQuestions.length})
              </h2>
            </div>
          </CardHeader>
          <CardContent className="pt-0">
            <div className="grid gap-2 sm:grid-cols-2">
              {question.relatedQuestions.map((related) => (
                <Link
                  key={related.id}
                  href={`/${locale}/questionnaires/question/${related.id}`}
                  className="flex items-start gap-3 p-3 rounded-lg border bg-card hover:bg-muted/50 transition-colors"
                >
                  <Badge variant="outline" className="font-mono shrink-0">
                    {related.pqNumber}
                  </Badge>
                  <p className="text-sm text-muted-foreground line-clamp-2">
                    {related.questionTextEn}
                  </p>
                </Link>
              ))}
            </div>
          </CardContent>
        </Card>
      )}

      {/* Back Navigation */}
      <div className="flex justify-start pt-4">
        <Button variant="outline" asChild>
          <Link
            href={`/${locale}/questionnaires/${questionnairePath}`}
            className="gap-2"
          >
            <ArrowLeft className="h-4 w-4" />
            {t("backToList")}
          </Link>
        </Button>
      </div>
    </div>
  );
}

```

# src/app/[locale]/(dashboard)/questionnaires/sms/loading.tsx

```tsx
import { SMSBrowserSkeleton } from "@/components/features/questionnaire/sms/sms-browser-skeleton";

export default function SMSQuestionnaireLoading() {
  return <SMSBrowserSkeleton />;
}

```

# src/app/[locale]/(dashboard)/questionnaires/sms/page.tsx

```tsx
import { Suspense } from "react";
import { getTranslations } from "next-intl/server";
import { SMSBrowser } from "@/components/features/questionnaire/sms/sms-browser";
import { SMSBrowserSkeleton } from "@/components/features/questionnaire/sms/sms-browser-skeleton";

interface PageProps {
  params: Promise<{ locale: string }>;
  searchParams: Promise<{
    component?: string;
    studyArea?: string;
  }>;
}

export async function generateMetadata({ params }: PageProps) {
  const { locale } = await params;
  const t = await getTranslations({ locale, namespace: "smsBrowser" });
  return {
    title: t("title"),
    description: t("subtitle"),
  };
}

export default async function SMSQuestionnairePage({
  params,
  searchParams,
}: PageProps) {
  const { locale } = await params;
  const filters = await searchParams;

  return (
    <Suspense fallback={<SMSBrowserSkeleton />}>
      <SMSBrowser
        locale={locale}
        initialComponent={filters.component}
        initialStudyArea={filters.studyArea}
      />
    </Suspense>
  );
}

```

# src/app/[locale]/layout.tsx

```tsx
import { NextIntlClientProvider } from "next-intl";
import { getMessages } from "next-intl/server";
import { notFound } from "next/navigation";
import { routing } from "@/lib/i18n/routing";
import "../globals.css";

export default async function LocaleLayout({
  children,
  params,
}: {
  children: React.ReactNode;
  params: Promise<{ locale: string }>;
}) {
  const { locale } = await params;

  if (!routing.locales.includes(locale as "en" | "fr")) {
    notFound();
  }

  const messages = await getMessages();

  return (
    <html lang={locale} suppressHydrationWarning>
      <body className="antialiased" suppressHydrationWarning>
        <NextIntlClientProvider messages={messages}>
          {children}
        </NextIntlClientProvider>
      </body>
    </html>
  );
}

```

# src/app/[locale]/page.tsx

```tsx
import { useTranslations } from "next-intl";
import Link from "next/link";

export default function HomePage() {
  const t = useTranslations("common");

  return (
    <main className="flex min-h-screen flex-col items-center justify-center p-24">
      <h1 className="text-4xl font-bold mb-4">{t("appName")}</h1>
      <p className="text-xl text-muted-foreground mb-8">{t("appTagline")}</p>
      <div className="flex gap-4">
        <Link
          href="/en/login"
          className="px-6 py-3 bg-primary text-primary-foreground rounded-lg"
        >
          English
        </Link>
        <Link
          href="/fr/login"
          className="px-6 py-3 bg-secondary text-secondary-foreground rounded-lg"
        >
          Français
        </Link>
      </div>
    </main>
  );
}

```

# src/app/api/auth/[...nextauth]/route.ts

```ts
import { GET, POST } from "@/lib/auth";

export { GET, POST };

```

# src/app/api/auth/register/route.ts

```ts
import { NextResponse } from "next/server";
import bcrypt from "bcryptjs";
import { db } from "@/lib/db";
import { z } from "zod";

const registerSchema = z.object({
  email: z.string().email(),
  password: z.string().min(12),
  firstName: z.string().min(2),
  lastName: z.string().min(2),
  locale: z.enum(["EN", "FR"]).default("EN"),
});

export async function POST(req: Request) {
  try {
    const body = await req.json();
    const { email, password, firstName, lastName, locale } = registerSchema.parse(body);

    const existingUser = await db.user.findUnique({
      where: { email },
    });

    if (existingUser) {
      return NextResponse.json(
        { error: "User already exists" },
        { status: 400 }
      );
    }

    const passwordHash = await bcrypt.hash(password, 12);

    const user = await db.user.create({
      data: {
        email,
        passwordHash,
        firstName,
        lastName,
        locale,
        role: "STAFF",
      },
    });

    return NextResponse.json(
      { message: "User created successfully", userId: user.id },
      { status: 201 }
    );
  } catch (error) {
    if (error instanceof z.ZodError) {
      return NextResponse.json(
        { error: "Invalid input", details: error.issues },
        { status: 400 }
      );
    }
    console.error("Registration error:", error);
    return NextResponse.json(
      { error: "Internal server error" },
      { status: 500 }
    );
  }
}

```

# src/app/api/trpc/[trpc]/route.ts

```ts
import { fetchRequestHandler } from "@trpc/server/adapters/fetch";
import { appRouter } from "@/server/trpc/routers/_app";
import { createContext } from "@/server/trpc/context";

/**
 * Configure CORS and caching headers
 */
const handler = (req: Request) =>
  fetchRequestHandler({
    endpoint: "/api/trpc",
    req,
    router: appRouter,
    createContext,
    onError:
      process.env.NODE_ENV === "development"
        ? ({ path, error }) => {
            console.error(
              `[tRPC Error] ${path ?? "<no-path>"}: ${error.message}`
            );
          }
        : undefined,
  });

export { handler as GET, handler as POST };

```

# src/app/api/upload/[filename]/route.ts

```ts
/**
 * File Download API Route
 *
 * Serves uploaded files from the local uploads directory.
 * In production, this would be replaced with CDN or cloud storage URLs.
 */

import { NextRequest, NextResponse } from "next/server";
import { readFile } from "fs/promises";
import { existsSync } from "fs";
import path from "path";
import { auth } from "@/lib/auth";

// =============================================================================
// CONSTANTS
// =============================================================================

const UPLOAD_DIR = path.join(process.cwd(), "uploads");

const MIME_TYPES: Record<string, string> = {
  ".pdf": "application/pdf",
  ".jpg": "image/jpeg",
  ".jpeg": "image/jpeg",
  ".png": "image/png",
  ".gif": "image/gif",
  ".webp": "image/webp",
  ".doc": "application/msword",
  ".docx":
    "application/vnd.openxmlformats-officedocument.wordprocessingml.document",
  ".xls": "application/vnd.ms-excel",
  ".xlsx":
    "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
  ".ppt": "application/vnd.ms-powerpoint",
  ".pptx":
    "application/vnd.openxmlformats-officedocument.presentationml.presentation",
};

// =============================================================================
// GET HANDLER - File Download
// =============================================================================

export async function GET(
  request: NextRequest,
  { params }: { params: Promise<{ filename: string }> }
) {
  try {
    // Verify authentication
    const session = await auth();
    if (!session?.user) {
      return NextResponse.json({ error: "Unauthorized" }, { status: 401 });
    }

    const { filename } = await params;

    // Validate filename (prevent path traversal)
    if (
      !filename ||
      filename.includes("..") ||
      filename.includes("/") ||
      filename.includes("\\")
    ) {
      return NextResponse.json(
        { error: "Invalid filename" },
        { status: 400 }
      );
    }

    const filePath = path.join(UPLOAD_DIR, filename);

    // Check if file exists
    if (!existsSync(filePath)) {
      return NextResponse.json({ error: "File not found" }, { status: 404 });
    }

    // Read file
    const fileBuffer = await readFile(filePath);

    // Determine content type
    const ext = path.extname(filename).toLowerCase();
    const contentType = MIME_TYPES[ext] || "application/octet-stream";

    // Return file with appropriate headers
    return new NextResponse(fileBuffer, {
      status: 200,
      headers: {
        "Content-Type": contentType,
        "Content-Length": fileBuffer.length.toString(),
        "Cache-Control": "private, max-age=3600",
        // For downloads, uncomment the following:
        // "Content-Disposition": `attachment; filename="${filename}"`,
      },
    });
  } catch (error) {
    console.error("Download error:", error);
    return NextResponse.json(
      { error: "Failed to download file" },
      { status: 500 }
    );
  }
}

```

# src/app/api/upload/route.ts

```ts
/**
 * Document Upload API Route
 *
 * Handles multipart form data file uploads for evidence documents.
 * For MVP, stores files locally in the /uploads directory.
 * Prepared for future cloud storage integration (S3, Supabase Storage).
 */

import { NextRequest, NextResponse } from "next/server";
import { writeFile, mkdir } from "fs/promises";
import { existsSync } from "fs";
import path from "path";
import crypto from "crypto";
import { auth } from "@/lib/auth";

// =============================================================================
// CONSTANTS
// =============================================================================

const ALLOWED_MIME_TYPES = [
  // PDFs
  "application/pdf",
  // Images
  "image/jpeg",
  "image/png",
  "image/gif",
  "image/webp",
  // Word documents
  "application/msword",
  "application/vnd.openxmlformats-officedocument.wordprocessingml.document",
  // Excel
  "application/vnd.ms-excel",
  "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
  // PowerPoint (bonus)
  "application/vnd.ms-powerpoint",
  "application/vnd.openxmlformats-officedocument.presentationml.presentation",
];

const MAX_FILE_SIZE = 10 * 1024 * 1024; // 10MB

const UPLOAD_DIR = path.join(process.cwd(), "uploads");

// =============================================================================
// HELPERS
// =============================================================================

function getFileExtension(mimeType: string): string {
  const mimeToExt: Record<string, string> = {
    "application/pdf": ".pdf",
    "image/jpeg": ".jpg",
    "image/png": ".png",
    "image/gif": ".gif",
    "image/webp": ".webp",
    "application/msword": ".doc",
    "application/vnd.openxmlformats-officedocument.wordprocessingml.document":
      ".docx",
    "application/vnd.ms-excel": ".xls",
    "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":
      ".xlsx",
    "application/vnd.ms-powerpoint": ".ppt",
    "application/vnd.openxmlformats-officedocument.presentationml.presentation":
      ".pptx",
  };
  return mimeToExt[mimeType] || "";
}

function sanitizeFilename(filename: string): string {
  // Remove path components and special characters
  return filename
    .replace(/[^a-zA-Z0-9._-]/g, "_")
    .replace(/_{2,}/g, "_")
    .substring(0, 100);
}

async function ensureUploadDir(): Promise<void> {
  if (!existsSync(UPLOAD_DIR)) {
    await mkdir(UPLOAD_DIR, { recursive: true });
  }
}

// =============================================================================
// POST HANDLER - File Upload
// =============================================================================

export async function POST(request: NextRequest) {
  try {
    // Verify authentication
    const session = await auth();
    if (!session?.user) {
      return NextResponse.json({ error: "Unauthorized" }, { status: 401 });
    }

    // Parse multipart form data
    const formData = await request.formData();
    const file = formData.get("file") as File | null;

    if (!file) {
      return NextResponse.json(
        { error: "No file provided" },
        { status: 400 }
      );
    }

    // Validate file type
    if (!ALLOWED_MIME_TYPES.includes(file.type)) {
      return NextResponse.json(
        {
          error: "Invalid file type",
          allowedTypes: ALLOWED_MIME_TYPES,
        },
        { status: 400 }
      );
    }

    // Validate file size
    if (file.size > MAX_FILE_SIZE) {
      return NextResponse.json(
        {
          error: "File too large",
          maxSize: MAX_FILE_SIZE,
          maxSizeMB: MAX_FILE_SIZE / 1024 / 1024,
        },
        { status: 400 }
      );
    }

    // Generate unique filename
    const fileId = crypto.randomUUID();
    const extension = getFileExtension(file.type);
    const sanitizedOriginal = sanitizeFilename(file.name);
    const filename = `${fileId}${extension}`;

    // Ensure upload directory exists
    await ensureUploadDir();

    // Write file to disk
    const bytes = await file.arrayBuffer();
    const buffer = Buffer.from(bytes);
    const filePath = path.join(UPLOAD_DIR, filename);
    await writeFile(filePath, buffer);

    // Generate URL for the uploaded file
    // In production, this would be a CDN URL or signed URL
    const fileUrl = `/api/upload/${filename}`;

    return NextResponse.json({
      success: true,
      file: {
        id: fileId,
        filename,
        originalName: sanitizedOriginal,
        mimeType: file.type,
        size: file.size,
        url: fileUrl,
      },
    });
  } catch (error) {
    console.error("Upload error:", error);
    return NextResponse.json(
      { error: "Failed to upload file" },
      { status: 500 }
    );
  }
}

// =============================================================================
// GET HANDLER - File Download (Placeholder for serving files)
// =============================================================================

export async function GET() {
  return NextResponse.json(
    {
      message: "Use /api/upload/[filename] to download files",
      allowedTypes: ALLOWED_MIME_TYPES,
      maxFileSize: MAX_FILE_SIZE,
      maxFileSizeMB: MAX_FILE_SIZE / 1024 / 1024,
    },
    { status: 200 }
  );
}

```

# src/app/favicon.ico

This is a binary file of the type: Binary

# src/app/globals.css

```css
@import "tailwindcss";

@custom-variant dark (&:is(.dark *));

@plugin "tailwindcss-animate";

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-border: var(--border);
  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);
  --color-secondary: var(--secondary);
  --color-secondary-foreground: var(--secondary-foreground);
  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);

  /* Maturity level colors */
  --color-maturity-a: #EF4444;
  --color-maturity-b: #F97316;
  --color-maturity-c: #EAB308;
  --color-maturity-d: #22C55E;
  --color-maturity-e: #3B82F6;
  --color-sidebar-ring: var(--sidebar-ring);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar: var(--sidebar);
  --color-chart-5: var(--chart-5);
  --color-chart-4: var(--chart-4);
  --color-chart-3: var(--chart-3);
  --color-chart-2: var(--chart-2);
  --color-chart-1: var(--chart-1);
  --color-ring: var(--ring);
  --color-input: var(--input);
  --color-destructive: var(--destructive);
  --color-accent-foreground: var(--accent-foreground);
  --color-accent: var(--accent);
  --color-popover-foreground: var(--popover-foreground);
  --color-popover: var(--popover);
  --color-card-foreground: var(--card-foreground);
  --color-card: var(--card);
  --radius-sm: calc(var(--radius) - 4px);
  --radius-md: calc(var(--radius) - 2px);
  --radius-lg: var(--radius);
  --radius-xl: calc(var(--radius) + 4px);
  --radius-2xl: calc(var(--radius) + 8px);
  --radius-3xl: calc(var(--radius) + 12px);
  --radius-4xl: calc(var(--radius) + 16px);
}

:root {
  --primary: oklch(0.21 0.034 264.665);
  --primary-foreground: oklch(0.985 0.002 247.839);
  --secondary: oklch(0.967 0.003 264.542);
  --secondary-foreground: oklch(0.21 0.034 264.665);
  --muted: oklch(0.967 0.003 264.542);
  --muted-foreground: oklch(0.551 0.027 264.364);
  --border: oklch(0.928 0.006 264.531);
  --radius: 0.625rem;
  --background: oklch(1 0 0);
  --foreground: oklch(0.13 0.028 261.692);
  --card: oklch(1 0 0);
  --card-foreground: oklch(0.13 0.028 261.692);
  --popover: oklch(1 0 0);
  --popover-foreground: oklch(0.13 0.028 261.692);
  --accent: oklch(0.967 0.003 264.542);
  --accent-foreground: oklch(0.21 0.034 264.665);
  --destructive: oklch(0.577 0.245 27.325);
  --input: oklch(0.928 0.006 264.531);
  --ring: oklch(0.707 0.022 261.325);
  --chart-1: oklch(0.646 0.222 41.116);
  --chart-2: oklch(0.6 0.118 184.704);
  --chart-3: oklch(0.398 0.07 227.392);
  --chart-4: oklch(0.828 0.189 84.429);
  --chart-5: oklch(0.769 0.188 70.08);
  --sidebar: oklch(0.985 0.002 247.839);
  --sidebar-foreground: oklch(0.13 0.028 261.692);
  --sidebar-primary: oklch(0.21 0.034 264.665);
  --sidebar-primary-foreground: oklch(0.985 0.002 247.839);
  --sidebar-accent: oklch(0.967 0.003 264.542);
  --sidebar-accent-foreground: oklch(0.21 0.034 264.665);
  --sidebar-border: oklch(0.928 0.006 264.531);
  --sidebar-ring: oklch(0.707 0.022 261.325);
}

.dark {
  --background: oklch(0.13 0.028 261.692);
  --foreground: oklch(0.985 0.002 247.839);
  --primary: oklch(0.928 0.006 264.531);
  --primary-foreground: oklch(0.21 0.034 264.665);
  --secondary: oklch(0.278 0.033 256.848);
  --secondary-foreground: oklch(0.985 0.002 247.839);
  --muted: oklch(0.278 0.033 256.848);
  --muted-foreground: oklch(0.707 0.022 261.325);
  --border: oklch(1 0 0 / 10%);
  --card: oklch(0.21 0.034 264.665);
  --card-foreground: oklch(0.985 0.002 247.839);
  --popover: oklch(0.21 0.034 264.665);
  --popover-foreground: oklch(0.985 0.002 247.839);
  --accent: oklch(0.278 0.033 256.848);
  --accent-foreground: oklch(0.985 0.002 247.839);
  --destructive: oklch(0.704 0.191 22.216);
  --input: oklch(1 0 0 / 15%);
  --ring: oklch(0.551 0.027 264.364);
  --chart-1: oklch(0.488 0.243 264.376);
  --chart-2: oklch(0.696 0.17 162.48);
  --chart-3: oklch(0.769 0.188 70.08);
  --chart-4: oklch(0.627 0.265 303.9);
  --chart-5: oklch(0.645 0.246 16.439);
  --sidebar: oklch(0.21 0.034 264.665);
  --sidebar-foreground: oklch(0.985 0.002 247.839);
  --sidebar-primary: oklch(0.488 0.243 264.376);
  --sidebar-primary-foreground: oklch(0.985 0.002 247.839);
  --sidebar-accent: oklch(0.278 0.033 256.848);
  --sidebar-accent-foreground: oklch(0.985 0.002 247.839);
  --sidebar-border: oklch(1 0 0 / 10%);
  --sidebar-ring: oklch(0.551 0.027 264.364);
}

body {
  background: hsl(var(--background));
  color: hsl(var(--foreground));
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
}

/* Utility classes for design system */
.bg-primary {
  background-color: hsl(var(--primary));
}

.text-primary-foreground {
  color: hsl(var(--primary-foreground));
}

.bg-secondary {
  background-color: hsl(var(--secondary));
}

.text-secondary-foreground {
  color: hsl(var(--secondary-foreground));
}

.text-muted-foreground {
  color: hsl(var(--muted-foreground));
}

@layer base {
  * {
    @apply border-border outline-ring/50;
  }
  body {
    @apply bg-background text-foreground;
  }
}

```

# src/app/layout.tsx

```tsx
import type { Metadata } from "next";

export const metadata: Metadata = {
  title: "African ANSP Peer Review",
  description: "Collaborative Excellence in Aviation Safety",
};

export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return children;
}

```

# src/app/page.tsx

```tsx
import Image from "next/image";

export default function Home() {
  return (
    <div className="flex min-h-screen items-center justify-center bg-zinc-50 font-sans dark:bg-black">
      <main className="flex min-h-screen w-full max-w-3xl flex-col items-center justify-between py-32 px-16 bg-white dark:bg-black sm:items-start">
        <Image
          className="dark:invert"
          src="/next.svg"
          alt="Next.js logo"
          width={100}
          height={20}
          priority
        />
        <div className="flex flex-col items-center gap-6 text-center sm:items-start sm:text-left">
          <h1 className="max-w-xs text-3xl font-semibold leading-10 tracking-tight text-black dark:text-zinc-50">
            To get started, edit the page.tsx file.
          </h1>
          <p className="max-w-md text-lg leading-8 text-zinc-600 dark:text-zinc-400">
            Looking for a starting point or more instructions? Head over to{" "}
            <a
              href="https://vercel.com/templates?framework=next.js&utm_source=create-next-app&utm_medium=appdir-template-tw&utm_campaign=create-next-app"
              className="font-medium text-zinc-950 dark:text-zinc-50"
            >
              Templates
            </a>{" "}
            or the{" "}
            <a
              href="https://nextjs.org/learn?utm_source=create-next-app&utm_medium=appdir-template-tw&utm_campaign=create-next-app"
              className="font-medium text-zinc-950 dark:text-zinc-50"
            >
              Learning
            </a>{" "}
            center.
          </p>
        </div>
        <div className="flex flex-col gap-4 text-base font-medium sm:flex-row">
          <a
            className="flex h-12 w-full items-center justify-center gap-2 rounded-full bg-foreground px-5 text-background transition-colors hover:bg-[#383838] dark:hover:bg-[#ccc] md:w-[158px]"
            href="https://vercel.com/new?utm_source=create-next-app&utm_medium=appdir-template-tw&utm_campaign=create-next-app"
            target="_blank"
            rel="noopener noreferrer"
          >
            <Image
              className="dark:invert"
              src="/vercel.svg"
              alt="Vercel logomark"
              width={16}
              height={16}
            />
            Deploy Now
          </a>
          <a
            className="flex h-12 w-full items-center justify-center rounded-full border border-solid border-black/[.08] px-5 transition-colors hover:border-transparent hover:bg-black/[.04] dark:border-white/[.145] dark:hover:bg-[#1a1a1a] md:w-[158px]"
            href="https://nextjs.org/docs?utm_source=create-next-app&utm_medium=appdir-template-tw&utm_campaign=create-next-app"
            target="_blank"
            rel="noopener noreferrer"
          >
            Documentation
          </a>
        </div>
      </main>
    </div>
  );
}

```

# src/components/features/admin/import-preview-table.tsx

```tsx
"use client";

import { useState, useMemo } from "react";
import { useTranslations } from "next-intl";
import { cn } from "@/lib/utils";
import {
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableHeader,
  TableRow,
} from "@/components/ui/table";
import { Badge } from "@/components/ui/badge";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { ScrollArea, ScrollBar } from "@/components/ui/scroll-area";
import {
  Dialog,
  DialogContent,
  DialogHeader,
  DialogTitle,
} from "@/components/ui/dialog";
import {
  AlertCircle,
  CheckCircle2,
  ChevronLeft,
  ChevronRight,
  Edit2,
  Search,
  X,
} from "lucide-react";
import type { ValidationError } from "@/lib/questionnaire/import-schema";

// =============================================================================
// TYPES
// =============================================================================

interface QuestionPreview {
  pqNumber?: string | null;
  questionTextEn: string;
  questionTextFr: string;
  auditArea?: string | null;
  criticalElement?: string | null;
  smsComponent?: string | null;
  studyArea?: string | null;
  isPriorityPQ?: boolean;
  requiresOnSite?: boolean;
  pqStatus?: string;
  sortOrder: number;
  icaoReferences?: unknown[];
}

interface ImportPreviewTableProps {
  questions: QuestionPreview[];
  errors: ValidationError[];
  type: "ANS_USOAP_CMA" | "SMS_CANSO_SOE";
  onEdit?: (index: number, data: QuestionPreview) => void;
  onRemove?: (index: number) => void;
  className?: string;
}

// =============================================================================
// COMPONENT
// =============================================================================

export function ImportPreviewTable({
  questions,
  errors,
  type,
  onEdit,
  onRemove,
  className,
}: ImportPreviewTableProps) {
  const t = useTranslations("admin.import");

  // State
  const [page, setPage] = useState(0);
  const [searchQuery, setSearchQuery] = useState("");
  const [editingIndex, setEditingIndex] = useState<number | null>(null);
  const [editData, setEditData] = useState<QuestionPreview | null>(null);

  const pageSize = 20;

  // Create error map for quick lookup
  const errorMap = useMemo(() => {
    const map = new Map<number, ValidationError[]>();
    errors.forEach((error) => {
      const existing = map.get(error.row) || [];
      existing.push(error);
      map.set(error.row, existing);
    });
    return map;
  }, [errors]);

  // Filter and paginate questions
  const filteredQuestions = useMemo(() => {
    if (!searchQuery.trim()) return questions;

    const query = searchQuery.toLowerCase();
    return questions.filter((q, index) => {
      const pqNumber = q.pqNumber?.toLowerCase() || "";
      const textEn = q.questionTextEn.toLowerCase();
      const textFr = q.questionTextFr.toLowerCase();
      const rowNumber = String(index + 1);

      return (
        pqNumber.includes(query) ||
        textEn.includes(query) ||
        textFr.includes(query) ||
        rowNumber.includes(query)
      );
    });
  }, [questions, searchQuery]);

  const totalPages = Math.ceil(filteredQuestions.length / pageSize);
  const paginatedQuestions = filteredQuestions.slice(
    page * pageSize,
    (page + 1) * pageSize
  );

  // Get original index for a filtered question
  const getOriginalIndex = (filteredIndex: number): number => {
    const question = paginatedQuestions[filteredIndex];
    return questions.indexOf(question);
  };

  // Handle edit
  const handleEdit = (index: number) => {
    const originalIndex = getOriginalIndex(index);
    setEditingIndex(originalIndex);
    setEditData({ ...questions[originalIndex] });
  };

  const handleSaveEdit = () => {
    if (editingIndex !== null && editData && onEdit) {
      onEdit(editingIndex, editData);
    }
    setEditingIndex(null);
    setEditData(null);
  };

  const handleCancelEdit = () => {
    setEditingIndex(null);
    setEditData(null);
  };

  // Columns based on type
  const isANS = type === "ANS_USOAP_CMA";

  return (
    <div className={cn("space-y-4", className)}>
      {/* Header with search and pagination info */}
      <div className="flex items-center justify-between gap-4">
        <div className="relative flex-1 max-w-sm">
          <Search className="absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground" />
          <Input
            value={searchQuery}
            onChange={(e) => {
              setSearchQuery(e.target.value);
              setPage(0);
            }}
            placeholder={t("searchPlaceholder")}
            className="pl-9"
          />
        </div>

        <div className="flex items-center gap-2 text-sm text-muted-foreground">
          <span>
            {t("showing", {
              from: page * pageSize + 1,
              to: Math.min((page + 1) * pageSize, filteredQuestions.length),
              total: filteredQuestions.length,
            })}
          </span>
          {errors.length > 0 && (
            <Badge variant="destructive" className="gap-1">
              <AlertCircle className="h-3 w-3" />
              {errors.length} {t("errors")}
            </Badge>
          )}
        </div>
      </div>

      {/* Table */}
      <ScrollArea className="border rounded-lg">
        <Table>
          <TableHeader>
            <TableRow className="bg-muted/50">
              <TableHead className="w-12">#</TableHead>
              <TableHead className="w-8">{t("status")}</TableHead>
              {isANS ? (
                <>
                  <TableHead className="w-24">{t("pqNumber")}</TableHead>
                  <TableHead className="w-20">{t("auditArea")}</TableHead>
                  <TableHead className="w-20">{t("ce")}</TableHead>
                </>
              ) : (
                <>
                  <TableHead className="w-24">{t("component")}</TableHead>
                  <TableHead className="w-24">{t("studyArea")}</TableHead>
                </>
              )}
              <TableHead className="min-w-[300px]">{t("questionText")}</TableHead>
              <TableHead className="w-20">{t("refs")}</TableHead>
              {(onEdit || onRemove) && (
                <TableHead className="w-24">{t("actions")}</TableHead>
              )}
            </TableRow>
          </TableHeader>
          <TableBody>
            {paginatedQuestions.map((question, filteredIndex) => {
              const originalIndex = getOriginalIndex(filteredIndex);
              const rowErrors = errorMap.get(originalIndex) || [];
              const hasErrors = rowErrors.length > 0;

              return (
                <TableRow
                  key={originalIndex}
                  className={cn(
                    hasErrors && "bg-red-50 dark:bg-red-900/10"
                  )}
                >
                  <TableCell className="font-mono text-xs text-muted-foreground">
                    {originalIndex + 1}
                  </TableCell>
                  <TableCell>
                    {hasErrors ? (
                      <div
                        className="group relative"
                        title={rowErrors.map((e) => `${e.field}: ${e.message}`).join("\n")}
                      >
                        <AlertCircle className="h-4 w-4 text-destructive" />
                      </div>
                    ) : (
                      <CheckCircle2 className="h-4 w-4 text-emerald-500" />
                    )}
                  </TableCell>
                  {isANS ? (
                    <>
                      <TableCell>
                        <Badge variant="outline" className="font-mono">
                          {question.pqNumber || "-"}
                        </Badge>
                      </TableCell>
                      <TableCell>
                        <Badge variant="secondary" className="text-xs">
                          {question.auditArea || "-"}
                        </Badge>
                      </TableCell>
                      <TableCell>
                        <Badge variant="secondary" className="text-xs">
                          {question.criticalElement?.replace("CE_", "CE-") || "-"}
                        </Badge>
                      </TableCell>
                    </>
                  ) : (
                    <>
                      <TableCell>
                        <Badge variant="secondary" className="text-xs">
                          {question.smsComponent
                            ?.replace("SAFETY_", "")
                            .replace("_", " ")
                            .slice(0, 12) || "-"}
                        </Badge>
                      </TableCell>
                      <TableCell>
                        <Badge variant="secondary" className="text-xs">
                          {question.studyArea?.replace("SA_", "SA ").replace("_", ".") || "-"}
                        </Badge>
                      </TableCell>
                    </>
                  )}
                  <TableCell>
                    <p className="text-sm line-clamp-2">
                      {question.questionTextEn}
                    </p>
                    {hasErrors && (
                      <div className="mt-1 space-y-0.5">
                        {rowErrors.map((error, i) => (
                          <p
                            key={i}
                            className="text-xs text-destructive"
                          >
                            {error.field}: {error.message}
                          </p>
                        ))}
                      </div>
                    )}
                  </TableCell>
                  <TableCell>
                    <span className="text-sm text-muted-foreground">
                      {question.icaoReferences?.length || 0}
                    </span>
                  </TableCell>
                  {(onEdit || onRemove) && (
                    <TableCell>
                      <div className="flex items-center gap-1">
                        {onEdit && (
                          <Button
                            variant="ghost"
                            size="icon"
                            onClick={() => handleEdit(filteredIndex)}
                            className="h-7 w-7"
                          >
                            <Edit2 className="h-3.5 w-3.5" />
                          </Button>
                        )}
                        {onRemove && (
                          <Button
                            variant="ghost"
                            size="icon"
                            onClick={() => onRemove(originalIndex)}
                            className="h-7 w-7 text-destructive hover:text-destructive"
                          >
                            <X className="h-3.5 w-3.5" />
                          </Button>
                        )}
                      </div>
                    </TableCell>
                  )}
                </TableRow>
              );
            })}

            {paginatedQuestions.length === 0 && (
              <TableRow>
                <TableCell
                  colSpan={isANS ? 8 : 7}
                  className="h-24 text-center text-muted-foreground"
                >
                  {searchQuery ? t("noMatchingResults") : t("noData")}
                </TableCell>
              </TableRow>
            )}
          </TableBody>
        </Table>
        <ScrollBar orientation="horizontal" />
      </ScrollArea>

      {/* Pagination */}
      {totalPages > 1 && (
        <div className="flex items-center justify-center gap-2">
          <Button
            variant="outline"
            size="sm"
            onClick={() => setPage((p) => Math.max(0, p - 1))}
            disabled={page === 0}
          >
            <ChevronLeft className="h-4 w-4" />
          </Button>
          <span className="text-sm text-muted-foreground">
            {t("page", { current: page + 1, total: totalPages })}
          </span>
          <Button
            variant="outline"
            size="sm"
            onClick={() => setPage((p) => Math.min(totalPages - 1, p + 1))}
            disabled={page >= totalPages - 1}
          >
            <ChevronRight className="h-4 w-4" />
          </Button>
        </div>
      )}

      {/* Edit Dialog */}
      <Dialog open={editingIndex !== null} onOpenChange={(open) => !open && handleCancelEdit()}>
        <DialogContent className="max-w-2xl">
          <DialogHeader>
            <DialogTitle>{t("editQuestion")}</DialogTitle>
          </DialogHeader>

          {editData && (
            <div className="space-y-4">
              {isANS && (
                <div className="grid grid-cols-3 gap-4">
                  <div className="space-y-2">
                    <label className="text-sm font-medium">{t("pqNumber")}</label>
                    <Input
                      value={editData.pqNumber || ""}
                      onChange={(e) =>
                        setEditData({ ...editData, pqNumber: e.target.value })
                      }
                    />
                  </div>
                  <div className="space-y-2">
                    <label className="text-sm font-medium">{t("auditArea")}</label>
                    <Input
                      value={editData.auditArea || ""}
                      onChange={(e) =>
                        setEditData({ ...editData, auditArea: e.target.value })
                      }
                    />
                  </div>
                  <div className="space-y-2">
                    <label className="text-sm font-medium">{t("ce")}</label>
                    <Input
                      value={editData.criticalElement || ""}
                      onChange={(e) =>
                        setEditData({ ...editData, criticalElement: e.target.value })
                      }
                    />
                  </div>
                </div>
              )}

              <div className="space-y-2">
                <label className="text-sm font-medium">{t("questionTextEn")}</label>
                <textarea
                  value={editData.questionTextEn}
                  onChange={(e) =>
                    setEditData({ ...editData, questionTextEn: e.target.value })
                  }
                  className="w-full min-h-[100px] p-3 border rounded-md text-sm"
                />
              </div>

              <div className="space-y-2">
                <label className="text-sm font-medium">{t("questionTextFr")}</label>
                <textarea
                  value={editData.questionTextFr}
                  onChange={(e) =>
                    setEditData({ ...editData, questionTextFr: e.target.value })
                  }
                  className="w-full min-h-[100px] p-3 border rounded-md text-sm"
                />
              </div>

              <div className="flex justify-end gap-2">
                <Button variant="outline" onClick={handleCancelEdit}>
                  {t("cancel")}
                </Button>
                <Button onClick={handleSaveEdit}>{t("save")}</Button>
              </div>
            </div>
          )}
        </DialogContent>
      </Dialog>
    </div>
  );
}

// =============================================================================
// SUMMARY COMPONENT
// =============================================================================

interface ImportSummaryProps {
  totalQuestions: number;
  totalCategories: number;
  totalReferences: number;
  errorCount: number;
  warningCount: number;
  type: "ANS_USOAP_CMA" | "SMS_CANSO_SOE";
}

export function ImportSummaryCard({
  totalQuestions,
  totalCategories,
  totalReferences,
  errorCount,
  warningCount,
}: ImportSummaryProps) {
  const t = useTranslations("admin.import");

  return (
    <div className="grid grid-cols-2 md:grid-cols-5 gap-4">
      <div className="p-4 rounded-lg border bg-card">
        <p className="text-sm text-muted-foreground">{t("questions")}</p>
        <p className="text-2xl font-bold">{totalQuestions}</p>
      </div>
      <div className="p-4 rounded-lg border bg-card">
        <p className="text-sm text-muted-foreground">{t("categories")}</p>
        <p className="text-2xl font-bold">{totalCategories}</p>
      </div>
      <div className="p-4 rounded-lg border bg-card">
        <p className="text-sm text-muted-foreground">{t("references")}</p>
        <p className="text-2xl font-bold">{totalReferences}</p>
      </div>
      <div
        className={cn(
          "p-4 rounded-lg border",
          errorCount > 0
            ? "bg-red-50 border-red-200 dark:bg-red-900/20 dark:border-red-800"
            : "bg-card"
        )}
      >
        <p className="text-sm text-muted-foreground">{t("errors")}</p>
        <p
          className={cn(
            "text-2xl font-bold",
            errorCount > 0 && "text-destructive"
          )}
        >
          {errorCount}
        </p>
      </div>
      <div
        className={cn(
          "p-4 rounded-lg border",
          warningCount > 0
            ? "bg-amber-50 border-amber-200 dark:bg-amber-900/20 dark:border-amber-800"
            : "bg-card"
        )}
      >
        <p className="text-sm text-muted-foreground">{t("warnings")}</p>
        <p
          className={cn(
            "text-2xl font-bold",
            warningCount > 0 && "text-amber-600 dark:text-amber-400"
          )}
        >
          {warningCount}
        </p>
      </div>
    </div>
  );
}

```

# src/components/features/admin/questionnaire-import-wizard.tsx

```tsx
"use client";

import { useCallback, useState } from "react";
import { useRouter } from "next/navigation";
import { useTranslations } from "next-intl";
import { toast } from "sonner";
import { cn } from "@/lib/utils";
import { Button } from "@/components/ui/button";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Progress } from "@/components/ui/progress";
import { Badge } from "@/components/ui/badge";
import { Label } from "@/components/ui/label";
import { RadioGroup, RadioGroupItem } from "@/components/ui/radio-group";
import {
  AlertCircle,
  CheckCircle2,
  ChevronLeft,
  ChevronRight,
  FileJson,
  FileSpreadsheet,
  Loader2,
  Shield,
  Upload,
  FileText,
} from "lucide-react";
import { ImportPreviewTable, ImportSummaryCard } from "./import-preview-table";
import { trpc } from "@/lib/trpc/client";
import type { ValidationError } from "@/lib/questionnaire/import-schema";

// =============================================================================
// TYPES
// =============================================================================

type QuestionnaireType = "ANS_USOAP_CMA" | "SMS_CANSO_SOE";
type FileFormat = "json" | "csv";
type WizardStep = 1 | 2 | 3 | 4;

interface QuestionPreview {
  pqNumber?: string | null;
  questionTextEn: string;
  questionTextFr: string;
  auditArea?: string | null;
  criticalElement?: string | null;
  smsComponent?: string | null;
  studyArea?: string | null;
  isPriorityPQ?: boolean;
  requiresOnSite?: boolean;
  pqStatus?: string;
  sortOrder: number;
  icaoReferences?: unknown[];
}

interface ValidationResult {
  isValid: boolean;
  errors: ValidationError[];
  warnings: string[];
  summary: {
    totalQuestions: number;
    totalCategories: number;
    totalReferences: number;
    newQuestions: number;
    updatedQuestions: number;
  } | null;
  preview?: {
    questionnaire: unknown;
    categories: unknown[];
    questions: QuestionPreview[];
  };
}

interface ImportWizardProps {
  locale: string;
  onComplete?: (questionnaireId: string) => void;
}

// =============================================================================
// STEP COMPONENTS
// =============================================================================

interface Step1Props {
  selectedType: QuestionnaireType | null;
  onSelectType: (type: QuestionnaireType) => void;
}

function Step1TypeSelection({ selectedType, onSelectType }: Step1Props) {
  const t = useTranslations("admin.import");

  return (
    <div className="space-y-4">
      <div>
        <h2 className="text-lg font-semibold">{t("step1.title")}</h2>
        <p className="text-sm text-muted-foreground">{t("step1.description")}</p>
      </div>

      <RadioGroup
        value={selectedType || ""}
        onValueChange={(value) => onSelectType(value as QuestionnaireType)}
        className="grid grid-cols-1 md:grid-cols-2 gap-4"
      >
        <Label
          htmlFor="ans"
          className={cn(
            "flex items-start gap-4 p-4 rounded-lg border-2 cursor-pointer transition-colors",
            selectedType === "ANS_USOAP_CMA"
              ? "border-blue-500 bg-blue-50 dark:bg-blue-900/20"
              : "border-muted hover:border-muted-foreground/30"
          )}
        >
          <RadioGroupItem value="ANS_USOAP_CMA" id="ans" className="mt-1" />
          <div className="flex-1">
            <div className="flex items-center gap-2">
              <FileText className="h-5 w-5 text-blue-600" />
              <span className="font-semibold">{t("step1.ansTitle")}</span>
            </div>
            <p className="text-sm text-muted-foreground mt-1">
              {t("step1.ansDescription")}
            </p>
            <div className="flex flex-wrap gap-2 mt-2">
              <Badge variant="secondary" className="text-xs">851 PQs</Badge>
              <Badge variant="secondary" className="text-xs">9 Audit Areas</Badge>
              <Badge variant="secondary" className="text-xs">8 CEs</Badge>
            </div>
          </div>
        </Label>

        <Label
          htmlFor="sms"
          className={cn(
            "flex items-start gap-4 p-4 rounded-lg border-2 cursor-pointer transition-colors",
            selectedType === "SMS_CANSO_SOE"
              ? "border-emerald-500 bg-emerald-50 dark:bg-emerald-900/20"
              : "border-muted hover:border-muted-foreground/30"
          )}
        >
          <RadioGroupItem value="SMS_CANSO_SOE" id="sms" className="mt-1" />
          <div className="flex-1">
            <div className="flex items-center gap-2">
              <Shield className="h-5 w-5 text-emerald-600" />
              <span className="font-semibold">{t("step1.smsTitle")}</span>
            </div>
            <p className="text-sm text-muted-foreground mt-1">
              {t("step1.smsDescription")}
            </p>
            <div className="flex flex-wrap gap-2 mt-2">
              <Badge variant="secondary" className="text-xs">4 Components</Badge>
              <Badge variant="secondary" className="text-xs">12 Study Areas</Badge>
              <Badge variant="secondary" className="text-xs">5 Levels</Badge>
            </div>
          </div>
        </Label>
      </RadioGroup>
    </div>
  );
}

interface Step2Props {
  selectedFormat: FileFormat;
  onSelectFormat: (format: FileFormat) => void;
  fileContent: string;
  fileName: string;
  onFileUpload: (content: string, name: string) => void;
  isValidating: boolean;
}

function Step2FileUpload({
  selectedFormat,
  onSelectFormat,
  fileContent,
  fileName,
  onFileUpload,
  isValidating,
}: Step2Props) {
  const t = useTranslations("admin.import");

  const handleFileChange = useCallback(
    async (event: React.ChangeEvent<HTMLInputElement>) => {
      const file = event.target.files?.[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onload = (e) => {
        const content = e.target?.result as string;
        onFileUpload(content, file.name);
      };
      reader.readAsText(file);
    },
    [onFileUpload]
  );

  const handleDrop = useCallback(
    (event: React.DragEvent<HTMLDivElement>) => {
      event.preventDefault();
      const file = event.dataTransfer.files?.[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onload = (e) => {
        const content = e.target?.result as string;
        onFileUpload(content, file.name);
      };
      reader.readAsText(file);
    },
    [onFileUpload]
  );

  const handleDragOver = (event: React.DragEvent<HTMLDivElement>) => {
    event.preventDefault();
  };

  return (
    <div className="space-y-6">
      <div>
        <h2 className="text-lg font-semibold">{t("step2.title")}</h2>
        <p className="text-sm text-muted-foreground">{t("step2.description")}</p>
      </div>

      {/* Format Selection */}
      <div className="space-y-2">
        <Label>{t("step2.formatLabel")}</Label>
        <RadioGroup
          value={selectedFormat}
          onValueChange={(value) => onSelectFormat(value as FileFormat)}
          className="flex gap-4"
        >
          <Label
            htmlFor="json"
            className={cn(
              "flex items-center gap-2 px-4 py-2 rounded-lg border cursor-pointer transition-colors",
              selectedFormat === "json"
                ? "border-primary bg-primary/5"
                : "border-muted"
            )}
          >
            <RadioGroupItem value="json" id="json" />
            <FileJson className="h-4 w-4" />
            <span>JSON</span>
          </Label>
          <Label
            htmlFor="csv"
            className={cn(
              "flex items-center gap-2 px-4 py-2 rounded-lg border cursor-pointer transition-colors",
              selectedFormat === "csv"
                ? "border-primary bg-primary/5"
                : "border-muted"
            )}
          >
            <RadioGroupItem value="csv" id="csv" />
            <FileSpreadsheet className="h-4 w-4" />
            <span>CSV</span>
          </Label>
        </RadioGroup>
      </div>

      {/* File Upload Area */}
      <div
        onDrop={handleDrop}
        onDragOver={handleDragOver}
        className={cn(
          "relative border-2 border-dashed rounded-lg p-8 text-center transition-colors",
          fileContent
            ? "border-emerald-500 bg-emerald-50 dark:bg-emerald-900/20"
            : "border-muted hover:border-muted-foreground/50"
        )}
      >
        <input
          type="file"
          accept={selectedFormat === "json" ? ".json" : ".csv"}
          onChange={handleFileChange}
          className="absolute inset-0 w-full h-full opacity-0 cursor-pointer"
          disabled={isValidating}
        />

        {isValidating ? (
          <div className="flex flex-col items-center gap-2">
            <Loader2 className="h-8 w-8 animate-spin text-primary" />
            <p className="text-sm text-muted-foreground">{t("step2.validating")}</p>
          </div>
        ) : fileContent ? (
          <div className="flex flex-col items-center gap-2">
            <CheckCircle2 className="h-8 w-8 text-emerald-500" />
            <p className="font-medium">{fileName}</p>
            <p className="text-sm text-muted-foreground">
              {t("step2.fileUploaded")}
            </p>
          </div>
        ) : (
          <div className="flex flex-col items-center gap-2">
            <Upload className="h-8 w-8 text-muted-foreground" />
            <p className="font-medium">{t("step2.dropHere")}</p>
            <p className="text-sm text-muted-foreground">
              {t("step2.orClickToUpload")}
            </p>
          </div>
        )}
      </div>
    </div>
  );
}

interface Step3Props {
  validationResult: ValidationResult | null;
  type: QuestionnaireType;
  onEditQuestion: (index: number, data: QuestionPreview) => void;
  onRemoveQuestion: (index: number) => void;
}

function Step3Preview({
  validationResult,
  type,
  onEditQuestion,
  onRemoveQuestion,
}: Step3Props) {
  const t = useTranslations("admin.import");

  if (!validationResult) {
    return (
      <div className="text-center py-8 text-muted-foreground">
        {t("step3.noData")}
      </div>
    );
  }

  return (
    <div className="space-y-6">
      <div>
        <h2 className="text-lg font-semibold">{t("step3.title")}</h2>
        <p className="text-sm text-muted-foreground">{t("step3.description")}</p>
      </div>

      {/* Summary */}
      {validationResult.summary && (
        <ImportSummaryCard
          totalQuestions={validationResult.summary.totalQuestions}
          totalCategories={validationResult.summary.totalCategories}
          totalReferences={validationResult.summary.totalReferences}
          errorCount={validationResult.errors.length}
          warningCount={validationResult.warnings.length}
          type={type}
        />
      )}

      {/* Warnings */}
      {validationResult.warnings.length > 0 && (
        <Card className="border-amber-200 bg-amber-50 dark:border-amber-800 dark:bg-amber-900/20">
          <CardHeader className="pb-2">
            <CardTitle className="text-sm flex items-center gap-2 text-amber-700 dark:text-amber-400">
              <AlertCircle className="h-4 w-4" />
              {t("step3.warnings")} ({validationResult.warnings.length})
            </CardTitle>
          </CardHeader>
          <CardContent>
            <ul className="text-sm space-y-1 text-amber-700 dark:text-amber-400">
              {validationResult.warnings.map((warning, i) => (
                <li key={i}>• {warning}</li>
              ))}
            </ul>
          </CardContent>
        </Card>
      )}

      {/* Preview Table */}
      {validationResult.preview && (
        <ImportPreviewTable
          questions={validationResult.preview.questions}
          errors={validationResult.errors}
          type={type}
          onEdit={onEditQuestion}
          onRemove={onRemoveQuestion}
        />
      )}
    </div>
  );
}

interface Step4Props {
  isImporting: boolean;
  importSuccess: boolean;
  importError: string | null;
  summary: {
    categories: number;
    questions: number;
    references: number;
  } | null;
}

function Step4Confirm({
  isImporting,
  importSuccess,
  importError,
  summary,
}: Step4Props) {
  const t = useTranslations("admin.import");

  if (isImporting) {
    return (
      <div className="text-center py-12">
        <Loader2 className="h-12 w-12 animate-spin text-primary mx-auto mb-4" />
        <h2 className="text-lg font-semibold">{t("step4.importing")}</h2>
        <p className="text-sm text-muted-foreground">{t("step4.pleaseWait")}</p>
      </div>
    );
  }

  if (importSuccess && summary) {
    return (
      <div className="text-center py-12">
        <CheckCircle2 className="h-12 w-12 text-emerald-500 mx-auto mb-4" />
        <h2 className="text-lg font-semibold text-emerald-700 dark:text-emerald-400">
          {t("step4.success")}
        </h2>
        <p className="text-sm text-muted-foreground mt-2">
          {t("step4.successDescription", {
            categories: summary.categories,
            questions: summary.questions,
            references: summary.references,
          })}
        </p>
      </div>
    );
  }

  if (importError) {
    return (
      <div className="text-center py-12">
        <AlertCircle className="h-12 w-12 text-destructive mx-auto mb-4" />
        <h2 className="text-lg font-semibold text-destructive">
          {t("step4.error")}
        </h2>
        <p className="text-sm text-muted-foreground mt-2">{importError}</p>
      </div>
    );
  }

  return (
    <div className="text-center py-12">
      <h2 className="text-lg font-semibold">{t("step4.ready")}</h2>
      <p className="text-sm text-muted-foreground mt-2">
        {t("step4.readyDescription")}
      </p>
    </div>
  );
}

// =============================================================================
// MAIN WIZARD COMPONENT
// =============================================================================

export function QuestionnaireImportWizard({
  locale,
  onComplete,
}: ImportWizardProps) {
  const t = useTranslations("admin.import");
  const router = useRouter();

  // State
  const [step, setStep] = useState<WizardStep>(1);
  const [selectedType, setSelectedType] = useState<QuestionnaireType | null>(null);
  const [selectedFormat, setSelectedFormat] = useState<FileFormat>("json");
  const [fileContent, setFileContent] = useState("");
  const [fileName, setFileName] = useState("");
  const [validationResult, setValidationResult] = useState<ValidationResult | null>(null);
  const [importSummary, setImportSummary] = useState<{
    categories: number;
    questions: number;
    references: number;
  } | null>(null);
  const [importError, setImportError] = useState<string | null>(null);
  const [importSuccess, setImportSuccess] = useState(false);

  // tRPC mutations
  const validateMutation = trpc.admin.questionnaire.validateImport.useMutation();
  const bulkImportMutation = trpc.admin.questionnaire.bulkImport.useMutation();

  // Handle file upload and validate
  const handleFileUpload = useCallback(
    async (content: string, name: string) => {
      setFileContent(content);
      setFileName(name);

      if (selectedType) {
        try {
          const result = await validateMutation.mutateAsync({
            type: selectedType,
            data: content,
            format: selectedFormat,
          });

          setValidationResult(result as ValidationResult);

          if (result.isValid) {
            toast.success(t("validationSuccess"));
          } else {
            toast.error(t("validationErrors", { count: result.errors.length }));
          }
        } catch (error) {
          toast.error(t("validationFailed"));
          setValidationResult({
            isValid: false,
            errors: [
              {
                row: 0,
                field: "",
                message: error instanceof Error ? error.message : "Unknown error",
              },
            ],
            warnings: [],
            summary: null,
          });
        }
      }
    },
    [selectedType, selectedFormat, validateMutation, t]
  );

  // Handle question edit in preview
  const handleEditQuestion = useCallback(
    (index: number, data: QuestionPreview) => {
      if (!validationResult?.preview) return;

      const newQuestions = [...validationResult.preview.questions];
      newQuestions[index] = data;

      setValidationResult({
        ...validationResult,
        preview: {
          ...validationResult.preview,
          questions: newQuestions,
        },
      });
    },
    [validationResult]
  );

  // Handle question removal in preview
  const handleRemoveQuestion = useCallback(
    (index: number) => {
      if (!validationResult?.preview) return;

      const newQuestions = validationResult.preview.questions.filter(
        (_, i) => i !== index
      );
      const newErrors = validationResult.errors.filter((e) => e.row !== index);

      setValidationResult({
        ...validationResult,
        errors: newErrors,
        preview: {
          ...validationResult.preview,
          questions: newQuestions,
        },
        summary: validationResult.summary
          ? {
              ...validationResult.summary,
              totalQuestions: newQuestions.length,
            }
          : null,
      });
    },
    [validationResult]
  );

  // Handle import
  const handleImport = useCallback(async () => {
    if (!selectedType || !fileContent) return;

    setStep(4);
    setImportError(null);

    try {
      const result = await bulkImportMutation.mutateAsync({
        type: selectedType,
        data: fileContent,
        createQuestionnaire: true,
        updateExisting: false,
      });

      if (result.success && result.summary) {
        setImportSuccess(true);
        setImportSummary(result.summary);
        toast.success(t("importSuccess"));

        if (result.questionnaireId && onComplete) {
          onComplete(result.questionnaireId);
        }
      } else {
        setImportError(
          result.errors?.[0]?.message || t("importFailed")
        );
        toast.error(t("importFailed"));
      }
    } catch (error) {
      const message = error instanceof Error ? error.message : t("importFailed");
      setImportError(message);
      toast.error(message);
    }
  }, [selectedType, fileContent, bulkImportMutation, onComplete, t]);

  // Navigation
  const canGoNext = (): boolean => {
    switch (step) {
      case 1:
        return selectedType !== null;
      case 2:
        return fileContent !== "" && validationResult !== null;
      case 3:
        return validationResult?.isValid === true;
      case 4:
        return importSuccess;
      default:
        return false;
    }
  };

  const goNext = () => {
    if (step === 3) {
      handleImport();
    } else if (step < 4) {
      setStep((step + 1) as WizardStep);
    } else if (importSuccess) {
      router.push(`/${locale}/admin/questionnaires`);
    }
  };

  const goBack = () => {
    if (step > 1) {
      setStep((step - 1) as WizardStep);
    }
  };

  return (
    <div className="space-y-6">
      {/* Progress */}
      <div className="space-y-2">
        <div className="flex items-center justify-between text-sm">
          <span className="text-muted-foreground">
            {t("step", { current: step, total: 4 })}
          </span>
          <span className="font-medium">
            {step === 1 && t("step1.name")}
            {step === 2 && t("step2.name")}
            {step === 3 && t("step3.name")}
            {step === 4 && t("step4.name")}
          </span>
        </div>
        <Progress value={(step / 4) * 100} className="h-2" />
      </div>

      {/* Step Content */}
      <Card>
        <CardContent className="pt-6">
          {step === 1 && (
            <Step1TypeSelection
              selectedType={selectedType}
              onSelectType={setSelectedType}
            />
          )}

          {step === 2 && (
            <Step2FileUpload
              selectedFormat={selectedFormat}
              onSelectFormat={setSelectedFormat}
              fileContent={fileContent}
              fileName={fileName}
              onFileUpload={handleFileUpload}
              isValidating={validateMutation.isPending}
            />
          )}

          {step === 3 && selectedType && (
            <Step3Preview
              validationResult={validationResult}
              type={selectedType}
              onEditQuestion={handleEditQuestion}
              onRemoveQuestion={handleRemoveQuestion}
            />
          )}

          {step === 4 && (
            <Step4Confirm
              isImporting={bulkImportMutation.isPending}
              importSuccess={importSuccess}
              importError={importError}
              summary={importSummary}
            />
          )}
        </CardContent>
      </Card>

      {/* Navigation */}
      <div className="flex items-center justify-between">
        <Button
          variant="outline"
          onClick={goBack}
          disabled={step === 1 || bulkImportMutation.isPending}
        >
          <ChevronLeft className="h-4 w-4 mr-2" />
          {t("back")}
        </Button>

        <Button
          onClick={goNext}
          disabled={!canGoNext() || bulkImportMutation.isPending}
        >
          {step === 3 ? (
            <>
              {t("import")}
              <Upload className="h-4 w-4 ml-2" />
            </>
          ) : step === 4 && importSuccess ? (
            <>
              {t("done")}
              <CheckCircle2 className="h-4 w-4 ml-2" />
            </>
          ) : (
            <>
              {t("next")}
              <ChevronRight className="h-4 w-4 ml-2" />
            </>
          )}
        </Button>
      </div>
    </div>
  );
}

```

# src/components/features/assessment/assessment-wizard.tsx

```tsx
"use client";

import { useState, useCallback } from "react";
import { useRouter } from "next/navigation";
import { useLocale, useTranslations } from "next-intl";
import { motion, AnimatePresence } from "framer-motion";
import { ArrowLeft, ArrowRight, Loader2, CheckCircle, Sparkles } from "lucide-react";
import { toast } from "sonner";
import { Button } from "@/components/ui/button";
import { Card, CardContent } from "@/components/ui/card";
import { trpc } from "@/lib/trpc/client";
import type { QuestionnaireType, AssessmentType } from "@prisma/client";

// Step components
import { WizardStepper, type WizardStep } from "./wizard-steps/wizard-stepper";
import { QuestionnaireTypeStep } from "./wizard-steps/questionnaire-type-step";
import { AssessmentTypeStep } from "./wizard-steps/assessment-type-step";
import { AssessmentDetailsStep } from "./wizard-steps/assessment-details-step";
import { ReviewConfirmStep } from "./wizard-steps/review-confirm-step";

// Default selected areas
const DEFAULT_ANS_AREAS = ["LEG", "ORG", "PEL", "OPS", "AIR", "AIG", "ANS", "AGA", "SSP"];
const DEFAULT_SMS_COMPONENTS = [
  "SAFETY_POLICY_OBJECTIVES",
  "SAFETY_RISK_MANAGEMENT",
  "SAFETY_ASSURANCE",
  "SAFETY_PROMOTION",
];

interface WizardData {
  questionnaireType: QuestionnaireType | null;
  assessmentType: AssessmentType | null;
  title: string;
  description: string;
  dueDate: Date | null;
  selectedAreas: string[];
  confirmed: boolean;
}

const initialData: WizardData = {
  questionnaireType: null,
  assessmentType: null,
  title: "",
  description: "",
  dueDate: null,
  selectedAreas: [],
  confirmed: false,
};

type WizardState = "wizard" | "creating" | "success";

interface CreatedAssessment {
  id: string;
  title: string;
  questionCount: number;
}

export function AssessmentWizard() {
  const router = useRouter();
  const locale = useLocale();
  const t = useTranslations("wizard");
  const tCommon = useTranslations("common");

  const [step, setStep] = useState(1);
  const [data, setData] = useState<WizardData>(initialData);
  const [state, setState] = useState<WizardState>("wizard");
  const [createdAssessment, setCreatedAssessment] = useState<CreatedAssessment | null>(null);

  // tRPC mutation for creating assessment
  const createMutation = trpc.assessment.create.useMutation({
    onSuccess: (result) => {
      setCreatedAssessment({
        id: result.id,
        title: data.title,
        questionCount: 0, // Will be updated after creation
      });
      setState("success");
      toast.success(t("success.created"));
    },
    onError: (error) => {
      toast.error(error.message || t("errors.createFailed"));
      setState("wizard");
    },
  });

  // Steps configuration
  const steps: WizardStep[] = [
    {
      title: t("steps.questionnaireType"),
      description: t("steps.questionnaireTypeDesc"),
      isCompleted: step > 1,
      isActive: step === 1,
    },
    {
      title: t("steps.assessmentType"),
      description: t("steps.assessmentTypeDesc"),
      isCompleted: step > 2,
      isActive: step === 2,
    },
    {
      title: t("steps.details"),
      description: t("steps.detailsDesc"),
      isCompleted: step > 3,
      isActive: step === 3,
    },
    {
      title: t("steps.review"),
      description: t("steps.reviewDesc"),
      isCompleted: step > 4,
      isActive: step === 4,
    },
  ];

  // Update wizard data
  const updateData = useCallback((updates: Partial<WizardData>) => {
    setData((prev) => ({ ...prev, ...updates }));
  }, []);

  // Handle questionnaire type change
  const handleQuestionnaireTypeChange = useCallback(
    (questionnaireType: QuestionnaireType) => {
      const selectedAreas =
        questionnaireType === "ANS_USOAP_CMA"
          ? DEFAULT_ANS_AREAS
          : DEFAULT_SMS_COMPONENTS;
      updateData({ questionnaireType, selectedAreas, title: "" });
    },
    [updateData]
  );

  // Validation for each step
  const canProceed = useCallback((): boolean => {
    switch (step) {
      case 1:
        return data.questionnaireType !== null;
      case 2:
        return data.assessmentType !== null;
      case 3:
        return data.title.trim().length > 0 && data.selectedAreas.length > 0;
      case 4:
        return data.confirmed;
      default:
        return false;
    }
  }, [step, data]);

  // Handle create assessment
  const handleCreate = useCallback(() => {
    if (!data.questionnaireType || !data.assessmentType || !data.title.trim()) return;

    setState("creating");
    createMutation.mutate({
      questionnaireType: data.questionnaireType,
      assessmentType: data.assessmentType,
      title: data.title,
      description: data.description || undefined,
      dueDate: data.dueDate || undefined,
      scope: data.selectedAreas,
    });
  }, [data, createMutation]);

  // Handle next step
  const handleNext = useCallback(() => {
    if (!canProceed()) return;

    if (step < 4) {
      setStep((prev) => prev + 1);
    } else {
      // Submit and create assessment
      handleCreate();
    }
  }, [step, canProceed, handleCreate]);

  // Handle previous step
  const handlePrevious = useCallback(() => {
    if (step > 1) {
      setStep((prev) => prev - 1);
    }
  }, [step]);

  // Handle start assessment
  const handleStartAssessment = useCallback(() => {
    if (createdAssessment) {
      router.push(`/${locale}/assessments/${createdAssessment.id}`);
    }
  }, [createdAssessment, router, locale]);

  // Handle view dashboard
  const handleViewDashboard = useCallback(() => {
    router.push(`/${locale}/assessments`);
  }, [router, locale]);

  // Handle create another
  const handleCreateAnother = useCallback(() => {
    setData(initialData);
    setStep(1);
    setState("wizard");
    setCreatedAssessment(null);
  }, []);

  // Animation variants for step transitions
  const slideVariants = {
    enter: (direction: number) => ({
      x: direction > 0 ? 300 : -300,
      opacity: 0,
    }),
    center: {
      x: 0,
      opacity: 1,
    },
    exit: (direction: number) => ({
      x: direction < 0 ? 300 : -300,
      opacity: 0,
    }),
  };

  // Track direction for animations
  const [direction, setDirection] = useState(0);

  // Creating state UI
  if (state === "creating") {
    return (
      <Card className="mx-auto max-w-lg">
        <CardContent className="flex flex-col items-center justify-center py-12">
          <motion.div
            animate={{ rotate: 360 }}
            transition={{ duration: 1, repeat: Infinity, ease: "linear" }}
          >
            <Loader2 className="h-12 w-12 text-primary" />
          </motion.div>
          <h3 className="mt-6 text-lg font-semibold">{t("creating.title")}</h3>
          <p className="mt-2 text-center text-muted-foreground">
            {t("creating.description")}
          </p>
        </CardContent>
      </Card>
    );
  }

  // Success state UI
  if (state === "success" && createdAssessment) {
    return (
      <Card className="mx-auto max-w-lg">
        <CardContent className="flex flex-col items-center justify-center py-12">
          <motion.div
            initial={{ scale: 0 }}
            animate={{ scale: 1 }}
            transition={{ type: "spring", damping: 10 }}
          >
            <div className="rounded-full bg-green-100 p-4 dark:bg-green-900/30">
              <CheckCircle className="h-12 w-12 text-green-600" />
            </div>
          </motion.div>
          <h3 className="mt-6 text-xl font-semibold">{t("success.title")}</h3>
          <p className="mt-2 text-center text-muted-foreground">
            {t("success.description")}
          </p>

          <div className="mt-6 w-full rounded-lg border bg-muted/50 p-4">
            <div className="text-sm text-muted-foreground">
              {t("success.assessmentId")}
            </div>
            <div className="font-mono text-sm">{createdAssessment.id}</div>
            <div className="mt-2 text-sm text-muted-foreground">
              {t("success.assessmentTitle")}
            </div>
            <div className="font-medium">{createdAssessment.title}</div>
          </div>

          <div className="mt-8 flex w-full flex-col gap-3 sm:flex-row">
            <Button onClick={handleStartAssessment} className="flex-1 gap-2">
              <Sparkles className="h-4 w-4" />
              {t("success.startAssessment")}
            </Button>
            <Button
              variant="outline"
              onClick={handleViewDashboard}
              className="flex-1"
            >
              {t("success.viewDashboard")}
            </Button>
          </div>
          <Button
            variant="ghost"
            onClick={handleCreateAnother}
            className="mt-4"
          >
            {t("success.createAnother")}
          </Button>
        </CardContent>
      </Card>
    );
  }

  // Wizard UI
  return (
    <div className="space-y-8">
      {/* Stepper - hide on mobile */}
      <div className="hidden sm:block">
        <WizardStepper currentStep={step} totalSteps={4} steps={steps} />
      </div>

      {/* Mobile step indicator */}
      <div className="sm:hidden">
        <div className="flex items-center justify-between text-sm">
          <span className="text-muted-foreground">
            {t("steps.stepOf", { current: step, total: 4 })}
          </span>
          <span className="font-medium">{steps[step - 1]?.title}</span>
        </div>
        <div className="mt-2 h-2 w-full overflow-hidden rounded-full bg-muted">
          <motion.div
            initial={{ width: "0%" }}
            animate={{ width: `${(step / 4) * 100}%` }}
            transition={{ duration: 0.3 }}
            className="h-full bg-primary"
          />
        </div>
      </div>

      {/* Step content */}
      <Card>
        <CardContent className="p-6 sm:p-8">
          <AnimatePresence mode="wait" custom={direction}>
            <motion.div
              key={step}
              custom={direction}
              variants={slideVariants}
              initial="enter"
              animate="center"
              exit="exit"
              transition={{ duration: 0.3, ease: "easeInOut" }}
            >
              {step === 1 && (
                <QuestionnaireTypeStep
                  value={data.questionnaireType}
                  onChange={handleQuestionnaireTypeChange}
                />
              )}
              {step === 2 && (
                <AssessmentTypeStep
                  value={data.assessmentType}
                  onChange={(type) => updateData({ assessmentType: type })}
                />
              )}
              {step === 3 && (
                <AssessmentDetailsStep
                  questionnaireType={data.questionnaireType}
                  assessmentType={data.assessmentType}
                  title={data.title}
                  description={data.description}
                  dueDate={data.dueDate}
                  selectedAreas={data.selectedAreas}
                  onTitleChange={(title) => updateData({ title })}
                  onDescriptionChange={(description) =>
                    updateData({ description })
                  }
                  onDueDateChange={(dueDate) => updateData({ dueDate })}
                  onSelectedAreasChange={(selectedAreas) =>
                    updateData({ selectedAreas })
                  }
                />
              )}
              {step === 4 && (
                <ReviewConfirmStep
                  questionnaireType={data.questionnaireType}
                  assessmentType={data.assessmentType}
                  title={data.title}
                  description={data.description}
                  dueDate={data.dueDate}
                  selectedAreas={data.selectedAreas}
                  confirmed={data.confirmed}
                  onConfirmedChange={(confirmed) => updateData({ confirmed })}
                  isSubmitting={createMutation.isPending}
                />
              )}
            </motion.div>
          </AnimatePresence>
        </CardContent>
      </Card>

      {/* Navigation buttons */}
      <div className="flex items-center justify-between">
        <Button
          variant="outline"
          onClick={() => {
            setDirection(-1);
            handlePrevious();
          }}
          disabled={step === 1}
          className="gap-2"
        >
          <ArrowLeft className="h-4 w-4" />
          {tCommon("actions.back")}
        </Button>

        <div className="flex items-center gap-2">
          {step < 4 ? (
            <Button
              onClick={() => {
                setDirection(1);
                handleNext();
              }}
              disabled={!canProceed()}
              className="gap-2"
            >
              {tCommon("actions.next")}
              <ArrowRight className="h-4 w-4" />
            </Button>
          ) : (
            <Button
              onClick={handleNext}
              disabled={!canProceed() || createMutation.isPending}
              className="gap-2"
            >
              {createMutation.isPending ? (
                <>
                  <Loader2 className="h-4 w-4 animate-spin" />
                  {t("creating.button")}
                </>
              ) : (
                <>
                  <CheckCircle className="h-4 w-4" />
                  {t("review.createButton")}
                </>
              )}
            </Button>
          )}
        </div>
      </div>
    </div>
  );
}

```

# src/components/features/assessment/assessment-workspace-context.tsx

```tsx
"use client";

import {
  createContext,
  useContext,
  useState,
  useCallback,
  useEffect,
  useMemo,
  type ReactNode,
} from "react";
import { toast } from "sonner";
import { trpc } from "@/lib/trpc/client";
import type { QuestionnaireType } from "@prisma/client";

// Types
export type ANSResponseValue =
  | "SATISFACTORY"
  | "NOT_SATISFACTORY"
  | "NOT_APPLICABLE"
  | "NOT_REVIEWED";

export type SMSMaturityLevel = "A" | "B" | "C" | "D" | "E";

export interface QuestionData {
  id: string;
  pqNumber?: string;
  questionTextEn: string;
  questionTextFr: string;
  guidanceTextEn?: string;
  guidanceTextFr?: string;
  auditArea?: string;
  criticalElement?: string;
  smsComponent?: string;
  studyArea?: string;
  isPriorityPQ: boolean;
  requiresOnSite: boolean;
  weight: number;
  icaoReferences?: string[];
  categoryId?: string;
  categoryCode?: string;
  categoryName?: string;
}

export interface ResponseData {
  id: string;
  questionId: string;
  responseValue: ANSResponseValue | null;
  maturityLevel: SMSMaturityLevel | null;
  notes: string;
  evidenceUrls: string[];
  evidenceDescription: string;
  assessorNotes: string;
  internalNotes: string;
  isFlagged: boolean;
  isComplete: boolean;
}

export interface AssessmentData {
  id: string;
  title: string;
  type: string;
  status: string;
  questionnaireType: QuestionnaireType;
  questionnaire: {
    id: string;
    code: string;
    titleEn: string;
    titleFr: string;
  };
  organization: {
    id: string;
    nameEn: string;
    nameFr: string;
  };
  progress: number;
}

export type QuestionFilter = "all" | "unanswered" | "flagged" | "priority";

interface AssessmentWorkspaceContextValue {
  // Assessment data
  assessment: AssessmentData | null;
  isLoading: boolean;
  error: string | null;

  // Questions
  questions: QuestionData[];
  responses: Map<string, ResponseData>;
  currentQuestionIndex: number;
  currentQuestion: QuestionData | null;
  currentResponse: ResponseData | null;

  // Navigation
  goToQuestion: (index: number) => void;
  goToNextQuestion: () => void;
  goToPreviousQuestion: () => void;
  goToQuestionById: (questionId: string) => void;

  // Filtering
  filter: QuestionFilter;
  setFilter: (filter: QuestionFilter) => void;
  searchQuery: string;
  setSearchQuery: (query: string) => void;
  filteredQuestions: QuestionData[];

  // Response actions
  updateResponse: (questionId: string, updates: Partial<ResponseData>) => void;
  saveCurrentResponse: () => Promise<void>;
  toggleFlag: (questionId: string) => void;

  // UI state
  isSidebarOpen: boolean;
  toggleSidebar: () => void;
  isEvidencePanelOpen: boolean;
  toggleEvidencePanel: () => void;

  // Save status
  saveStatus: "saved" | "saving" | "unsaved" | "error";
  lastSavedAt: Date | null;

  // Progress
  answeredCount: number;
  totalCount: number;
  progressPercent: number;
}

const AssessmentWorkspaceContext = createContext<AssessmentWorkspaceContextValue | null>(null);

export function useAssessmentWorkspace() {
  const context = useContext(AssessmentWorkspaceContext);
  if (!context) {
    throw new Error(
      "useAssessmentWorkspace must be used within AssessmentWorkspaceProvider"
    );
  }
  return context;
}

interface AssessmentWorkspaceProviderProps {
  assessmentId: string;
  children: ReactNode;
}

export function AssessmentWorkspaceProvider({
  assessmentId,
  children,
}: AssessmentWorkspaceProviderProps) {
  // State
  const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);
  const [filter, setFilter] = useState<QuestionFilter>("all");
  const [searchQuery, setSearchQuery] = useState("");
  const [isSidebarOpen, setIsSidebarOpen] = useState(true);
  const [isEvidencePanelOpen, setIsEvidencePanelOpen] = useState(false);
  const [saveStatus, setSaveStatus] = useState<"saved" | "saving" | "unsaved" | "error">("saved");
  const [lastSavedAt, setLastSavedAt] = useState<Date | null>(null);
  const [localEdits, setLocalEdits] = useState<Map<string, Partial<ResponseData>>>(new Map());
  const [pendingChanges, setPendingChanges] = useState<Set<string>>(new Set());

  // Fetch assessment data
  const {
    data: assessmentData,
    isLoading: isLoadingAssessment,
    error: assessmentError,
  } = trpc.assessment.getById.useQuery(
    { id: assessmentId },
    { enabled: !!assessmentId }
  );

  // Fetch responses
  const {
    data: responsesData,
    isLoading: isLoadingResponses,
  } = trpc.assessment.getResponses.useQuery(
    { assessmentId, limit: 100 },
    { enabled: !!assessmentId }
  );

  // Save mutation
  const saveMutation = trpc.assessment.saveResponse.useMutation({
    onSuccess: () => {
      setSaveStatus("saved");
      setLastSavedAt(new Date());
    },
    onError: (error) => {
      setSaveStatus("error");
      toast.error(error.message || "Failed to save response");
    },
  });

  // Build questions list from responses
  const questions = useMemo<QuestionData[]>(() => {
    if (!responsesData?.responses) return [];
    return responsesData.responses.map((r) => ({
      id: r.question.id,
      pqNumber: r.question.pqNumber ?? undefined,
      questionTextEn: r.question.questionTextEn,
      questionTextFr: r.question.questionTextFr,
      guidanceTextEn: r.question.guidanceEn ?? undefined,
      guidanceTextFr: r.question.guidanceFr ?? undefined,
      auditArea: r.question.auditArea ?? undefined,
      criticalElement: r.question.criticalElement ?? undefined,
      smsComponent: r.question.smsComponent ?? undefined,
      studyArea: r.question.studyArea ?? undefined,
      isPriorityPQ: r.question.isPriorityPQ,
      requiresOnSite: r.question.requiresOnSite,
      weight: r.question.weight,
    }));
  }, [responsesData]);

  // Build server responses map (immutable, from API)
  const serverResponses = useMemo(() => {
    const responseMap = new Map<string, ResponseData>();
    if (!responsesData?.responses) return responseMap;

    for (const r of responsesData.responses) {
      const hasContent = (r.notes && r.notes.length > 0) ||
        (r.evidenceUrls && r.evidenceUrls.length > 0);

      responseMap.set(r.questionId, {
        id: r.id,
        questionId: r.questionId,
        responseValue: r.responseValue as ANSResponseValue | null,
        maturityLevel: r.maturityLevel as SMSMaturityLevel | null,
        notes: r.notes || "",
        evidenceUrls: r.evidenceUrls || [],
        evidenceDescription: "",
        assessorNotes: r.notes || "",
        internalNotes: "",
        isFlagged: false,
        isComplete: hasContent,
      });
    }
    return responseMap;
  }, [responsesData]);

  // Merge server responses with local edits
  const localResponses = useMemo(() => {
    const merged = new Map<string, ResponseData>();
    for (const [id, response] of serverResponses) {
      const edits = localEdits.get(id);
      merged.set(id, edits ? { ...response, ...edits } : response);
    }
    // Add any new responses that don't exist on server yet
    for (const [id, edits] of localEdits) {
      if (!merged.has(id)) {
        merged.set(id, {
          id: "",
          questionId: id,
          responseValue: null,
          maturityLevel: null,
          notes: "",
          evidenceUrls: [],
          evidenceDescription: "",
          assessorNotes: "",
          internalNotes: "",
          isFlagged: false,
          isComplete: false,
          ...edits,
        } as ResponseData);
      }
    }
    return merged;
  }, [serverResponses, localEdits]);

  // Filter questions
  const filteredQuestions = useMemo(() => {
    let filtered = questions;

    // Apply filter
    switch (filter) {
      case "unanswered":
        filtered = filtered.filter((q) => {
          const response = localResponses.get(q.id);
          if (!response) return true;
          if (assessmentData?.questionnaire.type === "ANS_USOAP_CMA") {
            return !response.responseValue || response.responseValue === "NOT_REVIEWED";
          }
          return !response.maturityLevel;
        });
        break;
      case "flagged":
        filtered = filtered.filter((q) => {
          const response = localResponses.get(q.id);
          return response?.isFlagged;
        });
        break;
      case "priority":
        filtered = filtered.filter((q) => q.isPriorityPQ);
        break;
    }

    // Apply search
    if (searchQuery.trim()) {
      const query = searchQuery.toLowerCase();
      filtered = filtered.filter(
        (q) =>
          q.pqNumber?.toLowerCase().includes(query) ||
          q.questionTextEn.toLowerCase().includes(query) ||
          q.questionTextFr.toLowerCase().includes(query)
      );
    }

    return filtered;
  }, [questions, filter, searchQuery, localResponses, assessmentData?.questionnaire.type]);

  // Current question and response
  const currentQuestion = filteredQuestions[currentQuestionIndex] || null;
  const currentResponse = currentQuestion
    ? localResponses.get(currentQuestion.id) || null
    : null;

  // Navigation
  const goToQuestion = useCallback(
    (index: number) => {
      if (index >= 0 && index < filteredQuestions.length) {
        setCurrentQuestionIndex(index);
      }
    },
    [filteredQuestions.length]
  );

  const goToNextQuestion = useCallback(() => {
    if (currentQuestionIndex < filteredQuestions.length - 1) {
      setCurrentQuestionIndex((prev) => prev + 1);
    }
  }, [currentQuestionIndex, filteredQuestions.length]);

  const goToPreviousQuestion = useCallback(() => {
    if (currentQuestionIndex > 0) {
      setCurrentQuestionIndex((prev) => prev - 1);
    }
  }, [currentQuestionIndex]);

  const goToQuestionById = useCallback(
    (questionId: string) => {
      const index = filteredQuestions.findIndex((q) => q.id === questionId);
      if (index !== -1) {
        setCurrentQuestionIndex(index);
      }
    },
    [filteredQuestions]
  );

  // Update response locally
  const updateResponse = useCallback(
    (questionId: string, updates: Partial<ResponseData>) => {
      setLocalEdits((prev) => {
        const newMap = new Map(prev);
        const existing = newMap.get(questionId) || {};
        newMap.set(questionId, { ...existing, ...updates });
        return newMap;
      });
      setPendingChanges((prev) => new Set(prev).add(questionId));
      setSaveStatus("unsaved");
    },
    []
  );

  // Save current response
  const saveCurrentResponse = useCallback(async () => {
    if (!currentQuestion || !currentResponse) return;

    setSaveStatus("saving");
    try {
      await saveMutation.mutateAsync({
        assessmentId,
        questionId: currentQuestion.id,
        responseValue: currentResponse.responseValue,
        maturityLevel: currentResponse.maturityLevel,
        notes: currentResponse.notes || undefined,
        evidenceUrls: currentResponse.evidenceUrls,
      });
      setPendingChanges((prev) => {
        const newSet = new Set(prev);
        newSet.delete(currentQuestion.id);
        return newSet;
      });
    } catch {
      // Error handled in mutation
    }
  }, [assessmentId, currentQuestion, currentResponse, saveMutation]);

  // Toggle flag
  const toggleFlag = useCallback(
    (questionId: string) => {
      const response = localResponses.get(questionId);
      updateResponse(questionId, { isFlagged: !response?.isFlagged });
    },
    [localResponses, updateResponse]
  );

  // Toggle sidebar
  const toggleSidebar = useCallback(() => {
    setIsSidebarOpen((prev) => !prev);
  }, []);

  // Toggle evidence panel
  const toggleEvidencePanel = useCallback(() => {
    setIsEvidencePanelOpen((prev) => !prev);
  }, []);

  // Progress calculations
  const answeredCount = useMemo(() => {
    let count = 0;
    for (const response of localResponses.values()) {
      if (assessmentData?.questionnaire.type === "ANS_USOAP_CMA") {
        if (response.responseValue && response.responseValue !== "NOT_REVIEWED") {
          count++;
        }
      } else {
        if (response.maturityLevel) {
          count++;
        }
      }
    }
    return count;
  }, [localResponses, assessmentData?.questionnaire.type]);

  const totalCount = questions.length;
  const progressPercent = totalCount > 0 ? Math.round((answeredCount / totalCount) * 100) : 0;

  // Auto-save effect (debounced)
  useEffect(() => {
    if (pendingChanges.size === 0) return;

    const timer = setTimeout(() => {
      if (currentQuestion && pendingChanges.has(currentQuestion.id)) {
        saveCurrentResponse();
      }
    }, 2000);

    return () => clearTimeout(timer);
  }, [pendingChanges, currentQuestion, saveCurrentResponse]);

  // Keyboard shortcuts
  useEffect(() => {
    const handleKeyDown = (e: KeyboardEvent) => {
      // Ignore if typing in input
      if (
        e.target instanceof HTMLInputElement ||
        e.target instanceof HTMLTextAreaElement
      ) {
        return;
      }

      switch (e.key) {
        case "ArrowLeft":
          e.preventDefault();
          goToPreviousQuestion();
          break;
        case "ArrowRight":
          e.preventDefault();
          goToNextQuestion();
          break;
        case "f":
        case "F":
          if (currentQuestion) {
            e.preventDefault();
            toggleFlag(currentQuestion.id);
          }
          break;
        case "s":
          if (e.ctrlKey || e.metaKey) {
            e.preventDefault();
            saveCurrentResponse();
          }
          break;
        case "Enter":
          if (e.ctrlKey || e.metaKey) {
            e.preventDefault();
            saveCurrentResponse().then(() => goToNextQuestion());
          }
          break;
        case "Escape":
          setIsEvidencePanelOpen(false);
          break;
        // Quick response for ANS (1-4)
        case "1":
          if (assessmentData?.questionnaire.type === "ANS_USOAP_CMA" && currentQuestion) {
            updateResponse(currentQuestion.id, { responseValue: "SATISFACTORY" });
          }
          break;
        case "2":
          if (assessmentData?.questionnaire.type === "ANS_USOAP_CMA" && currentQuestion) {
            updateResponse(currentQuestion.id, { responseValue: "NOT_SATISFACTORY" });
          }
          break;
        case "3":
          if (assessmentData?.questionnaire.type === "ANS_USOAP_CMA" && currentQuestion) {
            updateResponse(currentQuestion.id, { responseValue: "NOT_APPLICABLE" });
          }
          break;
        case "4":
          if (assessmentData?.questionnaire.type === "ANS_USOAP_CMA" && currentQuestion) {
            updateResponse(currentQuestion.id, { responseValue: "NOT_REVIEWED" });
          }
          break;
        // Quick response for SMS (A-E)
        case "a":
        case "A":
          if (assessmentData?.questionnaire.type === "SMS_CANSO_SOE" && currentQuestion && !e.ctrlKey && !e.metaKey) {
            updateResponse(currentQuestion.id, { maturityLevel: "A" });
          }
          break;
        case "b":
        case "B":
          if (assessmentData?.questionnaire.type === "SMS_CANSO_SOE" && currentQuestion) {
            updateResponse(currentQuestion.id, { maturityLevel: "B" });
          }
          break;
        case "c":
        case "C":
          if (assessmentData?.questionnaire.type === "SMS_CANSO_SOE" && currentQuestion && !e.ctrlKey && !e.metaKey) {
            updateResponse(currentQuestion.id, { maturityLevel: "C" });
          }
          break;
        case "d":
        case "D":
          if (assessmentData?.questionnaire.type === "SMS_CANSO_SOE" && currentQuestion) {
            updateResponse(currentQuestion.id, { maturityLevel: "D" });
          }
          break;
        case "e":
        case "E":
          if (assessmentData?.questionnaire.type === "SMS_CANSO_SOE" && currentQuestion) {
            updateResponse(currentQuestion.id, { maturityLevel: "E" });
          }
          break;
      }
    };

    window.addEventListener("keydown", handleKeyDown);
    return () => window.removeEventListener("keydown", handleKeyDown);
  }, [
    assessmentData?.questionnaire.type,
    currentQuestion,
    goToNextQuestion,
    goToPreviousQuestion,
    saveCurrentResponse,
    toggleFlag,
    updateResponse,
  ]);

  // Build assessment object
  const assessment: AssessmentData | null = assessmentData
    ? {
        id: assessmentData.id,
        title: (assessmentData as { title?: string }).title || `${assessmentData.organization.nameEn} - ${assessmentData.type}`,
        type: assessmentData.type,
        status: assessmentData.status,
        questionnaireType: assessmentData.questionnaire.type,
        questionnaire: {
          id: assessmentData.questionnaire.id,
          code: assessmentData.questionnaire.code,
          titleEn: assessmentData.questionnaire.titleEn,
          titleFr: assessmentData.questionnaire.titleFr,
        },
        organization: {
          id: assessmentData.organization.id,
          nameEn: assessmentData.organization.nameEn,
          nameFr: assessmentData.organization.nameFr,
        },
        progress: progressPercent,
      }
    : null;

  const isLoading = isLoadingAssessment || isLoadingResponses;
  const error = assessmentError?.message || null;

  const value: AssessmentWorkspaceContextValue = {
    assessment,
    isLoading,
    error,
    questions,
    responses: localResponses,
    currentQuestionIndex,
    currentQuestion,
    currentResponse,
    goToQuestion,
    goToNextQuestion,
    goToPreviousQuestion,
    goToQuestionById,
    filter,
    setFilter,
    searchQuery,
    setSearchQuery,
    filteredQuestions,
    updateResponse,
    saveCurrentResponse,
    toggleFlag,
    isSidebarOpen,
    toggleSidebar,
    isEvidencePanelOpen,
    toggleEvidencePanel,
    saveStatus,
    lastSavedAt,
    answeredCount,
    totalCount,
    progressPercent,
  };

  return (
    <AssessmentWorkspaceContext.Provider value={value}>
      {children}
    </AssessmentWorkspaceContext.Provider>
  );
}

```

# src/components/features/assessment/comments-section.tsx

```tsx
"use client";

import { useState } from "react";
import { useTranslations } from "next-intl";
import { motion, AnimatePresence } from "framer-motion";
import {
  MessageSquare,
  Lock,
  ChevronDown,
  ChevronUp,
  Info,
} from "lucide-react";
import { cn } from "@/lib/utils";
import { Button } from "@/components/ui/button";
import { Textarea } from "@/components/ui/textarea";
import { Label } from "@/components/ui/label";
import {
  Collapsible,
  CollapsibleContent,
  CollapsibleTrigger,
} from "@/components/ui/collapsible";
import {
  Tooltip,
  TooltipContent,
  TooltipProvider,
  TooltipTrigger,
} from "@/components/ui/tooltip";

interface CommentsSectionProps {
  assessorNotes: string;
  internalNotes: string;
  onAssessorNotesChange: (value: string) => void;
  onInternalNotesChange: (value: string) => void;
  disabled?: boolean;
  isReviewMode?: boolean;
}

export function CommentsSection({
  assessorNotes,
  internalNotes,
  onAssessorNotesChange,
  onInternalNotesChange,
  disabled,
  isReviewMode = false,
}: CommentsSectionProps) {
  const t = useTranslations("workspace.comments");
  const [isAssessorOpen, setIsAssessorOpen] = useState(true);
  const [isInternalOpen, setIsInternalOpen] = useState(!!internalNotes);

  return (
    <div className="space-y-4">
      {/* Assessor Notes - Visible to reviewers */}
      <Collapsible open={isAssessorOpen} onOpenChange={setIsAssessorOpen}>
        <CollapsibleTrigger asChild>
          <Button
            variant="ghost"
            className="w-full flex items-center justify-between p-3 hover:bg-muted rounded-lg"
          >
            <div className="flex items-center gap-2">
              <MessageSquare className="h-4 w-4 text-primary" />
              <span className="font-medium">{t("assessorNotes")}</span>
              {assessorNotes && (
                <span className="text-xs bg-primary/10 text-primary px-2 py-0.5 rounded-full">
                  {t("hasContent")}
                </span>
              )}
            </div>
            {isAssessorOpen ? (
              <ChevronUp className="h-4 w-4" />
            ) : (
              <ChevronDown className="h-4 w-4" />
            )}
          </Button>
        </CollapsibleTrigger>

        <CollapsibleContent>
          <AnimatePresence>
            <motion.div
              initial={{ opacity: 0, height: 0 }}
              animate={{ opacity: 1, height: "auto" }}
              exit={{ opacity: 0, height: 0 }}
              className="px-3 pb-3"
            >
              <div className="space-y-2">
                <div className="flex items-center gap-2">
                  <Label htmlFor="assessor-notes" className="text-sm text-muted-foreground">
                    {t("assessorNotesDescription")}
                  </Label>
                  <TooltipProvider>
                    <Tooltip>
                      <TooltipTrigger asChild>
                        <Info className="h-3.5 w-3.5 text-muted-foreground cursor-help" />
                      </TooltipTrigger>
                      <TooltipContent>
                        <p className="max-w-xs text-xs">{t("assessorNotesTooltip")}</p>
                      </TooltipContent>
                    </Tooltip>
                  </TooltipProvider>
                </div>
                <Textarea
                  id="assessor-notes"
                  value={assessorNotes}
                  onChange={(e: React.ChangeEvent<HTMLTextAreaElement>) => onAssessorNotesChange(e.target.value)}
                  placeholder={t("assessorNotesPlaceholder")}
                  disabled={disabled || isReviewMode}
                  className={cn(
                    "min-h-[100px] resize-y",
                    isReviewMode && "bg-muted"
                  )}
                />
                <div className="flex items-center justify-between text-xs text-muted-foreground">
                  <span>
                    {assessorNotes.length > 0 && (
                      <>{assessorNotes.length} {t("characters")}</>
                    )}
                  </span>
                  <span className="flex items-center gap-1">
                    <MessageSquare className="h-3 w-3" />
                    {t("visibleToReviewers")}
                  </span>
                </div>
              </div>
            </motion.div>
          </AnimatePresence>
        </CollapsibleContent>
      </Collapsible>

      {/* Internal Notes - Private to self-assessment team */}
      <Collapsible open={isInternalOpen} onOpenChange={setIsInternalOpen}>
        <CollapsibleTrigger asChild>
          <Button
            variant="ghost"
            className="w-full flex items-center justify-between p-3 hover:bg-muted rounded-lg"
          >
            <div className="flex items-center gap-2">
              <Lock className="h-4 w-4 text-orange-500" />
              <span className="font-medium">{t("internalNotes")}</span>
              {internalNotes && (
                <span className="text-xs bg-orange-500/10 text-orange-600 px-2 py-0.5 rounded-full">
                  {t("hasContent")}
                </span>
              )}
            </div>
            {isInternalOpen ? (
              <ChevronUp className="h-4 w-4" />
            ) : (
              <ChevronDown className="h-4 w-4" />
            )}
          </Button>
        </CollapsibleTrigger>

        <CollapsibleContent>
          <AnimatePresence>
            <motion.div
              initial={{ opacity: 0, height: 0 }}
              animate={{ opacity: 1, height: "auto" }}
              exit={{ opacity: 0, height: 0 }}
              className="px-3 pb-3"
            >
              <div className="space-y-2">
                <div className="flex items-center gap-2">
                  <Label htmlFor="internal-notes" className="text-sm text-muted-foreground">
                    {t("internalNotesDescription")}
                  </Label>
                  <TooltipProvider>
                    <Tooltip>
                      <TooltipTrigger asChild>
                        <Info className="h-3.5 w-3.5 text-muted-foreground cursor-help" />
                      </TooltipTrigger>
                      <TooltipContent>
                        <p className="max-w-xs text-xs">{t("internalNotesTooltip")}</p>
                      </TooltipContent>
                    </Tooltip>
                  </TooltipProvider>
                </div>
                <Textarea
                  id="internal-notes"
                  value={internalNotes}
                  onChange={(e: React.ChangeEvent<HTMLTextAreaElement>) => onInternalNotesChange(e.target.value)}
                  placeholder={t("internalNotesPlaceholder")}
                  disabled={disabled}
                  className="min-h-[100px] resize-y border-orange-200 focus:border-orange-400"
                />
                <div className="flex items-center justify-between text-xs text-muted-foreground">
                  <span>
                    {internalNotes.length > 0 && (
                      <>{internalNotes.length} {t("characters")}</>
                    )}
                  </span>
                  <span className="flex items-center gap-1 text-orange-600">
                    <Lock className="h-3 w-3" />
                    {t("privateNote")}
                  </span>
                </div>
              </div>
            </motion.div>
          </AnimatePresence>
        </CollapsibleContent>
      </Collapsible>

      {/* Quick tips */}
      <div className="text-xs text-muted-foreground bg-muted/50 p-3 rounded-lg">
        <div className="flex items-start gap-2">
          <Info className="h-4 w-4 shrink-0 mt-0.5" />
          <div>
            <p className="font-medium mb-1">{t("tips.title")}</p>
            <ul className="list-disc list-inside space-y-0.5">
              <li>{t("tips.tip1")}</li>
              <li>{t("tips.tip2")}</li>
              <li>{t("tips.tip3")}</li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  );
}

```

# src/components/features/assessment/evidence-panel.tsx

```tsx
"use client";

import { useState, useRef, useCallback } from "react";
import { useTranslations } from "next-intl";
import { motion, AnimatePresence } from "framer-motion";
import {
  FileText,
  Link as LinkIcon,
  Upload,
  Trash2,
  ExternalLink,
  Plus,
  FileUp,
  AlertCircle,
  CheckCircle2,
  FolderOpen,
  Eye,
  File,
  Image as ImageIcon,
  FileSpreadsheet,
} from "lucide-react";
import { cn } from "@/lib/utils";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Textarea } from "@/components/ui/textarea";
import { Label } from "@/components/ui/label";
import { Badge } from "@/components/ui/badge";
import {
  Card,
  CardContent,
  CardDescription,
  CardHeader,
  CardTitle,
} from "@/components/ui/card";
import {
  AlertDialog,
  AlertDialogAction,
  AlertDialogCancel,
  AlertDialogContent,
  AlertDialogDescription,
  AlertDialogFooter,
  AlertDialogHeader,
  AlertDialogTitle,
  AlertDialogTrigger,
} from "@/components/ui/alert-dialog";
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from "@/components/ui/select";
import { Progress } from "@/components/ui/progress";
import { trpc } from "@/lib/trpc/client";
import { DocumentPreview, type PreviewDocument } from "../document/DocumentPreview";
import { DocumentLibrary } from "../document/DocumentLibrary";
import type { DocumentCategory } from "@prisma/client";

// =============================================================================
// TYPES
// =============================================================================

export interface EvidenceDocument {
  id: string;
  name: string;
  url: string;
  fileType: string;
  fileSize: number;
  category: DocumentCategory;
  description?: string | null;
}

interface EvidencePanelProps {
  assessmentId?: string;
  responseId?: string;
  organizationId?: string;
  evidenceDescription: string;
  evidenceUrls: string[];
  evidenceDocuments?: EvidenceDocument[];
  onDescriptionChange: (value: string) => void;
  onUrlsChange: (urls: string[]) => void;
  onDocumentsChange?: (documents: EvidenceDocument[]) => void;
  disabled?: boolean;
  maxFiles?: number;
}

// =============================================================================
// CONSTANTS
// =============================================================================

const ALLOWED_TYPES = [
  "application/pdf",
  "image/jpeg",
  "image/png",
  "image/gif",
  "image/webp",
  "application/msword",
  "application/vnd.openxmlformats-officedocument.wordprocessingml.document",
  "application/vnd.ms-excel",
  "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
];

const MAX_FILE_SIZE = 10 * 1024 * 1024; // 10MB

const DOCUMENT_CATEGORIES: { value: DocumentCategory; labelKey: string }[] = [
  { value: "EVIDENCE", labelKey: "EVIDENCE" },
  { value: "POLICY", labelKey: "POLICY" },
  { value: "PROCEDURE", labelKey: "PROCEDURE" },
  { value: "RECORD", labelKey: "RECORD" },
  { value: "CERTIFICATE", labelKey: "CERTIFICATE" },
  { value: "REPORT", labelKey: "REPORT" },
  { value: "TRAINING", labelKey: "TRAINING" },
  { value: "OTHER", labelKey: "OTHER" },
];

// =============================================================================
// HELPERS
// =============================================================================

function getFileIcon(mimeType: string) {
  if (mimeType.startsWith("image/")) return ImageIcon;
  if (mimeType === "application/pdf") return FileText;
  if (
    mimeType.includes("spreadsheet") ||
    mimeType.includes("excel") ||
    mimeType === "application/vnd.ms-excel"
  )
    return FileSpreadsheet;
  return File;
}

function formatFileSize(bytes: number): string {
  if (bytes === 0) return "";
  const k = 1024;
  const sizes = ["B", "KB", "MB", "GB"];
  const i = Math.floor(Math.log(bytes) / Math.log(k));
  return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + " " + sizes[i];
}

export function EvidencePanel({
  assessmentId,
  responseId,
  organizationId,
  evidenceDescription,
  evidenceUrls,
  evidenceDocuments = [],
  onDescriptionChange,
  onUrlsChange,
  onDocumentsChange,
  disabled,
  maxFiles = 5,
}: EvidencePanelProps) {
  const t = useTranslations("workspace.evidence");
  const tEvidence = useTranslations("evidence");
  const [newUrl, setNewUrl] = useState("");
  const [urlError, setUrlError] = useState("");
  const [isDragging, setIsDragging] = useState(false);
  const [uploadProgress, setUploadProgress] = useState(0);
  const [isUploading, setIsUploading] = useState(false);
  const [uploadError, setUploadError] = useState<string | null>(null);
  const [selectedCategory, setSelectedCategory] = useState<DocumentCategory>("EVIDENCE");
  const [showLibrary, setShowLibrary] = useState(false);
  const [previewDocument, setPreviewDocument] = useState<PreviewDocument | null>(null);
  const fileInputRef = useRef<HTMLInputElement>(null);

  // tRPC mutations
  const createDocument = trpc.document.create.useMutation();
  const linkToResponse = trpc.document.linkToResponse.useMutation();
  const unlinkFromResponse = trpc.document.unlinkFromResponse.useMutation();

  const canAddMore = evidenceDocuments.length < maxFiles;

  const validateUrl = (url: string): boolean => {
    try {
      new URL(url);
      return true;
    } catch {
      return false;
    }
  };

  const handleAddUrl = () => {
    const trimmedUrl = newUrl.trim();
    if (!trimmedUrl) {
      setUrlError(t("errors.emptyUrl"));
      return;
    }

    if (!validateUrl(trimmedUrl)) {
      setUrlError(t("errors.invalidUrl"));
      return;
    }

    if (evidenceUrls.includes(trimmedUrl)) {
      setUrlError(t("errors.duplicateUrl"));
      return;
    }

    onUrlsChange([...evidenceUrls, trimmedUrl]);
    setNewUrl("");
    setUrlError("");
  };

  const handleRemoveUrl = (urlToRemove: string) => {
    onUrlsChange(evidenceUrls.filter((url) => url !== urlToRemove));
  };

  const handleKeyPress = (e: React.KeyboardEvent) => {
    if (e.key === "Enter") {
      e.preventDefault();
      handleAddUrl();
    }
  };

  const handleDragOver = (e: React.DragEvent) => {
    e.preventDefault();
    if (!disabled && canAddMore) {
      setIsDragging(true);
    }
  };

  const handleDragLeave = (e: React.DragEvent) => {
    e.preventDefault();
    setIsDragging(false);
  };

  const handleFileUpload = useCallback(
    async (file: File) => {
      // Validate file type
      if (!ALLOWED_TYPES.includes(file.type)) {
        setUploadError(tEvidence("upload.allowedTypes"));
        return;
      }

      // Validate file size
      if (file.size > MAX_FILE_SIZE) {
        setUploadError(tEvidence("upload.maxSize", { size: 10 }));
        return;
      }

      if (!canAddMore) {
        setUploadError(tEvidence("upload.maxFiles", { count: maxFiles }));
        return;
      }

      setIsUploading(true);
      setUploadProgress(10);
      setUploadError(null);

      try {
        // Upload file to server
        const formData = new FormData();
        formData.append("file", file);

        setUploadProgress(30);

        const uploadResponse = await fetch("/api/upload", {
          method: "POST",
          body: formData,
        });

        if (!uploadResponse.ok) {
          const errorData = await uploadResponse.json();
          throw new Error(errorData.error || "Upload failed");
        }

        const uploadResult = await uploadResponse.json();

        setUploadProgress(60);

        // Create document record
        const documentResult = await createDocument.mutateAsync({
          name: file.name,
          originalName: uploadResult.file.originalName,
          fileUrl: uploadResult.file.url,
          fileType: file.type,
          fileSize: file.size,
          category: selectedCategory,
          assessmentId,
        });

        setUploadProgress(80);

        // Link to response if responseId provided
        if (responseId) {
          await linkToResponse.mutateAsync({
            documentId: documentResult.document.id,
            responseId,
          });
        }

        setUploadProgress(100);

        // Notify parent
        if (onDocumentsChange) {
          const newDoc: EvidenceDocument = {
            id: documentResult.document.id,
            name: documentResult.document.name,
            url: documentResult.document.fileUrl,
            fileType: documentResult.document.fileType,
            fileSize: documentResult.document.fileSize,
            category: documentResult.document.category,
            description: documentResult.document.description,
          };
          onDocumentsChange([...evidenceDocuments, newDoc]);
        }

        // Reset input
        if (fileInputRef.current) {
          fileInputRef.current.value = "";
        }
      } catch (error) {
        setUploadError(
          error instanceof Error ? error.message : tEvidence("upload.uploadFailed")
        );
      } finally {
        setIsUploading(false);
        setUploadProgress(0);
      }
    },
    [
      assessmentId,
      responseId,
      canAddMore,
      maxFiles,
      selectedCategory,
      tEvidence,
      createDocument,
      linkToResponse,
      onDocumentsChange,
      evidenceDocuments,
    ]
  );

  const handleDrop = useCallback(
    (e: React.DragEvent) => {
      e.preventDefault();
      setIsDragging(false);
      if (!disabled && canAddMore && e.dataTransfer.files.length > 0) {
        handleFileUpload(e.dataTransfer.files[0]);
      }
    },
    [disabled, canAddMore, handleFileUpload]
  );

  const handleRemoveDocument = useCallback(
    async (docId: string) => {
      if (responseId) {
        try {
          await unlinkFromResponse.mutateAsync({
            documentId: docId,
            responseId,
          });
        } catch (error) {
          console.error("Failed to unlink document:", error);
        }
      }

      if (onDocumentsChange) {
        onDocumentsChange(evidenceDocuments.filter((d) => d.id !== docId));
      }
    },
    [responseId, unlinkFromResponse, onDocumentsChange, evidenceDocuments]
  );

  const handleLibrarySelect = useCallback(
    async (selectedDocs: Array<{ id: string; name: string; fileUrl: string; fileType: string; fileSize: number; category: DocumentCategory; description?: string | null }>) => {
      if (responseId) {
        for (const doc of selectedDocs) {
          try {
            await linkToResponse.mutateAsync({
              documentId: doc.id,
              responseId,
            });
          } catch (error) {
            console.error("Failed to link document:", error);
          }
        }
      }

      if (onDocumentsChange) {
        const newDocs: EvidenceDocument[] = selectedDocs.map((doc) => ({
          id: doc.id,
          name: doc.name,
          url: doc.fileUrl,
          fileType: doc.fileType,
          fileSize: doc.fileSize,
          category: doc.category,
          description: doc.description,
        }));
        onDocumentsChange([...evidenceDocuments, ...newDocs]);
      }
    },
    [responseId, linkToResponse, onDocumentsChange, evidenceDocuments]
  );

  const handlePreview = useCallback((doc: EvidenceDocument) => {
    setPreviewDocument({
      id: doc.id,
      name: doc.name,
      url: doc.url,
      fileType: doc.fileType,
      fileSize: doc.fileSize,
      category: doc.category,
      description: doc.description,
    });
  }, []);

  const getUrlDomain = (url: string): string => {
    try {
      return new URL(url).hostname;
    } catch {
      return url;
    }
  };

  const hasEvidence =
    evidenceDescription.length > 0 ||
    evidenceUrls.length > 0 ||
    evidenceDocuments.length > 0;

  return (
    <Card className="border-dashed">
      <CardHeader className="pb-3">
        <div className="flex items-center justify-between">
          <div className="flex items-center gap-2">
            <FileText className="h-5 w-5 text-primary" />
            <CardTitle className="text-base">{t("title")}</CardTitle>
          </div>
          {hasEvidence ? (
            <Badge variant="default" className="bg-green-600">
              <CheckCircle2 className="h-3 w-3 mr-1" />
              {t("hasEvidence")}
            </Badge>
          ) : (
            <Badge variant="secondary">
              <AlertCircle className="h-3 w-3 mr-1" />
              {t("noEvidence")}
            </Badge>
          )}
        </div>
        <CardDescription>{t("description")}</CardDescription>
      </CardHeader>

      <CardContent className="space-y-4">
        {/* Evidence Description */}
        <div className="space-y-2">
          <Label htmlFor="evidence-description" className="text-sm font-medium">
            {t("descriptionLabel")}
          </Label>
          <Textarea
            id="evidence-description"
            value={evidenceDescription}
            onChange={(e) => onDescriptionChange(e.target.value)}
            placeholder={t("descriptionPlaceholder")}
            disabled={disabled}
            className="min-h-[80px] resize-y"
          />
          <p className="text-xs text-muted-foreground">
            {t("descriptionHint")}
          </p>
        </div>

        {/* Document Links */}
        <div className="space-y-3">
          <Label className="text-sm font-medium">{t("linksLabel")}</Label>

          {/* Existing URLs */}
          {evidenceUrls.length > 0 && (
            <div className="space-y-2">
              <AnimatePresence>
                {evidenceUrls.map((url, index) => (
                  <motion.div
                    key={url}
                    initial={{ opacity: 0, x: -20 }}
                    animate={{ opacity: 1, x: 0 }}
                    exit={{ opacity: 0, x: 20 }}
                    transition={{ delay: index * 0.05 }}
                    className="flex items-center gap-2 p-2 bg-muted rounded-md group"
                  >
                    <LinkIcon className="h-4 w-4 text-muted-foreground shrink-0" />
                    <div className="flex-1 min-w-0">
                      <a
                        href={url}
                        target="_blank"
                        rel="noopener noreferrer"
                        className="text-sm text-primary hover:underline truncate block"
                      >
                        {url}
                      </a>
                      <span className="text-xs text-muted-foreground">
                        {getUrlDomain(url)}
                      </span>
                    </div>
                    <div className="flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity">
                      <Button
                        variant="ghost"
                        size="icon"
                        className="h-7 w-7"
                        asChild
                      >
                        <a href={url} target="_blank" rel="noopener noreferrer">
                          <ExternalLink className="h-3.5 w-3.5" />
                        </a>
                      </Button>
                      <AlertDialog>
                        <AlertDialogTrigger asChild>
                          <Button
                            variant="ghost"
                            size="icon"
                            className="h-7 w-7 text-destructive hover:text-destructive"
                            disabled={disabled}
                          >
                            <Trash2 className="h-3.5 w-3.5" />
                          </Button>
                        </AlertDialogTrigger>
                        <AlertDialogContent>
                          <AlertDialogHeader>
                            <AlertDialogTitle>{t("removeDialog.title")}</AlertDialogTitle>
                            <AlertDialogDescription>
                              {t("removeDialog.description")}
                            </AlertDialogDescription>
                          </AlertDialogHeader>
                          <AlertDialogFooter>
                            <AlertDialogCancel>{t("removeDialog.cancel")}</AlertDialogCancel>
                            <AlertDialogAction
                              onClick={() => handleRemoveUrl(url)}
                              className="bg-destructive hover:bg-destructive/90"
                            >
                              {t("removeDialog.confirm")}
                            </AlertDialogAction>
                          </AlertDialogFooter>
                        </AlertDialogContent>
                      </AlertDialog>
                    </div>
                  </motion.div>
                ))}
              </AnimatePresence>
            </div>
          )}

          {/* Add new URL */}
          <div className="flex gap-2">
            <div className="flex-1">
              <Input
                value={newUrl}
                onChange={(e) => {
                  setNewUrl(e.target.value);
                  setUrlError("");
                }}
                onKeyPress={handleKeyPress}
                placeholder={t("urlPlaceholder")}
                disabled={disabled}
                className={cn(urlError && "border-destructive")}
              />
              {urlError && (
                <p className="text-xs text-destructive mt-1">{urlError}</p>
              )}
            </div>
            <Button
              type="button"
              onClick={handleAddUrl}
              disabled={disabled || !newUrl.trim()}
              size="icon"
            >
              <Plus className="h-4 w-4" />
            </Button>
          </div>

          {/* Uploaded Documents */}
          {evidenceDocuments.length > 0 && (
            <div className="space-y-2">
              <Label className="text-sm font-medium">
                {tEvidence("upload.title")} ({evidenceDocuments.length}/{maxFiles})
              </Label>
              <AnimatePresence>
                {evidenceDocuments.map((doc, index) => {
                  const FileIcon = getFileIcon(doc.fileType);
                  const isExternalLink = doc.fileType === "external_link";

                  return (
                    <motion.div
                      key={doc.id}
                      initial={{ opacity: 0, x: -20 }}
                      animate={{ opacity: 1, x: 0 }}
                      exit={{ opacity: 0, x: 20 }}
                      transition={{ delay: index * 0.05 }}
                      className="flex items-center gap-2 p-2 bg-muted rounded-md group"
                    >
                      {isExternalLink ? (
                        <ExternalLink className="h-4 w-4 text-blue-500 shrink-0" />
                      ) : (
                        <FileIcon className="h-4 w-4 text-muted-foreground shrink-0" />
                      )}
                      <div className="flex-1 min-w-0">
                        <p className="text-sm font-medium truncate">{doc.name}</p>
                        <p className="text-xs text-muted-foreground">
                          {tEvidence(`categories.${doc.category}`)}
                          {doc.fileSize > 0 && ` - ${formatFileSize(doc.fileSize)}`}
                        </p>
                      </div>
                      <div className="flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity">
                        <Button
                          variant="ghost"
                          size="icon"
                          className="h-7 w-7"
                          onClick={() => handlePreview(doc)}
                        >
                          <Eye className="h-3.5 w-3.5" />
                        </Button>
                        <AlertDialog>
                          <AlertDialogTrigger asChild>
                            <Button
                              variant="ghost"
                              size="icon"
                              className="h-7 w-7 text-destructive hover:text-destructive"
                              disabled={disabled}
                            >
                              <Trash2 className="h-3.5 w-3.5" />
                            </Button>
                          </AlertDialogTrigger>
                          <AlertDialogContent>
                            <AlertDialogHeader>
                              <AlertDialogTitle>{t("removeDialog.title")}</AlertDialogTitle>
                              <AlertDialogDescription>
                                {t("removeDialog.description")}
                              </AlertDialogDescription>
                            </AlertDialogHeader>
                            <AlertDialogFooter>
                              <AlertDialogCancel>{t("removeDialog.cancel")}</AlertDialogCancel>
                              <AlertDialogAction
                                onClick={() => handleRemoveDocument(doc.id)}
                                className="bg-destructive hover:bg-destructive/90"
                              >
                                {t("removeDialog.confirm")}
                              </AlertDialogAction>
                            </AlertDialogFooter>
                          </AlertDialogContent>
                        </AlertDialog>
                      </div>
                    </motion.div>
                  );
                })}
              </AnimatePresence>
            </div>
          )}

          {/* Category Selection */}
          {canAddMore && (
            <div className="flex items-center gap-2">
              <Label className="text-xs text-muted-foreground shrink-0">
                {tEvidence("upload.category")}:
              </Label>
              <Select
                value={selectedCategory}
                onValueChange={(value) => setSelectedCategory(value as DocumentCategory)}
                disabled={disabled}
              >
                <SelectTrigger className="h-8 text-xs flex-1">
                  <SelectValue />
                </SelectTrigger>
                <SelectContent>
                  {DOCUMENT_CATEGORIES.map((cat) => (
                    <SelectItem key={cat.value} value={cat.value}>
                      {tEvidence(`categories.${cat.labelKey}`)}
                    </SelectItem>
                  ))}
                </SelectContent>
              </Select>
            </div>
          )}

          {/* File Upload Zone */}
          <div
            onDragOver={handleDragOver}
            onDragLeave={handleDragLeave}
            onDrop={handleDrop}
            onClick={() => !disabled && canAddMore && !isUploading && fileInputRef.current?.click()}
            className={cn(
              "border-2 border-dashed rounded-lg p-6 text-center cursor-pointer transition-colors",
              isDragging
                ? "border-primary bg-primary/5"
                : "border-muted-foreground/25 hover:border-primary/50",
              (disabled || !canAddMore || isUploading) && "cursor-not-allowed opacity-50"
            )}
          >
            <input
              ref={fileInputRef}
              type="file"
              accept={ALLOWED_TYPES.join(",")}
              className="hidden"
              disabled={disabled || !canAddMore || isUploading}
              onChange={(e) => {
                const file = e.target.files?.[0];
                if (file) handleFileUpload(file);
              }}
            />

            {isUploading ? (
              <div className="space-y-3">
                <Upload className="h-8 w-8 mx-auto text-primary animate-pulse" />
                <p className="text-sm font-medium">{tEvidence("upload.uploading")}</p>
                <Progress value={uploadProgress} className="max-w-xs mx-auto" />
              </div>
            ) : (
              <>
                <FileUp className="h-8 w-8 mx-auto text-muted-foreground mb-2" />
                <p className="text-sm font-medium">{t("dropzone.title")}</p>
                <p className="text-xs text-muted-foreground mt-1">
                  {t("dropzone.subtitle")}
                </p>
                <div className="flex items-center justify-center gap-2 mt-3">
                  <Button
                    variant="secondary"
                    size="sm"
                    disabled={disabled || !canAddMore}
                    onClick={(e) => {
                      e.stopPropagation();
                      fileInputRef.current?.click();
                    }}
                  >
                    <Upload className="h-4 w-4 mr-2" />
                    {t("dropzone.button")}
                  </Button>
                  {organizationId && (
                    <Button
                      variant="outline"
                      size="sm"
                      disabled={disabled || !canAddMore}
                      onClick={(e) => {
                        e.stopPropagation();
                        setShowLibrary(true);
                      }}
                    >
                      <FolderOpen className="h-4 w-4 mr-2" />
                      {tEvidence("library.title")}
                    </Button>
                  )}
                </div>
              </>
            )}
          </div>

          {/* Upload Error */}
          {uploadError && (
            <p className="text-xs text-destructive">{uploadError}</p>
          )}

          {/* Supported formats hint */}
          <p className="text-xs text-muted-foreground">
            {t("supportedFormats")}
          </p>
        </div>
      </CardContent>

      {/* Document Library Dialog */}
      {organizationId && (
        <DocumentLibrary
          organizationId={organizationId}
          assessmentId={assessmentId}
          open={showLibrary}
          onClose={() => setShowLibrary(false)}
          onSelect={handleLibrarySelect}
          excludeIds={evidenceDocuments.map((d) => d.id)}
          maxSelection={maxFiles - evidenceDocuments.length}
        />
      )}

      {/* Document Preview Dialog */}
      {previewDocument && (
        <DocumentPreview
          document={previewDocument}
          open={!!previewDocument}
          onClose={() => setPreviewDocument(null)}
        />
      )}
    </Card>
  );
}

```

# src/components/features/assessment/question-navigation-sidebar.tsx

```tsx
"use client";

import { useMemo } from "react";
import { useLocale, useTranslations } from "next-intl";
import { motion, AnimatePresence } from "framer-motion";
import {
  ChevronLeft,
  ChevronRight,
  Search,
  Filter,
  Circle,
  CheckCircle,
  Flag,
  AlertTriangle,
  X,
} from "lucide-react";
import { cn } from "@/lib/utils";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Badge } from "@/components/ui/badge";
import { Progress } from "@/components/ui/progress";
import { ScrollArea } from "@/components/ui/scroll-area";
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from "@/components/ui/select";
import {
  useAssessmentWorkspace,
  type QuestionFilter,
  type QuestionData,
} from "./assessment-workspace-context";

interface QuestionGroup {
  code: string;
  name: string;
  questions: QuestionData[];
  answeredCount: number;
  totalCount: number;
}

export function QuestionNavigationSidebar() {
  const locale = useLocale();
  const t = useTranslations("workspace");
  const {
    assessment,
    responses,
    filteredQuestions,
    currentQuestion,
    filter,
    setFilter,
    searchQuery,
    setSearchQuery,
    goToQuestionById,
    isSidebarOpen,
    toggleSidebar,
    answeredCount,
    totalCount,
    progressPercent,
  } = useAssessmentWorkspace();

  const isANS = assessment?.questionnaireType === "ANS_USOAP_CMA";

  // Group questions by category
  const groupedQuestions = useMemo(() => {
    const groups: Map<string, QuestionGroup> = new Map();

    for (const question of filteredQuestions) {
      const code = isANS
        ? question.auditArea || "OTHER"
        : question.smsComponent || "OTHER";
      const name = code;

      if (!groups.has(code)) {
        groups.set(code, {
          code,
          name,
          questions: [],
          answeredCount: 0,
          totalCount: 0,
        });
      }

      const group = groups.get(code)!;
      group.questions.push(question);
      group.totalCount++;

      const response = responses.get(question.id);
      if (response) {
        const isAnswered = isANS
          ? response.responseValue && response.responseValue !== "NOT_REVIEWED"
          : !!response.maturityLevel;
        if (isAnswered) {
          group.answeredCount++;
        }
      }
    }

    return Array.from(groups.values()).sort((a, b) =>
      a.code.localeCompare(b.code)
    );
  }, [filteredQuestions, responses, isANS]);

  // Get question status
  const getQuestionStatus = (question: QuestionData) => {
    const response = responses.get(question.id);
    if (!response) return "unanswered";

    if (response.isFlagged) return "flagged";

    const isAnswered = isANS
      ? response.responseValue && response.responseValue !== "NOT_REVIEWED"
      : !!response.maturityLevel;

    if (!isAnswered) return "unanswered";
    if (response.isComplete || response.evidenceUrls.length > 0) return "complete";
    return "answered";
  };

  const filterOptions: { value: QuestionFilter; label: string }[] = [
    { value: "all", label: t("filters.all") },
    { value: "unanswered", label: t("filters.unanswered") },
    { value: "flagged", label: t("filters.flagged") },
    ...(isANS ? [{ value: "priority" as QuestionFilter, label: t("filters.priority") }] : []),
  ];

  return (
    <>
      {/* Sidebar */}
      <AnimatePresence mode="wait">
        {isSidebarOpen && (
          <motion.aside
            initial={{ width: 0, opacity: 0 }}
            animate={{ width: 320, opacity: 1 }}
            exit={{ width: 0, opacity: 0 }}
            transition={{ duration: 0.2 }}
            className="flex h-full flex-col border-r bg-background"
          >
            {/* Header */}
            <div className="flex items-center justify-between border-b p-4">
              <div>
                <h2 className="font-semibold">{t("sidebar.title")}</h2>
                <p className="text-sm text-muted-foreground">
                  {t("sidebar.progress", {
                    answered: answeredCount,
                    total: totalCount,
                  })}
                </p>
              </div>
              <Button
                variant="ghost"
                size="icon"
                onClick={toggleSidebar}
                className="shrink-0"
              >
                <ChevronLeft className="h-4 w-4" />
              </Button>
            </div>

            {/* Progress bar */}
            <div className="px-4 py-3 border-b">
              <div className="flex items-center justify-between text-sm mb-2">
                <span className="text-muted-foreground">
                  {t("sidebar.overallProgress")}
                </span>
                <span className="font-medium">{progressPercent}%</span>
              </div>
              <Progress value={progressPercent} className="h-2" />
            </div>

            {/* Search and filter */}
            <div className="space-y-3 p-4 border-b">
              <div className="relative">
                <Search className="absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground" />
                <Input
                  placeholder={t("sidebar.searchPlaceholder")}
                  value={searchQuery}
                  onChange={(e) => setSearchQuery(e.target.value)}
                  className="pl-9 pr-9"
                />
                {searchQuery && (
                  <Button
                    variant="ghost"
                    size="icon"
                    className="absolute right-1 top-1/2 h-7 w-7 -translate-y-1/2"
                    onClick={() => setSearchQuery("")}
                  >
                    <X className="h-3 w-3" />
                  </Button>
                )}
              </div>

              <Select value={filter} onValueChange={(v) => setFilter(v as QuestionFilter)}>
                <SelectTrigger>
                  <Filter className="h-4 w-4 mr-2" />
                  <SelectValue />
                </SelectTrigger>
                <SelectContent>
                  {filterOptions.map((option) => (
                    <SelectItem key={option.value} value={option.value}>
                      {option.label}
                    </SelectItem>
                  ))}
                </SelectContent>
              </Select>
            </div>

            {/* Question list */}
            <ScrollArea className="flex-1">
              <div className="p-2">
                {groupedQuestions.length === 0 ? (
                  <div className="p-4 text-center text-muted-foreground">
                    {t("sidebar.noQuestions")}
                  </div>
                ) : (
                  groupedQuestions.map((group) => (
                    <div key={group.code} className="mb-4">
                      {/* Group header */}
                      <div className="flex items-center justify-between px-2 py-1.5 mb-1">
                        <div className="flex items-center gap-2">
                          <Badge variant="outline" className="text-xs">
                            {group.code}
                          </Badge>
                          <span className="text-xs text-muted-foreground">
                            {group.answeredCount}/{group.totalCount}
                          </span>
                        </div>
                        <Progress
                          value={
                            group.totalCount > 0
                              ? (group.answeredCount / group.totalCount) * 100
                              : 0
                          }
                          className="w-16 h-1.5"
                        />
                      </div>

                      {/* Questions in group */}
                      <div className="space-y-0.5">
                        {group.questions.map((question) => {
                          const status = getQuestionStatus(question);
                          const isActive = currentQuestion?.id === question.id;
                          const globalIndex = filteredQuestions.findIndex(
                            (q) => q.id === question.id
                          );

                          return (
                            <button
                              key={question.id}
                              onClick={() => goToQuestionById(question.id)}
                              className={cn(
                                "flex w-full items-center gap-2 rounded-md px-2 py-1.5 text-left text-sm transition-colors",
                                isActive
                                  ? "bg-primary text-primary-foreground"
                                  : "hover:bg-muted"
                              )}
                            >
                              {/* Status indicator */}
                              <span className="shrink-0">
                                {status === "complete" && (
                                  <CheckCircle
                                    className={cn(
                                      "h-4 w-4",
                                      isActive
                                        ? "text-primary-foreground"
                                        : "text-green-600"
                                    )}
                                  />
                                )}
                                {status === "answered" && (
                                  <Circle
                                    className={cn(
                                      "h-4 w-4 fill-current",
                                      isActive
                                        ? "text-primary-foreground"
                                        : "text-blue-600"
                                    )}
                                  />
                                )}
                                {status === "flagged" && (
                                  <Flag
                                    className={cn(
                                      "h-4 w-4",
                                      isActive
                                        ? "text-primary-foreground"
                                        : "text-yellow-600"
                                    )}
                                  />
                                )}
                                {status === "unanswered" && (
                                  <Circle
                                    className={cn(
                                      "h-4 w-4",
                                      isActive
                                        ? "text-primary-foreground"
                                        : "text-muted-foreground"
                                    )}
                                  />
                                )}
                              </span>

                              {/* Question number */}
                              <span className="font-mono text-xs shrink-0">
                                {question.pqNumber || `Q${globalIndex + 1}`}
                              </span>

                              {/* Priority indicator */}
                              {question.isPriorityPQ && (
                                <AlertTriangle
                                  className={cn(
                                    "h-3 w-3 shrink-0",
                                    isActive
                                      ? "text-primary-foreground"
                                      : "text-orange-500"
                                  )}
                                />
                              )}

                              {/* Question text preview */}
                              <span className="truncate flex-1 text-xs">
                                {locale === "fr"
                                  ? question.questionTextFr
                                  : question.questionTextEn}
                              </span>
                            </button>
                          );
                        })}
                      </div>
                    </div>
                  ))
                )}
              </div>
            </ScrollArea>

            {/* Footer with keyboard shortcuts hint */}
            <div className="border-t p-3 text-xs text-muted-foreground">
              <div className="flex flex-wrap gap-x-4 gap-y-1">
                <span>
                  <kbd className="px-1 py-0.5 rounded bg-muted font-mono">
                    {"\u2190"}
                  </kbd>{" "}
                  {t("shortcuts.prev")}
                </span>
                <span>
                  <kbd className="px-1 py-0.5 rounded bg-muted font-mono">
                    {"\u2192"}
                  </kbd>{" "}
                  {t("shortcuts.next")}
                </span>
                <span>
                  <kbd className="px-1 py-0.5 rounded bg-muted font-mono">F</kbd>{" "}
                  {t("shortcuts.flag")}
                </span>
              </div>
            </div>
          </motion.aside>
        )}
      </AnimatePresence>

      {/* Collapsed toggle button */}
      {!isSidebarOpen && (
        <Button
          variant="ghost"
          size="icon"
          onClick={toggleSidebar}
          className="absolute left-2 top-20 z-10 h-8 w-8 rounded-full border bg-background shadow-sm"
        >
          <ChevronRight className="h-4 w-4" />
        </Button>
      )}
    </>
  );
}

```

# src/components/features/assessment/question-response-panel.tsx

```tsx
"use client";

import { useMemo } from "react";
import { useLocale, useTranslations } from "next-intl";
import { motion, AnimatePresence } from "framer-motion";
import {
  ChevronLeft,
  ChevronRight,
  Flag,
  AlertTriangle,
  Info,
  Save,
  Loader2,
  CheckCircle2,
} from "lucide-react";
import { cn } from "@/lib/utils";
import { Button } from "@/components/ui/button";
import { Badge } from "@/components/ui/badge";
import {
  Card,
  CardContent,
  CardDescription,
  CardHeader,
  CardTitle,
} from "@/components/ui/card";
import {
  Tooltip,
  TooltipContent,
  TooltipProvider,
  TooltipTrigger,
} from "@/components/ui/tooltip";
import { useAssessmentWorkspace } from "./assessment-workspace-context";
import { ANSResponse } from "./response-types/ans-response";
import { SMSResponse } from "./response-types/sms-response";
import { CommentsSection } from "./comments-section";
import { EvidencePanel } from "./evidence-panel";

export function QuestionResponsePanel() {
  const locale = useLocale();
  const t = useTranslations("workspace");
  const {
    assessment,
    currentQuestion,
    currentQuestionIndex,
    filteredQuestions,
    responses,
    goToNextQuestion,
    goToPreviousQuestion,
    updateResponse,
    saveStatus,
    saveCurrentResponse,
  } = useAssessmentWorkspace();

  const isANS = assessment?.questionnaireType === "ANS_USOAP_CMA";
  const response = currentQuestion ? responses.get(currentQuestion.id) : null;

  const questionText = useMemo(() => {
    if (!currentQuestion) return "";
    return locale === "fr"
      ? currentQuestion.questionTextFr
      : currentQuestion.questionTextEn;
  }, [currentQuestion, locale]);

  const guidanceText = useMemo(() => {
    if (!currentQuestion) return "";
    return locale === "fr"
      ? currentQuestion.guidanceTextFr
      : currentQuestion.guidanceTextEn;
  }, [currentQuestion, locale]);

  if (!currentQuestion) {
    return (
      <div className="flex items-center justify-center h-full">
        <div className="text-center">
          <Info className="h-12 w-12 mx-auto text-muted-foreground mb-4" />
          <h3 className="text-lg font-medium">{t("panel.noQuestion")}</h3>
          <p className="text-muted-foreground">{t("panel.selectQuestion")}</p>
        </div>
      </div>
    );
  }

  return (
    <div className="flex flex-col h-full">
      {/* Header with navigation */}
      <div className="flex items-center justify-between border-b p-4 bg-background">
        <div className="flex items-center gap-2">
          <Button
            variant="outline"
            size="icon"
            onClick={goToPreviousQuestion}
            disabled={currentQuestionIndex === 0}
          >
            <ChevronLeft className="h-4 w-4" />
          </Button>
          <span className="text-sm text-muted-foreground">
            {t("panel.questionOf", {
              current: currentQuestionIndex + 1,
              total: filteredQuestions.length,
            })}
          </span>
          <Button
            variant="outline"
            size="icon"
            onClick={goToNextQuestion}
            disabled={currentQuestionIndex >= filteredQuestions.length - 1}
          >
            <ChevronRight className="h-4 w-4" />
          </Button>
        </div>

        <div className="flex items-center gap-2">
          {/* Save status */}
          <div className="flex items-center gap-1 text-sm">
            {saveStatus === "saving" && (
              <>
                <Loader2 className="h-4 w-4 animate-spin text-muted-foreground" />
                <span className="text-muted-foreground">{t("panel.saving")}</span>
              </>
            )}
            {saveStatus === "saved" && (
              <>
                <CheckCircle2 className="h-4 w-4 text-green-600" />
                <span className="text-green-600">{t("panel.saved")}</span>
              </>
            )}
            {saveStatus === "error" && (
              <>
                <AlertTriangle className="h-4 w-4 text-destructive" />
                <span className="text-destructive">{t("panel.saveError")}</span>
              </>
            )}
          </div>

          {/* Manual save button */}
          <Button
            variant="outline"
            size="sm"
            onClick={saveCurrentResponse}
            disabled={saveStatus === "saving"}
          >
            <Save className="h-4 w-4 mr-2" />
            {t("panel.save")}
          </Button>

          {/* Flag button */}
          <TooltipProvider>
            <Tooltip>
              <TooltipTrigger asChild>
                <Button
                  variant={response?.isFlagged ? "default" : "outline"}
                  size="icon"
                  onClick={() =>
                    updateResponse(currentQuestion.id, {
                      isFlagged: !response?.isFlagged,
                    })
                  }
                  className={cn(
                    response?.isFlagged && "bg-yellow-500 hover:bg-yellow-600"
                  )}
                >
                  <Flag className="h-4 w-4" />
                </Button>
              </TooltipTrigger>
              <TooltipContent>
                <p>{response?.isFlagged ? t("panel.unflag") : t("panel.flag")}</p>
              </TooltipContent>
            </Tooltip>
          </TooltipProvider>
        </div>
      </div>

      {/* Main content area - scrollable */}
      <div className="flex-1 overflow-y-auto p-6">
        <AnimatePresence mode="wait">
          <motion.div
            key={currentQuestion.id}
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            exit={{ opacity: 0, y: -20 }}
            transition={{ duration: 0.2 }}
            className="max-w-3xl mx-auto space-y-6"
          >
            {/* Question card */}
            <Card>
              <CardHeader>
                <div className="flex items-start justify-between gap-4">
                  <div className="space-y-1.5">
                    <div className="flex items-center gap-2 flex-wrap">
                      {/* Question number */}
                      <Badge variant="secondary" className="font-mono">
                        {currentQuestion.pqNumber ||
                          `Q${currentQuestionIndex + 1}`}
                      </Badge>

                      {/* Category badge */}
                      <Badge variant="outline">
                        {isANS
                          ? currentQuestion.auditArea
                          : currentQuestion.smsComponent}
                      </Badge>

                      {/* Priority indicator */}
                      {currentQuestion.isPriorityPQ && (
                        <Badge
                          variant="destructive"
                          className="flex items-center gap-1"
                        >
                          <AlertTriangle className="h-3 w-3" />
                          {t("panel.priority")}
                        </Badge>
                      )}

                      {/* Critical element for ANS */}
                      {isANS && currentQuestion.criticalElement && (
                        <Badge variant="outline" className="text-orange-600 border-orange-300">
                          CE: {currentQuestion.criticalElement}
                        </Badge>
                      )}
                    </div>
                    <CardTitle className="text-xl leading-relaxed">
                      {questionText}
                    </CardTitle>
                  </div>
                </div>
              </CardHeader>

              {/* Guidance text */}
              {guidanceText && (
                <CardContent>
                  <div className="bg-blue-50 border border-blue-200 rounded-lg p-4">
                    <div className="flex items-start gap-2">
                      <Info className="h-5 w-5 text-blue-600 shrink-0 mt-0.5" />
                      <div>
                        <p className="text-sm font-medium text-blue-800 mb-1">
                          {t("panel.guidance")}
                        </p>
                        <p className="text-sm text-blue-700 whitespace-pre-wrap">
                          {guidanceText}
                        </p>
                      </div>
                    </div>
                  </div>
                </CardContent>
              )}
            </Card>

            {/* Response section */}
            <Card>
              <CardHeader className="pb-3">
                <CardTitle className="text-base">{t("panel.yourResponse")}</CardTitle>
                <CardDescription>
                  {isANS ? t("panel.ansInstructions") : t("panel.smsInstructions")}
                </CardDescription>
              </CardHeader>
              <CardContent>
                {isANS ? (
                  <ANSResponse
                    value={response?.responseValue ?? null}
                    onChange={(value) =>
                      updateResponse(currentQuestion.id, { responseValue: value })
                    }
                  />
                ) : (
                  <SMSResponse
                    value={response?.maturityLevel ?? null}
                    onChange={(value) =>
                      updateResponse(currentQuestion.id, { maturityLevel: value })
                    }
                  />
                )}
              </CardContent>
            </Card>

            {/* Evidence section */}
            <EvidencePanel
              evidenceDescription={response?.evidenceDescription ?? ""}
              evidenceUrls={response?.evidenceUrls ?? []}
              onDescriptionChange={(value) =>
                updateResponse(currentQuestion.id, { evidenceDescription: value })
              }
              onUrlsChange={(urls) =>
                updateResponse(currentQuestion.id, { evidenceUrls: urls })
              }
            />

            {/* Comments section */}
            <Card>
              <CardHeader className="pb-3">
                <CardTitle className="text-base">{t("panel.notes")}</CardTitle>
              </CardHeader>
              <CardContent>
                <CommentsSection
                  assessorNotes={response?.assessorNotes ?? ""}
                  internalNotes={response?.internalNotes ?? ""}
                  onAssessorNotesChange={(value) =>
                    updateResponse(currentQuestion.id, { assessorNotes: value })
                  }
                  onInternalNotesChange={(value) =>
                    updateResponse(currentQuestion.id, { internalNotes: value })
                  }
                />
              </CardContent>
            </Card>
          </motion.div>
        </AnimatePresence>
      </div>

      {/* Footer with quick navigation */}
      <div className="border-t p-4 bg-background">
        <div className="flex items-center justify-between max-w-3xl mx-auto">
          <Button
            variant="outline"
            onClick={goToPreviousQuestion}
            disabled={currentQuestionIndex === 0}
          >
            <ChevronLeft className="h-4 w-4 mr-2" />
            {t("panel.previous")}
          </Button>

          <div className="text-sm text-muted-foreground">
            {t("panel.keyboardHint")}
          </div>

          <Button
            onClick={goToNextQuestion}
            disabled={currentQuestionIndex >= filteredQuestions.length - 1}
          >
            {t("panel.next")}
            <ChevronRight className="h-4 w-4 ml-2" />
          </Button>
        </div>
      </div>
    </div>
  );
}

```

# src/components/features/assessment/response-types/ans-response.tsx

```tsx
"use client";

import { useTranslations } from "next-intl";
import { motion } from "framer-motion";
import {
  CheckCircle2,
  XCircle,
  MinusCircle,
  HelpCircle,
} from "lucide-react";
import { cn } from "@/lib/utils";
import { Badge } from "@/components/ui/badge";
import type { ANSResponseValue } from "../assessment-workspace-context";

interface ANSResponseProps {
  value: ANSResponseValue | null;
  onChange: (value: ANSResponseValue) => void;
  disabled?: boolean;
}

interface ResponseOption {
  value: ANSResponseValue;
  label: string;
  description: string;
  icon: React.ElementType;
  color: string;
  bgColor: string;
  borderColor: string;
  hoverBg: string;
  selectedBg: string;
  selectedText: string;
  shortcut: string;
}

export function ANSResponse({ value, onChange, disabled }: ANSResponseProps) {
  const t = useTranslations("workspace.ansResponse");

  const options: ResponseOption[] = [
    {
      value: "SATISFACTORY",
      label: t("satisfactory"),
      description: t("satisfactoryDescription"),
      icon: CheckCircle2,
      color: "text-green-600",
      bgColor: "bg-green-50",
      borderColor: "border-green-200",
      hoverBg: "hover:bg-green-100",
      selectedBg: "bg-green-600",
      selectedText: "text-white",
      shortcut: "1",
    },
    {
      value: "NOT_SATISFACTORY",
      label: t("notSatisfactory"),
      description: t("notSatisfactoryDescription"),
      icon: XCircle,
      color: "text-red-600",
      bgColor: "bg-red-50",
      borderColor: "border-red-200",
      hoverBg: "hover:bg-red-100",
      selectedBg: "bg-red-600",
      selectedText: "text-white",
      shortcut: "2",
    },
    {
      value: "NOT_APPLICABLE",
      label: t("notApplicable"),
      description: t("notApplicableDescription"),
      icon: MinusCircle,
      color: "text-gray-600",
      bgColor: "bg-gray-50",
      borderColor: "border-gray-200",
      hoverBg: "hover:bg-gray-100",
      selectedBg: "bg-gray-600",
      selectedText: "text-white",
      shortcut: "3",
    },
    {
      value: "NOT_REVIEWED",
      label: t("notReviewed"),
      description: t("notReviewedDescription"),
      icon: HelpCircle,
      color: "text-yellow-600",
      bgColor: "bg-yellow-50",
      borderColor: "border-yellow-200",
      hoverBg: "hover:bg-yellow-100",
      selectedBg: "bg-yellow-600",
      selectedText: "text-white",
      shortcut: "4",
    },
  ];

  return (
    <div className="space-y-4">
      <div className="flex items-center justify-between">
        <h3 className="font-medium text-sm">{t("title")}</h3>
        <Badge variant="outline" className="text-xs">
          {t("protocol")}
        </Badge>
      </div>

      <div className="grid grid-cols-2 gap-3">
        {options.map((option) => {
          const isSelected = value === option.value;
          const Icon = option.icon;

          return (
            <motion.button
              key={option.value}
              type="button"
              onClick={() => onChange(option.value)}
              disabled={disabled}
              whileHover={{ scale: disabled ? 1 : 1.02 }}
              whileTap={{ scale: disabled ? 1 : 0.98 }}
              className={cn(
                "relative flex flex-col items-center justify-center gap-2 rounded-lg border-2 p-4 transition-all",
                "focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary",
                disabled && "cursor-not-allowed opacity-50",
                isSelected
                  ? cn(option.selectedBg, option.selectedText, "border-transparent shadow-lg")
                  : cn(
                      option.bgColor,
                      option.borderColor,
                      option.hoverBg,
                      "cursor-pointer"
                    )
              )}
            >
              {/* Keyboard shortcut badge */}
              <span
                className={cn(
                  "absolute right-2 top-2 flex h-5 w-5 items-center justify-center rounded text-xs font-mono",
                  isSelected
                    ? "bg-white/20 text-white"
                    : "bg-muted text-muted-foreground"
                )}
              >
                {option.shortcut}
              </span>

              <Icon
                className={cn(
                  "h-8 w-8",
                  isSelected ? "text-white" : option.color
                )}
              />

              <div className="text-center">
                <div className="font-semibold text-sm">{option.label}</div>
                <div
                  className={cn(
                    "text-xs mt-1",
                    isSelected ? "text-white/80" : "text-muted-foreground"
                  )}
                >
                  {option.description}
                </div>
              </div>

              {/* Selection indicator */}
              {isSelected && (
                <motion.div
                  layoutId="ans-selection"
                  className="absolute inset-0 rounded-lg border-2 border-white/50"
                  initial={false}
                  transition={{ type: "spring", duration: 0.3 }}
                />
              )}
            </motion.button>
          );
        })}
      </div>

      {/* Status message */}
      {value && value !== "NOT_REVIEWED" && (
        <motion.div
          initial={{ opacity: 0, y: -10 }}
          animate={{ opacity: 1, y: 0 }}
          className={cn(
            "text-sm text-center p-2 rounded-md",
            value === "SATISFACTORY" && "bg-green-50 text-green-700",
            value === "NOT_SATISFACTORY" && "bg-red-50 text-red-700",
            value === "NOT_APPLICABLE" && "bg-gray-50 text-gray-700"
          )}
        >
          {value === "SATISFACTORY" && t("satisfactoryMessage")}
          {value === "NOT_SATISFACTORY" && t("notSatisfactoryMessage")}
          {value === "NOT_APPLICABLE" && t("notApplicableMessage")}
        </motion.div>
      )}
    </div>
  );
}

```

# src/components/features/assessment/response-types/sms-response.tsx

```tsx
"use client";

import { useTranslations } from "next-intl";
import { motion } from "framer-motion";
import { cn } from "@/lib/utils";
import { Badge } from "@/components/ui/badge";
import type { SMSMaturityLevel } from "../assessment-workspace-context";

interface SMSResponseProps {
  value: SMSMaturityLevel | null;
  onChange: (value: SMSMaturityLevel) => void;
  disabled?: boolean;
}

interface MaturityOption {
  value: SMSMaturityLevel;
  label: string;
  description: string;
  color: string;
  bgColor: string;
  borderColor: string;
  hoverBg: string;
  selectedBg: string;
  selectedBorder: string;
  score: number;
}

export function SMSResponse({ value, onChange, disabled }: SMSResponseProps) {
  const t = useTranslations("workspace.smsResponse");

  const options: MaturityOption[] = [
    {
      value: "A",
      label: t("levelA"),
      description: t("levelADescription"),
      color: "text-red-700",
      bgColor: "bg-red-50",
      borderColor: "border-red-200",
      hoverBg: "hover:bg-red-100",
      selectedBg: "bg-red-600",
      selectedBorder: "border-red-600",
      score: 1,
    },
    {
      value: "B",
      label: t("levelB"),
      description: t("levelBDescription"),
      color: "text-orange-700",
      bgColor: "bg-orange-50",
      borderColor: "border-orange-200",
      hoverBg: "hover:bg-orange-100",
      selectedBg: "bg-orange-500",
      selectedBorder: "border-orange-500",
      score: 2,
    },
    {
      value: "C",
      label: t("levelC"),
      description: t("levelCDescription"),
      color: "text-yellow-700",
      bgColor: "bg-yellow-50",
      borderColor: "border-yellow-200",
      hoverBg: "hover:bg-yellow-100",
      selectedBg: "bg-yellow-500",
      selectedBorder: "border-yellow-500",
      score: 3,
    },
    {
      value: "D",
      label: t("levelD"),
      description: t("levelDDescription"),
      color: "text-blue-700",
      bgColor: "bg-blue-50",
      borderColor: "border-blue-200",
      hoverBg: "hover:bg-blue-100",
      selectedBg: "bg-blue-600",
      selectedBorder: "border-blue-600",
      score: 4,
    },
    {
      value: "E",
      label: t("levelE"),
      description: t("levelEDescription"),
      color: "text-green-700",
      bgColor: "bg-green-50",
      borderColor: "border-green-200",
      hoverBg: "hover:bg-green-100",
      selectedBg: "bg-green-600",
      selectedBorder: "border-green-600",
      score: 5,
    },
  ];

  return (
    <div className="space-y-4">
      <div className="flex items-center justify-between">
        <h3 className="font-medium text-sm">{t("title")}</h3>
        <Badge variant="outline" className="text-xs">
          {t("cansoSoE")}
        </Badge>
      </div>

      {/* Maturity scale visualization */}
      <div className="flex items-center gap-1 p-3 bg-muted/50 rounded-lg">
        <span className="text-xs text-muted-foreground mr-2">{t("maturityScale")}</span>
        {options.map((option, index) => (
          <div key={option.value} className="flex items-center">
            <div
              className={cn(
                "h-2 w-8 rounded-sm transition-all",
                value === option.value
                  ? option.selectedBg
                  : value && options.findIndex(o => o.value === value) > index
                  ? option.selectedBg + "/60"
                  : "bg-gray-200"
              )}
            />
            {index < options.length - 1 && <div className="h-px w-1 bg-gray-300" />}
          </div>
        ))}
      </div>

      {/* Maturity level options */}
      <div className="space-y-2">
        {options.map((option) => {
          const isSelected = value === option.value;

          return (
            <motion.button
              key={option.value}
              type="button"
              onClick={() => onChange(option.value)}
              disabled={disabled}
              whileHover={{ x: disabled ? 0 : 4 }}
              whileTap={{ scale: disabled ? 1 : 0.99 }}
              className={cn(
                "relative w-full flex items-start gap-4 rounded-lg border-2 p-4 text-left transition-all",
                "focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary",
                disabled && "cursor-not-allowed opacity-50",
                isSelected
                  ? cn("border-transparent shadow-md", option.selectedBg, "text-white")
                  : cn(
                      option.bgColor,
                      option.borderColor,
                      option.hoverBg,
                      "cursor-pointer"
                    )
              )}
            >
              {/* Level indicator */}
              <div
                className={cn(
                  "flex h-10 w-10 shrink-0 items-center justify-center rounded-full font-bold text-lg",
                  isSelected
                    ? "bg-white/20 text-white"
                    : cn("bg-white", option.color)
                )}
              >
                {option.value}
              </div>

              {/* Content */}
              <div className="flex-1 min-w-0">
                <div className="flex items-center gap-2">
                  <span className="font-semibold">{option.label}</span>
                  <span
                    className={cn(
                      "text-xs px-2 py-0.5 rounded-full",
                      isSelected
                        ? "bg-white/20 text-white"
                        : "bg-white text-muted-foreground"
                    )}
                  >
                    {t("score", { score: option.score })}
                  </span>
                </div>
                <p
                  className={cn(
                    "text-sm mt-1",
                    isSelected ? "text-white/90" : "text-muted-foreground"
                  )}
                >
                  {option.description}
                </p>
              </div>

              {/* Keyboard shortcut */}
              <span
                className={cn(
                  "absolute right-3 top-3 flex h-6 w-6 items-center justify-center rounded text-xs font-mono",
                  isSelected
                    ? "bg-white/20 text-white"
                    : "bg-muted text-muted-foreground"
                )}
              >
                {option.value}
              </span>

              {/* Selection indicator */}
              {isSelected && (
                <motion.div
                  initial={{ scale: 0 }}
                  animate={{ scale: 1 }}
                  className="absolute right-3 bottom-3"
                >
                  <svg
                    className="h-5 w-5 text-white"
                    fill="currentColor"
                    viewBox="0 0 20 20"
                  >
                    <path
                      fillRule="evenodd"
                      d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                      clipRule="evenodd"
                    />
                  </svg>
                </motion.div>
              )}
            </motion.button>
          );
        })}
      </div>

      {/* Current selection summary */}
      {value && (
        <motion.div
          initial={{ opacity: 0, y: -10 }}
          animate={{ opacity: 1, y: 0 }}
          className="flex items-center justify-between p-3 bg-muted rounded-lg"
        >
          <span className="text-sm text-muted-foreground">
            {t("selectedLevel")}
          </span>
          <div className="flex items-center gap-2">
            <span className={cn("font-semibold", options.find(o => o.value === value)?.color)}>
              {t("level")} {value}
            </span>
            <span className="text-sm text-muted-foreground">
              ({options.find(o => o.value === value)?.label})
            </span>
          </div>
        </motion.div>
      )}
    </div>
  );
}

```

# src/components/features/assessment/wizard-steps/assessment-details-step.tsx

```tsx
"use client";

import { useEffect } from "react";
import { useTranslations } from "next-intl";
import { motion } from "framer-motion";
import { format } from "date-fns";
import { Calendar, Info, RefreshCw } from "lucide-react";
import { cn } from "@/lib/utils";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Checkbox } from "@/components/ui/checkbox";
import { Button } from "@/components/ui/button";
import {
  Card,
  CardContent,
  CardDescription,
  CardHeader,
  CardTitle,
} from "@/components/ui/card";
import type { QuestionnaireType, AssessmentType } from "@prisma/client";

// Audit areas for ANS USOAP CMA
const ANS_AUDIT_AREAS = [
  "LEG",
  "ORG",
  "PEL",
  "OPS",
  "AIR",
  "AIG",
  "ANS",
  "AGA",
  "SSP",
] as const;

// SMS Components for CANSO SoE
const SMS_COMPONENTS = [
  "SAFETY_POLICY_OBJECTIVES",
  "SAFETY_RISK_MANAGEMENT",
  "SAFETY_ASSURANCE",
  "SAFETY_PROMOTION",
] as const;

interface AssessmentDetailsStepProps {
  questionnaireType: QuestionnaireType | null;
  assessmentType: AssessmentType | null;
  title: string;
  description: string;
  dueDate: Date | null;
  selectedAreas: string[];
  onTitleChange: (title: string) => void;
  onDescriptionChange: (description: string) => void;
  onDueDateChange: (date: Date | null) => void;
  onSelectedAreasChange: (areas: string[]) => void;
}

function generateDefaultTitle(
  questionnaireType: QuestionnaireType | null,
  assessmentType: AssessmentType | null,
  t: (key: string) => string
): string {
  if (!questionnaireType || !assessmentType) return "";

  const qType = questionnaireType === "ANS_USOAP_CMA" ? "ANS" : "SMS";
  const aType = t(`assessmentType.types.${assessmentType.toLowerCase()}.short`);
  const date = format(new Date(), "yyyy-MM");

  return `${qType} ${aType} - ${date}`;
}

export function AssessmentDetailsStep({
  questionnaireType,
  assessmentType,
  title,
  description,
  dueDate,
  selectedAreas,
  onTitleChange,
  onDescriptionChange,
  onDueDateChange,
  onSelectedAreasChange,
}: AssessmentDetailsStepProps) {
  const t = useTranslations("wizard");
  const tAudit = useTranslations("auditAreas");
  const tSms = useTranslations("smsComponents");

  const isANS = questionnaireType === "ANS_USOAP_CMA";
  const areas = isANS ? ANS_AUDIT_AREAS : SMS_COMPONENTS;

  // Auto-generate title on mount if empty
  useEffect(() => {
    if (!title && questionnaireType && assessmentType) {
      onTitleChange(generateDefaultTitle(questionnaireType, assessmentType, t));
    }
  }, [title, questionnaireType, assessmentType, onTitleChange, t]);

  // Handle select all / deselect all
  const handleSelectAll = () => {
    if (selectedAreas.length === areas.length) {
      onSelectedAreasChange([]);
    } else {
      onSelectedAreasChange([...areas]);
    }
  };

  // Handle individual area toggle
  const handleAreaToggle = (area: string) => {
    if (selectedAreas.includes(area)) {
      onSelectedAreasChange(selectedAreas.filter((a) => a !== area));
    } else {
      onSelectedAreasChange([...selectedAreas, area]);
    }
  };

  // Regenerate title
  const handleRegenerateTitle = () => {
    onTitleChange(generateDefaultTitle(questionnaireType, assessmentType, t));
  };

  return (
    <div className="space-y-6">
      <div className="text-center">
        <h2 className="text-2xl font-bold tracking-tight">
          {t("details.title")}
        </h2>
        <p className="mt-2 text-muted-foreground">{t("details.description")}</p>
      </div>

      <motion.div
        initial={{ opacity: 0, y: 20 }}
        animate={{ opacity: 1, y: 0 }}
        className="space-y-6"
      >
        {/* Title field */}
        <div className="space-y-2">
          <Label htmlFor="title" className="text-sm font-medium">
            {t("details.titleLabel")} <span className="text-destructive">*</span>
          </Label>
          <div className="flex gap-2">
            <Input
              id="title"
              value={title}
              onChange={(e) => onTitleChange(e.target.value)}
              placeholder={t("details.titlePlaceholder")}
              className="flex-1"
            />
            <Button
              type="button"
              variant="outline"
              size="icon"
              onClick={handleRegenerateTitle}
              title={t("details.regenerateTitle")}
            >
              <RefreshCw className="h-4 w-4" />
            </Button>
          </div>
          <p className="text-xs text-muted-foreground">
            {t("details.titleHint")}
          </p>
        </div>

        {/* Description field */}
        <div className="space-y-2">
          <Label htmlFor="description" className="text-sm font-medium">
            {t("details.descriptionLabel")}
          </Label>
          <textarea
            id="description"
            value={description}
            onChange={(e) => onDescriptionChange(e.target.value)}
            placeholder={t("details.descriptionPlaceholder")}
            rows={3}
            className={cn(
              "flex w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-xs placeholder:text-muted-foreground",
              "focus-visible:outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]",
              "disabled:cursor-not-allowed disabled:opacity-50",
              "dark:bg-input/30"
            )}
          />
        </div>

        {/* Due date field */}
        <div className="space-y-2">
          <Label htmlFor="dueDate" className="text-sm font-medium">
            {t("details.dueDateLabel")}
          </Label>
          <div className="relative">
            <Calendar className="absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground" />
            <Input
              id="dueDate"
              type="date"
              value={dueDate ? format(dueDate, "yyyy-MM-dd") : ""}
              onChange={(e) =>
                onDueDateChange(e.target.value ? new Date(e.target.value) : null)
              }
              min={format(new Date(), "yyyy-MM-dd")}
              className="pl-10"
            />
          </div>
          <p className="text-xs text-muted-foreground">
            {t("details.dueDateHint")}
          </p>
        </div>

        {/* Scope selection */}
        <Card>
          <CardHeader className="pb-3">
            <div className="flex items-center justify-between">
              <div>
                <CardTitle className="text-base">
                  {isANS
                    ? t("details.scope.ansTitle")
                    : t("details.scope.smsTitle")}
                </CardTitle>
                <CardDescription className="mt-1">
                  {isANS
                    ? t("details.scope.ansDescription")
                    : t("details.scope.smsDescription")}
                </CardDescription>
              </div>
              <Button
                type="button"
                variant="outline"
                size="sm"
                onClick={handleSelectAll}
              >
                {selectedAreas.length === areas.length
                  ? t("details.scope.deselectAll")
                  : t("details.scope.selectAll")}
              </Button>
            </div>
          </CardHeader>
          <CardContent>
            <div
              className={cn(
                "grid gap-3",
                isANS ? "sm:grid-cols-3" : "sm:grid-cols-2"
              )}
            >
              {areas.map((area, index) => {
                const isSelected = selectedAreas.includes(area);
                const name = isANS
                  ? tAudit(`${area}.name`)
                  : tSms(`${area}.name`);
                const code = isANS ? area : tSms(`${area}.code`);

                return (
                  <motion.div
                    key={area}
                    initial={{ opacity: 0, scale: 0.95 }}
                    animate={{ opacity: 1, scale: 1 }}
                    transition={{ delay: index * 0.03 }}
                  >
                    <label
                      className={cn(
                        "flex items-start gap-3 rounded-lg border p-3 cursor-pointer transition-colors",
                        isSelected
                          ? "border-primary bg-primary/5"
                          : "border-border hover:border-primary/50 hover:bg-muted/50"
                      )}
                    >
                      <Checkbox
                        checked={isSelected}
                        onCheckedChange={() => handleAreaToggle(area)}
                        className="mt-0.5"
                      />
                      <div className="flex-1 min-w-0">
                        <div className="flex items-center gap-2">
                          <span className="text-xs font-mono text-muted-foreground">
                            {code}
                          </span>
                        </div>
                        <span className="text-sm font-medium line-clamp-1">
                          {name}
                        </span>
                      </div>
                    </label>
                  </motion.div>
                );
              })}
            </div>

            {/* Selection summary */}
            <div className="mt-4 flex items-center gap-2 text-sm text-muted-foreground">
              <Info className="h-4 w-4" />
              <span>
                {selectedAreas.length === 0
                  ? t("details.scope.noneSelected")
                  : selectedAreas.length === areas.length
                  ? t("details.scope.allSelected")
                  : t("details.scope.someSelected", {
                      count: selectedAreas.length,
                      total: areas.length,
                    })}
              </span>
            </div>
          </CardContent>
        </Card>
      </motion.div>
    </div>
  );
}

```

# src/components/features/assessment/wizard-steps/assessment-type-step.tsx

```tsx
"use client";

import { useTranslations } from "next-intl";
import { motion } from "framer-motion";
import {
  ClipboardList,
  Search,
  Users,
  RefreshCw,
  CheckCircle,
} from "lucide-react";
import { cn } from "@/lib/utils";
import { Card, CardContent } from "@/components/ui/card";
import { Badge } from "@/components/ui/badge";
import type { AssessmentType } from "@prisma/client";

interface AssessmentTypeStepProps {
  value: AssessmentType | null;
  onChange: (value: AssessmentType) => void;
}

interface AssessmentOption {
  type: AssessmentType;
  icon: typeof ClipboardList;
  color: string;
  bgColor: string;
  borderColor: string;
  recommended?: boolean;
}

const assessmentOptions: AssessmentOption[] = [
  {
    type: "SELF_ASSESSMENT",
    icon: ClipboardList,
    color: "text-blue-600 dark:text-blue-400",
    bgColor: "bg-blue-50 dark:bg-blue-950/30",
    borderColor: "border-blue-200 dark:border-blue-800",
    recommended: true,
  },
  {
    type: "GAP_ANALYSIS",
    icon: Search,
    color: "text-amber-600 dark:text-amber-400",
    bgColor: "bg-amber-50 dark:bg-amber-950/30",
    borderColor: "border-amber-200 dark:border-amber-800",
  },
  {
    type: "PEER_REVIEW",
    icon: Users,
    color: "text-purple-600 dark:text-purple-400",
    bgColor: "bg-purple-50 dark:bg-purple-950/30",
    borderColor: "border-purple-200 dark:border-purple-800",
  },
  {
    type: "FOLLOW_UP",
    icon: RefreshCw,
    color: "text-green-600 dark:text-green-400",
    bgColor: "bg-green-50 dark:bg-green-950/30",
    borderColor: "border-green-200 dark:border-green-800",
  },
];

export function AssessmentTypeStep({
  value,
  onChange,
}: AssessmentTypeStepProps) {
  const t = useTranslations("wizard");

  return (
    <div className="space-y-6">
      <div className="text-center">
        <h2 className="text-2xl font-bold tracking-tight">
          {t("assessmentType.title")}
        </h2>
        <p className="mt-2 text-muted-foreground">
          {t("assessmentType.description")}
        </p>
      </div>

      <div className="grid gap-4 sm:grid-cols-2">
        {assessmentOptions.map((option, index) => {
          const Icon = option.icon;
          const isSelected = value === option.type;
          const typeKey = option.type.toLowerCase();

          return (
            <motion.div
              key={option.type}
              initial={{ opacity: 0, y: 20 }}
              animate={{ opacity: 1, y: 0 }}
              transition={{ delay: index * 0.05 }}
            >
              <Card
                className={cn(
                  "relative cursor-pointer transition-all duration-200 hover:shadow-md h-full",
                  isSelected
                    ? `ring-2 ring-primary shadow-md ${option.bgColor}`
                    : "hover:border-primary/50"
                )}
                onClick={() => onChange(option.type)}
              >
                {/* Selection indicator */}
                {isSelected && (
                  <motion.div
                    initial={{ scale: 0 }}
                    animate={{ scale: 1 }}
                    className="absolute -right-2 -top-2 rounded-full bg-primary p-1 text-primary-foreground shadow-lg"
                  >
                    <CheckCircle className="h-4 w-4" />
                  </motion.div>
                )}

                {/* Recommended badge */}
                {option.recommended && (
                  <div className="absolute -top-2.5 left-3">
                    <Badge
                      variant="secondary"
                      className="text-xs shadow-sm"
                    >
                      {t("common.recommended")}
                    </Badge>
                  </div>
                )}

                <CardContent className={cn("p-5", option.recommended && "pt-6")}>
                  <div className="flex items-start gap-4">
                    <div
                      className={cn(
                        "flex h-10 w-10 shrink-0 items-center justify-center rounded-lg",
                        option.bgColor,
                        option.borderColor,
                        "border"
                      )}
                    >
                      <Icon className={cn("h-5 w-5", option.color)} />
                    </div>
                    <div className="flex-1 min-w-0">
                      <h3 className="font-semibold">
                        {t(`assessmentType.types.${typeKey}.title`)}
                      </h3>
                      <p className="mt-1 text-sm text-muted-foreground line-clamp-2">
                        {t(`assessmentType.types.${typeKey}.description`)}
                      </p>
                    </div>
                  </div>

                  {/* Purpose callout */}
                  <div
                    className={cn(
                      "mt-4 rounded-lg border p-2.5",
                      option.bgColor,
                      option.borderColor
                    )}
                  >
                    <p className="text-xs text-muted-foreground">
                      <span className="font-medium">
                        {t("assessmentType.bestFor")}:
                      </span>{" "}
                      {t(`assessmentType.types.${typeKey}.bestFor`)}
                    </p>
                  </div>
                </CardContent>
              </Card>
            </motion.div>
          );
        })}
      </div>
    </div>
  );
}

```

# src/components/features/assessment/wizard-steps/questionnaire-type-step.tsx

```tsx
"use client";

import { useTranslations } from "next-intl";
import { motion } from "framer-motion";
import { ClipboardCheck, Shield, CheckCircle, Sparkles } from "lucide-react";
import { cn } from "@/lib/utils";
import { Card, CardContent } from "@/components/ui/card";
import { Badge } from "@/components/ui/badge";
import type { QuestionnaireType } from "@prisma/client";

interface QuestionnaireTypeStepProps {
  value: QuestionnaireType | null;
  onChange: (value: QuestionnaireType) => void;
}

interface QuestionnaireOption {
  type: QuestionnaireType;
  icon: typeof ClipboardCheck;
  color: string;
  bgColor: string;
  borderColor: string;
  recommended?: boolean;
}

const questionnaireOptions: QuestionnaireOption[] = [
  {
    type: "ANS_USOAP_CMA",
    icon: ClipboardCheck,
    color: "text-blue-600 dark:text-blue-400",
    bgColor: "bg-blue-50 dark:bg-blue-950/30",
    borderColor: "border-blue-200 dark:border-blue-800",
    recommended: true,
  },
  {
    type: "SMS_CANSO_SOE",
    icon: Shield,
    color: "text-green-600 dark:text-green-400",
    bgColor: "bg-green-50 dark:bg-green-950/30",
    borderColor: "border-green-200 dark:border-green-800",
  },
];

export function QuestionnaireTypeStep({
  value,
  onChange,
}: QuestionnaireTypeStepProps) {
  const t = useTranslations("wizard");

  return (
    <div className="space-y-6">
      <div className="text-center">
        <h2 className="text-2xl font-bold tracking-tight">
          {t("questionnaireType.title")}
        </h2>
        <p className="mt-2 text-muted-foreground">
          {t("questionnaireType.description")}
        </p>
      </div>

      <div className="grid gap-6 md:grid-cols-2">
        {questionnaireOptions.map((option, index) => {
          const Icon = option.icon;
          const isSelected = value === option.type;
          const isANS = option.type === "ANS_USOAP_CMA";

          return (
            <motion.div
              key={option.type}
              initial={{ opacity: 0, y: 20 }}
              animate={{ opacity: 1, y: 0 }}
              transition={{ delay: index * 0.1 }}
            >
              <Card
                className={cn(
                  "relative cursor-pointer transition-all duration-200 hover:shadow-md",
                  isSelected
                    ? `ring-2 ring-primary shadow-md ${option.bgColor}`
                    : "hover:border-primary/50"
                )}
                onClick={() => onChange(option.type)}
              >
                {/* Selection indicator */}
                {isSelected && (
                  <motion.div
                    initial={{ scale: 0 }}
                    animate={{ scale: 1 }}
                    className="absolute -right-2 -top-2 rounded-full bg-primary p-1 text-primary-foreground shadow-lg"
                  >
                    <CheckCircle className="h-5 w-5" />
                  </motion.div>
                )}

                {/* Recommended badge */}
                {option.recommended && (
                  <div className="absolute -top-3 left-4">
                    <Badge className="bg-primary text-primary-foreground shadow-sm">
                      <Sparkles className="mr-1 h-3 w-3" />
                      {t("common.recommended")}
                    </Badge>
                  </div>
                )}

                <CardContent className="p-6 pt-8">
                  {/* Icon and title */}
                  <div className="flex items-start gap-4">
                    <div
                      className={cn(
                        "flex h-12 w-12 shrink-0 items-center justify-center rounded-lg",
                        option.bgColor,
                        option.borderColor,
                        "border"
                      )}
                    >
                      <Icon className={cn("h-6 w-6", option.color)} />
                    </div>
                    <div className="flex-1">
                      <h3 className="font-semibold text-lg">
                        {isANS
                          ? t("questionnaireType.ans.title")
                          : t("questionnaireType.sms.title")}
                      </h3>
                      <p className="mt-1 text-sm text-muted-foreground">
                        {isANS
                          ? t("questionnaireType.ans.subtitle")
                          : t("questionnaireType.sms.subtitle")}
                      </p>
                    </div>
                  </div>

                  {/* Description */}
                  <p className="mt-4 text-sm text-muted-foreground">
                    {isANS
                      ? t("questionnaireType.ans.description")
                      : t("questionnaireType.sms.description")}
                  </p>

                  {/* Features list */}
                  <ul className="mt-4 space-y-2">
                    {(isANS
                      ? [
                          { label: t("questionnaireType.ans.feature1"), value: "851" },
                          { label: t("questionnaireType.ans.feature2"), value: "9" },
                          { label: t("questionnaireType.ans.feature3"), value: "8" },
                        ]
                      : [
                          { label: t("questionnaireType.sms.feature1"), value: "A-E" },
                          { label: t("questionnaireType.sms.feature2"), value: "4" },
                          { label: t("questionnaireType.sms.feature3"), value: "12" },
                        ]
                    ).map((feature, idx) => (
                      <li key={idx} className="flex items-center gap-2 text-sm">
                        <CheckCircle
                          className={cn("h-4 w-4 shrink-0", option.color)}
                        />
                        <span className="text-muted-foreground">
                          {feature.label}:{" "}
                          <span className="font-medium text-foreground">
                            {feature.value}
                          </span>
                        </span>
                      </li>
                    ))}
                  </ul>

                  {/* Key difference callout */}
                  <div
                    className={cn(
                      "mt-4 rounded-lg border p-3",
                      option.bgColor,
                      option.borderColor
                    )}
                  >
                    <p className="text-xs font-medium text-muted-foreground">
                      {isANS
                        ? t("questionnaireType.ans.keyDifference")
                        : t("questionnaireType.sms.keyDifference")}
                    </p>
                  </div>
                </CardContent>
              </Card>
            </motion.div>
          );
        })}
      </div>

      {/* Help text */}
      <div className="text-center">
        <p className="text-sm text-muted-foreground">
          {t("questionnaireType.helpText")}
        </p>
      </div>
    </div>
  );
}

```

# src/components/features/assessment/wizard-steps/review-confirm-step.tsx

```tsx
"use client";

import { useTranslations } from "next-intl";
import { motion } from "framer-motion";
import { format } from "date-fns";
import {
  ClipboardCheck,
  Shield,
  Calendar,
  Clock,
  CheckCircle,
  Lightbulb,
  AlertCircle,
} from "lucide-react";
import { cn } from "@/lib/utils";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Badge } from "@/components/ui/badge";
import { Checkbox } from "@/components/ui/checkbox";
import { Label } from "@/components/ui/label";
import { Separator } from "@/components/ui/separator";
import type { QuestionnaireType, AssessmentType } from "@prisma/client";

interface ReviewConfirmStepProps {
  questionnaireType: QuestionnaireType | null;
  assessmentType: AssessmentType | null;
  title: string;
  description: string;
  dueDate: Date | null;
  selectedAreas: string[];
  confirmed: boolean;
  onConfirmedChange: (confirmed: boolean) => void;
  isSubmitting?: boolean;
}

// Estimated questions per area
const QUESTIONS_PER_ANS_AREA: Record<string, number> = {
  LEG: 45,
  ORG: 52,
  PEL: 89,
  OPS: 156,
  AIR: 134,
  AIG: 67,
  ANS: 145,
  AGA: 98,
  SSP: 65,
};

const QUESTIONS_PER_SMS_COMPONENT: Record<string, number> = {
  SAFETY_POLICY_OBJECTIVES: 25,
  SAFETY_RISK_MANAGEMENT: 35,
  SAFETY_ASSURANCE: 30,
  SAFETY_PROMOTION: 15,
};

export function ReviewConfirmStep({
  questionnaireType,
  assessmentType,
  title,
  description,
  dueDate,
  selectedAreas,
  confirmed,
  onConfirmedChange,
  isSubmitting,
}: ReviewConfirmStepProps) {
  const t = useTranslations("wizard");
  const tAudit = useTranslations("auditAreas");
  const tSms = useTranslations("smsComponents");

  const isANS = questionnaireType === "ANS_USOAP_CMA";

  // Calculate estimated questions
  const questionsMap = isANS
    ? QUESTIONS_PER_ANS_AREA
    : QUESTIONS_PER_SMS_COMPONENT;
  const estimatedQuestions = selectedAreas.reduce(
    (total, area) => total + (questionsMap[area] || 0),
    0
  );

  // Estimate time (5 minutes per question average)
  const estimatedMinutes = estimatedQuestions * 5;
  const estimatedHours = Math.ceil(estimatedMinutes / 60);

  // Tips for success
  const tips = [
    t("review.tips.gather"),
    t("review.tips.collaborate"),
    t("review.tips.evidence"),
    t("review.tips.honest"),
  ];

  return (
    <div className="space-y-6">
      <div className="text-center">
        <h2 className="text-2xl font-bold tracking-tight">
          {t("review.title")}
        </h2>
        <p className="mt-2 text-muted-foreground">{t("review.description")}</p>
      </div>

      <motion.div
        initial={{ opacity: 0, y: 20 }}
        animate={{ opacity: 1, y: 0 }}
        className="space-y-6"
      >
        {/* Summary card */}
        <Card>
          <CardHeader>
            <CardTitle className="flex items-center gap-2">
              {isANS ? (
                <ClipboardCheck className="h-5 w-5 text-blue-600" />
              ) : (
                <Shield className="h-5 w-5 text-green-600" />
              )}
              {t("review.summaryTitle")}
            </CardTitle>
          </CardHeader>
          <CardContent className="space-y-4">
            {/* Assessment title */}
            <div>
              <div className="text-sm text-muted-foreground">
                {t("review.assessmentTitle")}
              </div>
              <div className="font-medium">{title}</div>
            </div>

            {/* Type badges */}
            <div className="flex flex-wrap gap-2">
              <Badge
                variant="outline"
                className={cn(
                  isANS
                    ? "border-blue-200 bg-blue-50 text-blue-700 dark:border-blue-800 dark:bg-blue-950/30 dark:text-blue-400"
                    : "border-green-200 bg-green-50 text-green-700 dark:border-green-800 dark:bg-green-950/30 dark:text-green-400"
                )}
              >
                {isANS
                  ? t("questionnaireType.ans.title")
                  : t("questionnaireType.sms.title")}
              </Badge>
              {assessmentType && (
                <Badge variant="secondary">
                  {t(`assessmentType.types.${assessmentType.toLowerCase()}.title`)}
                </Badge>
              )}
            </div>

            {/* Description */}
            {description && (
              <div>
                <div className="text-sm text-muted-foreground">
                  {t("review.descriptionLabel")}
                </div>
                <div className="text-sm">{description}</div>
              </div>
            )}

            <Separator />

            {/* Scope */}
            <div>
              <div className="text-sm text-muted-foreground mb-2">
                {isANS ? t("review.auditAreas") : t("review.smsComponents")}
              </div>
              <div className="flex flex-wrap gap-1.5">
                {selectedAreas.map((area) => {
                  const name = isANS ? tAudit(`${area}.name`) : tSms(`${area}.name`);
                  const code = isANS ? area : tSms(`${area}.code`);
                  return (
                    <Badge key={area} variant="outline" className="text-xs">
                      {code}: {name}
                    </Badge>
                  );
                })}
              </div>
            </div>

            <Separator />

            {/* Stats */}
            <div className="grid gap-4 sm:grid-cols-3">
              {/* Questions */}
              <div className="flex items-center gap-3">
                <div className="flex h-10 w-10 items-center justify-center rounded-lg bg-muted">
                  <ClipboardCheck className="h-5 w-5 text-muted-foreground" />
                </div>
                <div>
                  <div className="text-2xl font-bold">{estimatedQuestions}</div>
                  <div className="text-xs text-muted-foreground">
                    {t("review.estimatedQuestions")}
                  </div>
                </div>
              </div>

              {/* Time */}
              <div className="flex items-center gap-3">
                <div className="flex h-10 w-10 items-center justify-center rounded-lg bg-muted">
                  <Clock className="h-5 w-5 text-muted-foreground" />
                </div>
                <div>
                  <div className="text-2xl font-bold">
                    {estimatedHours}
                    <span className="text-sm font-normal text-muted-foreground ml-1">
                      {t("review.hours")}
                    </span>
                  </div>
                  <div className="text-xs text-muted-foreground">
                    {t("review.estimatedTime")}
                  </div>
                </div>
              </div>

              {/* Due date */}
              <div className="flex items-center gap-3">
                <div className="flex h-10 w-10 items-center justify-center rounded-lg bg-muted">
                  <Calendar className="h-5 w-5 text-muted-foreground" />
                </div>
                <div>
                  <div className="text-lg font-semibold">
                    {dueDate ? format(dueDate, "MMM d, yyyy") : t("review.noDueDate")}
                  </div>
                  <div className="text-xs text-muted-foreground">
                    {t("review.targetDate")}
                  </div>
                </div>
              </div>
            </div>
          </CardContent>
        </Card>

        {/* Tips for success */}
        <Card className="border-amber-200 bg-amber-50/50 dark:border-amber-800 dark:bg-amber-950/20">
          <CardHeader className="pb-3">
            <CardTitle className="flex items-center gap-2 text-base">
              <Lightbulb className="h-5 w-5 text-amber-600" />
              {t("review.tipsTitle")}
            </CardTitle>
          </CardHeader>
          <CardContent>
            <ul className="space-y-2">
              {tips.map((tip, index) => (
                <li key={index} className="flex items-start gap-2 text-sm">
                  <CheckCircle className="h-4 w-4 shrink-0 text-amber-600 mt-0.5" />
                  <span>{tip}</span>
                </li>
              ))}
            </ul>
          </CardContent>
        </Card>

        {/* Confirmation checkbox */}
        <Card
          className={cn(
            "transition-colors",
            confirmed
              ? "border-green-200 bg-green-50/50 dark:border-green-800 dark:bg-green-950/20"
              : ""
          )}
        >
          <CardContent className="pt-6">
            <label className="flex items-start gap-3 cursor-pointer">
              <Checkbox
                id="confirm"
                checked={confirmed}
                onCheckedChange={(checked) => onConfirmedChange(checked === true)}
                disabled={isSubmitting}
                className="mt-0.5"
              />
              <div className="flex-1">
                <Label
                  htmlFor="confirm"
                  className="text-sm font-medium cursor-pointer"
                >
                  {t("review.confirmLabel")}
                </Label>
                <p className="mt-1 text-sm text-muted-foreground">
                  {t("review.confirmDescription")}
                </p>
              </div>
            </label>
          </CardContent>
        </Card>

        {/* Warning if not confirmed */}
        {!confirmed && (
          <motion.div
            initial={{ opacity: 0, height: 0 }}
            animate={{ opacity: 1, height: "auto" }}
            exit={{ opacity: 0, height: 0 }}
            className="flex items-center gap-2 text-sm text-amber-600 dark:text-amber-400"
          >
            <AlertCircle className="h-4 w-4" />
            <span>{t("review.confirmRequired")}</span>
          </motion.div>
        )}
      </motion.div>
    </div>
  );
}

```

# src/components/features/assessment/wizard-steps/wizard-stepper.tsx

```tsx
"use client";

import { cn } from "@/lib/utils";
import { Check } from "lucide-react";
import { motion } from "framer-motion";

export interface WizardStep {
  title: string;
  description: string;
  isCompleted: boolean;
  isActive: boolean;
}

interface WizardStepperProps {
  currentStep: number;
  totalSteps: number;
  steps: WizardStep[];
}

export function WizardStepper({ currentStep, totalSteps, steps }: WizardStepperProps) {
  return (
    <nav aria-label="Progress" className="mb-8">
      <ol className="flex items-center justify-between">
        {steps.map((step, index) => (
          <li key={index} className="relative flex-1">
            <div className="flex flex-col items-center">
              {/* Step indicator */}
              <div className="relative flex items-center justify-center">
                {step.isCompleted ? (
                  <motion.div
                    initial={{ scale: 0.8 }}
                    animate={{ scale: 1 }}
                    className="flex h-10 w-10 items-center justify-center rounded-full bg-primary text-primary-foreground"
                  >
                    <Check className="h-5 w-5" />
                  </motion.div>
                ) : step.isActive ? (
                  <motion.div
                    initial={{ scale: 0.9 }}
                    animate={{ scale: 1 }}
                    className="flex h-10 w-10 items-center justify-center rounded-full border-2 border-primary bg-background"
                  >
                    <span className="text-sm font-semibold text-primary">
                      {index + 1}
                    </span>
                  </motion.div>
                ) : (
                  <div className="flex h-10 w-10 items-center justify-center rounded-full border-2 border-muted bg-background">
                    <span className="text-sm font-medium text-muted-foreground">
                      {index + 1}
                    </span>
                  </div>
                )}
              </div>

              {/* Step labels */}
              <div className="mt-3 text-center">
                <span
                  className={cn(
                    "text-sm font-medium",
                    step.isActive
                      ? "text-primary"
                      : step.isCompleted
                      ? "text-foreground"
                      : "text-muted-foreground"
                  )}
                >
                  {step.title}
                </span>
                <span
                  className={cn(
                    "mt-0.5 block text-xs",
                    step.isActive || step.isCompleted
                      ? "text-muted-foreground"
                      : "text-muted-foreground/60"
                  )}
                >
                  {step.description}
                </span>
              </div>
            </div>

            {/* Connecting line */}
            {index < totalSteps - 1 && (
              <div
                className="absolute left-[calc(50%+20px)] right-[calc(-50%+20px)] top-5 h-0.5"
                aria-hidden="true"
              >
                <div className="h-full w-full bg-muted">
                  <motion.div
                    initial={{ width: "0%" }}
                    animate={{
                      width: step.isCompleted ? "100%" : "0%",
                    }}
                    transition={{ duration: 0.3 }}
                    className="h-full bg-primary"
                  />
                </div>
              </div>
            )}
          </li>
        ))}
      </ol>

      {/* Mobile progress bar */}
      <div className="mt-4 sm:hidden">
        <div className="flex items-center justify-between text-sm">
          <span className="text-muted-foreground">
            Step {currentStep} of {totalSteps}
          </span>
          <span className="font-medium text-primary">{steps[currentStep - 1]?.title}</span>
        </div>
        <div className="mt-2 h-2 w-full overflow-hidden rounded-full bg-muted">
          <motion.div
            initial={{ width: "0%" }}
            animate={{ width: `${(currentStep / totalSteps) * 100}%` }}
            transition={{ duration: 0.3 }}
            className="h-full bg-primary"
          />
        </div>
      </div>
    </nav>
  );
}

```

# src/components/features/dashboard/AssessmentStatusWidget.tsx

```tsx
"use client";

import { useMemo } from "react";
import { useTranslations } from "next-intl";
import { useRouter } from "next/navigation";
import {
  FileText,
  Send,
  Search,
  CheckCircle2,
  Archive,
  AlertTriangle,
  Clock,
  ArrowRight,
} from "lucide-react";
import { cn } from "@/lib/utils";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Badge } from "@/components/ui/badge";
import type { AssessmentStatus } from "@prisma/client";

// =============================================================================
// TYPES
// =============================================================================

interface AssessmentStatusWidgetProps {
  byStatus: Record<AssessmentStatus, number>;
  overdueCount?: number;
  showViewAll?: boolean;
  onViewAll?: () => void;
  className?: string;
}

// =============================================================================
// STATUS CONFIG
// =============================================================================

const STATUS_CONFIG: Record<
  AssessmentStatus,
  {
    label: string;
    icon: React.ElementType;
    color: string;
    bgColor: string;
  }
> = {
  DRAFT: {
    label: "Draft",
    icon: FileText,
    color: "text-slate-600",
    bgColor: "bg-slate-100",
  },
  SUBMITTED: {
    label: "Submitted",
    icon: Send,
    color: "text-blue-600",
    bgColor: "bg-blue-100",
  },
  UNDER_REVIEW: {
    label: "Under Review",
    icon: Search,
    color: "text-yellow-600",
    bgColor: "bg-yellow-100",
  },
  COMPLETED: {
    label: "Completed",
    icon: CheckCircle2,
    color: "text-green-600",
    bgColor: "bg-green-100",
  },
  ARCHIVED: {
    label: "Archived",
    icon: Archive,
    color: "text-gray-600",
    bgColor: "bg-gray-100",
  },
};

// =============================================================================
// COMPONENT
// =============================================================================

export function AssessmentStatusWidget({
  byStatus,
  overdueCount = 0,
  showViewAll = true,
  onViewAll,
  className,
}: AssessmentStatusWidgetProps) {
  const t = useTranslations("dashboard");
  const router = useRouter();

  // Calculate totals
  const total = useMemo(() => {
    return Object.values(byStatus).reduce((sum, count) => sum + count, 0);
  }, [byStatus]);

  const activeCount = useMemo(() => {
    return byStatus.DRAFT + byStatus.SUBMITTED + byStatus.UNDER_REVIEW;
  }, [byStatus]);

  const handleViewAll = () => {
    if (onViewAll) {
      onViewAll();
    } else {
      router.push("/assessments");
    }
  };

  return (
    <Card className={className}>
      <CardHeader className="pb-3">
        <div className="flex items-center justify-between">
          <CardTitle className="text-lg">{t("assessments.title")}</CardTitle>
          <Badge variant="secondary" className="font-normal">
            {total} total
          </Badge>
        </div>
      </CardHeader>
      <CardContent>
        {/* Status breakdown */}
        <div className="space-y-3">
          {(Object.keys(STATUS_CONFIG) as AssessmentStatus[]).map((status) => {
            const config = STATUS_CONFIG[status];
            const Icon = config.icon;
            const count = byStatus[status] || 0;

            if (count === 0 && status === "ARCHIVED") return null;

            return (
              <div
                key={status}
                className="flex items-center justify-between py-2"
              >
                <div className="flex items-center gap-3">
                  <div
                    className={cn(
                      "p-2 rounded-lg",
                      config.bgColor
                    )}
                  >
                    <Icon className={cn("h-4 w-4", config.color)} />
                  </div>
                  <span className="text-sm font-medium">{config.label}</span>
                </div>
                <span className="text-lg font-semibold">{count}</span>
              </div>
            );
          })}
        </div>

        {/* Overdue warning */}
        {overdueCount > 0 && (
          <div className="mt-4 p-3 rounded-lg bg-red-50 border border-red-200">
            <div className="flex items-center gap-2">
              <AlertTriangle className="h-4 w-4 text-red-600" />
              <span className="text-sm font-medium text-red-800">
                {overdueCount} {t("assessments.overdue")}
              </span>
            </div>
          </div>
        )}

        {/* Summary */}
        <div className="mt-4 pt-4 border-t">
          <div className="flex items-center justify-between text-sm">
            <div className="flex items-center gap-2">
              <Clock className="h-4 w-4 text-muted-foreground" />
              <span className="text-muted-foreground">
                {activeCount} {t("assessments.active")}
              </span>
            </div>
            {showViewAll && (
              <Button variant="ghost" size="sm" onClick={handleViewAll}>
                {t("assessments.viewAll")}
                <ArrowRight className="h-4 w-4 ml-1" />
              </Button>
            )}
          </div>
        </div>
      </CardContent>
    </Card>
  );
}

// =============================================================================
// COMPACT STATUS WIDGET
// =============================================================================

interface CompactStatusWidgetProps {
  byStatus: Record<AssessmentStatus, number>;
  className?: string;
}

export function CompactStatusWidget({
  byStatus,
  className,
}: CompactStatusWidgetProps) {
  return (
    <div className={cn("flex items-center gap-4", className)}>
      {(Object.keys(STATUS_CONFIG) as AssessmentStatus[]).map((status) => {
        const config = STATUS_CONFIG[status];
        const count = byStatus[status] || 0;

        if (count === 0) return null;

        return (
          <div key={status} className="flex items-center gap-1.5">
            <div
              className={cn(
                "h-2 w-2 rounded-full",
                config.color.replace("text-", "bg-")
              )}
            />
            <span className="text-xs text-muted-foreground">{config.label}</span>
            <span className="text-xs font-medium">{count}</span>
          </div>
        );
      })}
    </div>
  );
}

export default AssessmentStatusWidget;

```

# src/components/features/dashboard/AttentionRequiredWidget.tsx

```tsx
"use client";

import { useTranslations } from "next-intl";
import { useRouter } from "next/navigation";
import { formatDistanceToNow, isPast } from "date-fns";
import {
  AlertTriangle,
  Clock,
  Pause,
  ArrowRight,
  Calendar,
} from "lucide-react";
import { cn } from "@/lib/utils";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Badge } from "@/components/ui/badge";
import { ProgressBar } from "../progress/ProgressBar";
import type { AssessmentStatus } from "@prisma/client";

// =============================================================================
// TYPES
// =============================================================================

export interface AssessmentAttentionItem {
  id: string;
  title: string;
  status: AssessmentStatus;
  progress: number;
  dueDate: Date | null;
  lastActivity: Date | null;
  reason: "overdue" | "stalled";
}

interface AttentionRequiredWidgetProps {
  assessments: AssessmentAttentionItem[];
  showViewAll?: boolean;
  onViewAll?: () => void;
  onAssessmentClick?: (assessmentId: string) => void;
  className?: string;
}

// =============================================================================
// COMPONENT
// =============================================================================

export function AttentionRequiredWidget({
  assessments,
  showViewAll = true,
  onViewAll,
  onAssessmentClick,
  className,
}: AttentionRequiredWidgetProps) {
  const t = useTranslations("dashboard");
  const router = useRouter();

  const handleAssessmentClick = (id: string) => {
    if (onAssessmentClick) {
      onAssessmentClick(id);
    } else {
      router.push(`/assessments/${id}`);
    }
  };

  if (assessments.length === 0) {
    return (
      <Card className={className}>
        <CardHeader className="pb-3">
          <CardTitle className="text-lg flex items-center gap-2">
            <AlertTriangle className="h-5 w-5" />
            {t("attention.title")}
          </CardTitle>
        </CardHeader>
        <CardContent>
          <div className="flex flex-col items-center justify-center py-6 text-center">
            <div className="h-12 w-12 rounded-full bg-green-100 flex items-center justify-center mb-3">
              <Clock className="h-6 w-6 text-green-600" />
            </div>
            <p className="text-sm text-muted-foreground">
              {t("attention.allOnTrack")}
            </p>
          </div>
        </CardContent>
      </Card>
    );
  }

  return (
    <Card className={className}>
      <CardHeader className="pb-3">
        <div className="flex items-center justify-between">
          <CardTitle className="text-lg flex items-center gap-2">
            <AlertTriangle className="h-5 w-5 text-orange-500" />
            {t("attention.title")}
          </CardTitle>
          <Badge variant="destructive">{assessments.length}</Badge>
        </div>
      </CardHeader>
      <CardContent>
        <div className="space-y-3">
          {assessments.map((assessment) => {
            const isOverdue = assessment.reason === "overdue";
            const Icon = isOverdue ? Clock : Pause;
            const colorClass = isOverdue
              ? "text-red-600 bg-red-100"
              : "text-yellow-600 bg-yellow-100";

            return (
              <div
                key={assessment.id}
                className={cn(
                  "p-3 rounded-lg border cursor-pointer transition-colors",
                  "hover:bg-muted/50"
                )}
                onClick={() => handleAssessmentClick(assessment.id)}
              >
                <div className="flex items-start justify-between gap-2 mb-2">
                  <div className="flex items-center gap-2">
                    <div
                      className={cn(
                        "p-1.5 rounded",
                        colorClass.split(" ")[1]
                      )}
                    >
                      <Icon
                        className={cn("h-3.5 w-3.5", colorClass.split(" ")[0])}
                      />
                    </div>
                    <div>
                      <p className="font-medium text-sm line-clamp-1">
                        {assessment.title}
                      </p>
                      <Badge
                        variant="outline"
                        className={cn(
                          "text-[10px] mt-0.5",
                          isOverdue && "border-red-300 text-red-700",
                          !isOverdue && "border-yellow-300 text-yellow-700"
                        )}
                      >
                        {isOverdue
                          ? t("attention.overdue")
                          : t("attention.stalled")}
                      </Badge>
                    </div>
                  </div>
                  <ArrowRight className="h-4 w-4 text-muted-foreground flex-shrink-0" />
                </div>

                <div className="space-y-2">
                  <ProgressBar
                    value={assessment.progress}
                    showLabel={false}
                    size="sm"
                    variant={isOverdue ? "danger" : "warning"}
                  />
                  <div className="flex items-center justify-between text-xs text-muted-foreground">
                    <span>{assessment.progress}% complete</span>
                    {assessment.dueDate && (
                      <span className="flex items-center gap-1">
                        <Calendar className="h-3 w-3" />
                        {isPast(new Date(assessment.dueDate))
                          ? `${formatDistanceToNow(new Date(assessment.dueDate))} overdue`
                          : `Due ${formatDistanceToNow(new Date(assessment.dueDate), { addSuffix: true })}`}
                      </span>
                    )}
                    {!assessment.dueDate && assessment.lastActivity && (
                      <span>
                        Last activity{" "}
                        {formatDistanceToNow(new Date(assessment.lastActivity), {
                          addSuffix: true,
                        })}
                      </span>
                    )}
                  </div>
                </div>
              </div>
            );
          })}
        </div>

        {showViewAll && assessments.length > 0 && (
          <div className="mt-4 pt-4 border-t">
            <Button
              variant="outline"
              className="w-full"
              onClick={onViewAll}
            >
              {t("attention.viewAll")}
              <ArrowRight className="h-4 w-4 ml-2" />
            </Button>
          </div>
        )}
      </CardContent>
    </Card>
  );
}

export default AttentionRequiredWidget;

```

# src/components/features/dashboard/RecentActivityWidget.tsx

```tsx
"use client";

import { useTranslations } from "next-intl";
import { formatDistanceToNow } from "date-fns";
import {
  Plus,
  Play,
  Save,
  Paperclip,
  Trash2,
  RefreshCw,
  Send,
  CheckCircle,
  CheckCircle2,
  RefreshCcw,
  MessageSquare,
  Activity,
  ArrowRight,
} from "lucide-react";
import { cn } from "@/lib/utils";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { ScrollArea } from "@/components/ui/scroll-area";
import type { EventType } from "@prisma/client";

// =============================================================================
// TYPES
// =============================================================================

export interface ActivityItem {
  id: string;
  type: EventType;
  description: string;
  userName: string;
  createdAt: Date;
}

interface RecentActivityWidgetProps {
  activities: ActivityItem[];
  maxItems?: number;
  showViewAll?: boolean;
  onViewAll?: () => void;
  className?: string;
}

// =============================================================================
// EVENT CONFIG
// =============================================================================

const EVENT_ICONS: Record<EventType, React.ElementType> = {
  CREATED: Plus,
  STARTED: Play,
  RESPONSE_SAVED: Save,
  EVIDENCE_ADDED: Paperclip,
  EVIDENCE_REMOVED: Trash2,
  STATUS_CHANGED: RefreshCw,
  SUBMITTED: Send,
  REVIEWED: CheckCircle,
  COMPLETED: CheckCircle2,
  REOPENED: RefreshCcw,
  COMMENT_ADDED: MessageSquare,
};

const EVENT_COLORS: Record<EventType, string> = {
  CREATED: "text-green-600 bg-green-100",
  STARTED: "text-blue-600 bg-blue-100",
  RESPONSE_SAVED: "text-indigo-600 bg-indigo-100",
  EVIDENCE_ADDED: "text-purple-600 bg-purple-100",
  EVIDENCE_REMOVED: "text-orange-600 bg-orange-100",
  STATUS_CHANGED: "text-yellow-600 bg-yellow-100",
  SUBMITTED: "text-teal-600 bg-teal-100",
  REVIEWED: "text-cyan-600 bg-cyan-100",
  COMPLETED: "text-green-600 bg-green-100",
  REOPENED: "text-amber-600 bg-amber-100",
  COMMENT_ADDED: "text-slate-600 bg-slate-100",
};

// =============================================================================
// COMPONENT
// =============================================================================

export function RecentActivityWidget({
  activities,
  maxItems = 8,
  showViewAll = true,
  onViewAll,
  className,
}: RecentActivityWidgetProps) {
  const t = useTranslations("dashboard");
  const displayActivities = activities.slice(0, maxItems);

  return (
    <Card className={className}>
      <CardHeader className="pb-3">
        <div className="flex items-center justify-between">
          <CardTitle className="text-lg flex items-center gap-2">
            <Activity className="h-5 w-5" />
            {t("activity.title")}
          </CardTitle>
          {showViewAll && activities.length > 0 && (
            <Button variant="ghost" size="sm" onClick={onViewAll}>
              {t("activity.viewAll")}
              <ArrowRight className="h-4 w-4 ml-1" />
            </Button>
          )}
        </div>
      </CardHeader>
      <CardContent>
        {displayActivities.length === 0 ? (
          <div className="flex flex-col items-center justify-center py-8 text-center">
            <Activity className="h-8 w-8 text-muted-foreground mb-2" />
            <p className="text-sm text-muted-foreground">
              {t("activity.empty")}
            </p>
          </div>
        ) : (
          <ScrollArea className="h-[300px] pr-4">
            <div className="space-y-4">
              {displayActivities.map((activity) => {
                const Icon = EVENT_ICONS[activity.type];
                const colorClass = EVENT_COLORS[activity.type];

                return (
                  <div key={activity.id} className="flex gap-3">
                    <div
                      className={cn(
                        "flex-shrink-0 h-8 w-8 rounded-full flex items-center justify-center",
                        colorClass.split(" ")[1]
                      )}
                    >
                      <Icon
                        className={cn("h-4 w-4", colorClass.split(" ")[0])}
                      />
                    </div>
                    <div className="flex-1 min-w-0">
                      <p className="text-sm">{activity.description}</p>
                      <div className="flex items-center gap-2 mt-1">
                        <span className="text-xs text-muted-foreground">
                          {activity.userName}
                        </span>
                        <span className="text-xs text-muted-foreground">
                          {formatDistanceToNow(new Date(activity.createdAt), {
                            addSuffix: true,
                          })}
                        </span>
                      </div>
                    </div>
                  </div>
                );
              })}
            </div>
          </ScrollArea>
        )}
      </CardContent>
    </Card>
  );
}

// =============================================================================
// INLINE ACTIVITY LIST
// =============================================================================

interface InlineActivityListProps {
  activities: ActivityItem[];
  maxItems?: number;
  className?: string;
}

export function InlineActivityList({
  activities,
  maxItems = 5,
  className,
}: InlineActivityListProps) {
  const displayActivities = activities.slice(0, maxItems);

  if (displayActivities.length === 0) {
    return null;
  }

  return (
    <div className={cn("space-y-2", className)}>
      {displayActivities.map((activity) => {
        const Icon = EVENT_ICONS[activity.type];
        const colorClass = EVENT_COLORS[activity.type];

        return (
          <div key={activity.id} className="flex items-center gap-2 text-sm">
            <Icon className={cn("h-3.5 w-3.5", colorClass.split(" ")[0])} />
            <span className="flex-1 truncate">{activity.description}</span>
            <span className="text-xs text-muted-foreground">
              {formatDistanceToNow(new Date(activity.createdAt), {
                addSuffix: true,
              })}
            </span>
          </div>
        );
      })}
    </div>
  );
}

export default RecentActivityWidget;

```

# src/components/features/dashboard/StatsCard.tsx

```tsx
"use client";

import { cn } from "@/lib/utils";
import { LucideIcon } from "lucide-react";
import { Card, CardContent } from "@/components/ui/card";

// =============================================================================
// TYPES
// =============================================================================

interface StatsCardProps {
  title: string;
  value: string | number;
  subtitle?: string;
  icon?: LucideIcon;
  iconColor?: string;
  trend?: {
    value: number;
    label: string;
    direction: "up" | "down" | "neutral";
  };
  className?: string;
}

// =============================================================================
// COMPONENT
// =============================================================================

export function StatsCard({
  title,
  value,
  subtitle,
  icon: Icon,
  iconColor = "text-primary",
  trend,
  className,
}: StatsCardProps) {
  return (
    <Card className={cn("transition-shadow hover:shadow-md", className)}>
      <CardContent className="p-6">
        <div className="flex items-start justify-between">
          <div className="flex-1">
            <p className="text-sm font-medium text-muted-foreground">{title}</p>
            <p className="text-2xl font-bold mt-1">{value}</p>
            {subtitle && (
              <p className="text-xs text-muted-foreground mt-1">{subtitle}</p>
            )}
            {trend && (
              <div className="flex items-center gap-1 mt-2">
                <span
                  className={cn(
                    "text-xs font-medium",
                    trend.direction === "up" && "text-green-600",
                    trend.direction === "down" && "text-red-600",
                    trend.direction === "neutral" && "text-muted-foreground"
                  )}
                >
                  {trend.direction === "up" && "+"}
                  {trend.value}%
                </span>
                <span className="text-xs text-muted-foreground">
                  {trend.label}
                </span>
              </div>
            )}
          </div>
          {Icon && (
            <div
              className={cn(
                "p-3 rounded-lg bg-muted/50",
                iconColor
              )}
            >
              <Icon className="h-5 w-5" />
            </div>
          )}
        </div>
      </CardContent>
    </Card>
  );
}

// =============================================================================
// STATS GRID
// =============================================================================

interface StatsGridProps {
  children: React.ReactNode;
  columns?: 2 | 3 | 4;
  className?: string;
}

export function StatsGrid({
  children,
  columns = 4,
  className,
}: StatsGridProps) {
  return (
    <div
      className={cn(
        "grid gap-4",
        columns === 2 && "grid-cols-1 sm:grid-cols-2",
        columns === 3 && "grid-cols-1 sm:grid-cols-2 lg:grid-cols-3",
        columns === 4 && "grid-cols-1 sm:grid-cols-2 lg:grid-cols-4",
        className
      )}
    >
      {children}
    </div>
  );
}

// =============================================================================
// MINI STATS
// =============================================================================

interface MiniStatsProps {
  label: string;
  value: string | number;
  icon?: LucideIcon;
  iconColor?: string;
  className?: string;
}

export function MiniStats({
  label,
  value,
  icon: Icon,
  iconColor = "text-muted-foreground",
  className,
}: MiniStatsProps) {
  return (
    <div className={cn("flex items-center gap-3", className)}>
      {Icon && <Icon className={cn("h-4 w-4", iconColor)} />}
      <div>
        <p className="text-xs text-muted-foreground">{label}</p>
        <p className="font-semibold">{value}</p>
      </div>
    </div>
  );
}

export default StatsCard;

```

# src/components/features/document/DocumentLibrary.tsx

```tsx
"use client";

import { useState, useCallback, useMemo } from "react";
import { useTranslations } from "next-intl";
import {
  Search,
  Filter,
  File,
  FileText,
  Image as ImageIcon,
  FileSpreadsheet,
  ExternalLink,
  Check,
  Loader2,
  FolderOpen,
} from "lucide-react";
import { cn } from "@/lib/utils";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from "@/components/ui/select";
import {
  Dialog,
  DialogContent,
  DialogDescription,
  DialogFooter,
  DialogHeader,
  DialogTitle,
} from "@/components/ui/dialog";
import { Badge } from "@/components/ui/badge";
import { Checkbox } from "@/components/ui/checkbox";
import { ScrollArea } from "@/components/ui/scroll-area";
import { trpc } from "@/lib/trpc/client";
import type { DocumentCategory } from "@prisma/client";
import { DocumentPreview, type PreviewDocument } from "./DocumentPreview";

// =============================================================================
// TYPES
// =============================================================================

interface DocumentLibraryDocument {
  id: string;
  name: string;
  originalName?: string | null;
  fileUrl: string;
  fileType: string;
  fileSize: number;
  category: DocumentCategory;
  description?: string | null;
  uploadedBy: {
    id: string;
    firstName: string;
    lastName: string;
  };
  createdAt: Date;
}

interface DocumentLibraryProps {
  organizationId: string;
  assessmentId?: string;
  open: boolean;
  onClose: () => void;
  onSelect: (documents: DocumentLibraryDocument[]) => void;
  excludeIds?: string[];
  multiple?: boolean;
  maxSelection?: number;
}

// =============================================================================
// HELPERS
// =============================================================================

function getFileIcon(mimeType: string) {
  if (mimeType.startsWith("image/")) return ImageIcon;
  if (mimeType === "application/pdf") return FileText;
  if (
    mimeType.includes("spreadsheet") ||
    mimeType.includes("excel") ||
    mimeType === "application/vnd.ms-excel"
  )
    return FileSpreadsheet;
  return File;
}

function formatFileSize(bytes: number): string {
  if (bytes === 0) return "-";
  const k = 1024;
  const sizes = ["B", "KB", "MB", "GB"];
  const i = Math.floor(Math.log(bytes) / Math.log(k));
  return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + " " + sizes[i];
}

function formatDate(date: Date): string {
  return new Intl.DateTimeFormat("en-US", {
    month: "short",
    day: "numeric",
    year: "numeric",
  }).format(new Date(date));
}

// =============================================================================
// CATEGORY COLORS
// =============================================================================

const CATEGORY_COLORS: Record<DocumentCategory, string> = {
  POLICY: "bg-purple-100 text-purple-800",
  PROCEDURE: "bg-blue-100 text-blue-800",
  RECORD: "bg-green-100 text-green-800",
  CERTIFICATE: "bg-yellow-100 text-yellow-800",
  REPORT: "bg-orange-100 text-orange-800",
  TRAINING: "bg-pink-100 text-pink-800",
  EVIDENCE: "bg-gray-100 text-gray-800",
  OTHER: "bg-slate-100 text-slate-800",
};

const CATEGORIES: DocumentCategory[] = [
  "EVIDENCE",
  "POLICY",
  "PROCEDURE",
  "RECORD",
  "CERTIFICATE",
  "REPORT",
  "TRAINING",
  "OTHER",
];

// =============================================================================
// COMPONENT
// =============================================================================

export function DocumentLibrary({
  organizationId,
  assessmentId,
  open,
  onClose,
  onSelect,
  excludeIds = [],
  multiple = true,
  maxSelection = 5,
}: DocumentLibraryProps) {
  const t = useTranslations("evidence");

  // State
  const [searchQuery, setSearchQuery] = useState("");
  const [categoryFilter, setCategoryFilter] = useState<DocumentCategory | "ALL">(
    "ALL"
  );
  const [selectedIds, setSelectedIds] = useState<Set<string>>(new Set());
  const [previewDocument, setPreviewDocument] =
    useState<PreviewDocument | null>(null);

  // Fetch documents
  const { data: documents, isLoading } = trpc.document.getByOrganization.useQuery(
    {
      organizationId,
      category: categoryFilter === "ALL" ? undefined : categoryFilter,
      assessmentId,
      search: searchQuery || undefined,
    },
    { enabled: open }
  );

  // Filter out excluded documents
  const availableDocuments = useMemo(() => {
    if (!documents) return [];
    return documents.filter((doc) => !excludeIds.includes(doc.id));
  }, [documents, excludeIds]);

  // Handlers
  const handleToggleSelect = useCallback(
    (docId: string) => {
      setSelectedIds((prev) => {
        const next = new Set(prev);
        if (next.has(docId)) {
          next.delete(docId);
        } else {
          if (!multiple) {
            next.clear();
          }
          if (next.size < maxSelection) {
            next.add(docId);
          }
        }
        return next;
      });
    },
    [multiple, maxSelection]
  );

  const handleConfirm = useCallback(() => {
    if (!documents) return;
    const selectedDocs = documents.filter((doc) => selectedIds.has(doc.id));
    onSelect(
      selectedDocs.map((doc) => ({
        id: doc.id,
        name: doc.name,
        originalName: doc.originalName,
        fileUrl: doc.fileUrl,
        fileType: doc.fileType,
        fileSize: doc.fileSize,
        category: doc.category,
        description: doc.description,
        uploadedBy: doc.uploadedBy,
        createdAt: doc.createdAt,
      }))
    );
    setSelectedIds(new Set());
    onClose();
  }, [documents, selectedIds, onSelect, onClose]);

  const handlePreview = useCallback(
    (doc: DocumentLibraryDocument) => {
      setPreviewDocument({
        id: doc.id,
        name: doc.name,
        originalName: doc.originalName,
        url: doc.fileUrl,
        fileType: doc.fileType,
        fileSize: doc.fileSize,
        category: doc.category,
        description: doc.description,
        uploadedBy: doc.uploadedBy,
        createdAt: doc.createdAt,
      });
    },
    []
  );

  const handleClose = useCallback(() => {
    setSelectedIds(new Set());
    setSearchQuery("");
    setCategoryFilter("ALL");
    onClose();
  }, [onClose]);

  return (
    <>
      <Dialog open={open} onOpenChange={(o) => !o && handleClose()}>
        <DialogContent className="max-w-3xl max-h-[80vh] flex flex-col">
          <DialogHeader>
            <DialogTitle className="flex items-center gap-2">
              <FolderOpen className="h-5 w-5" />
              {t("library.title")}
            </DialogTitle>
            <DialogDescription>
              {t("library.description")}
            </DialogDescription>
          </DialogHeader>

          {/* Filters */}
          <div className="flex gap-3 flex-shrink-0">
            <div className="flex-1 relative">
              <Search className="absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground" />
              <Input
                value={searchQuery}
                onChange={(e) => setSearchQuery(e.target.value)}
                placeholder={t("library.searchPlaceholder")}
                className="pl-9"
              />
            </div>
            <Select
              value={categoryFilter}
              onValueChange={(v) =>
                setCategoryFilter(v as DocumentCategory | "ALL")
              }
            >
              <SelectTrigger className="w-[160px]">
                <Filter className="h-4 w-4 mr-2" />
                <SelectValue placeholder="Category" />
              </SelectTrigger>
              <SelectContent>
                <SelectItem value="ALL">{t("library.allCategories")}</SelectItem>
                {CATEGORIES.map((cat) => (
                  <SelectItem key={cat} value={cat}>
                    {t(`categories.${cat}`)}
                  </SelectItem>
                ))}
              </SelectContent>
            </Select>
          </div>

          {/* Document List */}
          <ScrollArea className="flex-1 -mx-6 px-6">
            {isLoading ? (
              <div className="flex items-center justify-center py-12">
                <Loader2 className="h-8 w-8 animate-spin text-muted-foreground" />
              </div>
            ) : availableDocuments.length === 0 ? (
              <div className="flex flex-col items-center justify-center py-12 text-center">
                <FolderOpen className="h-12 w-12 text-muted-foreground mb-3" />
                <p className="text-muted-foreground">
                  {searchQuery || categoryFilter !== "ALL"
                    ? t("library.noResults")
                    : t("library.empty")}
                </p>
              </div>
            ) : (
              <div className="space-y-2 py-2">
                {availableDocuments.map((doc) => {
                  const FileIcon = getFileIcon(doc.fileType);
                  const isSelected = selectedIds.has(doc.id);
                  const isExternalLink = doc.fileType === "external_link";

                  return (
                    <div
                      key={doc.id}
                      className={cn(
                        "flex items-center gap-3 p-3 rounded-lg border transition-colors cursor-pointer",
                        isSelected
                          ? "border-primary bg-primary/5"
                          : "hover:bg-muted/50"
                      )}
                      onClick={() => handleToggleSelect(doc.id)}
                    >
                      {/* Checkbox */}
                      <Checkbox
                        checked={isSelected}
                        onCheckedChange={() => handleToggleSelect(doc.id)}
                        className="flex-shrink-0"
                      />

                      {/* Icon */}
                      <div className="flex-shrink-0">
                        {isExternalLink ? (
                          <ExternalLink className="h-5 w-5 text-blue-500" />
                        ) : (
                          <FileIcon className="h-5 w-5 text-muted-foreground" />
                        )}
                      </div>

                      {/* Content */}
                      <div className="flex-1 min-w-0">
                        <p className="font-medium truncate">{doc.name}</p>
                        <div className="flex items-center gap-2 mt-1">
                          <Badge
                            variant="secondary"
                            className={cn(
                              "text-xs",
                              CATEGORY_COLORS[doc.category]
                            )}
                          >
                            {t(`categories.${doc.category}`)}
                          </Badge>
                          <span className="text-xs text-muted-foreground">
                            {formatDate(doc.createdAt)}
                          </span>
                          {doc.fileSize > 0 && (
                            <span className="text-xs text-muted-foreground">
                              {formatFileSize(doc.fileSize)}
                            </span>
                          )}
                        </div>
                      </div>

                      {/* Preview Button */}
                      <Button
                        variant="ghost"
                        size="sm"
                        onClick={(e) => {
                          e.stopPropagation();
                          handlePreview(doc);
                        }}
                        className="flex-shrink-0"
                      >
                        View
                      </Button>
                    </div>
                  );
                })}
              </div>
            )}
          </ScrollArea>

          {/* Footer */}
          <DialogFooter className="flex-shrink-0 border-t pt-4">
            <div className="flex items-center justify-between w-full">
              <p className="text-sm text-muted-foreground">
                {selectedIds.size} of {maxSelection} selected
              </p>
              <div className="flex gap-2">
                <Button variant="outline" onClick={handleClose}>
                  Cancel
                </Button>
                <Button
                  onClick={handleConfirm}
                  disabled={selectedIds.size === 0}
                >
                  <Check className="h-4 w-4 mr-2" />
                  {t("library.addSelected")} ({selectedIds.size})
                </Button>
              </div>
            </div>
          </DialogFooter>
        </DialogContent>
      </Dialog>

      {/* Preview Dialog */}
      {previewDocument && (
        <DocumentPreview
          document={previewDocument}
          open={!!previewDocument}
          onClose={() => setPreviewDocument(null)}
        />
      )}
    </>
  );
}

export default DocumentLibrary;

```

# src/components/features/document/DocumentPreview.tsx

```tsx
"use client";

import { useState, useCallback } from "react";
import Image from 'next/image';
import { useTranslations } from "next-intl";
import {
  X,
  Download,
  ExternalLink,
  FileText,
  File,
  Image as ImageIcon,
  FileSpreadsheet,
  Maximize2,
  ZoomIn,
  ZoomOut,
} from "lucide-react";
import { cn } from "@/lib/utils";
import { Button } from "@/components/ui/button";
import {
  Dialog,
  DialogContent,
  DialogHeader,
  DialogTitle,
} from "@/components/ui/dialog";
import { Badge } from "@/components/ui/badge";
import type { DocumentCategory } from "@prisma/client";

// =============================================================================
// TYPES
// =============================================================================

export interface PreviewDocument {
  id: string;
  name: string;
  originalName?: string | null;
  url: string;
  fileType: string;
  fileSize: number;
  category: DocumentCategory;
  description?: string | null;
  uploadedBy?: {
    firstName: string;
    lastName: string;
  };
  createdAt?: Date;
}

interface DocumentPreviewProps {
  document: PreviewDocument;
  open: boolean;
  onClose: () => void;
}

// =============================================================================
// HELPERS
// =============================================================================

function FileIconComponent({ mimeType, className }: { mimeType: string; className?: string }) {
  if (mimeType.startsWith("image/")) return <ImageIcon className={className} />;
  if (mimeType === "application/pdf") return <FileText className={className} />;
  if (
    mimeType.includes("spreadsheet") ||
    mimeType.includes("excel") ||
    mimeType === "application/vnd.ms-excel"
  )
    return <FileSpreadsheet className={className} />;
  return <File className={className} />;
}

function formatFileSize(bytes: number): string {
  if (bytes === 0) return "-";
  const k = 1024;
  const sizes = ["B", "KB", "MB", "GB"];
  const i = Math.floor(Math.log(bytes) / Math.log(k));
  return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + " " + sizes[i];
}

function getFileTypeLabel(mimeType: string): string {
  if (mimeType === "external_link") return "External Link";
  if (mimeType === "application/pdf") return "PDF Document";
  if (mimeType.startsWith("image/")) return "Image";
  if (mimeType.includes("word") || mimeType === "application/msword")
    return "Word Document";
  if (
    mimeType.includes("spreadsheet") ||
    mimeType.includes("excel") ||
    mimeType === "application/vnd.ms-excel"
  )
    return "Excel Spreadsheet";
  if (mimeType.includes("presentation") || mimeType.includes("powerpoint"))
    return "Presentation";
  return "Document";
}

function canPreviewInline(mimeType: string): boolean {
  return (
    mimeType.startsWith("image/") ||
    mimeType === "application/pdf"
  );
}

// =============================================================================
// CATEGORY COLORS
// =============================================================================

const CATEGORY_COLORS: Record<DocumentCategory, string> = {
  POLICY: "bg-purple-100 text-purple-800",
  PROCEDURE: "bg-blue-100 text-blue-800",
  RECORD: "bg-green-100 text-green-800",
  CERTIFICATE: "bg-yellow-100 text-yellow-800",
  REPORT: "bg-orange-100 text-orange-800",
  TRAINING: "bg-pink-100 text-pink-800",
  EVIDENCE: "bg-gray-100 text-gray-800",
  OTHER: "bg-slate-100 text-slate-800",
};

// =============================================================================
// COMPONENT
// =============================================================================

export function DocumentPreview({
  document,
  open,
  onClose,
}: DocumentPreviewProps) {
  const t = useTranslations("evidence");
  const [imageZoom, setImageZoom] = useState(1);
  const [imageError, setImageError] = useState(false);
  const [pdfError, setPdfError] = useState(false);

  const isExternalLink = document.fileType === "external_link";
  const isImage = document.fileType.startsWith("image/");
  const isPdf = document.fileType === "application/pdf";
  const canPreview = canPreviewInline(document.fileType) && !isExternalLink;

  const handleDownload = useCallback(() => {
    const link = window.document.createElement("a");
    link.href = document.url;
    link.download = document.originalName || document.name;
    link.target = "_blank";
    window.document.body.appendChild(link);
    link.click();
    window.document.body.removeChild(link);
  }, [document]);

  const handleOpenExternal = useCallback(() => {
    window.open(document.url, "_blank", "noopener,noreferrer");
  }, [document.url]);

  const handleZoomIn = useCallback(() => {
    setImageZoom((z) => Math.min(z + 0.25, 3));
  }, []);

  const handleZoomOut = useCallback(() => {
    setImageZoom((z) => Math.max(z - 0.25, 0.5));
  }, []);

  const handleResetZoom = useCallback(() => {
    setImageZoom(1);
  }, []);

  return (
    <Dialog open={open} onOpenChange={(o) => !o && onClose()}>
      <DialogContent className="max-w-4xl max-h-[90vh] flex flex-col">
        <DialogHeader className="flex-shrink-0">
          <div className="flex items-start justify-between gap-4">
            <div className="flex items-start gap-3">
              {isExternalLink ? (
                <ExternalLink className="h-6 w-6 text-blue-500 flex-shrink-0 mt-0.5" />
              ) : (
                <FileIconComponent mimeType={document.fileType} className="h-6 w-6 text-muted-foreground flex-shrink-0 mt-0.5" />
              )}
              <div>
                <DialogTitle className="text-left">
                  {document.name}
                </DialogTitle>
                <div className="flex items-center gap-2 mt-1 flex-wrap">
                  <Badge
                    variant="secondary"
                    className={cn(
                      "text-xs",
                      CATEGORY_COLORS[document.category]
                    )}
                  >
                    {t(`categories.${document.category}`)}
                  </Badge>
                  <span className="text-xs text-muted-foreground">
                    {getFileTypeLabel(document.fileType)}
                  </span>
                  {document.fileSize > 0 && (
                    <span className="text-xs text-muted-foreground">
                      {formatFileSize(document.fileSize)}
                    </span>
                  )}
                </div>
              </div>
            </div>
          </div>
        </DialogHeader>

        {/* Description */}
        {document.description && (
          <p className="text-sm text-muted-foreground flex-shrink-0">
            {document.description}
          </p>
        )}

        {/* Preview Area */}
        <div className="flex-1 min-h-0 overflow-hidden rounded-lg border bg-muted/30">
          {canPreview && isImage && !imageError ? (
            <div className="h-full flex items-center justify-center overflow-auto p-4">
              <Image
                src={document.url}
                alt={document.name}
                className="max-w-full transition-transform"
                style={{ transform: `scale(${imageZoom})` }}
                onError={() => setImageError(true)}
                width={800}
                height={600}
                unoptimized
              />
            </div>
          ) : canPreview && isPdf && !pdfError ? (
            <iframe
              src={document.url}
              title={document.name}
              className="w-full h-full min-h-[500px]"
              onError={() => setPdfError(true)}
            />
          ) : (
            <div className="h-full flex flex-col items-center justify-center p-8 text-center">
              <FileIconComponent mimeType={document.fileType} className="h-16 w-16 text-muted-foreground mb-4" />
              <p className="text-lg font-medium mb-2">
                {isExternalLink ? "External Link" : "Preview not available"}
              </p>
              <p className="text-sm text-muted-foreground mb-4">
                {isExternalLink
                  ? "Click the button below to open in a new tab"
                  : "Download or open in a new tab to view this document"}
              </p>
              <div className="flex gap-2">
                {!isExternalLink && (
                  <Button onClick={handleDownload}>
                    <Download className="h-4 w-4 mr-2" />
                    Download
                  </Button>
                )}
                <Button
                  variant={isExternalLink ? "default" : "outline"}
                  onClick={handleOpenExternal}
                >
                  <ExternalLink className="h-4 w-4 mr-2" />
                  Open in new tab
                </Button>
              </div>
            </div>
          )}
        </div>

        {/* Image Controls */}
        {canPreview && isImage && !imageError && (
          <div className="flex-shrink-0 flex items-center justify-center gap-2 pt-2">
            <Button variant="outline" size="sm" onClick={handleZoomOut}>
              <ZoomOut className="h-4 w-4" />
            </Button>
            <Button variant="outline" size="sm" onClick={handleResetZoom}>
              {Math.round(imageZoom * 100)}%
            </Button>
            <Button variant="outline" size="sm" onClick={handleZoomIn}>
              <ZoomIn className="h-4 w-4" />
            </Button>
          </div>
        )}

        {/* Footer Actions */}
        <div className="flex-shrink-0 flex items-center justify-between pt-4 border-t">
          <div className="text-xs text-muted-foreground">
            {document.uploadedBy && (
              <span>
                Uploaded by {document.uploadedBy.firstName}{" "}
                {document.uploadedBy.lastName}
              </span>
            )}
          </div>
          <div className="flex gap-2">
            {!isExternalLink && (
              <Button variant="outline" size="sm" onClick={handleDownload}>
                <Download className="h-4 w-4 mr-2" />
                Download
              </Button>
            )}
            <Button variant="outline" size="sm" onClick={handleOpenExternal}>
              <Maximize2 className="h-4 w-4 mr-2" />
              Open
            </Button>
            <Button variant="ghost" size="sm" onClick={onClose}>
              <X className="h-4 w-4 mr-2" />
              Close
            </Button>
          </div>
        </div>
      </DialogContent>
    </Dialog>
  );
}

export default DocumentPreview;

```

# src/components/features/document/EvidenceUpload.tsx

```tsx
"use client";

import { useState, useCallback, useRef } from "react";
import { useTranslations } from "next-intl";
import {
  Upload,
  Link2,
  File,
  FileText,
  Image as ImageIcon,
  FileSpreadsheet,
  X,
  Loader2,
  ExternalLink,
  AlertCircle,
} from "lucide-react";
import { cn } from "@/lib/utils";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Textarea } from "@/components/ui/textarea";
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from "@/components/ui/select";
import {
  Dialog,
  DialogContent,
  DialogDescription,
  DialogFooter,
  DialogHeader,
  DialogTitle,
} from "@/components/ui/dialog";
import { Progress } from "@/components/ui/progress";
import { Alert, AlertDescription } from "@/components/ui/alert";
import { trpc } from "@/lib/trpc/client";
import type { DocumentCategory } from "@prisma/client";

// =============================================================================
// TYPES
// =============================================================================

export interface Evidence {
  id: string;
  name: string;
  url: string;
  fileType: string;
  fileSize: number;
  category: DocumentCategory;
  description?: string | null;
}

interface EvidenceUploadProps {
  assessmentId: string;
  responseId: string;
  existingEvidence: Evidence[];
  onEvidenceAdded: (evidence: Evidence) => void;
  onEvidenceRemoved: (evidenceId: string) => void;
  maxFiles?: number;
  disabled?: boolean;
}

interface UploadState {
  uploading: boolean;
  progress: number;
  error: string | null;
}

// =============================================================================
// HELPERS
// =============================================================================

const ALLOWED_TYPES = [
  "application/pdf",
  "image/jpeg",
  "image/png",
  "image/gif",
  "image/webp",
  "application/msword",
  "application/vnd.openxmlformats-officedocument.wordprocessingml.document",
  "application/vnd.ms-excel",
  "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
];

const MAX_FILE_SIZE = 10 * 1024 * 1024; // 10MB
const DEFAULT_MAX_FILES = 5;

function getFileIcon(mimeType: string) {
  if (mimeType.startsWith("image/")) return ImageIcon;
  if (mimeType === "application/pdf") return FileText;
  if (
    mimeType.includes("spreadsheet") ||
    mimeType.includes("excel") ||
    mimeType === "application/vnd.ms-excel"
  )
    return FileSpreadsheet;
  return File;
}

function formatFileSize(bytes: number): string {
  if (bytes === 0) return "0 B";
  const k = 1024;
  const sizes = ["B", "KB", "MB", "GB"];
  const i = Math.floor(Math.log(bytes) / Math.log(k));
  return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + " " + sizes[i];
}

function getFileTypeLabel(mimeType: string): string {
  if (mimeType === "external_link") return "URL";
  if (mimeType === "application/pdf") return "PDF";
  if (mimeType.startsWith("image/")) return "Image";
  if (mimeType.includes("word") || mimeType === "application/msword")
    return "Word";
  if (
    mimeType.includes("spreadsheet") ||
    mimeType.includes("excel") ||
    mimeType === "application/vnd.ms-excel"
  )
    return "Excel";
  return "File";
}

// =============================================================================
// DOCUMENT CATEGORIES
// =============================================================================

const DOCUMENT_CATEGORIES: { value: DocumentCategory; labelKey: string }[] = [
  { value: "EVIDENCE", labelKey: "EVIDENCE" },
  { value: "POLICY", labelKey: "POLICY" },
  { value: "PROCEDURE", labelKey: "PROCEDURE" },
  { value: "RECORD", labelKey: "RECORD" },
  { value: "CERTIFICATE", labelKey: "CERTIFICATE" },
  { value: "REPORT", labelKey: "REPORT" },
  { value: "TRAINING", labelKey: "TRAINING" },
  { value: "OTHER", labelKey: "OTHER" },
];

// =============================================================================
// COMPONENT
// =============================================================================

export function EvidenceUpload({
  assessmentId,
  responseId,
  existingEvidence,
  onEvidenceAdded,
  onEvidenceRemoved,
  maxFiles = DEFAULT_MAX_FILES,
  disabled = false,
}: EvidenceUploadProps) {
  const t = useTranslations("evidence");
  const fileInputRef = useRef<HTMLInputElement>(null);

  // State
  const [uploadState, setUploadState] = useState<UploadState>({
    uploading: false,
    progress: 0,
    error: null,
  });
  const [showUrlDialog, setShowUrlDialog] = useState(false);
  const [urlInput, setUrlInput] = useState("");
  const [urlName, setUrlName] = useState("");
  const [urlDescription, setUrlDescription] = useState("");
  const [selectedCategory, setSelectedCategory] =
    useState<DocumentCategory>("EVIDENCE");
  const [isDragOver, setIsDragOver] = useState(false);

  // tRPC mutations
  const createDocument = trpc.document.create.useMutation();
  const createUrlReference = trpc.document.createUrlReference.useMutation();
  const linkToResponse = trpc.document.linkToResponse.useMutation();
  const unlinkFromResponse = trpc.document.unlinkFromResponse.useMutation();

  const canAddMore = existingEvidence.length < maxFiles;

  // Handlers
  const handleFileSelect = useCallback(
    async (files: FileList | null) => {
      if (!files || files.length === 0) return;
      if (!canAddMore) {
        setUploadState({
          uploading: false,
          progress: 0,
          error: t("upload.maxFiles", { count: maxFiles }),
        });
        return;
      }

      const file = files[0];

      // Validate file type
      if (!ALLOWED_TYPES.includes(file.type)) {
        setUploadState({
          uploading: false,
          progress: 0,
          error: t("upload.allowedTypes"),
        });
        return;
      }

      // Validate file size
      if (file.size > MAX_FILE_SIZE) {
        setUploadState({
          uploading: false,
          progress: 0,
          error: t("upload.maxSize", { size: 10 }),
        });
        return;
      }

      setUploadState({ uploading: true, progress: 10, error: null });

      try {
        // Upload file
        const formData = new FormData();
        formData.append("file", file);

        setUploadState((s) => ({ ...s, progress: 30 }));

        const uploadResponse = await fetch("/api/upload", {
          method: "POST",
          body: formData,
        });

        if (!uploadResponse.ok) {
          const errorData = await uploadResponse.json();
          throw new Error(errorData.error || "Upload failed");
        }

        const uploadResult = await uploadResponse.json();

        setUploadState((s) => ({ ...s, progress: 60 }));

        // Create document record
        const documentResult = await createDocument.mutateAsync({
          name: file.name,
          originalName: uploadResult.file.originalName,
          fileUrl: uploadResult.file.url,
          fileType: file.type,
          fileSize: file.size,
          category: selectedCategory,
          assessmentId,
        });

        setUploadState((s) => ({ ...s, progress: 80 }));

        // Link to response
        await linkToResponse.mutateAsync({
          documentId: documentResult.document.id,
          responseId,
        });

        setUploadState({ uploading: false, progress: 100, error: null });

        // Notify parent
        onEvidenceAdded({
          id: documentResult.document.id,
          name: documentResult.document.name,
          url: documentResult.document.fileUrl,
          fileType: documentResult.document.fileType,
          fileSize: documentResult.document.fileSize,
          category: documentResult.document.category,
          description: documentResult.document.description,
        });

        // Reset input
        if (fileInputRef.current) {
          fileInputRef.current.value = "";
        }
      } catch (error) {
        setUploadState({
          uploading: false,
          progress: 0,
          error:
            error instanceof Error ? error.message : t("upload.uploadFailed"),
        });
      }
    },
    [
      assessmentId,
      responseId,
      canAddMore,
      maxFiles,
      selectedCategory,
      t,
      createDocument,
      linkToResponse,
      onEvidenceAdded,
    ]
  );

  const handleUrlSubmit = useCallback(async () => {
    if (!urlInput.trim() || !urlName.trim()) return;

    try {
      setUploadState({ uploading: true, progress: 30, error: null });

      // Create URL reference
      const documentResult = await createUrlReference.mutateAsync({
        url: urlInput.trim(),
        name: urlName.trim(),
        description: urlDescription.trim() || undefined,
        category: selectedCategory,
        assessmentId,
      });

      setUploadState((s) => ({ ...s, progress: 70 }));

      // Link to response
      await linkToResponse.mutateAsync({
        documentId: documentResult.document.id,
        responseId,
      });

      setUploadState({ uploading: false, progress: 100, error: null });

      // Notify parent
      onEvidenceAdded({
        id: documentResult.document.id,
        name: documentResult.document.name,
        url: documentResult.document.fileUrl,
        fileType: "external_link",
        fileSize: 0,
        category: documentResult.document.category,
        description: documentResult.document.description,
      });

      // Reset and close dialog
      setUrlInput("");
      setUrlName("");
      setUrlDescription("");
      setShowUrlDialog(false);
    } catch (error) {
      setUploadState({
        uploading: false,
        progress: 0,
        error:
          error instanceof Error ? error.message : t("upload.uploadFailed"),
      });
    }
  }, [
    urlInput,
    urlName,
    urlDescription,
    assessmentId,
    responseId,
    selectedCategory,
    t,
    createUrlReference,
    linkToResponse,
    onEvidenceAdded,
  ]);

  const handleRemove = useCallback(
    async (evidenceId: string) => {
      try {
        await unlinkFromResponse.mutateAsync({
          documentId: evidenceId,
          responseId,
        });
        onEvidenceRemoved(evidenceId);
      } catch (error) {
        console.error("Failed to remove evidence:", error);
      }
    },
    [responseId, unlinkFromResponse, onEvidenceRemoved]
  );

  // Drag and drop handlers
  const handleDragOver = useCallback(
    (e: React.DragEvent) => {
      e.preventDefault();
      if (!disabled && canAddMore) {
        setIsDragOver(true);
      }
    },
    [disabled, canAddMore]
  );

  const handleDragLeave = useCallback((e: React.DragEvent) => {
    e.preventDefault();
    setIsDragOver(false);
  }, []);

  const handleDrop = useCallback(
    (e: React.DragEvent) => {
      e.preventDefault();
      setIsDragOver(false);
      if (!disabled && canAddMore) {
        handleFileSelect(e.dataTransfer.files);
      }
    },
    [disabled, canAddMore, handleFileSelect]
  );

  return (
    <div className="space-y-4">
      {/* Upload Area */}
      <div
        className={cn(
          "border-2 border-dashed rounded-lg p-6 text-center transition-colors",
          isDragOver && "border-primary bg-primary/5",
          disabled || !canAddMore
            ? "opacity-50 cursor-not-allowed"
            : "cursor-pointer hover:border-primary/50"
        )}
        onDragOver={handleDragOver}
        onDragLeave={handleDragLeave}
        onDrop={handleDrop}
        onClick={() =>
          !disabled && canAddMore && fileInputRef.current?.click()
        }
      >
        <input
          ref={fileInputRef}
          type="file"
          accept={ALLOWED_TYPES.join(",")}
          onChange={(e) => handleFileSelect(e.target.files)}
          className="hidden"
          disabled={disabled || !canAddMore}
        />

        {uploadState.uploading ? (
          <div className="space-y-3">
            <Loader2 className="h-8 w-8 mx-auto animate-spin text-primary" />
            <p className="text-sm text-muted-foreground">
              {t("upload.uploading")}
            </p>
            <Progress value={uploadState.progress} className="max-w-xs mx-auto" />
          </div>
        ) : (
          <>
            <Upload className="h-8 w-8 mx-auto mb-3 text-muted-foreground" />
            <p className="text-sm font-medium">{t("upload.dragDrop")}</p>
            <p className="text-xs text-muted-foreground mt-1">
              {t("upload.allowedTypes")}
            </p>
            <p className="text-xs text-muted-foreground">
              {t("upload.maxSize", { size: 10 })}
            </p>
          </>
        )}
      </div>

      {/* Category Selection */}
      <div className="flex items-center gap-4">
        <div className="flex-1">
          <Label className="text-xs text-muted-foreground">
            {t("upload.category")}
          </Label>
          <Select
            value={selectedCategory}
            onValueChange={(value) =>
              setSelectedCategory(value as DocumentCategory)
            }
            disabled={disabled}
          >
            <SelectTrigger className="h-9">
              <SelectValue />
            </SelectTrigger>
            <SelectContent>
              {DOCUMENT_CATEGORIES.map((cat) => (
                <SelectItem key={cat.value} value={cat.value}>
                  {t(`categories.${cat.labelKey}`)}
                </SelectItem>
              ))}
            </SelectContent>
          </Select>
        </div>

        <Button
          variant="outline"
          size="sm"
          onClick={() => setShowUrlDialog(true)}
          disabled={disabled || !canAddMore}
          className="mt-5"
        >
          <Link2 className="h-4 w-4 mr-2" />
          {t("upload.addUrl")}
        </Button>
      </div>

      {/* Error Message */}
      {uploadState.error && (
        <Alert variant="destructive">
          <AlertCircle className="h-4 w-4" />
          <AlertDescription>{uploadState.error}</AlertDescription>
        </Alert>
      )}

      {/* Existing Evidence List */}
      {existingEvidence.length > 0 && (
        <div className="space-y-2">
          <p className="text-sm font-medium">
            {t("upload.maxFiles", { count: `${existingEvidence.length}/${maxFiles}` })}
          </p>
          <div className="space-y-2">
            {existingEvidence.map((evidence) => {
              const FileIcon = getFileIcon(evidence.fileType);
              const isExternalLink = evidence.fileType === "external_link";

              return (
                <div
                  key={evidence.id}
                  className="flex items-center gap-3 p-2 rounded-lg border bg-card"
                >
                  <div className="flex-shrink-0">
                    {isExternalLink ? (
                      <ExternalLink className="h-5 w-5 text-blue-500" />
                    ) : (
                      <FileIcon className="h-5 w-5 text-muted-foreground" />
                    )}
                  </div>
                  <div className="flex-1 min-w-0">
                    <a
                      href={evidence.url}
                      target="_blank"
                      rel="noopener noreferrer"
                      className="text-sm font-medium hover:underline truncate block"
                    >
                      {evidence.name}
                    </a>
                    <p className="text-xs text-muted-foreground">
                      {getFileTypeLabel(evidence.fileType)}
                      {evidence.fileSize > 0 &&
                        ` - ${formatFileSize(evidence.fileSize)}`}
                    </p>
                  </div>
                  {!disabled && (
                    <Button
                      variant="ghost"
                      size="sm"
                      onClick={() => handleRemove(evidence.id)}
                      className="flex-shrink-0"
                    >
                      <X className="h-4 w-4" />
                    </Button>
                  )}
                </div>
              );
            })}
          </div>
        </div>
      )}

      {/* URL Dialog */}
      <Dialog open={showUrlDialog} onOpenChange={setShowUrlDialog}>
        <DialogContent>
          <DialogHeader>
            <DialogTitle>{t("upload.addUrl")}</DialogTitle>
            <DialogDescription>
              {t("upload.urlPlaceholder")}
            </DialogDescription>
          </DialogHeader>

          <div className="space-y-4 py-4">
            <div className="space-y-2">
              <Label htmlFor="url">URL</Label>
              <Input
                id="url"
                value={urlInput}
                onChange={(e) => setUrlInput(e.target.value)}
                placeholder="https://example.com/document.pdf"
              />
            </div>

            <div className="space-y-2">
              <Label htmlFor="urlName">{t("upload.title")}</Label>
              <Input
                id="urlName"
                value={urlName}
                onChange={(e) => setUrlName(e.target.value)}
                placeholder="Document title"
              />
            </div>

            <div className="space-y-2">
              <Label htmlFor="urlDescription">{t("upload.description")}</Label>
              <Textarea
                id="urlDescription"
                value={urlDescription}
                onChange={(e) => setUrlDescription(e.target.value)}
                placeholder={t("upload.description")}
                rows={2}
              />
            </div>
          </div>

          <DialogFooter>
            <Button variant="outline" onClick={() => setShowUrlDialog(false)}>
              Cancel
            </Button>
            <Button
              onClick={handleUrlSubmit}
              disabled={!urlInput.trim() || !urlName.trim() || uploadState.uploading}
            >
              {uploadState.uploading ? (
                <>
                  <Loader2 className="h-4 w-4 mr-2 animate-spin" />
                  {t("upload.uploading")}
                </>
              ) : (
                t("upload.addUrl")
              )}
            </Button>
          </DialogFooter>
        </DialogContent>
      </Dialog>
    </div>
  );
}

export default EvidenceUpload;

```

# src/components/features/document/index.ts

```ts
/**
 * Document Components
 *
 * Components for document management and evidence upload.
 */

export { EvidenceUpload, type Evidence } from "./EvidenceUpload";
export { DocumentPreview, type PreviewDocument } from "./DocumentPreview";
export { DocumentLibrary } from "./DocumentLibrary";

```

# src/components/features/progress/ActivityTimeline.tsx

```tsx
"use client";

import { useState } from "react";
import { useTranslations } from "next-intl";
import { formatDistanceToNow } from "date-fns";
import {
  Plus,
  Play,
  Save,
  Paperclip,
  Trash2,
  RefreshCw,
  Send,
  CheckCircle,
  CheckCircle2,
  RefreshCcw,
  MessageSquare,
  ChevronDown,
  Loader2,
  Clock,
} from "lucide-react";
import { cn } from "@/lib/utils";
import { Button } from "@/components/ui/button";
import { ScrollArea } from "@/components/ui/scroll-area";
import type { EventType } from "@prisma/client";

// =============================================================================
// TYPES
// =============================================================================

export interface TimelineEvent {
  id: string;
  type: EventType;
  description: string;
  metadata: Record<string, unknown> | null;
  userId: string;
  userName: string;
  createdAt: Date;
}

interface ActivityTimelineProps {
  events: TimelineEvent[];
  totalCount: number;
  hasMore: boolean;
  onLoadMore?: () => void;
  isLoadingMore?: boolean;
  maxHeight?: string;
  showEmpty?: boolean;
  className?: string;
}

// =============================================================================
// EVENT TYPE CONFIG
// =============================================================================

const EVENT_CONFIG: Record<
  EventType,
  {
    icon: React.ElementType;
    color: string;
    bgColor: string;
    label: string;
  }
> = {
  CREATED: {
    icon: Plus,
    color: "text-green-600",
    bgColor: "bg-green-100",
    label: "Created",
  },
  STARTED: {
    icon: Play,
    color: "text-blue-600",
    bgColor: "bg-blue-100",
    label: "Started",
  },
  RESPONSE_SAVED: {
    icon: Save,
    color: "text-indigo-600",
    bgColor: "bg-indigo-100",
    label: "Response Saved",
  },
  EVIDENCE_ADDED: {
    icon: Paperclip,
    color: "text-purple-600",
    bgColor: "bg-purple-100",
    label: "Evidence Added",
  },
  EVIDENCE_REMOVED: {
    icon: Trash2,
    color: "text-orange-600",
    bgColor: "bg-orange-100",
    label: "Evidence Removed",
  },
  STATUS_CHANGED: {
    icon: RefreshCw,
    color: "text-yellow-600",
    bgColor: "bg-yellow-100",
    label: "Status Changed",
  },
  SUBMITTED: {
    icon: Send,
    color: "text-teal-600",
    bgColor: "bg-teal-100",
    label: "Submitted",
  },
  REVIEWED: {
    icon: CheckCircle,
    color: "text-cyan-600",
    bgColor: "bg-cyan-100",
    label: "Reviewed",
  },
  COMPLETED: {
    icon: CheckCircle2,
    color: "text-green-600",
    bgColor: "bg-green-100",
    label: "Completed",
  },
  REOPENED: {
    icon: RefreshCcw,
    color: "text-amber-600",
    bgColor: "bg-amber-100",
    label: "Reopened",
  },
  COMMENT_ADDED: {
    icon: MessageSquare,
    color: "text-slate-600",
    bgColor: "bg-slate-100",
    label: "Comment Added",
  },
};

// =============================================================================
// COMPONENT
// =============================================================================

export function ActivityTimeline({
  events,
  totalCount,
  hasMore,
  onLoadMore,
  isLoadingMore,
  maxHeight = "400px",
  showEmpty = true,
  className,
}: ActivityTimelineProps) {
  const t = useTranslations("progress");

  if (events.length === 0 && showEmpty) {
    return (
      <div
        className={cn(
          "flex flex-col items-center justify-center py-8 text-center",
          className
        )}
      >
        <Clock className="h-10 w-10 text-muted-foreground mb-3" />
        <p className="text-muted-foreground">{t("timeline.empty")}</p>
      </div>
    );
  }

  return (
    <div className={className}>
      <ScrollArea style={{ maxHeight }} className="pr-4">
        <div className="relative">
          {/* Timeline line */}
          <div className="absolute left-4 top-0 bottom-0 w-0.5 bg-border" />

          {/* Events */}
          <div className="space-y-4">
            {events.map((event, index) => {
              const config = EVENT_CONFIG[event.type];
              const Icon = config.icon;
              const isLast = index === events.length - 1;

              return (
                <div key={event.id} className="relative flex gap-4">
                  {/* Icon */}
                  <div
                    className={cn(
                      "relative z-10 flex h-8 w-8 items-center justify-center rounded-full",
                      config.bgColor
                    )}
                  >
                    <Icon className={cn("h-4 w-4", config.color)} />
                  </div>

                  {/* Content */}
                  <div className={cn("flex-1 pb-4", !isLast && "border-b")}>
                    <div className="flex items-start justify-between gap-2">
                      <div>
                        <p className="font-medium text-sm">
                          {event.description}
                        </p>
                        <p className="text-xs text-muted-foreground mt-0.5">
                          {event.userName}
                        </p>
                      </div>
                      <time className="text-xs text-muted-foreground whitespace-nowrap">
                        {formatDistanceToNow(new Date(event.createdAt), {
                          addSuffix: true,
                        })}
                      </time>
                    </div>

                    {/* Metadata */}
                    {event.metadata && Object.keys(event.metadata).length > 0 && (
                      <div className="mt-2 p-2 rounded bg-muted/50 text-xs">
                        {Object.entries(event.metadata).map(([key, value]) => (
                          <div key={key} className="flex gap-2">
                            <span className="text-muted-foreground capitalize">
                              {key}:
                            </span>
                            <span>{String(value)}</span>
                          </div>
                        ))}
                      </div>
                    )}
                  </div>
                </div>
              );
            })}
          </div>
        </div>

        {/* Load more */}
        {hasMore && onLoadMore && (
          <div className="mt-4 text-center">
            <Button
              variant="outline"
              size="sm"
              onClick={onLoadMore}
              disabled={isLoadingMore}
            >
              {isLoadingMore ? (
                <Loader2 className="h-4 w-4 mr-2 animate-spin" />
              ) : (
                <ChevronDown className="h-4 w-4 mr-2" />
              )}
              {t("timeline.loadMore")} ({totalCount - events.length} more)
            </Button>
          </div>
        )}
      </ScrollArea>
    </div>
  );
}

// =============================================================================
// COMPACT TIMELINE (for sidebar/summary views)
// =============================================================================

interface CompactTimelineProps {
  events: TimelineEvent[];
  limit?: number;
  className?: string;
}

export function CompactTimeline({
  events,
  limit = 5,
  className,
}: CompactTimelineProps) {
  const [expanded, setExpanded] = useState(false);
  const displayEvents = expanded ? events : events.slice(0, limit);
  const hasMore = events.length > limit;

  if (events.length === 0) {
    return null;
  }

  return (
    <div className={className}>
      <div className="space-y-2">
        {displayEvents.map((event) => {
          const config = EVENT_CONFIG[event.type];
          const Icon = config.icon;

          return (
            <div
              key={event.id}
              className="flex items-center gap-2 text-sm"
            >
              <div
                className={cn(
                  "flex h-6 w-6 items-center justify-center rounded-full",
                  config.bgColor
                )}
              >
                <Icon className={cn("h-3 w-3", config.color)} />
              </div>
              <span className="flex-1 truncate text-muted-foreground">
                {event.description}
              </span>
              <time className="text-xs text-muted-foreground">
                {formatDistanceToNow(new Date(event.createdAt), {
                  addSuffix: true,
                })}
              </time>
            </div>
          );
        })}
      </div>

      {hasMore && (
        <Button
          variant="ghost"
          size="sm"
          onClick={() => setExpanded(!expanded)}
          className="mt-2 w-full"
        >
          {expanded ? "Show less" : `Show ${events.length - limit} more`}
        </Button>
      )}
    </div>
  );
}

export default ActivityTimeline;

```

# src/components/features/progress/CategoryProgress.tsx

```tsx
"use client";

import { useMemo } from "react";
import { useTranslations } from "next-intl";
import { ChevronRight, CheckCircle2, Circle, AlertCircle } from "lucide-react";
import { cn } from "@/lib/utils";
import { ProgressBar } from "./ProgressBar";
import {
  Collapsible,
  CollapsibleContent,
  CollapsibleTrigger,
} from "@/components/ui/collapsible";
import { Button } from "@/components/ui/button";
import { Badge } from "@/components/ui/badge";

// =============================================================================
// TYPES
// =============================================================================

export interface CategoryProgressData {
  categoryId: string;
  categoryCode: string;
  categoryName: string;
  totalQuestions: number;
  answeredQuestions: number;
  percentComplete: number;
}

interface CategoryProgressProps {
  categories: CategoryProgressData[];
  onCategoryClick?: (categoryId: string) => void;
  showDetails?: boolean;
  className?: string;
}

interface CategoryProgressItemProps {
  category: CategoryProgressData;
  onClick?: () => void;
  showDetails?: boolean;
}

// =============================================================================
// HELPERS
// =============================================================================

function getStatusIcon(percentComplete: number) {
  if (percentComplete === 100) {
    return <CheckCircle2 className="h-4 w-4 text-green-500" />;
  }
  if (percentComplete > 0) {
    return <Circle className="h-4 w-4 text-blue-500" />;
  }
  return <AlertCircle className="h-4 w-4 text-muted-foreground" />;
}

function getStatusColor(percentComplete: number): string {
  if (percentComplete === 100) return "bg-green-100 text-green-800";
  if (percentComplete >= 75) return "bg-blue-100 text-blue-800";
  if (percentComplete >= 50) return "bg-yellow-100 text-yellow-800";
  if (percentComplete >= 25) return "bg-orange-100 text-orange-800";
  if (percentComplete > 0) return "bg-red-100 text-red-800";
  return "bg-gray-100 text-gray-800";
}

// =============================================================================
// CATEGORY PROGRESS ITEM
// =============================================================================

function CategoryProgressItem({
  category,
  onClick,
  showDetails,
}: CategoryProgressItemProps) {
  return (
    <div
      className={cn(
        "group flex items-center gap-4 p-3 rounded-lg border transition-colors",
        onClick && "cursor-pointer hover:bg-muted/50"
      )}
      onClick={onClick}
    >
      {/* Status Icon */}
      <div className="flex-shrink-0">{getStatusIcon(category.percentComplete)}</div>

      {/* Content */}
      <div className="flex-1 min-w-0">
        <div className="flex items-center justify-between mb-1">
          <span className="font-medium text-sm truncate">
            {category.categoryCode} - {category.categoryName}
          </span>
          <Badge
            variant="secondary"
            className={cn("text-xs ml-2", getStatusColor(category.percentComplete))}
          >
            {category.percentComplete}%
          </Badge>
        </div>

        {showDetails && (
          <ProgressBar
            value={category.percentComplete}
            showLabel={false}
            size="sm"
            className="mb-1"
          />
        )}

        <div className="flex items-center justify-between text-xs text-muted-foreground">
          <span>
            {category.answeredQuestions} / {category.totalQuestions} questions
          </span>
          {category.percentComplete === 100 && (
            <span className="text-green-600 font-medium">Complete</span>
          )}
        </div>
      </div>

      {/* Arrow */}
      {onClick && (
        <ChevronRight className="h-4 w-4 text-muted-foreground group-hover:text-foreground transition-colors flex-shrink-0" />
      )}
    </div>
  );
}

// =============================================================================
// MAIN COMPONENT
// =============================================================================

export function CategoryProgress({
  categories,
  onCategoryClick,
  showDetails = true,
  className,
}: CategoryProgressProps) {
  const t = useTranslations("progress");

  // Calculate summary stats
  const summary = useMemo(() => {
    const totalQuestions = categories.reduce((sum, c) => sum + c.totalQuestions, 0);
    const answeredQuestions = categories.reduce(
      (sum, c) => sum + c.answeredQuestions,
      0
    );
    const completedCategories = categories.filter(
      (c) => c.percentComplete === 100
    ).length;
    const inProgressCategories = categories.filter(
      (c) => c.percentComplete > 0 && c.percentComplete < 100
    ).length;
    const notStartedCategories = categories.filter(
      (c) => c.percentComplete === 0
    ).length;

    return {
      totalQuestions,
      answeredQuestions,
      overallProgress:
        totalQuestions > 0
          ? Math.round((answeredQuestions / totalQuestions) * 100)
          : 0,
      completedCategories,
      inProgressCategories,
      notStartedCategories,
    };
  }, [categories]);

  return (
    <div className={className}>
      {/* Summary */}
      <div className="mb-4 p-4 rounded-lg bg-muted/30 border">
        <div className="flex items-center justify-between mb-2">
          <span className="font-medium">{t("categories.overallProgress")}</span>
          <span className="text-lg font-bold">{summary.overallProgress}%</span>
        </div>
        <ProgressBar value={summary.overallProgress} size="lg" showLabel={false} />
        <div className="flex items-center justify-between mt-3 text-sm">
          <div className="flex items-center gap-4">
            <span className="flex items-center gap-1">
              <CheckCircle2 className="h-3 w-3 text-green-500" />
              {summary.completedCategories} complete
            </span>
            <span className="flex items-center gap-1">
              <Circle className="h-3 w-3 text-blue-500" />
              {summary.inProgressCategories} in progress
            </span>
            <span className="flex items-center gap-1">
              <AlertCircle className="h-3 w-3 text-muted-foreground" />
              {summary.notStartedCategories} not started
            </span>
          </div>
          <span className="text-muted-foreground">
            {summary.answeredQuestions} / {summary.totalQuestions} questions
          </span>
        </div>
      </div>

      {/* Category List */}
      <div className="space-y-2">
        {categories.map((category) => (
          <CategoryProgressItem
            key={category.categoryId}
            category={category}
            onClick={onCategoryClick ? () => onCategoryClick(category.categoryId) : undefined}
            showDetails={showDetails}
          />
        ))}
      </div>
    </div>
  );
}

// =============================================================================
// COLLAPSIBLE CATEGORY PROGRESS
// =============================================================================

interface CollapsibleCategoryProgressProps {
  categories: CategoryProgressData[];
  onCategoryClick?: (categoryId: string) => void;
  defaultExpanded?: boolean;
  title?: string;
  className?: string;
}

export function CollapsibleCategoryProgress({
  categories,
  onCategoryClick,
  defaultExpanded = false,
  title = "Category Progress",
  className,
}: CollapsibleCategoryProgressProps) {
  const summary = useMemo(() => {
    const totalQuestions = categories.reduce((sum, c) => sum + c.totalQuestions, 0);
    const answeredQuestions = categories.reduce(
      (sum, c) => sum + c.answeredQuestions,
      0
    );
    return totalQuestions > 0
      ? Math.round((answeredQuestions / totalQuestions) * 100)
      : 0;
  }, [categories]);

  return (
    <Collapsible defaultOpen={defaultExpanded} className={className}>
      <CollapsibleTrigger asChild>
        <Button
          variant="ghost"
          className="w-full flex items-center justify-between p-4 h-auto"
        >
          <div className="flex items-center gap-3">
            <span className="font-medium">{title}</span>
            <Badge variant="secondary">{summary}%</Badge>
          </div>
          <ChevronRight className="h-4 w-4 transition-transform ui-expanded:rotate-90" />
        </Button>
      </CollapsibleTrigger>
      <CollapsibleContent className="px-4 pb-4">
        <div className="space-y-2">
          {categories.map((category) => (
            <CategoryProgressItem
              key={category.categoryId}
              category={category}
              onClick={
                onCategoryClick
                  ? () => onCategoryClick(category.categoryId)
                  : undefined
              }
              showDetails={false}
            />
          ))}
        </div>
      </CollapsibleContent>
    </Collapsible>
  );
}

export default CategoryProgress;

```

# src/components/features/progress/ProgressBar.tsx

```tsx
"use client";

import { cn } from "@/lib/utils";

// =============================================================================
// TYPES
// =============================================================================

interface ProgressBarProps {
  value: number;
  max?: number;
  showLabel?: boolean;
  labelPosition?: "inside" | "outside" | "none";
  size?: "sm" | "md" | "lg";
  variant?: "default" | "success" | "warning" | "danger";
  animated?: boolean;
  className?: string;
}

// =============================================================================
// HELPERS
// =============================================================================

function getColorClass(value: number, variant?: string): string {
  if (variant === "success") return "bg-green-500";
  if (variant === "warning") return "bg-yellow-500";
  if (variant === "danger") return "bg-red-500";

  // Default: gradient based on value
  if (value >= 80) return "bg-green-500";
  if (value >= 60) return "bg-blue-500";
  if (value >= 40) return "bg-yellow-500";
  if (value >= 20) return "bg-orange-500";
  return "bg-red-500";
}

function getSizeClass(size: string): { bar: string; text: string } {
  switch (size) {
    case "sm":
      return { bar: "h-1.5", text: "text-[10px]" };
    case "lg":
      return { bar: "h-4", text: "text-sm" };
    default:
      return { bar: "h-2.5", text: "text-xs" };
  }
}

// =============================================================================
// COMPONENT
// =============================================================================

export function ProgressBar({
  value,
  max = 100,
  showLabel = true,
  labelPosition = "outside",
  size = "md",
  variant,
  animated = false,
  className,
}: ProgressBarProps) {
  const percentage = Math.min(Math.max((value / max) * 100, 0), 100);
  const sizeClass = getSizeClass(size);
  const colorClass = getColorClass(percentage, variant);

  return (
    <div className={cn("w-full", className)}>
      {showLabel && labelPosition === "outside" && (
        <div className="flex justify-between mb-1">
          <span className={cn("font-medium text-foreground", sizeClass.text)}>
            Progress
          </span>
          <span className={cn("text-muted-foreground", sizeClass.text)}>
            {Math.round(percentage)}%
          </span>
        </div>
      )}

      <div
        className={cn(
          "w-full bg-muted rounded-full overflow-hidden",
          sizeClass.bar
        )}
      >
        <div
          className={cn(
            "h-full rounded-full transition-all duration-500 ease-out",
            colorClass,
            animated && "animate-pulse",
            labelPosition === "inside" &&
              "flex items-center justify-end pr-2 min-w-[2rem]"
          )}
          style={{ width: `${percentage}%` }}
        >
          {showLabel && labelPosition === "inside" && percentage > 15 && (
            <span
              className={cn(
                "font-medium text-white",
                size === "lg" ? "text-xs" : "text-[10px]"
              )}
            >
              {Math.round(percentage)}%
            </span>
          )}
        </div>
      </div>
    </div>
  );
}

// =============================================================================
// CIRCULAR PROGRESS
// =============================================================================

interface CircularProgressProps {
  value: number;
  max?: number;
  size?: number;
  strokeWidth?: number;
  showLabel?: boolean;
  className?: string;
}

export function CircularProgress({
  value,
  max = 100,
  size = 100,
  strokeWidth = 8,
  showLabel = true,
  className,
}: CircularProgressProps) {
  const percentage = Math.min(Math.max((value / max) * 100, 0), 100);
  const radius = (size - strokeWidth) / 2;
  const circumference = radius * 2 * Math.PI;
  const offset = circumference - (percentage / 100) * circumference;

  const colorClass =
    percentage >= 80
      ? "text-green-500"
      : percentage >= 60
        ? "text-blue-500"
        : percentage >= 40
          ? "text-yellow-500"
          : percentage >= 20
            ? "text-orange-500"
            : "text-red-500";

  return (
    <div className={cn("relative inline-flex", className)}>
      <svg width={size} height={size} className="-rotate-90">
        {/* Background circle */}
        <circle
          cx={size / 2}
          cy={size / 2}
          r={radius}
          fill="none"
          stroke="currentColor"
          strokeWidth={strokeWidth}
          className="text-muted"
        />
        {/* Progress circle */}
        <circle
          cx={size / 2}
          cy={size / 2}
          r={radius}
          fill="none"
          stroke="currentColor"
          strokeWidth={strokeWidth}
          strokeLinecap="round"
          strokeDasharray={circumference}
          strokeDashoffset={offset}
          className={cn("transition-all duration-500 ease-out", colorClass)}
        />
      </svg>
      {showLabel && (
        <div className="absolute inset-0 flex items-center justify-center">
          <span className="text-lg font-semibold">
            {Math.round(percentage)}%
          </span>
        </div>
      )}
    </div>
  );
}

export default ProgressBar;

```

# src/components/features/questionnaire/amendment-badge.tsx

```tsx
"use client";

import { useTranslations } from "next-intl";
import { cn } from "@/lib/utils";
import { Badge } from "@/components/ui/badge";
import {
  Sparkles,
  RefreshCw,
  GitMerge,
  Trash2,
  FileEdit,
} from "lucide-react";
import type { PQAmendmentStatus } from "@prisma/client";

interface AmendmentBadgeProps {
  status: PQAmendmentStatus;
  previousPQNumber?: string | null;
  showLabel?: boolean;
  size?: "sm" | "md";
  className?: string;
}

const statusConfig: Record<
  PQAmendmentStatus,
  {
    icon: React.ComponentType<{ className?: string }>;
    colorClasses: string;
    show: boolean;
  }
> = {
  NO_CHANGE: {
    icon: () => null,
    colorClasses: "",
    show: false,
  },
  NEW: {
    icon: Sparkles,
    colorClasses:
      "bg-emerald-100 text-emerald-700 border-emerald-200 dark:bg-emerald-900/50 dark:text-emerald-400 dark:border-emerald-800",
    show: true,
  },
  REVISED: {
    icon: RefreshCw,
    colorClasses:
      "bg-amber-100 text-amber-700 border-amber-200 dark:bg-amber-900/50 dark:text-amber-400 dark:border-amber-800",
    show: true,
  },
  MERGED: {
    icon: GitMerge,
    colorClasses:
      "bg-blue-100 text-blue-700 border-blue-200 dark:bg-blue-900/50 dark:text-blue-400 dark:border-blue-800",
    show: true,
  },
  DELETED: {
    icon: Trash2,
    colorClasses:
      "bg-red-100 text-red-700 border-red-200 dark:bg-red-900/50 dark:text-red-400 dark:border-red-800",
    show: true,
  },
  REFERENCE_REVISED: {
    icon: FileEdit,
    colorClasses:
      "bg-slate-100 text-slate-600 border-slate-200 dark:bg-slate-800 dark:text-slate-400 dark:border-slate-700",
    show: true,
  },
};

export function AmendmentBadge({
  status,
  previousPQNumber,
  showLabel = true,
  size = "sm",
  className,
}: AmendmentBadgeProps) {
  const t = useTranslations("questionDetail.amendment");

  const config = statusConfig[status];

  if (!config.show) {
    return null;
  }

  const Icon = config.icon;
  const iconSize = size === "sm" ? "h-3 w-3" : "h-3.5 w-3.5";
  const textSize = size === "sm" ? "text-xs" : "text-sm";

  return (
    <Badge
      variant="outline"
      className={cn(
        "font-medium gap-1",
        config.colorClasses,
        textSize,
        className
      )}
    >
      <Icon className={iconSize} />
      {showLabel && (
        <span>
          {t(status)}
          {previousPQNumber && status === "MERGED" && (
            <span className="ml-1 opacity-75">
              ({t("from")} {previousPQNumber})
            </span>
          )}
          {previousPQNumber && status === "REVISED" && (
            <span className="ml-1 opacity-75">
              ({t("was")} {previousPQNumber})
            </span>
          )}
        </span>
      )}
    </Badge>
  );
}

// Utility component for displaying multiple amendment indicators
interface AmendmentIndicatorsProps {
  status: PQAmendmentStatus;
  previousPQNumber?: string | null;
  isNewIn2024?: boolean;
  className?: string;
}

export function AmendmentIndicators({
  status,
  previousPQNumber,
  isNewIn2024,
  className,
}: AmendmentIndicatorsProps) {
  const t = useTranslations("questionDetail.amendment");

  // If status is NEW and isNewIn2024 is also true, only show NEW badge
  if (status === "NEW" || (status === "NO_CHANGE" && isNewIn2024)) {
    return (
      <div className={cn("flex flex-wrap gap-1", className)}>
        <Badge
          variant="outline"
          className="bg-emerald-100 text-emerald-700 border-emerald-200 dark:bg-emerald-900/50 dark:text-emerald-400 dark:border-emerald-800 text-xs font-medium gap-1"
        >
          <Sparkles className="h-3 w-3" />
          {t("NEW")}
        </Badge>
      </div>
    );
  }

  // Show the regular amendment badge
  if (status !== "NO_CHANGE") {
    return (
      <div className={cn("flex flex-wrap gap-1", className)}>
        <AmendmentBadge
          status={status}
          previousPQNumber={previousPQNumber}
          size="sm"
        />
      </div>
    );
  }

  return null;
}

```

# src/components/features/questionnaire/ans/ans-browser-skeleton.tsx

```tsx
import { Skeleton } from "@/components/ui/skeleton";
import { Card, CardContent, CardHeader } from "@/components/ui/card";

export function ANSBrowserSkeleton() {
  return (
    <div className="flex flex-col gap-6">
      {/* Header */}
      <div className="flex flex-col gap-2">
        <Skeleton className="h-4 w-48" />
        <Skeleton className="h-8 w-64" />
        <Skeleton className="h-4 w-96" />
      </div>

      <div className="flex gap-6">
        {/* Sidebar Filters */}
        <div className="hidden lg:block w-72 shrink-0">
          <Card>
            <CardHeader className="pb-3">
              <Skeleton className="h-5 w-24" />
            </CardHeader>
            <CardContent className="space-y-4">
              {/* Search */}
              <Skeleton className="h-10 w-full" />

              {/* Filter sections */}
              {[1, 2, 3, 4].map((i) => (
                <div key={i} className="space-y-2">
                  <Skeleton className="h-10 w-full" />
                </div>
              ))}
            </CardContent>
          </Card>
        </div>

        {/* Main Content */}
        <div className="flex-1 space-y-4">
          {/* Active Filters */}
          <div className="flex flex-wrap gap-2">
            <Skeleton className="h-6 w-24 rounded-full" />
            <Skeleton className="h-6 w-32 rounded-full" />
          </div>

          {/* Stats Bar */}
          <div className="flex items-center justify-between">
            <Skeleton className="h-4 w-48" />
            <Skeleton className="h-8 w-32" />
          </div>

          {/* Question List */}
          <div className="space-y-3">
            {[1, 2, 3, 4, 5, 6, 7, 8].map((i) => (
              <Card key={i}>
                <CardContent className="p-4">
                  <div className="flex items-start gap-4">
                    <Skeleton className="h-10 w-16 rounded" />
                    <div className="flex-1 space-y-2">
                      <Skeleton className="h-4 w-full" />
                      <Skeleton className="h-4 w-3/4" />
                      <div className="flex gap-2">
                        <Skeleton className="h-5 w-16 rounded-full" />
                        <Skeleton className="h-5 w-12 rounded-full" />
                      </div>
                    </div>
                  </div>
                </CardContent>
              </Card>
            ))}
          </div>

          {/* Pagination */}
          <div className="flex justify-center gap-2 pt-4">
            <Skeleton className="h-10 w-10" />
            <Skeleton className="h-10 w-10" />
            <Skeleton className="h-10 w-10" />
            <Skeleton className="h-10 w-10" />
          </div>
        </div>
      </div>
    </div>
  );
}

```

# src/components/features/questionnaire/ans/ans-browser.tsx

```tsx
"use client";

import { useCallback, useMemo, useState } from "react";
import { useRouter, useSearchParams } from "next/navigation";
import { useTranslations } from "next-intl";
import {
  ChevronRight,
  FileText,
  Filter,
  Home,
  Search,
  X,
} from "lucide-react";
import Link from "next/link";
import {
  Accordion,
  AccordionContent,
  AccordionItem,
  AccordionTrigger,
} from "@/components/ui/accordion";
import { Badge } from "@/components/ui/badge";
import { Button } from "@/components/ui/button";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Input } from "@/components/ui/input";
import { ScrollArea } from "@/components/ui/scroll-area";
import { Separator } from "@/components/ui/separator";
import { Switch } from "@/components/ui/switch";
import { Label } from "@/components/ui/label";
import {
  Sheet,
  SheetContent,
  SheetHeader,
  SheetTitle,
  SheetTrigger,
} from "@/components/ui/sheet";
import { AuditAreaFilter } from "./audit-area-filter";
import { CriticalElementFilter } from "./critical-element-filter";
import { PQList } from "./pq-list";
import { USOAP_AUDIT_AREAS } from "@/lib/questionnaire/constants";
import type { USOAPAuditArea, CriticalElement } from "@prisma/client";

interface ANSBrowserProps {
  locale: string;
  initialFilters: {
    auditArea?: string;
    criticalElement?: string;
    isPriority?: string;
    requiresOnSite?: string;
    search?: string;
    page?: string;
  };
}

export function ANSBrowser({ locale, initialFilters }: ANSBrowserProps) {
  const t = useTranslations("ansBrowser");
  const router = useRouter();
  const searchParams = useSearchParams();

  // Parse initial filters
  const [searchQuery, setSearchQuery] = useState(initialFilters.search || "");
  const [mobileFiltersOpen, setMobileFiltersOpen] = useState(false);

  // Get current filter values from URL
  const selectedAuditAreas = useMemo(() => {
    const param = searchParams.get("auditArea");
    return param ? param.split(",") as USOAPAuditArea[] : [];
  }, [searchParams]);

  const selectedCriticalElements = useMemo(() => {
    const param = searchParams.get("criticalElement");
    return param ? param.split(",") as CriticalElement[] : [];
  }, [searchParams]);

  const isPriority = searchParams.get("isPriority") === "true";
  const requiresOnSite = searchParams.get("requiresOnSite") === "true";
  const currentSearch = searchParams.get("search") || "";
  const currentPage = parseInt(searchParams.get("page") || "1", 10);

  // Update URL with new filters
  const updateFilters = useCallback(
    (updates: Record<string, string | null>) => {
      const params = new URLSearchParams(searchParams.toString());

      Object.entries(updates).forEach(([key, value]) => {
        if (value === null || value === "" || value === "false") {
          params.delete(key);
        } else {
          params.set(key, value);
        }
      });

      // Reset page when filters change (except when changing page itself)
      if (!("page" in updates)) {
        params.delete("page");
      }

      router.push(`/${locale}/questionnaires/ans?${params.toString()}`);
    },
    [router, searchParams, locale]
  );

  // Filter handlers
  const handleAuditAreaChange = useCallback(
    (areas: USOAPAuditArea[]) => {
      updateFilters({ auditArea: areas.length > 0 ? areas.join(",") : null });
    },
    [updateFilters]
  );

  const handleCriticalElementChange = useCallback(
    (elements: CriticalElement[]) => {
      updateFilters({
        criticalElement: elements.length > 0 ? elements.join(",") : null,
      });
    },
    [updateFilters]
  );

  const handlePriorityToggle = useCallback(
    (checked: boolean) => {
      updateFilters({ isPriority: checked ? "true" : null });
    },
    [updateFilters]
  );

  const handleOnSiteToggle = useCallback(
    (checked: boolean) => {
      updateFilters({ requiresOnSite: checked ? "true" : null });
    },
    [updateFilters]
  );

  const handleSearch = useCallback(() => {
    updateFilters({ search: searchQuery || null });
  }, [updateFilters, searchQuery]);

  const handleSearchKeyDown = useCallback(
    (e: React.KeyboardEvent) => {
      if (e.key === "Enter") {
        handleSearch();
      }
    },
    [handleSearch]
  );

  const handlePageChange = useCallback(
    (page: number) => {
      updateFilters({ page: page > 1 ? page.toString() : null });
    },
    [updateFilters]
  );

  const clearAllFilters = useCallback(() => {
    setSearchQuery("");
    router.push(`/${locale}/questionnaires/ans`);
  }, [router, locale]);

  const removeFilter = useCallback(
    (type: string, value?: string) => {
      switch (type) {
        case "auditArea":
          if (value) {
            const newAreas = selectedAuditAreas.filter((a) => a !== value);
            handleAuditAreaChange(newAreas);
          }
          break;
        case "criticalElement":
          if (value) {
            const newElements = selectedCriticalElements.filter(
              (e) => e !== value
            );
            handleCriticalElementChange(newElements);
          }
          break;
        case "isPriority":
          handlePriorityToggle(false);
          break;
        case "requiresOnSite":
          handleOnSiteToggle(false);
          break;
        case "search":
          setSearchQuery("");
          updateFilters({ search: null });
          break;
      }
    },
    [
      selectedAuditAreas,
      selectedCriticalElements,
      handleAuditAreaChange,
      handleCriticalElementChange,
      handlePriorityToggle,
      handleOnSiteToggle,
      updateFilters,
    ]
  );

  // Count active filters
  const activeFilterCount =
    selectedAuditAreas.length +
    selectedCriticalElements.length +
    (isPriority ? 1 : 0) +
    (requiresOnSite ? 1 : 0) +
    (currentSearch ? 1 : 0);

  // Filter sidebar content (shared between desktop and mobile)
  const FilterContent = (
    <div className="space-y-4">
      {/* Search */}
      <div className="space-y-2">
        <Label htmlFor="search">{t("filters.search")}</Label>
        <div className="flex gap-2">
          <Input
            id="search"
            placeholder={t("filters.searchPlaceholder")}
            value={searchQuery}
            onChange={(e) => setSearchQuery(e.target.value)}
            onKeyDown={handleSearchKeyDown}
            className="flex-1"
          />
          <Button size="icon" variant="secondary" onClick={handleSearch}>
            <Search className="h-4 w-4" />
          </Button>
        </div>
      </div>

      <Separator />

      {/* Filter Accordion */}
      <Accordion
        type="multiple"
        defaultValue={["auditArea", "criticalElement"]}
        className="w-full"
      >
        {/* Audit Area Filter */}
        <AccordionItem value="auditArea">
          <AccordionTrigger className="text-sm font-medium">
            {t("filters.auditArea")}
            {selectedAuditAreas.length > 0 && (
              <Badge variant="secondary" className="ml-2">
                {selectedAuditAreas.length}
              </Badge>
            )}
          </AccordionTrigger>
          <AccordionContent>
            <AuditAreaFilter
              selected={selectedAuditAreas}
              onChange={handleAuditAreaChange}
              locale={locale}
            />
          </AccordionContent>
        </AccordionItem>

        {/* Critical Element Filter */}
        <AccordionItem value="criticalElement">
          <AccordionTrigger className="text-sm font-medium">
            {t("filters.criticalElement")}
            {selectedCriticalElements.length > 0 && (
              <Badge variant="secondary" className="ml-2">
                {selectedCriticalElements.length}
              </Badge>
            )}
          </AccordionTrigger>
          <AccordionContent>
            <CriticalElementFilter
              selected={selectedCriticalElements}
              onChange={handleCriticalElementChange}
              locale={locale}
            />
          </AccordionContent>
        </AccordionItem>

        {/* Additional Filters */}
        <AccordionItem value="additional">
          <AccordionTrigger className="text-sm font-medium">
            {t("filters.additional")}
          </AccordionTrigger>
          <AccordionContent>
            <div className="space-y-4">
              <div className="flex items-center justify-between">
                <Label
                  htmlFor="priority"
                  className="text-sm cursor-pointer flex-1"
                >
                  {t("filters.priorityPQ")}
                </Label>
                <Switch
                  id="priority"
                  checked={isPriority}
                  onCheckedChange={handlePriorityToggle}
                />
              </div>
              <div className="flex items-center justify-between">
                <Label
                  htmlFor="onsite"
                  className="text-sm cursor-pointer flex-1"
                >
                  {t("filters.requiresOnSite")}
                </Label>
                <Switch
                  id="onsite"
                  checked={requiresOnSite}
                  onCheckedChange={handleOnSiteToggle}
                />
              </div>
            </div>
          </AccordionContent>
        </AccordionItem>
      </Accordion>

      {/* Clear All */}
      {activeFilterCount > 0 && (
        <>
          <Separator />
          <Button
            variant="outline"
            className="w-full"
            onClick={clearAllFilters}
          >
            {t("filters.clearAll")} ({activeFilterCount})
          </Button>
        </>
      )}
    </div>
  );

  return (
    <div className="flex flex-col gap-6">
      {/* Breadcrumb & Header */}
      <div>
        <nav className="flex items-center gap-1 text-sm text-muted-foreground mb-2">
          <Link
            href={`/${locale}/questionnaires`}
            className="hover:text-foreground transition-colors"
          >
            <Home className="h-4 w-4" />
          </Link>
          <ChevronRight className="h-4 w-4" />
          <Link
            href={`/${locale}/questionnaires`}
            className="hover:text-foreground transition-colors"
          >
            {t("breadcrumb.questionnaires")}
          </Link>
          <ChevronRight className="h-4 w-4" />
          <span className="text-foreground font-medium">{t("breadcrumb.ans")}</span>
        </nav>

        <div className="flex items-start justify-between gap-4">
          <div>
            <h1 className="text-2xl font-bold tracking-tight flex items-center gap-2">
              <FileText className="h-6 w-6 text-blue-600" />
              {t("title")}
            </h1>
            <p className="text-muted-foreground">{t("subtitle")}</p>
          </div>

          {/* Mobile Filter Button */}
          <Sheet open={mobileFiltersOpen} onOpenChange={setMobileFiltersOpen}>
            <SheetTrigger asChild>
              <Button variant="outline" className="lg:hidden" size="sm">
                <Filter className="h-4 w-4 mr-2" />
                {t("filters.title")}
                {activeFilterCount > 0 && (
                  <Badge variant="secondary" className="ml-2">
                    {activeFilterCount}
                  </Badge>
                )}
              </Button>
            </SheetTrigger>
            <SheetContent side="left" className="w-80">
              <SheetHeader>
                <SheetTitle>{t("filters.title")}</SheetTitle>
              </SheetHeader>
              <ScrollArea className="h-[calc(100vh-8rem)] mt-4">
                {FilterContent}
              </ScrollArea>
            </SheetContent>
          </Sheet>
        </div>
      </div>

      <div className="flex gap-6">
        {/* Desktop Sidebar */}
        <div className="hidden lg:block w-72 shrink-0">
          <Card className="sticky top-4">
            <CardHeader className="pb-3">
              <CardTitle className="text-base flex items-center gap-2">
                <Filter className="h-4 w-4" />
                {t("filters.title")}
              </CardTitle>
            </CardHeader>
            <CardContent>
              <ScrollArea className="h-[calc(100vh-16rem)]">
                {FilterContent}
              </ScrollArea>
            </CardContent>
          </Card>
        </div>

        {/* Main Content */}
        <div className="flex-1 min-w-0">
          {/* Active Filters Display */}
          {activeFilterCount > 0 && (
            <div className="flex flex-wrap gap-2 mb-4">
              {selectedAuditAreas.map((area) => (
                <Badge
                  key={area}
                  variant="secondary"
                  className="gap-1 bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400"
                >
                  {USOAP_AUDIT_AREAS[area].name[locale === "fr" ? "fr" : "en"]}
                  <button
                    onClick={() => removeFilter("auditArea", area)}
                    className="ml-1 hover:text-blue-900"
                  >
                    <X className="h-3 w-3" />
                  </button>
                </Badge>
              ))}
              {selectedCriticalElements.map((element) => (
                <Badge
                  key={element}
                  variant="secondary"
                  className="gap-1 bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400"
                >
                  {element.replace("_", "-")}
                  <button
                    onClick={() => removeFilter("criticalElement", element)}
                    className="ml-1 hover:text-purple-900"
                  >
                    <X className="h-3 w-3" />
                  </button>
                </Badge>
              ))}
              {isPriority && (
                <Badge
                  variant="secondary"
                  className="gap-1 bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400"
                >
                  {t("filters.priorityPQ")}
                  <button
                    onClick={() => removeFilter("isPriority")}
                    className="ml-1 hover:text-amber-900"
                  >
                    <X className="h-3 w-3" />
                  </button>
                </Badge>
              )}
              {requiresOnSite && (
                <Badge
                  variant="secondary"
                  className="gap-1 bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400"
                >
                  {t("filters.requiresOnSite")}
                  <button
                    onClick={() => removeFilter("requiresOnSite")}
                    className="ml-1 hover:text-orange-900"
                  >
                    <X className="h-3 w-3" />
                  </button>
                </Badge>
              )}
              {currentSearch && (
                <Badge variant="secondary" className="gap-1">
                  &quot;{currentSearch}&quot;
                  <button
                    onClick={() => removeFilter("search")}
                    className="ml-1 hover:text-foreground"
                  >
                    <X className="h-3 w-3" />
                  </button>
                </Badge>
              )}
            </div>
          )}

          {/* Question List */}
          <PQList
            locale={locale}
            filters={{
              auditAreas: selectedAuditAreas,
              criticalElements: selectedCriticalElements,
              isPriority,
              requiresOnSite,
              search: currentSearch,
            }}
            page={currentPage}
            onPageChange={handlePageChange}
          />
        </div>
      </div>
    </div>
  );
}

```

# src/components/features/questionnaire/ans/audit-area-filter.tsx

```tsx
"use client";

import { useTranslations } from "next-intl";
import { Checkbox } from "@/components/ui/checkbox";
import { Button } from "@/components/ui/button";
import { Badge } from "@/components/ui/badge";
import { cn } from "@/lib/utils";
import { getAuditAreasArray } from "@/lib/questionnaire/constants";
import type { USOAPAuditArea } from "@prisma/client";

interface AuditAreaFilterProps {
  selected: USOAPAuditArea[];
  onChange: (areas: USOAPAuditArea[]) => void;
  locale: string;
}

export function AuditAreaFilter({
  selected,
  onChange,
  locale,
}: AuditAreaFilterProps) {
  const t = useTranslations("ansBrowser");
  const areas = getAuditAreasArray();
  const lang = locale === "fr" ? "fr" : "en";

  const handleToggle = (area: USOAPAuditArea) => {
    if (selected.includes(area)) {
      onChange(selected.filter((a) => a !== area));
    } else {
      onChange([...selected, area]);
    }
  };

  const selectAll = () => {
    onChange(areas.map((a) => a.code));
  };

  const clearAll = () => {
    onChange([]);
  };

  return (
    <div className="space-y-3">
      {/* Quick Actions */}
      <div className="flex gap-2">
        <Button
          variant="ghost"
          size="sm"
          className="h-7 text-xs"
          onClick={selectAll}
        >
          {t("filters.selectAll")}
        </Button>
        <Button
          variant="ghost"
          size="sm"
          className="h-7 text-xs"
          onClick={clearAll}
          disabled={selected.length === 0}
        >
          {t("filters.clear")}
        </Button>
      </div>

      {/* Area List */}
      <div className="space-y-1">
        {areas.map((area) => {
          const isSelected = selected.includes(area.code);
          return (
            <label
              key={area.code}
              className={cn(
                "flex items-center gap-3 rounded-md p-2 cursor-pointer transition-colors",
                isSelected
                  ? "bg-blue-50 dark:bg-blue-950/30"
                  : "hover:bg-muted/50"
              )}
            >
              <Checkbox
                checked={isSelected}
                onCheckedChange={() => handleToggle(area.code)}
                className="data-[state=checked]:bg-blue-600 data-[state=checked]:border-blue-600"
              />
              <div className="flex-1 min-w-0">
                <div className="flex items-center gap-2">
                  <span
                    className={cn(
                      "font-mono text-xs font-bold px-1.5 py-0.5 rounded",
                      isSelected
                        ? "bg-blue-600 text-white"
                        : "bg-muted text-muted-foreground"
                    )}
                  >
                    {area.code}
                  </span>
                  <span className="text-sm truncate">{area.name[lang]}</span>
                </div>
              </div>
              <Badge
                variant="outline"
                className={cn(
                  "text-xs shrink-0",
                  isSelected && "border-blue-300 text-blue-600"
                )}
              >
                {area.pqCount}
              </Badge>
            </label>
          );
        })}
      </div>
    </div>
  );
}

```

# src/components/features/questionnaire/ans/critical-element-filter.tsx

```tsx
"use client";

import { useTranslations } from "next-intl";
import { Checkbox } from "@/components/ui/checkbox";
import { Button } from "@/components/ui/button";
import { cn } from "@/lib/utils";
import { getCriticalElementsArray } from "@/lib/questionnaire/constants";
import type { CriticalElement } from "@prisma/client";

interface CriticalElementFilterProps {
  selected: CriticalElement[];
  onChange: (elements: CriticalElement[]) => void;
  locale: string;
}

export function CriticalElementFilter({
  selected,
  onChange,
  locale,
}: CriticalElementFilterProps) {
  const t = useTranslations("ansBrowser");
  const elements = getCriticalElementsArray();
  const lang = locale === "fr" ? "fr" : "en";

  const handleToggle = (element: CriticalElement) => {
    if (selected.includes(element)) {
      onChange(selected.filter((e) => e !== element));
    } else {
      onChange([...selected, element]);
    }
  };

  const selectAll = () => {
    onChange(elements.map((e) => e.code));
  };

  const clearAll = () => {
    onChange([]);
  };

  return (
    <div className="space-y-3">
      {/* Quick Actions */}
      <div className="flex gap-2">
        <Button
          variant="ghost"
          size="sm"
          className="h-7 text-xs"
          onClick={selectAll}
        >
          {t("filters.selectAll")}
        </Button>
        <Button
          variant="ghost"
          size="sm"
          className="h-7 text-xs"
          onClick={clearAll}
          disabled={selected.length === 0}
        >
          {t("filters.clear")}
        </Button>
      </div>

      {/* Element List */}
      <div className="space-y-1">
        {elements.map((element) => {
          const isSelected = selected.includes(element.code);
          const displayCode = element.code.replace("_", "-");

          return (
            <label
              key={element.code}
              className={cn(
                "flex items-start gap-3 rounded-md p-2 cursor-pointer transition-colors",
                isSelected
                  ? "bg-purple-50 dark:bg-purple-950/30"
                  : "hover:bg-muted/50"
              )}
            >
              <Checkbox
                checked={isSelected}
                onCheckedChange={() => handleToggle(element.code)}
                className="mt-0.5 data-[state=checked]:bg-purple-600 data-[state=checked]:border-purple-600"
              />
              <div className="flex-1 min-w-0">
                <div className="flex items-center gap-2 mb-0.5">
                  <span
                    className={cn(
                      "font-mono text-xs font-bold px-1.5 py-0.5 rounded",
                      isSelected
                        ? "bg-purple-600 text-white"
                        : "bg-muted text-muted-foreground"
                    )}
                  >
                    {displayCode}
                  </span>
                </div>
                <span className="text-xs text-muted-foreground line-clamp-2">
                  {element.name[lang]}
                </span>
              </div>
            </label>
          );
        })}
      </div>
    </div>
  );
}

```

# src/components/features/questionnaire/ans/index.ts

```ts
export { ANSBrowser } from "./ans-browser";
export { ANSBrowserSkeleton } from "./ans-browser-skeleton";
export { AuditAreaFilter } from "./audit-area-filter";
export { CriticalElementFilter } from "./critical-element-filter";
export { PQList } from "./pq-list";
export { PQCard } from "./pq-card";

```

# src/components/features/questionnaire/ans/pq-card.tsx

```tsx
"use client";

import { useTranslations } from "next-intl";
import {
  BookOpen,
  ChevronDown,
  ChevronUp,
  ExternalLink,
  MapPin,
  Sparkles,
  Star,
} from "lucide-react";
import { Badge } from "@/components/ui/badge";
import { Button } from "@/components/ui/button";
import { Card, CardContent } from "@/components/ui/card";
import { Separator } from "@/components/ui/separator";
import {
  Collapsible,
  CollapsibleContent,
  CollapsibleTrigger,
} from "@/components/ui/collapsible";
import { cn } from "@/lib/utils";
import { USOAP_AUDIT_AREAS, CRITICAL_ELEMENTS } from "@/lib/questionnaire/constants";
import type { USOAPAuditArea, CriticalElement } from "@prisma/client";

interface ICAOReference {
  id: string;
  referenceType: string;
  document: string;
  chapter: string | null;
  description: string | null;
}

interface PQCardProps {
  question: {
    id: string;
    pqNumber: string;
    questionTextEn: string;
    questionTextFr: string;
    guidanceEn: string | null;
    guidanceFr: string | null;
    auditArea: USOAPAuditArea | null;
    criticalElement: CriticalElement | null;
    isPriorityPQ: boolean;
    requiresOnSite: boolean;
    pqStatus: "NO_CHANGE" | "REVISED" | "NEW";
    icaoReferences: ICAOReference[];
  };
  locale: string;
  isExpanded: boolean;
  onToggle: () => void;
}

export function PQCard({ question, locale, isExpanded, onToggle }: PQCardProps) {
  const t = useTranslations("ansBrowser");
  const lang = locale === "fr" ? "fr" : "en";

  const questionText =
    lang === "fr" ? question.questionTextFr : question.questionTextEn;
  const guidanceText =
    lang === "fr" ? question.guidanceFr : question.guidanceEn;

  const auditAreaMeta = question.auditArea
    ? USOAP_AUDIT_AREAS[question.auditArea]
    : null;
  const ceMeta = question.criticalElement
    ? CRITICAL_ELEMENTS[question.criticalElement]
    : null;

  return (
    <Collapsible open={isExpanded} onOpenChange={onToggle}>
      <Card
        className={cn(
          "transition-all",
          isExpanded && "ring-2 ring-blue-500/20",
          question.pqStatus === "NEW" && "border-l-4 border-l-green-500",
          question.pqStatus === "REVISED" && "border-l-4 border-l-amber-500"
        )}
      >
        <CollapsibleTrigger asChild>
          <CardContent className="p-4 cursor-pointer hover:bg-muted/30 transition-colors">
            <div className="flex items-start gap-4">
              {/* PQ Number */}
              <div className="shrink-0">
                <div
                  className={cn(
                    "font-mono text-sm font-bold px-2 py-1 rounded-md text-center min-w-[60px]",
                    "bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400"
                  )}
                >
                  {question.pqNumber}
                </div>
                {/* Status badges under PQ number */}
                <div className="flex flex-col gap-1 mt-2">
                  {question.isPriorityPQ && (
                    <Badge
                      variant="outline"
                      className="text-[10px] px-1.5 py-0 border-amber-300 text-amber-600 dark:border-amber-700 dark:text-amber-400"
                    >
                      <Star className="h-3 w-3 mr-0.5 fill-current" />
                      {t("pq.priority")}
                    </Badge>
                  )}
                  {question.requiresOnSite && (
                    <Badge
                      variant="outline"
                      className="text-[10px] px-1.5 py-0 border-orange-300 text-orange-600 dark:border-orange-700 dark:text-orange-400"
                    >
                      <MapPin className="h-3 w-3 mr-0.5" />
                      {t("pq.onSite")}
                    </Badge>
                  )}
                </div>
              </div>

              {/* Question Content */}
              <div className="flex-1 min-w-0">
                {/* Amendment Status */}
                {question.pqStatus !== "NO_CHANGE" && (
                  <div className="mb-2">
                    <Badge
                      variant="secondary"
                      className={cn(
                        "text-xs",
                        question.pqStatus === "NEW" &&
                          "bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",
                        question.pqStatus === "REVISED" &&
                          "bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400"
                      )}
                    >
                      <Sparkles className="h-3 w-3 mr-1" />
                      {question.pqStatus === "NEW"
                        ? t("pq.newIn2024")
                        : t("pq.revisedIn2024")}
                    </Badge>
                  </div>
                )}

                {/* Question Text */}
                <p
                  className={cn(
                    "text-sm",
                    !isExpanded && "line-clamp-2"
                  )}
                >
                  {questionText}
                </p>

                {/* Badges */}
                <div className="flex flex-wrap gap-2 mt-3">
                  {auditAreaMeta && (
                    <Badge
                      variant="secondary"
                      className="bg-blue-50 text-blue-700 dark:bg-blue-950/50 dark:text-blue-400"
                    >
                      {auditAreaMeta.code}: {auditAreaMeta.name[lang]}
                    </Badge>
                  )}
                  {ceMeta && (
                    <Badge
                      variant="secondary"
                      className="bg-purple-50 text-purple-700 dark:bg-purple-950/50 dark:text-purple-400"
                    >
                      {ceMeta.code.replace("_", "-")}
                    </Badge>
                  )}
                </div>
              </div>

              {/* Expand Button */}
              <Button variant="ghost" size="icon" className="shrink-0">
                {isExpanded ? (
                  <ChevronUp className="h-4 w-4" />
                ) : (
                  <ChevronDown className="h-4 w-4" />
                )}
              </Button>
            </div>
          </CardContent>
        </CollapsibleTrigger>

        <CollapsibleContent>
          <Separator />
          <CardContent className="p-4 bg-muted/20">
            <div className="space-y-4">
              {/* Guidance */}
              {guidanceText && (
                <div>
                  <h4 className="text-sm font-semibold mb-2 flex items-center gap-2">
                    <BookOpen className="h-4 w-4 text-blue-600" />
                    {t("pq.guidance")}
                  </h4>
                  <p className="text-sm text-muted-foreground pl-6">
                    {guidanceText}
                  </p>
                </div>
              )}

              {/* ICAO References */}
              {question.icaoReferences.length > 0 && (
                <div>
                  <h4 className="text-sm font-semibold mb-2 flex items-center gap-2">
                    <ExternalLink className="h-4 w-4 text-blue-600" />
                    {t("pq.icaoReferences")}
                  </h4>
                  <div className="space-y-2 pl-6">
                    {question.icaoReferences.map((ref) => (
                      <div
                        key={ref.id}
                        className="flex items-start gap-2 text-sm"
                      >
                        <Badge variant="outline" className="shrink-0 text-xs">
                          {ref.referenceType}
                        </Badge>
                        <div>
                          <span className="font-medium">{ref.document}</span>
                          {ref.chapter && (
                            <span className="text-muted-foreground">
                              {" "}
                              - {ref.chapter}
                            </span>
                          )}
                          {ref.description && (
                            <p className="text-xs text-muted-foreground mt-0.5">
                              {ref.description}
                            </p>
                          )}
                        </div>
                      </div>
                    ))}
                  </div>
                </div>
              )}

              {/* Critical Element Description */}
              {ceMeta && (
                <div>
                  <h4 className="text-sm font-semibold mb-2 flex items-center gap-2">
                    <Badge
                      variant="secondary"
                      className="bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400"
                    >
                      {ceMeta.code.replace("_", "-")}
                    </Badge>
                    {ceMeta.name[lang]}
                  </h4>
                  <p className="text-sm text-muted-foreground pl-6">
                    {ceMeta.description[lang]}
                  </p>
                </div>
              )}
            </div>
          </CardContent>
        </CollapsibleContent>
      </Card>
    </Collapsible>
  );
}

```

# src/components/features/questionnaire/ans/pq-list.tsx

```tsx
"use client";

import { useState } from "react";
import { useTranslations } from "next-intl";
import { AlertCircle, FileQuestion, Loader2 } from "lucide-react";
import { Alert, AlertDescription, AlertTitle } from "@/components/ui/alert";
import {
  Pagination,
  PaginationContent,
  PaginationEllipsis,
  PaginationItem,
  PaginationLink,
  PaginationNext,
  PaginationPrevious,
} from "@/components/ui/pagination";
import { PQCard } from "./pq-card";
import type { USOAPAuditArea, CriticalElement } from "@prisma/client";

interface PQListProps {
  locale: string;
  filters: {
    auditAreas: USOAPAuditArea[];
    criticalElements: CriticalElement[];
    isPriority: boolean;
    requiresOnSite: boolean;
    search: string;
  };
  page: number;
  onPageChange: (page: number) => void;
}

const ITEMS_PER_PAGE = 20;

export function PQList({ locale, filters, page, onPageChange }: PQListProps) {
  const t = useTranslations("ansBrowser");
  const [expandedId, setExpandedId] = useState<string | null>(null);

  // For now, we'll simulate data since we don't have real data in the database yet
  // In production, this would use the tRPC query
  const mockQuestions = generateMockQuestions(filters, page);

  const totalItems = mockQuestions.total;
  const totalPages = Math.ceil(totalItems / ITEMS_PER_PAGE);
  const questions = mockQuestions.questions;
  const isLoading = false;
  const error = null;

  // Toggle expanded question
  const handleToggle = (id: string) => {
    setExpandedId(expandedId === id ? null : id);
  };

  // Generate pagination items
  const getPaginationItems = () => {
    const items: (number | "ellipsis")[] = [];
    const maxVisible = 5;

    if (totalPages <= maxVisible + 2) {
      // Show all pages
      for (let i = 1; i <= totalPages; i++) {
        items.push(i);
      }
    } else {
      // Always show first page
      items.push(1);

      if (page > 3) {
        items.push("ellipsis");
      }

      // Show pages around current
      const start = Math.max(2, page - 1);
      const end = Math.min(totalPages - 1, page + 1);

      for (let i = start; i <= end; i++) {
        items.push(i);
      }

      if (page < totalPages - 2) {
        items.push("ellipsis");
      }

      // Always show last page
      items.push(totalPages);
    }

    return items;
  };

  if (error) {
    return (
      <Alert variant="destructive">
        <AlertCircle className="h-4 w-4" />
        <AlertTitle>{t("error.title")}</AlertTitle>
        <AlertDescription>{t("error.description")}</AlertDescription>
      </Alert>
    );
  }

  if (isLoading) {
    return (
      <div className="flex items-center justify-center py-12">
        <Loader2 className="h-8 w-8 animate-spin text-muted-foreground" />
      </div>
    );
  }

  if (questions.length === 0) {
    return (
      <div className="flex flex-col items-center justify-center py-12 text-center">
        <FileQuestion className="h-12 w-12 text-muted-foreground mb-4" />
        <h3 className="font-semibold text-lg mb-1">{t("empty.title")}</h3>
        <p className="text-muted-foreground text-sm max-w-md">
          {t("empty.description")}
        </p>
      </div>
    );
  }

  return (
    <div className="space-y-4">
      {/* Results Summary */}
      <div className="flex items-center justify-between text-sm text-muted-foreground">
        <span>
          {t("results.showing", {
            from: (page - 1) * ITEMS_PER_PAGE + 1,
            to: Math.min(page * ITEMS_PER_PAGE, totalItems),
            total: totalItems,
          })}
        </span>
        <span>
          {t("results.page", { current: page, total: totalPages })}
        </span>
      </div>

      {/* Question Cards */}
      <div className="space-y-3">
        {questions.map((question) => (
          <PQCard
            key={question.id}
            question={question}
            locale={locale}
            isExpanded={expandedId === question.id}
            onToggle={() => handleToggle(question.id)}
          />
        ))}
      </div>

      {/* Pagination */}
      {totalPages > 1 && (
        <Pagination className="mt-6">
          <PaginationContent>
            <PaginationItem>
              <PaginationPrevious
                onClick={() => page > 1 && onPageChange(page - 1)}
                className={page <= 1 ? "pointer-events-none opacity-50" : "cursor-pointer"}
              />
            </PaginationItem>

            {getPaginationItems().map((item, index) =>
              item === "ellipsis" ? (
                <PaginationItem key={`ellipsis-${index}`}>
                  <PaginationEllipsis />
                </PaginationItem>
              ) : (
                <PaginationItem key={item}>
                  <PaginationLink
                    onClick={() => onPageChange(item)}
                    isActive={page === item}
                    className="cursor-pointer"
                  >
                    {item}
                  </PaginationLink>
                </PaginationItem>
              )
            )}

            <PaginationItem>
              <PaginationNext
                onClick={() => page < totalPages && onPageChange(page + 1)}
                className={page >= totalPages ? "pointer-events-none opacity-50" : "cursor-pointer"}
              />
            </PaginationItem>
          </PaginationContent>
        </Pagination>
      )}
    </div>
  );
}

// Mock data generator for demo purposes
// This would be replaced with actual tRPC data fetching
interface MockQuestion {
  id: string;
  pqNumber: string;
  questionTextEn: string;
  questionTextFr: string;
  guidanceEn: string | null;
  guidanceFr: string | null;
  auditArea: USOAPAuditArea | null;
  criticalElement: CriticalElement | null;
  isPriorityPQ: boolean;
  requiresOnSite: boolean;
  pqStatus: "NO_CHANGE" | "REVISED" | "NEW";
  icaoReferences: Array<{
    id: string;
    referenceType: string;
    document: string;
    chapter: string | null;
    description: string | null;
  }>;
}

function generateMockQuestions(
  filters: PQListProps["filters"],
  page: number
): { questions: MockQuestion[]; total: number } {
  const allQuestions: MockQuestion[] = [];
  const auditAreas: USOAPAuditArea[] = [
    "LEG", "ORG", "PEL", "OPS", "AIR", "AIG", "ANS", "AGA", "SSP"
  ];
  const criticalElements: CriticalElement[] = [
    "CE_1", "CE_2", "CE_3", "CE_4", "CE_5", "CE_6", "CE_7", "CE_8"
  ];

  // Generate 100 sample questions
  for (let i = 1; i <= 100; i++) {
    const auditArea = auditAreas[i % auditAreas.length];
    const ce = criticalElements[i % criticalElements.length];
    const isPriority = i % 7 === 0;
    const requiresOnSite = i % 5 === 0;
    const pqStatus = i % 15 === 0 ? "NEW" : i % 10 === 0 ? "REVISED" : "NO_CHANGE";

    allQuestions.push({
      id: `pq-${i}`,
      pqNumber: `${7 + Math.floor(i / 100)}.${String(i).padStart(3, "0")}`,
      questionTextEn: `Has the State established ${isPriority ? "priority " : ""}requirements for ${auditArea} related to ${ce.replace("_", "-")}? This question assesses the implementation of safety oversight functions.`,
      questionTextFr: `L'État a-t-il établi des exigences ${isPriority ? "prioritaires " : ""}pour ${auditArea} liées à ${ce.replace("_", "-")}? Cette question évalue la mise en œuvre des fonctions de surveillance de la sécurité.`,
      guidanceEn: "Review the relevant documentation and verify that adequate procedures are in place. Check for evidence of implementation and compliance monitoring.",
      guidanceFr: "Examiner la documentation pertinente et vérifier que des procédures adéquates sont en place. Vérifier les preuves de mise en œuvre et de surveillance de la conformité.",
      auditArea,
      criticalElement: ce,
      isPriorityPQ: isPriority,
      requiresOnSite,
      pqStatus,
      icaoReferences: [
        {
          id: `ref-${i}-1`,
          referenceType: "STD",
          document: `Annex ${1 + (i % 18)}`,
          chapter: `Chapter ${1 + (i % 12)}`,
          description: "Standard reference for compliance assessment",
        },
        ...(i % 3 === 0
          ? [
              {
                id: `ref-${i}-2`,
                referenceType: "GM",
                document: "Doc 9859",
                chapter: "Section 4.2",
                description: "Safety Management Manual guidance",
              },
            ]
          : []),
      ],
    });
  }

  // Apply filters
  let filtered = allQuestions;

  if (filters.auditAreas.length > 0) {
    filtered = filtered.filter((q) =>
      q.auditArea && filters.auditAreas.includes(q.auditArea)
    );
  }

  if (filters.criticalElements.length > 0) {
    filtered = filtered.filter((q) =>
      q.criticalElement && filters.criticalElements.includes(q.criticalElement)
    );
  }

  if (filters.isPriority) {
    filtered = filtered.filter((q) => q.isPriorityPQ);
  }

  if (filters.requiresOnSite) {
    filtered = filtered.filter((q) => q.requiresOnSite);
  }

  if (filters.search) {
    const searchLower = filters.search.toLowerCase();
    filtered = filtered.filter(
      (q) =>
        q.pqNumber.toLowerCase().includes(searchLower) ||
        q.questionTextEn.toLowerCase().includes(searchLower) ||
        q.questionTextFr.toLowerCase().includes(searchLower)
    );
  }

  // Paginate
  const start = (page - 1) * ITEMS_PER_PAGE;
  const paginated = filtered.slice(start, start + ITEMS_PER_PAGE);

  return {
    questions: paginated,
    total: filtered.length,
  };
}

```

# src/components/features/questionnaire/icao-reference-list.tsx

```tsx
"use client";

import { useTranslations } from "next-intl";
import { cn } from "@/lib/utils";
import { Badge } from "@/components/ui/badge";
import { BookOpen, FileText, ScrollText } from "lucide-react";
import { ICAO_REFERENCE_TYPES } from "@/lib/questionnaire/constants";
import type { ICAOReference, ICAOReferenceType } from "@prisma/client";
import type { ContentLanguage } from "./language-toggle";

interface ICAOReferenceListProps {
  references: ICAOReference[];
  contentLanguage: ContentLanguage;
  className?: string;
  compact?: boolean;
}

// Color schemes for different reference types
const referenceTypeColors: Record<ICAOReferenceType, string> = {
  CC: "bg-purple-100 text-purple-700 border-purple-200 dark:bg-purple-900/50 dark:text-purple-400",
  STD: "bg-blue-100 text-blue-700 border-blue-200 dark:bg-blue-900/50 dark:text-blue-400",
  RP: "bg-cyan-100 text-cyan-700 border-cyan-200 dark:bg-cyan-900/50 dark:text-cyan-400",
  PANS: "bg-emerald-100 text-emerald-700 border-emerald-200 dark:bg-emerald-900/50 dark:text-emerald-400",
  GM: "bg-amber-100 text-amber-700 border-amber-200 dark:bg-amber-900/50 dark:text-amber-400",
  Cir: "bg-rose-100 text-rose-700 border-rose-200 dark:bg-rose-900/50 dark:text-rose-400",
  SUPPS: "bg-slate-100 text-slate-600 border-slate-200 dark:bg-slate-800 dark:text-slate-400",
};

// Icons for different reference types
const referenceTypeIcons: Record<
  ICAOReferenceType,
  React.ComponentType<{ className?: string }>
> = {
  CC: ScrollText,
  STD: FileText,
  RP: FileText,
  PANS: BookOpen,
  GM: BookOpen,
  Cir: FileText,
  SUPPS: FileText,
};

interface ICAOReferenceItemProps {
  reference: ICAOReference;
  contentLanguage: ContentLanguage;
  compact?: boolean;
}

function ICAOReferenceItem({
  reference,
  contentLanguage,
  compact = false,
}: ICAOReferenceItemProps) {
  const lang = contentLanguage;
  const typeMeta = ICAO_REFERENCE_TYPES[reference.referenceType];
  const Icon = referenceTypeIcons[reference.referenceType];

  if (compact) {
    return (
      <div className="flex items-center gap-2 text-sm">
        <Badge
          variant="outline"
          className={cn(
            "text-xs font-medium px-1.5 py-0",
            referenceTypeColors[reference.referenceType]
          )}
        >
          {reference.referenceType}
        </Badge>
        <span className="text-muted-foreground">
          {reference.document}
          {reference.chapter && (
            <span className="ml-1">({reference.chapter})</span>
          )}
        </span>
      </div>
    );
  }

  return (
    <div className="flex items-start gap-3 p-3 rounded-lg border bg-card hover:bg-muted/30 transition-colors">
      {/* Type Badge and Icon */}
      <div className="flex flex-col items-center gap-1 shrink-0">
        <div
          className={cn(
            "w-8 h-8 rounded-md flex items-center justify-center",
            referenceTypeColors[reference.referenceType].split(" ")[0]
          )}
        >
          <Icon
            className={cn(
              "h-4 w-4",
              referenceTypeColors[reference.referenceType].split(" ")[1]
            )}
          />
        </div>
        <Badge
          variant="outline"
          className={cn(
            "text-[10px] font-bold px-1 py-0",
            referenceTypeColors[reference.referenceType]
          )}
        >
          {reference.referenceType}
        </Badge>
      </div>

      {/* Reference Content */}
      <div className="flex-1 min-w-0">
        <div>
          <p className="font-medium text-sm leading-tight">{reference.document}</p>
          {reference.chapter && (
            <p className="text-xs text-muted-foreground mt-0.5">
              {reference.chapter}
            </p>
          )}
        </div>

        {reference.description && (
          <p className="text-xs text-muted-foreground mt-1.5 line-clamp-2">
            {reference.description}
          </p>
        )}

        {/* Reference Type Label */}
        <p className="text-[10px] text-muted-foreground/70 mt-1">
          {typeMeta.name[lang]}
        </p>
      </div>
    </div>
  );
}

export function ICAOReferenceList({
  references,
  contentLanguage,
  className,
  compact = false,
}: ICAOReferenceListProps) {
  const t = useTranslations("questionDetail");

  if (!references || references.length === 0) {
    return (
      <div className={cn("text-sm text-muted-foreground italic", className)}>
        {t("noReferences")}
      </div>
    );
  }

  // Group references by type for better organization
  const groupedReferences = references.reduce(
    (acc, ref) => {
      if (!acc[ref.referenceType]) {
        acc[ref.referenceType] = [];
      }
      acc[ref.referenceType].push(ref);
      return acc;
    },
    {} as Record<ICAOReferenceType, ICAOReference[]>
  );

  // Sort types by their sort order
  const sortedTypes = (Object.keys(groupedReferences) as ICAOReferenceType[]).sort(
    (a, b) =>
      ICAO_REFERENCE_TYPES[a].sortOrder - ICAO_REFERENCE_TYPES[b].sortOrder
  );

  if (compact) {
    return (
      <div className={cn("space-y-1.5", className)}>
        {references.map((ref) => (
          <ICAOReferenceItem
            key={ref.id}
            reference={ref}
            contentLanguage={contentLanguage}
            compact
          />
        ))}
      </div>
    );
  }

  return (
    <div className={cn("space-y-4", className)}>
      {sortedTypes.map((type) => (
        <div key={type}>
          <div className="flex items-center gap-2 mb-2">
            <Badge
              variant="outline"
              className={cn(
                "text-xs font-semibold",
                referenceTypeColors[type]
              )}
            >
              {type}
            </Badge>
            <span className="text-xs text-muted-foreground">
              {ICAO_REFERENCE_TYPES[type].name[contentLanguage]} (
              {groupedReferences[type].length})
            </span>
          </div>
          <div className="space-y-2">
            {groupedReferences[type].map((ref) => (
              <ICAOReferenceItem
                key={ref.id}
                reference={ref}
                contentLanguage={contentLanguage}
              />
            ))}
          </div>
        </div>
      ))}
    </div>
  );
}

// Simple badge-only display for reference types
interface ICAOReferenceTypeBadgeProps {
  type: ICAOReferenceType;
  className?: string;
}

export function ICAOReferenceTypeBadge({
  type,
  className,
}: ICAOReferenceTypeBadgeProps) {
  return (
    <Badge
      variant="outline"
      className={cn(
        "text-xs font-medium",
        referenceTypeColors[type],
        className
      )}
    >
      {type}
    </Badge>
  );
}

// Export colors for external use
export { referenceTypeColors };

```

# src/components/features/questionnaire/index.ts

```ts
// Questionnaire Type Card
export { QuestionnaireTypeCard, getStatsIcon } from "./questionnaire-type-card";

// Language Toggle
export {
  LanguageToggle,
  useContentLanguage,
  type ContentLanguage,
} from "./language-toggle";

// Amendment Badge
export { AmendmentBadge, AmendmentIndicators } from "./amendment-badge";

// ICAO Reference List
export {
  ICAOReferenceList,
  ICAOReferenceTypeBadge,
  referenceTypeColors,
} from "./icao-reference-list";

// Question Detail Modal
export {
  QuestionDetailModal,
  useQuestionModal,
} from "./question-detail-modal";

// ANS Components
export * from "./ans";

// SMS Components
export * from "./sms";

```

# src/components/features/questionnaire/language-toggle.tsx

```tsx
"use client";

import { useCallback } from "react";
import { cn } from "@/lib/utils";
import { Button } from "@/components/ui/button";
import { Languages } from "lucide-react";

export type ContentLanguage = "en" | "fr";

interface LanguageToggleProps {
  currentLanguage: ContentLanguage;
  onChange: (language: ContentLanguage) => void;
  className?: string;
  size?: "sm" | "default";
  showIcon?: boolean;
}

export function LanguageToggle({
  currentLanguage,
  onChange,
  className,
  size = "sm",
  showIcon = true,
}: LanguageToggleProps) {
  const handleToggle = useCallback(() => {
    onChange(currentLanguage === "en" ? "fr" : "en");
  }, [currentLanguage, onChange]);

  const handleKeyDown = useCallback(
    (event: React.KeyboardEvent) => {
      if (event.key === "Enter" || event.key === " ") {
        event.preventDefault();
        handleToggle();
      }
    },
    [handleToggle]
  );

  return (
    <div
      className={cn("inline-flex items-center gap-1", className)}
      role="group"
      aria-label="Language toggle"
    >
      {showIcon && (
        <Languages
          className={cn(
            "text-muted-foreground",
            size === "sm" ? "h-3.5 w-3.5" : "h-4 w-4"
          )}
        />
      )}
      <div className="inline-flex rounded-md border bg-muted/50 p-0.5">
        <Button
          variant="ghost"
          size="sm"
          onClick={() => onChange("en")}
          onKeyDown={handleKeyDown}
          className={cn(
            "px-2 py-0.5 h-auto font-medium transition-colors",
            size === "sm" ? "text-xs" : "text-sm",
            currentLanguage === "en"
              ? "bg-background text-foreground shadow-sm"
              : "text-muted-foreground hover:text-foreground hover:bg-transparent"
          )}
          aria-pressed={currentLanguage === "en"}
          aria-label="English"
        >
          EN
        </Button>
        <Button
          variant="ghost"
          size="sm"
          onClick={() => onChange("fr")}
          onKeyDown={handleKeyDown}
          className={cn(
            "px-2 py-0.5 h-auto font-medium transition-colors",
            size === "sm" ? "text-xs" : "text-sm",
            currentLanguage === "fr"
              ? "bg-background text-foreground shadow-sm"
              : "text-muted-foreground hover:text-foreground hover:bg-transparent"
          )}
          aria-pressed={currentLanguage === "fr"}
          aria-label="French"
        >
          FR
        </Button>
      </div>
    </div>
  );
}

// Hook for managing content language state with locale default
import { useState, useMemo } from "react";

interface UseContentLanguageOptions {
  defaultLocale?: string;
  storageKey?: string;
}

export function useContentLanguage(options: UseContentLanguageOptions = {}) {
  const { defaultLocale = "en" } = options;

  const initialLanguage = useMemo((): ContentLanguage => {
    return defaultLocale === "fr" ? "fr" : "en";
  }, [defaultLocale]);

  const [contentLanguage, setContentLanguage] =
    useState<ContentLanguage>(initialLanguage);

  const toggleLanguage = useCallback(() => {
    setContentLanguage((prev) => (prev === "en" ? "fr" : "en"));
  }, []);

  const getBilingualText = useCallback(
    (en: string | null | undefined, fr: string | null | undefined): string => {
      if (contentLanguage === "fr") {
        return fr || en || "";
      }
      return en || fr || "";
    },
    [contentLanguage]
  );

  return {
    contentLanguage,
    setContentLanguage,
    toggleLanguage,
    getBilingualText,
    isEnglish: contentLanguage === "en",
    isFrench: contentLanguage === "fr",
  };
}

```

# src/components/features/questionnaire/question-detail-modal.tsx

```tsx
"use client";

import { useCallback, useEffect, useState } from "react";
import { useTranslations } from "next-intl";
import Link from "next/link";
import {
  Dialog,
  DialogContent,
  DialogHeader,
  DialogTitle,
} from "@/components/ui/dialog";
import { Button } from "@/components/ui/button";
import { Badge } from "@/components/ui/badge";
import { ScrollArea } from "@/components/ui/scroll-area";
import { Separator } from "@/components/ui/separator";
import {
  ChevronLeft,
  ChevronRight,
  Star,
  MapPin,
  BookOpen,
  ExternalLink,
  Link2,
  FileText,
  Layers,
  Target,
  Shield,
} from "lucide-react";
import {
  LanguageToggle,
  useContentLanguage,
} from "./language-toggle";
import { AmendmentIndicators } from "./amendment-badge";
import { ICAOReferenceList } from "./icao-reference-list";
import {
  USOAP_AUDIT_AREAS,
  CRITICAL_ELEMENTS,
  SMS_COMPONENTS,
  CANSO_STUDY_AREAS,
} from "@/lib/questionnaire/constants";
import type {
  Question,
  ICAOReference,
  PQAmendmentStatus,
  QuestionnaireType,
} from "@prisma/client";

// Extended question type with relations
interface QuestionWithRelations extends Question {
  icaoReferences: ICAOReference[];
  relatedQuestions?: {
    id: string;
    pqNumber: string | null;
    questionTextEn: string | null;
  }[];
}

interface QuestionDetailModalProps {
  question: QuestionWithRelations | null;
  open: boolean;
  onOpenChange: (open: boolean) => void;
  locale: string;
  onNavigate?: (direction: "prev" | "next") => void;
  hasPrevious?: boolean;
  hasNext?: boolean;
  questionnaireType?: QuestionnaireType;
}

export function QuestionDetailModal({
  question,
  open,
  onOpenChange,
  locale,
  onNavigate,
  hasPrevious = false,
  hasNext = false,
  questionnaireType,
}: QuestionDetailModalProps) {
  const t = useTranslations("questionDetail");
  const { contentLanguage, setContentLanguage, getBilingualText } =
    useContentLanguage({ defaultLocale: locale });

  // Handle keyboard navigation
  useEffect(() => {
    if (!open) return;

    const handleKeyDown = (event: KeyboardEvent) => {
      if (event.key === "ArrowLeft" && hasPrevious && onNavigate) {
        event.preventDefault();
        onNavigate("prev");
      } else if (event.key === "ArrowRight" && hasNext && onNavigate) {
        event.preventDefault();
        onNavigate("next");
      }
    };

    window.addEventListener("keydown", handleKeyDown);
    return () => window.removeEventListener("keydown", handleKeyDown);
  }, [open, hasPrevious, hasNext, onNavigate]);

  if (!question) return null;

  const isANS = questionnaireType === "ANS_USOAP_CMA" || question.auditArea;
  const isSMS = questionnaireType === "SMS_CANSO_SOE" || question.smsComponent;

  // Get metadata labels
  const auditAreaMeta = question.auditArea
    ? USOAP_AUDIT_AREAS[question.auditArea]
    : null;
  const criticalElementMeta = question.criticalElement
    ? CRITICAL_ELEMENTS[question.criticalElement]
    : null;
  const smsComponentMeta = question.smsComponent
    ? SMS_COMPONENTS[question.smsComponent]
    : null;
  const studyAreaMeta = question.studyArea
    ? CANSO_STUDY_AREAS[question.studyArea]
    : null;

  return (
    <Dialog open={open} onOpenChange={onOpenChange}>
      <DialogContent className="max-w-3xl max-h-[90vh] p-0 gap-0 overflow-hidden">
        {/* Header */}
        <DialogHeader className="p-4 pb-0">
          <div className="flex items-start justify-between gap-4">
            <div className="flex-1 min-w-0">
              {/* Question Number */}
              <div className="flex items-center gap-2 mb-2">
                {question.pqNumber && (
                  <Badge
                    variant="outline"
                    className="font-mono text-base font-bold px-2 py-0.5"
                  >
                    {question.pqNumber}
                  </Badge>
                )}

                {/* Status Badges */}
                <div className="flex items-center gap-1.5">
                  {question.isPriorityPQ && (
                    <Badge
                      variant="secondary"
                      className="bg-amber-100 text-amber-700 dark:bg-amber-900/50 dark:text-amber-400 text-xs gap-1"
                    >
                      <Star className="h-3 w-3" />
                      {t("priority")}
                    </Badge>
                  )}
                  {question.requiresOnSite && (
                    <Badge
                      variant="secondary"
                      className="bg-blue-100 text-blue-700 dark:bg-blue-900/50 dark:text-blue-400 text-xs gap-1"
                    >
                      <MapPin className="h-3 w-3" />
                      {t("onSite")}
                    </Badge>
                  )}
                  <AmendmentIndicators
                    status={question.pqStatus as PQAmendmentStatus}
                    previousPQNumber={question.previousPqNumber}
                  />
                </div>
              </div>

              <DialogTitle className="text-lg font-semibold leading-tight sr-only">
                {question.pqNumber || t("question")}
              </DialogTitle>
            </div>

            {/* Language Toggle */}
            <LanguageToggle
              currentLanguage={contentLanguage}
              onChange={setContentLanguage}
              className="shrink-0"
            />
          </div>
        </DialogHeader>

        {/* Scrollable Content */}
        <ScrollArea className="flex-1 max-h-[calc(90vh-180px)]">
          <div className="p-4 space-y-6">
            {/* Question Text */}
            <div>
              <p className="text-base leading-relaxed">
                {getBilingualText(question.questionTextEn, question.questionTextFr)}
              </p>
            </div>

            <Separator />

            {/* Metadata Grid */}
            <div className="grid grid-cols-2 gap-4">
              {/* ANS Metadata */}
              {isANS && (
                <>
                  {auditAreaMeta && (
                    <div className="space-y-1">
                      <div className="flex items-center gap-1.5 text-xs text-muted-foreground">
                        <FileText className="h-3.5 w-3.5" />
                        {t("auditArea")}
                      </div>
                      <Badge variant="outline" className="font-medium">
                        {question.auditArea} -{" "}
                        {auditAreaMeta.name[contentLanguage]}
                      </Badge>
                    </div>
                  )}

                  {criticalElementMeta && (
                    <div className="space-y-1">
                      <div className="flex items-center gap-1.5 text-xs text-muted-foreground">
                        <Target className="h-3.5 w-3.5" />
                        {t("criticalElement")}
                      </div>
                      <Badge variant="outline" className="font-medium">
                        CE-{criticalElementMeta.number}:{" "}
                        {criticalElementMeta.name[contentLanguage]}
                      </Badge>
                    </div>
                  )}
                </>
              )}

              {/* SMS Metadata */}
              {isSMS && (
                <>
                  {smsComponentMeta && (
                    <div className="space-y-1">
                      <div className="flex items-center gap-1.5 text-xs text-muted-foreground">
                        <Shield className="h-3.5 w-3.5" />
                        {t("smsComponent")}
                      </div>
                      <Badge
                        variant="outline"
                        className="font-medium bg-emerald-50 dark:bg-emerald-900/20"
                      >
                        {smsComponentMeta.name[contentLanguage]}
                      </Badge>
                    </div>
                  )}

                  {studyAreaMeta && (
                    <div className="space-y-1">
                      <div className="flex items-center gap-1.5 text-xs text-muted-foreground">
                        <Layers className="h-3.5 w-3.5" />
                        {t("studyArea")}
                      </div>
                      <Badge variant="outline" className="font-medium">
                        SA {studyAreaMeta.componentNumber}.
                        {studyAreaMeta.areaNumber}:{" "}
                        {studyAreaMeta.name[contentLanguage]}
                      </Badge>
                    </div>
                  )}
                </>
              )}
            </div>

            {/* Guidance for Review of Evidence */}
            {(question.guidanceEn || question.guidanceFr) && (
              <>
                <Separator />
                <div className="space-y-2">
                  <div className="flex items-center gap-2">
                    <BookOpen className="h-4 w-4 text-muted-foreground" />
                    <h3 className="font-semibold text-sm">{t("guidance")}</h3>
                  </div>
                  <div className="rounded-lg border bg-muted/30 p-3">
                    <p className="text-sm text-muted-foreground whitespace-pre-wrap">
                      {getBilingualText(question.guidanceEn, question.guidanceFr)}
                    </p>
                  </div>
                </div>
              </>
            )}

            {/* ICAO References */}
            {question.icaoReferences && question.icaoReferences.length > 0 && (
              <>
                <Separator />
                <div className="space-y-3">
                  <div className="flex items-center gap-2">
                    <FileText className="h-4 w-4 text-muted-foreground" />
                    <h3 className="font-semibold text-sm">
                      {t("icaoReferences")} ({question.icaoReferences.length})
                    </h3>
                  </div>
                  <ICAOReferenceList
                    references={question.icaoReferences}
                    contentLanguage={contentLanguage}
                  />
                </div>
              </>
            )}

            {/* Related Questions */}
            {question.relatedQuestions && question.relatedQuestions.length > 0 && (
              <>
                <Separator />
                <div className="space-y-2">
                  <div className="flex items-center gap-2">
                    <Link2 className="h-4 w-4 text-muted-foreground" />
                    <h3 className="font-semibold text-sm">
                      {t("relatedQuestions")} ({question.relatedQuestions.length})
                    </h3>
                  </div>
                  <div className="flex flex-wrap gap-2">
                    {question.relatedQuestions.map((related) => (
                      <Link
                        key={related.id}
                        href={`/${locale}/questionnaires/question/${related.id}`}
                        className="inline-flex items-center gap-1.5 text-sm px-2.5 py-1 rounded-md border bg-card hover:bg-muted transition-colors"
                      >
                        <span className="font-mono font-medium">
                          {related.pqNumber}
                        </span>
                        <ExternalLink className="h-3 w-3 text-muted-foreground" />
                      </Link>
                    ))}
                  </div>
                </div>
              </>
            )}
          </div>
        </ScrollArea>

        {/* Footer with Navigation */}
        <div className="border-t p-3 flex items-center justify-between bg-muted/30">
          <div className="flex items-center gap-2">
            {onNavigate && (
              <>
                <Button
                  variant="outline"
                  size="sm"
                  onClick={() => onNavigate("prev")}
                  disabled={!hasPrevious}
                  className="gap-1"
                >
                  <ChevronLeft className="h-4 w-4" />
                  {t("previous")}
                </Button>
                <Button
                  variant="outline"
                  size="sm"
                  onClick={() => onNavigate("next")}
                  disabled={!hasNext}
                  className="gap-1"
                >
                  {t("next")}
                  <ChevronRight className="h-4 w-4" />
                </Button>
              </>
            )}
          </div>

          <div className="flex items-center gap-2">
            <Link
              href={`/${locale}/questionnaires/question/${question.id}`}
              target="_blank"
              className="text-xs text-muted-foreground hover:text-foreground flex items-center gap-1"
            >
              {t("openInNewTab")}
              <ExternalLink className="h-3 w-3" />
            </Link>
          </div>
        </div>
      </DialogContent>
    </Dialog>
  );
}

// Hook for managing modal state with question list navigation
interface UseQuestionModalOptions {
  questions: QuestionWithRelations[];
  onQuestionChange?: (question: QuestionWithRelations | null) => void;
}

export function useQuestionModal({ questions, onQuestionChange }: UseQuestionModalOptions) {
  const [selectedQuestion, setSelectedQuestion] = useState<QuestionWithRelations | null>(null);
  const [open, setOpen] = useState(false);

  const currentIndex = selectedQuestion
    ? questions.findIndex((q) => q.id === selectedQuestion.id)
    : -1;

  const hasPrevious = currentIndex > 0;
  const hasNext = currentIndex < questions.length - 1;

  const openQuestion = useCallback((question: QuestionWithRelations) => {
    setSelectedQuestion(question);
    setOpen(true);
    onQuestionChange?.(question);
  }, [onQuestionChange]);

  const closeModal = useCallback(() => {
    setOpen(false);
    setSelectedQuestion(null);
    onQuestionChange?.(null);
  }, [onQuestionChange]);

  const navigate = useCallback(
    (direction: "prev" | "next") => {
      if (direction === "prev" && hasPrevious) {
        const newQuestion = questions[currentIndex - 1];
        setSelectedQuestion(newQuestion);
        onQuestionChange?.(newQuestion);
      } else if (direction === "next" && hasNext) {
        const newQuestion = questions[currentIndex + 1];
        setSelectedQuestion(newQuestion);
        onQuestionChange?.(newQuestion);
      }
    },
    [questions, currentIndex, hasPrevious, hasNext, onQuestionChange]
  );

  const handleOpenChange = useCallback(
    (newOpen: boolean) => {
      setOpen(newOpen);
      if (!newOpen) {
        setSelectedQuestion(null);
        onQuestionChange?.(null);
      }
    },
    [onQuestionChange]
  );

  return {
    selectedQuestion,
    open,
    openQuestion,
    closeModal,
    navigate,
    handleOpenChange,
    hasPrevious,
    hasNext,
    currentIndex,
    totalQuestions: questions.length,
  };
}

```

# src/components/features/questionnaire/questionnaire-type-card.tsx

```tsx
"use client";

import Link from "next/link";
import { FileText, Shield, ArrowRight, BookOpen, Layers, Target, Award } from "lucide-react";
import { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Badge } from "@/components/ui/badge";
import { cn } from "@/lib/utils";

interface StatItem {
  label: string;
  value: string | number;
  icon?: React.ReactNode;
}

interface QuestionnaireTypeCardProps {
  type: "ans" | "sms";
  title: string;
  fullTitle: string;
  description: string;
  effectiveDate?: string;
  stats: StatItem[];
  browseLabel: string;
  href: string;
  locale: string;
  isNew?: boolean;
}

export function QuestionnaireTypeCard({
  type,
  title,
  fullTitle,
  description,
  effectiveDate,
  stats,
  browseLabel,
  href,
  locale,
  isNew = false,
}: QuestionnaireTypeCardProps) {
  const isANS = type === "ans";

  return (
    <Card
      className={cn(
        "relative overflow-hidden transition-all hover:shadow-lg",
        isANS
          ? "border-blue-200 hover:border-blue-300 dark:border-blue-900 dark:hover:border-blue-800"
          : "border-emerald-200 hover:border-emerald-300 dark:border-emerald-900 dark:hover:border-emerald-800"
      )}
    >
      {/* Colored top bar */}
      <div
        className={cn(
          "absolute top-0 left-0 right-0 h-1",
          isANS ? "bg-blue-500" : "bg-emerald-500"
        )}
      />

      <CardHeader className="pb-3">
        <div className="flex items-start justify-between">
          <div
            className={cn(
              "flex h-12 w-12 items-center justify-center rounded-lg",
              isANS
                ? "bg-blue-100 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400"
                : "bg-emerald-100 text-emerald-600 dark:bg-emerald-900/30 dark:text-emerald-400"
            )}
          >
            {isANS ? (
              <FileText className="h-6 w-6" />
            ) : (
              <Shield className="h-6 w-6" />
            )}
          </div>
          {isNew && (
            <Badge variant="secondary" className="bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400">
              2024
            </Badge>
          )}
        </div>

        <div className="space-y-1 pt-3">
          <CardTitle className="text-xl">{title}</CardTitle>
          <p
            className={cn(
              "text-sm font-medium",
              isANS ? "text-blue-600 dark:text-blue-400" : "text-emerald-600 dark:text-emerald-400"
            )}
          >
            {fullTitle}
          </p>
        </div>

        <CardDescription className="text-sm leading-relaxed pt-2">
          {description}
        </CardDescription>

        {effectiveDate && (
          <p className="text-xs text-muted-foreground pt-1">{effectiveDate}</p>
        )}
      </CardHeader>

      <CardContent className="pb-4">
        <div className="grid grid-cols-2 gap-3">
          {stats.map((stat, index) => (
            <div
              key={index}
              className={cn(
                "flex flex-col rounded-lg p-3",
                isANS
                  ? "bg-blue-50 dark:bg-blue-950/30"
                  : "bg-emerald-50 dark:bg-emerald-950/30"
              )}
            >
              <div className="flex items-center gap-2">
                {stat.icon && (
                  <span
                    className={cn(
                      "text-muted-foreground",
                      isANS ? "text-blue-500" : "text-emerald-500"
                    )}
                  >
                    {stat.icon}
                  </span>
                )}
                <span className="text-2xl font-bold">{stat.value}</span>
              </div>
              <span className="text-xs text-muted-foreground">{stat.label}</span>
            </div>
          ))}
        </div>
      </CardContent>

      <CardFooter className="pt-0">
        <Button
          asChild
          className={cn(
            "w-full group",
            isANS
              ? "bg-blue-600 hover:bg-blue-700 dark:bg-blue-600 dark:hover:bg-blue-700"
              : "bg-emerald-600 hover:bg-emerald-700 dark:bg-emerald-600 dark:hover:bg-emerald-700"
          )}
        >
          <Link href={`/${locale}${href}`}>
            {browseLabel}
            <ArrowRight className="ml-2 h-4 w-4 transition-transform group-hover:translate-x-1" />
          </Link>
        </Button>
      </CardFooter>
    </Card>
  );
}

// Helper to get default stats icons
export function getStatsIcon(type: string) {
  switch (type) {
    case "questions":
      return <BookOpen className="h-4 w-4" />;
    case "areas":
      return <Layers className="h-4 w-4" />;
    case "elements":
      return <Target className="h-4 w-4" />;
    case "levels":
      return <Award className="h-4 w-4" />;
    default:
      return null;
  }
}

```

# src/components/features/questionnaire/sms/component-tabs.tsx

```tsx
"use client";

import { useTranslations } from "next-intl";
import { Shield, AlertTriangle, CheckCircle, Megaphone } from "lucide-react";
import { cn } from "@/lib/utils";
import { getSMSComponentsArray } from "@/lib/questionnaire/constants";
import type { SMSComponent } from "@prisma/client";

interface ComponentTabsProps {
  selected: SMSComponent;
  onChange: (component: SMSComponent) => void;
  locale: string;
}

const componentIcons: Record<SMSComponent, typeof Shield> = {
  SAFETY_POLICY_OBJECTIVES: Shield,
  SAFETY_RISK_MANAGEMENT: AlertTriangle,
  SAFETY_ASSURANCE: CheckCircle,
  SAFETY_PROMOTION: Megaphone,
};

const componentColors: Record<
  SMSComponent,
  {
    bg: string;
    bgActive: string;
    border: string;
    text: string;
    textActive: string;
    icon: string;
    iconActive: string;
    weight: string;
  }
> = {
  SAFETY_POLICY_OBJECTIVES: {
    bg: "bg-white dark:bg-gray-900",
    bgActive: "bg-emerald-50 dark:bg-emerald-950/50",
    border: "border-gray-200 dark:border-gray-800",
    text: "text-gray-600 dark:text-gray-400",
    textActive: "text-emerald-700 dark:text-emerald-400",
    icon: "text-gray-400",
    iconActive: "text-emerald-600 dark:text-emerald-400",
    weight: "bg-emerald-100 text-emerald-700 dark:bg-emerald-900/50 dark:text-emerald-400",
  },
  SAFETY_RISK_MANAGEMENT: {
    bg: "bg-white dark:bg-gray-900",
    bgActive: "bg-amber-50 dark:bg-amber-950/50",
    border: "border-gray-200 dark:border-gray-800",
    text: "text-gray-600 dark:text-gray-400",
    textActive: "text-amber-700 dark:text-amber-400",
    icon: "text-gray-400",
    iconActive: "text-amber-600 dark:text-amber-400",
    weight: "bg-amber-100 text-amber-700 dark:bg-amber-900/50 dark:text-amber-400",
  },
  SAFETY_ASSURANCE: {
    bg: "bg-white dark:bg-gray-900",
    bgActive: "bg-blue-50 dark:bg-blue-950/50",
    border: "border-gray-200 dark:border-gray-800",
    text: "text-gray-600 dark:text-gray-400",
    textActive: "text-blue-700 dark:text-blue-400",
    icon: "text-gray-400",
    iconActive: "text-blue-600 dark:text-blue-400",
    weight: "bg-blue-100 text-blue-700 dark:bg-blue-900/50 dark:text-blue-400",
  },
  SAFETY_PROMOTION: {
    bg: "bg-white dark:bg-gray-900",
    bgActive: "bg-purple-50 dark:bg-purple-950/50",
    border: "border-gray-200 dark:border-gray-800",
    text: "text-gray-600 dark:text-gray-400",
    textActive: "text-purple-700 dark:text-purple-400",
    icon: "text-gray-400",
    iconActive: "text-purple-600 dark:text-purple-400",
    weight: "bg-purple-100 text-purple-700 dark:bg-purple-900/50 dark:text-purple-400",
  },
};

export function ComponentTabs({
  selected,
  onChange,
  locale,
}: ComponentTabsProps) {
  const t = useTranslations("smsBrowser");
  const components = getSMSComponentsArray();
  const lang = locale === "fr" ? "fr" : "en";

  return (
    <div className="flex gap-3 overflow-x-auto pb-2 -mx-4 px-4 md:mx-0 md:px-0">
      {components.map((component) => {
        const isActive = selected === component.code;
        const Icon = componentIcons[component.code];
        const colors = componentColors[component.code];

        return (
          <button
            key={component.code}
            onClick={() => onChange(component.code)}
            className={cn(
              "flex-shrink-0 rounded-xl border-2 p-4 text-left transition-all min-w-[180px]",
              "hover:shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500",
              isActive
                ? cn(colors.bgActive, "border-current", colors.textActive)
                : cn(colors.bg, colors.border, "hover:border-gray-300")
            )}
          >
            <div className="flex items-start justify-between gap-2 mb-2">
              <Icon
                className={cn(
                  "h-6 w-6",
                  isActive ? colors.iconActive : colors.icon
                )}
              />
              <span
                className={cn(
                  "text-xs font-bold px-2 py-0.5 rounded",
                  colors.weight
                )}
              >
                {Math.round(component.weight * 100)}%
              </span>
            </div>
            <div className="space-y-1">
              <p
                className={cn(
                  "text-sm font-semibold",
                  isActive ? colors.textActive : colors.text
                )}
              >
                {t(`components.${component.number}.short`)}
              </p>
              <p className="text-xs text-muted-foreground line-clamp-2">
                {component.name[lang]}
              </p>
            </div>

            {/* Visual weight indicator */}
            <div className="mt-3 h-1.5 rounded-full bg-gray-200 dark:bg-gray-700 overflow-hidden">
              <div
                className={cn(
                  "h-full rounded-full transition-all",
                  isActive
                    ? componentColors[component.code].iconActive.replace(
                        "text-",
                        "bg-"
                      )
                    : "bg-gray-300 dark:bg-gray-600"
                )}
                style={{ width: `${component.weight * 100}%` }}
              />
            </div>
          </button>
        );
      })}
    </div>
  );
}

```

# src/components/features/questionnaire/sms/index.ts

```ts
export { SMSBrowser } from "./sms-browser";
export { SMSBrowserSkeleton } from "./sms-browser-skeleton";
export { ComponentTabs } from "./component-tabs";
export { StudyAreaAccordion } from "./study-area-accordion";
export { MaturityTable } from "./maturity-table";
export { MaturityLegend, MaturityBadge, maturityColors } from "./maturity-legend";
export { TransversalBadge, TransversalBadges } from "./transversal-badge";

```

# src/components/features/questionnaire/sms/maturity-legend.tsx

```tsx
"use client";

import { useState } from "react";
import { useTranslations } from "next-intl";
import { ChevronDown, ChevronUp, Info } from "lucide-react";
import { Button } from "@/components/ui/button";
import { Card, CardContent } from "@/components/ui/card";
import {
  Collapsible,
  CollapsibleContent,
  CollapsibleTrigger,
} from "@/components/ui/collapsible";
import { cn } from "@/lib/utils";
import { MATURITY_LEVELS, getMaturityLevelsArray } from "@/lib/questionnaire/constants";
import type { MaturityLevel } from "@prisma/client";

interface MaturityLegendProps {
  locale: string;
  defaultOpen?: boolean;
  compact?: boolean;
}

// Maturity level color configuration
export const maturityColors: Record<
  MaturityLevel,
  {
    bg: string;
    text: string;
    border: string;
    fill: string;
  }
> = {
  LEVEL_A: {
    bg: "bg-red-100 dark:bg-red-950/40",
    text: "text-red-700 dark:text-red-400",
    border: "border-red-300 dark:border-red-700",
    fill: "bg-red-500",
  },
  LEVEL_B: {
    bg: "bg-orange-100 dark:bg-orange-950/40",
    text: "text-orange-700 dark:text-orange-400",
    border: "border-orange-300 dark:border-orange-700",
    fill: "bg-orange-500",
  },
  LEVEL_C: {
    bg: "bg-yellow-100 dark:bg-yellow-950/40",
    text: "text-yellow-700 dark:text-yellow-400",
    border: "border-yellow-300 dark:border-yellow-700",
    fill: "bg-yellow-500",
  },
  LEVEL_D: {
    bg: "bg-lime-100 dark:bg-lime-950/40",
    text: "text-lime-700 dark:text-lime-400",
    border: "border-lime-300 dark:border-lime-700",
    fill: "bg-lime-500",
  },
  LEVEL_E: {
    bg: "bg-emerald-100 dark:bg-emerald-950/40",
    text: "text-emerald-700 dark:text-emerald-400",
    border: "border-emerald-300 dark:border-emerald-700",
    fill: "bg-emerald-500",
  },
};

export function MaturityLegend({
  locale,
  defaultOpen = true,
  compact = false,
}: MaturityLegendProps) {
  const t = useTranslations("smsBrowser");
  const [isOpen, setIsOpen] = useState(defaultOpen);
  const levels = getMaturityLevelsArray();
  const lang = locale === "fr" ? "fr" : "en";

  if (compact) {
    return (
      <div className="flex items-center gap-3 flex-wrap">
        {levels.map((level) => {
          const colors = maturityColors[level.code];
          return (
            <div key={level.code} className="flex items-center gap-1.5">
              <div
                className={cn(
                  "w-6 h-6 rounded flex items-center justify-center text-xs font-bold",
                  colors.bg,
                  colors.text
                )}
              >
                {level.level}
              </div>
              <span className="text-xs text-muted-foreground">
                {level.name[lang]}
              </span>
            </div>
          );
        })}
      </div>
    );
  }

  return (
    <Collapsible open={isOpen} onOpenChange={setIsOpen}>
      <Card>
        <CollapsibleTrigger asChild>
          <CardContent className="p-4 cursor-pointer hover:bg-muted/30 transition-colors">
            <div className="flex items-center justify-between">
              <div className="flex items-center gap-2">
                <Info className="h-4 w-4 text-emerald-600" />
                <span className="font-medium text-sm">
                  {t("maturity.legend")}
                </span>
              </div>
              <div className="flex items-center gap-4">
                {/* Compact view when closed */}
                {!isOpen && (
                  <div className="hidden sm:flex items-center gap-2">
                    {levels.map((level) => {
                      const colors = maturityColors[level.code];
                      return (
                        <div
                          key={level.code}
                          className={cn(
                            "w-6 h-6 rounded flex items-center justify-center text-xs font-bold",
                            colors.bg,
                            colors.text
                          )}
                        >
                          {level.level}
                        </div>
                      );
                    })}
                  </div>
                )}
                <Button variant="ghost" size="icon" className="h-6 w-6">
                  {isOpen ? (
                    <ChevronUp className="h-4 w-4" />
                  ) : (
                    <ChevronDown className="h-4 w-4" />
                  )}
                </Button>
              </div>
            </div>
          </CardContent>
        </CollapsibleTrigger>

        <CollapsibleContent>
          <CardContent className="pt-0 px-4 pb-4">
            <div className="grid gap-3 sm:grid-cols-5">
              {levels.map((level) => {
                const colors = maturityColors[level.code];
                return (
                  <div
                    key={level.code}
                    className={cn(
                      "rounded-lg p-3 border",
                      colors.bg,
                      colors.border
                    )}
                  >
                    <div className="flex items-center gap-2 mb-2">
                      <div
                        className={cn(
                          "w-8 h-8 rounded flex items-center justify-center text-sm font-bold",
                          colors.fill,
                          "text-white"
                        )}
                      >
                        {level.level}
                      </div>
                      <span className={cn("font-semibold text-sm", colors.text)}>
                        {level.name[lang]}
                      </span>
                    </div>
                    <p className="text-xs text-muted-foreground line-clamp-3">
                      {level.description[lang]}
                    </p>
                  </div>
                );
              })}
            </div>
          </CardContent>
        </CollapsibleContent>
      </Card>
    </Collapsible>
  );
}

// Helper component to show a single maturity level badge
interface MaturityBadgeProps {
  level: MaturityLevel;
  locale: string;
  showLabel?: boolean;
  size?: "sm" | "md" | "lg";
}

export function MaturityBadge({
  level,
  locale,
  showLabel = false,
  size = "md",
}: MaturityBadgeProps) {
  const lang = locale === "fr" ? "fr" : "en";
  const meta = MATURITY_LEVELS[level];
  const colors = maturityColors[level];

  const sizeClasses = {
    sm: "w-5 h-5 text-[10px]",
    md: "w-6 h-6 text-xs",
    lg: "w-8 h-8 text-sm",
  };

  return (
    <div className="flex items-center gap-1.5">
      <div
        className={cn(
          "rounded flex items-center justify-center font-bold",
          colors.fill,
          "text-white",
          sizeClasses[size]
        )}
      >
        {meta.level}
      </div>
      {showLabel && (
        <span className={cn("text-sm", colors.text)}>{meta.name[lang]}</span>
      )}
    </div>
  );
}

```

# src/components/features/questionnaire/sms/maturity-table.tsx

```tsx
"use client";

import { useTranslations } from "next-intl";
import { cn } from "@/lib/utils";
import { maturityColors } from "./maturity-legend";
import { getMaturityLevelsArray } from "@/lib/questionnaire/constants";
import type { CANSOStudyArea, MaturityLevel } from "@prisma/client";

interface MaturityTableProps {
  studyArea: CANSOStudyArea;
  locale: string;
  componentNumber: number;
}

// Mock objectives data for each study area
interface ObjectiveMaturity {
  id: string;
  objectiveNumber: number;
  titleEn: string;
  titleFr: string;
  maturityDescriptors: Record<
    MaturityLevel,
    { en: string; fr: string }
  >;
}

const mockObjectives: Partial<Record<CANSOStudyArea, ObjectiveMaturity[]>> = {
  SA_1_1: [
    {
      id: "obj-1-1-1",
      objectiveNumber: 1,
      titleEn: "Senior management demonstrates commitment to safety",
      titleFr: "La haute direction démontre son engagement envers la sécurité",
      maturityDescriptors: {
        LEVEL_A: {
          en: "No formal safety commitment documented",
          fr: "Aucun engagement formel en matière de sécurité documenté",
        },
        LEVEL_B: {
          en: "Safety policy exists but not actively communicated",
          fr: "La politique de sécurité existe mais n'est pas activement communiquée",
        },
        LEVEL_C: {
          en: "Safety policy signed and communicated to all staff",
          fr: "Politique de sécurité signée et communiquée à tout le personnel",
        },
        LEVEL_D: {
          en: "Management actively promotes safety in daily operations",
          fr: "La direction promeut activement la sécurité dans les opérations quotidiennes",
        },
        LEVEL_E: {
          en: "Safety leadership recognized as industry benchmark",
          fr: "Leadership en sécurité reconnu comme référence de l'industrie",
        },
      },
    },
    {
      id: "obj-1-1-2",
      objectiveNumber: 2,
      titleEn: "Adequate resources are allocated to safety activities",
      titleFr: "Des ressources adéquates sont allouées aux activités de sécurité",
      maturityDescriptors: {
        LEVEL_A: {
          en: "Safety activities funded on ad-hoc basis",
          fr: "Activités de sécurité financées de manière ponctuelle",
        },
        LEVEL_B: {
          en: "Basic budget allocated but often insufficient",
          fr: "Budget de base alloué mais souvent insuffisant",
        },
        LEVEL_C: {
          en: "Dedicated budget with annual planning process",
          fr: "Budget dédié avec processus de planification annuel",
        },
        LEVEL_D: {
          en: "Resources optimized based on risk assessment",
          fr: "Ressources optimisées sur la base de l'évaluation des risques",
        },
        LEVEL_E: {
          en: "Investment in safety innovation and best practices",
          fr: "Investissement dans l'innovation en sécurité et les meilleures pratiques",
        },
      },
    },
    {
      id: "obj-1-1-3",
      objectiveNumber: 3,
      titleEn: "Safety objectives are defined and measurable",
      titleFr: "Les objectifs de sécurité sont définis et mesurables",
      maturityDescriptors: {
        LEVEL_A: {
          en: "No formal safety objectives established",
          fr: "Aucun objectif de sécurité formel établi",
        },
        LEVEL_B: {
          en: "General safety goals exist without specific targets",
          fr: "Des objectifs généraux de sécurité existent sans cibles spécifiques",
        },
        LEVEL_C: {
          en: "SMART objectives defined with regular monitoring",
          fr: "Objectifs SMART définis avec suivi régulier",
        },
        LEVEL_D: {
          en: "Objectives aligned with organizational strategy",
          fr: "Objectifs alignés sur la stratégie organisationnelle",
        },
        LEVEL_E: {
          en: "Objectives set to exceed industry benchmarks",
          fr: "Objectifs fixés pour dépasser les références de l'industrie",
        },
      },
    },
    {
      id: "obj-1-1-4",
      objectiveNumber: 4,
      titleEn: "Safety performance is regularly reviewed by management",
      titleFr: "Les performances de sécurité sont régulièrement examinées par la direction",
      maturityDescriptors: {
        LEVEL_A: {
          en: "No formal safety performance review process",
          fr: "Aucun processus formel d'examen des performances de sécurité",
        },
        LEVEL_B: {
          en: "Annual review of major incidents only",
          fr: "Examen annuel des incidents majeurs uniquement",
        },
        LEVEL_C: {
          en: "Quarterly management review of safety metrics",
          fr: "Revue trimestrielle par la direction des indicateurs de sécurité",
        },
        LEVEL_D: {
          en: "Real-time monitoring with proactive interventions",
          fr: "Surveillance en temps réel avec interventions proactives",
        },
        LEVEL_E: {
          en: "Predictive analytics driving continuous improvement",
          fr: "Analyses prédictives favorisant l'amélioration continue",
        },
      },
    },
  ],
  SA_2_1: [
    {
      id: "obj-2-1-1",
      objectiveNumber: 1,
      titleEn: "Hazard identification processes are established",
      titleFr: "Les processus d'identification des dangers sont établis",
      maturityDescriptors: {
        LEVEL_A: {
          en: "Reactive hazard identification only",
          fr: "Identification des dangers réactive uniquement",
        },
        LEVEL_B: {
          en: "Basic reporting system in place",
          fr: "Système de signalement de base en place",
        },
        LEVEL_C: {
          en: "Proactive hazard identification program",
          fr: "Programme proactif d'identification des dangers",
        },
        LEVEL_D: {
          en: "Predictive methods integrated with operations",
          fr: "Méthodes prédictives intégrées aux opérations",
        },
        LEVEL_E: {
          en: "Industry-leading predictive capabilities",
          fr: "Capacités prédictives de premier plan dans l'industrie",
        },
      },
    },
  ],
};

// Get objectives for a study area (with fallback)
function getObjectivesForStudyArea(studyArea: CANSOStudyArea): ObjectiveMaturity[] {
  return mockObjectives[studyArea] || mockObjectives.SA_1_1 || [];
}

export function MaturityTable({
  studyArea,
  locale,
}: MaturityTableProps) {
  const t = useTranslations("smsBrowser");
  const lang = locale === "fr" ? "fr" : "en";
  const levels = getMaturityLevelsArray();
  const objectives = getObjectivesForStudyArea(studyArea);

  return (
    <div className="space-y-4">
      <h4 className="font-semibold text-sm flex items-center gap-2">
        {t("maturity.objectivesTitle")}
      </h4>

      {objectives.map((objective) => (
        <div
          key={objective.id}
          className="rounded-lg border bg-card overflow-hidden"
        >
          {/* Objective Header */}
          <div className="p-3 bg-muted/30 border-b">
            <div className="flex items-start gap-2">
              <span className="shrink-0 font-mono text-xs font-bold px-2 py-1 rounded bg-muted">
                {objective.objectiveNumber}
              </span>
              <p className="text-sm font-medium">
                {lang === "fr" ? objective.titleFr : objective.titleEn}
              </p>
            </div>
          </div>

          {/* Maturity Levels Grid */}
          <div className="grid grid-cols-5">
            {levels.map((level, index) => {
              const colors = maturityColors[level.code];
              const descriptor = objective.maturityDescriptors[level.code];

              return (
                <div
                  key={level.code}
                  className={cn(
                    "p-3 min-h-[100px]",
                    index < 4 && "border-r",
                    colors.bg
                  )}
                >
                  {/* Level Badge */}
                  <div className="flex items-center gap-1.5 mb-2">
                    <div
                      className={cn(
                        "w-6 h-6 rounded flex items-center justify-center text-xs font-bold text-white",
                        colors.fill
                      )}
                    >
                      {level.level}
                    </div>
                    <span className={cn("text-xs font-medium", colors.text)}>
                      {level.name[lang]}
                    </span>
                  </div>

                  {/* Descriptor */}
                  <p className="text-xs text-muted-foreground">
                    {lang === "fr" ? descriptor.fr : descriptor.en}
                  </p>
                </div>
              );
            })}
          </div>
        </div>
      ))}
    </div>
  );
}

```

# src/components/features/questionnaire/sms/sms-browser-skeleton.tsx

```tsx
import { Skeleton } from "@/components/ui/skeleton";
import { Card, CardContent, CardHeader } from "@/components/ui/card";

export function SMSBrowserSkeleton() {
  return (
    <div className="flex flex-col gap-6">
      {/* Header */}
      <div className="flex flex-col gap-2">
        <Skeleton className="h-4 w-48" />
        <Skeleton className="h-8 w-72" />
        <Skeleton className="h-4 w-96" />
      </div>

      {/* Maturity Legend */}
      <Card>
        <CardContent className="p-4">
          <div className="flex items-center gap-4 flex-wrap">
            {[1, 2, 3, 4, 5].map((i) => (
              <div key={i} className="flex items-center gap-2">
                <Skeleton className="h-6 w-6 rounded" />
                <Skeleton className="h-4 w-20" />
              </div>
            ))}
          </div>
        </CardContent>
      </Card>

      {/* Component Tabs */}
      <div className="flex gap-2 overflow-x-auto pb-2">
        {[1, 2, 3, 4].map((i) => (
          <Skeleton key={i} className="h-16 w-48 shrink-0 rounded-lg" />
        ))}
      </div>

      {/* Study Areas Accordion */}
      <div className="space-y-3">
        {[1, 2, 3].map((i) => (
          <Card key={i}>
            <CardHeader className="p-4">
              <div className="flex items-center gap-4">
                <Skeleton className="h-10 w-16 rounded" />
                <div className="flex-1 space-y-2">
                  <Skeleton className="h-5 w-64" />
                  <Skeleton className="h-4 w-48" />
                </div>
                <Skeleton className="h-6 w-6" />
              </div>
            </CardHeader>
          </Card>
        ))}
      </div>

      {/* Maturity Table */}
      <Card>
        <CardHeader>
          <Skeleton className="h-6 w-48" />
        </CardHeader>
        <CardContent>
          <div className="space-y-4">
            {[1, 2, 3].map((i) => (
              <div key={i} className="space-y-2">
                <Skeleton className="h-4 w-full" />
                <div className="grid grid-cols-5 gap-2">
                  {[1, 2, 3, 4, 5].map((j) => (
                    <Skeleton key={j} className="h-20 rounded" />
                  ))}
                </div>
              </div>
            ))}
          </div>
        </CardContent>
      </Card>
    </div>
  );
}

```

# src/components/features/questionnaire/sms/sms-browser.tsx

```tsx
"use client";

import { useCallback, useState } from "react";
import { useRouter, useSearchParams } from "next/navigation";
import { useTranslations } from "next-intl";
import Link from "next/link";
import { ChevronRight, Home, Shield } from "lucide-react";
import { ComponentTabs } from "./component-tabs";
import { StudyAreaAccordion } from "./study-area-accordion";
import { MaturityLegend } from "./maturity-legend";
import { SMS_COMPONENTS } from "@/lib/questionnaire/constants";
import type { SMSComponent, CANSOStudyArea } from "@prisma/client";

interface SMSBrowserProps {
  locale: string;
  initialComponent?: string;
  initialStudyArea?: string;
}

export function SMSBrowser({
  locale,
  initialComponent,
  initialStudyArea,
}: SMSBrowserProps) {
  const t = useTranslations("smsBrowser");
  const router = useRouter();
  const searchParams = useSearchParams();
  const lang = locale === "fr" ? "fr" : "en";

  // State
  const [selectedComponent, setSelectedComponent] = useState<SMSComponent>(
    (initialComponent as SMSComponent) || "SAFETY_POLICY_OBJECTIVES"
  );

  // Update URL when component changes
  const handleComponentChange = useCallback(
    (component: SMSComponent) => {
      setSelectedComponent(component);
      const params = new URLSearchParams(searchParams.toString());
      params.set("component", component);
      params.delete("studyArea");
      router.push(`/${locale}/questionnaires/sms?${params.toString()}`);
    },
    [router, searchParams, locale]
  );

  // Update URL when study area is expanded
  const handleStudyAreaChange = useCallback(
    (studyArea: CANSOStudyArea | undefined) => {
      const params = new URLSearchParams(searchParams.toString());
      if (studyArea) {
        params.set("studyArea", studyArea);
      } else {
        params.delete("studyArea");
      }
      router.push(`/${locale}/questionnaires/sms?${params.toString()}`);
    },
    [router, searchParams, locale]
  );

  const componentMeta = SMS_COMPONENTS[selectedComponent];

  return (
    <div className="flex flex-col gap-6">
      {/* Breadcrumb & Header */}
      <div>
        <nav className="flex items-center gap-1 text-sm text-muted-foreground mb-2">
          <Link
            href={`/${locale}/questionnaires`}
            className="hover:text-foreground transition-colors"
          >
            <Home className="h-4 w-4" />
          </Link>
          <ChevronRight className="h-4 w-4" />
          <Link
            href={`/${locale}/questionnaires`}
            className="hover:text-foreground transition-colors"
          >
            {t("breadcrumb.questionnaires")}
          </Link>
          <ChevronRight className="h-4 w-4" />
          <span className="text-foreground font-medium">
            {t("breadcrumb.sms")}
          </span>
        </nav>

        <h1 className="text-2xl font-bold tracking-tight flex items-center gap-2">
          <Shield className="h-6 w-6 text-emerald-600" />
          {t("title")}
        </h1>
        <p className="text-muted-foreground">{t("subtitle")}</p>
      </div>

      {/* Maturity Legend */}
      <MaturityLegend locale={locale} defaultOpen={false} />

      {/* Component Tabs */}
      <div>
        <h2 className="text-lg font-semibold mb-3">{t("components.title")}</h2>
        <ComponentTabs
          selected={selectedComponent}
          onChange={handleComponentChange}
          locale={locale}
        />
      </div>

      {/* Component Details */}
      <div className="rounded-lg border bg-muted/20 p-4">
        <div className="flex items-center gap-3 mb-2">
          <span className="text-sm font-medium text-muted-foreground">
            {t("components.selected")}:
          </span>
          <span className="font-semibold">{componentMeta.name[lang]}</span>
          <span className="text-sm px-2 py-0.5 rounded bg-emerald-100 text-emerald-700 dark:bg-emerald-900/50 dark:text-emerald-400 font-bold">
            {Math.round(componentMeta.weight * 100)}% {t("components.weight")}
          </span>
        </div>
        <p className="text-sm text-muted-foreground">
          {componentMeta.description[lang]}
        </p>
      </div>

      {/* Study Areas */}
      <div>
        <h2 className="text-lg font-semibold mb-3">
          {t("studyArea.title")}
        </h2>
        <StudyAreaAccordion
          component={selectedComponent}
          locale={locale}
          defaultOpen={initialStudyArea}
          onStudyAreaChange={handleStudyAreaChange}
        />
      </div>
    </div>
  );
}

```

# src/components/features/questionnaire/sms/study-area-accordion.tsx

```tsx
"use client";

import { useTranslations } from "next-intl";
import { ChevronDown, Target } from "lucide-react";
import { Card, CardContent, CardHeader } from "@/components/ui/card";
import {
  Accordion,
  AccordionContent,
  AccordionItem,
  AccordionTrigger,
} from "@/components/ui/accordion";
import { cn } from "@/lib/utils";
import { TransversalBadges } from "./transversal-badge";
import { MaturityTable } from "./maturity-table";
import { getStudyAreasByComponent } from "@/lib/questionnaire/constants";
import type { SMSComponent, CANSOStudyArea, TransversalArea } from "@prisma/client";

interface StudyAreaAccordionProps {
  component: SMSComponent;
  locale: string;
  defaultOpen?: string;
  onStudyAreaChange?: (studyArea: CANSOStudyArea | undefined) => void;
}

// Mock data for transversal areas associated with each study area
const studyAreaTransversals: Partial<Record<CANSOStudyArea, TransversalArea[]>> = {
  SA_1_1: ["SPM"],
  SA_1_2: ["HP"],
  SA_2_1: ["SPM", "HP"],
  SA_2_2: ["SPM", "CI"],
  SA_3_1: ["SPM", "CI"],
  SA_3_2: ["CI"],
  SA_3_3: ["CI"],
  SA_4_1: ["HP"],
  SA_4_2: ["HP", "CI"],
};

// Mock objective counts per study area
const studyAreaObjectiveCounts: Partial<Record<CANSOStudyArea, number>> = {
  SA_1_1: 4,
  SA_1_2: 3,
  SA_1_3: 2,
  SA_1_4: 3,
  SA_1_5: 2,
  SA_2_1: 5,
  SA_2_2: 4,
  SA_3_1: 4,
  SA_3_2: 3,
  SA_3_3: 3,
  SA_4_1: 3,
  SA_4_2: 3,
};

const componentColors: Record<number, string> = {
  1: "border-emerald-200 dark:border-emerald-800",
  2: "border-amber-200 dark:border-amber-800",
  3: "border-blue-200 dark:border-blue-800",
  4: "border-purple-200 dark:border-purple-800",
};

const componentBgColors: Record<number, string> = {
  1: "bg-emerald-50 dark:bg-emerald-950/30",
  2: "bg-amber-50 dark:bg-amber-950/30",
  3: "bg-blue-50 dark:bg-blue-950/30",
  4: "bg-purple-50 dark:bg-purple-950/30",
};

const componentTextColors: Record<number, string> = {
  1: "text-emerald-700 dark:text-emerald-400",
  2: "text-amber-700 dark:text-amber-400",
  3: "text-blue-700 dark:text-blue-400",
  4: "text-purple-700 dark:text-purple-400",
};

export function StudyAreaAccordion({
  component,
  locale,
  defaultOpen,
  onStudyAreaChange,
}: StudyAreaAccordionProps) {
  const t = useTranslations("smsBrowser");
  const lang = locale === "fr" ? "fr" : "en";

  // Get study areas for the selected component
  const studyAreas = getStudyAreasByComponent(
    parseInt(component.split("_")[2]) || 1
  );

  const componentNumber = studyAreas[0]?.componentNumber || 1;
  const borderColor = componentColors[componentNumber];
  const bgColor = componentBgColors[componentNumber];
  const textColor = componentTextColors[componentNumber];

  const handleValueChange = (value: string) => {
    if (onStudyAreaChange) {
      onStudyAreaChange(value ? (value as CANSOStudyArea) : undefined);
    }
  };

  return (
    <Accordion
      type="single"
      collapsible
      defaultValue={defaultOpen}
      onValueChange={handleValueChange}
      className="space-y-3"
    >
      {studyAreas.map((studyArea) => {
        const transversals = studyAreaTransversals[studyArea.code] || [];
        const objectiveCount = studyAreaObjectiveCounts[studyArea.code] || 0;
        const displayCode = studyArea.code.replace(/_/g, " ").replace("SA ", "");

        return (
          <AccordionItem
            key={studyArea.code}
            value={studyArea.code}
            className="border-0"
          >
            <Card className={cn("transition-all", borderColor)}>
              <CardHeader className="p-0">
                <AccordionTrigger className="p-4 hover:bg-muted/30 hover:no-underline w-full [&[data-state=open]>div>svg]:rotate-180">
                  <div className="flex items-center gap-4 w-full">
                    {/* Study Area Code Badge */}
                    <div
                      className={cn(
                        "shrink-0 px-3 py-2 rounded-lg font-mono font-bold text-sm",
                        bgColor,
                        textColor
                      )}
                    >
                      SA {displayCode}
                    </div>

                    {/* Title and Meta */}
                    <div className="flex-1 min-w-0 text-left">
                      <h3 className="font-semibold text-sm mb-1">
                        {studyArea.name[lang]}
                      </h3>
                      <div className="flex items-center gap-3 flex-wrap">
                        <span className="text-xs text-muted-foreground flex items-center gap-1">
                          <Target className="h-3 w-3" />
                          {t("studyArea.objectives", { count: objectiveCount })}
                        </span>
                        {transversals.length > 0 && (
                          <TransversalBadges
                            areas={transversals}
                            locale={locale}
                            size="sm"
                          />
                        )}
                      </div>
                    </div>

                    {/* Chevron */}
                    <ChevronDown className="h-5 w-5 shrink-0 text-muted-foreground transition-transform duration-200" />
                  </div>
                </AccordionTrigger>
              </CardHeader>

              <AccordionContent>
                <CardContent className="pt-0 px-4 pb-4">
                  {/* Study Area Description */}
                  <div className="mb-4 p-3 rounded-lg bg-muted/30">
                    <p className="text-sm text-muted-foreground">
                      {studyArea.description[lang]}
                    </p>
                  </div>

                  {/* Maturity Table */}
                  <MaturityTable
                    studyArea={studyArea.code}
                    locale={locale}
                    componentNumber={componentNumber}
                  />
                </CardContent>
              </AccordionContent>
            </Card>
          </AccordionItem>
        );
      })}
    </Accordion>
  );
}

```

# src/components/features/questionnaire/sms/transversal-badge.tsx

```tsx
"use client";

import { Badge } from "@/components/ui/badge";
import {
  Tooltip,
  TooltipContent,
  TooltipProvider,
  TooltipTrigger,
} from "@/components/ui/tooltip";
import { BarChart3, Users, RefreshCw } from "lucide-react";
import { cn } from "@/lib/utils";
import type { TransversalArea } from "@prisma/client";
import { TRANSVERSAL_AREAS } from "@/lib/questionnaire/constants";

interface TransversalBadgeProps {
  area: TransversalArea;
  locale: string;
  showLabel?: boolean;
  size?: "sm" | "md";
}

const areaConfig: Record<
  TransversalArea,
  {
    icon: typeof BarChart3;
    bgColor: string;
    textColor: string;
    borderColor: string;
  }
> = {
  SPM: {
    icon: BarChart3,
    bgColor: "bg-indigo-100 dark:bg-indigo-950/40",
    textColor: "text-indigo-700 dark:text-indigo-400",
    borderColor: "border-indigo-300 dark:border-indigo-700",
  },
  HP: {
    icon: Users,
    bgColor: "bg-rose-100 dark:bg-rose-950/40",
    textColor: "text-rose-700 dark:text-rose-400",
    borderColor: "border-rose-300 dark:border-rose-700",
  },
  CI: {
    icon: RefreshCw,
    bgColor: "bg-teal-100 dark:bg-teal-950/40",
    textColor: "text-teal-700 dark:text-teal-400",
    borderColor: "border-teal-300 dark:border-teal-700",
  },
};

export function TransversalBadge({
  area,
  locale,
  showLabel = true,
  size = "md",
}: TransversalBadgeProps) {
  const lang = locale === "fr" ? "fr" : "en";
  const config = areaConfig[area];
  const meta = TRANSVERSAL_AREAS[area];
  const Icon = config.icon;

  const badge = (
    <Badge
      variant="outline"
      className={cn(
        config.bgColor,
        config.textColor,
        config.borderColor,
        size === "sm" ? "text-[10px] px-1.5 py-0" : "text-xs px-2 py-0.5"
      )}
    >
      <Icon className={cn("mr-1", size === "sm" ? "h-3 w-3" : "h-3.5 w-3.5")} />
      {showLabel ? meta.name[lang] : area}
    </Badge>
  );

  if (!showLabel) {
    return (
      <TooltipProvider>
        <Tooltip>
          <TooltipTrigger asChild>{badge}</TooltipTrigger>
          <TooltipContent>
            <p className="font-medium">{meta.name[lang]}</p>
            <p className="text-xs text-muted-foreground max-w-[200px]">
              {meta.description[lang]}
            </p>
          </TooltipContent>
        </Tooltip>
      </TooltipProvider>
    );
  }

  return badge;
}

interface TransversalBadgesProps {
  areas: TransversalArea[];
  locale: string;
  size?: "sm" | "md";
}

export function TransversalBadges({
  areas,
  locale,
  size = "sm",
}: TransversalBadgesProps) {
  if (areas.length === 0) return null;

  return (
    <div className="flex flex-wrap gap-1">
      {areas.map((area) => (
        <TransversalBadge
          key={area}
          area={area}
          locale={locale}
          showLabel={false}
          size={size}
        />
      ))}
    </div>
  );
}

```

# src/components/features/scoring/ei-score-display.tsx

```tsx
"use client";

import { useMemo } from "react";
import { useLocale, useTranslations } from "next-intl";
import { motion } from "framer-motion";
import {
  CheckCircle2,
  XCircle,
  MinusCircle,
  HelpCircle,
  TrendingUp,
  TrendingDown,
  Minus,
  Info,
} from "lucide-react";
import { cn } from "@/lib/utils";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Badge } from "@/components/ui/badge";
import { Progress } from "@/components/ui/progress";
import {
  Tooltip,
  TooltipContent,
  TooltipProvider,
  TooltipTrigger,
} from "@/components/ui/tooltip";
import type { EIScoreResult, AuditAreaScore } from "@/server/services/scoring.service";
import { AUDIT_AREAS, CRITICAL_ELEMENTS } from "@/lib/constants/scoring";

// =============================================================================
// PROPS
// =============================================================================

interface EIScoreDisplayProps {
  score: EIScoreResult;
  showBreakdown?: boolean;
  previousScore?: number;
  compact?: boolean;
}

interface ScoreGaugeProps {
  score: number;
  size?: "sm" | "md" | "lg";
  label?: string;
  showTrend?: boolean;
  previousScore?: number;
}

interface ResponseBreakdownProps {
  satisfactory: number;
  notSatisfactory: number;
  notApplicable: number;
  notReviewed: number;
  total: number;
}

// =============================================================================
// HELPERS
// =============================================================================

function getScoreColor(score: number): string {
  if (score >= 90) return "text-green-600";
  if (score >= 70) return "text-blue-600";
  if (score >= 50) return "text-yellow-600";
  if (score >= 30) return "text-orange-600";
  return "text-red-600";
}

function getScoreLabel(score: number): string {
  if (score >= 90) return "Excellent";
  if (score >= 70) return "Good";
  if (score >= 50) return "Satisfactory";
  if (score >= 30) return "Needs Improvement";
  return "Critical";
}

// =============================================================================
// SUB-COMPONENTS
// =============================================================================

function ScoreGauge({
  score,
  size = "md",
  label,
  showTrend,
  previousScore,
}: ScoreGaugeProps) {
  const sizeClasses = {
    sm: "w-24 h-24",
    md: "w-36 h-36",
    lg: "w-48 h-48",
  };

  const fontSize = {
    sm: "text-xl",
    md: "text-3xl",
    lg: "text-4xl",
  };

  const strokeWidth = {
    sm: 6,
    md: 8,
    lg: 10,
  };

  const radius = size === "sm" ? 40 : size === "md" ? 60 : 80;
  const circumference = 2 * Math.PI * radius;
  const strokeDashoffset = circumference - (score / 100) * circumference;

  const trend = previousScore !== undefined ? score - previousScore : 0;

  return (
    <div className="relative inline-flex flex-col items-center">
      <div className={cn("relative", sizeClasses[size])}>
        <svg className="w-full h-full transform -rotate-90">
          {/* Background circle */}
          <circle
            cx="50%"
            cy="50%"
            r={radius}
            fill="none"
            stroke="currentColor"
            strokeWidth={strokeWidth[size]}
            className="text-muted/30"
          />
          {/* Score arc */}
          <motion.circle
            cx="50%"
            cy="50%"
            r={radius}
            fill="none"
            stroke="url(#scoreGradient)"
            strokeWidth={strokeWidth[size]}
            strokeLinecap="round"
            strokeDasharray={circumference}
            initial={{ strokeDashoffset: circumference }}
            animate={{ strokeDashoffset }}
            transition={{ duration: 1, ease: "easeOut" }}
          />
          <defs>
            <linearGradient id="scoreGradient" x1="0%" y1="0%" x2="100%" y2="0%">
              <stop
                offset="0%"
                className={cn(
                  score >= 90
                    ? "text-green-500"
                    : score >= 70
                    ? "text-blue-500"
                    : score >= 50
                    ? "text-yellow-500"
                    : score >= 30
                    ? "text-orange-500"
                    : "text-red-500"
                )}
                stopColor="currentColor"
              />
              <stop
                offset="100%"
                className={cn(
                  score >= 90
                    ? "text-green-600"
                    : score >= 70
                    ? "text-blue-600"
                    : score >= 50
                    ? "text-yellow-600"
                    : score >= 30
                    ? "text-orange-600"
                    : "text-red-600"
                )}
                stopColor="currentColor"
              />
            </linearGradient>
          </defs>
        </svg>

        {/* Score value */}
        <div className="absolute inset-0 flex flex-col items-center justify-center">
          <motion.span
            initial={{ scale: 0 }}
            animate={{ scale: 1 }}
            transition={{ delay: 0.5, type: "spring" }}
            className={cn("font-bold", fontSize[size], getScoreColor(score))}
          >
            {score.toFixed(1)}%
          </motion.span>
          {label && (
            <span className="text-xs text-muted-foreground mt-1">{label}</span>
          )}
        </div>
      </div>

      {/* Trend indicator */}
      {showTrend && previousScore !== undefined && (
        <div
          className={cn(
            "flex items-center gap-1 mt-2 text-sm",
            trend > 0
              ? "text-green-600"
              : trend < 0
              ? "text-red-600"
              : "text-muted-foreground"
          )}
        >
          {trend > 0 ? (
            <TrendingUp className="h-4 w-4" />
          ) : trend < 0 ? (
            <TrendingDown className="h-4 w-4" />
          ) : (
            <Minus className="h-4 w-4" />
          )}
          <span>
            {trend > 0 ? "+" : ""}
            {trend.toFixed(1)}%
          </span>
        </div>
      )}
    </div>
  );
}

function ResponseBreakdown({
  satisfactory,
  notSatisfactory,
  notApplicable,
  notReviewed,
  total,
}: ResponseBreakdownProps) {
  const t = useTranslations("scoring");

  const items = [
    {
      key: "satisfactory",
      label: t("satisfactory"),
      count: satisfactory,
      icon: CheckCircle2,
      color: "text-green-600",
      bgColor: "bg-green-100",
    },
    {
      key: "notSatisfactory",
      label: t("notSatisfactory"),
      count: notSatisfactory,
      icon: XCircle,
      color: "text-red-600",
      bgColor: "bg-red-100",
    },
    {
      key: "notApplicable",
      label: t("notApplicable"),
      count: notApplicable,
      icon: MinusCircle,
      color: "text-gray-600",
      bgColor: "bg-gray-100",
    },
    {
      key: "notReviewed",
      label: t("notReviewed"),
      count: notReviewed,
      icon: HelpCircle,
      color: "text-yellow-600",
      bgColor: "bg-yellow-100",
    },
  ];

  return (
    <div className="grid grid-cols-2 gap-3">
      {items.map((item) => {
        const Icon = item.icon;
        const percentage =
          total > 0 ? Math.round((item.count / total) * 100) : 0;

        return (
          <div
            key={item.key}
            className={cn(
              "flex items-center gap-3 p-3 rounded-lg",
              item.bgColor
            )}
          >
            <Icon className={cn("h-5 w-5", item.color)} />
            <div className="flex-1">
              <div className="flex items-center justify-between">
                <span className="text-sm font-medium">{item.label}</span>
                <span className={cn("font-bold", item.color)}>{item.count}</span>
              </div>
              <span className="text-xs text-muted-foreground">
                {percentage}% of total
              </span>
            </div>
          </div>
        );
      })}
    </div>
  );
}

function AuditAreaBreakdown({
  byAuditArea,
}: {
  byAuditArea: Record<string, AuditAreaScore>;
}) {
  const t = useTranslations("scoring");
  const locale = useLocale();

  const sortedAreas = useMemo(() => {
    return Object.values(byAuditArea)
      .filter((area) => area.total > 0)
      .sort((a, b) => b.eiScore - a.eiScore);
  }, [byAuditArea]);

  if (sortedAreas.length === 0) return null;

  return (
    <div className="space-y-3">
      <h4 className="text-sm font-medium flex items-center gap-2">
        {t("byAuditArea")}
        <TooltipProvider>
          <Tooltip>
            <TooltipTrigger>
              <Info className="h-4 w-4 text-muted-foreground" />
            </TooltipTrigger>
            <TooltipContent>
              <p className="max-w-xs text-xs">
                EI score calculated per USOAP audit area
              </p>
            </TooltipContent>
          </Tooltip>
        </TooltipProvider>
      </h4>

      <div className="space-y-2">
        {sortedAreas.map((area) => {
          const areaInfo = AUDIT_AREAS[area.code];
          const name = locale === "fr" ? areaInfo?.nameFr : areaInfo?.nameEn;

          return (
            <div key={area.code} className="space-y-1">
              <div className="flex items-center justify-between text-sm">
                <div className="flex items-center gap-2">
                  <Badge variant="outline" className="font-mono text-xs">
                    {area.code}
                  </Badge>
                  <span className="truncate max-w-[200px]">{name}</span>
                </div>
                <span className={cn("font-medium", getScoreColor(area.eiScore))}>
                  {area.eiScore.toFixed(1)}%
                </span>
              </div>
              <Progress value={area.eiScore} className="h-2" />
              <div className="flex items-center gap-4 text-xs text-muted-foreground">
                <span className="text-green-600">
                  {area.satisfactory} SAT
                </span>
                <span className="text-red-600">
                  {area.notSatisfactory} NSAT
                </span>
                <span className="text-gray-600">{area.notApplicable} N/A</span>
              </div>
            </div>
          );
        })}
      </div>
    </div>
  );
}

function CriticalElementBreakdown({
  byCriticalElement,
}: {
  byCriticalElement: Record<string, { code: string; eiScore: number; total: number }>;
}) {
  const t = useTranslations("scoring");
  const locale = useLocale();

  const sortedElements = useMemo(() => {
    return Object.values(byCriticalElement)
      .filter((ce) => ce.total > 0)
      .sort((a, b) => {
        const aNum = parseInt(a.code.replace("CE_", ""));
        const bNum = parseInt(b.code.replace("CE_", ""));
        return aNum - bNum;
      });
  }, [byCriticalElement]);

  if (sortedElements.length === 0) return null;

  return (
    <div className="space-y-3">
      <h4 className="text-sm font-medium flex items-center gap-2">
        {t("byCriticalElement")}
        <TooltipProvider>
          <Tooltip>
            <TooltipTrigger>
              <Info className="h-4 w-4 text-muted-foreground" />
            </TooltipTrigger>
            <TooltipContent>
              <p className="max-w-xs text-xs">
                EI score for each of the 8 ICAO Critical Elements
              </p>
            </TooltipContent>
          </Tooltip>
        </TooltipProvider>
      </h4>

      <div className="grid grid-cols-4 gap-3">
        {sortedElements.map((ce) => {
          const ceInfo = CRITICAL_ELEMENTS[ce.code as keyof typeof CRITICAL_ELEMENTS];
          const name = locale === "fr" ? ceInfo?.nameFr : ceInfo?.nameEn;
          const ceNumber = ce.code.replace("CE_", "");

          return (
            <TooltipProvider key={ce.code}>
              <Tooltip>
                <TooltipTrigger asChild>
                  <div
                    className={cn(
                      "flex flex-col items-center justify-center p-3 rounded-lg border-2 transition-colors",
                      ce.eiScore >= 90
                        ? "border-green-500 bg-green-50"
                        : ce.eiScore >= 70
                        ? "border-blue-500 bg-blue-50"
                        : ce.eiScore >= 50
                        ? "border-yellow-500 bg-yellow-50"
                        : ce.eiScore >= 30
                        ? "border-orange-500 bg-orange-50"
                        : "border-red-500 bg-red-50"
                    )}
                  >
                    <span className="text-xs text-muted-foreground">
                      CE-{ceNumber}
                    </span>
                    <span
                      className={cn(
                        "text-xl font-bold",
                        getScoreColor(ce.eiScore)
                      )}
                    >
                      {ce.eiScore.toFixed(0)}%
                    </span>
                  </div>
                </TooltipTrigger>
                <TooltipContent>
                  <p className="font-medium">{name}</p>
                  <p className="text-xs text-muted-foreground">
                    {ce.eiScore.toFixed(1)}% EI Score
                  </p>
                </TooltipContent>
              </Tooltip>
            </TooltipProvider>
          );
        })}
      </div>
    </div>
  );
}

// =============================================================================
// MAIN COMPONENT
// =============================================================================

export function EIScoreDisplay({
  score,
  showBreakdown = true,
  previousScore,
  compact = false,
}: EIScoreDisplayProps) {
  const t = useTranslations("scoring");

  if (compact) {
    return (
      <div className="flex items-center gap-4">
        <ScoreGauge score={score.overall} size="sm" />
        <div>
          <p className="text-sm text-muted-foreground">{t("eiScore")}</p>
          <p className={cn("text-2xl font-bold", getScoreColor(score.overall))}>
            {score.overall.toFixed(1)}%
          </p>
          <Badge
            variant="outline"
            className={cn(
              score.overall >= 90
                ? "border-green-500 text-green-600"
                : score.overall >= 70
                ? "border-blue-500 text-blue-600"
                : score.overall >= 50
                ? "border-yellow-500 text-yellow-600"
                : "border-red-500 text-red-600"
            )}
          >
            {getScoreLabel(score.overall)}
          </Badge>
        </div>
      </div>
    );
  }

  return (
    <Card>
      <CardHeader>
        <CardTitle className="flex items-center justify-between">
          <span>{t("eiScore")}</span>
          <Badge variant="outline">
            {score.completionPercentage}% {t("complete")}
          </Badge>
        </CardTitle>
      </CardHeader>
      <CardContent className="space-y-6">
        {/* Main score gauge */}
        <div className="flex flex-col items-center">
          <ScoreGauge
            score={score.overall}
            size="lg"
            label={t("overallEI")}
            showTrend={!!previousScore}
            previousScore={previousScore}
          />
          <Badge
            className={cn(
              "mt-4",
              score.overall >= 90
                ? "bg-green-600"
                : score.overall >= 70
                ? "bg-blue-600"
                : score.overall >= 50
                ? "bg-yellow-600"
                : score.overall >= 30
                ? "bg-orange-600"
                : "bg-red-600"
            )}
          >
            {getScoreLabel(score.overall)}
          </Badge>
        </div>

        {/* Response breakdown */}
        {showBreakdown && (
          <>
            <div className="border-t pt-6">
              <h4 className="text-sm font-medium mb-4">
                {t("responseBreakdown")}
              </h4>
              <ResponseBreakdown
                satisfactory={score.satisfactoryCount}
                notSatisfactory={score.notSatisfactoryCount}
                notApplicable={score.notApplicableCount}
                notReviewed={score.notReviewedCount}
                total={score.totalQuestions}
              />
            </div>

            {/* Critical Elements */}
            <div className="border-t pt-6">
              <CriticalElementBreakdown
                byCriticalElement={score.byCriticalElement}
              />
            </div>

            {/* Audit Areas */}
            <div className="border-t pt-6">
              <AuditAreaBreakdown byAuditArea={score.byAuditArea} />
            </div>
          </>
        )}
      </CardContent>
    </Card>
  );
}

```

# src/components/features/scoring/index.ts

```ts
/**
 * Scoring Components
 *
 * Display components for EI scores and SMS maturity levels.
 */

export { EIScoreDisplay } from "./ei-score-display";
export { SMSMaturityDisplay } from "./sms-maturity-display";
export {
  EIBarChart,
  SMSComponentChart,
  ScoreComparisonChart,
  MaturityDistributionChart,
} from "./score-breakdown-chart";

```

# src/components/features/scoring/score-breakdown-chart.tsx

```tsx
"use client";

import { useMemo } from "react";
import { useLocale, useTranslations } from "next-intl";
import { motion } from "framer-motion";
import { cn } from "@/lib/utils";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Badge } from "@/components/ui/badge";
import {
  Tooltip,
  TooltipContent,
  TooltipProvider,
  TooltipTrigger,
} from "@/components/ui/tooltip";
import type {
  AuditAreaScore,
  ComponentScore,
} from "@/server/services/scoring.service";
import {
  AUDIT_AREAS,
  CRITICAL_ELEMENTS,
  SMS_COMPONENTS,
  MATURITY_LEVEL_VALUES,
} from "@/lib/constants/scoring";
import type { MaturityLevel, USOAPAuditArea, CriticalElement } from "@prisma/client";

// =============================================================================
// PROPS
// =============================================================================

interface EIBarChartProps {
  data: Record<string, AuditAreaScore> | Record<string, { code: string; eiScore: number; total: number }>;
  type: "auditArea" | "criticalElement";
  title?: string;
  height?: number;
}

interface SMSRadarChartProps {
  data: Record<string, ComponentScore>;
  title?: string;
  size?: number;
}

interface ScoreComparisonChartProps {
  assessments: Array<{
    id: string;
    title: string;
    score: number;
    date?: Date;
  }>;
  title?: string;
}

interface MaturityDistributionProps {
  levelCounts: Record<MaturityLevel, number>;
  title?: string;
}

// =============================================================================
// HELPERS
// =============================================================================

function getBarColor(score: number): string {
  if (score >= 90) return "#22C55E";
  if (score >= 70) return "#3B82F6";
  if (score >= 50) return "#EAB308";
  if (score >= 30) return "#F97316";
  return "#DC2626";
}

// =============================================================================
// EI BAR CHART
// =============================================================================

export function EIBarChart({
  data,
  type,
  title,
  height = 300,
}: EIBarChartProps) {
  const t = useTranslations("scoring");
  const locale = useLocale();

  const chartData = useMemo(() => {
    return Object.values(data)
      .filter((item) => item.total > 0)
      .map((item) => {
        const info =
          type === "auditArea"
            ? AUDIT_AREAS[item.code as USOAPAuditArea]
            : CRITICAL_ELEMENTS[item.code as CriticalElement];

        return {
          code: item.code,
          name: locale === "fr" ? info?.nameFr : info?.nameEn,
          score: item.eiScore,
          total: item.total,
        };
      })
      .sort((a, b) => {
        if (type === "criticalElement") {
          const aNum = parseInt(a.code.replace("CE_", ""));
          const bNum = parseInt(b.code.replace("CE_", ""));
          return aNum - bNum;
        }
        return a.code.localeCompare(b.code);
      });
  }, [data, type, locale]);

  const maxScore = 100;

  return (
    <Card>
      <CardHeader className="pb-2">
        <CardTitle className="text-base">
          {title ||
            (type === "auditArea" ? t("byAuditArea") : t("byCriticalElement"))}
        </CardTitle>
      </CardHeader>
      <CardContent>
        <div className="space-y-3" style={{ minHeight: height }}>
          {chartData.map((item, index) => (
            <motion.div
              key={item.code}
              initial={{ opacity: 0, x: -20 }}
              animate={{ opacity: 1, x: 0 }}
              transition={{ delay: index * 0.05 }}
              className="space-y-1"
            >
              <div className="flex items-center justify-between text-sm">
                <div className="flex items-center gap-2">
                  <Badge variant="outline" className="font-mono text-xs min-w-[50px] justify-center">
                    {type === "criticalElement"
                      ? item.code.replace("CE_", "CE-")
                      : item.code}
                  </Badge>
                  <TooltipProvider>
                    <Tooltip>
                      <TooltipTrigger asChild>
                        <span className="truncate max-w-[180px] text-muted-foreground cursor-help">
                          {item.name}
                        </span>
                      </TooltipTrigger>
                      <TooltipContent>
                        <p className="max-w-xs">{item.name}</p>
                      </TooltipContent>
                    </Tooltip>
                  </TooltipProvider>
                </div>
                <span
                  className="font-bold"
                  style={{ color: getBarColor(item.score) }}
                >
                  {item.score.toFixed(1)}%
                </span>
              </div>
              <div className="h-4 bg-muted rounded-full overflow-hidden">
                <motion.div
                  initial={{ width: 0 }}
                  animate={{ width: `${(item.score / maxScore) * 100}%` }}
                  transition={{ duration: 0.5, delay: index * 0.05 }}
                  className="h-full rounded-full"
                  style={{ backgroundColor: getBarColor(item.score) }}
                />
              </div>
            </motion.div>
          ))}

          {chartData.length === 0 && (
            <div className="flex items-center justify-center h-full text-muted-foreground">
              {t("noData")}
            </div>
          )}
        </div>
      </CardContent>
    </Card>
  );
}

// =============================================================================
// SMS RADAR/COMPONENT CHART
// =============================================================================

export function SMSComponentChart({
  data,
  title,
  size = 300,
}: SMSRadarChartProps) {
  const t = useTranslations("scoring");
  const locale = useLocale();

  const components = useMemo(() => {
    return Object.values(data).map((comp) => {
      const info = SMS_COMPONENTS[comp.code];
      return {
        ...comp,
        name: locale === "fr" ? info?.nameFr : info?.nameEn,
        shortName: comp.code
          .replace("SAFETY_", "")
          .replace("_", " ")
          .split(" ")
          .map((w) => w.charAt(0))
          .join(""),
      };
    });
  }, [data, locale]);

  // Create a simple visual representation since we don't have a charting library
  const centerX = size / 2;
  const centerY = size / 2;
  const radius = (size - 80) / 2;

  return (
    <Card>
      <CardHeader className="pb-2">
        <CardTitle className="text-base">{title || t("byComponent")}</CardTitle>
      </CardHeader>
      <CardContent>
        <div className="flex flex-col items-center">
          {/* Simple spider/radar chart using SVG */}
          <svg width={size} height={size} className="overflow-visible">
            {/* Background circles */}
            {[20, 40, 60, 80, 100].map((level) => (
              <circle
                key={level}
                cx={centerX}
                cy={centerY}
                r={(radius * level) / 100}
                fill="none"
                stroke="currentColor"
                strokeWidth={1}
                className="text-muted/30"
              />
            ))}

            {/* Axis lines */}
            {components.map((comp, i) => {
              const angle = (i * 2 * Math.PI) / components.length - Math.PI / 2;
              const x2 = centerX + radius * Math.cos(angle);
              const y2 = centerY + radius * Math.sin(angle);
              return (
                <line
                  key={comp.code}
                  x1={centerX}
                  y1={centerY}
                  x2={x2}
                  y2={y2}
                  stroke="currentColor"
                  strokeWidth={1}
                  className="text-muted/30"
                />
              );
            })}

            {/* Data polygon */}
            <motion.polygon
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              transition={{ duration: 0.5 }}
              points={components
                .map((comp, i) => {
                  const angle =
                    (i * 2 * Math.PI) / components.length - Math.PI / 2;
                  const r = (radius * comp.score) / 100;
                  const x = centerX + r * Math.cos(angle);
                  const y = centerY + r * Math.sin(angle);
                  return `${x},${y}`;
                })
                .join(" ")}
              fill={MATURITY_LEVEL_VALUES[components[0]?.level || "LEVEL_A"].color}
              fillOpacity={0.3}
              stroke={MATURITY_LEVEL_VALUES[components[0]?.level || "LEVEL_A"].color}
              strokeWidth={2}
            />

            {/* Data points */}
            {components.map((comp, i) => {
              const angle = (i * 2 * Math.PI) / components.length - Math.PI / 2;
              const r = (radius * comp.score) / 100;
              const x = centerX + r * Math.cos(angle);
              const y = centerY + r * Math.sin(angle);
              const labelR = radius + 30;
              const labelX = centerX + labelR * Math.cos(angle);
              const labelY = centerY + labelR * Math.sin(angle);

              return (
                <g key={comp.code}>
                  <motion.circle
                    initial={{ scale: 0 }}
                    animate={{ scale: 1 }}
                    transition={{ delay: i * 0.1 }}
                    cx={x}
                    cy={y}
                    r={6}
                    fill={MATURITY_LEVEL_VALUES[comp.level].color}
                  />
                  <text
                    x={labelX}
                    y={labelY}
                    textAnchor="middle"
                    dominantBaseline="middle"
                    className="text-xs fill-muted-foreground font-medium"
                  >
                    {comp.shortName}
                  </text>
                </g>
              );
            })}
          </svg>

          {/* Legend */}
          <div className="grid grid-cols-2 gap-2 mt-4 w-full">
            {components.map((comp) => (
              <div
                key={comp.code}
                className={cn(
                  "flex items-center gap-2 p-2 rounded-lg text-sm",
                  `bg-${comp.level === "LEVEL_A" ? "red" : comp.level === "LEVEL_B" ? "orange" : comp.level === "LEVEL_C" ? "yellow" : comp.level === "LEVEL_D" ? "green" : "blue"}-50`
                )}
              >
                <div
                  className="w-3 h-3 rounded-full"
                  style={{
                    backgroundColor: MATURITY_LEVEL_VALUES[comp.level].color,
                  }}
                />
                <span className="truncate flex-1">{comp.name}</span>
                <span
                  className="font-bold"
                  style={{ color: MATURITY_LEVEL_VALUES[comp.level].color }}
                >
                  {comp.score.toFixed(0)}%
                </span>
              </div>
            ))}
          </div>
        </div>
      </CardContent>
    </Card>
  );
}

// =============================================================================
// SCORE COMPARISON CHART
// =============================================================================

export function ScoreComparisonChart({
  assessments,
  title,
}: ScoreComparisonChartProps) {
  const t = useTranslations("scoring");

  const sortedAssessments = useMemo(() => {
    return [...assessments].sort((a, b) => {
      if (a.date && b.date) {
        return a.date.getTime() - b.date.getTime();
      }
      return 0;
    });
  }, [assessments]);

  const maxScore = 100;

  if (sortedAssessments.length === 0) {
    return (
      <Card>
        <CardHeader className="pb-2">
          <CardTitle className="text-base">{title || t("scoreComparison")}</CardTitle>
        </CardHeader>
        <CardContent>
          <div className="flex items-center justify-center h-48 text-muted-foreground">
            {t("noData")}
          </div>
        </CardContent>
      </Card>
    );
  }

  return (
    <Card>
      <CardHeader className="pb-2">
        <CardTitle className="text-base">{title || t("scoreComparison")}</CardTitle>
      </CardHeader>
      <CardContent>
        <div className="flex items-end gap-4 h-48">
          {sortedAssessments.map((assessment, index) => {
            const barHeight = (assessment.score / maxScore) * 100;

            return (
              <TooltipProvider key={assessment.id}>
                <Tooltip>
                  <TooltipTrigger asChild>
                    <motion.div
                      initial={{ height: 0 }}
                      animate={{ height: `${barHeight}%` }}
                      transition={{ duration: 0.5, delay: index * 0.1 }}
                      className="flex-1 min-w-[40px] rounded-t-lg cursor-pointer"
                      style={{ backgroundColor: getBarColor(assessment.score) }}
                    />
                  </TooltipTrigger>
                  <TooltipContent>
                    <p className="font-medium">{assessment.title}</p>
                    <p className="text-sm">
                      {t("score")}: {assessment.score.toFixed(1)}%
                    </p>
                    {assessment.date && (
                      <p className="text-xs text-muted-foreground">
                        {assessment.date.toLocaleDateString()}
                      </p>
                    )}
                  </TooltipContent>
                </Tooltip>
              </TooltipProvider>
            );
          })}
        </div>

        {/* X-axis labels */}
        <div className="flex items-center gap-4 mt-2 border-t pt-2">
          {sortedAssessments.map((assessment) => (
            <div
              key={assessment.id}
              className="flex-1 min-w-[40px] text-center text-xs text-muted-foreground truncate"
            >
              {assessment.date
                ? assessment.date.toLocaleDateString(undefined, {
                    month: "short",
                    year: "2-digit",
                  })
                : assessment.title.substring(0, 10)}
            </div>
          ))}
        </div>
      </CardContent>
    </Card>
  );
}

// =============================================================================
// MATURITY DISTRIBUTION CHART
// =============================================================================

export function MaturityDistributionChart({
  levelCounts,
  title,
}: MaturityDistributionProps) {
  const t = useTranslations("scoring");

  const levels: MaturityLevel[] = [
    "LEVEL_A",
    "LEVEL_B",
    "LEVEL_C",
    "LEVEL_D",
    "LEVEL_E",
  ];
  const total = Object.values(levelCounts).reduce((a, b) => a + b, 0);

  return (
    <Card>
      <CardHeader className="pb-2">
        <CardTitle className="text-base">
          {title || t("maturityDistribution")}
        </CardTitle>
      </CardHeader>
      <CardContent>
        {/* Stacked bar */}
        <div className="h-8 flex rounded-lg overflow-hidden mb-4">
          {levels.map((level) => {
            const count = levelCounts[level] || 0;
            const percentage = total > 0 ? (count / total) * 100 : 0;

            if (percentage === 0) return null;

            return (
              <TooltipProvider key={level}>
                <Tooltip>
                  <TooltipTrigger asChild>
                    <motion.div
                      initial={{ width: 0 }}
                      animate={{ width: `${percentage}%` }}
                      transition={{ duration: 0.5 }}
                      className="h-full cursor-pointer"
                      style={{
                        backgroundColor: MATURITY_LEVEL_VALUES[level].color,
                      }}
                    />
                  </TooltipTrigger>
                  <TooltipContent>
                    <p className="font-medium">
                      {t("level")} {level.replace("LEVEL_", "")}
                    </p>
                    <p className="text-sm">
                      {count} {t("questions")} ({percentage.toFixed(1)}%)
                    </p>
                  </TooltipContent>
                </Tooltip>
              </TooltipProvider>
            );
          })}
        </div>

        {/* Legend */}
        <div className="grid grid-cols-5 gap-2">
          {levels.map((level) => {
            const info = MATURITY_LEVEL_VALUES[level];
            const count = levelCounts[level] || 0;

            return (
              <div key={level} className="text-center">
                <div
                  className="w-full h-2 rounded-full mb-1"
                  style={{ backgroundColor: info.color }}
                />
                <div className="text-xs font-medium">
                  {level.replace("LEVEL_", "")}
                </div>
                <div className="text-xs text-muted-foreground">{count}</div>
              </div>
            );
          })}
        </div>
      </CardContent>
    </Card>
  );
}

```

# src/components/features/scoring/sms-maturity-display.tsx

```tsx
"use client";

import { useMemo } from "react";
import { useLocale, useTranslations } from "next-intl";
import { motion } from "framer-motion";
import { Info, TrendingUp, TrendingDown, Minus } from "lucide-react";
import { cn } from "@/lib/utils";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Badge } from "@/components/ui/badge";
import { Progress } from "@/components/ui/progress";
import {
  Tooltip,
  TooltipContent,
  TooltipProvider,
  TooltipTrigger,
} from "@/components/ui/tooltip";
import type {
  SMSScoreResult,
  ComponentScore,
  StudyAreaScore,
} from "@/server/services/scoring.service";
import {
  MATURITY_LEVEL_VALUES,
  SMS_COMPONENTS,
  SMS_STUDY_AREAS,
} from "@/lib/constants/scoring";
import type { MaturityLevel, SMSComponent } from "@prisma/client";

// =============================================================================
// PROPS
// =============================================================================

interface SMSMaturityDisplayProps {
  score: SMSScoreResult;
  showBreakdown?: boolean;
  previousLevel?: MaturityLevel;
  compact?: boolean;
}

// =============================================================================
// HELPERS
// =============================================================================

function getMaturityBgColor(level: MaturityLevel): string {
  const colorMap: Record<MaturityLevel, string> = {
    LEVEL_A: "bg-red-50",
    LEVEL_B: "bg-orange-50",
    LEVEL_C: "bg-yellow-50",
    LEVEL_D: "bg-green-50",
    LEVEL_E: "bg-blue-50",
  };
  return colorMap[level];
}

function getMaturityBorderColor(level: MaturityLevel): string {
  const colorMap: Record<MaturityLevel, string> = {
    LEVEL_A: "border-red-500",
    LEVEL_B: "border-orange-500",
    LEVEL_C: "border-yellow-500",
    LEVEL_D: "border-green-500",
    LEVEL_E: "border-blue-500",
  };
  return colorMap[level];
}

function getMaturityTextColor(level: MaturityLevel): string {
  const colorMap: Record<MaturityLevel, string> = {
    LEVEL_A: "text-red-600",
    LEVEL_B: "text-orange-600",
    LEVEL_C: "text-yellow-600",
    LEVEL_D: "text-green-600",
    LEVEL_E: "text-blue-600",
  };
  return colorMap[level];
}

function getLevelLetter(level: MaturityLevel): string {
  return level.replace("LEVEL_", "");
}

// =============================================================================
// SUB-COMPONENTS
// =============================================================================

function MaturityLevelBadge({
  level,
  size = "md",
  showName = true,
}: {
  level: MaturityLevel;
  size?: "sm" | "md" | "lg";
  showName?: boolean;
}) {
  const levelInfo = MATURITY_LEVEL_VALUES[level];

  const sizeClasses = {
    sm: "w-8 h-8 text-sm",
    md: "w-12 h-12 text-lg",
    lg: "w-16 h-16 text-2xl",
  };

  return (
    <div className="flex items-center gap-3">
      <div
        className={cn(
          "rounded-full flex items-center justify-center font-bold text-white",
          sizeClasses[size]
        )}
        style={{ backgroundColor: levelInfo.color }}
      >
        {getLevelLetter(level)}
      </div>
      {showName && (
        <div>
          <p className="font-medium">{levelInfo.nameEn}</p>
          <p className="text-xs text-muted-foreground">
            {levelInfo.minScore}-{levelInfo.maxScore}%
          </p>
        </div>
      )}
    </div>
  );
}

function MaturityScale({
  currentLevel,
  score,
}: {
  currentLevel: MaturityLevel;
  score: number;
}) {
  const levels: MaturityLevel[] = [
    "LEVEL_A",
    "LEVEL_B",
    "LEVEL_C",
    "LEVEL_D",
    "LEVEL_E",
  ];

  return (
    <div className="space-y-2">
      <div className="flex items-center gap-1">
        {levels.map((level, index) => {
          const levelInfo = MATURITY_LEVEL_VALUES[level];
          const isActive = level === currentLevel;
          const isPassed =
            levels.indexOf(currentLevel) > index ||
            (isActive && score > levelInfo.midpoint);

          return (
            <div key={level} className="flex-1 flex items-center">
              <TooltipProvider>
                <Tooltip>
                  <TooltipTrigger asChild>
                    <div
                      className={cn(
                        "w-full h-3 rounded-sm transition-all",
                        isActive
                          ? "ring-2 ring-offset-2"
                          : isPassed
                          ? "opacity-100"
                          : "opacity-30"
                      )}
                      style={{
                        backgroundColor: levelInfo.color,
                        // @ts-expect-error CSS custom property for ring color
                        "--tw-ring-color": levelInfo.color,
                      }}
                    />
                  </TooltipTrigger>
                  <TooltipContent>
                    <p className="font-medium">Level {getLevelLetter(level)}</p>
                    <p className="text-xs">{levelInfo.nameEn}</p>
                    <p className="text-xs text-muted-foreground">
                      {levelInfo.minScore}-{levelInfo.maxScore}%
                    </p>
                  </TooltipContent>
                </Tooltip>
              </TooltipProvider>
              {index < levels.length - 1 && (
                <div className="w-1 h-3 bg-muted" />
              )}
            </div>
          );
        })}
      </div>
      <div className="flex items-center justify-between text-xs text-muted-foreground">
        <span>A - Initial</span>
        <span>E - Excellence</span>
      </div>
    </div>
  );
}

function ComponentScoreCard({
  component,
}: {
  component: ComponentScore;
}) {
  const t = useTranslations("scoring");
  const locale = useLocale();

  const componentInfo = SMS_COMPONENTS[component.code];
  const name = locale === "fr" ? componentInfo?.nameFr : componentInfo?.nameEn;

  return (
    <Card className={cn("border-2", getMaturityBorderColor(component.level))}>
      <CardContent className="p-4 space-y-3">
        <div className="flex items-start justify-between">
          <div>
            <p className="text-sm font-medium">{name}</p>
            <p className="text-xs text-muted-foreground">
              {t("weight")}: {(component.weight * 100).toFixed(0)}%
            </p>
          </div>
          <MaturityLevelBadge level={component.level} size="sm" showName={false} />
        </div>

        <div className="space-y-1">
          <div className="flex items-center justify-between text-sm">
            <span className="text-muted-foreground">{t("score")}</span>
            <span className={cn("font-bold", getMaturityTextColor(component.level))}>
              {component.score.toFixed(1)}%
            </span>
          </div>
          <Progress
            value={component.score}
            className="h-2"
            style={
              {
                "--progress-background": MATURITY_LEVEL_VALUES[component.level].color,
              } as React.CSSProperties
            }
          />
        </div>

        <div className="text-xs text-muted-foreground">
          {component.answeredCount}/{component.questionCount} {t("questionsAnswered")}
        </div>
      </CardContent>
    </Card>
  );
}

function StudyAreasList({
  byStudyArea,
  componentCode,
}: {
  byStudyArea: Record<string, StudyAreaScore>;
  componentCode: SMSComponent;
}) {
  const locale = useLocale();

  const studyAreas = useMemo(() => {
    return Object.values(byStudyArea)
      .filter((sa) => sa.componentCode === componentCode && sa.questionCount > 0)
      .sort((a, b) => a.code.localeCompare(b.code));
  }, [byStudyArea, componentCode]);

  if (studyAreas.length === 0) return null;

  return (
    <div className="space-y-2">
      {studyAreas.map((sa) => {
        const saInfo = SMS_STUDY_AREAS[sa.code];
        const name = locale === "fr" ? saInfo?.nameFr : saInfo?.nameEn;
        const saCode = sa.code.replace("SA_", "").replace("_", ".");

        return (
          <div
            key={sa.code}
            className={cn(
              "flex items-center justify-between p-2 rounded-lg",
              getMaturityBgColor(sa.level)
            )}
          >
            <div className="flex items-center gap-2">
              <Badge variant="outline" className="font-mono text-xs">
                {saCode}
              </Badge>
              <span className="text-sm truncate max-w-[200px]">{name}</span>
            </div>
            <div className="flex items-center gap-2">
              <span className={cn("text-sm font-medium", getMaturityTextColor(sa.level))}>
                {sa.score.toFixed(0)}%
              </span>
              <div
                className="w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold text-white"
                style={{ backgroundColor: MATURITY_LEVEL_VALUES[sa.level].color }}
              >
                {getLevelLetter(sa.level)}
              </div>
            </div>
          </div>
        );
      })}
    </div>
  );
}

function RadarChartPlaceholder({
  byComponent,
}: {
  byComponent: Record<string, ComponentScore>;
}) {
  const t = useTranslations("scoring");

  // Simple visual representation of component scores
  const components = Object.values(byComponent);

  return (
    <div className="space-y-3">
      <h4 className="text-sm font-medium">{t("componentOverview")}</h4>
      <div className="grid grid-cols-2 gap-3">
        {components.map((comp) => (
          <ComponentScoreCard key={comp.code} component={comp} />
        ))}
      </div>
    </div>
  );
}

// =============================================================================
// MAIN COMPONENT
// =============================================================================

export function SMSMaturityDisplay({
  score,
  showBreakdown = true,
  previousLevel,
  compact = false,
}: SMSMaturityDisplayProps) {
  const t = useTranslations("scoring");
  const levelInfo = MATURITY_LEVEL_VALUES[score.overallLevel];

  // Calculate trend
  const previousLevelNumeric = previousLevel
    ? MATURITY_LEVEL_VALUES[previousLevel].numeric
    : null;
  const currentLevelNumeric = MATURITY_LEVEL_VALUES[score.overallLevel].numeric;
  const trend =
    previousLevelNumeric !== null
      ? currentLevelNumeric - previousLevelNumeric
      : 0;

  if (compact) {
    return (
      <div className="flex items-center gap-4">
        <MaturityLevelBadge level={score.overallLevel} size="md" showName={false} />
        <div>
          <p className="text-sm text-muted-foreground">{t("smsMaturity")}</p>
          <p
            className="text-2xl font-bold"
            style={{ color: levelInfo.color }}
          >
            {t("level")} {getLevelLetter(score.overallLevel)}
          </p>
          <p className="text-sm text-muted-foreground">{levelInfo.nameEn}</p>
        </div>
      </div>
    );
  }

  return (
    <Card>
      <CardHeader>
        <CardTitle className="flex items-center justify-between">
          <span>{t("smsMaturity")}</span>
          <Badge variant="outline">
            {score.completionPercentage}% {t("complete")}
          </Badge>
        </CardTitle>
      </CardHeader>
      <CardContent className="space-y-6">
        {/* Overall maturity level */}
        <div className="flex flex-col items-center text-center">
          <motion.div
            initial={{ scale: 0 }}
            animate={{ scale: 1 }}
            transition={{ type: "spring", duration: 0.5 }}
            className="w-24 h-24 rounded-full flex items-center justify-center text-white text-4xl font-bold mb-4"
            style={{ backgroundColor: levelInfo.color }}
          >
            {getLevelLetter(score.overallLevel)}
          </motion.div>

          <h3 className="text-2xl font-bold" style={{ color: levelInfo.color }}>
            {t("level")} {getLevelLetter(score.overallLevel)} - {levelInfo.nameEn}
          </h3>

          <p className="text-sm text-muted-foreground mt-1">
            {t("overallScore")}: {score.overallScore.toFixed(1)}%
          </p>

          {/* Trend indicator */}
          {previousLevel && (
            <div
              className={cn(
                "flex items-center gap-1 mt-2 text-sm",
                trend > 0
                  ? "text-green-600"
                  : trend < 0
                  ? "text-red-600"
                  : "text-muted-foreground"
              )}
            >
              {trend > 0 ? (
                <TrendingUp className="h-4 w-4" />
              ) : trend < 0 ? (
                <TrendingDown className="h-4 w-4" />
              ) : (
                <Minus className="h-4 w-4" />
              )}
              <span>
                {trend > 0 ? "+" : ""}
                {trend} {t("levels")}
              </span>
            </div>
          )}
        </div>

        {/* Maturity scale */}
        <MaturityScale currentLevel={score.overallLevel} score={score.overallScore} />

        {showBreakdown && (
          <>
            {/* Component scores */}
            <div className="border-t pt-6">
              <RadarChartPlaceholder byComponent={score.byComponent} />
            </div>

            {/* Study areas by component */}
            <div className="border-t pt-6 space-y-6">
              <h4 className="text-sm font-medium flex items-center gap-2">
                {t("byStudyArea")}
                <TooltipProvider>
                  <Tooltip>
                    <TooltipTrigger>
                      <Info className="h-4 w-4 text-muted-foreground" />
                    </TooltipTrigger>
                    <TooltipContent>
                      <p className="max-w-xs text-xs">
                        Maturity levels per CANSO SoE study area
                      </p>
                    </TooltipContent>
                  </Tooltip>
                </TooltipProvider>
              </h4>

              {Object.values(SMS_COMPONENTS).map((comp) => (
                <div key={comp.code} className="space-y-2">
                  <p className="text-sm font-medium text-muted-foreground">
                    {comp.nameEn}
                  </p>
                  <StudyAreasList
                    byStudyArea={score.byStudyArea}
                    componentCode={comp.code}
                  />
                </div>
              ))}
            </div>
          </>
        )}

        {/* Completion info */}
        <div className="border-t pt-4 text-center text-sm text-muted-foreground">
          {score.answeredCount}/{score.questionCount} {t("questionsAnswered")}
        </div>
      </CardContent>
    </Card>
  );
}

```

# src/components/layout/app-shell.tsx

```tsx
import { Sidebar } from "./sidebar";
import { Header } from "./header";

interface AppShellProps {
  children: React.ReactNode;
  locale: string;
  user: {
    firstName: string;
    lastName: string;
    email: string;
    role: string;
  };
}

export function AppShell({ children, locale, user }: AppShellProps) {
  return (
    <div className="flex h-screen overflow-hidden">
      <Sidebar locale={locale} />
      <div className="flex flex-1 flex-col overflow-hidden">
        <Header locale={locale} user={user} />
        <main className="flex-1 overflow-auto bg-muted/30 p-6">
          {children}
        </main>
      </div>
    </div>
  );
}

```

# src/components/layout/header.tsx

```tsx
"use client";

import { useTranslations } from "next-intl";
import { signOut } from "next-auth/react";
import { useRouter } from "next/navigation";
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuLabel,
  DropdownMenuSeparator,
  DropdownMenuTrigger,
} from "@/components/ui/dropdown-menu";
import { Button } from "@/components/ui/button";
import { Avatar, AvatarFallback } from "@/components/ui/avatar";
import { Badge } from "@/components/ui/badge";
import { Bell, Globe, LogOut, User, Settings } from "lucide-react";
import Link from "next/link";

interface HeaderProps {
  locale: string;
  user: {
    firstName: string;
    lastName: string;
    email: string;
    role: string;
  };
}

export function Header({ locale, user }: HeaderProps) {
  const t = useTranslations("common");
  const router = useRouter();
  const otherLocale = locale === "en" ? "fr" : "en";
  const initials = `${user.firstName[0]}${user.lastName[0]}`.toUpperCase();

  const handleSignOut = async () => {
    await signOut({ redirect: false });
    router.push(`/${locale}/login`);
  };

  const switchLocale = () => {
    const currentPath = window.location.pathname;
    const newPath = currentPath.replace(`/${locale}`, `/${otherLocale}`);
    router.push(newPath);
  };

  return (
    <header className="flex h-16 items-center justify-between border-b bg-background px-6">
      <div className="flex items-center gap-4">
        <h1 className="text-lg font-semibold">{t("appName")}</h1>
      </div>

      <div className="flex items-center gap-2">
        <Button variant="ghost" size="icon" onClick={switchLocale}>
          <Globe className="h-4 w-4" />
        </Button>

        <Button variant="ghost" size="icon" className="relative">
          <Bell className="h-4 w-4" />
          <span className="absolute -right-1 -top-1 flex h-4 w-4 items-center justify-center rounded-full bg-destructive text-[10px] text-destructive-foreground">
            3
          </span>
        </Button>

        <DropdownMenu>
          <DropdownMenuTrigger asChild>
            <Button variant="ghost" className="flex items-center gap-2 px-2">
              <Avatar className="h-8 w-8">
                <AvatarFallback className="bg-primary text-primary-foreground text-xs">
                  {initials}
                </AvatarFallback>
              </Avatar>
              <div className="hidden flex-col items-start text-sm md:flex">
                <span className="font-medium">{user.firstName} {user.lastName}</span>
                <Badge variant="secondary" className="text-[10px] px-1 py-0">
                  {user.role.replace("_", " ")}
                </Badge>
              </div>
            </Button>
          </DropdownMenuTrigger>
          <DropdownMenuContent align="end" className="w-56">
            <DropdownMenuLabel>
              <div className="flex flex-col">
                <span>{user.firstName} {user.lastName}</span>
                <span className="text-xs font-normal text-muted-foreground">{user.email}</span>
              </div>
            </DropdownMenuLabel>
            <DropdownMenuSeparator />
            <DropdownMenuItem asChild>
              <Link href={`/${locale}/profile`}>
                <User className="mr-2 h-4 w-4" />
                {t("actions.profile")}
              </Link>
            </DropdownMenuItem>
            <DropdownMenuItem asChild>
              <Link href={`/${locale}/settings`}>
                <Settings className="mr-2 h-4 w-4" />
                {t("actions.settings")}
              </Link>
            </DropdownMenuItem>
            <DropdownMenuSeparator />
            <DropdownMenuItem onClick={handleSignOut} className="text-destructive">
              <LogOut className="mr-2 h-4 w-4" />
              {t("actions.logout")}
            </DropdownMenuItem>
          </DropdownMenuContent>
        </DropdownMenu>
      </div>
    </header>
  );
}

```

# src/components/layout/sidebar.tsx

```tsx
"use client";

import Link from "next/link";
import { usePathname } from "next/navigation";
import { useTranslations } from "next-intl";
import { cn } from "@/lib/utils";
import {
  LayoutDashboard,
  ClipboardList,
  FileCheck,
  Users,
  Building2,
  BookOpen,
  Settings,
  ChevronLeft,
  ChevronRight,
} from "lucide-react";
import { Button } from "@/components/ui/button";
import { ScrollArea } from "@/components/ui/scroll-area";
import {
  Tooltip,
  TooltipContent,
  TooltipProvider,
  TooltipTrigger,
} from "@/components/ui/tooltip";
import { useState } from "react";

interface NavItem {
  titleKey: string;
  href: string;
  icon: React.ElementType;
}

const navItems: NavItem[] = [
  { titleKey: "dashboard", href: "/dashboard", icon: LayoutDashboard },
  { titleKey: "questionnaires", href: "/questionnaires", icon: ClipboardList },
  { titleKey: "assessments", href: "/assessments", icon: FileCheck },
  { titleKey: "reviews", href: "/reviews", icon: Users },
  { titleKey: "organizations", href: "/organizations", icon: Building2 },
  { titleKey: "training", href: "/training", icon: BookOpen },
  { titleKey: "settings", href: "/settings", icon: Settings },
];

interface SidebarProps {
  locale: string;
}

export function Sidebar({ locale }: SidebarProps) {
  const pathname = usePathname();
  const t = useTranslations("navigation");
  const [collapsed, setCollapsed] = useState(false);

  return (
    <div
      className={cn(
        "relative flex flex-col border-r bg-background transition-all duration-300",
        collapsed ? "w-16" : "w-64"
      )}
    >
      <div className="flex h-16 items-center justify-center border-b px-4">
        {!collapsed && (
          <Link href={`/${locale}`} className="flex items-center gap-2">
            <div className="flex h-8 w-8 items-center justify-center rounded-lg bg-primary text-primary-foreground font-bold">
              A
            </div>
            <span className="font-semibold text-sm">ANSP Peer Review</span>
          </Link>
        )}
        {collapsed && (
          <div className="flex h-8 w-8 items-center justify-center rounded-lg bg-primary text-primary-foreground font-bold">
            A
          </div>
        )}
      </div>

      <ScrollArea className="flex-1 px-3 py-4">
        <TooltipProvider delayDuration={0}>
          <nav className="flex flex-col gap-1">
            {navItems.map((item) => {
              const fullHref = item.href === "/" ? `/${locale}` : `/${locale}${item.href}`;
              const isActive = item.href === "/"
                ? pathname === `/${locale}` || pathname === `/${locale}/`
                : pathname.startsWith(fullHref);

              const navLink = (
                <Link
                  href={fullHref}
                  className={cn(
                    "flex items-center gap-3 rounded-lg px-3 py-2 text-sm transition-all",
                    isActive
                      ? "bg-primary/10 text-primary font-medium border-l-2 border-primary ml-[-2px]"
                      : "text-muted-foreground hover:bg-muted hover:text-foreground",
                    collapsed && "justify-center px-2"
                  )}
                >
                  <item.icon className={cn("h-4 w-4 shrink-0", isActive && "text-primary")} />
                  {!collapsed && <span>{t(item.titleKey)}</span>}
                </Link>
              );

              // Show tooltip only when collapsed
              if (collapsed) {
                return (
                  <Tooltip key={item.titleKey}>
                    <TooltipTrigger asChild>
                      {navLink}
                    </TooltipTrigger>
                    <TooltipContent side="right" className="flex items-center gap-2">
                      <span>{t(item.titleKey)}</span>
                      {isActive && (
                        <span className="text-xs text-muted-foreground">(current)</span>
                      )}
                    </TooltipContent>
                  </Tooltip>
                );
              }

              return (
                <div key={item.titleKey}>
                  {navLink}
                </div>
              );
            })}
          </nav>
        </TooltipProvider>
      </ScrollArea>

      <Button
        variant="ghost"
        size="icon"
        className="absolute -right-3 top-20 h-6 w-6 rounded-full border bg-background"
        onClick={() => setCollapsed(!collapsed)}
      >
        {collapsed ? <ChevronRight className="h-3 w-3" /> : <ChevronLeft className="h-3 w-3" />}
      </Button>
    </div>
  );
}

```

# src/components/providers/dashboard-providers.tsx

```tsx
"use client";

import { TRPCProvider } from "@/lib/trpc/provider";

interface DashboardProvidersProps {
  children: React.ReactNode;
}

export function DashboardProviders({ children }: DashboardProvidersProps) {
  return <TRPCProvider>{children}</TRPCProvider>;
}

```

# src/components/ui/accordion.tsx

```tsx
"use client"

import * as React from "react"
import * as AccordionPrimitive from "@radix-ui/react-accordion"
import { ChevronDownIcon } from "lucide-react"

import { cn } from "@/lib/utils"

function Accordion({
  ...props
}: React.ComponentProps<typeof AccordionPrimitive.Root>) {
  return <AccordionPrimitive.Root data-slot="accordion" {...props} />
}

function AccordionItem({
  className,
  ...props
}: React.ComponentProps<typeof AccordionPrimitive.Item>) {
  return (
    <AccordionPrimitive.Item
      data-slot="accordion-item"
      className={cn("border-b last:border-b-0", className)}
      {...props}
    />
  )
}

function AccordionTrigger({
  className,
  children,
  ...props
}: React.ComponentProps<typeof AccordionPrimitive.Trigger>) {
  return (
    <AccordionPrimitive.Header className="flex">
      <AccordionPrimitive.Trigger
        data-slot="accordion-trigger"
        className={cn(
          "focus-visible:border-ring focus-visible:ring-ring/50 flex flex-1 items-start justify-between gap-4 rounded-md py-4 text-left text-sm font-medium transition-all outline-none hover:underline focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 [&[data-state=open]>svg]:rotate-180",
          className
        )}
        {...props}
      >
        {children}
        <ChevronDownIcon className="text-muted-foreground pointer-events-none size-4 shrink-0 translate-y-0.5 transition-transform duration-200" />
      </AccordionPrimitive.Trigger>
    </AccordionPrimitive.Header>
  )
}

function AccordionContent({
  className,
  children,
  ...props
}: React.ComponentProps<typeof AccordionPrimitive.Content>) {
  return (
    <AccordionPrimitive.Content
      data-slot="accordion-content"
      className="data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down overflow-hidden text-sm"
      {...props}
    >
      <div className={cn("pt-0 pb-4", className)}>{children}</div>
    </AccordionPrimitive.Content>
  )
}

export { Accordion, AccordionItem, AccordionTrigger, AccordionContent }

```

# src/components/ui/alert-dialog.tsx

```tsx
"use client"

import * as React from "react"
import * as AlertDialogPrimitive from "@radix-ui/react-alert-dialog"

import { cn } from "@/lib/utils"
import { buttonVariants } from "@/components/ui/button"

function AlertDialog({
  ...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Root>) {
  return <AlertDialogPrimitive.Root data-slot="alert-dialog" {...props} />
}

function AlertDialogTrigger({
  ...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Trigger>) {
  return (
    <AlertDialogPrimitive.Trigger data-slot="alert-dialog-trigger" {...props} />
  )
}

function AlertDialogPortal({
  ...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Portal>) {
  return (
    <AlertDialogPrimitive.Portal data-slot="alert-dialog-portal" {...props} />
  )
}

function AlertDialogOverlay({
  className,
  ...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Overlay>) {
  return (
    <AlertDialogPrimitive.Overlay
      data-slot="alert-dialog-overlay"
      className={cn(
        "data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",
        className
      )}
      {...props}
    />
  )
}

function AlertDialogContent({
  className,
  ...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Content>) {
  return (
    <AlertDialogPortal>
      <AlertDialogOverlay />
      <AlertDialogPrimitive.Content
        data-slot="alert-dialog-content"
        className={cn(
          "bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",
          className
        )}
        {...props}
      />
    </AlertDialogPortal>
  )
}

function AlertDialogHeader({
  className,
  ...props
}: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="alert-dialog-header"
      className={cn("flex flex-col gap-2 text-center sm:text-left", className)}
      {...props}
    />
  )
}

function AlertDialogFooter({
  className,
  ...props
}: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="alert-dialog-footer"
      className={cn(
        "flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",
        className
      )}
      {...props}
    />
  )
}

function AlertDialogTitle({
  className,
  ...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Title>) {
  return (
    <AlertDialogPrimitive.Title
      data-slot="alert-dialog-title"
      className={cn("text-lg font-semibold", className)}
      {...props}
    />
  )
}

function AlertDialogDescription({
  className,
  ...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Description>) {
  return (
    <AlertDialogPrimitive.Description
      data-slot="alert-dialog-description"
      className={cn("text-muted-foreground text-sm", className)}
      {...props}
    />
  )
}

function AlertDialogAction({
  className,
  ...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Action>) {
  return (
    <AlertDialogPrimitive.Action
      className={cn(buttonVariants(), className)}
      {...props}
    />
  )
}

function AlertDialogCancel({
  className,
  ...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Cancel>) {
  return (
    <AlertDialogPrimitive.Cancel
      className={cn(buttonVariants({ variant: "outline" }), className)}
      {...props}
    />
  )
}

export {
  AlertDialog,
  AlertDialogPortal,
  AlertDialogOverlay,
  AlertDialogTrigger,
  AlertDialogContent,
  AlertDialogHeader,
  AlertDialogFooter,
  AlertDialogTitle,
  AlertDialogDescription,
  AlertDialogAction,
  AlertDialogCancel,
}

```

# src/components/ui/alert.tsx

```tsx
import * as React from "react"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const alertVariants = cva(
  "relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",
  {
    variants: {
      variant: {
        default: "bg-card text-card-foreground",
        destructive:
          "text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  }
)

function Alert({
  className,
  variant,
  ...props
}: React.ComponentProps<"div"> & VariantProps<typeof alertVariants>) {
  return (
    <div
      data-slot="alert"
      role="alert"
      className={cn(alertVariants({ variant }), className)}
      {...props}
    />
  )
}

function AlertTitle({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="alert-title"
      className={cn(
        "col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",
        className
      )}
      {...props}
    />
  )
}

function AlertDescription({
  className,
  ...props
}: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="alert-description"
      className={cn(
        "text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",
        className
      )}
      {...props}
    />
  )
}

export { Alert, AlertTitle, AlertDescription }

```

# src/components/ui/avatar.tsx

```tsx
"use client"

import * as React from "react"
import * as AvatarPrimitive from "@radix-ui/react-avatar"

import { cn } from "@/lib/utils"

function Avatar({
  className,
  ...props
}: React.ComponentProps<typeof AvatarPrimitive.Root>) {
  return (
    <AvatarPrimitive.Root
      data-slot="avatar"
      className={cn(
        "relative flex size-8 shrink-0 overflow-hidden rounded-full",
        className
      )}
      {...props}
    />
  )
}

function AvatarImage({
  className,
  ...props
}: React.ComponentProps<typeof AvatarPrimitive.Image>) {
  return (
    <AvatarPrimitive.Image
      data-slot="avatar-image"
      className={cn("aspect-square size-full", className)}
      {...props}
    />
  )
}

function AvatarFallback({
  className,
  ...props
}: React.ComponentProps<typeof AvatarPrimitive.Fallback>) {
  return (
    <AvatarPrimitive.Fallback
      data-slot="avatar-fallback"
      className={cn(
        "bg-muted flex size-full items-center justify-center rounded-full",
        className
      )}
      {...props}
    />
  )
}

export { Avatar, AvatarImage, AvatarFallback }

```

# src/components/ui/badge.tsx

```tsx
import * as React from "react"
import { Slot } from "@radix-ui/react-slot"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const badgeVariants = cva(
  "inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",
  {
    variants: {
      variant: {
        default:
          "border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",
        secondary:
          "border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",
        destructive:
          "border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",
        outline:
          "text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  }
)

function Badge({
  className,
  variant,
  asChild = false,
  ...props
}: React.ComponentProps<"span"> &
  VariantProps<typeof badgeVariants> & { asChild?: boolean }) {
  const Comp = asChild ? Slot : "span"

  return (
    <Comp
      data-slot="badge"
      className={cn(badgeVariants({ variant }), className)}
      {...props}
    />
  )
}

export { Badge, badgeVariants }

```

# src/components/ui/button.tsx

```tsx
import * as React from "react"
import { Slot } from "@radix-ui/react-slot"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const buttonVariants = cva(
  "inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",
  {
    variants: {
      variant: {
        default: "bg-primary text-primary-foreground hover:bg-primary/90",
        destructive:
          "bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",
        outline:
          "border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",
        secondary:
          "bg-secondary text-secondary-foreground hover:bg-secondary/80",
        ghost:
          "hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",
        link: "text-primary underline-offset-4 hover:underline",
      },
      size: {
        default: "h-9 px-4 py-2 has-[>svg]:px-3",
        sm: "h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",
        lg: "h-10 rounded-md px-6 has-[>svg]:px-4",
        icon: "size-9",
        "icon-sm": "size-8",
        "icon-lg": "size-10",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  }
)

function Button({
  className,
  variant = "default",
  size = "default",
  asChild = false,
  ...props
}: React.ComponentProps<"button"> &
  VariantProps<typeof buttonVariants> & {
    asChild?: boolean
  }) {
  const Comp = asChild ? Slot : "button"

  return (
    <Comp
      data-slot="button"
      data-variant={variant}
      data-size={size}
      className={cn(buttonVariants({ variant, size, className }))}
      {...props}
    />
  )
}

export { Button, buttonVariants }

```

# src/components/ui/card.tsx

```tsx
import * as React from "react"

import { cn } from "@/lib/utils"

function Card({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card"
      className={cn(
        "bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",
        className
      )}
      {...props}
    />
  )
}

function CardHeader({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-header"
      className={cn(
        "@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",
        className
      )}
      {...props}
    />
  )
}

function CardTitle({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-title"
      className={cn("leading-none font-semibold", className)}
      {...props}
    />
  )
}

function CardDescription({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-description"
      className={cn("text-muted-foreground text-sm", className)}
      {...props}
    />
  )
}

function CardAction({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-action"
      className={cn(
        "col-start-2 row-span-2 row-start-1 self-start justify-self-end",
        className
      )}
      {...props}
    />
  )
}

function CardContent({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-content"
      className={cn("px-6", className)}
      {...props}
    />
  )
}

function CardFooter({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-footer"
      className={cn("flex items-center px-6 [.border-t]:pt-6", className)}
      {...props}
    />
  )
}

export {
  Card,
  CardHeader,
  CardFooter,
  CardTitle,
  CardAction,
  CardDescription,
  CardContent,
}

```

# src/components/ui/checkbox.tsx

```tsx
"use client"

import * as React from "react"
import * as CheckboxPrimitive from "@radix-ui/react-checkbox"
import { CheckIcon } from "lucide-react"

import { cn } from "@/lib/utils"

function Checkbox({
  className,
  ...props
}: React.ComponentProps<typeof CheckboxPrimitive.Root>) {
  return (
    <CheckboxPrimitive.Root
      data-slot="checkbox"
      className={cn(
        "peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",
        className
      )}
      {...props}
    >
      <CheckboxPrimitive.Indicator
        data-slot="checkbox-indicator"
        className="grid place-content-center text-current transition-none"
      >
        <CheckIcon className="size-3.5" />
      </CheckboxPrimitive.Indicator>
    </CheckboxPrimitive.Root>
  )
}

export { Checkbox }

```

# src/components/ui/collapsible.tsx

```tsx
"use client"

import * as CollapsiblePrimitive from "@radix-ui/react-collapsible"

function Collapsible({
  ...props
}: React.ComponentProps<typeof CollapsiblePrimitive.Root>) {
  return <CollapsiblePrimitive.Root data-slot="collapsible" {...props} />
}

function CollapsibleTrigger({
  ...props
}: React.ComponentProps<typeof CollapsiblePrimitive.CollapsibleTrigger>) {
  return (
    <CollapsiblePrimitive.CollapsibleTrigger
      data-slot="collapsible-trigger"
      {...props}
    />
  )
}

function CollapsibleContent({
  ...props
}: React.ComponentProps<typeof CollapsiblePrimitive.CollapsibleContent>) {
  return (
    <CollapsiblePrimitive.CollapsibleContent
      data-slot="collapsible-content"
      {...props}
    />
  )
}

export { Collapsible, CollapsibleTrigger, CollapsibleContent }

```

# src/components/ui/dialog.tsx

```tsx
"use client"

import * as React from "react"
import * as DialogPrimitive from "@radix-ui/react-dialog"
import { XIcon } from "lucide-react"

import { cn } from "@/lib/utils"

function Dialog({
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Root>) {
  return <DialogPrimitive.Root data-slot="dialog" {...props} />
}

function DialogTrigger({
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Trigger>) {
  return <DialogPrimitive.Trigger data-slot="dialog-trigger" {...props} />
}

function DialogPortal({
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Portal>) {
  return <DialogPrimitive.Portal data-slot="dialog-portal" {...props} />
}

function DialogClose({
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Close>) {
  return <DialogPrimitive.Close data-slot="dialog-close" {...props} />
}

function DialogOverlay({
  className,
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Overlay>) {
  return (
    <DialogPrimitive.Overlay
      data-slot="dialog-overlay"
      className={cn(
        "data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",
        className
      )}
      {...props}
    />
  )
}

function DialogContent({
  className,
  children,
  showCloseButton = true,
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Content> & {
  showCloseButton?: boolean
}) {
  return (
    <DialogPortal data-slot="dialog-portal">
      <DialogOverlay />
      <DialogPrimitive.Content
        data-slot="dialog-content"
        className={cn(
          "bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 outline-none sm:max-w-lg",
          className
        )}
        {...props}
      >
        {children}
        {showCloseButton && (
          <DialogPrimitive.Close
            data-slot="dialog-close"
            className="ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4"
          >
            <XIcon />
            <span className="sr-only">Close</span>
          </DialogPrimitive.Close>
        )}
      </DialogPrimitive.Content>
    </DialogPortal>
  )
}

function DialogHeader({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="dialog-header"
      className={cn("flex flex-col gap-2 text-center sm:text-left", className)}
      {...props}
    />
  )
}

function DialogFooter({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="dialog-footer"
      className={cn(
        "flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",
        className
      )}
      {...props}
    />
  )
}

function DialogTitle({
  className,
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Title>) {
  return (
    <DialogPrimitive.Title
      data-slot="dialog-title"
      className={cn("text-lg leading-none font-semibold", className)}
      {...props}
    />
  )
}

function DialogDescription({
  className,
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Description>) {
  return (
    <DialogPrimitive.Description
      data-slot="dialog-description"
      className={cn("text-muted-foreground text-sm", className)}
      {...props}
    />
  )
}

export {
  Dialog,
  DialogClose,
  DialogContent,
  DialogDescription,
  DialogFooter,
  DialogHeader,
  DialogOverlay,
  DialogPortal,
  DialogTitle,
  DialogTrigger,
}

```

# src/components/ui/dropdown-menu.tsx

```tsx
"use client"

import * as React from "react"
import * as DropdownMenuPrimitive from "@radix-ui/react-dropdown-menu"
import { CheckIcon, ChevronRightIcon, CircleIcon } from "lucide-react"

import { cn } from "@/lib/utils"

function DropdownMenu({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Root>) {
  return <DropdownMenuPrimitive.Root data-slot="dropdown-menu" {...props} />
}

function DropdownMenuPortal({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Portal>) {
  return (
    <DropdownMenuPrimitive.Portal data-slot="dropdown-menu-portal" {...props} />
  )
}

function DropdownMenuTrigger({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Trigger>) {
  return (
    <DropdownMenuPrimitive.Trigger
      data-slot="dropdown-menu-trigger"
      {...props}
    />
  )
}

function DropdownMenuContent({
  className,
  sideOffset = 4,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Content>) {
  return (
    <DropdownMenuPrimitive.Portal>
      <DropdownMenuPrimitive.Content
        data-slot="dropdown-menu-content"
        sideOffset={sideOffset}
        className={cn(
          "bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",
          className
        )}
        {...props}
      />
    </DropdownMenuPrimitive.Portal>
  )
}

function DropdownMenuGroup({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Group>) {
  return (
    <DropdownMenuPrimitive.Group data-slot="dropdown-menu-group" {...props} />
  )
}

function DropdownMenuItem({
  className,
  inset,
  variant = "default",
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Item> & {
  inset?: boolean
  variant?: "default" | "destructive"
}) {
  return (
    <DropdownMenuPrimitive.Item
      data-slot="dropdown-menu-item"
      data-inset={inset}
      data-variant={variant}
      className={cn(
        "focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className
      )}
      {...props}
    />
  )
}

function DropdownMenuCheckboxItem({
  className,
  children,
  checked,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.CheckboxItem>) {
  return (
    <DropdownMenuPrimitive.CheckboxItem
      data-slot="dropdown-menu-checkbox-item"
      className={cn(
        "focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-sm py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className
      )}
      checked={checked}
      {...props}
    >
      <span className="pointer-events-none absolute left-2 flex size-3.5 items-center justify-center">
        <DropdownMenuPrimitive.ItemIndicator>
          <CheckIcon className="size-4" />
        </DropdownMenuPrimitive.ItemIndicator>
      </span>
      {children}
    </DropdownMenuPrimitive.CheckboxItem>
  )
}

function DropdownMenuRadioGroup({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.RadioGroup>) {
  return (
    <DropdownMenuPrimitive.RadioGroup
      data-slot="dropdown-menu-radio-group"
      {...props}
    />
  )
}

function DropdownMenuRadioItem({
  className,
  children,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.RadioItem>) {
  return (
    <DropdownMenuPrimitive.RadioItem
      data-slot="dropdown-menu-radio-item"
      className={cn(
        "focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-sm py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className
      )}
      {...props}
    >
      <span className="pointer-events-none absolute left-2 flex size-3.5 items-center justify-center">
        <DropdownMenuPrimitive.ItemIndicator>
          <CircleIcon className="size-2 fill-current" />
        </DropdownMenuPrimitive.ItemIndicator>
      </span>
      {children}
    </DropdownMenuPrimitive.RadioItem>
  )
}

function DropdownMenuLabel({
  className,
  inset,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Label> & {
  inset?: boolean
}) {
  return (
    <DropdownMenuPrimitive.Label
      data-slot="dropdown-menu-label"
      data-inset={inset}
      className={cn(
        "px-2 py-1.5 text-sm font-medium data-[inset]:pl-8",
        className
      )}
      {...props}
    />
  )
}

function DropdownMenuSeparator({
  className,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Separator>) {
  return (
    <DropdownMenuPrimitive.Separator
      data-slot="dropdown-menu-separator"
      className={cn("bg-border -mx-1 my-1 h-px", className)}
      {...props}
    />
  )
}

function DropdownMenuShortcut({
  className,
  ...props
}: React.ComponentProps<"span">) {
  return (
    <span
      data-slot="dropdown-menu-shortcut"
      className={cn(
        "text-muted-foreground ml-auto text-xs tracking-widest",
        className
      )}
      {...props}
    />
  )
}

function DropdownMenuSub({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Sub>) {
  return <DropdownMenuPrimitive.Sub data-slot="dropdown-menu-sub" {...props} />
}

function DropdownMenuSubTrigger({
  className,
  inset,
  children,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.SubTrigger> & {
  inset?: boolean
}) {
  return (
    <DropdownMenuPrimitive.SubTrigger
      data-slot="dropdown-menu-sub-trigger"
      data-inset={inset}
      className={cn(
        "focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className
      )}
      {...props}
    >
      {children}
      <ChevronRightIcon className="ml-auto size-4" />
    </DropdownMenuPrimitive.SubTrigger>
  )
}

function DropdownMenuSubContent({
  className,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.SubContent>) {
  return (
    <DropdownMenuPrimitive.SubContent
      data-slot="dropdown-menu-sub-content"
      className={cn(
        "bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-hidden rounded-md border p-1 shadow-lg",
        className
      )}
      {...props}
    />
  )
}

export {
  DropdownMenu,
  DropdownMenuPortal,
  DropdownMenuTrigger,
  DropdownMenuContent,
  DropdownMenuGroup,
  DropdownMenuLabel,
  DropdownMenuItem,
  DropdownMenuCheckboxItem,
  DropdownMenuRadioGroup,
  DropdownMenuRadioItem,
  DropdownMenuSeparator,
  DropdownMenuShortcut,
  DropdownMenuSub,
  DropdownMenuSubTrigger,
  DropdownMenuSubContent,
}

```

# src/components/ui/form.tsx

```tsx
"use client"

import * as React from "react"
import type * as LabelPrimitive from "@radix-ui/react-label"
import { Slot } from "@radix-ui/react-slot"
import {
  Controller,
  FormProvider,
  useFormContext,
  useFormState,
  type ControllerProps,
  type FieldPath,
  type FieldValues,
} from "react-hook-form"

import { cn } from "@/lib/utils"
import { Label } from "@/components/ui/label"

const Form = FormProvider

type FormFieldContextValue<
  TFieldValues extends FieldValues = FieldValues,
  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>,
> = {
  name: TName
}

const FormFieldContext = React.createContext<FormFieldContextValue>(
  {} as FormFieldContextValue
)

const FormField = <
  TFieldValues extends FieldValues = FieldValues,
  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>,
>({
  ...props
}: ControllerProps<TFieldValues, TName>) => {
  return (
    <FormFieldContext.Provider value={{ name: props.name }}>
      <Controller {...props} />
    </FormFieldContext.Provider>
  )
}

const useFormField = () => {
  const fieldContext = React.useContext(FormFieldContext)
  const itemContext = React.useContext(FormItemContext)
  const { getFieldState } = useFormContext()
  const formState = useFormState({ name: fieldContext.name })
  const fieldState = getFieldState(fieldContext.name, formState)

  if (!fieldContext) {
    throw new Error("useFormField should be used within <FormField>")
  }

  const { id } = itemContext

  return {
    id,
    name: fieldContext.name,
    formItemId: `${id}-form-item`,
    formDescriptionId: `${id}-form-item-description`,
    formMessageId: `${id}-form-item-message`,
    ...fieldState,
  }
}

type FormItemContextValue = {
  id: string
}

const FormItemContext = React.createContext<FormItemContextValue>(
  {} as FormItemContextValue
)

function FormItem({ className, ...props }: React.ComponentProps<"div">) {
  const id = React.useId()

  return (
    <FormItemContext.Provider value={{ id }}>
      <div
        data-slot="form-item"
        className={cn("grid gap-2", className)}
        {...props}
      />
    </FormItemContext.Provider>
  )
}

function FormLabel({
  className,
  ...props
}: React.ComponentProps<typeof LabelPrimitive.Root>) {
  const { error, formItemId } = useFormField()

  return (
    <Label
      data-slot="form-label"
      data-error={!!error}
      className={cn("data-[error=true]:text-destructive", className)}
      htmlFor={formItemId}
      {...props}
    />
  )
}

function FormControl({ ...props }: React.ComponentProps<typeof Slot>) {
  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()

  return (
    <Slot
      data-slot="form-control"
      id={formItemId}
      aria-describedby={
        !error
          ? `${formDescriptionId}`
          : `${formDescriptionId} ${formMessageId}`
      }
      aria-invalid={!!error}
      {...props}
    />
  )
}

function FormDescription({ className, ...props }: React.ComponentProps<"p">) {
  const { formDescriptionId } = useFormField()

  return (
    <p
      data-slot="form-description"
      id={formDescriptionId}
      className={cn("text-muted-foreground text-sm", className)}
      {...props}
    />
  )
}

function FormMessage({ className, ...props }: React.ComponentProps<"p">) {
  const { error, formMessageId } = useFormField()
  const body = error ? String(error?.message ?? "") : props.children

  if (!body) {
    return null
  }

  return (
    <p
      data-slot="form-message"
      id={formMessageId}
      className={cn("text-destructive text-sm", className)}
      {...props}
    >
      {body}
    </p>
  )
}

export {
  useFormField,
  Form,
  FormItem,
  FormLabel,
  FormControl,
  FormDescription,
  FormMessage,
  FormField,
}

```

# src/components/ui/input.tsx

```tsx
import * as React from "react"

import { cn } from "@/lib/utils"

function Input({ className, type, ...props }: React.ComponentProps<"input">) {
  return (
    <input
      type={type}
      data-slot="input"
      className={cn(
        "file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",
        "focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]",
        "aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",
        className
      )}
      {...props}
    />
  )
}

export { Input }

```

# src/components/ui/label.tsx

```tsx
"use client"

import * as React from "react"
import * as LabelPrimitive from "@radix-ui/react-label"

import { cn } from "@/lib/utils"

function Label({
  className,
  ...props
}: React.ComponentProps<typeof LabelPrimitive.Root>) {
  return (
    <LabelPrimitive.Root
      data-slot="label"
      className={cn(
        "flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",
        className
      )}
      {...props}
    />
  )
}

export { Label }

```

# src/components/ui/pagination.tsx

```tsx
import * as React from "react"
import {
  ChevronLeftIcon,
  ChevronRightIcon,
  MoreHorizontalIcon,
} from "lucide-react"

import { cn } from "@/lib/utils"
import { buttonVariants, type Button } from "@/components/ui/button"

function Pagination({ className, ...props }: React.ComponentProps<"nav">) {
  return (
    <nav
      role="navigation"
      aria-label="pagination"
      data-slot="pagination"
      className={cn("mx-auto flex w-full justify-center", className)}
      {...props}
    />
  )
}

function PaginationContent({
  className,
  ...props
}: React.ComponentProps<"ul">) {
  return (
    <ul
      data-slot="pagination-content"
      className={cn("flex flex-row items-center gap-1", className)}
      {...props}
    />
  )
}

function PaginationItem({ ...props }: React.ComponentProps<"li">) {
  return <li data-slot="pagination-item" {...props} />
}

type PaginationLinkProps = {
  isActive?: boolean
} & Pick<React.ComponentProps<typeof Button>, "size"> &
  React.ComponentProps<"a">

function PaginationLink({
  className,
  isActive,
  size = "icon",
  ...props
}: PaginationLinkProps) {
  return (
    <a
      aria-current={isActive ? "page" : undefined}
      data-slot="pagination-link"
      data-active={isActive}
      className={cn(
        buttonVariants({
          variant: isActive ? "outline" : "ghost",
          size,
        }),
        className
      )}
      {...props}
    />
  )
}

function PaginationPrevious({
  className,
  ...props
}: React.ComponentProps<typeof PaginationLink>) {
  return (
    <PaginationLink
      aria-label="Go to previous page"
      size="default"
      className={cn("gap-1 px-2.5 sm:pl-2.5", className)}
      {...props}
    >
      <ChevronLeftIcon />
      <span className="hidden sm:block">Previous</span>
    </PaginationLink>
  )
}

function PaginationNext({
  className,
  ...props
}: React.ComponentProps<typeof PaginationLink>) {
  return (
    <PaginationLink
      aria-label="Go to next page"
      size="default"
      className={cn("gap-1 px-2.5 sm:pr-2.5", className)}
      {...props}
    >
      <span className="hidden sm:block">Next</span>
      <ChevronRightIcon />
    </PaginationLink>
  )
}

function PaginationEllipsis({
  className,
  ...props
}: React.ComponentProps<"span">) {
  return (
    <span
      aria-hidden
      data-slot="pagination-ellipsis"
      className={cn("flex size-9 items-center justify-center", className)}
      {...props}
    >
      <MoreHorizontalIcon className="size-4" />
      <span className="sr-only">More pages</span>
    </span>
  )
}

export {
  Pagination,
  PaginationContent,
  PaginationLink,
  PaginationItem,
  PaginationPrevious,
  PaginationNext,
  PaginationEllipsis,
}

```

# src/components/ui/progress.tsx

```tsx
"use client"

import * as React from "react"
import * as ProgressPrimitive from "@radix-ui/react-progress"

import { cn } from "@/lib/utils"

function Progress({
  className,
  value,
  ...props
}: React.ComponentProps<typeof ProgressPrimitive.Root>) {
  return (
    <ProgressPrimitive.Root
      data-slot="progress"
      className={cn(
        "bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",
        className
      )}
      {...props}
    >
      <ProgressPrimitive.Indicator
        data-slot="progress-indicator"
        className="bg-primary h-full w-full flex-1 transition-all"
        style={{ transform: `translateX(-${100 - (value || 0)}%)` }}
      />
    </ProgressPrimitive.Root>
  )
}

export { Progress }

```

# src/components/ui/radio-group.tsx

```tsx
"use client"

import * as React from "react"
import * as RadioGroupPrimitive from "@radix-ui/react-radio-group"
import { CircleIcon } from "lucide-react"

import { cn } from "@/lib/utils"

function RadioGroup({
  className,
  ...props
}: React.ComponentProps<typeof RadioGroupPrimitive.Root>) {
  return (
    <RadioGroupPrimitive.Root
      data-slot="radio-group"
      className={cn("grid gap-3", className)}
      {...props}
    />
  )
}

function RadioGroupItem({
  className,
  ...props
}: React.ComponentProps<typeof RadioGroupPrimitive.Item>) {
  return (
    <RadioGroupPrimitive.Item
      data-slot="radio-group-item"
      className={cn(
        "border-input text-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 aspect-square size-4 shrink-0 rounded-full border shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",
        className
      )}
      {...props}
    >
      <RadioGroupPrimitive.Indicator
        data-slot="radio-group-indicator"
        className="relative flex items-center justify-center"
      >
        <CircleIcon className="fill-primary absolute top-1/2 left-1/2 size-2 -translate-x-1/2 -translate-y-1/2" />
      </RadioGroupPrimitive.Indicator>
    </RadioGroupPrimitive.Item>
  )
}

export { RadioGroup, RadioGroupItem }

```

# src/components/ui/scroll-area.tsx

```tsx
"use client"

import * as React from "react"
import * as ScrollAreaPrimitive from "@radix-ui/react-scroll-area"

import { cn } from "@/lib/utils"

function ScrollArea({
  className,
  children,
  ...props
}: React.ComponentProps<typeof ScrollAreaPrimitive.Root>) {
  return (
    <ScrollAreaPrimitive.Root
      data-slot="scroll-area"
      className={cn("relative", className)}
      {...props}
    >
      <ScrollAreaPrimitive.Viewport
        data-slot="scroll-area-viewport"
        className="focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1"
      >
        {children}
      </ScrollAreaPrimitive.Viewport>
      <ScrollBar />
      <ScrollAreaPrimitive.Corner />
    </ScrollAreaPrimitive.Root>
  )
}

function ScrollBar({
  className,
  orientation = "vertical",
  ...props
}: React.ComponentProps<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>) {
  return (
    <ScrollAreaPrimitive.ScrollAreaScrollbar
      data-slot="scroll-area-scrollbar"
      orientation={orientation}
      className={cn(
        "flex touch-none p-px transition-colors select-none",
        orientation === "vertical" &&
          "h-full w-2.5 border-l border-l-transparent",
        orientation === "horizontal" &&
          "h-2.5 flex-col border-t border-t-transparent",
        className
      )}
      {...props}
    >
      <ScrollAreaPrimitive.ScrollAreaThumb
        data-slot="scroll-area-thumb"
        className="bg-border relative flex-1 rounded-full"
      />
    </ScrollAreaPrimitive.ScrollAreaScrollbar>
  )
}

export { ScrollArea, ScrollBar }

```

# src/components/ui/select.tsx

```tsx
"use client"

import * as React from "react"
import * as SelectPrimitive from "@radix-ui/react-select"
import { CheckIcon, ChevronDownIcon, ChevronUpIcon } from "lucide-react"

import { cn } from "@/lib/utils"

function Select({
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Root>) {
  return <SelectPrimitive.Root data-slot="select" {...props} />
}

function SelectGroup({
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Group>) {
  return <SelectPrimitive.Group data-slot="select-group" {...props} />
}

function SelectValue({
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Value>) {
  return <SelectPrimitive.Value data-slot="select-value" {...props} />
}

function SelectTrigger({
  className,
  size = "default",
  children,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Trigger> & {
  size?: "sm" | "default"
}) {
  return (
    <SelectPrimitive.Trigger
      data-slot="select-trigger"
      data-size={size}
      className={cn(
        "border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className
      )}
      {...props}
    >
      {children}
      <SelectPrimitive.Icon asChild>
        <ChevronDownIcon className="size-4 opacity-50" />
      </SelectPrimitive.Icon>
    </SelectPrimitive.Trigger>
  )
}

function SelectContent({
  className,
  children,
  position = "item-aligned",
  align = "center",
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Content>) {
  return (
    <SelectPrimitive.Portal>
      <SelectPrimitive.Content
        data-slot="select-content"
        className={cn(
          "bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",
          position === "popper" &&
            "data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",
          className
        )}
        position={position}
        align={align}
        {...props}
      >
        <SelectScrollUpButton />
        <SelectPrimitive.Viewport
          className={cn(
            "p-1",
            position === "popper" &&
              "h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"
          )}
        >
          {children}
        </SelectPrimitive.Viewport>
        <SelectScrollDownButton />
      </SelectPrimitive.Content>
    </SelectPrimitive.Portal>
  )
}

function SelectLabel({
  className,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Label>) {
  return (
    <SelectPrimitive.Label
      data-slot="select-label"
      className={cn("text-muted-foreground px-2 py-1.5 text-xs", className)}
      {...props}
    />
  )
}

function SelectItem({
  className,
  children,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Item>) {
  return (
    <SelectPrimitive.Item
      data-slot="select-item"
      className={cn(
        "focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",
        className
      )}
      {...props}
    >
      <span
        data-slot="select-item-indicator"
        className="absolute right-2 flex size-3.5 items-center justify-center"
      >
        <SelectPrimitive.ItemIndicator>
          <CheckIcon className="size-4" />
        </SelectPrimitive.ItemIndicator>
      </span>
      <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>
    </SelectPrimitive.Item>
  )
}

function SelectSeparator({
  className,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Separator>) {
  return (
    <SelectPrimitive.Separator
      data-slot="select-separator"
      className={cn("bg-border pointer-events-none -mx-1 my-1 h-px", className)}
      {...props}
    />
  )
}

function SelectScrollUpButton({
  className,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.ScrollUpButton>) {
  return (
    <SelectPrimitive.ScrollUpButton
      data-slot="select-scroll-up-button"
      className={cn(
        "flex cursor-default items-center justify-center py-1",
        className
      )}
      {...props}
    >
      <ChevronUpIcon className="size-4" />
    </SelectPrimitive.ScrollUpButton>
  )
}

function SelectScrollDownButton({
  className,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.ScrollDownButton>) {
  return (
    <SelectPrimitive.ScrollDownButton
      data-slot="select-scroll-down-button"
      className={cn(
        "flex cursor-default items-center justify-center py-1",
        className
      )}
      {...props}
    >
      <ChevronDownIcon className="size-4" />
    </SelectPrimitive.ScrollDownButton>
  )
}

export {
  Select,
  SelectContent,
  SelectGroup,
  SelectItem,
  SelectLabel,
  SelectScrollDownButton,
  SelectScrollUpButton,
  SelectSeparator,
  SelectTrigger,
  SelectValue,
}

```

# src/components/ui/separator.tsx

```tsx
"use client"

import * as React from "react"
import * as SeparatorPrimitive from "@radix-ui/react-separator"

import { cn } from "@/lib/utils"

function Separator({
  className,
  orientation = "horizontal",
  decorative = true,
  ...props
}: React.ComponentProps<typeof SeparatorPrimitive.Root>) {
  return (
    <SeparatorPrimitive.Root
      data-slot="separator"
      decorative={decorative}
      orientation={orientation}
      className={cn(
        "bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",
        className
      )}
      {...props}
    />
  )
}

export { Separator }

```

# src/components/ui/sheet.tsx

```tsx
"use client"

import * as React from "react"
import * as SheetPrimitive from "@radix-ui/react-dialog"
import { XIcon } from "lucide-react"

import { cn } from "@/lib/utils"

function Sheet({ ...props }: React.ComponentProps<typeof SheetPrimitive.Root>) {
  return <SheetPrimitive.Root data-slot="sheet" {...props} />
}

function SheetTrigger({
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Trigger>) {
  return <SheetPrimitive.Trigger data-slot="sheet-trigger" {...props} />
}

function SheetClose({
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Close>) {
  return <SheetPrimitive.Close data-slot="sheet-close" {...props} />
}

function SheetPortal({
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Portal>) {
  return <SheetPrimitive.Portal data-slot="sheet-portal" {...props} />
}

function SheetOverlay({
  className,
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Overlay>) {
  return (
    <SheetPrimitive.Overlay
      data-slot="sheet-overlay"
      className={cn(
        "data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",
        className
      )}
      {...props}
    />
  )
}

function SheetContent({
  className,
  children,
  side = "right",
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Content> & {
  side?: "top" | "right" | "bottom" | "left"
}) {
  return (
    <SheetPortal>
      <SheetOverlay />
      <SheetPrimitive.Content
        data-slot="sheet-content"
        className={cn(
          "bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500",
          side === "right" &&
            "data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm",
          side === "left" &&
            "data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm",
          side === "top" &&
            "data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b",
          side === "bottom" &&
            "data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",
          className
        )}
        {...props}
      >
        {children}
        <SheetPrimitive.Close className="ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none">
          <XIcon className="size-4" />
          <span className="sr-only">Close</span>
        </SheetPrimitive.Close>
      </SheetPrimitive.Content>
    </SheetPortal>
  )
}

function SheetHeader({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="sheet-header"
      className={cn("flex flex-col gap-1.5 p-4", className)}
      {...props}
    />
  )
}

function SheetFooter({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="sheet-footer"
      className={cn("mt-auto flex flex-col gap-2 p-4", className)}
      {...props}
    />
  )
}

function SheetTitle({
  className,
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Title>) {
  return (
    <SheetPrimitive.Title
      data-slot="sheet-title"
      className={cn("text-foreground font-semibold", className)}
      {...props}
    />
  )
}

function SheetDescription({
  className,
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Description>) {
  return (
    <SheetPrimitive.Description
      data-slot="sheet-description"
      className={cn("text-muted-foreground text-sm", className)}
      {...props}
    />
  )
}

export {
  Sheet,
  SheetTrigger,
  SheetClose,
  SheetContent,
  SheetHeader,
  SheetFooter,
  SheetTitle,
  SheetDescription,
}

```

# src/components/ui/skeleton.tsx

```tsx
import { cn } from "@/lib/utils"

function Skeleton({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="skeleton"
      className={cn("bg-accent animate-pulse rounded-md", className)}
      {...props}
    />
  )
}

export { Skeleton }

```

# src/components/ui/sonner.tsx

```tsx
"use client"

import {
  CircleCheckIcon,
  InfoIcon,
  Loader2Icon,
  OctagonXIcon,
  TriangleAlertIcon,
} from "lucide-react"
import { useTheme } from "next-themes"
import { Toaster as Sonner, type ToasterProps } from "sonner"

const Toaster = ({ ...props }: ToasterProps) => {
  const { theme = "system" } = useTheme()

  return (
    <Sonner
      theme={theme as ToasterProps["theme"]}
      className="toaster group"
      icons={{
        success: <CircleCheckIcon className="size-4" />,
        info: <InfoIcon className="size-4" />,
        warning: <TriangleAlertIcon className="size-4" />,
        error: <OctagonXIcon className="size-4" />,
        loading: <Loader2Icon className="size-4 animate-spin" />,
      }}
      style={
        {
          "--normal-bg": "var(--popover)",
          "--normal-text": "var(--popover-foreground)",
          "--normal-border": "var(--border)",
          "--border-radius": "var(--radius)",
        } as React.CSSProperties
      }
      {...props}
    />
  )
}

export { Toaster }

```

# src/components/ui/switch.tsx

```tsx
"use client"

import * as React from "react"
import * as SwitchPrimitive from "@radix-ui/react-switch"

import { cn } from "@/lib/utils"

function Switch({
  className,
  ...props
}: React.ComponentProps<typeof SwitchPrimitive.Root>) {
  return (
    <SwitchPrimitive.Root
      data-slot="switch"
      className={cn(
        "peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",
        className
      )}
      {...props}
    >
      <SwitchPrimitive.Thumb
        data-slot="switch-thumb"
        className={cn(
          "bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0"
        )}
      />
    </SwitchPrimitive.Root>
  )
}

export { Switch }

```

# src/components/ui/table.tsx

```tsx
"use client"

import * as React from "react"

import { cn } from "@/lib/utils"

function Table({ className, ...props }: React.ComponentProps<"table">) {
  return (
    <div
      data-slot="table-container"
      className="relative w-full overflow-x-auto"
    >
      <table
        data-slot="table"
        className={cn("w-full caption-bottom text-sm", className)}
        {...props}
      />
    </div>
  )
}

function TableHeader({ className, ...props }: React.ComponentProps<"thead">) {
  return (
    <thead
      data-slot="table-header"
      className={cn("[&_tr]:border-b", className)}
      {...props}
    />
  )
}

function TableBody({ className, ...props }: React.ComponentProps<"tbody">) {
  return (
    <tbody
      data-slot="table-body"
      className={cn("[&_tr:last-child]:border-0", className)}
      {...props}
    />
  )
}

function TableFooter({ className, ...props }: React.ComponentProps<"tfoot">) {
  return (
    <tfoot
      data-slot="table-footer"
      className={cn(
        "bg-muted/50 border-t font-medium [&>tr]:last:border-b-0",
        className
      )}
      {...props}
    />
  )
}

function TableRow({ className, ...props }: React.ComponentProps<"tr">) {
  return (
    <tr
      data-slot="table-row"
      className={cn(
        "hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",
        className
      )}
      {...props}
    />
  )
}

function TableHead({ className, ...props }: React.ComponentProps<"th">) {
  return (
    <th
      data-slot="table-head"
      className={cn(
        "text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",
        className
      )}
      {...props}
    />
  )
}

function TableCell({ className, ...props }: React.ComponentProps<"td">) {
  return (
    <td
      data-slot="table-cell"
      className={cn(
        "p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",
        className
      )}
      {...props}
    />
  )
}

function TableCaption({
  className,
  ...props
}: React.ComponentProps<"caption">) {
  return (
    <caption
      data-slot="table-caption"
      className={cn("text-muted-foreground mt-4 text-sm", className)}
      {...props}
    />
  )
}

export {
  Table,
  TableHeader,
  TableBody,
  TableFooter,
  TableHead,
  TableRow,
  TableCell,
  TableCaption,
}

```

# src/components/ui/tabs.tsx

```tsx
"use client"

import * as React from "react"
import * as TabsPrimitive from "@radix-ui/react-tabs"

import { cn } from "@/lib/utils"

function Tabs({
  className,
  ...props
}: React.ComponentProps<typeof TabsPrimitive.Root>) {
  return (
    <TabsPrimitive.Root
      data-slot="tabs"
      className={cn("flex flex-col gap-2", className)}
      {...props}
    />
  )
}

function TabsList({
  className,
  ...props
}: React.ComponentProps<typeof TabsPrimitive.List>) {
  return (
    <TabsPrimitive.List
      data-slot="tabs-list"
      className={cn(
        "bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",
        className
      )}
      {...props}
    />
  )
}

function TabsTrigger({
  className,
  ...props
}: React.ComponentProps<typeof TabsPrimitive.Trigger>) {
  return (
    <TabsPrimitive.Trigger
      data-slot="tabs-trigger"
      className={cn(
        "data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className
      )}
      {...props}
    />
  )
}

function TabsContent({
  className,
  ...props
}: React.ComponentProps<typeof TabsPrimitive.Content>) {
  return (
    <TabsPrimitive.Content
      data-slot="tabs-content"
      className={cn("flex-1 outline-none", className)}
      {...props}
    />
  )
}

export { Tabs, TabsList, TabsTrigger, TabsContent }

```

# src/components/ui/textarea.tsx

```tsx
"use client";

import * as React from "react";
import { cn } from "@/lib/utils";

export type TextareaProps = React.TextareaHTMLAttributes<HTMLTextAreaElement>;

const Textarea = React.forwardRef<HTMLTextAreaElement, TextareaProps>(
  ({ className, ...props }, ref) => {
    return (
      <textarea
        className={cn(
          "flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",
          className
        )}
        ref={ref}
        {...props}
      />
    );
  }
);
Textarea.displayName = "Textarea";

export { Textarea };

```

# src/components/ui/tooltip.tsx

```tsx
"use client"

import * as React from "react"
import * as TooltipPrimitive from "@radix-ui/react-tooltip"

import { cn } from "@/lib/utils"

function TooltipProvider({
  delayDuration = 0,
  ...props
}: React.ComponentProps<typeof TooltipPrimitive.Provider>) {
  return (
    <TooltipPrimitive.Provider
      data-slot="tooltip-provider"
      delayDuration={delayDuration}
      {...props}
    />
  )
}

function Tooltip({
  ...props
}: React.ComponentProps<typeof TooltipPrimitive.Root>) {
  return (
    <TooltipProvider>
      <TooltipPrimitive.Root data-slot="tooltip" {...props} />
    </TooltipProvider>
  )
}

function TooltipTrigger({
  ...props
}: React.ComponentProps<typeof TooltipPrimitive.Trigger>) {
  return <TooltipPrimitive.Trigger data-slot="tooltip-trigger" {...props} />
}

function TooltipContent({
  className,
  sideOffset = 0,
  children,
  ...props
}: React.ComponentProps<typeof TooltipPrimitive.Content>) {
  return (
    <TooltipPrimitive.Portal>
      <TooltipPrimitive.Content
        data-slot="tooltip-content"
        sideOffset={sideOffset}
        className={cn(
          "bg-foreground text-background animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",
          className
        )}
        {...props}
      >
        {children}
        <TooltipPrimitive.Arrow className="bg-foreground fill-foreground z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]" />
      </TooltipPrimitive.Content>
    </TooltipPrimitive.Portal>
  )
}

export { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }

```

# src/hooks/useAutoSave.ts

```ts
"use client";

import { useRef, useEffect, useCallback, useState } from "react";

export type SaveStatus = "idle" | "saving" | "saved" | "error";

interface UseAutoSaveOptions<T> {
  data: T;
  onSave: (data: T) => Promise<void>;
  debounceMs?: number;
  enabled?: boolean;
}

interface UseAutoSaveReturn {
  saveStatus: SaveStatus;
  lastSavedAt: Date | null;
  saveNow: () => void;
  error: Error | null;
}

/**
 * A hook for auto-saving data with debouncing
 *
 * @param options - Configuration options
 * @param options.data - The data to save
 * @param options.onSave - Async function to save the data
 * @param options.debounceMs - Debounce delay in milliseconds (default: 2000)
 * @param options.enabled - Whether auto-save is enabled (default: true)
 * @returns Save status and controls
 */
export function useAutoSave<T>({
  data,
  onSave,
  debounceMs = 2000,
  enabled = true,
}: UseAutoSaveOptions<T>): UseAutoSaveReturn {
  const [saveStatus, setSaveStatus] = useState<SaveStatus>("idle");
  const [lastSavedAt, setLastSavedAt] = useState<Date | null>(null);
  const [error, setError] = useState<Error | null>(null);

  const timeoutRef = useRef<NodeJS.Timeout | null>(null);
  const lastDataRef = useRef<T>(data);
  const isMountedRef = useRef(true);
  const pendingSaveRef = useRef(false);

  // Deep comparison of data
  const hasDataChanged = useCallback((newData: T, oldData: T): boolean => {
    return JSON.stringify(newData) !== JSON.stringify(oldData);
  }, []);

  // Perform the save operation
  const performSave = useCallback(async (dataToSave: T) => {
    if (!isMountedRef.current) return;

    setSaveStatus("saving");
    setError(null);

    try {
      await onSave(dataToSave);
      if (isMountedRef.current) {
        setSaveStatus("saved");
        setLastSavedAt(new Date());
        lastDataRef.current = dataToSave;

        // Reset status to idle after a delay
        setTimeout(() => {
          if (isMountedRef.current) {
            setSaveStatus("idle");
          }
        }, 2000);
      }
    } catch (err) {
      if (isMountedRef.current) {
        setSaveStatus("error");
        setError(err instanceof Error ? err : new Error("Save failed"));
      }
    }
  }, [onSave]);

  // Manual save trigger
  const saveNow = useCallback(() => {
    if (timeoutRef.current) {
      clearTimeout(timeoutRef.current);
      timeoutRef.current = null;
    }
    performSave(lastDataRef.current);
  }, [performSave]);

  // Effect to handle debounced auto-save
  useEffect(() => {
    if (!enabled) return;

    // Check if data has changed
    if (!hasDataChanged(data, lastDataRef.current)) {
      return;
    }

    // Update the ref to track latest data
    lastDataRef.current = data;
    pendingSaveRef.current = true;

    // Clear existing timeout
    if (timeoutRef.current) {
      clearTimeout(timeoutRef.current);
    }

    // Set new timeout for debounced save
    timeoutRef.current = setTimeout(() => {
      if (pendingSaveRef.current) {
        performSave(data);
        pendingSaveRef.current = false;
      }
    }, debounceMs);

    return () => {
      if (timeoutRef.current) {
        clearTimeout(timeoutRef.current);
      }
    };
  }, [data, debounceMs, enabled, hasDataChanged, performSave]);

  // Cleanup on unmount
  useEffect(() => {
    isMountedRef.current = true;
    return () => {
      isMountedRef.current = false;
      if (timeoutRef.current) {
        clearTimeout(timeoutRef.current);
      }
    };
  }, []);

  // Save on page unload if there are pending changes
  useEffect(() => {
    const handleBeforeUnload = (e: BeforeUnloadEvent) => {
      if (pendingSaveRef.current && enabled) {
        e.preventDefault();
        e.returnValue = "";
        // Attempt to save synchronously (may not complete)
        performSave(lastDataRef.current);
      }
    };

    window.addEventListener("beforeunload", handleBeforeUnload);
    return () => {
      window.removeEventListener("beforeunload", handleBeforeUnload);
    };
  }, [enabled, performSave]);

  return {
    saveStatus,
    lastSavedAt,
    saveNow,
    error,
  };
}

/**
 * A simpler hook for debouncing a value
 */
export function useDebounce<T>(value: T, delay: number): T {
  const [debouncedValue, setDebouncedValue] = useState<T>(value);

  useEffect(() => {
    const timer = setTimeout(() => {
      setDebouncedValue(value);
    }, delay);

    return () => {
      clearTimeout(timer);
    };
  }, [value, delay]);

  return debouncedValue;
}

/**
 * A hook for tracking dirty state of a form
 */
export function useDirtyTracking<T>(
  currentData: T,
  savedData: T
): {
  isDirty: boolean;
  changedFields: string[];
} {
  const isDirty = JSON.stringify(currentData) !== JSON.stringify(savedData);

  // Find which fields have changed (for objects)
  const changedFields: string[] = [];
  if (typeof currentData === "object" && currentData !== null) {
    const current = currentData as Record<string, unknown>;
    const saved = savedData as Record<string, unknown>;

    for (const key of Object.keys(current)) {
      if (JSON.stringify(current[key]) !== JSON.stringify(saved[key])) {
        changedFields.push(key);
      }
    }
  }

  return { isDirty, changedFields };
}

```

# src/lib/assessment/constants.ts

```ts
/**
 * Self-Assessment Module - Constants
 *
 * Bilingual constants for the assessment system, aligned with:
 * - ICAO USOAP CMA methodology for ANS assessments
 * - CANSO Standard of Excellence (SoE) for SMS assessments
 */

import type {
  AssessmentStatus,
  AssessmentType,
  ANSResponseValue,
  SMSMaturityLevel,
  EvidenceType,
} from "./types";

// =============================================================================
// HELPER TYPES
// =============================================================================

export interface BilingualLabel {
  en: string;
  fr: string;
}

export interface BilingualDescription {
  en: string;
  fr: string;
}

// =============================================================================
// ASSESSMENT STATUS CONFIGURATION
// =============================================================================

export interface AssessmentStatusConfig {
  label: BilingualLabel;
  description: BilingualDescription;
  color: string;
  bgColor: string;
  textColor: string;
  icon: string;
  allowedTransitions: AssessmentStatus[];
  sortOrder: number;
}

export const ASSESSMENT_STATUSES: Record<AssessmentStatus, AssessmentStatusConfig> = {
  DRAFT: {
    label: {
      en: "Draft",
      fr: "Brouillon",
    },
    description: {
      en: "Assessment is being prepared and can be edited",
      fr: "L'évaluation est en cours de préparation et peut être modifiée",
    },
    color: "gray",
    bgColor: "bg-gray-100 dark:bg-gray-800",
    textColor: "text-gray-700 dark:text-gray-300",
    icon: "FileEdit",
    allowedTransitions: ["IN_PROGRESS", "ARCHIVED"],
    sortOrder: 1,
  },
  IN_PROGRESS: {
    label: {
      en: "In Progress",
      fr: "En cours",
    },
    description: {
      en: "Assessment is actively being completed",
      fr: "L'évaluation est en cours de réalisation",
    },
    color: "blue",
    bgColor: "bg-blue-100 dark:bg-blue-900/30",
    textColor: "text-blue-700 dark:text-blue-400",
    icon: "Play",
    allowedTransitions: ["SUBMITTED", "DRAFT"],
    sortOrder: 2,
  },
  SUBMITTED: {
    label: {
      en: "Submitted",
      fr: "Soumis",
    },
    description: {
      en: "Assessment has been submitted for review",
      fr: "L'évaluation a été soumise pour examen",
    },
    color: "amber",
    bgColor: "bg-amber-100 dark:bg-amber-900/30",
    textColor: "text-amber-700 dark:text-amber-400",
    icon: "Send",
    allowedTransitions: ["UNDER_REVIEW", "IN_PROGRESS"],
    sortOrder: 3,
  },
  UNDER_REVIEW: {
    label: {
      en: "Under Review",
      fr: "En cours d'examen",
    },
    description: {
      en: "Assessment is being reviewed by peers or auditors",
      fr: "L'évaluation est examinée par des pairs ou des auditeurs",
    },
    color: "purple",
    bgColor: "bg-purple-100 dark:bg-purple-900/30",
    textColor: "text-purple-700 dark:text-purple-400",
    icon: "Eye",
    allowedTransitions: ["COMPLETED", "SUBMITTED"],
    sortOrder: 4,
  },
  COMPLETED: {
    label: {
      en: "Completed",
      fr: "Terminé",
    },
    description: {
      en: "Assessment has been finalized and approved",
      fr: "L'évaluation a été finalisée et approuvée",
    },
    color: "green",
    bgColor: "bg-green-100 dark:bg-green-900/30",
    textColor: "text-green-700 dark:text-green-400",
    icon: "CheckCircle",
    allowedTransitions: ["ARCHIVED"],
    sortOrder: 5,
  },
  ARCHIVED: {
    label: {
      en: "Archived",
      fr: "Archivé",
    },
    description: {
      en: "Assessment has been archived for historical reference",
      fr: "L'évaluation a été archivée pour référence historique",
    },
    color: "slate",
    bgColor: "bg-slate-100 dark:bg-slate-800",
    textColor: "text-slate-600 dark:text-slate-400",
    icon: "Archive",
    allowedTransitions: [],
    sortOrder: 6,
  },
};

// =============================================================================
// ASSESSMENT TYPE CONFIGURATION
// =============================================================================

export interface AssessmentTypeConfig {
  label: BilingualLabel;
  description: BilingualDescription;
  color: string;
  icon: string;
}

export const ASSESSMENT_TYPES: Record<AssessmentType, AssessmentTypeConfig> = {
  SELF_ASSESSMENT: {
    label: {
      en: "Self-Assessment",
      fr: "Auto-évaluation",
    },
    description: {
      en: "Organization evaluates its own safety oversight capabilities",
      fr: "L'organisation évalue ses propres capacités de surveillance de la sécurité",
    },
    color: "blue",
    icon: "ClipboardCheck",
  },
  GAP_ANALYSIS: {
    label: {
      en: "Gap Analysis",
      fr: "Analyse des écarts",
    },
    description: {
      en: "Identify gaps between current state and desired compliance level",
      fr: "Identifier les écarts entre l'état actuel et le niveau de conformité souhaité",
    },
    color: "orange",
    icon: "Search",
  },
  PRE_REVIEW: {
    label: {
      en: "Pre-Review Assessment",
      fr: "Évaluation pré-revue",
    },
    description: {
      en: "Preparation assessment before a scheduled peer review",
      fr: "Évaluation préparatoire avant une revue par les pairs programmée",
    },
    color: "purple",
    icon: "Calendar",
  },
  MOCK_REVIEW: {
    label: {
      en: "Mock Review",
      fr: "Revue simulée",
    },
    description: {
      en: "Practice assessment to simulate peer review experience",
      fr: "Évaluation pratique pour simuler l'expérience de revue par les pairs",
    },
    color: "teal",
    icon: "TestTube",
  },
};

// =============================================================================
// ANS RESPONSE VALUES (USOAP CMA ALIGNED)
// =============================================================================

export interface ANSResponseConfig {
  label: BilingualLabel;
  description: BilingualDescription;
  score: number | null;
  color: string;
  bgColor: string;
  textColor: string;
  borderColor: string;
  icon: string;
  shortCode: string;
}

export const ANS_RESPONSE_VALUES: Record<ANSResponseValue, ANSResponseConfig> = {
  SATISFACTORY: {
    label: {
      en: "Satisfactory",
      fr: "Satisfaisant",
    },
    description: {
      en: "The State has implemented the critical element. Evidence demonstrates effective implementation of ICAO provisions.",
      fr: "L'État a mis en œuvre l'élément critique. Les preuves démontrent une mise en œuvre effective des dispositions de l'OACI.",
    },
    score: 1,
    color: "green",
    bgColor: "bg-green-100 dark:bg-green-900/30",
    textColor: "text-green-700 dark:text-green-400",
    borderColor: "border-green-500",
    icon: "CheckCircle",
    shortCode: "S",
  },
  NOT_SATISFACTORY: {
    label: {
      en: "Not Satisfactory",
      fr: "Non satisfaisant",
    },
    description: {
      en: "The State has not implemented or has only partially implemented the critical element. A finding should be raised.",
      fr: "L'État n'a pas mis en œuvre ou n'a que partiellement mis en œuvre l'élément critique. Une constatation doit être soulevée.",
    },
    score: 0,
    color: "red",
    bgColor: "bg-red-100 dark:bg-red-900/30",
    textColor: "text-red-700 dark:text-red-400",
    borderColor: "border-red-500",
    icon: "XCircle",
    shortCode: "NS",
  },
  NOT_APPLICABLE: {
    label: {
      en: "Not Applicable",
      fr: "Non applicable",
    },
    description: {
      en: "The protocol question is not applicable to the State due to its specific circumstances or aviation activities.",
      fr: "La question de protocole n'est pas applicable à l'État en raison de ses circonstances spécifiques ou de ses activités aéronautiques.",
    },
    score: null, // Excluded from EI calculation
    color: "gray",
    bgColor: "bg-gray-100 dark:bg-gray-800",
    textColor: "text-gray-600 dark:text-gray-400",
    borderColor: "border-gray-400",
    icon: "MinusCircle",
    shortCode: "NA",
  },
  NOT_REVIEWED: {
    label: {
      en: "Not Reviewed",
      fr: "Non examiné",
    },
    description: {
      en: "The question has not yet been assessed. Response required before submission.",
      fr: "La question n'a pas encore été évaluée. Une réponse est requise avant la soumission.",
    },
    score: null,
    color: "yellow",
    bgColor: "bg-yellow-100 dark:bg-yellow-900/30",
    textColor: "text-yellow-700 dark:text-yellow-400",
    borderColor: "border-yellow-500",
    icon: "Clock",
    shortCode: "NR",
  },
};

// =============================================================================
// SMS MATURITY LEVELS (CANSO SOE ALIGNED)
// =============================================================================

export interface SMSMaturityConfig {
  label: BilingualLabel;
  description: BilingualDescription;
  characteristics: BilingualLabel;
  scoreValue: number;
  scoreRange: [number, number]; // Percentage range
  color: string;
  bgColor: string;
  textColor: string;
  borderColor: string;
}

export const SMS_MATURITY_LEVELS: Record<NonNullable<SMSMaturityLevel>, SMSMaturityConfig> = {
  A: {
    label: {
      en: "Level A - Initial/Ad-hoc",
      fr: "Niveau A - Initial/Ad hoc",
    },
    description: {
      en: "Processes are typically undocumented and in a state of dynamic change, tending to be driven by individual efforts.",
      fr: "Les processus sont généralement non documentés et en état de changement dynamique, tendant à être guidés par des efforts individuels.",
    },
    characteristics: {
      en: "Reactive, individual-dependent, informal processes",
      fr: "Réactif, dépendant des individus, processus informels",
    },
    scoreValue: 1,
    scoreRange: [0, 20],
    color: "red",
    bgColor: "bg-red-100 dark:bg-red-900/30",
    textColor: "text-red-700 dark:text-red-400",
    borderColor: "border-red-500",
  },
  B: {
    label: {
      en: "Level B - Defined/Documented",
      fr: "Niveau B - Défini/Documenté",
    },
    description: {
      en: "Processes are documented, standardized and integrated into organization-wide procedures. Basic training is provided.",
      fr: "Les processus sont documentés, standardisés et intégrés dans les procédures à l'échelle de l'organisation. Une formation de base est dispensée.",
    },
    characteristics: {
      en: "Documented, standardized, basic training provided",
      fr: "Documenté, standardisé, formation de base fournie",
    },
    scoreValue: 2,
    scoreRange: [21, 40],
    color: "orange",
    bgColor: "bg-orange-100 dark:bg-orange-900/30",
    textColor: "text-orange-700 dark:text-orange-400",
    borderColor: "border-orange-500",
  },
  C: {
    label: {
      en: "Level C - Implemented/Measured",
      fr: "Niveau C - Mis en œuvre/Mesuré",
    },
    description: {
      en: "Processes are implemented organization-wide and performance is measured using key indicators. Regular reviews conducted.",
      fr: "Les processus sont mis en œuvre à l'échelle de l'organisation et la performance est mesurée à l'aide d'indicateurs clés. Des revues régulières sont effectuées.",
    },
    characteristics: {
      en: "Organization-wide implementation, performance measured, regular reviews",
      fr: "Mise en œuvre à l'échelle de l'organisation, performance mesurée, revues régulières",
    },
    scoreValue: 3,
    scoreRange: [41, 60],
    color: "yellow",
    bgColor: "bg-yellow-100 dark:bg-yellow-900/30",
    textColor: "text-yellow-700 dark:text-yellow-400",
    borderColor: "border-yellow-500",
  },
  D: {
    label: {
      en: "Level D - Managed/Controlled",
      fr: "Niveau D - Géré/Contrôlé",
    },
    description: {
      en: "Processes are managed and controlled using detailed metrics. Process improvement targets are established and monitored.",
      fr: "Les processus sont gérés et contrôlés à l'aide de métriques détaillées. Des objectifs d'amélioration des processus sont établis et suivis.",
    },
    characteristics: {
      en: "Quantitatively managed, improvement targets, proactive approach",
      fr: "Géré quantitativement, objectifs d'amélioration, approche proactive",
    },
    scoreValue: 4,
    scoreRange: [61, 80],
    color: "blue",
    bgColor: "bg-blue-100 dark:bg-blue-900/30",
    textColor: "text-blue-700 dark:text-blue-400",
    borderColor: "border-blue-500",
  },
  E: {
    label: {
      en: "Level E - Optimizing/Leading",
      fr: "Niveau E - Optimisation/Leader",
    },
    description: {
      en: "Focus is on continuous process improvement and industry leadership. Best practices are shared and innovation is encouraged.",
      fr: "L'accent est mis sur l'amélioration continue des processus et le leadership industriel. Les meilleures pratiques sont partagées et l'innovation est encouragée.",
    },
    characteristics: {
      en: "Continuous improvement, industry leadership, best practices shared",
      fr: "Amélioration continue, leadership industriel, meilleures pratiques partagées",
    },
    scoreValue: 5,
    scoreRange: [81, 100],
    color: "green",
    bgColor: "bg-green-100 dark:bg-green-900/30",
    textColor: "text-green-700 dark:text-green-400",
    borderColor: "border-green-500",
  },
};

// =============================================================================
// EVIDENCE TYPE CONFIGURATION
// =============================================================================

export interface EvidenceTypeConfig {
  label: BilingualLabel;
  description: BilingualDescription;
  examples: string[];
  icon: string;
  acceptedFileTypes?: string[];
}

export const EVIDENCE_TYPES: Record<EvidenceType, EvidenceTypeConfig> = {
  DOCUMENT: {
    label: {
      en: "Document",
      fr: "Document",
    },
    description: {
      en: "Official policies, procedures, manuals, and formal documentation",
      fr: "Politiques officielles, procédures, manuels et documentation formelle",
    },
    examples: [
      "Safety Policy",
      "Operations Manual",
      "SMS Manual",
      "Quality Manual",
      "Standard Operating Procedures",
    ],
    icon: "FileText",
    acceptedFileTypes: [".pdf", ".doc", ".docx"],
  },
  PROCEDURE: {
    label: {
      en: "Procedure",
      fr: "Procédure",
    },
    description: {
      en: "Documented procedures, work instructions, and process flows",
      fr: "Procédures documentées, instructions de travail et flux de processus",
    },
    examples: [
      "Risk Assessment Procedure",
      "Incident Reporting Procedure",
      "Change Management Procedure",
      "Hazard Identification Process",
    ],
    icon: "ListChecks",
    acceptedFileTypes: [".pdf", ".doc", ".docx"],
  },
  RECORD: {
    label: {
      en: "Record",
      fr: "Enregistrement",
    },
    description: {
      en: "Evidence of activities performed, including reports and meeting records",
      fr: "Preuves des activités réalisées, y compris les rapports et les comptes rendus de réunions",
    },
    examples: [
      "Training Records",
      "Audit Reports",
      "Safety Meeting Minutes",
      "Risk Register",
      "Incident Reports",
    ],
    icon: "Database",
    acceptedFileTypes: [".pdf", ".xls", ".xlsx", ".doc", ".docx"],
  },
  INTERVIEW: {
    label: {
      en: "Interview",
      fr: "Entretien",
    },
    description: {
      en: "Information obtained through interviews with personnel",
      fr: "Informations obtenues lors d'entretiens avec le personnel",
    },
    examples: [
      "Staff Interviews",
      "Management Discussions",
      "Focus Group Sessions",
      "Expert Consultations",
    ],
    icon: "Users",
    acceptedFileTypes: [".pdf", ".doc", ".docx", ".mp3", ".mp4"],
  },
  OBSERVATION: {
    label: {
      en: "Observation",
      fr: "Observation",
    },
    description: {
      en: "Direct observation of activities, facilities, and processes",
      fr: "Observation directe des activités, des installations et des processus",
    },
    examples: [
      "Facility Tour Notes",
      "Process Observation Reports",
      "Safety Walk Notes",
      "Equipment Inspection",
    ],
    icon: "Eye",
    acceptedFileTypes: [".pdf", ".doc", ".docx", ".jpg", ".png"],
  },
  OTHER: {
    label: {
      en: "Other",
      fr: "Autre",
    },
    description: {
      en: "Other types of evidence not covered by specific categories",
      fr: "Autres types de preuves non couverts par les catégories spécifiques",
    },
    examples: [
      "Photos",
      "Screenshots",
      "External Reports",
      "Third-party Certifications",
      "Industry Benchmarks",
    ],
    icon: "File",
    acceptedFileTypes: [".pdf", ".doc", ".docx", ".jpg", ".png", ".zip"],
  },
};

// =============================================================================
// SCORING CONSTANTS
// =============================================================================

/**
 * SMS Component weights for overall maturity calculation
 * Based on CANSO SoE methodology
 */
export const SMS_COMPONENT_WEIGHTS = {
  SAFETY_POLICY_OBJECTIVES: 0.25,
  SAFETY_RISK_MANAGEMENT: 0.30,
  SAFETY_ASSURANCE: 0.25,
  SAFETY_PROMOTION: 0.20,
} as const;

/**
 * EI Score thresholds for categorization
 */
export const EI_SCORE_THRESHOLDS = {
  EXCELLENT: { min: 90, label: { en: "Excellent", fr: "Excellent" } },
  GOOD: { min: 75, label: { en: "Good", fr: "Bon" } },
  SATISFACTORY: { min: 60, label: { en: "Satisfactory", fr: "Satisfaisant" } },
  NEEDS_IMPROVEMENT: { min: 40, label: { en: "Needs Improvement", fr: "À améliorer" } },
  CRITICAL: { min: 0, label: { en: "Critical", fr: "Critique" } },
} as const;

/**
 * Minimum completion requirements for submission
 */
export const SUBMISSION_REQUIREMENTS = {
  ANS_USOAP_CMA: {
    minAnsweredPercentage: 100, // All questions must be answered
    minEvidencePercentage: 80,  // At least 80% with evidence
    maxNotReviewed: 0,          // No NR allowed
  },
  SMS_CANSO_SOE: {
    minAnsweredPercentage: 100,
    minEvidencePercentage: 75,
    maxNotReviewed: 0,
  },
} as const;

// =============================================================================
// HELPER FUNCTIONS
// =============================================================================

/**
 * Get assessment status array sorted by workflow order
 */
export function getAssessmentStatusArray() {
  return Object.entries(ASSESSMENT_STATUSES)
    .map(([code, config]) => ({
      code: code as AssessmentStatus,
      ...config,
    }))
    .sort((a, b) => a.sortOrder - b.sortOrder);
}

/**
 * Get assessment types array
 */
export function getAssessmentTypesArray() {
  return Object.entries(ASSESSMENT_TYPES).map(([code, config]) => ({
    code: code as AssessmentType,
    ...config,
  }));
}

/**
 * Get ANS response values array
 */
export function getANSResponseValuesArray() {
  return Object.entries(ANS_RESPONSE_VALUES).map(([code, config]) => ({
    code: code as ANSResponseValue,
    ...config,
  }));
}

/**
 * Get SMS maturity levels array sorted by score
 */
export function getSMSMaturityLevelsArray() {
  return Object.entries(SMS_MATURITY_LEVELS)
    .map(([code, config]) => ({
      code: code as NonNullable<SMSMaturityLevel>,
      ...config,
    }))
    .sort((a, b) => a.scoreValue - b.scoreValue);
}

/**
 * Get evidence types array
 */
export function getEvidenceTypesArray() {
  return Object.entries(EVIDENCE_TYPES).map(([code, config]) => ({
    code: code as EvidenceType,
    ...config,
  }));
}

/**
 * Check if status transition is allowed
 */
export function isStatusTransitionAllowed(
  currentStatus: AssessmentStatus,
  targetStatus: AssessmentStatus
): boolean {
  return ASSESSMENT_STATUSES[currentStatus].allowedTransitions.includes(targetStatus);
}

/**
 * Get maturity level from numeric score (1-5)
 */
export function getMaturityLevelFromScore(score: number): SMSMaturityLevel {
  if (score >= 4.5) return "E";
  if (score >= 3.5) return "D";
  if (score >= 2.5) return "C";
  if (score >= 1.5) return "B";
  return "A";
}

/**
 * Get EI score category from percentage
 */
export function getEIScoreCategory(eiScore: number): keyof typeof EI_SCORE_THRESHOLDS {
  if (eiScore >= EI_SCORE_THRESHOLDS.EXCELLENT.min) return "EXCELLENT";
  if (eiScore >= EI_SCORE_THRESHOLDS.GOOD.min) return "GOOD";
  if (eiScore >= EI_SCORE_THRESHOLDS.SATISFACTORY.min) return "SATISFACTORY";
  if (eiScore >= EI_SCORE_THRESHOLDS.NEEDS_IMPROVEMENT.min) return "NEEDS_IMPROVEMENT";
  return "CRITICAL";
}

/**
 * Calculate weighted SMS score from component scores
 */
export function calculateWeightedSMSScore(
  componentScores: Partial<Record<keyof typeof SMS_COMPONENT_WEIGHTS, number>>
): number {
  let totalWeight = 0;
  let weightedSum = 0;

  for (const [component, weight] of Object.entries(SMS_COMPONENT_WEIGHTS)) {
    const score = componentScores[component as keyof typeof SMS_COMPONENT_WEIGHTS];
    if (score !== undefined) {
      weightedSum += score * weight;
      totalWeight += weight;
    }
  }

  return totalWeight > 0 ? weightedSum / totalWeight : 0;
}

```

# src/lib/assessment/index.ts

```ts
/**
 * Self-Assessment Module - Barrel Export
 *
 * Centralizes exports for the assessment system
 */

// Types
export * from "./types";

// Zod Schemas
export * from "./schemas";

// Constants
export * from "./constants";

// Scoring utilities
export {
  calculateEIScore,
  calculateSimpleEIScore,
  calculateSMSMaturity,
  maturityLevelToScore,
  getLowestMaturityLevel,
  calculateCategoryScores,
  compareScores,
  identifyImprovementAreas,
  validateAssessmentForSubmission,
} from "./scoring";

// Progress utilities
export {
  calculateProgress,
  estimateRemainingTime,
  calculateAverageTimePerQuestion,
  getProgressStatusLabel,
  getProgressColor,
  canSubmitAssessment,
} from "./progress";

```

# src/lib/assessment/progress.ts

```ts
/**
 * Self-Assessment Module - Progress Tracking Utilities
 *
 * Provides utilities for calculating and tracking assessment progress
 */

import type {
  AssessmentProgress,
  AssessmentResponse,
  AssessmentResponseWithQuestion,
  CategoryProgress,
  ElementProgress,
} from "./types";
import { maturityLevelToScore } from "./scoring";
import { getMaturityLevelFromScore } from "./constants";
import type { QuestionnaireType } from "@prisma/client";

// =============================================================================
// PROGRESS CALCULATION
// =============================================================================

/**
 * Calculate overall assessment progress
 */
export function calculateProgress(
  responses: AssessmentResponseWithQuestion[],
  totalQuestions: number,
  questionnaireType: QuestionnaireType
): AssessmentProgress {
  // Count answered and completed questions
  let answeredQuestions = 0;
  let completedQuestions = 0;
  let skippedQuestions = 0;

  for (const response of responses) {
    const hasResponse = questionnaireType === "ANS_USOAP_CMA"
      ? response.responseValue !== null && response.responseValue !== "NOT_REVIEWED"
      : response.maturityLevel !== null;

    if (hasResponse) {
      answeredQuestions++;

      // Check if N/A (skipped)
      if (response.responseValue === "NOT_APPLICABLE") {
        skippedQuestions++;
      }

      // Check if complete (has evidence)
      if (response.isComplete ||
          (response.evidenceDescription && response.evidenceDescription.length > 0) ||
          response.evidenceUrls.length > 0) {
        completedQuestions++;
      }
    }
  }

  const percentComplete = totalQuestions > 0
    ? Math.round((completedQuestions / totalQuestions) * 100)
    : 0;

  const percentAnswered = totalQuestions > 0
    ? Math.round((answeredQuestions / totalQuestions) * 100)
    : 0;

  // Calculate category progress
  const categoryProgress = calculateCategoryProgress(responses, questionnaireType);

  // Calculate element progress (audit areas for ANS, components for SMS)
  const elementProgress = calculateElementProgress(responses, questionnaireType);

  // Find last activity
  const lastActivityAt = responses.length > 0
    ? new Date(Math.max(...responses.map((r) => new Date(r.respondedAt).getTime())))
    : undefined;

  return {
    assessmentId: responses[0]?.assessmentId ?? "",
    questionnaireType,
    totalQuestions,
    answeredQuestions,
    completedQuestions,
    skippedQuestions,
    percentComplete,
    percentAnswered,
    categoryProgress,
    elementProgress,
    lastActivityAt,
  };
}

/**
 * Calculate progress by category
 */
function calculateCategoryProgress(
  responses: AssessmentResponseWithQuestion[],
  questionnaireType: QuestionnaireType
): CategoryProgress[] {
  // Group responses by category
  const categoryGroups: Record<string, {
    responses: AssessmentResponseWithQuestion[];
    name: string;
  }> = {};

  for (const response of responses) {
    // Determine category based on questionnaire type
    let categoryId: string | null = null;
    let categoryName = "";

    if (questionnaireType === "ANS_USOAP_CMA" && response.question.auditArea) {
      categoryId = response.question.auditArea;
      categoryName = response.question.auditArea;
    } else if (questionnaireType === "SMS_CANSO_SOE" && response.question.smsComponent) {
      categoryId = response.question.smsComponent;
      categoryName = formatComponentName(response.question.smsComponent);
    }

    if (categoryId) {
      if (!categoryGroups[categoryId]) {
        categoryGroups[categoryId] = {
          responses: [],
          name: categoryName,
        };
      }
      categoryGroups[categoryId].responses.push(response);
    }
  }

  // Calculate progress for each category
  const progress: CategoryProgress[] = [];

  for (const [categoryId, { responses: catResponses, name }] of Object.entries(categoryGroups)) {
    const total = catResponses.length;
    let answered = 0;
    let completed = 0;

    for (const response of catResponses) {
      const hasResponse = questionnaireType === "ANS_USOAP_CMA"
        ? response.responseValue !== null && response.responseValue !== "NOT_REVIEWED"
        : response.maturityLevel !== null;

      if (hasResponse) {
        answered++;
        if (response.isComplete ||
            (response.evidenceDescription && response.evidenceDescription.length > 0)) {
          completed++;
        }
      }
    }

    progress.push({
      categoryId,
      categoryCode: categoryId,
      categoryName: name,
      total,
      answered,
      completed,
      percentComplete: total > 0 ? Math.round((completed / total) * 100) : 0,
    });
  }

  return progress.sort((a, b) => a.categoryCode.localeCompare(b.categoryCode));
}

/**
 * Calculate progress by element (audit area for ANS, component for SMS)
 */
function calculateElementProgress(
  responses: AssessmentResponseWithQuestion[],
  questionnaireType: QuestionnaireType
): ElementProgress[] {
  if (questionnaireType === "ANS_USOAP_CMA") {
    return calculateANSElementProgress(responses);
  }
  return calculateSMSElementProgress(responses);
}

/**
 * Calculate ANS audit area progress
 */
function calculateANSElementProgress(
  responses: AssessmentResponseWithQuestion[]
): ElementProgress[] {
  // Group by audit area
  const auditAreaGroups: Record<string, AssessmentResponseWithQuestion[]> = {};

  for (const response of responses) {
    const auditArea = response.question.auditArea;
    if (auditArea) {
      if (!auditAreaGroups[auditArea]) {
        auditAreaGroups[auditArea] = [];
      }
      auditAreaGroups[auditArea].push(response);
    }
  }

  const progress: ElementProgress[] = [];

  for (const [element, elementResponses] of Object.entries(auditAreaGroups)) {
    const total = elementResponses.length;
    let answered = 0;
    let completed = 0;
    let satisfactoryCount = 0;
    let notSatisfactoryCount = 0;
    let notApplicableCount = 0;

    for (const response of elementResponses) {
      if (response.responseValue && response.responseValue !== "NOT_REVIEWED") {
        answered++;

        switch (response.responseValue) {
          case "SATISFACTORY":
            satisfactoryCount++;
            break;
          case "NOT_SATISFACTORY":
            notSatisfactoryCount++;
            break;
          case "NOT_APPLICABLE":
            notApplicableCount++;
            break;
        }

        if (response.isComplete ||
            (response.evidenceDescription && response.evidenceDescription.length > 0)) {
          completed++;
        }
      }
    }

    // Calculate EI score for this area
    const applicable = satisfactoryCount + notSatisfactoryCount;
    const eiScore = applicable > 0
      ? Math.round((satisfactoryCount / applicable) * 100)
      : 0;

    progress.push({
      element,
      elementName: element,
      total,
      answered,
      completed,
      satisfactoryCount,
      notSatisfactoryCount,
      notApplicableCount,
      eiScore,
    });
  }

  return progress.sort((a, b) => a.element.localeCompare(b.element));
}

/**
 * Calculate SMS component progress
 */
function calculateSMSElementProgress(
  responses: AssessmentResponseWithQuestion[]
): ElementProgress[] {
  // Group by SMS component
  const componentGroups: Record<string, AssessmentResponseWithQuestion[]> = {};

  for (const response of responses) {
    const component = response.question.smsComponent;
    if (component) {
      if (!componentGroups[component]) {
        componentGroups[component] = [];
      }
      componentGroups[component].push(response);
    }
  }

  const progress: ElementProgress[] = [];

  for (const [element, elementResponses] of Object.entries(componentGroups)) {
    const total = elementResponses.length;
    let answered = 0;
    let completed = 0;
    const maturityDistribution: Record<string, number> = {
      A: 0, B: 0, C: 0, D: 0, E: 0,
    };
    const scores: number[] = [];

    for (const response of elementResponses) {
      if (response.maturityLevel !== null) {
        answered++;
        maturityDistribution[response.maturityLevel]++;
        scores.push(maturityLevelToScore(response.maturityLevel));

        if (response.isComplete ||
            (response.evidenceDescription && response.evidenceDescription.length > 0)) {
          completed++;
        }
      }
    }

    // Calculate average maturity
    const averageMaturity = scores.length > 0
      ? scores.reduce((a, b) => a + b, 0) / scores.length
      : 0;

    progress.push({
      element,
      elementName: formatComponentName(element),
      total,
      answered,
      completed,
      maturityDistribution,
      averageMaturity: Math.round(averageMaturity * 100) / 100,
      maturityLevel: scores.length > 0 ? getMaturityLevelFromScore(averageMaturity) : null,
    });
  }

  // Sort by component number
  const componentOrder = [
    "SAFETY_POLICY_OBJECTIVES",
    "SAFETY_RISK_MANAGEMENT",
    "SAFETY_ASSURANCE",
    "SAFETY_PROMOTION",
  ];
  return progress.sort((a, b) =>
    componentOrder.indexOf(a.element) - componentOrder.indexOf(b.element)
  );
}

// =============================================================================
// TIME ESTIMATION
// =============================================================================

/**
 * Estimate remaining time to complete assessment
 */
export function estimateRemainingTime(
  responses: AssessmentResponse[],
  totalQuestions: number,
  averageMinutesPerQuestion: number = 5
): {
  estimatedMinutes: number;
  estimatedHours: number;
  formatted: string;
} {
  const answeredCount = responses.filter(
    (r) => r.responseValue !== null || r.maturityLevel !== null
  ).length;

  const remainingQuestions = totalQuestions - answeredCount;
  const estimatedMinutes = remainingQuestions * averageMinutesPerQuestion;
  const estimatedHours = Math.round((estimatedMinutes / 60) * 10) / 10;

  let formatted: string;
  if (estimatedMinutes < 60) {
    formatted = `${estimatedMinutes} minutes`;
  } else if (estimatedMinutes < 120) {
    formatted = `1 hour ${estimatedMinutes - 60} minutes`;
  } else {
    formatted = `${estimatedHours} hours`;
  }

  return {
    estimatedMinutes,
    estimatedHours,
    formatted,
  };
}

/**
 * Calculate average time per question from response history
 */
export function calculateAverageTimePerQuestion(
  responses: AssessmentResponse[]
): number {
  if (responses.length < 2) return 5; // Default 5 minutes

  // Sort by response time
  const sortedResponses = [...responses]
    .filter((r) => r.respondedAt)
    .sort((a, b) => new Date(a.respondedAt).getTime() - new Date(b.respondedAt).getTime());

  if (sortedResponses.length < 2) return 5;

  // Calculate time differences between consecutive responses
  const timeDiffs: number[] = [];
  for (let i = 1; i < sortedResponses.length; i++) {
    const diff = new Date(sortedResponses[i].respondedAt).getTime() -
                 new Date(sortedResponses[i - 1].respondedAt).getTime();
    // Only count reasonable differences (between 30 seconds and 30 minutes)
    const diffMinutes = diff / (1000 * 60);
    if (diffMinutes >= 0.5 && diffMinutes <= 30) {
      timeDiffs.push(diffMinutes);
    }
  }

  if (timeDiffs.length === 0) return 5;

  // Return average, rounded to 1 decimal
  const average = timeDiffs.reduce((a, b) => a + b, 0) / timeDiffs.length;
  return Math.round(average * 10) / 10;
}

// =============================================================================
// UTILITY FUNCTIONS
// =============================================================================

/**
 * Format SMS component name for display
 */
function formatComponentName(component: string): string {
  const names: Record<string, string> = {
    SAFETY_POLICY_OBJECTIVES: "Safety Policy & Objectives",
    SAFETY_RISK_MANAGEMENT: "Safety Risk Management",
    SAFETY_ASSURANCE: "Safety Assurance",
    SAFETY_PROMOTION: "Safety Promotion",
  };
  return names[component] || component;
}

/**
 * Get progress status label
 */
export function getProgressStatusLabel(
  percentComplete: number,
  locale: "en" | "fr" = "en"
): string {
  if (percentComplete === 0) {
    return locale === "en" ? "Not Started" : "Non commencé";
  }
  if (percentComplete < 25) {
    return locale === "en" ? "Just Started" : "Tout juste commencé";
  }
  if (percentComplete < 50) {
    return locale === "en" ? "In Progress" : "En cours";
  }
  if (percentComplete < 75) {
    return locale === "en" ? "Halfway Complete" : "À moitié terminé";
  }
  if (percentComplete < 100) {
    return locale === "en" ? "Almost Complete" : "Presque terminé";
  }
  return locale === "en" ? "Complete" : "Terminé";
}

/**
 * Get progress color based on percentage
 */
export function getProgressColor(percentComplete: number): string {
  if (percentComplete === 0) return "gray";
  if (percentComplete < 25) return "red";
  if (percentComplete < 50) return "orange";
  if (percentComplete < 75) return "yellow";
  if (percentComplete < 100) return "blue";
  return "green";
}

/**
 * Check if assessment can be submitted
 */
export function canSubmitAssessment(progress: AssessmentProgress): {
  canSubmit: boolean;
  blockers: string[];
  warnings: string[];
} {
  const blockers: string[] = [];
  const warnings: string[] = [];

  // Must have all questions answered
  if (progress.percentAnswered < 100) {
    blockers.push(
      `${progress.totalQuestions - progress.answeredQuestions} questions still need to be answered`
    );
  }

  // Should have evidence for most questions
  if (progress.percentComplete < 75) {
    warnings.push(
      `Only ${progress.percentComplete}% of questions have supporting evidence`
    );
  }

  // Check for any incomplete categories
  const incompleteCategories = progress.categoryProgress.filter(
    (c) => c.answered < c.total
  );
  if (incompleteCategories.length > 0) {
    blockers.push(
      `${incompleteCategories.length} categories have unanswered questions`
    );
  }

  return {
    canSubmit: blockers.length === 0,
    blockers,
    warnings,
  };
}

```

# src/lib/assessment/schemas.ts

```ts
/**
 * Self-Assessment Module - Zod Validation Schemas
 *
 * Provides runtime validation for assessment data, aligned with:
 * - ICAO USOAP CMA methodology for ANS assessments
 * - CANSO Standard of Excellence (SoE) for SMS assessments
 */

import { z } from "zod";

// =============================================================================
// ENUM SCHEMAS
// =============================================================================

export const AssessmentStatusSchema = z.enum([
  "DRAFT",
  "IN_PROGRESS",
  "SUBMITTED",
  "UNDER_REVIEW",
  "COMPLETED",
  "ARCHIVED",
]);

export const AssessmentTypeSchema = z.enum([
  "SELF_ASSESSMENT",
  "GAP_ANALYSIS",
  "PRE_REVIEW",
  "MOCK_REVIEW",
]);

export const ANSResponseValueSchema = z.enum([
  "SATISFACTORY",
  "NOT_SATISFACTORY",
  "NOT_APPLICABLE",
  "NOT_REVIEWED",
]);

export const SMSMaturityLevelSchema = z.enum(["A", "B", "C", "D", "E"]).nullable();

export const EvidenceTypeSchema = z.enum([
  "DOCUMENT",
  "PROCEDURE",
  "RECORD",
  "INTERVIEW",
  "OBSERVATION",
  "OTHER",
]);

export const QuestionnaireTypeSchema = z.enum([
  "ANS_USOAP_CMA",
  "SMS_CANSO_SOE",
]);

// =============================================================================
// ASSESSMENT SCHEMAS
// =============================================================================

/**
 * Schema for creating a new assessment
 * Note: organizationId is obtained from the session, not from the client
 */
export const CreateAssessmentSchema = z.object({
  // Either questionnaireId OR questionnaireType (API resolves the other)
  questionnaireId: z.string().cuid().optional(),
  questionnaireType: z.enum(["ANS_USOAP_CMA", "SMS_CANSO_SOE"]).optional(),
  assessmentType: AssessmentTypeSchema,
  title: z
    .string()
    .min(3, "Title must be at least 3 characters")
    .max(200, "Title must be less than 200 characters"),
  description: z
    .string()
    .max(2000, "Description must be less than 2000 characters")
    .optional(),
  dueDate: z.coerce.date().optional(),
  scope: z.array(z.string()).optional(), // Audit areas or SMS components
}).refine(
  (data) => data.questionnaireId || data.questionnaireType,
  { message: "Either questionnaireId or questionnaireType is required" }
);

export type CreateAssessmentInput = z.infer<typeof CreateAssessmentSchema>;

/**
 * Schema for updating an assessment
 */
export const UpdateAssessmentSchema = z.object({
  id: z.string().cuid(),
  title: z
    .string()
    .min(3, "Title must be at least 3 characters")
    .max(200, "Title must be less than 200 characters")
    .optional(),
  description: z
    .string()
    .max(2000, "Description must be less than 2000 characters")
    .optional(),
  dueDate: z.coerce.date().optional().nullable(),
});

export type UpdateAssessmentInput = z.infer<typeof UpdateAssessmentSchema>;

/**
 * Schema for changing assessment status
 */
export const UpdateAssessmentStatusSchema = z.object({
  id: z.string().cuid(),
  status: AssessmentStatusSchema,
  comments: z.string().max(500).optional(),
});

export type UpdateAssessmentStatusInput = z.infer<typeof UpdateAssessmentStatusSchema>;

/**
 * Schema for submitting/completing an assessment
 */
export const SubmitAssessmentSchema = z.object({
  id: z.string().cuid(),
  finalComments: z.string().max(2000).optional(),
  confirmComplete: z.boolean().refine((val) => val === true, {
    message: "You must confirm the assessment is complete",
  }),
});

export type SubmitAssessmentInput = z.infer<typeof SubmitAssessmentSchema>;

// =============================================================================
// RESPONSE SCHEMAS
// =============================================================================

/**
 * Base schema for ANS response
 */
export const ANSResponseSchema = z.object({
  responseValue: ANSResponseValueSchema,
  evidenceDescription: z.string().max(2000).optional(),
  assessorComments: z.string().max(2000).optional(),
  internalNotes: z.string().max(2000).optional(),
});

/**
 * Base schema for SMS response
 */
export const SMSResponseSchema = z.object({
  maturityLevel: SMSMaturityLevelSchema,
  evidenceDescription: z.string().max(2000).optional(),
  assessorComments: z.string().max(2000).optional(),
  internalNotes: z.string().max(2000).optional(),
});

/**
 * Schema for submitting a single response
 */
export const SubmitResponseSchema = z
  .object({
    assessmentId: z.string().cuid(),
    questionId: z.string().cuid(),
    questionnaireType: QuestionnaireTypeSchema,

    // ANS fields
    responseValue: ANSResponseValueSchema.optional().nullable(),

    // SMS fields
    maturityLevel: SMSMaturityLevelSchema.optional(),

    // Common fields
    evidenceDescription: z.string().max(2000).optional(),
    assessorComments: z.string().max(2000).optional(),
    internalNotes: z.string().max(2000).optional(),
    needsReview: z.boolean().default(false),
  })
  .refine(
    (data) => {
      // ANS assessments require responseValue
      if (data.questionnaireType === "ANS_USOAP_CMA") {
        return data.responseValue !== undefined;
      }
      // SMS assessments require maturityLevel
      if (data.questionnaireType === "SMS_CANSO_SOE") {
        return data.maturityLevel !== undefined;
      }
      return true;
    },
    {
      message: "Response value or maturity level required based on questionnaire type",
    }
  );

export type SubmitResponseInput = z.infer<typeof SubmitResponseSchema>;

/**
 * Schema for bulk response update
 */
export const BulkResponseUpdateSchema = z.object({
  assessmentId: z.string().cuid(),
  questionnaireType: QuestionnaireTypeSchema,
  responses: z
    .array(
      z.object({
        questionId: z.string().cuid(),
        responseValue: ANSResponseValueSchema.optional().nullable(),
        maturityLevel: SMSMaturityLevelSchema.optional(),
      })
    )
    .min(1, "At least one response is required")
    .max(100, "Maximum 100 responses per batch"),
});

export type BulkResponseUpdateInput = z.infer<typeof BulkResponseUpdateSchema>;

/**
 * Schema for marking response as complete
 */
export const CompleteResponseSchema = z.object({
  responseId: z.string().cuid(),
  isComplete: z.boolean(),
  verificationNotes: z.string().max(500).optional(),
});

export type CompleteResponseInput = z.infer<typeof CompleteResponseSchema>;

// =============================================================================
// EVIDENCE SCHEMAS
// =============================================================================

/**
 * Schema for uploading evidence
 */
export const UploadEvidenceSchema = z
  .object({
    responseId: z.string().cuid(),
    type: EvidenceTypeSchema,
    title: z
      .string()
      .min(3, "Title must be at least 3 characters")
      .max(200, "Title must be less than 200 characters"),
    description: z.string().max(1000).optional(),
    documentReference: z.string().max(100).optional(),
    icaoReference: z.string().max(100).optional(),
    externalUrl: z.string().url().optional(),
    validFrom: z.coerce.date().optional(),
    validUntil: z.coerce.date().optional(),
  })
  .refine(
    (data) => {
      // If validUntil is provided, it must be after validFrom
      if (data.validFrom && data.validUntil) {
        return data.validUntil > data.validFrom;
      }
      return true;
    },
    {
      message: "Valid until date must be after valid from date",
      path: ["validUntil"],
    }
  );

export type UploadEvidenceInput = z.infer<typeof UploadEvidenceSchema>;

/**
 * Schema for updating evidence
 */
export const UpdateEvidenceSchema = z.object({
  id: z.string().cuid(),
  title: z.string().min(3).max(200).optional(),
  description: z.string().max(1000).optional(),
  type: EvidenceTypeSchema.optional(),
  documentReference: z.string().max(100).optional(),
  icaoReference: z.string().max(100).optional(),
  isVerified: z.boolean().optional(),
});

export type UpdateEvidenceInput = z.infer<typeof UpdateEvidenceSchema>;

/**
 * Schema for deleting evidence
 */
export const DeleteEvidenceSchema = z.object({
  id: z.string().cuid(),
  reason: z.string().max(500).optional(),
});

export type DeleteEvidenceInput = z.infer<typeof DeleteEvidenceSchema>;

// =============================================================================
// FILTER SCHEMAS
// =============================================================================

/**
 * Schema for filtering assessments
 */
export const AssessmentFilterSchema = z.object({
  organizationId: z.string().cuid().optional(),
  questionnaireId: z.string().cuid().optional(),
  questionnaireType: QuestionnaireTypeSchema.optional(),
  assessmentType: AssessmentTypeSchema.optional(),
  status: z
    .union([AssessmentStatusSchema, z.array(AssessmentStatusSchema)])
    .optional(),
  createdById: z.string().cuid().optional(),

  // Date filters
  startedAfter: z.coerce.date().optional(),
  startedBefore: z.coerce.date().optional(),
  dueAfter: z.coerce.date().optional(),
  dueBefore: z.coerce.date().optional(),

  // Score filters
  minScore: z.number().min(0).max(100).optional(),
  maxScore: z.number().min(0).max(100).optional(),

  // Search
  search: z.string().max(100).optional(),
});

export type AssessmentFilterInput = z.infer<typeof AssessmentFilterSchema>;

/**
 * Schema for filtering responses
 */
export const ResponseFilterSchema = z.object({
  assessmentId: z.string().cuid(),
  questionId: z.string().cuid().optional(),
  responseValue: ANSResponseValueSchema.optional(),
  maturityLevel: SMSMaturityLevelSchema.optional(),
  isComplete: z.boolean().optional(),
  needsReview: z.boolean().optional(),

  // ANS filters
  auditArea: z
    .enum(["LEG", "ORG", "PEL", "OPS", "AIR", "AIG", "ANS", "AGA", "SSP"])
    .optional(),
  criticalElement: z
    .enum(["CE_1", "CE_2", "CE_3", "CE_4", "CE_5", "CE_6", "CE_7", "CE_8"])
    .optional(),
  isPriorityPQ: z.boolean().optional(),

  // SMS filters
  smsComponent: z
    .enum([
      "SAFETY_POLICY_OBJECTIVES",
      "SAFETY_RISK_MANAGEMENT",
      "SAFETY_ASSURANCE",
      "SAFETY_PROMOTION",
    ])
    .optional(),
  studyArea: z
    .enum([
      "SA_1_1", "SA_1_2", "SA_1_3", "SA_1_4", "SA_1_5",
      "SA_2_1", "SA_2_2",
      "SA_3_1", "SA_3_2", "SA_3_3",
      "SA_4_1", "SA_4_2",
    ])
    .optional(),
});

export type ResponseFilterInput = z.infer<typeof ResponseFilterSchema>;

// =============================================================================
// SCORING SCHEMAS
// =============================================================================

/**
 * Schema for score calculation request
 */
export const CalculateScoreSchema = z.object({
  assessmentId: z.string().cuid(),
  includeIncomplete: z.boolean().default(false),
  saveResults: z.boolean().default(true),
});

export type CalculateScoreInput = z.infer<typeof CalculateScoreSchema>;

/**
 * Schema for comparing assessments
 */
export const CompareAssessmentsSchema = z.object({
  assessmentIds: z
    .array(z.string().cuid())
    .min(2, "At least 2 assessments required for comparison")
    .max(5, "Maximum 5 assessments can be compared"),
});

export type CompareAssessmentsInput = z.infer<typeof CompareAssessmentsSchema>;

// =============================================================================
// PAGINATION SCHEMA
// =============================================================================

export const AssessmentPaginationSchema = z.object({
  page: z.coerce.number().int().positive().default(1),
  pageSize: z.coerce.number().int().min(1).max(100).default(20),
  sortBy: z
    .enum(["startedAt", "dueDate", "status", "title", "overallScore"])
    .default("startedAt"),
  sortOrder: z.enum(["asc", "desc"]).default("desc"),
});

export type AssessmentPaginationInput = z.infer<typeof AssessmentPaginationSchema>;

// =============================================================================
// EXPORT SCHEMAS
// =============================================================================

/**
 * Schema for exporting assessment data
 */
export const ExportAssessmentSchema = z.object({
  assessmentId: z.string().cuid(),
  format: z.enum(["pdf", "excel", "csv", "json"]).default("pdf"),
  includeEvidence: z.boolean().default(true),
  includeComments: z.boolean().default(true),
  includeScoring: z.boolean().default(true),
  language: z.enum(["en", "fr"]).default("en"),
});

export type ExportAssessmentInput = z.infer<typeof ExportAssessmentSchema>;

```

# src/lib/assessment/scoring.ts

```ts
/**
 * Self-Assessment Module - Score Calculation Utilities
 *
 * Implements scoring methodologies aligned with:
 * - ICAO USOAP CMA for EI (Effective Implementation) calculation
 * - CANSO Standard of Excellence (SoE) for SMS maturity calculation
 */

import type {
  AssessmentResponse,
  AssessmentResponseWithQuestion,
  EIScoreResult,
  SMSMaturityResult,
  SMSMaturityLevel,
} from "./types";
import {
  SMS_COMPONENT_WEIGHTS,
  getMaturityLevelFromScore,
  SMS_MATURITY_LEVELS,
} from "./constants";
import type { USOAPAuditArea, CriticalElement, SMSComponent, CANSOStudyArea } from "@prisma/client";

// =============================================================================
// EI SCORE CALCULATION (USOAP CMA METHODOLOGY)
// =============================================================================

/**
 * Calculate EI (Effective Implementation) score
 *
 * Formula: EI = (Satisfactory / (Total - Not Applicable)) * 100
 *
 * Per ICAO USOAP CMA methodology:
 * - Satisfactory (S) = 1 point
 * - Not Satisfactory (NS) = 0 points
 * - Not Applicable (NA) = Excluded from calculation
 * - Not Reviewed (NR) = Excluded from calculation
 */
export function calculateEIScore(
  responses: AssessmentResponseWithQuestion[]
): EIScoreResult {
  // Initialize counters
  let satisfactoryCount = 0;
  let notSatisfactoryCount = 0;
  let notApplicableCount = 0;
  let notReviewedCount = 0;

  // Initialize audit area tracking
  const auditAreaScores: EIScoreResult["auditAreaScores"] = {} as EIScoreResult["auditAreaScores"];
  const criticalElementScores: EIScoreResult["criticalElementScores"] = {} as EIScoreResult["criticalElementScores"];

  // Process each response
  for (const response of responses) {
    const { responseValue, question } = response;
    const auditArea = question.auditArea;
    const criticalElement = question.criticalElement;

    // Count by response type
    switch (responseValue) {
      case "SATISFACTORY":
        satisfactoryCount++;
        break;
      case "NOT_SATISFACTORY":
        notSatisfactoryCount++;
        break;
      case "NOT_APPLICABLE":
        notApplicableCount++;
        break;
      case "NOT_REVIEWED":
      default:
        notReviewedCount++;
        break;
    }

    // Track by audit area
    if (auditArea) {
      if (!auditAreaScores[auditArea]) {
        auditAreaScores[auditArea] = {
          ei: 0,
          satisfactory: 0,
          notSatisfactory: 0,
          notApplicable: 0,
          total: 0,
        };
      }
      auditAreaScores[auditArea].total++;
      if (responseValue === "SATISFACTORY") {
        auditAreaScores[auditArea].satisfactory++;
      } else if (responseValue === "NOT_SATISFACTORY") {
        auditAreaScores[auditArea].notSatisfactory++;
      } else if (responseValue === "NOT_APPLICABLE") {
        auditAreaScores[auditArea].notApplicable++;
      }
    }

    // Track by critical element
    if (criticalElement) {
      if (!criticalElementScores[criticalElement]) {
        criticalElementScores[criticalElement] = {
          ei: 0,
          satisfactory: 0,
          notSatisfactory: 0,
          total: 0,
        };
      }
      criticalElementScores[criticalElement].total++;
      if (responseValue === "SATISFACTORY") {
        criticalElementScores[criticalElement].satisfactory++;
      } else if (responseValue === "NOT_SATISFACTORY") {
        criticalElementScores[criticalElement].notSatisfactory++;
      }
    }
  }

  // Calculate overall EI
  const totalApplicable = satisfactoryCount + notSatisfactoryCount;
  const overallEI = totalApplicable > 0
    ? Math.round((satisfactoryCount / totalApplicable) * 100 * 100) / 100
    : 0;

  // Calculate EI for each audit area
  for (const area of Object.keys(auditAreaScores) as USOAPAuditArea[]) {
    const scores = auditAreaScores[area];
    const applicable = scores.satisfactory + scores.notSatisfactory;
    scores.ei = applicable > 0
      ? Math.round((scores.satisfactory / applicable) * 100 * 100) / 100
      : 0;
  }

  // Calculate EI for each critical element
  for (const ce of Object.keys(criticalElementScores) as CriticalElement[]) {
    const scores = criticalElementScores[ce];
    const applicable = scores.satisfactory + scores.notSatisfactory;
    scores.ei = applicable > 0
      ? Math.round((scores.satisfactory / applicable) * 100 * 100) / 100
      : 0;
  }

  // Calculate priority PQ score if applicable
  const priorityResponses = responses.filter((r) => r.question.isPriorityPQ);
  let priorityPQScore: number | undefined;
  if (priorityResponses.length > 0) {
    const prioritySatisfactory = priorityResponses.filter(
      (r) => r.responseValue === "SATISFACTORY"
    ).length;
    const priorityApplicable = priorityResponses.filter(
      (r) => r.responseValue === "SATISFACTORY" || r.responseValue === "NOT_SATISFACTORY"
    ).length;
    priorityPQScore = priorityApplicable > 0
      ? Math.round((prioritySatisfactory / priorityApplicable) * 100 * 100) / 100
      : 0;
  }

  return {
    overallEI,
    totalApplicable,
    satisfactoryCount,
    notSatisfactoryCount,
    notApplicableCount,
    notReviewedCount,
    auditAreaScores,
    criticalElementScores,
    priorityPQScore,
  };
}

/**
 * Calculate EI score from simple response array (without question details)
 */
export function calculateSimpleEIScore(
  satisfactoryCount: number,
  notSatisfactoryCount: number
): number {
  const total = satisfactoryCount + notSatisfactoryCount;
  if (total === 0) return 0;
  return Math.round((satisfactoryCount / total) * 100 * 100) / 100;
}

// =============================================================================
// SMS MATURITY CALCULATION (CANSO SOE METHODOLOGY)
// =============================================================================

/**
 * Calculate SMS Maturity score
 *
 * Per CANSO SoE methodology:
 * - Each question is scored A(1) to E(5)
 * - Component score = weighted average of question scores
 * - Overall score = weighted average of component scores
 * - Overall level = lowest component level (per CANSO guidance)
 */
export function calculateSMSMaturity(
  responses: AssessmentResponseWithQuestion[]
): SMSMaturityResult {
  // Initialize component tracking
  const componentScores: SMSMaturityResult["componentLevels"] = {} as SMSMaturityResult["componentLevels"];
  const studyAreaScores: SMSMaturityResult["studyAreaLevels"] = {} as SMSMaturityResult["studyAreaLevels"];
  const maturityDistribution: Record<string, number> = {
    A: 0,
    B: 0,
    C: 0,
    D: 0,
    E: 0,
    null: 0,
  };

  // Group responses by component and study area
  const componentResponses: Record<string, AssessmentResponseWithQuestion[]> = {};
  const studyAreaResponses: Record<string, AssessmentResponseWithQuestion[]> = {};

  for (const response of responses) {
    const { maturityLevel, question } = response;
    const component = question.smsComponent;
    const studyArea = question.studyArea;

    // Count maturity distribution
    maturityDistribution[maturityLevel ?? "null"]++;

    // Group by component
    if (component) {
      if (!componentResponses[component]) {
        componentResponses[component] = [];
      }
      componentResponses[component].push(response);
    }

    // Group by study area
    if (studyArea) {
      if (!studyAreaResponses[studyArea]) {
        studyAreaResponses[studyArea] = [];
      }
      studyAreaResponses[studyArea].push(response);
    }
  }

  // Calculate component scores
  for (const component of Object.keys(componentResponses) as SMSComponent[]) {
    const compResponses = componentResponses[component];
    const scores = compResponses
      .filter((r) => r.maturityLevel !== null)
      .map((r) => maturityLevelToScore(r.maturityLevel!));

    const avgScore = scores.length > 0
      ? scores.reduce((a, b) => a + b, 0) / scores.length
      : 0;

    const weight = SMS_COMPONENT_WEIGHTS[component] || 0.25;

    componentScores[component] = {
      level: getMaturityLevelFromScore(avgScore),
      score: Math.round(avgScore * 100) / 100,
      weight,
      weightedScore: Math.round(avgScore * weight * 100) / 100,
      questionCount: compResponses.length,
    };
  }

  // Calculate study area scores
  for (const studyArea of Object.keys(studyAreaResponses) as CANSOStudyArea[]) {
    const saResponses = studyAreaResponses[studyArea];
    const scores = saResponses
      .filter((r) => r.maturityLevel !== null)
      .map((r) => maturityLevelToScore(r.maturityLevel!));

    const avgScore = scores.length > 0
      ? scores.reduce((a, b) => a + b, 0) / scores.length
      : 0;

    studyAreaScores[studyArea] = {
      level: getMaturityLevelFromScore(avgScore),
      score: Math.round(avgScore * 100) / 100,
      questionCount: saResponses.length,
    };
  }

  // Calculate overall weighted score
  let totalWeight = 0;
  let weightedSum = 0;
  for (const component of Object.keys(componentScores) as SMSComponent[]) {
    const compScore = componentScores[component];
    weightedSum += compScore.weightedScore;
    totalWeight += compScore.weight;
  }

  const overallScore = totalWeight > 0
    ? Math.round((weightedSum / totalWeight) * 100) / 100
    : 0;

  // Per CANSO guidance: overall level = lowest component level
  const componentLevels = Object.values(componentScores)
    .filter((c) => c.questionCount > 0)
    .map((c) => c.level);

  const overallLevel = componentLevels.length > 0
    ? getLowestMaturityLevel(componentLevels)
    : null;

  // Calculate overall percentage
  const overallPercentage = Math.round((overallScore / 5) * 100);

  // Identify gap areas (below Level C)
  const gapAreas: string[] = [];
  for (const [component, scores] of Object.entries(componentScores)) {
    if (scores.level && (scores.level === "A" || scores.level === "B")) {
      gapAreas.push(component);
    }
  }

  return {
    overallLevel,
    overallScore,
    overallPercentage,
    componentLevels: componentScores,
    studyAreaLevels: studyAreaScores,
    maturityDistribution,
    gapAreas,
  };
}

/**
 * Convert maturity level to numeric score
 */
export function maturityLevelToScore(level: NonNullable<SMSMaturityLevel>): number {
  return SMS_MATURITY_LEVELS[level].scoreValue;
}

/**
 * Get the lowest maturity level from an array
 */
export function getLowestMaturityLevel(
  levels: (SMSMaturityLevel | null)[]
): SMSMaturityLevel {
  const validLevels = levels.filter((l): l is NonNullable<SMSMaturityLevel> => l !== null);
  if (validLevels.length === 0) return null;

  const scoreOrder: NonNullable<SMSMaturityLevel>[] = ["A", "B", "C", "D", "E"];
  for (const level of scoreOrder) {
    if (validLevels.includes(level)) {
      return level;
    }
  }
  return validLevels[0];
}

// =============================================================================
// CATEGORY-LEVEL SCORING
// =============================================================================

/**
 * Calculate scores grouped by category
 */
export function calculateCategoryScores(
  responses: AssessmentResponseWithQuestion[],
  questionnaireType: "ANS_USOAP_CMA" | "SMS_CANSO_SOE"
): Record<string, number> {
  // Group responses by category (audit area for ANS, component for SMS)
  const categoryGroups: Record<string, AssessmentResponseWithQuestion[]> = {};

  for (const response of responses) {
    let category: string | null = null;

    if (questionnaireType === "ANS_USOAP_CMA") {
      category = response.question.auditArea ?? null;
    } else {
      category = response.question.smsComponent ?? null;
    }

    if (category) {
      if (!categoryGroups[category]) {
        categoryGroups[category] = [];
      }
      categoryGroups[category].push(response);
    }
  }

  // Calculate score for each category
  const categoryScores: Record<string, number> = {};

  for (const [category, catResponses] of Object.entries(categoryGroups)) {
    if (questionnaireType === "ANS_USOAP_CMA") {
      // EI score calculation
      const satisfactory = catResponses.filter(
        (r) => r.responseValue === "SATISFACTORY"
      ).length;
      const applicable = catResponses.filter(
        (r) => r.responseValue === "SATISFACTORY" || r.responseValue === "NOT_SATISFACTORY"
      ).length;
      categoryScores[category] = applicable > 0
        ? Math.round((satisfactory / applicable) * 100 * 100) / 100
        : 0;
    } else {
      // SMS maturity score calculation (1-5 scale converted to percentage)
      const scores = catResponses
        .filter((r) => r.maturityLevel !== null)
        .map((r) => maturityLevelToScore(r.maturityLevel as NonNullable<SMSMaturityLevel>));
      const avgScore = scores.length > 0
        ? scores.reduce((a, b) => a + b, 0) / scores.length
        : 0;
      categoryScores[category] = Math.round((avgScore / 5) * 100 * 100) / 100;
    }
  }

  return categoryScores;
}

// =============================================================================
// COMPARISON UTILITIES
// =============================================================================

/**
 * Compare two assessment scores and calculate delta
 */
export function compareScores(
  currentScore: number,
  previousScore: number
): {
  delta: number;
  percentageChange: number;
  trend: "IMPROVING" | "DECLINING" | "STABLE";
} {
  const delta = Math.round((currentScore - previousScore) * 100) / 100;
  const percentageChange = previousScore > 0
    ? Math.round((delta / previousScore) * 100 * 100) / 100
    : delta > 0 ? 100 : 0;

  let trend: "IMPROVING" | "DECLINING" | "STABLE";
  if (Math.abs(delta) < 1) {
    trend = "STABLE";
  } else if (delta > 0) {
    trend = "IMPROVING";
  } else {
    trend = "DECLINING";
  }

  return { delta, percentageChange, trend };
}

/**
 * Calculate improvement areas between assessments
 */
export function identifyImprovementAreas(
  currentScores: Record<string, number>,
  previousScores: Record<string, number>,
  threshold: number = 5
): {
  improved: string[];
  declined: string[];
  unchanged: string[];
} {
  const improved: string[] = [];
  const declined: string[] = [];
  const unchanged: string[] = [];

  const allCategories = new Set([
    ...Object.keys(currentScores),
    ...Object.keys(previousScores),
  ]);

  for (const category of allCategories) {
    const current = currentScores[category] ?? 0;
    const previous = previousScores[category] ?? 0;
    const delta = current - previous;

    if (delta >= threshold) {
      improved.push(category);
    } else if (delta <= -threshold) {
      declined.push(category);
    } else {
      unchanged.push(category);
    }
  }

  return { improved, declined, unchanged };
}

// =============================================================================
// VALIDATION UTILITIES
// =============================================================================

/**
 * Check if assessment meets submission requirements
 */
export function validateAssessmentForSubmission(
  responses: AssessmentResponse[],
  totalQuestions: number,
  questionnaireType: "ANS_USOAP_CMA" | "SMS_CANSO_SOE"
): {
  isValid: boolean;
  errors: string[];
  warnings: string[];
} {
  const errors: string[] = [];
  const warnings: string[] = [];

  // Count answered questions
  const answeredCount = responses.filter((r) => {
    if (questionnaireType === "ANS_USOAP_CMA") {
      return r.responseValue !== null && r.responseValue !== "NOT_REVIEWED";
    }
    return r.maturityLevel !== null;
  }).length;

  const answeredPercentage = (answeredCount / totalQuestions) * 100;

  // Check minimum answered requirement
  if (answeredPercentage < 100) {
    errors.push(
      `Only ${answeredCount} of ${totalQuestions} questions answered (${Math.round(answeredPercentage)}%). All questions must be answered.`
    );
  }

  // Count questions with evidence
  const withEvidenceCount = responses.filter(
    (r) => r.isComplete || (r.evidenceDescription && r.evidenceDescription.length > 0)
  ).length;
  const evidencePercentage = (withEvidenceCount / totalQuestions) * 100;

  // Check evidence requirement
  const minEvidence = questionnaireType === "ANS_USOAP_CMA" ? 80 : 75;
  if (evidencePercentage < minEvidence) {
    warnings.push(
      `Only ${Math.round(evidencePercentage)}% of questions have evidence. Recommended: at least ${minEvidence}%.`
    );
  }

  // Check for NOT_REVIEWED responses (ANS only)
  if (questionnaireType === "ANS_USOAP_CMA") {
    const notReviewedCount = responses.filter(
      (r) => r.responseValue === "NOT_REVIEWED"
    ).length;
    if (notReviewedCount > 0) {
      errors.push(
        `${notReviewedCount} questions are marked as "Not Reviewed". All questions must be assessed.`
      );
    }
  }

  return {
    isValid: errors.length === 0,
    errors,
    warnings,
  };
}

```

# src/lib/assessment/types.ts

```ts
/**
 * Self-Assessment Module - TypeScript Types
 *
 * Defines interfaces and types for the assessment system, aligned with:
 * - ICAO USOAP CMA methodology for ANS assessments
 * - CANSO Standard of Excellence (SoE) for SMS assessments
 */

import type { QuestionnaireType, SMSComponent, CANSOStudyArea, USOAPAuditArea, CriticalElement } from "@prisma/client";

// =============================================================================
// ENUMS & LITERAL TYPES
// =============================================================================

/**
 * Assessment status workflow
 * DRAFT → IN_PROGRESS → SUBMITTED → UNDER_REVIEW → COMPLETED → ARCHIVED
 */
export type AssessmentStatus =
  | "DRAFT"
  | "IN_PROGRESS"
  | "SUBMITTED"
  | "UNDER_REVIEW"
  | "COMPLETED"
  | "ARCHIVED";

/**
 * Assessment types for different use cases
 */
export type AssessmentType =
  | "SELF_ASSESSMENT"   // Organization self-evaluation
  | "GAP_ANALYSIS"      // Identify gaps before peer review
  | "PRE_REVIEW"        // Preparation for upcoming review
  | "MOCK_REVIEW";      // Practice/simulation review

/**
 * ANS Response values (USOAP CMA aligned)
 * Used for Protocol Questions in ANS USOAP CMA assessments
 */
export type ANSResponseValue =
  | "SATISFACTORY"      // S - Critical element implemented
  | "NOT_SATISFACTORY"  // NS - Not or partially implemented
  | "NOT_APPLICABLE"    // NA - Not applicable to State
  | "NOT_REVIEWED";     // NR - Not yet assessed

/**
 * SMS Maturity levels (CANSO SoE aligned)
 * 5-level maturity model for SMS assessments
 */
export type SMSMaturityLevel = "A" | "B" | "C" | "D" | "E" | null;

/**
 * Evidence types for supporting assessment responses
 */
export type EvidenceType =
  | "DOCUMENT"      // Policies, procedures, manuals
  | "PROCEDURE"     // Documented procedures, work instructions
  | "RECORD"        // Training records, audit reports, minutes
  | "INTERVIEW"     // Staff interviews, management discussions
  | "OBSERVATION"   // Facility tours, process observations
  | "OTHER";        // Photos, screenshots, external reports

// =============================================================================
// CORE INTERFACES
// =============================================================================

/**
 * Main Assessment entity
 * Represents a complete self-assessment or gap analysis
 */
export interface Assessment {
  id: string;
  organizationId: string;
  questionnaireId: string;
  questionnaireType: QuestionnaireType;
  assessmentType: AssessmentType;
  status: AssessmentStatus;

  // Descriptive fields
  title: string;
  description?: string;

  // Temporal data
  startedAt: Date;
  submittedAt?: Date;
  completedAt?: Date;
  dueDate?: Date;

  // Scoring results
  overallScore?: number;              // EI percentage for ANS (0-100)
  maturityLevel?: SMSMaturityLevel;   // Overall level for SMS
  eiScore?: number;                   // Effective Implementation score
  categoryScores?: Record<string, number>;

  // Audit fields
  createdById: string;
  createdAt: Date;
  lastModifiedById: string;
  lastModifiedAt: Date;

  // Relationships
  reviewId?: string;                  // If part of peer review
  previousAssessmentId?: string;      // For tracking improvements
}

/**
 * Assessment with related data
 */
export interface AssessmentWithRelations extends Assessment {
  organization: {
    id: string;
    name: string;
    code: string;
  };
  questionnaire: {
    id: string;
    code: string;
    titleEn: string;
    titleFr: string;
    type: QuestionnaireType;
  };
  createdBy: {
    id: string;
    firstName: string;
    lastName: string;
  };
  responses?: AssessmentResponse[];
  _count?: {
    responses: number;
  };
}

/**
 * Individual question response within an assessment
 */
export interface AssessmentResponse {
  id: string;
  assessmentId: string;
  questionId: string;

  // Response data (one of these based on questionnaire type)
  responseValue: ANSResponseValue | null;  // For ANS USOAP CMA
  maturityLevel: SMSMaturityLevel;         // For SMS CANSO SoE
  score?: number;                          // Calculated score

  // Evidence and documentation
  evidenceDescription?: string;
  evidenceUrls: string[];

  // Comments
  assessorComments?: string;               // Official assessor comments
  internalNotes?: string;                  // Private notes (not shared)

  // Audit trail
  respondedById: string;
  respondedAt: Date;
  lastModifiedAt: Date;

  // Status
  isComplete: boolean;                     // Has required evidence
  needsReview: boolean;                    // Flagged for review
}

/**
 * Response with question details
 */
export interface AssessmentResponseWithQuestion extends AssessmentResponse {
  question: {
    id: string;
    pqNumber?: string;
    questionTextEn: string;
    questionTextFr: string;
    auditArea?: USOAPAuditArea;
    criticalElement?: CriticalElement;
    smsComponent?: SMSComponent;
    studyArea?: CANSOStudyArea;
    isPriorityPQ: boolean;
    requiresOnSite: boolean;
    weight: number;
  };
}

/**
 * Evidence attached to an assessment response
 */
export interface AssessmentEvidence {
  id: string;
  responseId: string;
  assessmentId: string;

  // Evidence details
  type: EvidenceType;
  title: string;
  description?: string;

  // File information
  fileUrl?: string;
  fileName?: string;
  fileType?: string;           // MIME type
  fileSize?: number;           // Bytes

  // Reference information
  documentReference?: string;  // Internal doc reference
  icaoReference?: string;      // ICAO document reference
  externalUrl?: string;        // Link to external resource

  // Audit
  uploadedById: string;
  uploadedAt: Date;

  // Validity
  validFrom?: Date;
  validUntil?: Date;
  isVerified: boolean;
}

// =============================================================================
// PROGRESS & STATISTICS
// =============================================================================

/**
 * Assessment progress tracking
 */
export interface AssessmentProgress {
  assessmentId: string;
  questionnaireType: QuestionnaireType;

  // Overall progress
  totalQuestions: number;
  answeredQuestions: number;       // Has a response value
  completedQuestions: number;      // Has response + evidence
  skippedQuestions: number;        // Marked as N/A
  percentComplete: number;         // 0-100
  percentAnswered: number;         // 0-100

  // Progress by category
  categoryProgress: CategoryProgress[];

  // Progress by audit area (ANS) or component (SMS)
  elementProgress: ElementProgress[];

  // Time tracking
  estimatedTimeRemaining?: number; // Minutes
  averageTimePerQuestion?: number; // Minutes
  lastActivityAt?: Date;
}

/**
 * Progress within a category
 */
export interface CategoryProgress {
  categoryId: string;
  categoryCode: string;
  categoryName: string;
  total: number;
  answered: number;
  completed: number;
  percentComplete: number;
}

/**
 * Progress by audit area (ANS) or SMS component
 */
export interface ElementProgress {
  element: string;                          // Audit area code or SMS component
  elementName: string;
  total: number;
  answered: number;
  completed: number;

  // ANS-specific
  satisfactoryCount?: number;
  notSatisfactoryCount?: number;
  notApplicableCount?: number;
  eiScore?: number;

  // SMS-specific
  maturityDistribution?: Record<string, number>; // A, B, C, D, E counts
  averageMaturity?: number;                      // 1-5 scale
  maturityLevel?: SMSMaturityLevel;
}

// =============================================================================
// SCORING INTERFACES
// =============================================================================

/**
 * EI Score calculation result (USOAP CMA)
 */
export interface EIScoreResult {
  overallEI: number;                              // 0-100 percentage
  totalApplicable: number;                        // Total - N/A
  satisfactoryCount: number;
  notSatisfactoryCount: number;
  notApplicableCount: number;
  notReviewedCount: number;

  // By audit area
  auditAreaScores: Record<USOAPAuditArea, {
    ei: number;
    satisfactory: number;
    notSatisfactory: number;
    notApplicable: number;
    total: number;
  }>;

  // By critical element
  criticalElementScores: Record<CriticalElement, {
    ei: number;
    satisfactory: number;
    notSatisfactory: number;
    total: number;
  }>;

  // Priority PQ metrics
  priorityPQScore?: number;
}

/**
 * SMS Maturity calculation result (CANSO SoE)
 */
export interface SMSMaturityResult {
  overallLevel: SMSMaturityLevel;
  overallScore: number;                           // 1-5 scale
  overallPercentage: number;                      // 0-100

  // By component (weighted)
  componentLevels: Record<SMSComponent, {
    level: SMSMaturityLevel;
    score: number;
    weight: number;
    weightedScore: number;
    questionCount: number;
  }>;

  // By study area
  studyAreaLevels: Record<CANSOStudyArea, {
    level: SMSMaturityLevel;
    score: number;
    questionCount: number;
  }>;

  // Distribution
  maturityDistribution: Record<string, number>;   // Count per level

  // Gaps identified
  gapAreas: string[];                             // Areas below target
}

/**
 * Combined score summary
 */
export interface AssessmentScoreSummary {
  assessmentId: string;
  questionnaireType: QuestionnaireType;
  calculatedAt: Date;

  // For ANS
  eiScore?: EIScoreResult;

  // For SMS
  smsMaturity?: SMSMaturityResult;

  // Comparison with previous
  previousScore?: number;
  scoreDelta?: number;
  trend: "IMPROVING" | "DECLINING" | "STABLE" | "NEW";
}

// =============================================================================
// FILTER & QUERY INTERFACES
// =============================================================================

/**
 * Assessment list filters
 */
export interface AssessmentFilters {
  organizationId?: string;
  questionnaireId?: string;
  questionnaireType?: QuestionnaireType;
  assessmentType?: AssessmentType;
  status?: AssessmentStatus | AssessmentStatus[];
  createdById?: string;

  // Date filters
  startedAfter?: Date;
  startedBefore?: Date;
  dueAfter?: Date;
  dueBefore?: Date;

  // Score filters
  minScore?: number;
  maxScore?: number;

  // Search
  search?: string;
}

/**
 * Response filters for querying
 */
export interface ResponseFilters {
  assessmentId: string;
  questionId?: string;
  responseValue?: ANSResponseValue;
  maturityLevel?: SMSMaturityLevel;
  isComplete?: boolean;
  needsReview?: boolean;

  // ANS filters
  auditArea?: USOAPAuditArea;
  criticalElement?: CriticalElement;
  isPriorityPQ?: boolean;

  // SMS filters
  smsComponent?: SMSComponent;
  studyArea?: CANSOStudyArea;
}

// =============================================================================
// INPUT/OUTPUT TYPES
// =============================================================================
// Note: Primary input types are defined in schemas.ts via Zod inference
// The following are additional interface types not covered by Zod schemas

/**
 * Input for bulk response update (interface version)
 */
export interface BulkResponseInput {
  assessmentId: string;
  responses: {
    questionId: string;
    responseValue?: ANSResponseValue;
    maturityLevel?: SMSMaturityLevel;
  }[];
}

```

# src/lib/auth/config.ts

```ts
import { type NextAuthConfig } from "next-auth";
import Credentials from "next-auth/providers/credentials";
import bcrypt from "bcryptjs";
import { db } from "@/lib/db";
import { UserRole, Locale } from "@prisma/client";

export const authConfig: NextAuthConfig = {
  session: {
    strategy: "jwt",
    maxAge: 30 * 24 * 60 * 60,
  },
  pages: {
    signIn: "/login",
    error: "/login",
  },
  callbacks: {
    async jwt({ token, user }) {
      if (user) {
        token.id = user.id;
        token.role = user.role;
        token.organizationId = user.organizationId;
        token.firstName = user.firstName;
        token.lastName = user.lastName;
        token.locale = user.locale;
      }
      return token;
    },
    async session({ session, token }) {
      if (token && session.user) {
        session.user.id = token.id as string;
        session.user.role = token.role as UserRole;
        session.user.organizationId = token.organizationId as string | null;
        session.user.firstName = token.firstName as string;
        session.user.lastName = token.lastName as string;
        session.user.locale = token.locale as Locale;
      }
      return session;
    },
  },
  providers: [
    Credentials({
      name: "credentials",
      credentials: {
        email: { label: "Email", type: "email" },
        password: { label: "Password", type: "password" },
      },
      async authorize(credentials) {
        if (!credentials?.email || !credentials?.password) {
          return null;
        }

        const user = await db.user.findUnique({
          where: { email: credentials.email as string },
          include: { organization: true },
        });

        if (!user || !user.passwordHash) {
          return null;
        }

        const isPasswordValid = await bcrypt.compare(
          credentials.password as string,
          user.passwordHash
        );

        if (!isPasswordValid) {
          return null;
        }

        await db.user.update({
          where: { id: user.id },
          data: { lastLoginAt: new Date() },
        });

        return {
          id: user.id,
          email: user.email,
          firstName: user.firstName,
          lastName: user.lastName,
          role: user.role,
          organizationId: user.organizationId,
          locale: user.locale,
        };
      },
    }),
  ],
};

```

# src/lib/auth/index.ts

```ts
import NextAuth from "next-auth";
import { authConfig } from "./config";

export const {
  handlers: { GET, POST },
  auth,
  signIn,
  signOut,
} = NextAuth(authConfig);

```

# src/lib/auth/permissions.ts

```ts
import { UserRole } from "@prisma/client";

export type Permission =
  | "users:read" | "users:create" | "users:update" | "users:delete"
  | "organizations:read" | "organizations:create" | "organizations:update" | "organizations:delete"
  | "questionnaires:read" | "questionnaires:create" | "questionnaires:update" | "questionnaires:delete"
  | "assessments:read" | "assessments:create" | "assessments:update" | "assessments:delete" | "assessments:submit"
  | "reviews:read" | "reviews:create" | "reviews:update" | "reviews:delete" | "reviews:assign-team" | "reviews:approve"
  | "findings:read" | "findings:create" | "findings:update" | "findings:delete"
  | "cap:read" | "cap:create" | "cap:update" | "cap:verify"
  | "reviewers:read" | "reviewers:create" | "reviewers:update" | "reviewers:delete"
  | "training:read" | "training:manage"
  | "reports:read" | "reports:export" | "analytics:read"
  | "system:admin" | "system:audit-logs";

export const rolePermissions: Record<UserRole, Permission[]> = {
  SUPER_ADMIN: [
    "users:read", "users:create", "users:update", "users:delete",
    "organizations:read", "organizations:create", "organizations:update", "organizations:delete",
    "questionnaires:read", "questionnaires:create", "questionnaires:update", "questionnaires:delete",
    "assessments:read", "assessments:create", "assessments:update", "assessments:delete", "assessments:submit",
    "reviews:read", "reviews:create", "reviews:update", "reviews:delete", "reviews:assign-team", "reviews:approve",
    "findings:read", "findings:create", "findings:update", "findings:delete",
    "cap:read", "cap:create", "cap:update", "cap:verify",
    "reviewers:read", "reviewers:create", "reviewers:update", "reviewers:delete",
    "training:read", "training:manage",
    "reports:read", "reports:export", "analytics:read",
    "system:admin", "system:audit-logs",
  ],
  SYSTEM_ADMIN: [
    "users:read", "users:create", "users:update",
    "organizations:read", "organizations:create", "organizations:update",
    "questionnaires:read", "questionnaires:create", "questionnaires:update",
    "assessments:read", "reviews:read", "findings:read", "cap:read",
    "reviewers:read", "reviewers:create", "reviewers:update",
    "training:read", "training:manage",
    "reports:read", "reports:export", "analytics:read",
    "system:admin", "system:audit-logs",
  ],
  STEERING_COMMITTEE: [
    "users:read", "organizations:read", "questionnaires:read",
    "assessments:read", "reviews:read", "reviews:approve",
    "findings:read", "cap:read", "reviewers:read", "training:read",
    "reports:read", "reports:export", "analytics:read",
  ],
  PROGRAMME_COORDINATOR: [
    "users:read", "users:create", "users:update", "organizations:read",
    "questionnaires:read", "assessments:read",
    "reviews:read", "reviews:create", "reviews:update", "reviews:assign-team",
    "findings:read", "cap:read", "reviewers:read", "reviewers:update",
    "training:read", "reports:read", "reports:export", "analytics:read",
  ],
  LEAD_REVIEWER: [
    "organizations:read", "questionnaires:read", "assessments:read",
    "reviews:read", "reviews:update",
    "findings:read", "findings:create", "findings:update",
    "cap:read", "cap:verify", "reviewers:read", "training:read",
    "reports:read", "reports:export",
  ],
  PEER_REVIEWER: [
    "organizations:read", "questionnaires:read", "assessments:read",
    "reviews:read", "findings:read", "findings:create",
    "cap:read", "reviewers:read", "training:read", "reports:read",
  ],
  OBSERVER: [
    "questionnaires:read", "assessments:read", "reviews:read",
    "findings:read", "training:read",
  ],
  ANSP_ADMIN: [
    "users:read", "users:create", "users:update", "questionnaires:read",
    "assessments:read", "assessments:create", "assessments:update", "assessments:submit",
    "reviews:read", "findings:read",
    "cap:read", "cap:create", "cap:update",
    "training:read", "reports:read",
  ],
  SAFETY_MANAGER: [
    "questionnaires:read",
    "assessments:read", "assessments:create", "assessments:update", "assessments:submit",
    "reviews:read", "findings:read",
    "cap:read", "cap:create", "cap:update",
    "training:read", "reports:read",
  ],
  QUALITY_MANAGER: [
    "questionnaires:read",
    "assessments:read", "assessments:create", "assessments:update",
    "reviews:read", "findings:read",
    "cap:read", "cap:create", "cap:update",
    "training:read", "reports:read",
  ],
  STAFF: [
    "questionnaires:read", "assessments:read", "training:read",
  ],
};

export function hasPermission(role: UserRole, permission: Permission): boolean {
  return rolePermissions[role]?.includes(permission) ?? false;
}

export function hasAnyPermission(role: UserRole, permissions: Permission[]): boolean {
  return permissions.some((permission) => hasPermission(role, permission));
}

export function hasAllPermissions(role: UserRole, permissions: Permission[]): boolean {
  return permissions.every((permission) => hasPermission(role, permission));
}

export function getPermissions(role: UserRole): Permission[] {
  return rolePermissions[role] ?? [];
}

```

# src/lib/auth/rbac.ts

```ts
import { auth } from "@/lib/auth";
import { Permission, hasPermission, hasAnyPermission } from "./permissions";
import { redirect } from "next/navigation";

export async function checkPermission(permission: Permission) {
  const session = await auth();

  if (!session?.user) {
    redirect("/login");
  }

  if (!hasPermission(session.user.role, permission)) {
    redirect("/unauthorized");
  }

  return session;
}

export async function checkAnyPermission(permissions: Permission[]) {
  const session = await auth();

  if (!session?.user) {
    redirect("/login");
  }

  if (!hasAnyPermission(session.user.role, permissions)) {
    redirect("/unauthorized");
  }

  return session;
}

export async function requireAuth() {
  const session = await auth();

  if (!session?.user) {
    redirect("/login");
  }

  return session;
}

```

# src/lib/auth/types.ts

```ts
import { UserRole, Locale } from "@prisma/client";
import type { DefaultSession } from "next-auth";

declare module "next-auth" {
  interface User {
    id: string;
    email: string;
    firstName: string;
    lastName: string;
    role: UserRole;
    organizationId: string | null;
    locale: Locale;
  }

  interface Session extends DefaultSession {
    user: {
      id: string;
      email: string;
      firstName: string;
      lastName: string;
      role: UserRole;
      organizationId: string | null;
      locale: Locale;
    } & DefaultSession["user"];
  }
}

```

# src/lib/constants/scoring.ts

```ts
/**
 * Scoring Constants
 *
 * Constants for ICAO USOAP CMA and CANSO SoE 2024 scoring methodologies.
 */

import type {
  MaturityLevel,
  USOAPAuditArea,
  CriticalElement,
  SMSComponent,
  CANSOStudyArea,
} from "@prisma/client";

// =============================================================================
// ICAO CRITICAL ELEMENTS
// =============================================================================

export interface CriticalElementInfo {
  code: CriticalElement;
  name: string;
  nameEn: string;
  nameFr: string;
  description?: string;
}

export const CRITICAL_ELEMENTS: Record<CriticalElement, CriticalElementInfo> = {
  CE_1: {
    code: "CE_1",
    name: "Primary Aviation Legislation",
    nameEn: "Primary Aviation Legislation",
    nameFr: "Législation aéronautique de base",
    description:
      "The provision of a comprehensive and effective aviation law consistent with the environment and complexity of the State's aviation activity",
  },
  CE_2: {
    code: "CE_2",
    name: "Specific Operating Regulations",
    nameEn: "Specific Operating Regulations",
    nameFr: "Règlements d'exploitation spécifiques",
    description:
      "The provision of adequate regulations to address national requirements emanating from the primary aviation legislation",
  },
  CE_3: {
    code: "CE_3",
    name: "State Civil Aviation System",
    nameEn: "State Civil Aviation System and Safety Oversight Functions",
    nameFr: "Système d'aviation civile de l'État",
    description:
      "The establishment of a state aviation system with appropriate organizational structure and qualified technical personnel",
  },
  CE_4: {
    code: "CE_4",
    name: "Technical Personnel Qualification",
    nameEn: "Technical Personnel Qualification and Training",
    nameFr: "Qualification du personnel technique",
    description:
      "The availability of adequate and qualified technical personnel for the performance of state safety oversight functions",
  },
  CE_5: {
    code: "CE_5",
    name: "Technical Guidance, Tools, Provision of Safety-Critical Information",
    nameEn:
      "Technical Guidance, Tools and Provision of Safety-Critical Information",
    nameFr: "Orientations techniques et informations critiques",
    description:
      "The provision of technical guidance, tools, and safety-critical information to the aviation industry",
  },
  CE_6: {
    code: "CE_6",
    name: "Licensing, Certification, Authorization",
    nameEn: "Licensing, Certification, Authorization and Approval Obligations",
    nameFr: "Licences, certification et autorisation",
    description:
      "The implementation of processes to ensure personnel and organizations meet established requirements",
  },
  CE_7: {
    code: "CE_7",
    name: "Surveillance Obligations",
    nameEn: "Surveillance Obligations",
    nameFr: "Obligations de surveillance",
    description:
      "The implementation of processes such as inspections, audits, and monitoring activities",
  },
  CE_8: {
    code: "CE_8",
    name: "Resolution of Safety Issues",
    nameEn: "Resolution of Safety Issues",
    nameFr: "Résolution des problèmes de sécurité",
    description:
      "The implementation of processes to resolve identified safety issues including enforcement measures",
  },
} as const;

// =============================================================================
// USOAP AUDIT AREAS
// =============================================================================

export interface AuditAreaInfo {
  code: USOAPAuditArea;
  name: string;
  nameEn: string;
  nameFr: string;
  description?: string;
  pqCount?: number;
}

export const AUDIT_AREAS: Record<USOAPAuditArea, AuditAreaInfo> = {
  LEG: {
    code: "LEG",
    name: "Primary Aviation Legislation",
    nameEn: "Primary Aviation Legislation",
    nameFr: "Législation aéronautique de base",
    description:
      "Legislation that provides the foundation for safety oversight",
    pqCount: 23,
  },
  ORG: {
    code: "ORG",
    name: "Civil Aviation Organization",
    nameEn: "Civil Aviation Organization",
    nameFr: "Organisation de l'aviation civile",
    description:
      "Establishment of a civil aviation authority with adequate staffing and resources",
    pqCount: 13,
  },
  PEL: {
    code: "PEL",
    name: "Personnel Licensing and Training",
    nameEn: "Personnel Licensing and Training",
    nameFr: "Licences du personnel et formation",
    description: "Licensing and certification of aviation personnel",
    pqCount: 100,
  },
  OPS: {
    code: "OPS",
    name: "Aircraft Operations",
    nameEn: "Aircraft Operations",
    nameFr: "Exploitation des aéronefs",
    description: "Operational requirements for aircraft operators",
    pqCount: 136,
  },
  AIR: {
    code: "AIR",
    name: "Airworthiness of Aircraft",
    nameEn: "Airworthiness of Aircraft",
    nameFr: "Navigabilité des aéronefs",
    description: "Certification and continuing airworthiness of aircraft",
    pqCount: 198,
  },
  AIG: {
    code: "AIG",
    name: "Aircraft Accident and Incident Investigation",
    nameEn: "Aircraft Accident and Incident Investigation",
    nameFr: "Enquêtes sur les accidents et incidents d'aéronefs",
    description: "Investigation of aircraft accidents and incidents",
    pqCount: 84,
  },
  ANS: {
    code: "ANS",
    name: "Air Navigation Services",
    nameEn: "Air Navigation Services",
    nameFr: "Services de navigation aérienne",
    description:
      "Provision of air traffic services, communications, navigation, and surveillance",
    pqCount: 128,
  },
  AGA: {
    code: "AGA",
    name: "Aerodromes and Ground Aids",
    nameEn: "Aerodromes and Ground Aids",
    nameFr: "Aérodromes et aides au sol",
    description:
      "Certification and oversight of aerodromes including physical characteristics",
    pqCount: 153,
  },
  SSP: {
    code: "SSP",
    name: "State Safety Programme",
    nameEn: "State Safety Programme",
    nameFr: "Programme national de sécurité",
    description:
      "Implementation of a State Safety Programme including safety policy and risk management",
    pqCount: 16,
  },
} as const;

// =============================================================================
// SMS COMPONENTS (CANSO SoE 2024)
// =============================================================================

export interface SMSComponentInfo {
  code: SMSComponent;
  name: string;
  nameEn: string;
  nameFr: string;
  weight: number;
  studyAreas: CANSOStudyArea[];
  description?: string;
}

export const SMS_COMPONENTS: Record<SMSComponent, SMSComponentInfo> = {
  SAFETY_POLICY_OBJECTIVES: {
    code: "SAFETY_POLICY_OBJECTIVES",
    name: "Safety Policy and Objectives",
    nameEn: "Safety Policy and Objectives",
    nameFr: "Politique et objectifs de sécurité",
    weight: 0.25,
    studyAreas: ["SA_1_1", "SA_1_2", "SA_1_3", "SA_1_4", "SA_1_5"],
    description:
      "Management commitment, safety responsibilities, appointment of key safety personnel",
  },
  SAFETY_RISK_MANAGEMENT: {
    code: "SAFETY_RISK_MANAGEMENT",
    name: "Safety Risk Management",
    nameEn: "Safety Risk Management",
    nameFr: "Gestion des risques de sécurité",
    weight: 0.3,
    studyAreas: ["SA_2_1", "SA_2_2"],
    description:
      "Hazard identification, safety risk assessment and mitigation processes",
  },
  SAFETY_ASSURANCE: {
    code: "SAFETY_ASSURANCE",
    name: "Safety Assurance",
    nameEn: "Safety Assurance",
    nameFr: "Assurance de la sécurité",
    weight: 0.25,
    studyAreas: ["SA_3_1", "SA_3_2", "SA_3_3"],
    description:
      "Safety performance monitoring, change management, and continuous improvement",
  },
  SAFETY_PROMOTION: {
    code: "SAFETY_PROMOTION",
    name: "Safety Promotion",
    nameEn: "Safety Promotion",
    nameFr: "Promotion de la sécurité",
    weight: 0.2,
    studyAreas: ["SA_4_1", "SA_4_2"],
    description: "Training and education, and safety communication",
  },
} as const;

// =============================================================================
// SMS STUDY AREAS (CANSO SoE 2024)
// =============================================================================

export interface StudyAreaInfo {
  code: CANSOStudyArea;
  name: string;
  nameEn: string;
  nameFr: string;
  component: SMSComponent;
  description?: string;
}

export const SMS_STUDY_AREAS: Record<CANSOStudyArea, StudyAreaInfo> = {
  SA_1_1: {
    code: "SA_1_1",
    name: "Management Commitment",
    nameEn: "Management Commitment",
    nameFr: "Engagement de la direction",
    component: "SAFETY_POLICY_OBJECTIVES",
    description:
      "Management commitment and responsibility for safety, including the safety policy statement",
  },
  SA_1_2: {
    code: "SA_1_2",
    name: "Safety Accountabilities",
    nameEn: "Safety Accountabilities",
    nameFr: "Responsabilités en matière de sécurité",
    component: "SAFETY_POLICY_OBJECTIVES",
    description:
      "Identification of the accountable executive and safety responsibilities of managers",
  },
  SA_1_3: {
    code: "SA_1_3",
    name: "Appointment of Key Safety Personnel",
    nameEn: "Appointment of Key Safety Personnel",
    nameFr: "Nomination du personnel clé de sécurité",
    component: "SAFETY_POLICY_OBJECTIVES",
    description: "Appointment of key safety personnel including the safety manager",
  },
  SA_1_4: {
    code: "SA_1_4",
    name: "Coordination of Emergency Response Planning",
    nameEn: "Coordination of Emergency Response Planning",
    nameFr: "Coordination de la planification des interventions d'urgence",
    component: "SAFETY_POLICY_OBJECTIVES",
    description:
      "Coordination of emergency response planning with appropriate organizations",
  },
  SA_1_5: {
    code: "SA_1_5",
    name: "SMS Documentation",
    nameEn: "SMS Documentation",
    nameFr: "Documentation du SGS",
    component: "SAFETY_POLICY_OBJECTIVES",
    description: "SMS implementation plan, documentation, and records management",
  },
  SA_2_1: {
    code: "SA_2_1",
    name: "Hazard Identification",
    nameEn: "Hazard Identification",
    nameFr: "Identification des dangers",
    component: "SAFETY_RISK_MANAGEMENT",
    description:
      "Processes for identifying hazards through reactive, proactive, and predictive methods",
  },
  SA_2_2: {
    code: "SA_2_2",
    name: "Risk Assessment and Mitigation",
    nameEn: "Risk Assessment and Mitigation",
    nameFr: "Évaluation et atténuation des risques",
    component: "SAFETY_RISK_MANAGEMENT",
    description:
      "Safety risk assessment and development of risk controls and mitigation strategies",
  },
  SA_3_1: {
    code: "SA_3_1",
    name: "Safety Performance Monitoring and Measurement",
    nameEn: "Safety Performance Monitoring and Measurement",
    nameFr: "Surveillance et mesure des performances de sécurité",
    component: "SAFETY_ASSURANCE",
    description:
      "Monitoring and measurement of safety performance including SPIs and SPTs",
  },
  SA_3_2: {
    code: "SA_3_2",
    name: "Management of Change",
    nameEn: "Management of Change",
    nameFr: "Gestion du changement",
    component: "SAFETY_ASSURANCE",
    description:
      "Processes to manage safety risks associated with organizational or operational changes",
  },
  SA_3_3: {
    code: "SA_3_3",
    name: "Continuous Improvement of the SMS",
    nameEn: "Continuous Improvement of the SMS",
    nameFr: "Amélioration continue du SGS",
    component: "SAFETY_ASSURANCE",
    description: "Internal evaluations, audits, and continuous improvement of the SMS",
  },
  SA_4_1: {
    code: "SA_4_1",
    name: "Training and Education",
    nameEn: "Training and Education",
    nameFr: "Formation et éducation",
    component: "SAFETY_PROMOTION",
    description: "Safety training programs for personnel at all levels",
  },
  SA_4_2: {
    code: "SA_4_2",
    name: "Safety Communication",
    nameEn: "Safety Communication",
    nameFr: "Communication sur la sécurité",
    component: "SAFETY_PROMOTION",
    description:
      "Communication of safety-critical information and promotion of safety culture",
  },
} as const;

// =============================================================================
// MATURITY LEVEL VALUES
// =============================================================================

export interface MaturityLevelValue {
  code: MaturityLevel;
  name: string;
  nameEn: string;
  nameFr: string;
  numeric: number;
  percentage: number;
  midpoint: number;
  minScore: number;
  maxScore: number;
  color: string;
}

export const MATURITY_LEVEL_VALUES: Record<MaturityLevel, MaturityLevelValue> = {
  LEVEL_A: {
    code: "LEVEL_A",
    name: "Initial/Ad-hoc",
    nameEn: "Initial/Ad-hoc",
    nameFr: "Initial/Ad-hoc",
    numeric: 1,
    percentage: 10,
    midpoint: 10,
    minScore: 0,
    maxScore: 20,
    color: "#DC2626", // red-600
  },
  LEVEL_B: {
    code: "LEVEL_B",
    name: "Defined/Documented",
    nameEn: "Defined/Documented",
    nameFr: "Défini/Documenté",
    numeric: 2,
    percentage: 30,
    midpoint: 30,
    minScore: 21,
    maxScore: 40,
    color: "#F97316", // orange-500
  },
  LEVEL_C: {
    code: "LEVEL_C",
    name: "Implemented/Measured",
    nameEn: "Implemented/Measured",
    nameFr: "Mis en œuvre/Mesuré",
    numeric: 3,
    percentage: 50,
    midpoint: 50,
    minScore: 41,
    maxScore: 60,
    color: "#EAB308", // yellow-500
  },
  LEVEL_D: {
    code: "LEVEL_D",
    name: "Managed/Controlled",
    nameEn: "Managed/Controlled",
    nameFr: "Géré/Contrôlé",
    numeric: 4,
    percentage: 70,
    midpoint: 70,
    minScore: 61,
    maxScore: 80,
    color: "#22C55E", // green-500
  },
  LEVEL_E: {
    code: "LEVEL_E",
    name: "Optimizing/Leading",
    nameEn: "Optimizing/Leading",
    nameFr: "Optimisé/Leader",
    numeric: 5,
    percentage: 90,
    midpoint: 90,
    minScore: 81,
    maxScore: 100,
    color: "#3B82F6", // blue-500
  },
} as const;

// =============================================================================
// CONVERSION FUNCTIONS
// =============================================================================

/**
 * Convert percentage score to maturity level
 */
export function percentageToMaturityLevel(percentage: number): MaturityLevel {
  if (percentage <= 20) return "LEVEL_A";
  if (percentage <= 40) return "LEVEL_B";
  if (percentage <= 60) return "LEVEL_C";
  if (percentage <= 80) return "LEVEL_D";
  return "LEVEL_E";
}

/**
 * Convert maturity level to percentage (midpoint)
 */
export function maturityLevelToPercentage(level: MaturityLevel): number {
  return MATURITY_LEVEL_VALUES[level].midpoint;
}

/**
 * Convert maturity level to numeric value (1-5)
 */
export function maturityLevelToNumeric(level: MaturityLevel): number {
  return MATURITY_LEVEL_VALUES[level].numeric;
}

/**
 * Convert numeric value to maturity level
 */
export function numericToMaturityLevel(numeric: number): MaturityLevel {
  if (numeric <= 1.5) return "LEVEL_A";
  if (numeric <= 2.5) return "LEVEL_B";
  if (numeric <= 3.5) return "LEVEL_C";
  if (numeric <= 4.5) return "LEVEL_D";
  return "LEVEL_E";
}

/**
 * Get study areas for a component
 */
export function getStudyAreasForComponent(
  component: SMSComponent
): CANSOStudyArea[] {
  return SMS_COMPONENTS[component].studyAreas;
}

/**
 * Get component for a study area
 */
export function getComponentForStudyArea(studyArea: CANSOStudyArea): SMSComponent {
  return SMS_STUDY_AREAS[studyArea].component;
}

// =============================================================================
// SCORING THRESHOLDS
// =============================================================================

/**
 * Minimum completion percentage required for scoring
 */
export const MIN_COMPLETION_FOR_SCORING = 80;

/**
 * Priority PQ weight multiplier (optional weighted calculation)
 */
export const PRIORITY_PQ_WEIGHT = 1.5;

/**
 * Default weight for non-priority PQs
 */
export const DEFAULT_PQ_WEIGHT = 1.0;

// =============================================================================
// ANS RESPONSE VALUES
// =============================================================================

export type ANSResponseValue =
  | "SATISFACTORY"
  | "NOT_SATISFACTORY"
  | "NOT_APPLICABLE"
  | "NOT_REVIEWED";

export const ANS_RESPONSE_VALUES: ANSResponseValue[] = [
  "SATISFACTORY",
  "NOT_SATISFACTORY",
  "NOT_APPLICABLE",
  "NOT_REVIEWED",
];

/**
 * Check if response counts toward EI calculation
 */
export function isCountableResponse(response: string | null): boolean {
  return (
    response !== null &&
    response !== "NOT_APPLICABLE" &&
    response !== "NOT_REVIEWED"
  );
}

/**
 * Check if response is satisfactory
 */
export function isSatisfactoryResponse(response: string | null): boolean {
  return response === "SATISFACTORY";
}

```

# src/lib/db/index.ts

```ts
import { PrismaClient } from "@prisma/client";
import { PrismaPg } from "@prisma/adapter-pg";
import { Pool } from "pg";

const globalForPrisma = globalThis as unknown as {
  prisma: PrismaClient | undefined;
  pool: Pool | undefined;
};

function createPrismaClient() {
  const connectionString = process.env.DATABASE_URL;
  
  if (!connectionString) {
    throw new Error("DATABASE_URL environment variable is not set");
  }

  const pool = globalForPrisma.pool ?? new Pool({ connectionString });
  globalForPrisma.pool = pool;

  const adapter = new PrismaPg(pool);
  
  return new PrismaClient({ adapter });
}

export const db = globalForPrisma.prisma ?? createPrismaClient();

if (process.env.NODE_ENV !== "production") {
  globalForPrisma.prisma = db;
}

export const prisma = db;
export default db;

```

# src/lib/i18n/request.ts

```ts
import { getRequestConfig } from "next-intl/server";
import { routing } from "./routing";

export default getRequestConfig(async ({ requestLocale }) => {
  let locale = await requestLocale;

  // Ensure that a valid locale is used
  if (!locale || !routing.locales.includes(locale as "en" | "fr")) {
    locale = routing.defaultLocale;
  }

  return {
    locale,
    messages: (await import(`../../../messages/${locale}.json`)).default
  };
});

```

# src/lib/i18n/routing.ts

```ts
import { defineRouting } from "next-intl/routing";
import { createNavigation } from "next-intl/navigation";

export const routing = defineRouting({
  locales: ["en", "fr"],
  defaultLocale: "en",
});

export const { Link, redirect, usePathname, useRouter } = createNavigation(routing);

```

# src/lib/questionnaire/constants.ts

```ts
import type {
  USOAPAuditArea,
  CriticalElement,
  SMSComponent,
  CANSOStudyArea,
  MaturityLevel,
  TransversalArea,
  ICAOReferenceType,
} from "@prisma/client";
import type {
  AuditAreaMeta,
  CriticalElementMeta,
  SMSComponentMeta,
  StudyAreaMeta,
  MaturityLevelMeta,
  TransversalAreaMeta,
  ICAOReferenceTypeMeta,
} from "./types";

// =============================================================================
// USOAP CMA 2024 - AUDIT AREAS (9 areas, 851 Protocol Questions)
// =============================================================================

export const USOAP_AUDIT_AREAS: Record<USOAPAuditArea, AuditAreaMeta> = {
  LEG: {
    code: "LEG",
    name: {
      en: "Primary Aviation Legislation",
      fr: "Legislation Aeronautique Primaire",
    },
    description: {
      en: "Laws enacted by the State legislature that establish a framework for national civil aviation",
      fr: "Lois promulguees par le legislateur de l'Etat etablissant un cadre pour l'aviation civile nationale",
    },
    pqCount: 23,
    sortOrder: 1,
  },
  ORG: {
    code: "ORG",
    name: {
      en: "Civil Aviation Organization",
      fr: "Organisation de l'Aviation Civile",
    },
    description: {
      en: "Civil aviation authority structure, resources, and organizational framework",
      fr: "Structure de l'autorite de l'aviation civile, ressources et cadre organisationnel",
    },
    pqCount: 13,
    sortOrder: 2,
  },
  PEL: {
    code: "PEL",
    name: {
      en: "Personnel Licensing and Training",
      fr: "Licences du Personnel et Formation",
    },
    description: {
      en: "Licensing and certification of aviation personnel including pilots, cabin crew, and ground personnel",
      fr: "Delivrance de licences et certification du personnel aeronautique incluant pilotes, equipage de cabine et personnel au sol",
    },
    pqCount: 100,
    sortOrder: 3,
  },
  OPS: {
    code: "OPS",
    name: {
      en: "Aircraft Operations",
      fr: "Operations Aeriennes",
    },
    description: {
      en: "Certification and oversight of commercial and general aviation operations",
      fr: "Certification et surveillance des operations d'aviation commerciale et generale",
    },
    pqCount: 136,
    sortOrder: 4,
  },
  AIR: {
    code: "AIR",
    name: {
      en: "Airworthiness of Aircraft",
      fr: "Navigabilite des Aeronefs",
    },
    description: {
      en: "Certification and continued airworthiness of aircraft, engines, and equipment",
      fr: "Certification et maintien de la navigabilite des aeronefs, moteurs et equipements",
    },
    pqCount: 198,
    sortOrder: 5,
  },
  AIG: {
    code: "AIG",
    name: {
      en: "Aircraft Accident and Incident Investigation",
      fr: "Enquetes sur les Accidents et Incidents d'Aviation",
    },
    description: {
      en: "Independent investigation of aircraft accidents and serious incidents",
      fr: "Enquetes independantes sur les accidents et incidents graves d'aeronefs",
    },
    pqCount: 84,
    sortOrder: 6,
  },
  ANS: {
    code: "ANS",
    name: {
      en: "Air Navigation Services",
      fr: "Services de Navigation Aerienne",
    },
    description: {
      en: "Provision and oversight of air traffic services, communications, navigation, and surveillance",
      fr: "Fourniture et surveillance des services de la circulation aerienne, communications, navigation et surveillance",
    },
    pqCount: 128,
    sortOrder: 7,
  },
  AGA: {
    code: "AGA",
    name: {
      en: "Aerodromes and Ground Aids",
      fr: "Aerodromes et Aides au Sol",
    },
    description: {
      en: "Certification and oversight of aerodromes, heliports, and ground aids",
      fr: "Certification et surveillance des aerodromes, heliports et aides au sol",
    },
    pqCount: 153,
    sortOrder: 8,
  },
  SSP: {
    code: "SSP",
    name: {
      en: "State Safety Programme",
      fr: "Programme National de Securite",
    },
    description: {
      en: "Implementation of the State Safety Programme framework and safety performance management",
      fr: "Mise en oeuvre du cadre du Programme National de Securite et gestion des performances de securite",
    },
    pqCount: 16,
    sortOrder: 9,
  },
} as const;

// Total PQ count: 851 (verified against USOAP CMA 2024)
export const TOTAL_USOAP_PQ_COUNT = Object.values(USOAP_AUDIT_AREAS).reduce(
  (sum, area) => sum + area.pqCount,
  0
);

// =============================================================================
// CRITICAL ELEMENTS (CE-1 to CE-8)
// =============================================================================

export const CRITICAL_ELEMENTS: Record<CriticalElement, CriticalElementMeta> = {
  CE_1: {
    code: "CE_1",
    number: 1,
    name: {
      en: "Primary Aviation Legislation",
      fr: "Legislation Aeronautique Primaire",
    },
    description: {
      en: "The State has promulgated a comprehensive and effective aviation law that provides for safe, secure and sustainable development of civil aviation",
      fr: "L'Etat a promulgue une legislation aeronautique complete et efficace qui prevoit un developpement sur, securise et durable de l'aviation civile",
    },
    sortOrder: 1,
  },
  CE_2: {
    code: "CE_2",
    number: 2,
    name: {
      en: "Specific Operating Regulations",
      fr: "Reglements d'Exploitation Specifiques",
    },
    description: {
      en: "The State has adopted detailed regulations implementing ICAO Standards and Recommended Practices",
      fr: "L'Etat a adopte des reglements detailles mettant en oeuvre les normes et pratiques recommandees de l'OACI",
    },
    sortOrder: 2,
  },
  CE_3: {
    code: "CE_3",
    number: 3,
    name: {
      en: "State System and Functions",
      fr: "Systeme et Fonctions de l'Etat",
    },
    description: {
      en: "The State has established a civil aviation authority with adequate authority, resources, and procedures",
      fr: "L'Etat a etabli une autorite de l'aviation civile dotee de pouvoirs, ressources et procedures adequats",
    },
    sortOrder: 3,
  },
  CE_4: {
    code: "CE_4",
    number: 4,
    name: {
      en: "Qualified Technical Personnel",
      fr: "Personnel Technique Qualifie",
    },
    description: {
      en: "The State has established minimum requirements for the knowledge and experience of technical personnel",
      fr: "L'Etat a etabli des exigences minimales pour les connaissances et l'experience du personnel technique",
    },
    sortOrder: 4,
  },
  CE_5: {
    code: "CE_5",
    number: 5,
    name: {
      en: "Technical Guidance, Tools and Safety-Critical Information",
      fr: "Orientations Techniques, Outils et Information Critique pour la Securite",
    },
    description: {
      en: "The State has established the means to provide safety-critical information and technical guidance",
      fr: "L'Etat a etabli les moyens de fournir des informations critiques pour la securite et des orientations techniques",
    },
    sortOrder: 5,
  },
  CE_6: {
    code: "CE_6",
    number: 6,
    name: {
      en: "Licensing, Certification, Authorization and Approval",
      fr: "Licences, Certification, Autorisation et Approbation",
    },
    description: {
      en: "The State has implemented processes for issuance of licences, certificates, and approvals",
      fr: "L'Etat a mis en oeuvre des processus pour la delivrance de licences, certificats et approbations",
    },
    sortOrder: 6,
  },
  CE_7: {
    code: "CE_7",
    number: 7,
    name: {
      en: "Surveillance Obligations",
      fr: "Obligations de Surveillance",
    },
    description: {
      en: "The State has established and implemented a surveillance programme including inspections and audits",
      fr: "L'Etat a etabli et mis en oeuvre un programme de surveillance incluant inspections et audits",
    },
    sortOrder: 7,
  },
  CE_8: {
    code: "CE_8",
    number: 8,
    name: {
      en: "Resolution of Safety Issues",
      fr: "Resolution des Problemes de Securite",
    },
    description: {
      en: "The State has established procedures for resolution of identified safety deficiencies",
      fr: "L'Etat a etabli des procedures pour la resolution des deficiences de securite identifiees",
    },
    sortOrder: 8,
  },
} as const;

// =============================================================================
// SMS COMPONENTS (CANSO SoE 2024 - 4 Components with Weights)
// =============================================================================

export const SMS_COMPONENTS: Record<SMSComponent, SMSComponentMeta> = {
  SAFETY_POLICY_OBJECTIVES: {
    code: "SAFETY_POLICY_OBJECTIVES",
    number: 1,
    name: {
      en: "Safety Policy and Objectives",
      fr: "Politique et Objectifs de Securite",
    },
    description: {
      en: "Management commitment, safety accountabilities and responsibilities, appointment of key safety personnel, coordination of emergency response planning, and SMS documentation",
      fr: "Engagement de la direction, responsabilites en matiere de securite, designation du personnel cle de securite, coordination de la planification des interventions d'urgence et documentation SMS",
    },
    weight: 0.25,
    sortOrder: 1,
  },
  SAFETY_RISK_MANAGEMENT: {
    code: "SAFETY_RISK_MANAGEMENT",
    number: 2,
    name: {
      en: "Safety Risk Management",
      fr: "Gestion des Risques de Securite",
    },
    description: {
      en: "Hazard identification, safety risk assessment and mitigation processes",
      fr: "Identification des dangers, evaluation et attenuation des risques de securite",
    },
    weight: 0.3,
    sortOrder: 2,
  },
  SAFETY_ASSURANCE: {
    code: "SAFETY_ASSURANCE",
    number: 3,
    name: {
      en: "Safety Assurance",
      fr: "Assurance de la Securite",
    },
    description: {
      en: "Safety performance monitoring and measurement, management of change, and continuous improvement of the SMS",
      fr: "Surveillance et mesure des performances de securite, gestion du changement et amelioration continue du SMS",
    },
    weight: 0.25,
    sortOrder: 3,
  },
  SAFETY_PROMOTION: {
    code: "SAFETY_PROMOTION",
    number: 4,
    name: {
      en: "Safety Promotion",
      fr: "Promotion de la Securite",
    },
    description: {
      en: "Training and education, and safety communication to foster a positive safety culture",
      fr: "Formation et education, et communication sur la securite pour favoriser une culture positive de securite",
    },
    weight: 0.2,
    sortOrder: 4,
  },
} as const;

// Validate weights sum to 1.0
const SMS_WEIGHTS_SUM = Object.values(SMS_COMPONENTS).reduce(
  (sum, c) => sum + c.weight,
  0
);
if (Math.abs(SMS_WEIGHTS_SUM - 1.0) > 0.001) {
  throw new Error(
    `SMS component weights must sum to 1.0, got ${SMS_WEIGHTS_SUM}`
  );
}

// =============================================================================
// CANSO STUDY AREAS (12 Study Areas across 4 Components)
// =============================================================================

export const CANSO_STUDY_AREAS: Record<CANSOStudyArea, StudyAreaMeta> = {
  // Component 1: Safety Policy and Objectives
  SA_1_1: {
    code: "SA_1_1",
    componentNumber: 1,
    areaNumber: 1,
    name: {
      en: "Management Commitment and Responsibility",
      fr: "Engagement et Responsabilite de la Direction",
    },
    description: {
      en: "Senior management commitment to safety and allocation of resources",
      fr: "Engagement de la haute direction envers la securite et allocation des ressources",
    },
    sortOrder: 1,
  },
  SA_1_2: {
    code: "SA_1_2",
    componentNumber: 1,
    areaNumber: 2,
    name: {
      en: "Safety Accountabilities",
      fr: "Responsabilites en Matiere de Securite",
    },
    description: {
      en: "Definition and documentation of safety accountabilities throughout the organization",
      fr: "Definition et documentation des responsabilites de securite dans toute l'organisation",
    },
    sortOrder: 2,
  },
  SA_1_3: {
    code: "SA_1_3",
    componentNumber: 1,
    areaNumber: 3,
    name: {
      en: "Appointment of Key Safety Personnel",
      fr: "Designation du Personnel Cle de Securite",
    },
    description: {
      en: "Appointment of a safety manager and safety review board",
      fr: "Designation d'un responsable securite et d'un comite d'examen de la securite",
    },
    sortOrder: 3,
  },
  SA_1_4: {
    code: "SA_1_4",
    componentNumber: 1,
    areaNumber: 4,
    name: {
      en: "Coordination of Emergency Response Planning",
      fr: "Coordination de la Planification des Interventions d'Urgence",
    },
    description: {
      en: "Emergency response planning and coordination with relevant organizations",
      fr: "Planification des interventions d'urgence et coordination avec les organisations concernees",
    },
    sortOrder: 4,
  },
  SA_1_5: {
    code: "SA_1_5",
    componentNumber: 1,
    areaNumber: 5,
    name: {
      en: "SMS Documentation",
      fr: "Documentation SMS",
    },
    description: {
      en: "Development and maintenance of SMS documentation",
      fr: "Developpement et maintenance de la documentation SMS",
    },
    sortOrder: 5,
  },

  // Component 2: Safety Risk Management
  SA_2_1: {
    code: "SA_2_1",
    componentNumber: 2,
    areaNumber: 1,
    name: {
      en: "Hazard Identification",
      fr: "Identification des Dangers",
    },
    description: {
      en: "Processes to identify hazards associated with aviation activities",
      fr: "Processus pour identifier les dangers associes aux activites aeronautiques",
    },
    sortOrder: 6,
  },
  SA_2_2: {
    code: "SA_2_2",
    componentNumber: 2,
    areaNumber: 2,
    name: {
      en: "Safety Risk Assessment and Mitigation",
      fr: "Evaluation et Attenuation des Risques de Securite",
    },
    description: {
      en: "Assessment of safety risks and development of mitigation strategies",
      fr: "Evaluation des risques de securite et developpement de strategies d'attenuation",
    },
    sortOrder: 7,
  },

  // Component 3: Safety Assurance
  SA_3_1: {
    code: "SA_3_1",
    componentNumber: 3,
    areaNumber: 1,
    name: {
      en: "Safety Performance Monitoring and Measurement",
      fr: "Surveillance et Mesure des Performances de Securite",
    },
    description: {
      en: "Monitoring and measurement of safety performance indicators",
      fr: "Surveillance et mesure des indicateurs de performance de securite",
    },
    sortOrder: 8,
  },
  SA_3_2: {
    code: "SA_3_2",
    componentNumber: 3,
    areaNumber: 2,
    name: {
      en: "Management of Change",
      fr: "Gestion du Changement",
    },
    description: {
      en: "Processes to manage safety risks during organizational changes",
      fr: "Processus pour gerer les risques de securite lors des changements organisationnels",
    },
    sortOrder: 9,
  },
  SA_3_3: {
    code: "SA_3_3",
    componentNumber: 3,
    areaNumber: 3,
    name: {
      en: "Continuous Improvement of the SMS",
      fr: "Amelioration Continue du SMS",
    },
    description: {
      en: "Internal evaluation and continuous improvement of SMS effectiveness",
      fr: "Evaluation interne et amelioration continue de l'efficacite du SMS",
    },
    sortOrder: 10,
  },

  // Component 4: Safety Promotion
  SA_4_1: {
    code: "SA_4_1",
    componentNumber: 4,
    areaNumber: 1,
    name: {
      en: "Training and Education",
      fr: "Formation et Education",
    },
    description: {
      en: "Safety training programmes for all personnel",
      fr: "Programmes de formation a la securite pour tout le personnel",
    },
    sortOrder: 11,
  },
  SA_4_2: {
    code: "SA_4_2",
    componentNumber: 4,
    areaNumber: 2,
    name: {
      en: "Safety Communication",
      fr: "Communication sur la Securite",
    },
    description: {
      en: "Communication of safety-critical information throughout the organization",
      fr: "Communication des informations critiques de securite dans toute l'organisation",
    },
    sortOrder: 12,
  },
} as const;

// =============================================================================
// MATURITY LEVELS (5 Levels: A through E)
// =============================================================================

export const MATURITY_LEVELS: Record<MaturityLevel, MaturityLevelMeta> = {
  LEVEL_A: {
    code: "LEVEL_A",
    level: "A",
    name: {
      en: "Informal",
      fr: "Informel",
    },
    description: {
      en: "Processes are not agreed at organizational level. Informal or ad-hoc approaches which tend to be driven individually rather than by the organization",
      fr: "Les processus ne sont pas convenus au niveau organisationnel. Approches informelles ou ponctuelles qui tendent a etre menees individuellement plutot que par l'organisation",
    },
    score: 1,
    sortOrder: 1,
  },
  LEVEL_B: {
    code: "LEVEL_B",
    level: "B",
    name: {
      en: "Defined",
      fr: "Defini",
    },
    description: {
      en: "Processes are defined but not yet fully implemented or not yet consistently applied across the organization",
      fr: "Les processus sont definis mais pas encore pleinement mis en oeuvre ou pas encore appliques de maniere coherente dans toute l'organisation",
    },
    score: 2,
    sortOrder: 2,
  },
  LEVEL_C: {
    code: "LEVEL_C",
    level: "C",
    name: {
      en: "Managed",
      fr: "Gere",
    },
    description: {
      en: "Processes are documented and consistently applied, with evidence of compliance and active management oversight",
      fr: "Les processus sont documentes et appliques de maniere coherente, avec des preuves de conformite et une surveillance active de la direction",
    },
    score: 3,
    sortOrder: 3,
  },
  LEVEL_D: {
    code: "LEVEL_D",
    level: "D",
    name: {
      en: "Resilient",
      fr: "Resilient",
    },
    description: {
      en: "Evidence of positive, efficient results. Processes are measured, with feedback loops driving continuous improvement",
      fr: "Preuves de resultats positifs et efficaces. Les processus sont mesures, avec des boucles de retroaction favorisant l'amelioration continue",
    },
    score: 4,
    sortOrder: 4,
  },
  LEVEL_E: {
    code: "LEVEL_E",
    level: "E",
    name: {
      en: "Excellence",
      fr: "Excellence",
    },
    description: {
      en: "Sets international best practice. Organization is a recognized leader in safety management and performance",
      fr: "Etablit les meilleures pratiques internationales. L'organisation est un leader reconnu en gestion et performance de la securite",
    },
    score: 5,
    sortOrder: 5,
  },
} as const;

// =============================================================================
// TRANSVERSAL AREAS (3 Cross-Cutting Areas)
// =============================================================================

export const TRANSVERSAL_AREAS: Record<TransversalArea, TransversalAreaMeta> = {
  SPM: {
    code: "SPM",
    name: {
      en: "Safety Performance Management",
      fr: "Gestion des Performances de Securite",
    },
    description: {
      en: "Data-driven approach to monitoring and improving safety performance through indicators and targets",
      fr: "Approche basee sur les donnees pour surveiller et ameliorer les performances de securite via des indicateurs et des cibles",
    },
    sortOrder: 1,
  },
  HP: {
    code: "HP",
    name: {
      en: "Human Performance",
      fr: "Performance Humaine",
    },
    description: {
      en: "Understanding and optimizing human factors in aviation operations and safety management",
      fr: "Comprendre et optimiser les facteurs humains dans les operations aeronautiques et la gestion de la securite",
    },
    sortOrder: 2,
  },
  CI: {
    code: "CI",
    name: {
      en: "Continuous Improvement",
      fr: "Amelioration Continue",
    },
    description: {
      en: "Systematic approach to identifying and implementing improvements in safety processes and outcomes",
      fr: "Approche systematique pour identifier et mettre en oeuvre des ameliorations dans les processus et resultats de securite",
    },
    sortOrder: 3,
  },
} as const;

// =============================================================================
// ICAO REFERENCE TYPES
// =============================================================================

export const ICAO_REFERENCE_TYPES: Record<
  ICAOReferenceType,
  ICAOReferenceTypeMeta
> = {
  CC: {
    code: "CC",
    name: {
      en: "Chicago Convention",
      fr: "Convention de Chicago",
    },
    description: {
      en: "Convention on International Civil Aviation (Chicago, 1944)",
      fr: "Convention relative a l'aviation civile internationale (Chicago, 1944)",
    },
    sortOrder: 1,
  },
  STD: {
    code: "STD",
    name: {
      en: "Standard",
      fr: "Norme",
    },
    description: {
      en: "ICAO Standards from Annexes to the Chicago Convention",
      fr: "Normes de l'OACI issues des Annexes a la Convention de Chicago",
    },
    sortOrder: 2,
  },
  RP: {
    code: "RP",
    name: {
      en: "Recommended Practice",
      fr: "Pratique Recommandee",
    },
    description: {
      en: "ICAO Recommended Practices from Annexes to the Chicago Convention",
      fr: "Pratiques recommandees de l'OACI issues des Annexes a la Convention de Chicago",
    },
    sortOrder: 3,
  },
  PANS: {
    code: "PANS",
    name: {
      en: "PANS",
      fr: "PANS",
    },
    description: {
      en: "Procedures for Air Navigation Services",
      fr: "Procedures pour les services de navigation aerienne",
    },
    sortOrder: 4,
  },
  GM: {
    code: "GM",
    name: {
      en: "Guidance Material",
      fr: "Elements Indicatifs",
    },
    description: {
      en: "ICAO Guidance Material and Manuals",
      fr: "Elements indicatifs et manuels de l'OACI",
    },
    sortOrder: 5,
  },
  Cir: {
    code: "Cir",
    name: {
      en: "Circular",
      fr: "Circulaire",
    },
    description: {
      en: "ICAO Circulars providing supplementary information",
      fr: "Circulaires de l'OACI fournissant des informations supplementaires",
    },
    sortOrder: 6,
  },
  SUPPS: {
    code: "SUPPS",
    name: {
      en: "Regional Supplements",
      fr: "Supplements Regionaux",
    },
    description: {
      en: "Regional supplementary procedures (Doc 7030)",
      fr: "Procedures supplementaires regionales (Doc 7030)",
    },
    sortOrder: 7,
  },
} as const;

// =============================================================================
// HELPER FUNCTIONS
// =============================================================================

/**
 * Get audit areas as sorted array
 */
export function getAuditAreasArray(): AuditAreaMeta[] {
  return Object.values(USOAP_AUDIT_AREAS).sort(
    (a, b) => a.sortOrder - b.sortOrder
  );
}

/**
 * Get critical elements as sorted array
 */
export function getCriticalElementsArray(): CriticalElementMeta[] {
  return Object.values(CRITICAL_ELEMENTS).sort(
    (a, b) => a.sortOrder - b.sortOrder
  );
}

/**
 * Get SMS components as sorted array
 */
export function getSMSComponentsArray(): SMSComponentMeta[] {
  return Object.values(SMS_COMPONENTS).sort(
    (a, b) => a.sortOrder - b.sortOrder
  );
}

/**
 * Get study areas as sorted array
 */
export function getStudyAreasArray(): StudyAreaMeta[] {
  return Object.values(CANSO_STUDY_AREAS).sort(
    (a, b) => a.sortOrder - b.sortOrder
  );
}

/**
 * Get study areas for a specific SMS component
 */
export function getStudyAreasByComponent(
  componentNumber: number
): StudyAreaMeta[] {
  return Object.values(CANSO_STUDY_AREAS)
    .filter((sa) => sa.componentNumber === componentNumber)
    .sort((a, b) => a.sortOrder - b.sortOrder);
}

/**
 * Get maturity levels as sorted array
 */
export function getMaturityLevelsArray(): MaturityLevelMeta[] {
  return Object.values(MATURITY_LEVELS).sort(
    (a, b) => a.sortOrder - b.sortOrder
  );
}

/**
 * Get transversal areas as sorted array
 */
export function getTransversalAreasArray(): TransversalAreaMeta[] {
  return Object.values(TRANSVERSAL_AREAS).sort(
    (a, b) => a.sortOrder - b.sortOrder
  );
}

/**
 * Get ICAO reference types as sorted array
 */
export function getICAOReferenceTypesArray(): ICAOReferenceTypeMeta[] {
  return Object.values(ICAO_REFERENCE_TYPES).sort(
    (a, b) => a.sortOrder - b.sortOrder
  );
}

/**
 * Calculate maturity level from average score
 */
export function getMaturityLevelFromScore(score: number): MaturityLevel {
  if (score >= 4.5) return "LEVEL_E";
  if (score >= 3.5) return "LEVEL_D";
  if (score >= 2.5) return "LEVEL_C";
  if (score >= 1.5) return "LEVEL_B";
  return "LEVEL_A";
}

/**
 * Calculate weighted SMS score
 */
export function calculateWeightedSMSScore(
  componentScores: Record<SMSComponent, number>
): number {
  return Object.entries(componentScores).reduce((total, [component, score]) => {
    const weight = SMS_COMPONENTS[component as SMSComponent].weight;
    return total + score * weight;
  }, 0);
}

/**
 * Calculate EI (Effective Implementation) score for USOAP
 * Formula: (Satisfactory PQs / Total Applicable PQs) * 100
 */
export function calculateEIScore(
  satisfactory: number,
  totalApplicable: number
): number {
  if (totalApplicable === 0) return 0;
  return (satisfactory / totalApplicable) * 100;
}

// =============================================================================
// QUESTIONNAIRE METADATA
// =============================================================================

export const QUESTIONNAIRE_METADATA = {
  ANS_USOAP_CMA: {
    code: "ANS_USOAP_CMA",
    titleEn: "ANS Questionnaire (USOAP CMA 2024)",
    titleFr: "Questionnaire ANS (USOAP CMA 2024)",
    descriptionEn:
      "ICAO Universal Safety Oversight Audit Programme - Continuous Monitoring Approach. 851 Protocol Questions across 9 audit areas aligned with 8 Critical Elements.",
    descriptionFr:
      "Programme universel d'audit de surveillance de la securite de l'OACI - Approche de surveillance continue. 851 Questions de Protocole dans 9 domaines d'audit alignes sur 8 Elements Critiques.",
    version: "2024.1",
    totalQuestions: 851,
    auditAreas: 9,
    criticalElements: 8,
    responseType: "SATISFACTORY_NOT" as const,
    scoringMethod: "EI" as const,
  },
  SMS_CANSO_SOE: {
    code: "SMS_CANSO_SOE",
    titleEn: "SMS Questionnaire (CANSO SoE 2024)",
    titleFr: "Questionnaire SMS (CANSO SoE 2024)",
    descriptionEn:
      "CANSO Standard of Excellence in Safety Management System. Maturity-based assessment across 4 SMS components and 12 study areas.",
    descriptionFr:
      "Norme d'excellence CANSO en Systeme de Gestion de la Securite. Evaluation basee sur la maturite a travers 4 composantes SMS et 12 domaines d'etude.",
    version: "2024.1",
    totalQuestions: 48, // Approximate
    components: 4,
    studyAreas: 12,
    maturityLevels: 5,
    responseType: "MATURITY_LEVEL" as const,
    scoringMethod: "MATURITY" as const,
  },
} as const;

```

# src/lib/questionnaire/import-parser.ts

```ts
import type {
  ANSQuestionImport,
  SMSQuestionImport,
  CategoryImport,
  QuestionnaireImport,
  ValidationError,
  ICAOReferenceImport,
} from "./import-schema";
import {
  validateANSQuestion,
  validateSMSQuestion,
  CategoryImportSchema,
  QuestionnaireImportSchema,
  ICAOReferenceImportSchema,
} from "./import-schema";

// =============================================================================
// CSV PARSING
// =============================================================================

interface CSVParseResult<T> {
  data: T[];
  errors: ValidationError[];
  headers: string[];
}

/**
 * Parse CSV string to array of objects
 */
export function parseCSV<T extends Record<string, unknown>>(
  csvString: string,
  options: {
    delimiter?: string;
    skipEmptyLines?: boolean;
  } = {}
): CSVParseResult<T> {
  const { delimiter = ",", skipEmptyLines = true } = options;
  const errors: ValidationError[] = [];

  // Split into lines and filter empty if needed
  let lines = csvString.split(/\r?\n/);
  if (skipEmptyLines) {
    lines = lines.filter((line) => line.trim() !== "");
  }

  if (lines.length < 2) {
    return {
      data: [],
      errors: [{ row: 0, field: "", message: "CSV must have at least a header row and one data row" }],
      headers: [],
    };
  }

  // Parse header row
  const headers = parseCSVLine(lines[0], delimiter);

  // Parse data rows
  const data: T[] = [];
  for (let i = 1; i < lines.length; i++) {
    const values = parseCSVLine(lines[i], delimiter);

    if (values.length !== headers.length) {
      errors.push({
        row: i,
        field: "",
        message: `Row has ${values.length} columns, expected ${headers.length}`,
      });
      continue;
    }

    const row = headers.reduce(
      (obj, header, index) => {
        obj[header] = parseValue(values[index]);
        return obj;
      },
      {} as Record<string, unknown>
    );

    data.push(row as T);
  }

  return { data, errors, headers };
}

/**
 * Parse a single CSV line, handling quoted values
 */
function parseCSVLine(line: string, delimiter: string): string[] {
  const values: string[] = [];
  let current = "";
  let inQuotes = false;

  for (let i = 0; i < line.length; i++) {
    const char = line[i];

    if (char === '"') {
      if (inQuotes && line[i + 1] === '"') {
        // Escaped quote
        current += '"';
        i++;
      } else {
        // Toggle quote mode
        inQuotes = !inQuotes;
      }
    } else if (char === delimiter && !inQuotes) {
      values.push(current.trim());
      current = "";
    } else {
      current += char;
    }
  }

  values.push(current.trim());
  return values;
}

/**
 * Parse string value to appropriate type
 */
function parseValue(value: string): unknown {
  const trimmed = value.trim();

  // Empty string
  if (trimmed === "" || trimmed.toLowerCase() === "null") {
    return null;
  }

  // Boolean
  if (trimmed.toLowerCase() === "true") return true;
  if (trimmed.toLowerCase() === "false") return false;

  // Number
  if (/^-?\d+(\.\d+)?$/.test(trimmed)) {
    const num = parseFloat(trimmed);
    if (!isNaN(num)) return num;
  }

  // Array (JSON)
  if (trimmed.startsWith("[") && trimmed.endsWith("]")) {
    try {
      return JSON.parse(trimmed);
    } catch {
      return trimmed;
    }
  }

  // Object (JSON)
  if (trimmed.startsWith("{") && trimmed.endsWith("}")) {
    try {
      return JSON.parse(trimmed);
    } catch {
      return trimmed;
    }
  }

  return trimmed;
}

// =============================================================================
// JSON PARSING
// =============================================================================

interface JSONParseResult<T> {
  data: T | null;
  errors: ValidationError[];
}

/**
 * Parse JSON string to object
 */
export function parseJSON<T>(jsonString: string): JSONParseResult<T> {
  try {
    const data = JSON.parse(jsonString) as T;
    return { data, errors: [] };
  } catch (error) {
    return {
      data: null,
      errors: [
        {
          row: 0,
          field: "",
          message: `Invalid JSON: ${error instanceof Error ? error.message : "Unknown error"}`,
        },
      ],
    };
  }
}

// =============================================================================
// DATA NORMALIZATION
// =============================================================================

/**
 * Normalize field names from various formats to camelCase
 */
export function normalizeFieldNames(data: Record<string, unknown>): Record<string, unknown> {
  const fieldMappings: Record<string, string> = {
    // Common variations
    pq_number: "pqNumber",
    "pq number": "pqNumber",
    PQ_NUMBER: "pqNumber",
    question_text_en: "questionTextEn",
    "question text en": "questionTextEn",
    question_text_fr: "questionTextFr",
    "question text fr": "questionTextFr",
    audit_area: "auditArea",
    "audit area": "auditArea",
    critical_element: "criticalElement",
    "critical element": "criticalElement",
    is_priority_pq: "isPriorityPQ",
    "is priority pq": "isPriorityPQ",
    priority_pq: "isPriorityPQ",
    requires_on_site: "requiresOnSite",
    "requires on site": "requiresOnSite",
    on_site: "requiresOnSite",
    pq_status: "pqStatus",
    "pq status": "pqStatus",
    previous_pq_number: "previousPqNumber",
    "previous pq number": "previousPqNumber",
    guidance_en: "guidanceEn",
    "guidance en": "guidanceEn",
    guidance_fr: "guidanceFr",
    "guidance fr": "guidanceFr",
    response_type: "responseType",
    "response type": "responseType",
    required_evidence: "requiredEvidence",
    "required evidence": "requiredEvidence",
    sort_order: "sortOrder",
    "sort order": "sortOrder",
    max_score: "maxScore",
    "max score": "maxScore",
    icao_references: "icaoReferences",
    "icao references": "icaoReferences",
    sms_component: "smsComponent",
    "sms component": "smsComponent",
    study_area: "studyArea",
    "study area": "studyArea",
    maturity_level: "maturityLevel",
    "maturity level": "maturityLevel",
    transversal_area: "transversalArea",
    "transversal area": "transversalArea",
    name_en: "nameEn",
    "name en": "nameEn",
    name_fr: "nameFr",
    "name fr": "nameFr",
    description_en: "descriptionEn",
    "description en": "descriptionEn",
    description_fr: "descriptionFr",
    "description fr": "descriptionFr",
    title_en: "titleEn",
    "title en": "titleEn",
    title_fr: "titleFr",
    "title fr": "titleFr",
    effective_date: "effectiveDate",
    "effective date": "effectiveDate",
    expiry_date: "expiryDate",
    "expiry date": "expiryDate",
    reference_type: "referenceType",
    "reference type": "referenceType",
  };

  const normalized: Record<string, unknown> = {};

  for (const [key, value] of Object.entries(data)) {
    const normalizedKey = fieldMappings[key.toLowerCase()] || toCamelCase(key);
    normalized[normalizedKey] = value;
  }

  return normalized;
}

/**
 * Convert string to camelCase
 */
function toCamelCase(str: string): string {
  return str
    .toLowerCase()
    .replace(/[_\s-]+(.)?/g, (_, char) => (char ? char.toUpperCase() : ""));
}

/**
 * Normalize audit area code
 */
export function normalizeAuditArea(value: unknown): string | null {
  if (!value) return null;
  const str = String(value).toUpperCase().trim();
  const validAreas = ["LEG", "ORG", "PEL", "OPS", "AIR", "AIG", "ANS", "AGA", "SSP"];
  return validAreas.includes(str) ? str : null;
}

/**
 * Normalize critical element code
 */
export function normalizeCriticalElement(value: unknown): string | null {
  if (!value) return null;
  const str = String(value).toUpperCase().trim();

  // Handle various formats: CE_1, CE-1, CE1, 1
  const match = str.match(/^CE[_-]?(\d)$|^(\d)$/);
  if (match) {
    const num = match[1] || match[2];
    return `CE_${num}`;
  }
  return null;
}

/**
 * Normalize SMS component code
 */
export function normalizeSMSComponent(value: unknown): string | null {
  if (!value) return null;
  const str = String(value).toUpperCase().trim();

  const mappings: Record<string, string> = {
    "1": "SAFETY_POLICY_OBJECTIVES",
    "COMPONENT 1": "SAFETY_POLICY_OBJECTIVES",
    "SAFETY POLICY": "SAFETY_POLICY_OBJECTIVES",
    SAFETY_POLICY_OBJECTIVES: "SAFETY_POLICY_OBJECTIVES",
    "2": "SAFETY_RISK_MANAGEMENT",
    "COMPONENT 2": "SAFETY_RISK_MANAGEMENT",
    "RISK MANAGEMENT": "SAFETY_RISK_MANAGEMENT",
    SAFETY_RISK_MANAGEMENT: "SAFETY_RISK_MANAGEMENT",
    "3": "SAFETY_ASSURANCE",
    "COMPONENT 3": "SAFETY_ASSURANCE",
    "SAFETY ASSURANCE": "SAFETY_ASSURANCE",
    "4": "SAFETY_PROMOTION",
    "COMPONENT 4": "SAFETY_PROMOTION",
    "SAFETY PROMOTION": "SAFETY_PROMOTION",
  };

  return mappings[str] || null;
}

/**
 * Normalize study area code
 */
export function normalizeStudyArea(value: unknown): string | null {
  if (!value) return null;
  const str = String(value).toUpperCase().trim();

  // Handle formats: SA_1_1, SA 1.1, 1.1
  const match = str.match(/^SA[_\s]?(\d)[_.\s](\d)$|^(\d)[.\s](\d)$/);
  if (match) {
    const comp = match[1] || match[3];
    const area = match[2] || match[4];
    return `SA_${comp}_${area}`;
  }
  return null;
}

// =============================================================================
// DUPLICATE DETECTION
// =============================================================================

interface DuplicateResult {
  duplicates: Array<{
    pqNumber: string;
    indices: number[];
  }>;
  hasDuplicates: boolean;
}

/**
 * Detect duplicate PQ numbers in import data
 */
export function detectDuplicates(
  questions: Array<{ pqNumber?: string | null }>
): DuplicateResult {
  const pqMap = new Map<string, number[]>();

  questions.forEach((q, index) => {
    if (q.pqNumber) {
      const existing = pqMap.get(q.pqNumber) || [];
      existing.push(index);
      pqMap.set(q.pqNumber, existing);
    }
  });

  const duplicates = Array.from(pqMap.entries())
    .filter(([, indices]) => indices.length > 1)
    .map(([pqNumber, indices]) => ({ pqNumber, indices }));

  return {
    duplicates,
    hasDuplicates: duplicates.length > 0,
  };
}

// =============================================================================
// REFERENCE VALIDATION
// =============================================================================

/**
 * Parse ICAO references from string or array
 */
export function parseICAOReferences(
  value: unknown
): ICAOReferenceImport[] {
  if (!value) return [];

  // Already an array
  if (Array.isArray(value)) {
    return value
      .map((ref) => {
        if (typeof ref === "object" && ref !== null) {
          const result = ICAOReferenceImportSchema.safeParse(ref);
          return result.success ? result.data : null;
        }
        return null;
      })
      .filter((ref): ref is ICAOReferenceImport => ref !== null);
  }

  // String format: "STD:Annex 11:Chapter 2|RP:Annex 15:Section 3"
  if (typeof value === "string") {
    const refs: ICAOReferenceImport[] = [];
    const parts = value.split("|").map((p) => p.trim());

    for (const part of parts) {
      const [type, document, chapter] = part.split(":").map((s) => s.trim());
      if (type && document) {
        const refType = type.toUpperCase();
        const validTypes = ["CC", "STD", "RP", "PANS", "GM", "Cir", "SUPPS"];
        if (validTypes.includes(refType)) {
          refs.push({
            referenceType: refType as ICAOReferenceImport["referenceType"],
            document,
            chapter: chapter || null,
            description: null,
          });
        }
      }
    }

    return refs;
  }

  return [];
}

// =============================================================================
// FULL IMPORT PARSING
// =============================================================================

interface ParsedImport<T> {
  questionnaire: QuestionnaireImport | null;
  categories: CategoryImport[];
  questions: T[];
  errors: ValidationError[];
  warnings: string[];
}

/**
 * Parse and validate ANS bulk import data
 */
export function parseANSImport(
  data: unknown
): ParsedImport<ANSQuestionImport> {
  const errors: ValidationError[] = [];
  const warnings: string[] = [];

  if (typeof data !== "object" || data === null) {
    return {
      questionnaire: null,
      categories: [],
      questions: [],
      errors: [{ row: 0, field: "", message: "Invalid import data format" }],
      warnings: [],
    };
  }

  const importData = data as Record<string, unknown>;

  // Parse questionnaire metadata
  let questionnaire: QuestionnaireImport | null = null;
  if (importData.questionnaire) {
    const normalized = normalizeFieldNames(
      importData.questionnaire as Record<string, unknown>
    );
    const result = QuestionnaireImportSchema.safeParse({
      ...normalized,
      type: "ANS_USOAP_CMA",
    });
    if (result.success) {
      questionnaire = result.data;
    } else {
      errors.push(
        ...result.error.issues.map((e) => ({
          row: 0,
          field: `questionnaire.${e.path.join(".")}`,
          message: e.message,
        }))
      );
    }
  }

  // Parse categories
  const categories: CategoryImport[] = [];
  if (Array.isArray(importData.categories)) {
    importData.categories.forEach((cat, index) => {
      const normalized = normalizeFieldNames(cat as Record<string, unknown>);
      const result = CategoryImportSchema.safeParse(normalized);
      if (result.success) {
        categories.push(result.data);
      } else {
        errors.push(
          ...result.error.issues.map((e) => ({
            row: index,
            field: `categories[${index}].${e.path.join(".")}`,
            message: e.message,
          }))
        );
      }
    });
  }

  // Parse questions
  const questions: ANSQuestionImport[] = [];
  if (Array.isArray(importData.questions)) {
    importData.questions.forEach((q, index) => {
      const normalized = normalizeFieldNames(q as Record<string, unknown>);

      // Normalize specific fields
      if (normalized.auditArea) {
        normalized.auditArea = normalizeAuditArea(normalized.auditArea);
      }
      if (normalized.criticalElement) {
        normalized.criticalElement = normalizeCriticalElement(normalized.criticalElement);
      }
      if (normalized.icaoReferences) {
        normalized.icaoReferences = parseICAOReferences(normalized.icaoReferences);
      }

      const result = validateANSQuestion(normalized, index);
      if (result.isValid && result.data) {
        questions.push(result.data);
      } else {
        errors.push(...result.errors);
      }
    });
  }

  // Check for duplicates
  const duplicateResult = detectDuplicates(questions);
  if (duplicateResult.hasDuplicates) {
    duplicateResult.duplicates.forEach(({ pqNumber, indices }) => {
      warnings.push(
        `Duplicate PQ number "${pqNumber}" found at rows: ${indices.map((i) => i + 1).join(", ")}`
      );
    });
  }

  return {
    questionnaire,
    categories,
    questions,
    errors,
    warnings,
  };
}

/**
 * Parse and validate SMS bulk import data
 */
export function parseSMSImport(
  data: unknown
): ParsedImport<SMSQuestionImport> {
  const errors: ValidationError[] = [];
  const warnings: string[] = [];

  if (typeof data !== "object" || data === null) {
    return {
      questionnaire: null,
      categories: [],
      questions: [],
      errors: [{ row: 0, field: "", message: "Invalid import data format" }],
      warnings: [],
    };
  }

  const importData = data as Record<string, unknown>;

  // Parse questionnaire metadata
  let questionnaire: QuestionnaireImport | null = null;
  if (importData.questionnaire) {
    const normalized = normalizeFieldNames(
      importData.questionnaire as Record<string, unknown>
    );
    const result = QuestionnaireImportSchema.safeParse({
      ...normalized,
      type: "SMS_CANSO_SOE",
    });
    if (result.success) {
      questionnaire = result.data;
    } else {
      errors.push(
        ...result.error.issues.map((e) => ({
          row: 0,
          field: `questionnaire.${e.path.join(".")}`,
          message: e.message,
        }))
      );
    }
  }

  // Parse categories
  const categories: CategoryImport[] = [];
  if (Array.isArray(importData.categories)) {
    importData.categories.forEach((cat, index) => {
      const normalized = normalizeFieldNames(cat as Record<string, unknown>);
      const result = CategoryImportSchema.safeParse(normalized);
      if (result.success) {
        categories.push(result.data);
      } else {
        errors.push(
          ...result.error.issues.map((e) => ({
            row: index,
            field: `categories[${index}].${e.path.join(".")}`,
            message: e.message,
          }))
        );
      }
    });
  }

  // Parse questions
  const questions: SMSQuestionImport[] = [];
  if (Array.isArray(importData.questions)) {
    importData.questions.forEach((q, index) => {
      const normalized = normalizeFieldNames(q as Record<string, unknown>);

      // Normalize specific fields
      if (normalized.smsComponent) {
        normalized.smsComponent = normalizeSMSComponent(normalized.smsComponent);
      }
      if (normalized.studyArea) {
        normalized.studyArea = normalizeStudyArea(normalized.studyArea);
      }
      if (normalized.icaoReferences) {
        normalized.icaoReferences = parseICAOReferences(normalized.icaoReferences);
      }

      const result = validateSMSQuestion(normalized, index);
      if (result.isValid && result.data) {
        questions.push(result.data);
      } else {
        errors.push(...result.errors);
      }
    });
  }

  return {
    questionnaire,
    categories,
    questions,
    errors,
    warnings,
  };
}

/**
 * Auto-detect import type from data
 */
export function detectImportType(
  data: unknown
): "ANS_USOAP_CMA" | "SMS_CANSO_SOE" | null {
  if (typeof data !== "object" || data === null) return null;

  const importData = data as Record<string, unknown>;

  // Check questionnaire type first
  if (importData.questionnaire) {
    const q = importData.questionnaire as Record<string, unknown>;
    if (q.type === "ANS_USOAP_CMA") return "ANS_USOAP_CMA";
    if (q.type === "SMS_CANSO_SOE") return "SMS_CANSO_SOE";
  }

  // Check questions for type indicators
  if (Array.isArray(importData.questions) && importData.questions.length > 0) {
    const firstQ = importData.questions[0] as Record<string, unknown>;

    // ANS indicators
    if (firstQ.auditArea || firstQ.audit_area || firstQ.criticalElement || firstQ.critical_element) {
      return "ANS_USOAP_CMA";
    }

    // SMS indicators
    if (firstQ.smsComponent || firstQ.sms_component || firstQ.studyArea || firstQ.study_area) {
      return "SMS_CANSO_SOE";
    }
  }

  return null;
}

```

# src/lib/questionnaire/import-schema.ts

```ts
import { z } from "zod";

// =============================================================================
// ENUM SCHEMAS
// =============================================================================

export const USOAPAuditAreaSchema = z.enum([
  "LEG",
  "ORG",
  "PEL",
  "OPS",
  "AIR",
  "AIG",
  "ANS",
  "AGA",
  "SSP",
]);

export const CriticalElementSchema = z.enum([
  "CE_1",
  "CE_2",
  "CE_3",
  "CE_4",
  "CE_5",
  "CE_6",
  "CE_7",
  "CE_8",
]);

export const SMSComponentSchema = z.enum([
  "SAFETY_POLICY_OBJECTIVES",
  "SAFETY_RISK_MANAGEMENT",
  "SAFETY_ASSURANCE",
  "SAFETY_PROMOTION",
]);

export const CANSOStudyAreaSchema = z.enum([
  "SA_1_1",
  "SA_1_2",
  "SA_1_3",
  "SA_1_4",
  "SA_1_5",
  "SA_2_1",
  "SA_2_2",
  "SA_3_1",
  "SA_3_2",
  "SA_3_3",
  "SA_4_1",
  "SA_4_2",
]);

export const MaturityLevelSchema = z.enum([
  "LEVEL_A",
  "LEVEL_B",
  "LEVEL_C",
  "LEVEL_D",
  "LEVEL_E",
]);

export const TransversalAreaSchema = z.enum(["SPM", "HP", "CI"]);

export const PQAmendmentStatusSchema = z.enum([
  "NO_CHANGE",
  "REVISED",
  "NEW",
  "MERGED",
  "DELETED",
  "REFERENCE_REVISED",
]);

export const ResponseTypeSchema = z.enum([
  "SATISFACTORY_NOT",
  "MATURITY_LEVEL",
  "YES_NO",
  "SCALE_1_5",
  "TEXT",
  "MULTI_SELECT",
]);

export const ICAOReferenceTypeSchema = z.enum([
  "CC",
  "STD",
  "RP",
  "PANS",
  "GM",
  "Cir",
  "SUPPS",
]);

// =============================================================================
// ICAO REFERENCE IMPORT SCHEMA
// =============================================================================

export const ICAOReferenceImportSchema = z.object({
  referenceType: ICAOReferenceTypeSchema,
  document: z.string().min(1, "Document name is required"),
  chapter: z.string().optional().nullable(),
  description: z.string().optional().nullable(),
});

export type ICAOReferenceImport = z.infer<typeof ICAOReferenceImportSchema>;

// =============================================================================
// ANS USOAP CMA QUESTION IMPORT SCHEMA
// =============================================================================

export const ANSQuestionImportSchema = z.object({
  // Required fields
  pqNumber: z
    .string()
    .min(1, "PQ number is required")
    .regex(/^[A-Z]+-\d+(\.\d+)?$/, "PQ number must be in format AA-NNN or AA-NNN.N"),
  questionTextEn: z.string().min(1, "English question text is required"),
  questionTextFr: z.string().min(1, "French question text is required"),
  auditArea: USOAPAuditAreaSchema,
  criticalElement: CriticalElementSchema,
  sortOrder: z.number().int().positive(),

  // Optional fields
  isPriorityPQ: z.boolean().default(false),
  requiresOnSite: z.boolean().default(false),
  pqStatus: PQAmendmentStatusSchema.default("NO_CHANGE"),
  previousPqNumber: z.string().optional().nullable(),
  guidanceEn: z.string().optional().nullable(),
  guidanceFr: z.string().optional().nullable(),
  responseType: ResponseTypeSchema.default("SATISFACTORY_NOT"),
  requiredEvidence: z.array(z.string()).default([]),
  weight: z.number().positive().default(1.0),
  maxScore: z.number().positive().default(1.0),

  // ICAO References
  icaoReferences: z.array(ICAOReferenceImportSchema).default([]),
});

export type ANSQuestionImport = z.infer<typeof ANSQuestionImportSchema>;

// =============================================================================
// SMS CANSO SoE QUESTION IMPORT SCHEMA
// =============================================================================

export const SMSQuestionImportSchema = z.object({
  // Required fields
  smsComponent: SMSComponentSchema,
  studyArea: CANSOStudyAreaSchema,
  questionTextEn: z.string().min(1, "English question text is required"),
  questionTextFr: z.string().min(1, "French question text is required"),
  sortOrder: z.number().int().positive(),

  // Optional fields
  pqNumber: z.string().optional().nullable(),
  maturityLevel: MaturityLevelSchema.optional().nullable(),
  transversalArea: TransversalAreaSchema.optional().nullable(),
  guidanceEn: z.string().optional().nullable(),
  guidanceFr: z.string().optional().nullable(),
  responseType: ResponseTypeSchema.default("MATURITY_LEVEL"),
  requiredEvidence: z.array(z.string()).default([]),
  weight: z.number().positive().default(1.0),
  maxScore: z.number().positive().default(5.0),

  // ICAO References (optional for SMS)
  icaoReferences: z.array(ICAOReferenceImportSchema).default([]),
});

export type SMSQuestionImport = z.infer<typeof SMSQuestionImportSchema>;

// =============================================================================
// CATEGORY IMPORT SCHEMA
// =============================================================================

export const CategoryImportSchema = z.object({
  code: z.string().min(1, "Category code is required"),
  nameEn: z.string().min(1, "English name is required"),
  nameFr: z.string().min(1, "French name is required"),
  descriptionEn: z.string().optional().nullable(),
  descriptionFr: z.string().optional().nullable(),
  sortOrder: z.number().int().positive(),

  // For ANS questionnaires
  auditArea: USOAPAuditAreaSchema.optional().nullable(),
  criticalElement: CriticalElementSchema.optional().nullable(),

  // For SMS questionnaires
  smsComponent: SMSComponentSchema.optional().nullable(),
  studyArea: CANSOStudyAreaSchema.optional().nullable(),
  transversalArea: TransversalAreaSchema.optional().nullable(),
});

export type CategoryImport = z.infer<typeof CategoryImportSchema>;

// =============================================================================
// QUESTIONNAIRE IMPORT SCHEMA
// =============================================================================

export const QuestionnaireTypeSchema = z.enum(["ANS_USOAP_CMA", "SMS_CANSO_SOE"]);

export const QuestionnaireImportSchema = z.object({
  code: z.string().min(1, "Questionnaire code is required"),
  type: QuestionnaireTypeSchema,
  version: z.string().min(1, "Version is required"),
  titleEn: z.string().min(1, "English title is required"),
  titleFr: z.string().min(1, "French title is required"),
  descriptionEn: z.string().optional().nullable(),
  descriptionFr: z.string().optional().nullable(),
  effectiveDate: z.coerce.date(),
  expiryDate: z.coerce.date().optional().nullable(),
});

export type QuestionnaireImport = z.infer<typeof QuestionnaireImportSchema>;

// =============================================================================
// BULK IMPORT SCHEMA
// =============================================================================

export const ANSBulkImportSchema = z.object({
  questionnaire: QuestionnaireImportSchema.extend({
    type: z.literal("ANS_USOAP_CMA"),
  }),
  categories: z.array(CategoryImportSchema).min(1, "At least one category is required"),
  questions: z.array(ANSQuestionImportSchema).min(1, "At least one question is required"),
});

export type ANSBulkImport = z.infer<typeof ANSBulkImportSchema>;

export const SMSBulkImportSchema = z.object({
  questionnaire: QuestionnaireImportSchema.extend({
    type: z.literal("SMS_CANSO_SOE"),
  }),
  categories: z.array(CategoryImportSchema).min(1, "At least one category is required"),
  questions: z.array(SMSQuestionImportSchema).min(1, "At least one question is required"),
});

export type SMSBulkImport = z.infer<typeof SMSBulkImportSchema>;

// Union type for any bulk import
export const BulkImportSchema = z.discriminatedUnion("type", [
  z.object({
    type: z.literal("ANS_USOAP_CMA"),
    data: ANSBulkImportSchema,
  }),
  z.object({
    type: z.literal("SMS_CANSO_SOE"),
    data: SMSBulkImportSchema,
  }),
]);

export type BulkImport = z.infer<typeof BulkImportSchema>;

// =============================================================================
// VALIDATION RESULT TYPES
// =============================================================================

export interface ValidationError {
  row: number;
  field: string;
  message: string;
  value?: unknown;
}

export interface ValidationResult<T> {
  isValid: boolean;
  data: T | null;
  errors: ValidationError[];
  warnings: string[];
}

export interface ImportSummary {
  totalQuestions: number;
  totalCategories: number;
  totalReferences: number;
  newQuestions: number;
  updatedQuestions: number;
  errors: ValidationError[];
  warnings: string[];
}

// =============================================================================
// HELPER FUNCTIONS
// =============================================================================

/**
 * Validate a single ANS question import row
 */
export function validateANSQuestion(
  data: unknown,
  rowIndex: number
): ValidationResult<ANSQuestionImport> {
  const result = ANSQuestionImportSchema.safeParse(data);

  if (result.success) {
    return {
      isValid: true,
      data: result.data,
      errors: [],
      warnings: [],
    };
  }

  const errors: ValidationError[] = result.error.issues.map((err) => ({
    row: rowIndex,
    field: err.path.join("."),
    message: err.message,
    value: (data as Record<string, unknown>)?.[err.path[0] as string],
  }));

  return {
    isValid: false,
    data: null,
    errors,
    warnings: [],
  };
}

/**
 * Validate a single SMS question import row
 */
export function validateSMSQuestion(
  data: unknown,
  rowIndex: number
): ValidationResult<SMSQuestionImport> {
  const result = SMSQuestionImportSchema.safeParse(data);

  if (result.success) {
    return {
      isValid: true,
      data: result.data,
      errors: [],
      warnings: [],
    };
  }

  const errors: ValidationError[] = result.error.issues.map((err) => ({
    row: rowIndex,
    field: err.path.join("."),
    message: err.message,
    value: (data as Record<string, unknown>)?.[err.path[0] as string],
  }));

  return {
    isValid: false,
    data: null,
    errors,
    warnings: [],
  };
}

/**
 * Validate bulk import data
 */
export function validateBulkImport(
  type: "ANS_USOAP_CMA" | "SMS_CANSO_SOE",
  data: unknown
): ValidationResult<ANSBulkImport | SMSBulkImport> {
  const schema = type === "ANS_USOAP_CMA" ? ANSBulkImportSchema : SMSBulkImportSchema;
  const result = schema.safeParse(data);

  if (result.success) {
    return {
      isValid: true,
      data: result.data as ANSBulkImport | SMSBulkImport,
      errors: [],
      warnings: [],
    };
  }

  const errors: ValidationError[] = result.error.issues.map((err) => ({
    row: 0,
    field: err.path.join("."),
    message: err.message,
  }));

  return {
    isValid: false,
    data: null,
    errors,
    warnings: [],
  };
}

```

# src/lib/questionnaire/index.ts

```ts
// Types
export * from "./types";

// Constants
export * from "./constants";

```

# src/lib/questionnaire/types.ts

```ts
import { z } from "zod";
import type {
  Questionnaire,
  QuestionnaireCategory,
  Question,
  ICAOReference,
  QuestionnaireType,
  USOAPAuditArea,
  CriticalElement,
  SMSComponent,
  CANSOStudyArea,
  TransversalArea,
  MaturityLevel,
  PQAmendmentStatus,
  ResponseType,
  ICAOReferenceType,
} from "@prisma/client";

// =============================================================================
// QUESTIONNAIRE INTERFACES
// =============================================================================

/**
 * Question with all related ICAO references
 */
export interface QuestionWithRelations extends Question {
  icaoReferences: ICAOReference[];
}

/**
 * Category with its questions and relations
 */
export interface CategoryWithQuestions extends QuestionnaireCategory {
  questions: QuestionWithRelations[];
}

/**
 * Full questionnaire with categories and questions
 */
export interface QuestionnaireWithRelations extends Questionnaire {
  categories: CategoryWithQuestions[];
  questions: QuestionWithRelations[];
}

/**
 * Light questionnaire for list views
 */
export interface QuestionnaireListItem
  extends Pick<
    Questionnaire,
    | "id"
    | "code"
    | "type"
    | "version"
    | "titleEn"
    | "titleFr"
    | "effectiveDate"
    | "isActive"
  > {
  _count: {
    categories: number;
    questions: number;
  };
}

// =============================================================================
// FILTER AND PAGINATION INTERFACES
// =============================================================================

/**
 * Filters for questionnaire search
 */
export interface QuestionnaireFilters {
  type?: QuestionnaireType;
  isActive?: boolean;
  search?: string;
  effectiveDateFrom?: Date;
  effectiveDateTo?: Date;
}

/**
 * Filters for question search within a questionnaire
 */
export interface QuestionFilters {
  questionnaireId?: string;
  categoryId?: string;
  auditArea?: USOAPAuditArea;
  criticalElement?: CriticalElement;
  smsComponent?: SMSComponent;
  studyArea?: CANSOStudyArea;
  transversalArea?: TransversalArea;
  maturityLevel?: MaturityLevel;
  isPriorityPQ?: boolean;
  requiresOnSite?: boolean;
  pqStatus?: PQAmendmentStatus;
  responseType?: ResponseType;
  search?: string;
}

/**
 * Pagination metadata
 */
export interface PaginationMeta {
  page: number;
  pageSize: number;
  totalItems: number;
  totalPages: number;
  hasNextPage: boolean;
  hasPreviousPage: boolean;
}

/**
 * Paginated questionnaire list
 */
export interface PaginatedQuestionnaires {
  data: QuestionnaireListItem[];
  meta: PaginationMeta;
}

/**
 * Paginated question list
 */
export interface PaginatedQuestions {
  data: QuestionWithRelations[];
  meta: PaginationMeta;
}

// =============================================================================
// METADATA INTERFACES
// =============================================================================

/**
 * Bilingual label structure
 */
export interface BilingualLabel {
  en: string;
  fr: string;
}

/**
 * Audit area metadata
 */
export interface AuditAreaMeta {
  code: USOAPAuditArea;
  name: BilingualLabel;
  description: BilingualLabel;
  pqCount: number;
  sortOrder: number;
}

/**
 * Critical element metadata
 */
export interface CriticalElementMeta {
  code: CriticalElement;
  number: number;
  name: BilingualLabel;
  description: BilingualLabel;
  sortOrder: number;
}

/**
 * SMS component metadata
 */
export interface SMSComponentMeta {
  code: SMSComponent;
  number: number;
  name: BilingualLabel;
  description: BilingualLabel;
  weight: number;
  sortOrder: number;
}

/**
 * CANSO study area metadata
 */
export interface StudyAreaMeta {
  code: CANSOStudyArea;
  componentNumber: number;
  areaNumber: number;
  name: BilingualLabel;
  description: BilingualLabel;
  sortOrder: number;
}

/**
 * Maturity level metadata
 */
export interface MaturityLevelMeta {
  code: MaturityLevel;
  level: string;
  name: BilingualLabel;
  description: BilingualLabel;
  score: number;
  sortOrder: number;
}

/**
 * Transversal area metadata
 */
export interface TransversalAreaMeta {
  code: TransversalArea;
  name: BilingualLabel;
  description: BilingualLabel;
  sortOrder: number;
}

/**
 * ICAO reference type metadata
 */
export interface ICAOReferenceTypeMeta {
  code: ICAOReferenceType;
  name: BilingualLabel;
  description: BilingualLabel;
  sortOrder: number;
}

// =============================================================================
// SCORE AND ANALYSIS INTERFACES
// =============================================================================

/**
 * Category score breakdown
 */
export interface CategoryScore {
  categoryId: string;
  categoryCode: string;
  categoryName: BilingualLabel;
  totalQuestions: number;
  answeredQuestions: number;
  score: number;
  maxScore: number;
  percentage: number;
  maturityLevel?: MaturityLevel;
}

/**
 * Audit area score breakdown
 */
export interface AuditAreaScore {
  auditArea: USOAPAuditArea;
  name: BilingualLabel;
  totalQuestions: number;
  satisfactory: number;
  notSatisfactory: number;
  notApplicable: number;
  eiScore: number;
}

/**
 * SMS component score breakdown
 */
export interface SMSComponentScore {
  component: SMSComponent;
  name: BilingualLabel;
  weight: number;
  studyAreas: StudyAreaScore[];
  averageMaturity: number;
  maturityLevel: MaturityLevel;
}

/**
 * Study area score breakdown
 */
export interface StudyAreaScore {
  studyArea: CANSOStudyArea;
  name: BilingualLabel;
  totalQuestions: number;
  answeredQuestions: number;
  averageMaturity: number;
  maturityLevel: MaturityLevel;
}

/**
 * Overall assessment score
 */
export interface AssessmentScore {
  questionnaireType: QuestionnaireType;
  overallScore: number;
  overallPercentage: number;
  overallMaturity?: MaturityLevel;
  eiScore?: number;
  categoryScores: CategoryScore[];
  auditAreaScores?: AuditAreaScore[];
  componentScores?: SMSComponentScore[];
  totalQuestions: number;
  answeredQuestions: number;
  completionPercentage: number;
}

// =============================================================================
// ZOD VALIDATION SCHEMAS
// =============================================================================

export const QuestionnaireFiltersSchema = z.object({
  type: z.enum(["ANS_USOAP_CMA", "SMS_CANSO_SOE"]).optional(),
  isActive: z.boolean().optional(),
  search: z.string().max(100).optional(),
  effectiveDateFrom: z.coerce.date().optional(),
  effectiveDateTo: z.coerce.date().optional(),
});

export const QuestionFiltersSchema = z.object({
  questionnaireId: z.string().cuid().optional(),
  categoryId: z.string().cuid().optional(),
  auditArea: z
    .enum(["LEG", "ORG", "PEL", "OPS", "AIR", "AIG", "ANS", "AGA", "SSP"])
    .optional(),
  criticalElement: z
    .enum(["CE_1", "CE_2", "CE_3", "CE_4", "CE_5", "CE_6", "CE_7", "CE_8"])
    .optional(),
  smsComponent: z
    .enum([
      "SAFETY_POLICY_OBJECTIVES",
      "SAFETY_RISK_MANAGEMENT",
      "SAFETY_ASSURANCE",
      "SAFETY_PROMOTION",
    ])
    .optional(),
  studyArea: z
    .enum([
      "SA_1_1",
      "SA_1_2",
      "SA_1_3",
      "SA_1_4",
      "SA_1_5",
      "SA_2_1",
      "SA_2_2",
      "SA_3_1",
      "SA_3_2",
      "SA_3_3",
      "SA_4_1",
      "SA_4_2",
    ])
    .optional(),
  transversalArea: z.enum(["SPM", "HP", "CI"]).optional(),
  maturityLevel: z
    .enum(["LEVEL_A", "LEVEL_B", "LEVEL_C", "LEVEL_D", "LEVEL_E"])
    .optional(),
  isPriorityPQ: z.boolean().optional(),
  requiresOnSite: z.boolean().optional(),
  pqStatus: z
    .enum([
      "NO_CHANGE",
      "REVISED",
      "NEW",
      "MERGED",
      "DELETED",
      "REFERENCE_REVISED",
    ])
    .optional(),
  responseType: z
    .enum([
      "SATISFACTORY_NOT",
      "MATURITY_LEVEL",
      "YES_NO",
      "SCALE_1_5",
      "TEXT",
      "MULTI_SELECT",
    ])
    .optional(),
  search: z.string().max(200).optional(),
});

export const PaginationSchema = z.object({
  page: z.coerce.number().int().positive().default(1),
  pageSize: z.coerce.number().int().min(1).max(100).default(20),
});

// Type exports from schemas
export type QuestionnaireFiltersInput = z.infer<
  typeof QuestionnaireFiltersSchema
>;
export type QuestionFiltersInput = z.infer<typeof QuestionFiltersSchema>;
export type PaginationInput = z.infer<typeof PaginationSchema>;

```

# src/lib/trpc/client.ts

```ts
import { createTRPCReact } from "@trpc/react-query";
import type { AppRouter } from "@/server/trpc/routers/_app";

/**
 * tRPC React hooks client
 * Use this in React components to call tRPC procedures
 *
 * @example
 * \`\`\`tsx
 * const { data, isLoading } = trpc.questionnaire.list.useQuery({
 *   type: "ANS_USOAP_CMA",
 *   page: 1,
 *   limit: 10,
 * });
 * \`\`\`
 */
export const trpc = createTRPCReact<AppRouter>();

/**
 * Helper to get the tRPC API URL
 */
export function getBaseUrl() {
  if (typeof window !== "undefined") {
    // Browser should use relative URL
    return "";
  }

  // SSR should use absolute URL
  if (process.env.VERCEL_URL) {
    return `https://${process.env.VERCEL_URL}`;
  }

  // Assume localhost in development
  return `http://localhost:${process.env.PORT ?? 3000}`;
}

/**
 * Get the full tRPC API URL
 */
export function getTRPCUrl() {
  return `${getBaseUrl()}/api/trpc`;
}

```

# src/lib/trpc/index.ts

```ts
// Client exports
export { trpc, getBaseUrl, getTRPCUrl } from "./client";
export { TRPCProvider } from "./provider";

// Re-export types from server
export type { AppRouter } from "@/server/trpc/routers/_app";

```

# src/lib/trpc/provider.tsx

```tsx
"use client";

import { useState } from "react";
import { QueryClient, QueryClientProvider } from "@tanstack/react-query";
import { httpBatchLink, loggerLink } from "@trpc/client";
import superjson from "superjson";
import { trpc, getTRPCUrl } from "./client";

/**
 * Create a stable QueryClient instance
 */
function makeQueryClient() {
  return new QueryClient({
    defaultOptions: {
      queries: {
        // With SSR, we don't want to refetch immediately on client
        staleTime: 60 * 1000, // 1 minute
        refetchOnWindowFocus: false,
        retry: (failureCount, error) => {
          // Don't retry on 4xx errors (client errors)
          if (error instanceof Error && error.message.includes("UNAUTHORIZED")) {
            return false;
          }
          if (error instanceof Error && error.message.includes("FORBIDDEN")) {
            return false;
          }
          if (error instanceof Error && error.message.includes("NOT_FOUND")) {
            return false;
          }
          return failureCount < 3;
        },
      },
      mutations: {
        retry: false,
      },
    },
  });
}

let browserQueryClient: QueryClient | undefined = undefined;

function getQueryClient() {
  if (typeof window === "undefined") {
    // Server: always create a new QueryClient
    return makeQueryClient();
  }
  // Browser: use singleton pattern to keep the same client
  if (!browserQueryClient) {
    browserQueryClient = makeQueryClient();
  }
  return browserQueryClient;
}

interface TRPCProviderProps {
  children: React.ReactNode;
}

/**
 * tRPC Provider component
 * Wraps the app with tRPC and React Query providers
 *
 * @example
 * \`\`\`tsx
 * // In your root layout
 * <TRPCProvider>
 *   {children}
 * </TRPCProvider>
 * \`\`\`
 */
export function TRPCProvider({ children }: TRPCProviderProps) {
  const queryClient = getQueryClient();

  const [trpcClient] = useState(() =>
    trpc.createClient({
      links: [
        // Logger link for development
        loggerLink({
          enabled: (opts) =>
            process.env.NODE_ENV === "development" ||
            (opts.direction === "down" && opts.result instanceof Error),
        }),
        // HTTP batch link for efficient request batching
        httpBatchLink({
          url: getTRPCUrl(),
          transformer: superjson,
          headers() {
            return {
              "x-trpc-source": "react",
            };
          },
        }),
      ],
    })
  );

  return (
    <trpc.Provider client={trpcClient} queryClient={queryClient}>
      <QueryClientProvider client={queryClient}>{children}</QueryClientProvider>
    </trpc.Provider>
  );
}

```

# src/lib/utils.ts

```ts
import { clsx, type ClassValue } from "clsx"
import { twMerge } from "tailwind-merge"

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs))
}

```

# src/lib/utils/cn.ts

```ts
import { type ClassValue, clsx } from "clsx";
import { twMerge } from "tailwind-merge";

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs));
}

```

# src/lib/validations/response.ts

```ts
/**
 * Response Validation Schemas
 *
 * Zod schemas for assessment response management.
 * Supports both ANS (USOAP CMA) and SMS (CANSO SoE) response types.
 */

import { z } from "zod";
import { MaturityLevel } from "@prisma/client";

// =============================================================================
// ANS RESPONSE VALUES (USOAP CMA)
// =============================================================================

/**
 * ANS response values following ICAO USOAP CMA methodology
 * - SATISFACTORY: The PQ requirement is fully met
 * - NOT_SATISFACTORY: The PQ requirement is not met (finding)
 * - NOT_APPLICABLE: The PQ does not apply to this State/ANSP
 * - NOT_REVIEWED: Not yet assessed (initial state)
 */
export const ANSResponseValue = z.enum([
  "SATISFACTORY",
  "NOT_SATISFACTORY",
  "NOT_APPLICABLE",
  "NOT_REVIEWED",
]);

export type ANSResponseValue = z.infer<typeof ANSResponseValue>;

/**
 * Localized labels for ANS response values
 */
export const ANS_RESPONSE_LABELS = {
  SATISFACTORY: {
    en: "Satisfactory",
    fr: "Satisfaisant",
  },
  NOT_SATISFACTORY: {
    en: "Not Satisfactory",
    fr: "Non Satisfaisant",
  },
  NOT_APPLICABLE: {
    en: "Not Applicable",
    fr: "Non Applicable",
  },
  NOT_REVIEWED: {
    en: "Not Reviewed",
    fr: "Non Examiné",
  },
} as const;

// =============================================================================
// SMS RESPONSE VALUES (CANSO SoE)
// =============================================================================

/**
 * SMS maturity levels following CANSO Standard of Excellence
 * Maps to the Prisma MaturityLevel enum
 */
export const SMSResponseValue = z.nativeEnum(MaturityLevel);

export type SMSResponseValue = z.infer<typeof SMSResponseValue>;

/**
 * Simplified maturity level input (A-E instead of LEVEL_A, etc.)
 */
export const MaturityLevelInput = z.enum(["A", "B", "C", "D", "E"]);

export type MaturityLevelInput = z.infer<typeof MaturityLevelInput>;

/**
 * Localized labels for SMS maturity levels
 */
export const SMS_MATURITY_LABELS = {
  LEVEL_A: {
    en: "Level A - Initial/Ad-hoc",
    fr: "Niveau A - Initial/Ad-hoc",
    short: "A",
  },
  LEVEL_B: {
    en: "Level B - Planned/Documented",
    fr: "Niveau B - Planifié/Documenté",
    short: "B",
  },
  LEVEL_C: {
    en: "Level C - Implemented/Managed",
    fr: "Niveau C - Mis en œuvre/Géré",
    short: "C",
  },
  LEVEL_D: {
    en: "Level D - Monitored/Reviewed",
    fr: "Niveau D - Surveillé/Revu",
    short: "D",
  },
  LEVEL_E: {
    en: "Level E - Optimized/Continuous Improvement",
    fr: "Niveau E - Optimisé/Amélioration Continue",
    short: "E",
  },
} as const;

/**
 * Mapping between short form (A-E) and database enum
 */
export const MATURITY_LEVEL_MAP: Record<MaturityLevelInput, MaturityLevel> = {
  A: "LEVEL_A",
  B: "LEVEL_B",
  C: "LEVEL_C",
  D: "LEVEL_D",
  E: "LEVEL_E",
};

export const MATURITY_LEVEL_REVERSE: Record<MaturityLevel, MaturityLevelInput> = {
  LEVEL_A: "A",
  LEVEL_B: "B",
  LEVEL_C: "C",
  LEVEL_D: "D",
  LEVEL_E: "E",
};

// =============================================================================
// RESPONSE INPUT SCHEMAS
// =============================================================================

/**
 * Save a single response
 */
export const SaveResponseInput = z.object({
  assessmentId: z.string().cuid(),
  questionId: z.string().cuid(),

  // Response value - one of these based on questionnaire type
  ansResponse: ANSResponseValue.optional().nullable(),
  smsResponse: MaturityLevelInput.optional().nullable(),

  // Supporting information
  notes: z.string().max(2000).optional(),
  evidenceNotes: z.string().max(1000).optional(),

  // For partial saves / auto-save
  isDraft: z.boolean().default(true),
});

export type SaveResponseInput = z.infer<typeof SaveResponseInput>;

/**
 * Bulk save multiple responses
 */
export const BulkSaveResponsesInput = z.object({
  assessmentId: z.string().cuid(),
  responses: z
    .array(
      z.object({
        questionId: z.string().cuid(),
        ansResponse: ANSResponseValue.optional().nullable(),
        smsResponse: MaturityLevelInput.optional().nullable(),
        notes: z.string().max(2000).optional(),
        evidenceNotes: z.string().max(1000).optional(),
        isDraft: z.boolean().default(true),
      })
    )
    .min(1)
    .max(1000),
});

export type BulkSaveResponsesInput = z.infer<typeof BulkSaveResponsesInput>;

/**
 * Get responses with filters
 */
export const GetResponsesInput = z.object({
  assessmentId: z.string().cuid(),
  categoryId: z.string().cuid().optional(),
  questionId: z.string().cuid().optional(),
  auditArea: z.string().optional(),
  criticalElement: z.string().optional(),
  smsComponent: z.string().optional(),
  studyArea: z.string().optional(),
  onlyUnanswered: z.boolean().optional(),
  onlyDraft: z.boolean().optional(),
  page: z.number().int().positive().default(1),
  limit: z.number().int().min(1).max(1000).default(50),
});

export type GetResponsesInput = z.infer<typeof GetResponsesInput>;

/**
 * Delete/clear a response
 */
export const DeleteResponseInput = z.object({
  assessmentId: z.string().cuid(),
  questionId: z.string().cuid(),
});

export type DeleteResponseInput = z.infer<typeof DeleteResponseInput>;

/**
 * Add evidence to a response
 */
export const AddEvidenceInput = z.object({
  assessmentId: z.string().cuid(),
  questionId: z.string().cuid(),
  evidenceUrl: z.string().url(),
  evidenceDescription: z.string().max(500).optional(),
});

export type AddEvidenceInput = z.infer<typeof AddEvidenceInput>;

/**
 * Remove evidence from a response
 */
export const RemoveEvidenceInput = z.object({
  assessmentId: z.string().cuid(),
  questionId: z.string().cuid(),
  evidenceUrl: z.string().url(),
});

export type RemoveEvidenceInput = z.infer<typeof RemoveEvidenceInput>;

// =============================================================================
// RESPONSE OUTPUT TYPES
// =============================================================================

/**
 * Response save result with progress update
 */
export interface SaveResponseResult {
  success: boolean;
  response: {
    id: string;
    questionId: string;
    value: string | MaturityLevel | null;
    isDraft: boolean;
    updatedAt: Date;
  };
  progress: {
    answered: number;
    total: number;
    percentage: number;
  };
}

/**
 * Bulk save result
 */
export interface BulkSaveResult {
  success: boolean;
  updatedCount: number;
  failedCount: number;
  errors: Array<{
    questionId: string;
    error: string;
  }>;
  progress: {
    answered: number;
    total: number;
    percentage: number;
  };
}

/**
 * Progress statistics
 */
export interface ResponseProgress {
  totalQuestions: number;
  answeredQuestions: number;
  draftResponses: number;
  finalizedResponses: number;
  percentage: number;
  estimatedTimeRemaining: number | null;
  byCategory: Record<
    string,
    {
      total: number;
      answered: number;
      percentage: number;
    }
  >;
}

// =============================================================================
// ERROR MESSAGES
// =============================================================================

export const RESPONSE_ERRORS = {
  ASSESSMENT_NOT_FOUND: {
    en: "Assessment not found",
    fr: "Évaluation non trouvée",
  },
  QUESTION_NOT_FOUND: {
    en: "Question not found in this questionnaire",
    fr: "Question non trouvée dans ce questionnaire",
  },
  NOT_EDITABLE: {
    en: "Assessment is not editable. Only draft assessments can be modified.",
    fr: "L'évaluation n'est pas modifiable. Seuls les brouillons peuvent être modifiés.",
  },
  INVALID_RESPONSE_TYPE: {
    en: "Invalid response type for this questionnaire",
    fr: "Type de réponse invalide pour ce questionnaire",
  },
  UNAUTHORIZED: {
    en: "You do not have permission to modify this assessment",
    fr: "Vous n'avez pas la permission de modifier cette évaluation",
  },
  VALIDATION_FAILED: {
    en: "Response validation failed",
    fr: "La validation de la réponse a échoué",
  },
} as const;

// =============================================================================
// VALIDATION HELPERS
// =============================================================================

/**
 * Check if a response value is valid for the given questionnaire type
 */
export function isValidResponseForType(
  questionnaireType: "ANS_USOAP_CMA" | "SMS_CANSO_SOE",
  ansResponse?: string | null,
  smsResponse?: string | null
): boolean {
  if (questionnaireType === "ANS_USOAP_CMA") {
    // ANS questionnaire should have ansResponse, not smsResponse
    if (smsResponse && !ansResponse) return false;
    if (ansResponse && !ANSResponseValue.safeParse(ansResponse).success) {
      return false;
    }
    return true;
  } else {
    // SMS questionnaire should have smsResponse, not ansResponse
    if (ansResponse && !smsResponse) return false;
    if (smsResponse && !MaturityLevelInput.safeParse(smsResponse).success) {
      return false;
    }
    return true;
  }
}

/**
 * Convert maturity level input to database enum
 */
export function toMaturityLevel(input: MaturityLevelInput): MaturityLevel {
  return MATURITY_LEVEL_MAP[input];
}

/**
 * Convert database enum to maturity level input
 */
export function fromMaturityLevel(level: MaturityLevel): MaturityLevelInput {
  return MATURITY_LEVEL_REVERSE[level];
}

/**
 * Get score for maturity level (1-5 scale)
 */
export function maturityLevelToScore(level: MaturityLevelInput): number {
  const scores: Record<MaturityLevelInput, number> = {
    A: 1,
    B: 2,
    C: 3,
    D: 4,
    E: 5,
  };
  return scores[level];
}

/**
 * Get maturity level from score
 */
export function scoreToMaturityLevel(score: number): MaturityLevelInput {
  if (score >= 4.5) return "E";
  if (score >= 3.5) return "D";
  if (score >= 2.5) return "C";
  if (score >= 1.5) return "B";
  return "A";
}

```

# src/middleware.ts

```ts
import createMiddleware from "next-intl/middleware";
import { routing } from "@/lib/i18n/routing";

export default createMiddleware(routing);

export const config = {
  matcher: ["/((?!api|_next|_vercel|.*\\..*).*)"]
};

```

# src/server/services/document.service.ts

```ts
/**
 * Document Service
 *
 * Handles document management including upload, linking to responses,
 * retrieval, and deletion (soft delete).
 */

import { prisma } from "@/lib/db";
import type {
  Document,
  DocumentCategory,
  Locale,
  Prisma,
} from "@prisma/client";

// =============================================================================
// TYPES
// =============================================================================

export interface UploadedFile {
  id: string;
  filename: string;
  originalName: string;
  mimeType: string;
  size: number;
  url: string;
}

export interface CreateDocumentInput {
  name: string;
  originalName?: string;
  description?: string;
  fileUrl: string;
  fileType: string;
  fileSize: number;
  category?: DocumentCategory;
  tags?: string[];
  language?: Locale;
  organizationId?: string;
  assessmentId?: string;
  uploadedById: string;
}

export interface UpdateDocumentInput {
  name?: string;
  description?: string;
  category?: DocumentCategory;
  tags?: string[];
  language?: Locale;
}

export interface LinkDocumentInput {
  documentId: string;
  responseId: string;
  notes?: string;
  addedById: string;
}

export interface DocumentFilter {
  organizationId?: string;
  assessmentId?: string;
  category?: DocumentCategory;
  tags?: string[];
  search?: string;
  includeDeleted?: boolean;
}

export interface ValidationResult {
  valid: boolean;
  errors: string[];
}

export interface DocumentWithRelations extends Document {
  uploadedBy: {
    id: string;
    firstName: string;
    lastName: string;
  };
  responses?: Array<{
    responseId: string;
    notes: string | null;
  }>;
}

// =============================================================================
// CONSTANTS
// =============================================================================

const ALLOWED_MIME_TYPES = [
  "application/pdf",
  "image/jpeg",
  "image/png",
  "image/gif",
  "image/webp",
  "application/msword",
  "application/vnd.openxmlformats-officedocument.wordprocessingml.document",
  "application/vnd.ms-excel",
  "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
  "application/vnd.ms-powerpoint",
  "application/vnd.openxmlformats-officedocument.presentationml.presentation",
];

const MAX_FILE_SIZE = 10 * 1024 * 1024; // 10MB
const MAX_FILES_PER_RESPONSE = 5;

// =============================================================================
// SERVICE CLASS
// =============================================================================

class DocumentService {
  /**
   * Validate a file before upload
   */
  validateFile(
    file: { type: string; size: number },
    existingCount = 0
  ): ValidationResult {
    const errors: string[] = [];

    if (!ALLOWED_MIME_TYPES.includes(file.type)) {
      errors.push(
        `Invalid file type: ${file.type}. Allowed types: PDF, images, Word, Excel`
      );
    }

    if (file.size > MAX_FILE_SIZE) {
      errors.push(
        `File too large: ${(file.size / 1024 / 1024).toFixed(2)}MB. Maximum: ${MAX_FILE_SIZE / 1024 / 1024}MB`
      );
    }

    if (existingCount >= MAX_FILES_PER_RESPONSE) {
      errors.push(
        `Maximum files per response reached: ${MAX_FILES_PER_RESPONSE}`
      );
    }

    return {
      valid: errors.length === 0,
      errors,
    };
  }

  /**
   * Validate a URL reference
   */
  validateUrl(url: string): ValidationResult {
    const errors: string[] = [];

    try {
      const parsed = new URL(url);
      if (!["http:", "https:"].includes(parsed.protocol)) {
        errors.push("URL must use HTTP or HTTPS protocol");
      }
    } catch {
      errors.push("Invalid URL format");
    }

    return {
      valid: errors.length === 0,
      errors,
    };
  }

  /**
   * Create a new document record
   */
  async createDocument(input: CreateDocumentInput): Promise<Document> {
    const document = await prisma.document.create({
      data: {
        name: input.name,
        originalName: input.originalName,
        description: input.description,
        fileUrl: input.fileUrl,
        fileType: input.fileType,
        fileSize: input.fileSize,
        category: input.category ?? "EVIDENCE",
        tags: input.tags ?? [],
        language: input.language,
        organizationId: input.organizationId,
        assessmentId: input.assessmentId,
        uploadedById: input.uploadedById,
      },
    });

    return document;
  }

  /**
   * Create an external URL reference as a document
   */
  async createUrlReference(
    url: string,
    name: string,
    userId: string,
    options?: {
      description?: string;
      category?: DocumentCategory;
      organizationId?: string;
      assessmentId?: string;
    }
  ): Promise<Document> {
    const document = await prisma.document.create({
      data: {
        name,
        fileUrl: url,
        fileType: "external_link",
        fileSize: 0,
        category: options?.category ?? "EVIDENCE",
        description: options?.description,
        organizationId: options?.organizationId,
        assessmentId: options?.assessmentId,
        uploadedById: userId,
      },
    });

    return document;
  }

  /**
   * Link a document to an assessment response
   */
  async linkToResponse(input: LinkDocumentInput): Promise<void> {
    // Verify document exists and is not deleted
    const document = await prisma.document.findFirst({
      where: {
        id: input.documentId,
        isDeleted: false,
      },
    });

    if (!document) {
      throw new Error("Document not found");
    }

    // Verify response exists
    const response = await prisma.assessmentResponse.findUnique({
      where: { id: input.responseId },
      include: { documents: true },
    });

    if (!response) {
      throw new Error("Response not found");
    }

    // Check if already linked
    const existingLink = response.documents.find(
      (d) => d.documentId === input.documentId
    );
    if (existingLink) {
      throw new Error("Document already linked to this response");
    }

    // Check max files limit
    if (response.documents.length >= MAX_FILES_PER_RESPONSE) {
      throw new Error(
        `Maximum ${MAX_FILES_PER_RESPONSE} documents per response`
      );
    }

    // Create link
    await prisma.responseDocument.create({
      data: {
        responseId: input.responseId,
        documentId: input.documentId,
        notes: input.notes,
        addedById: input.addedById,
      },
    });
  }

  /**
   * Unlink a document from an assessment response
   */
  async unlinkFromResponse(
    documentId: string,
    responseId: string
  ): Promise<void> {
    await prisma.responseDocument.delete({
      where: {
        responseId_documentId: {
          responseId,
          documentId,
        },
      },
    });
  }

  /**
   * Get a document by ID
   */
  async getDocument(
    documentId: string
  ): Promise<DocumentWithRelations | null> {
    const document = await prisma.document.findFirst({
      where: {
        id: documentId,
        isDeleted: false,
      },
      include: {
        uploadedBy: {
          select: {
            id: true,
            firstName: true,
            lastName: true,
          },
        },
        responses: {
          select: {
            responseId: true,
            notes: true,
          },
        },
      },
    });

    return document;
  }

  /**
   * Get documents for an assessment
   */
  async getAssessmentDocuments(
    assessmentId: string
  ): Promise<DocumentWithRelations[]> {
    const documents = await prisma.document.findMany({
      where: {
        assessmentId,
        isDeleted: false,
      },
      include: {
        uploadedBy: {
          select: {
            id: true,
            firstName: true,
            lastName: true,
          },
        },
        responses: {
          select: {
            responseId: true,
            notes: true,
          },
        },
      },
      orderBy: {
        createdAt: "desc",
      },
    });

    return documents;
  }

  /**
   * Get documents for a specific response
   */
  async getResponseDocuments(
    responseId: string
  ): Promise<DocumentWithRelations[]> {
    const responseDocuments = await prisma.responseDocument.findMany({
      where: { responseId },
      include: {
        document: {
          include: {
            uploadedBy: {
              select: {
                id: true,
                firstName: true,
                lastName: true,
              },
            },
          },
        },
      },
      orderBy: {
        addedAt: "desc",
      },
    });

    return responseDocuments
      .filter((rd) => !rd.document.isDeleted)
      .map((rd) => ({
        ...rd.document,
        responses: [{ responseId, notes: rd.notes }],
      }));
  }

  /**
   * Get documents for an organization (document library)
   */
  async getOrganizationDocuments(
    organizationId: string,
    filter?: DocumentFilter
  ): Promise<DocumentWithRelations[]> {
    const where: Prisma.DocumentWhereInput = {
      organizationId,
      isDeleted: filter?.includeDeleted ? undefined : false,
    };

    if (filter?.category) {
      where.category = filter.category;
    }

    if (filter?.assessmentId) {
      where.assessmentId = filter.assessmentId;
    }

    if (filter?.tags && filter.tags.length > 0) {
      where.tags = {
        hasSome: filter.tags,
      };
    }

    if (filter?.search) {
      where.OR = [
        { name: { contains: filter.search, mode: "insensitive" } },
        { description: { contains: filter.search, mode: "insensitive" } },
        { originalName: { contains: filter.search, mode: "insensitive" } },
      ];
    }

    const documents = await prisma.document.findMany({
      where,
      include: {
        uploadedBy: {
          select: {
            id: true,
            firstName: true,
            lastName: true,
          },
        },
        responses: {
          select: {
            responseId: true,
            notes: true,
          },
        },
      },
      orderBy: {
        createdAt: "desc",
      },
    });

    return documents;
  }

  /**
   * Update document metadata
   */
  async updateDocument(
    documentId: string,
    input: UpdateDocumentInput,
    // eslint-disable-next-line @typescript-eslint/no-unused-vars
    _userId: string
  ): Promise<Document> {
    // Verify document exists
    const existing = await prisma.document.findFirst({
      where: {
        id: documentId,
        isDeleted: false,
      },
    });

    if (!existing) {
      throw new Error("Document not found");
    }

    const document = await prisma.document.update({
      where: { id: documentId },
      data: {
        name: input.name,
        description: input.description,
        category: input.category,
        tags: input.tags,
        language: input.language,
      },
    });

    return document;
  }

  /**
   * Soft delete a document
   */
  // eslint-disable-next-line @typescript-eslint/no-unused-vars
  async deleteDocument(documentId: string, _userId: string): Promise<void> {
    // Verify document exists
    const document = await prisma.document.findFirst({
      where: {
        id: documentId,
        isDeleted: false,
      },
    });

    if (!document) {
      throw new Error("Document not found");
    }

    // Soft delete
    await prisma.document.update({
      where: { id: documentId },
      data: {
        isDeleted: true,
        deletedAt: new Date(),
      },
    });
  }

  /**
   * Get document count for a response
   */
  async getResponseDocumentCount(responseId: string): Promise<number> {
    const count = await prisma.responseDocument.count({
      where: {
        responseId,
        document: {
          isDeleted: false,
        },
      },
    });

    return count;
  }

  /**
   * Check if user can access document
   */
  async canAccessDocument(
    documentId: string,
    userId: string,
    userOrgId: string | null,
    isAdmin: boolean
  ): Promise<boolean> {
    if (isAdmin) return true;

    const document = await prisma.document.findFirst({
      where: {
        id: documentId,
        isDeleted: false,
      },
    });

    if (!document) return false;

    // User uploaded the document
    if (document.uploadedById === userId) return true;

    // Document belongs to user's organization
    if (userOrgId && document.organizationId === userOrgId) return true;

    return false;
  }

  /**
   * Get constants for client validation
   */
  getConstraints() {
    return {
      allowedMimeTypes: ALLOWED_MIME_TYPES,
      maxFileSize: MAX_FILE_SIZE,
      maxFilesPerResponse: MAX_FILES_PER_RESPONSE,
    };
  }
}

// =============================================================================
// EXPORT SINGLETON
// =============================================================================

export const documentService = new DocumentService();

```

# src/server/services/progress.service.ts

```ts
/**
 * Progress Service
 *
 * Handles assessment progress tracking, event logging,
 * activity timeline, and organization-level analytics.
 */

import { prisma } from "@/lib/db";
import { Prisma } from "@prisma/client";
import type {
  EventType,
  AssessmentStatus,
  AssessmentType,
} from "@prisma/client";

// =============================================================================
// TYPES
// =============================================================================

export interface ProgressStats {
  totalQuestions: number;
  answeredQuestions: number;
  unansweredQuestions: number;
  percentComplete: number;
  byCategory: CategoryProgressStats[];
}

export interface CategoryProgressStats {
  categoryId: string;
  categoryCode: string;
  categoryName: string;
  totalQuestions: number;
  answeredQuestions: number;
  percentComplete: number;
}

export interface AssessmentEvent {
  id: string;
  type: EventType;
  description: string;
  metadata: Record<string, unknown> | null;
  userId: string;
  userName: string;
  createdAt: Date;
}

export interface AssessmentTimeline {
  events: AssessmentEvent[];
  totalCount: number;
  hasMore: boolean;
}

export interface OrganizationAnalytics {
  totalAssessments: number;
  completedAssessments: number;
  inProgressAssessments: number;
  averageCompletion: number;
  averageScore: number | null;
  byStatus: Record<AssessmentStatus, number>;
  byType: Record<AssessmentType, number>;
  recentActivity: AssessmentEvent[];
  completionTrend: CompletionTrendPoint[];
}

export interface CompletionTrendPoint {
  date: string;
  completed: number;
  total: number;
}

export interface DashboardStats {
  assessments: {
    total: number;
    inProgress: number;
    completed: number;
    overdue: number;
  };
  responses: {
    total: number;
    thisWeek: number;
  };
  documents: {
    total: number;
    thisWeek: number;
  };
  activity: AssessmentEvent[];
}

export interface CreateEventInput {
  assessmentId: string;
  type: EventType;
  description: string;
  metadata?: Record<string, unknown>;
  userId: string;
}

// =============================================================================
// SERVICE CLASS
// =============================================================================

class ProgressService {
  /**
   * Calculate progress statistics for an assessment
   */
  async getAssessmentProgress(assessmentId: string): Promise<ProgressStats> {
    // Get assessment with questionnaire categories
    const assessment = await prisma.assessment.findUnique({
      where: { id: assessmentId },
      include: {
        questionnaire: {
          include: {
            categories: {
              orderBy: { sortOrder: "asc" },
            },
            questions: {
              where: { isActive: true },
            },
          },
        },
        responses: true,
      },
    });

    if (!assessment) {
      throw new Error("Assessment not found");
    }

    const totalQuestions = assessment.questionnaire.questions.length;
    const answeredResponses = assessment.responses.filter(
      (r) => r.responseValue !== null && r.responseValue !== ""
    );
    const answeredQuestions = answeredResponses.length;
    const unansweredQuestions = totalQuestions - answeredQuestions;
    const percentComplete =
      totalQuestions > 0
        ? Math.round((answeredQuestions / totalQuestions) * 100)
        : 0;

    // Calculate by category
    const byCategory: CategoryProgressStats[] =
      assessment.questionnaire.categories.map((category) => {
        const categoryQuestions = assessment.questionnaire.questions.filter(
          (q) => q.categoryId === category.id
        );
        const categoryAnswered = assessment.responses.filter(
          (r) =>
            categoryQuestions.some((q) => q.id === r.questionId) &&
            r.responseValue !== null &&
            r.responseValue !== ""
        );

        return {
          categoryId: category.id,
          categoryCode: category.code,
          categoryName: category.nameEn,
          totalQuestions: categoryQuestions.length,
          answeredQuestions: categoryAnswered.length,
          percentComplete:
            categoryQuestions.length > 0
              ? Math.round(
                  (categoryAnswered.length / categoryQuestions.length) * 100
                )
              : 0,
        };
      });

    return {
      totalQuestions,
      answeredQuestions,
      unansweredQuestions,
      percentComplete,
      byCategory,
    };
  }

  /**
   * Update assessment progress percentage in the database
   */
  async updateAssessmentProgress(assessmentId: string): Promise<number> {
    const stats = await this.getAssessmentProgress(assessmentId);

    await prisma.assessment.update({
      where: { id: assessmentId },
      data: { progress: stats.percentComplete },
    });

    return stats.percentComplete;
  }

  /**
   * Log an assessment event
   */
  async logEvent(input: CreateEventInput): Promise<void> {
    await prisma.assessmentEvent.create({
      data: {
        assessmentId: input.assessmentId,
        type: input.type,
        description: input.description,
        metadata: input.metadata
          ? (input.metadata as Prisma.InputJsonValue)
          : Prisma.JsonNull,
        userId: input.userId,
      },
    });
  }

  /**
   * Get timeline of events for an assessment
   */
  async getAssessmentTimeline(
    assessmentId: string,
    limit = 20,
    offset = 0
  ): Promise<AssessmentTimeline> {
    const [events, totalCount] = await Promise.all([
      prisma.assessmentEvent.findMany({
        where: { assessmentId },
        include: {
          user: {
            select: {
              id: true,
              firstName: true,
              lastName: true,
            },
          },
        },
        orderBy: { createdAt: "desc" },
        take: limit,
        skip: offset,
      }),
      prisma.assessmentEvent.count({
        where: { assessmentId },
      }),
    ]);

    return {
      events: events.map((e) => ({
        id: e.id,
        type: e.type,
        description: e.description,
        metadata: e.metadata as Record<string, unknown> | null,
        userId: e.userId,
        userName: `${e.user.firstName} ${e.user.lastName}`,
        createdAt: e.createdAt,
      })),
      totalCount,
      hasMore: offset + events.length < totalCount,
    };
  }

  /**
   * Get organization-level analytics
   */
  async getOrganizationAnalytics(
    organizationId: string
  ): Promise<OrganizationAnalytics> {
    // Get all assessments for the organization
    const assessments = await prisma.assessment.findMany({
      where: { organizationId },
      include: {
        events: {
          orderBy: { createdAt: "desc" },
          take: 10,
          include: {
            user: {
              select: {
                id: true,
                firstName: true,
                lastName: true,
              },
            },
          },
        },
      },
    });

    const totalAssessments = assessments.length;
    const completedAssessments = assessments.filter(
      (a) => a.status === "COMPLETED"
    ).length;
    const inProgressAssessments = assessments.filter(
      (a) => a.status === "DRAFT" || a.status === "SUBMITTED"
    ).length;

    // Calculate averages
    const averageCompletion =
      totalAssessments > 0
        ? Math.round(
            assessments.reduce((sum, a) => sum + a.progress, 0) /
              totalAssessments
          )
        : 0;

    const scoredAssessments = assessments.filter(
      (a) => a.overallScore !== null
    );
    const averageScore =
      scoredAssessments.length > 0
        ? Math.round(
            (scoredAssessments.reduce(
              (sum, a) => sum + (a.overallScore ?? 0),
              0
            ) /
              scoredAssessments.length) *
              100
          ) / 100
        : null;

    // Count by status
    const byStatus: Record<AssessmentStatus, number> = {
      DRAFT: 0,
      SUBMITTED: 0,
      UNDER_REVIEW: 0,
      COMPLETED: 0,
      ARCHIVED: 0,
    };
    assessments.forEach((a) => {
      byStatus[a.status]++;
    });

    // Count by type
    const byType: Record<AssessmentType, number> = {
      SELF_ASSESSMENT: 0,
      PEER_REVIEW: 0,
      GAP_ANALYSIS: 0,
      FOLLOW_UP: 0,
    };
    assessments.forEach((a) => {
      byType[a.type]++;
    });

    // Gather recent activity across all assessments
    const recentActivity: AssessmentEvent[] = assessments
      .flatMap((a) =>
        a.events.map((e) => ({
          id: e.id,
          type: e.type,
          description: e.description,
          metadata: e.metadata as Record<string, unknown> | null,
          userId: e.userId,
          userName: `${e.user.firstName} ${e.user.lastName}`,
          createdAt: e.createdAt,
        }))
      )
      .sort((a, b) => b.createdAt.getTime() - a.createdAt.getTime())
      .slice(0, 10);

    // Calculate completion trend (last 30 days)
    const thirtyDaysAgo = new Date();
    thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);

    const completionTrend = await this.getCompletionTrend(
      organizationId,
      thirtyDaysAgo
    );

    return {
      totalAssessments,
      completedAssessments,
      inProgressAssessments,
      averageCompletion,
      averageScore,
      byStatus,
      byType,
      recentActivity,
      completionTrend,
    };
  }

  /**
   * Get completion trend data
   */
  private async getCompletionTrend(
    organizationId: string,
    since: Date
  ): Promise<CompletionTrendPoint[]> {
    // Get completed assessments grouped by day
    const completedByDay = await prisma.assessment.groupBy({
      by: ["completedAt"],
      where: {
        organizationId,
        status: "COMPLETED",
        completedAt: {
          gte: since,
        },
      },
      _count: true,
    });

    // Get total assessments by creation date
    const totalByDay = await prisma.assessment.groupBy({
      by: ["createdAt"],
      where: {
        organizationId,
        createdAt: {
          gte: since,
        },
      },
      _count: true,
    });

    // Build trend data
    const trend: Map<string, CompletionTrendPoint> = new Map();
    const today = new Date();

    for (let d = new Date(since); d <= today; d.setDate(d.getDate() + 1)) {
      const dateStr = d.toISOString().split("T")[0];
      trend.set(dateStr, { date: dateStr, completed: 0, total: 0 });
    }

    completedByDay.forEach((item) => {
      if (item.completedAt) {
        const dateStr = item.completedAt.toISOString().split("T")[0];
        const point = trend.get(dateStr);
        if (point) {
          point.completed = item._count;
        }
      }
    });

    totalByDay.forEach((item) => {
      const dateStr = item.createdAt.toISOString().split("T")[0];
      const point = trend.get(dateStr);
      if (point) {
        point.total = item._count;
      }
    });

    return Array.from(trend.values());
  }

  /**
   * Get dashboard statistics for a user
   */
  async getDashboardStats(
    userId: string,
    organizationId?: string
  ): Promise<DashboardStats> {
    const now = new Date();
    const oneWeekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);

    // Build where clause
    const assessmentWhere = organizationId
      ? { organizationId }
      : undefined;

    // Get assessment counts
    const [
      totalAssessments,
      inProgressAssessments,
      completedAssessments,
      overdueAssessments,
    ] = await Promise.all([
      prisma.assessment.count({ where: assessmentWhere }),
      prisma.assessment.count({
        where: {
          ...assessmentWhere,
          status: { in: ["DRAFT", "SUBMITTED", "UNDER_REVIEW"] },
        },
      }),
      prisma.assessment.count({
        where: { ...assessmentWhere, status: "COMPLETED" },
      }),
      prisma.assessment.count({
        where: {
          ...assessmentWhere,
          status: { in: ["DRAFT", "SUBMITTED", "UNDER_REVIEW"] },
          dueDate: { lt: now },
        },
      }),
    ]);

    // Get response counts
    const [totalResponses, weeklyResponses] = await Promise.all([
      prisma.assessmentResponse.count({
        where: organizationId
          ? { assessment: { organizationId } }
          : undefined,
      }),
      prisma.assessmentResponse.count({
        where: {
          ...(organizationId
            ? { assessment: { organizationId } }
            : undefined),
          updatedAt: { gte: oneWeekAgo },
        },
      }),
    ]);

    // Get document counts
    const [totalDocuments, weeklyDocuments] = await Promise.all([
      prisma.document.count({
        where: {
          ...(organizationId ? { organizationId } : undefined),
          isDeleted: false,
        },
      }),
      prisma.document.count({
        where: {
          ...(organizationId ? { organizationId } : undefined),
          isDeleted: false,
          createdAt: { gte: oneWeekAgo },
        },
      }),
    ]);

    // Get recent activity
    const recentEvents = await prisma.assessmentEvent.findMany({
      where: organizationId
        ? { assessment: { organizationId } }
        : undefined,
      include: {
        user: {
          select: {
            id: true,
            firstName: true,
            lastName: true,
          },
        },
      },
      orderBy: { createdAt: "desc" },
      take: 10,
    });

    return {
      assessments: {
        total: totalAssessments,
        inProgress: inProgressAssessments,
        completed: completedAssessments,
        overdue: overdueAssessments,
      },
      responses: {
        total: totalResponses,
        thisWeek: weeklyResponses,
      },
      documents: {
        total: totalDocuments,
        thisWeek: weeklyDocuments,
      },
      activity: recentEvents.map((e) => ({
        id: e.id,
        type: e.type,
        description: e.description,
        metadata: e.metadata as Record<string, unknown> | null,
        userId: e.userId,
        userName: `${e.user.firstName} ${e.user.lastName}`,
        createdAt: e.createdAt,
      })),
    };
  }

  /**
   * Get assessment summary with progress
   */
  async getAssessmentSummary(assessmentId: string) {
    const assessment = await prisma.assessment.findUnique({
      where: { id: assessmentId },
      include: {
        organization: {
          select: {
            id: true,
            nameEn: true,
            nameFr: true,
          },
        },
        questionnaire: {
          select: {
            id: true,
            titleEn: true,
            titleFr: true,
            type: true,
          },
        },
        _count: {
          select: {
            responses: true,
            events: true,
            documents: true,
          },
        },
      },
    });

    if (!assessment) {
      throw new Error("Assessment not found");
    }

    const progress = await this.getAssessmentProgress(assessmentId);

    return {
      ...assessment,
      progressStats: progress,
    };
  }

  /**
   * Get assessments needing attention (overdue, stalled)
   */
  async getAssessmentsNeedingAttention(
    organizationId?: string,
    limit = 10
  ): Promise<
    Array<{
      id: string;
      title: string;
      status: AssessmentStatus;
      progress: number;
      dueDate: Date | null;
      lastActivity: Date | null;
      reason: "overdue" | "stalled";
    }>
  > {
    const now = new Date();
    const sevenDaysAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);

    const where = organizationId ? { organizationId } : {};

    // Get overdue assessments
    const overdueAssessments = await prisma.assessment.findMany({
      where: {
        ...where,
        status: { in: ["DRAFT", "SUBMITTED", "UNDER_REVIEW"] },
        dueDate: { lt: now },
      },
      select: {
        id: true,
        title: true,
        status: true,
        progress: true,
        dueDate: true,
        updatedAt: true,
      },
      orderBy: { dueDate: "asc" },
      take: limit,
    });

    // Get stalled assessments (no activity in 7 days)
    const stalledAssessments = await prisma.assessment.findMany({
      where: {
        ...where,
        status: { in: ["DRAFT", "SUBMITTED"] },
        updatedAt: { lt: sevenDaysAgo },
        dueDate: { gte: now }, // Not overdue
      },
      select: {
        id: true,
        title: true,
        status: true,
        progress: true,
        dueDate: true,
        updatedAt: true,
      },
      orderBy: { updatedAt: "asc" },
      take: limit,
    });

    const result = [
      ...overdueAssessments.map((a) => ({
        id: a.id,
        title: a.title,
        status: a.status,
        progress: a.progress,
        dueDate: a.dueDate,
        lastActivity: a.updatedAt as Date | null,
        reason: "overdue" as const,
      })),
      ...stalledAssessments.map((a) => ({
        id: a.id,
        title: a.title,
        status: a.status,
        progress: a.progress,
        dueDate: a.dueDate,
        lastActivity: a.updatedAt as Date | null,
        reason: "stalled" as const,
      })),
    ];

    return result.slice(0, limit);
  }
}

// =============================================================================
// EXPORT SINGLETON
// =============================================================================

export const progressService = new ProgressService();

```

# src/server/services/response.service.ts

```ts
/**
 * Response Service
 *
 * Business logic for assessment response management.
 * Handles saving, validation, progress calculation, and scoring preparation.
 */

import { prisma } from "@/lib/db";
import {
  Prisma,
  MaturityLevel,
  QuestionnaireType,
  AssessmentStatus,
  UserRole,
  USOAPAuditArea,
  CriticalElement,
  SMSComponent,
  CANSOStudyArea,
} from "@prisma/client";
import {
  MATURITY_LEVEL_MAP,
  MATURITY_LEVEL_REVERSE,
  maturityLevelToScore,
  type SaveResponseInput,
  type BulkSaveResponsesInput,
  type GetResponsesInput,
  type ResponseProgress,
  type SaveResponseResult,
  type BulkSaveResult,
} from "@/lib/validations/response";

// =============================================================================
// TYPES
// =============================================================================

export interface AssessmentAccessResult {
  assessment: Prisma.AssessmentGetPayload<{
    include: {
      organization: true;
      questionnaire: true;
    };
  }> | null;
  hasAccess: boolean;
  canWrite: boolean;
  reason?: string;
}

export interface ResponseWithQuestion {
  id: string;
  assessmentId: string;
  questionId: string;
  responseValue: string | null;
  maturityLevel: MaturityLevel | null;
  score: number | null;
  notes: string | null;
  evidenceUrls: string[];
  respondedById: string | null;
  respondedAt: Date | null;
  createdAt: Date;
  updatedAt: Date;
  question: {
    id: string;
    pqNumber: string | null;
    questionTextEn: string;
    questionTextFr: string;
    auditArea: USOAPAuditArea | null;
    criticalElement: CriticalElement | null;
    smsComponent: SMSComponent | null;
    studyArea: CANSOStudyArea | null;
    isPriorityPQ: boolean;
    requiresOnSite: boolean;
    weight: number;
    categoryId: string | null;
  };
}

// =============================================================================
// ACCESS CONTROL
// =============================================================================

/**
 * Roles that can manage assessments
 */
const ASSESSMENT_MANAGER_ROLES: UserRole[] = [
  "SUPER_ADMIN",
  "SYSTEM_ADMIN",
  "PROGRAMME_COORDINATOR",
  "ANSP_ADMIN",
  "SAFETY_MANAGER",
  "QUALITY_MANAGER",
  "STAFF",
];

/**
 * Check if user has access to an assessment
 */
export async function checkAssessmentAccess(
  assessmentId: string,
  userId: string,
  userRole: UserRole,
  userOrgId: string | null,
  requireWrite: boolean = false
): Promise<AssessmentAccessResult> {
  const assessment = await prisma.assessment.findUnique({
    where: { id: assessmentId },
    include: {
      organization: true,
      questionnaire: true,
    },
  });

  if (!assessment) {
    return {
      assessment: null,
      hasAccess: false,
      canWrite: false,
      reason: "Assessment not found",
    };
  }

  // Super admins and system admins have full access
  if (["SUPER_ADMIN", "SYSTEM_ADMIN", "PROGRAMME_COORDINATOR"].includes(userRole)) {
    return {
      assessment,
      hasAccess: true,
      canWrite: true,
    };
  }

  // Check organization membership
  if (userOrgId !== assessment.organizationId) {
    // Peer reviewers can view submitted assessments
    if (
      ["PEER_REVIEWER", "LEAD_REVIEWER"].includes(userRole) &&
      ["SUBMITTED", "UNDER_REVIEW", "COMPLETED"].includes(assessment.status) &&
      !requireWrite
    ) {
      return { assessment, hasAccess: true, canWrite: false };
    }

    // Steering committee can view completed assessments
    if (
      userRole === "STEERING_COMMITTEE" &&
      assessment.status === "COMPLETED" &&
      !requireWrite
    ) {
      return { assessment, hasAccess: true, canWrite: false };
    }

    return {
      assessment,
      hasAccess: false,
      canWrite: false,
      reason: "You do not have access to this organization's assessments",
    };
  }

  // Organization members - check role for write access
  const canWrite = ASSESSMENT_MANAGER_ROLES.includes(userRole);

  if (requireWrite && !canWrite) {
    return {
      assessment,
      hasAccess: true,
      canWrite: false,
      reason: "You do not have permission to modify assessments",
    };
  }

  return { assessment, hasAccess: true, canWrite };
}

/**
 * Check if assessment is editable
 */
export function isAssessmentEditable(status: AssessmentStatus): boolean {
  return status === "DRAFT";
}

// =============================================================================
// RESPONSE MANAGEMENT
// =============================================================================

/**
 * Save a single response
 */
export async function saveResponse(
  input: SaveResponseInput,
  userId: string,
  questionnaireType: QuestionnaireType
): Promise<SaveResponseResult> {
  // Build update data based on questionnaire type
  const updateData: Prisma.AssessmentResponseUpdateInput = {
    respondedBy: { connect: { id: userId } },
    respondedAt: new Date(),
  };

  if (questionnaireType === "ANS_USOAP_CMA") {
    updateData.responseValue = input.ansResponse || null;
    updateData.maturityLevel = null;
  } else {
    updateData.maturityLevel = input.smsResponse
      ? MATURITY_LEVEL_MAP[input.smsResponse]
      : null;
    updateData.responseValue = null;

    // Calculate score for maturity level
    if (input.smsResponse) {
      updateData.score = maturityLevelToScore(input.smsResponse);
    }
  }

  if (input.notes !== undefined) {
    updateData.notes = input.notes;
  }

  // Upsert response
  const response = await prisma.assessmentResponse.upsert({
    where: {
      assessmentId_questionId: {
        assessmentId: input.assessmentId,
        questionId: input.questionId,
      },
    },
    update: updateData,
    create: {
      assessment: { connect: { id: input.assessmentId } },
      question: { connect: { id: input.questionId } },
      responseValue:
        questionnaireType === "ANS_USOAP_CMA" ? input.ansResponse || null : null,
      maturityLevel:
        questionnaireType === "SMS_CANSO_SOE" && input.smsResponse
          ? MATURITY_LEVEL_MAP[input.smsResponse]
          : null,
      score: input.smsResponse ? maturityLevelToScore(input.smsResponse) : null,
      notes: input.notes,
      respondedBy: { connect: { id: userId } },
      respondedAt: new Date(),
    },
  });

  // Calculate updated progress
  const progress = await calculateProgress(input.assessmentId, questionnaireType);

  // Update assessment progress
  await prisma.assessment.update({
    where: { id: input.assessmentId },
    data: { progress: progress.percentage },
  });

  return {
    success: true,
    response: {
      id: response.id,
      questionId: response.questionId,
      value:
        questionnaireType === "ANS_USOAP_CMA"
          ? response.responseValue
          : response.maturityLevel,
      isDraft: input.isDraft,
      updatedAt: response.updatedAt,
    },
    progress: {
      answered: progress.answeredQuestions,
      total: progress.totalQuestions,
      percentage: progress.percentage,
    },
  };
}

/**
 * Save multiple responses in bulk
 */
export async function saveResponses(
  input: BulkSaveResponsesInput,
  userId: string,
  questionnaireType: QuestionnaireType
): Promise<BulkSaveResult> {
  const errors: Array<{ questionId: string; error: string }> = [];
  let updatedCount = 0;

  // Process all responses in a transaction
  await prisma.$transaction(async (tx) => {
    for (const response of input.responses) {
      try {
        const updateData: Prisma.AssessmentResponseUpdateInput = {
          respondedBy: { connect: { id: userId } },
          respondedAt: new Date(),
        };

        if (questionnaireType === "ANS_USOAP_CMA") {
          updateData.responseValue = response.ansResponse || null;
        } else {
          updateData.maturityLevel = response.smsResponse
            ? MATURITY_LEVEL_MAP[response.smsResponse]
            : null;
          if (response.smsResponse) {
            updateData.score = maturityLevelToScore(response.smsResponse);
          }
        }

        if (response.notes !== undefined) {
          updateData.notes = response.notes;
        }

        await tx.assessmentResponse.upsert({
          where: {
            assessmentId_questionId: {
              assessmentId: input.assessmentId,
              questionId: response.questionId,
            },
          },
          update: updateData,
          create: {
            assessment: { connect: { id: input.assessmentId } },
            question: { connect: { id: response.questionId } },
            responseValue:
              questionnaireType === "ANS_USOAP_CMA"
                ? response.ansResponse || null
                : null,
            maturityLevel:
              questionnaireType === "SMS_CANSO_SOE" && response.smsResponse
                ? MATURITY_LEVEL_MAP[response.smsResponse]
                : null,
            score: response.smsResponse
              ? maturityLevelToScore(response.smsResponse)
              : null,
            notes: response.notes,
            respondedBy: { connect: { id: userId } },
            respondedAt: new Date(),
          },
        });

        updatedCount++;
      } catch (error) {
        errors.push({
          questionId: response.questionId,
          error: error instanceof Error ? error.message : "Unknown error",
        });
      }
    }
  });

  // Calculate updated progress
  const progress = await calculateProgress(input.assessmentId, questionnaireType);

  // Update assessment progress
  await prisma.assessment.update({
    where: { id: input.assessmentId },
    data: { progress: progress.percentage },
  });

  return {
    success: errors.length === 0,
    updatedCount,
    failedCount: errors.length,
    errors,
    progress: {
      answered: progress.answeredQuestions,
      total: progress.totalQuestions,
      percentage: progress.percentage,
    },
  };
}

/**
 * Get responses with filters
 */
export async function getResponses(
  input: GetResponsesInput,
  questionnaireType: QuestionnaireType
): Promise<{
  responses: ResponseWithQuestion[];
  total: number;
  page: number;
  limit: number;
  totalPages: number;
}> {
  // Build filter
  const where: Prisma.AssessmentResponseWhereInput = {
    assessmentId: input.assessmentId,
  };

  // Question filters
  const questionWhere: Prisma.QuestionWhereInput = {};

  if (input.categoryId) {
    questionWhere.categoryId = input.categoryId;
  }
  if (input.questionId) {
    where.questionId = input.questionId;
  }
  if (input.auditArea) {
    questionWhere.auditArea = input.auditArea as USOAPAuditArea;
  }
  if (input.criticalElement) {
    questionWhere.criticalElement = input.criticalElement as CriticalElement;
  }
  if (input.smsComponent) {
    questionWhere.smsComponent = input.smsComponent as SMSComponent;
  }
  if (input.studyArea) {
    questionWhere.studyArea = input.studyArea as CANSOStudyArea;
  }

  if (Object.keys(questionWhere).length > 0) {
    where.question = questionWhere;
  }

  // Filter for unanswered only
  if (input.onlyUnanswered) {
    if (questionnaireType === "ANS_USOAP_CMA") {
      where.responseValue = null;
    } else {
      where.maturityLevel = null;
    }
  }

  const total = await prisma.assessmentResponse.count({ where });

  const responses = await prisma.assessmentResponse.findMany({
    where,
    include: {
      question: {
        select: {
          id: true,
          pqNumber: true,
          questionTextEn: true,
          questionTextFr: true,
          auditArea: true,
          criticalElement: true,
          smsComponent: true,
          studyArea: true,
          isPriorityPQ: true,
          requiresOnSite: true,
          weight: true,
          categoryId: true,
        },
      },
    },
    orderBy: { question: { sortOrder: "asc" } },
    skip: (input.page - 1) * input.limit,
    take: input.limit,
  });

  return {
    responses: responses as ResponseWithQuestion[],
    total,
    page: input.page,
    limit: input.limit,
    totalPages: Math.ceil(total / input.limit),
  };
}

/**
 * Get a single response by question ID
 */
export async function getResponseByQuestion(
  assessmentId: string,
  questionId: string
): Promise<ResponseWithQuestion | null> {
  const response = await prisma.assessmentResponse.findUnique({
    where: {
      assessmentId_questionId: {
        assessmentId,
        questionId,
      },
    },
    include: {
      question: {
        select: {
          id: true,
          pqNumber: true,
          questionTextEn: true,
          questionTextFr: true,
          auditArea: true,
          criticalElement: true,
          smsComponent: true,
          studyArea: true,
          isPriorityPQ: true,
          requiresOnSite: true,
          weight: true,
          categoryId: true,
        },
      },
    },
  });

  return response as ResponseWithQuestion | null;
}

/**
 * Clear/delete a response (reset to unanswered)
 */
export async function clearResponse(
  assessmentId: string,
  questionId: string,
  questionnaireType: QuestionnaireType
): Promise<{ success: boolean; progress: ResponseProgress }> {
  await prisma.assessmentResponse.update({
    where: {
      assessmentId_questionId: {
        assessmentId,
        questionId,
      },
    },
    data: {
      responseValue: null,
      maturityLevel: null,
      score: null,
      notes: null,
      evidenceUrls: [],
      respondedById: null,
      respondedAt: null,
    },
  });

  const progress = await calculateProgress(assessmentId, questionnaireType);

  // Update assessment progress
  await prisma.assessment.update({
    where: { id: assessmentId },
    data: { progress: progress.percentage },
  });

  return { success: true, progress };
}

// =============================================================================
// EVIDENCE MANAGEMENT
// =============================================================================

/**
 * Add evidence URL to a response
 */
export async function addEvidence(
  assessmentId: string,
  questionId: string,
  evidenceUrl: string
): Promise<ResponseWithQuestion> {
  const response = await prisma.assessmentResponse.findUnique({
    where: {
      assessmentId_questionId: {
        assessmentId,
        questionId,
      },
    },
  });

  if (!response) {
    throw new Error("Response not found");
  }

  const updated = await prisma.assessmentResponse.update({
    where: { id: response.id },
    data: {
      evidenceUrls: {
        push: evidenceUrl,
      },
    },
    include: {
      question: {
        select: {
          id: true,
          pqNumber: true,
          questionTextEn: true,
          questionTextFr: true,
          auditArea: true,
          criticalElement: true,
          smsComponent: true,
          studyArea: true,
          isPriorityPQ: true,
          requiresOnSite: true,
          weight: true,
          categoryId: true,
        },
      },
    },
  });

  return updated as ResponseWithQuestion;
}

/**
 * Remove evidence URL from a response
 */
export async function removeEvidence(
  assessmentId: string,
  questionId: string,
  evidenceUrl: string
): Promise<ResponseWithQuestion> {
  const response = await prisma.assessmentResponse.findUnique({
    where: {
      assessmentId_questionId: {
        assessmentId,
        questionId,
      },
    },
  });

  if (!response) {
    throw new Error("Response not found");
  }

  const updatedUrls = response.evidenceUrls.filter((url) => url !== evidenceUrl);

  const updated = await prisma.assessmentResponse.update({
    where: { id: response.id },
    data: {
      evidenceUrls: updatedUrls,
    },
    include: {
      question: {
        select: {
          id: true,
          pqNumber: true,
          questionTextEn: true,
          questionTextFr: true,
          auditArea: true,
          criticalElement: true,
          smsComponent: true,
          studyArea: true,
          isPriorityPQ: true,
          requiresOnSite: true,
          weight: true,
          categoryId: true,
        },
      },
    },
  });

  return updated as ResponseWithQuestion;
}

// =============================================================================
// PROGRESS CALCULATION
// =============================================================================

/**
 * Calculate completion progress for an assessment
 */
export async function calculateProgress(
  assessmentId: string,
  questionnaireType: QuestionnaireType
): Promise<ResponseProgress> {
  const responses = await prisma.assessmentResponse.findMany({
    where: { assessmentId },
    include: {
      question: {
        select: {
          categoryId: true,
        },
      },
    },
  });

  const totalQuestions = responses.length;
  let answeredQuestions = 0;
  const draftResponses = 0;
  let finalizedResponses = 0;
  const byCategory: Record<
    string,
    { total: number; answered: number; percentage: number }
  > = {};

  for (const r of responses) {
    const categoryId = r.question.categoryId || "uncategorized";

    // Initialize category
    if (!byCategory[categoryId]) {
      byCategory[categoryId] = { total: 0, answered: 0, percentage: 0 };
    }
    byCategory[categoryId].total++;

    // Check if answered
    const isAnswered =
      questionnaireType === "ANS_USOAP_CMA"
        ? r.responseValue !== null
        : r.maturityLevel !== null;

    if (isAnswered) {
      answeredQuestions++;
      byCategory[categoryId].answered++;

      // For now, treat all responses as finalized (isDraft field not in schema)
      finalizedResponses++;
    }
  }

  // Calculate category percentages
  for (const categoryId of Object.keys(byCategory)) {
    const cat = byCategory[categoryId];
    cat.percentage = cat.total > 0 ? Math.round((cat.answered / cat.total) * 100) : 0;
  }

  const percentage =
    totalQuestions > 0
      ? Math.round((answeredQuestions / totalQuestions) * 100)
      : 0;

  // Estimate remaining time (rough: 2 minutes per question)
  const remainingQuestions = totalQuestions - answeredQuestions;
  const estimatedTimeRemaining =
    remainingQuestions > 0 ? remainingQuestions * 2 : null;

  return {
    totalQuestions,
    answeredQuestions,
    draftResponses,
    finalizedResponses,
    percentage,
    estimatedTimeRemaining,
    byCategory,
  };
}

/**
 * Get detailed progress with category breakdown
 */
export async function getDetailedProgress(
  assessmentId: string,
  questionnaireType: QuestionnaireType
): Promise<ResponseProgress & { categories: Array<{ id: string; name: string; progress: number }> }> {
  const progress = await calculateProgress(assessmentId, questionnaireType);

  // Get category names
  const categories = await prisma.questionnaireCategory.findMany({
    where: {
      id: { in: Object.keys(progress.byCategory) },
    },
    select: {
      id: true,
      nameEn: true,
    },
  });

  const categoryDetails = Object.entries(progress.byCategory).map(([id, data]) => {
    const cat = categories.find((c) => c.id === id);
    return {
      id,
      name: cat?.nameEn || "Uncategorized",
      progress: data.percentage,
    };
  });

  return {
    ...progress,
    categories: categoryDetails,
  };
}

// =============================================================================
// SCORING PREPARATION
// =============================================================================

/**
 * Transform responses for scoring functions
 */
export function transformResponsesForScoring(
  responses: ResponseWithQuestion[]
): Array<{
  id: string;
  assessmentId: string;
  questionId: string;
  responseValue: "SATISFACTORY" | "NOT_SATISFACTORY" | "NOT_APPLICABLE" | "NOT_REVIEWED" | null;
  maturityLevel: "A" | "B" | "C" | "D" | "E" | null;
  score: number | undefined;
  evidenceDescription: string | undefined;
  evidenceUrls: string[];
  respondedById: string;
  respondedAt: Date;
  lastModifiedAt: Date;
  isComplete: boolean;
  needsReview: boolean;
  question: {
    id: string;
    pqNumber: string | undefined;
    questionTextEn: string;
    questionTextFr: string;
    auditArea: USOAPAuditArea | undefined;
    criticalElement: CriticalElement | undefined;
    smsComponent: SMSComponent | undefined;
    studyArea: CANSOStudyArea | undefined;
    isPriorityPQ: boolean;
    requiresOnSite: boolean;
    weight: number;
  };
}> {
  return responses.map((r) => ({
    id: r.id,
    assessmentId: r.assessmentId,
    questionId: r.questionId,
    responseValue: r.responseValue as
      | "SATISFACTORY"
      | "NOT_SATISFACTORY"
      | "NOT_APPLICABLE"
      | "NOT_REVIEWED"
      | null,
    maturityLevel: r.maturityLevel
      ? (MATURITY_LEVEL_REVERSE[r.maturityLevel] as "A" | "B" | "C" | "D" | "E")
      : null,
    score: r.score ?? undefined,
    evidenceDescription: r.notes ?? undefined,
    evidenceUrls: r.evidenceUrls,
    respondedById: r.respondedById ?? "",
    respondedAt: r.respondedAt ?? new Date(),
    lastModifiedAt: r.updatedAt,
    isComplete: r.evidenceUrls.length > 0 || (r.notes?.length ?? 0) > 0,
    needsReview: false,
    question: {
      id: r.question.id,
      pqNumber: r.question.pqNumber ?? undefined,
      questionTextEn: r.question.questionTextEn,
      questionTextFr: r.question.questionTextFr,
      auditArea: r.question.auditArea ?? undefined,
      criticalElement: r.question.criticalElement ?? undefined,
      smsComponent: r.question.smsComponent ?? undefined,
      studyArea: r.question.studyArea ?? undefined,
      isPriorityPQ: r.question.isPriorityPQ,
      requiresOnSite: r.question.requiresOnSite,
      weight: r.question.weight,
    },
  }));
}

/**
 * Get all responses for scoring
 */
export async function getResponsesForScoring(
  assessmentId: string
): Promise<ResponseWithQuestion[]> {
  const responses = await prisma.assessmentResponse.findMany({
    where: { assessmentId },
    include: {
      question: {
        select: {
          id: true,
          pqNumber: true,
          questionTextEn: true,
          questionTextFr: true,
          auditArea: true,
          criticalElement: true,
          smsComponent: true,
          studyArea: true,
          isPriorityPQ: true,
          requiresOnSite: true,
          weight: true,
          categoryId: true,
        },
      },
    },
  });

  return responses as ResponseWithQuestion[];
}

// =============================================================================
// VALIDATION
// =============================================================================

/**
 * Validate response value for questionnaire type
 */
export function validateResponseValue(
  questionnaireType: QuestionnaireType,
  ansResponse?: string | null,
  smsResponse?: string | null
): { valid: boolean; error?: string } {
  if (questionnaireType === "ANS_USOAP_CMA") {
    if (smsResponse && !ansResponse) {
      return {
        valid: false,
        error: "SMS maturity level cannot be used for ANS questionnaire",
      };
    }
    const validValues = ["SATISFACTORY", "NOT_SATISFACTORY", "NOT_APPLICABLE", "NOT_REVIEWED"];
    if (ansResponse && !validValues.includes(ansResponse)) {
      return {
        valid: false,
        error: `Invalid ANS response value. Must be one of: ${validValues.join(", ")}`,
      };
    }
  } else {
    if (ansResponse && !smsResponse) {
      return {
        valid: false,
        error: "ANS response value cannot be used for SMS questionnaire",
      };
    }
    const validLevels = ["A", "B", "C", "D", "E"];
    if (smsResponse && !validLevels.includes(smsResponse)) {
      return {
        valid: false,
        error: `Invalid SMS maturity level. Must be one of: ${validLevels.join(", ")}`,
      };
    }
  }

  return { valid: true };
}

/**
 * Validate question belongs to questionnaire
 */
export async function validateQuestionInQuestionnaire(
  questionId: string,
  questionnaireId: string
): Promise<boolean> {
  const question = await prisma.question.findFirst({
    where: {
      id: questionId,
      questionnaireId: questionnaireId,
    },
  });

  return question !== null;
}

// =============================================================================
// AUDIT LOGGING
// =============================================================================

/**
 * Log audit entry for response changes
 */
export async function logResponseAudit(
  userId: string,
  action: string,
  assessmentId: string,
  questionId: string,
  data?: Record<string, unknown>
): Promise<void> {
  try {
    await prisma.auditLog.create({
      data: {
        userId,
        action,
        entityType: "AssessmentResponse",
        entityId: `${assessmentId}:${questionId}`,
        newData: data ? JSON.stringify(data) : Prisma.JsonNull,
      },
    });
  } catch (error) {
    console.error("[Audit] Failed to log response entry:", error);
  }
}

```

# src/server/services/scoring.service.ts

```ts
/**
 * Scoring Service
 *
 * Implements ICAO USOAP CMA (EI Score) and CANSO SoE 2024 (SMS Maturity)
 * scoring methodologies for assessments.
 */

import { prisma } from "@/lib/db";
import type {
  MaturityLevel,
  USOAPAuditArea,
  CriticalElement,
  SMSComponent,
  CANSOStudyArea,
  AssessmentStatus,
} from "@prisma/client";
import {
  AUDIT_AREAS,
  CRITICAL_ELEMENTS,
  SMS_COMPONENTS,
  SMS_STUDY_AREAS,
  percentageToMaturityLevel,
  maturityLevelToNumeric,
  numericToMaturityLevel,
  isCountableResponse,
  MIN_COMPLETION_FOR_SCORING,
  PRIORITY_PQ_WEIGHT,
  DEFAULT_PQ_WEIGHT,
} from "@/lib/constants/scoring";

// =============================================================================
// TYPES
// =============================================================================

export interface AuditAreaScore {
  code: USOAPAuditArea;
  name: string;
  nameEn: string;
  nameFr: string;
  eiScore: number;
  satisfactory: number;
  notSatisfactory: number;
  notApplicable: number;
  notReviewed: number;
  total: number;
  applicable: number;
}

export interface CriticalElementScore {
  code: CriticalElement;
  name: string;
  nameEn: string;
  nameFr: string;
  eiScore: number;
  satisfactory: number;
  notSatisfactory: number;
  notApplicable: number;
  notReviewed: number;
  total: number;
  applicable: number;
}

export interface CategoryScore {
  id: string;
  code: string;
  name: string;
  eiScore: number;
  satisfactory: number;
  notSatisfactory: number;
  notApplicable: number;
  notReviewed: number;
  total: number;
  applicable: number;
}

export interface EIScoreResult {
  overall: number;
  weightedOverall: number;
  byAuditArea: Record<USOAPAuditArea, AuditAreaScore>;
  byCriticalElement: Record<CriticalElement, CriticalElementScore>;
  byCategory: Record<string, CategoryScore>;
  totalQuestions: number;
  applicableQuestions: number;
  satisfactoryCount: number;
  notSatisfactoryCount: number;
  notApplicableCount: number;
  notReviewedCount: number;
  completionPercentage: number;
  calculatedAt: Date;
  isComplete: boolean;
}

export interface ComponentScore {
  code: SMSComponent;
  name: string;
  nameEn: string;
  nameFr: string;
  weight: number;
  score: number;
  level: MaturityLevel;
  studyAreas: CANSOStudyArea[];
  questionCount: number;
  answeredCount: number;
}

export interface StudyAreaScore {
  code: CANSOStudyArea;
  name: string;
  nameEn: string;
  nameFr: string;
  componentCode: SMSComponent;
  score: number;
  level: MaturityLevel;
  questionCount: number;
  answeredCount: number;
  levelCounts: Record<MaturityLevel, number>;
}

export interface TransversalScore {
  code: string;
  name: string;
  score: number;
  level: MaturityLevel;
  questionCount: number;
  answeredCount: number;
}

export interface SMSScoreResult {
  overallScore: number;
  overallLevel: MaturityLevel;
  byComponent: Record<SMSComponent, ComponentScore>;
  byStudyArea: Record<CANSOStudyArea, StudyAreaScore>;
  byTransversalArea: Record<string, TransversalScore>;
  questionCount: number;
  answeredCount: number;
  completionPercentage: number;
  calculatedAt: Date;
  isComplete: boolean;
}

export interface ScoreComparison {
  assessments: Array<{
    id: string;
    title: string;
    type: string;
    organizationName: string;
    completedAt: Date | null;
    score: number;
    level?: MaturityLevel;
  }>;
  trend: "improving" | "declining" | "stable" | "insufficient_data";
  averageScore: number;
  highestScore: number;
  lowestScore: number;
}

export interface ValidationResult {
  isValid: boolean;
  canCalculate: boolean;
  completionPercentage: number;
  errors: string[];
  warnings: string[];
}

// =============================================================================
// SCORING SERVICE CLASS
// =============================================================================

export class ScoringService {
  /**
   * Calculate EI score for ANS (USOAP CMA) assessment
   */
  async calculateEIScore(
    assessmentId: string,
    options: { useWeighting?: boolean } = {}
  ): Promise<EIScoreResult> {
    const { useWeighting = false } = options;

    // Fetch assessment with responses
    const assessment = await prisma.assessment.findUnique({
      where: { id: assessmentId },
      include: {
        questionnaire: true,
        responses: {
          include: {
            question: {
              include: {
                category: true,
              },
            },
          },
        },
      },
    });

    if (!assessment) {
      throw new Error(`Assessment not found: ${assessmentId}`);
    }

    if (assessment.questionnaire.type !== "ANS_USOAP_CMA") {
      throw new Error(
        `Assessment is not ANS type: ${assessment.questionnaire.type}`
      );
    }

    // Initialize score containers
    const byAuditArea = initializeAuditAreaScores();
    const byCriticalElement = initializeCriticalElementScores();
    const byCategory: Record<string, CategoryScore> = {};

    // Count totals
    let totalQuestions = 0;
    let satisfactoryCount = 0;
    let notSatisfactoryCount = 0;
    let notApplicableCount = 0;
    let notReviewedCount = 0;
    let weightedSatisfactory = 0;
    let weightedApplicable = 0;

    // Process each response
    for (const response of assessment.responses) {
      const question = response.question;
      const responseValue = response.responseValue;
      const weight = useWeighting && question.isPriorityPQ
        ? PRIORITY_PQ_WEIGHT
        : DEFAULT_PQ_WEIGHT;

      totalQuestions++;

      // Count by response type
      if (responseValue === "SATISFACTORY") {
        satisfactoryCount++;
        weightedSatisfactory += weight;
      } else if (responseValue === "NOT_SATISFACTORY") {
        notSatisfactoryCount++;
      } else if (responseValue === "NOT_APPLICABLE") {
        notApplicableCount++;
      } else {
        notReviewedCount++;
      }

      // Update audit area scores
      if (question.auditArea && question.auditArea in byAuditArea) {
        const area = byAuditArea[question.auditArea as USOAPAuditArea];
        area.total++;
        if (responseValue === "SATISFACTORY") {
          area.satisfactory++;
        } else if (responseValue === "NOT_SATISFACTORY") {
          area.notSatisfactory++;
        } else if (responseValue === "NOT_APPLICABLE") {
          area.notApplicable++;
        } else {
          area.notReviewed++;
        }
        area.applicable = area.total - area.notApplicable - area.notReviewed;
      }

      // Update critical element scores
      if (question.criticalElement && question.criticalElement in byCriticalElement) {
        const ce = byCriticalElement[question.criticalElement as CriticalElement];
        ce.total++;
        if (responseValue === "SATISFACTORY") {
          ce.satisfactory++;
        } else if (responseValue === "NOT_SATISFACTORY") {
          ce.notSatisfactory++;
        } else if (responseValue === "NOT_APPLICABLE") {
          ce.notApplicable++;
        } else {
          ce.notReviewed++;
        }
        ce.applicable = ce.total - ce.notApplicable - ce.notReviewed;
      }

      // Update category scores
      const categoryId = question.categoryId;
      if (!byCategory[categoryId]) {
        byCategory[categoryId] = {
          id: categoryId,
          code: question.category.code,
          name: question.category.nameEn,
          eiScore: 0,
          satisfactory: 0,
          notSatisfactory: 0,
          notApplicable: 0,
          notReviewed: 0,
          total: 0,
          applicable: 0,
        };
      }
      const cat = byCategory[categoryId];
      cat.total++;
      if (responseValue === "SATISFACTORY") {
        cat.satisfactory++;
      } else if (responseValue === "NOT_SATISFACTORY") {
        cat.notSatisfactory++;
      } else if (responseValue === "NOT_APPLICABLE") {
        cat.notApplicable++;
      } else {
        cat.notReviewed++;
      }
      cat.applicable = cat.total - cat.notApplicable - cat.notReviewed;

      // Track weighted applicable
      if (isCountableResponse(responseValue)) {
        weightedApplicable += weight;
      }
    }

    // Calculate EI scores
    const applicableQuestions =
      totalQuestions - notApplicableCount - notReviewedCount;

    const overall =
      applicableQuestions > 0
        ? Math.round((satisfactoryCount / applicableQuestions) * 100 * 10) / 10
        : 0;

    const weightedOverall =
      weightedApplicable > 0
        ? Math.round((weightedSatisfactory / weightedApplicable) * 100 * 10) / 10
        : 0;

    // Calculate per audit area EI
    for (const area of Object.values(byAuditArea)) {
      area.eiScore =
        area.applicable > 0
          ? Math.round((area.satisfactory / area.applicable) * 100 * 10) / 10
          : 0;
    }

    // Calculate per critical element EI
    for (const ce of Object.values(byCriticalElement)) {
      ce.eiScore =
        ce.applicable > 0
          ? Math.round((ce.satisfactory / ce.applicable) * 100 * 10) / 10
          : 0;
    }

    // Calculate per category EI
    for (const cat of Object.values(byCategory)) {
      cat.eiScore =
        cat.applicable > 0
          ? Math.round((cat.satisfactory / cat.applicable) * 100 * 10) / 10
          : 0;
    }

    const completionPercentage =
      totalQuestions > 0
        ? Math.round(
            ((totalQuestions - notReviewedCount) / totalQuestions) * 100
          )
        : 0;

    return {
      overall,
      weightedOverall,
      byAuditArea,
      byCriticalElement,
      byCategory,
      totalQuestions,
      applicableQuestions,
      satisfactoryCount,
      notSatisfactoryCount,
      notApplicableCount,
      notReviewedCount,
      completionPercentage,
      calculatedAt: new Date(),
      isComplete: completionPercentage >= MIN_COMPLETION_FOR_SCORING,
    };
  }

  /**
   * Calculate SMS maturity for CANSO SoE assessment
   */
  async calculateSMSMaturity(assessmentId: string): Promise<SMSScoreResult> {
    // Fetch assessment with responses
    const assessment = await prisma.assessment.findUnique({
      where: { id: assessmentId },
      include: {
        questionnaire: true,
        responses: {
          include: {
            question: {
              include: {
                category: true,
              },
            },
          },
        },
      },
    });

    if (!assessment) {
      throw new Error(`Assessment not found: ${assessmentId}`);
    }

    if (assessment.questionnaire.type !== "SMS_CANSO_SOE") {
      throw new Error(
        `Assessment is not SMS type: ${assessment.questionnaire.type}`
      );
    }

    // Initialize score containers
    const byStudyArea = initializeStudyAreaScores();
    const byComponent = initializeComponentScores();
    const byTransversalArea: Record<string, TransversalScore> = {};

    let totalQuestions = 0;
    let answeredQuestions = 0;

    // Process each response
    for (const response of assessment.responses) {
      const question = response.question;
      const maturityLevel = response.maturityLevel;

      totalQuestions++;

      if (maturityLevel) {
        answeredQuestions++;
      }

      // Update study area scores
      if (question.studyArea && question.studyArea in byStudyArea) {
        const sa = byStudyArea[question.studyArea as CANSOStudyArea];
        sa.questionCount++;
        if (maturityLevel) {
          sa.answeredCount++;
          sa.levelCounts[maturityLevel]++;
        }
      }
    }

    // Calculate study area scores (average maturity level)
    for (const sa of Object.values(byStudyArea)) {
      if (sa.answeredCount > 0) {
        let totalNumeric = 0;
        for (const [level, count] of Object.entries(sa.levelCounts)) {
          totalNumeric += maturityLevelToNumeric(level as MaturityLevel) * count;
        }
        const avgNumeric = totalNumeric / sa.answeredCount;
        // Convert to percentage (1-5 scale to 0-100)
        sa.score = Math.round(((avgNumeric - 1) / 4) * 100 * 10) / 10;
        sa.level = numericToMaturityLevel(avgNumeric);
      }
    }

    // Calculate component scores (weighted average of study areas)
    for (const comp of Object.values(byComponent)) {
      let totalScore = 0;
      let totalWeight = 0;
      let questionCount = 0;
      let answeredCount = 0;

      for (const saCode of comp.studyAreas) {
        const sa = byStudyArea[saCode];
        if (sa.answeredCount > 0) {
          // Each study area within a component has equal weight
          totalScore += sa.score;
          totalWeight += 1;
        }
        questionCount += sa.questionCount;
        answeredCount += sa.answeredCount;
      }

      comp.questionCount = questionCount;
      comp.answeredCount = answeredCount;

      if (totalWeight > 0) {
        comp.score = Math.round((totalScore / totalWeight) * 10) / 10;
        comp.level = percentageToMaturityLevel(comp.score);
      }
    }

    // Calculate overall score (weighted average of components)
    let overallScore = 0;
    for (const comp of Object.values(byComponent)) {
      if (comp.answeredCount > 0) {
        overallScore += comp.score * comp.weight;
      }
    }
    overallScore = Math.round(overallScore * 10) / 10;
    const overallLevel = percentageToMaturityLevel(overallScore);

    const completionPercentage =
      totalQuestions > 0
        ? Math.round((answeredQuestions / totalQuestions) * 100)
        : 0;

    return {
      overallScore,
      overallLevel,
      byComponent,
      byStudyArea,
      byTransversalArea,
      questionCount: totalQuestions,
      answeredCount: answeredQuestions,
      completionPercentage,
      calculatedAt: new Date(),
      isComplete: completionPercentage >= MIN_COMPLETION_FOR_SCORING,
    };
  }

  /**
   * Calculate scores and update assessment record
   */
  async calculateAndSaveScores(assessmentId: string): Promise<void> {
    const assessment = await prisma.assessment.findUnique({
      where: { id: assessmentId },
      include: { questionnaire: true },
    });

    if (!assessment) {
      throw new Error(`Assessment not found: ${assessmentId}`);
    }

    if (assessment.questionnaire.type === "ANS_USOAP_CMA") {
      const scores = await this.calculateEIScore(assessmentId);

      // Convert to plain JSON for Prisma
      const categoryScoresJson = JSON.parse(JSON.stringify({
        byAuditArea: scores.byAuditArea,
        byCriticalElement: scores.byCriticalElement,
        byCategory: scores.byCategory,
        metadata: {
          totalQuestions: scores.totalQuestions,
          satisfactoryCount: scores.satisfactoryCount,
          notSatisfactoryCount: scores.notSatisfactoryCount,
          notApplicableCount: scores.notApplicableCount,
          completionPercentage: scores.completionPercentage,
        },
      }));

      await prisma.assessment.update({
        where: { id: assessmentId },
        data: {
          eiScore: scores.overall,
          overallScore: scores.overall,
          categoryScores: categoryScoresJson,
          progress: scores.completionPercentage,
        },
      });
    } else {
      const scores = await this.calculateSMSMaturity(assessmentId);

      // Convert to plain JSON for Prisma
      const categoryScoresJson = JSON.parse(JSON.stringify({
        byComponent: scores.byComponent,
        byStudyArea: scores.byStudyArea,
        metadata: {
          questionCount: scores.questionCount,
          answeredCount: scores.answeredCount,
          completionPercentage: scores.completionPercentage,
        },
      }));

      await prisma.assessment.update({
        where: { id: assessmentId },
        data: {
          overallScore: scores.overallScore,
          maturityLevel: scores.overallLevel,
          categoryScores: categoryScoresJson,
          progress: scores.completionPercentage,
        },
      });
    }
  }

  /**
   * Get score breakdown for reporting
   */
  async getScoreBreakdown(
    assessmentId: string
  ): Promise<EIScoreResult | SMSScoreResult> {
    const assessment = await prisma.assessment.findUnique({
      where: { id: assessmentId },
      include: { questionnaire: true },
    });

    if (!assessment) {
      throw new Error(`Assessment not found: ${assessmentId}`);
    }

    if (assessment.questionnaire.type === "ANS_USOAP_CMA") {
      return this.calculateEIScore(assessmentId);
    } else {
      return this.calculateSMSMaturity(assessmentId);
    }
  }

  /**
   * Compare scores between assessments (for trend analysis)
   */
  async compareScores(assessmentIds: string[]): Promise<ScoreComparison> {
    if (assessmentIds.length === 0) {
      return {
        assessments: [],
        trend: "insufficient_data",
        averageScore: 0,
        highestScore: 0,
        lowestScore: 0,
      };
    }

    const assessments = await prisma.assessment.findMany({
      where: { id: { in: assessmentIds } },
      include: {
        organization: true,
        questionnaire: true,
      },
      orderBy: { completedAt: "asc" },
    });

    const results = assessments.map((a) => ({
      id: a.id,
      title: a.title,
      type: a.questionnaire.type,
      organizationName: a.organization.nameEn,
      completedAt: a.completedAt,
      score: a.overallScore ?? 0,
      level: a.maturityLevel ?? undefined,
    }));

    const scores: number[] = results.map((r) => r.score).filter((s): s is number => s > 0);

    if (scores.length < 2) {
      return {
        assessments: results,
        trend: "insufficient_data",
        averageScore: scores.length > 0 ? scores[0] : 0,
        highestScore: scores.length > 0 ? Math.max(...scores) : 0,
        lowestScore: scores.length > 0 ? Math.min(...scores) : 0,
      };
    }

    const averageScore =
      Math.round((scores.reduce((a: number, b: number) => a + b, 0) / scores.length) * 10) / 10;
    const highestScore = Math.max(...scores);
    const lowestScore = Math.min(...scores);

    // Determine trend based on first and last scores
    const firstScore = scores[0];
    const lastScore = scores[scores.length - 1];
    const scoreDiff = lastScore - firstScore;

    let trend: ScoreComparison["trend"];
    if (scoreDiff > 5) {
      trend = "improving";
    } else if (scoreDiff < -5) {
      trend = "declining";
    } else {
      trend = "stable";
    }

    return {
      assessments: results,
      trend,
      averageScore,
      highestScore,
      lowestScore,
    };
  }

  /**
   * Validate assessment is complete enough for scoring
   */
  async validateForScoring(assessmentId: string): Promise<ValidationResult> {
    const assessment = await prisma.assessment.findUnique({
      where: { id: assessmentId },
      include: {
        questionnaire: true,
        responses: true,
      },
    });

    if (!assessment) {
      return {
        isValid: false,
        canCalculate: false,
        completionPercentage: 0,
        errors: ["Assessment not found"],
        warnings: [],
      };
    }

    const errors: string[] = [];
    const warnings: string[] = [];

    // Count responses
    const totalResponses = assessment.responses.length;
    let answeredCount = 0;

    if (assessment.questionnaire.type === "ANS_USOAP_CMA") {
      for (const response of assessment.responses) {
        if (
          response.responseValue &&
          response.responseValue !== "NOT_REVIEWED"
        ) {
          answeredCount++;
        }
      }
    } else {
      for (const response of assessment.responses) {
        if (response.maturityLevel) {
          answeredCount++;
        }
      }
    }

    const completionPercentage =
      totalResponses > 0
        ? Math.round((answeredCount / totalResponses) * 100)
        : 0;

    // Check completion threshold
    if (completionPercentage < MIN_COMPLETION_FOR_SCORING) {
      warnings.push(
        `Assessment is only ${completionPercentage}% complete. Minimum ${MIN_COMPLETION_FOR_SCORING}% required for official scoring.`
      );
    }

    // Check assessment status
    const validStatuses: AssessmentStatus[] = [
      "SUBMITTED",
      "UNDER_REVIEW",
      "COMPLETED",
    ];
    if (!validStatuses.includes(assessment.status)) {
      warnings.push(
        `Assessment status is ${assessment.status}. Consider submitting the assessment for official scoring.`
      );
    }

    // Check for any responses
    if (totalResponses === 0) {
      errors.push("No responses recorded for this assessment");
    }

    return {
      isValid: errors.length === 0,
      canCalculate: errors.length === 0,
      completionPercentage,
      errors,
      warnings,
    };
  }

  /**
   * Get historical scores for an organization
   */
  async getOrganizationScoreHistory(
    organizationId: string,
    questionnaireType?: "ANS_USOAP_CMA" | "SMS_CANSO_SOE"
  ): Promise<ScoreComparison> {
    const whereClause: Record<string, unknown> = {
      organizationId,
      overallScore: { not: null },
    };

    if (questionnaireType) {
      whereClause.questionnaire = { type: questionnaireType };
    }

    const assessments = await prisma.assessment.findMany({
      where: whereClause,
      include: {
        organization: true,
        questionnaire: true,
      },
      orderBy: { completedAt: "asc" },
    });

    return this.compareScores(assessments.map((a: { id: string }) => a.id));
  }
}

// =============================================================================
// HELPER FUNCTIONS
// =============================================================================

function initializeAuditAreaScores(): Record<USOAPAuditArea, AuditAreaScore> {
  const scores: Partial<Record<USOAPAuditArea, AuditAreaScore>> = {};

  for (const [code, info] of Object.entries(AUDIT_AREAS)) {
    scores[code as USOAPAuditArea] = {
      code: code as USOAPAuditArea,
      name: info.name,
      nameEn: info.nameEn,
      nameFr: info.nameFr,
      eiScore: 0,
      satisfactory: 0,
      notSatisfactory: 0,
      notApplicable: 0,
      notReviewed: 0,
      total: 0,
      applicable: 0,
    };
  }

  return scores as Record<USOAPAuditArea, AuditAreaScore>;
}

function initializeCriticalElementScores(): Record<
  CriticalElement,
  CriticalElementScore
> {
  const scores: Partial<Record<CriticalElement, CriticalElementScore>> = {};

  for (const [code, info] of Object.entries(CRITICAL_ELEMENTS)) {
    scores[code as CriticalElement] = {
      code: code as CriticalElement,
      name: info.name,
      nameEn: info.nameEn,
      nameFr: info.nameFr,
      eiScore: 0,
      satisfactory: 0,
      notSatisfactory: 0,
      notApplicable: 0,
      notReviewed: 0,
      total: 0,
      applicable: 0,
    };
  }

  return scores as Record<CriticalElement, CriticalElementScore>;
}

function initializeStudyAreaScores(): Record<CANSOStudyArea, StudyAreaScore> {
  const scores: Partial<Record<CANSOStudyArea, StudyAreaScore>> = {};

  for (const [code, info] of Object.entries(SMS_STUDY_AREAS)) {
    scores[code as CANSOStudyArea] = {
      code: code as CANSOStudyArea,
      name: info.name,
      nameEn: info.nameEn,
      nameFr: info.nameFr,
      componentCode: info.component,
      score: 0,
      level: "LEVEL_A",
      questionCount: 0,
      answeredCount: 0,
      levelCounts: {
        LEVEL_A: 0,
        LEVEL_B: 0,
        LEVEL_C: 0,
        LEVEL_D: 0,
        LEVEL_E: 0,
      },
    };
  }

  return scores as Record<CANSOStudyArea, StudyAreaScore>;
}

function initializeComponentScores(): Record<SMSComponent, ComponentScore> {
  const scores: Partial<Record<SMSComponent, ComponentScore>> = {};

  for (const [code, info] of Object.entries(SMS_COMPONENTS)) {
    scores[code as SMSComponent] = {
      code: code as SMSComponent,
      name: info.name,
      nameEn: info.nameEn,
      nameFr: info.nameFr,
      weight: info.weight,
      score: 0,
      level: "LEVEL_A",
      studyAreas: info.studyAreas,
      questionCount: 0,
      answeredCount: 0,
    };
  }

  return scores as Record<SMSComponent, ComponentScore>;
}

// Export singleton instance
export const scoringService = new ScoringService();

```

# src/server/trpc/context.ts

```ts
import type { FetchCreateContextFnOptions } from "@trpc/server/adapters/fetch";
import { auth } from "@/lib/auth";
import { db } from "@/lib/db";
import type { Session } from "next-auth";

/**
 * Context available to all tRPC procedures
 */
export interface Context {
  session: Session | null;
  db: typeof db;
  headers: Headers;
}

/**
 * Creates context for each tRPC request
 * This is called for each incoming request
 */
export async function createContext(
  opts: FetchCreateContextFnOptions
): Promise<Context> {
  const session = await auth();

  return {
    session,
    db,
    headers: opts.req.headers,
  };
}

/**
 * Create context for server-side calls (without HTTP request)
 */
export async function createServerContext(): Promise<Context> {
  const session = await auth();

  return {
    session,
    db,
    headers: new Headers(),
  };
}

```

# src/server/trpc/index.ts

```ts
// Re-export everything for convenient imports
export * from "./trpc";
export * from "./context";
export { appRouter, type AppRouter, createCaller } from "./routers/_app";

```

# src/server/trpc/routers/_app.ts

```ts
import { router, createCallerFactory } from "../trpc";
import { questionnaireRouter } from "./questionnaire";
import { adminRouter } from "./admin";
import { assessmentRouter } from "./assessment";
import { responseRouter } from "./response";
import { scoringRouter } from "./scoring";
import { documentRouter } from "./document";
import { progressRouter } from "./progress";

/**
 * Main app router combining all sub-routers
 */
export const appRouter = router({
  questionnaire: questionnaireRouter,
  admin: adminRouter,
  assessment: assessmentRouter,
  response: responseRouter,
  scoring: scoringRouter,
  document: documentRouter,
  progress: progressRouter,
});

/**
 * Export type definition of the API
 * This is used by the client to type-check calls
 */
export type AppRouter = typeof appRouter;

/**
 * Create a server-side caller for direct procedure calls
 */
export const createCaller = createCallerFactory(appRouter);

```

# src/server/trpc/routers/admin/index.ts

```ts
import { router } from "../../trpc";
import { adminQuestionnaireRouter } from "./questionnaire";

/**
 * Admin router combining all admin-specific sub-routers
 */
export const adminRouter = router({
  questionnaire: adminQuestionnaireRouter,
});

```

# src/server/trpc/routers/admin/questionnaire.ts

```ts
import { z } from "zod";
import { TRPCError } from "@trpc/server";
import { router, adminProcedure } from "../../trpc";
import { prisma } from "@/lib/db";
import {
  QuestionnaireImportSchema,
  CategoryImportSchema,
  ANSQuestionImportSchema,
  SMSQuestionImportSchema,
  QuestionnaireTypeSchema,
  type ValidationError,
  type ImportSummary,
} from "@/lib/questionnaire/import-schema";
import {
  parseJSON,
  parseCSV,
  parseANSImport,
  parseSMSImport,
} from "@/lib/questionnaire/import-parser";

// =============================================================================
// INPUT SCHEMAS
// =============================================================================

const CreateQuestionnaireInput = QuestionnaireImportSchema;

const UpdateQuestionnaireInput = z.object({
  id: z.string().cuid(),
  data: QuestionnaireImportSchema.partial(),
});

const DeleteQuestionnaireInput = z.object({
  id: z.string().cuid(),
  hardDelete: z.boolean().default(false),
});

const ValidateImportInput = z.object({
  type: QuestionnaireTypeSchema,
  data: z.string(), // JSON or CSV string
  format: z.enum(["json", "csv"]).default("json"),
});

const ImportQuestionsInput = z.object({
  questionnaireId: z.string().cuid(),
  questions: z.array(z.union([ANSQuestionImportSchema, SMSQuestionImportSchema])),
  categories: z.array(CategoryImportSchema).optional(),
  updateExisting: z.boolean().default(false),
});

const BulkImportInput = z.object({
  type: QuestionnaireTypeSchema,
  data: z.string(), // JSON string
  createQuestionnaire: z.boolean().default(true),
  updateExisting: z.boolean().default(false),
});

// =============================================================================
// ADMIN QUESTIONNAIRE ROUTER
// =============================================================================

export const adminQuestionnaireRouter = router({
  /**
   * List all questionnaires (including inactive)
   */
  list: adminProcedure
    .input(
      z.object({
        includeInactive: z.boolean().default(true),
        type: QuestionnaireTypeSchema.optional(),
      }).optional()
    )
    .query(async ({ input }) => {
      const where: Record<string, unknown> = {};

      if (input?.type) {
        where.type = input.type;
      }

      if (!input?.includeInactive) {
        where.isActive = true;
      }

      const questionnaires = await prisma.questionnaire.findMany({
        where,
        include: {
          _count: {
            select: {
              questions: true,
              categories: true,
              assessments: true,
            },
          },
        },
        orderBy: [{ type: "asc" }, { effectiveDate: "desc" }],
      });

      return questionnaires;
    }),

  /**
   * Get questionnaire by ID with full details
   */
  getById: adminProcedure
    .input(z.object({ id: z.string().cuid() }))
    .query(async ({ input }) => {
      const questionnaire = await prisma.questionnaire.findUnique({
        where: { id: input.id },
        include: {
          categories: {
            orderBy: { sortOrder: "asc" },
          },
          questions: {
            include: {
              icaoReferences: true,
            },
            orderBy: { sortOrder: "asc" },
          },
          _count: {
            select: {
              assessments: true,
            },
          },
        },
      });

      if (!questionnaire) {
        throw new TRPCError({
          code: "NOT_FOUND",
          message: "Questionnaire not found",
        });
      }

      return questionnaire;
    }),

  /**
   * Create a new questionnaire
   */
  create: adminProcedure
    .input(CreateQuestionnaireInput)
    .mutation(async ({ input, ctx }) => {
      // Check for duplicate code
      const existing = await prisma.questionnaire.findUnique({
        where: { code: input.code },
      });

      if (existing) {
        throw new TRPCError({
          code: "CONFLICT",
          message: `Questionnaire with code "${input.code}" already exists`,
        });
      }

      const questionnaire = await prisma.questionnaire.create({
        data: {
          ...input,
          effectiveDate: new Date(input.effectiveDate),
          expiryDate: input.expiryDate ? new Date(input.expiryDate) : null,
        },
      });

      console.log(
        `[Admin] User ${ctx.user.id} created questionnaire ${questionnaire.id}`
      );

      return questionnaire;
    }),

  /**
   * Update questionnaire metadata
   */
  update: adminProcedure
    .input(UpdateQuestionnaireInput)
    .mutation(async ({ input, ctx }) => {
      const existing = await prisma.questionnaire.findUnique({
        where: { id: input.id },
      });

      if (!existing) {
        throw new TRPCError({
          code: "NOT_FOUND",
          message: "Questionnaire not found",
        });
      }

      // Check for code conflict if updating code
      if (input.data.code && input.data.code !== existing.code) {
        const codeConflict = await prisma.questionnaire.findUnique({
          where: { code: input.data.code },
        });

        if (codeConflict) {
          throw new TRPCError({
            code: "CONFLICT",
            message: `Questionnaire with code "${input.data.code}" already exists`,
          });
        }
      }

      const questionnaire = await prisma.questionnaire.update({
        where: { id: input.id },
        data: {
          ...input.data,
          effectiveDate: input.data.effectiveDate
            ? new Date(input.data.effectiveDate)
            : undefined,
          expiryDate: input.data.expiryDate
            ? new Date(input.data.expiryDate)
            : undefined,
        },
      });

      console.log(
        `[Admin] User ${ctx.user.id} updated questionnaire ${questionnaire.id}`
      );

      return questionnaire;
    }),

  /**
   * Delete questionnaire (soft delete by default)
   */
  delete: adminProcedure
    .input(DeleteQuestionnaireInput)
    .mutation(async ({ input, ctx }) => {
      const existing = await prisma.questionnaire.findUnique({
        where: { id: input.id },
        include: {
          _count: {
            select: { assessments: true },
          },
        },
      });

      if (!existing) {
        throw new TRPCError({
          code: "NOT_FOUND",
          message: "Questionnaire not found",
        });
      }

      // Prevent hard delete if assessments exist
      if (input.hardDelete && existing._count.assessments > 0) {
        throw new TRPCError({
          code: "PRECONDITION_FAILED",
          message: `Cannot hard delete questionnaire with ${existing._count.assessments} assessments. Use soft delete instead.`,
        });
      }

      if (input.hardDelete) {
        // Delete all related data
        await prisma.$transaction([
          prisma.iCAOReference.deleteMany({
            where: { question: { questionnaireId: input.id } },
          }),
          prisma.question.deleteMany({
            where: { questionnaireId: input.id },
          }),
          prisma.questionnaireCategory.deleteMany({
            where: { questionnaireId: input.id },
          }),
          prisma.questionnaire.delete({
            where: { id: input.id },
          }),
        ]);

        console.log(
          `[Admin] User ${ctx.user.id} hard deleted questionnaire ${input.id}`
        );

        return { deleted: true, hard: true };
      }

      // Soft delete
      await prisma.questionnaire.update({
        where: { id: input.id },
        data: { isActive: false },
      });

      console.log(
        `[Admin] User ${ctx.user.id} soft deleted questionnaire ${input.id}`
      );

      return { deleted: true, hard: false };
    }),

  /**
   * Validate import data without committing
   */
  validateImport: adminProcedure
    .input(ValidateImportInput)
    .mutation(async ({ input }) => {
      let parsedData: unknown;

      // Parse input based on format
      if (input.format === "csv") {
        const csvResult = parseCSV(input.data);
        if (csvResult.errors.length > 0) {
          return {
            isValid: false,
            errors: csvResult.errors,
            warnings: [],
            summary: null,
          };
        }
        parsedData = { questions: csvResult.data };
      } else {
        const jsonResult = parseJSON(input.data);
        if (jsonResult.errors.length > 0) {
          return {
            isValid: false,
            errors: jsonResult.errors,
            warnings: [],
            summary: null,
          };
        }
        parsedData = jsonResult.data;
      }

      // Validate based on type
      const parseResult =
        input.type === "ANS_USOAP_CMA"
          ? parseANSImport(parsedData)
          : parseSMSImport(parsedData);

      const summary: ImportSummary = {
        totalQuestions: parseResult.questions.length,
        totalCategories: parseResult.categories.length,
        totalReferences: parseResult.questions.reduce(
          (sum, q) => sum + (q.icaoReferences?.length || 0),
          0
        ),
        newQuestions: parseResult.questions.length,
        updatedQuestions: 0,
        errors: parseResult.errors,
        warnings: parseResult.warnings,
      };

      return {
        isValid: parseResult.errors.length === 0,
        errors: parseResult.errors,
        warnings: parseResult.warnings,
        summary,
        preview: {
          questionnaire: parseResult.questionnaire,
          categories: parseResult.categories.slice(0, 10),
          questions: parseResult.questions.slice(0, 20),
        },
      };
    }),

  /**
   * Import questions into existing questionnaire
   */
  importQuestions: adminProcedure
    .input(ImportQuestionsInput)
    .mutation(async ({ input, ctx }) => {
      const questionnaire = await prisma.questionnaire.findUnique({
        where: { id: input.questionnaireId },
      });

      if (!questionnaire) {
        throw new TRPCError({
          code: "NOT_FOUND",
          message: "Questionnaire not found",
        });
      }

      const errors: ValidationError[] = [];
      let createdCount = 0;
      let updatedCount = 0;

      // Import categories first
      const categoryMap = new Map<string, string>();

      if (input.categories && input.categories.length > 0) {
        for (const cat of input.categories) {
          const existing = await prisma.questionnaireCategory.findFirst({
            where: {
              questionnaireId: input.questionnaireId,
              code: cat.code,
            },
          });

          if (existing) {
            if (input.updateExisting) {
              await prisma.questionnaireCategory.update({
                where: { id: existing.id },
                data: cat,
              });
            }
            categoryMap.set(cat.code, existing.id);
          } else {
            const created = await prisma.questionnaireCategory.create({
              data: {
                ...cat,
                questionnaireId: input.questionnaireId,
              },
            });
            categoryMap.set(cat.code, created.id);
          }
        }
      }

      // Get or create default category
      let defaultCategoryId: string;
      const defaultCategory = await prisma.questionnaireCategory.findFirst({
        where: {
          questionnaireId: input.questionnaireId,
          code: "DEFAULT",
        },
      });

      if (defaultCategory) {
        defaultCategoryId = defaultCategory.id;
      } else {
        const created = await prisma.questionnaireCategory.create({
          data: {
            questionnaireId: input.questionnaireId,
            code: "DEFAULT",
            nameEn: "Default Category",
            nameFr: "Catégorie par défaut",
            sortOrder: 0,
          },
        });
        defaultCategoryId = created.id;
      }

      // Import questions
      for (let i = 0; i < input.questions.length; i++) {
        const q = input.questions[i];

        try {
          // Check if question exists (by PQ number)
          const existing = q.pqNumber
            ? await prisma.question.findFirst({
                where: {
                  questionnaireId: input.questionnaireId,
                  pqNumber: q.pqNumber,
                },
              })
            : null;

          // Determine category ID
          const categoryId = defaultCategoryId;

          // Prepare question data
          const questionData = {
            questionnaireId: input.questionnaireId,
            categoryId,
            pqNumber: q.pqNumber || null,
            questionTextEn: q.questionTextEn,
            questionTextFr: q.questionTextFr,
            guidanceEn: q.guidanceEn || null,
            guidanceFr: q.guidanceFr || null,
            responseType: q.responseType || "SATISFACTORY_NOT",
            weight: q.weight || 1.0,
            maxScore: q.maxScore || 1.0,
            sortOrder: q.sortOrder,
            // ANS-specific fields
            auditArea: "auditArea" in q ? q.auditArea : null,
            criticalElement: "criticalElement" in q ? q.criticalElement : null,
            isPriorityPQ: "isPriorityPQ" in q ? q.isPriorityPQ : false,
            requiresOnSite: "requiresOnSite" in q ? q.requiresOnSite : false,
            pqStatus: "pqStatus" in q ? q.pqStatus : "NO_CHANGE",
            previousPqNumber: "previousPqNumber" in q ? q.previousPqNumber : null,
            // SMS-specific fields
            smsComponent: "smsComponent" in q ? q.smsComponent : null,
            studyArea: "studyArea" in q ? q.studyArea : null,
            maturityLevel: "maturityLevel" in q ? q.maturityLevel : null,
          };

          if (existing && input.updateExisting) {
            // Update existing question
            await prisma.question.update({
              where: { id: existing.id },
              data: questionData,
            });

            // Update ICAO references
            if (q.icaoReferences && q.icaoReferences.length > 0) {
              await prisma.iCAOReference.deleteMany({
                where: { questionId: existing.id },
              });
              await prisma.iCAOReference.createMany({
                data: q.icaoReferences.map((ref) => ({
                  questionId: existing.id,
                  referenceType: ref.referenceType,
                  document: ref.document,
                  chapter: ref.chapter || null,
                  description: ref.description || null,
                })),
              });
            }

            updatedCount++;
          } else if (!existing) {
            // Create new question
            const created = await prisma.question.create({
              data: questionData,
            });

            // Create ICAO references
            if (q.icaoReferences && q.icaoReferences.length > 0) {
              await prisma.iCAOReference.createMany({
                data: q.icaoReferences.map((ref) => ({
                  questionId: created.id,
                  referenceType: ref.referenceType,
                  document: ref.document,
                  chapter: ref.chapter || null,
                  description: ref.description || null,
                })),
              });
            }

            createdCount++;
          }
        } catch (error) {
          errors.push({
            row: i,
            field: "question",
            message:
              error instanceof Error ? error.message : "Unknown error",
          });
        }
      }

      console.log(
        `[Admin] User ${ctx.user.id} imported ${createdCount} new, ${updatedCount} updated questions to questionnaire ${input.questionnaireId}`
      );

      return {
        success: errors.length === 0,
        created: createdCount,
        updated: updatedCount,
        errors,
      };
    }),

  /**
   * Bulk import with questionnaire creation
   */
  bulkImport: adminProcedure
    .input(BulkImportInput)
    .mutation(async ({ input, ctx }) => {
      // Parse JSON data
      const jsonResult = parseJSON(input.data);
      if (jsonResult.errors.length > 0) {
        return {
          success: false,
          errors: jsonResult.errors,
          questionnaireId: null,
        };
      }

      // Validate and parse based on type
      const parseResult =
        input.type === "ANS_USOAP_CMA"
          ? parseANSImport(jsonResult.data)
          : parseSMSImport(jsonResult.data);

      if (parseResult.errors.length > 0) {
        return {
          success: false,
          errors: parseResult.errors,
          questionnaireId: null,
        };
      }

      let questionnaireId: string;

      if (input.createQuestionnaire && parseResult.questionnaire) {
        // Check for existing
        const existing = await prisma.questionnaire.findUnique({
          where: { code: parseResult.questionnaire.code },
        });

        if (existing && !input.updateExisting) {
          return {
            success: false,
            errors: [
              {
                row: 0,
                field: "questionnaire.code",
                message: `Questionnaire with code "${parseResult.questionnaire.code}" already exists`,
              },
            ],
            questionnaireId: null,
          };
        }

        if (existing) {
          questionnaireId = existing.id;
        } else {
          const created = await prisma.questionnaire.create({
            data: {
              ...parseResult.questionnaire,
              effectiveDate: new Date(parseResult.questionnaire.effectiveDate),
              expiryDate: parseResult.questionnaire.expiryDate
                ? new Date(parseResult.questionnaire.expiryDate)
                : null,
            },
          });
          questionnaireId = created.id;
        }
      } else {
        return {
          success: false,
          errors: [
            {
              row: 0,
              field: "questionnaire",
              message: "Questionnaire metadata is required for bulk import",
            },
          ],
          questionnaireId: null,
        };
      }

      // Import categories and questions using existing procedure logic
      const importResult = await prisma.$transaction(async (tx) => {
        const categoryMap = new Map<string, string>();
        let createdQuestions = 0;
        let createdReferences = 0;

        // Create categories
        for (const cat of parseResult.categories) {
          const created = await tx.questionnaireCategory.create({
            data: {
              ...cat,
              questionnaireId,
            },
          });
          categoryMap.set(cat.code, created.id);
        }

        // Create default category if none exist
        if (categoryMap.size === 0) {
          const defaultCat = await tx.questionnaireCategory.create({
            data: {
              questionnaireId,
              code: "DEFAULT",
              nameEn: "Default Category",
              nameFr: "Catégorie par défaut",
              sortOrder: 0,
            },
          });
          categoryMap.set("DEFAULT", defaultCat.id);
        }

        const defaultCategoryId = categoryMap.get("DEFAULT") || Array.from(categoryMap.values())[0];

        // Create questions
        for (const q of parseResult.questions) {
          const questionData = {
            questionnaireId,
            categoryId: defaultCategoryId,
            pqNumber: q.pqNumber || null,
            questionTextEn: q.questionTextEn,
            questionTextFr: q.questionTextFr,
            guidanceEn: q.guidanceEn || null,
            guidanceFr: q.guidanceFr || null,
            responseType: q.responseType || (input.type === "ANS_USOAP_CMA" ? "SATISFACTORY_NOT" : "MATURITY_LEVEL"),
            weight: q.weight || 1.0,
            maxScore: q.maxScore || (input.type === "ANS_USOAP_CMA" ? 1.0 : 5.0),
            sortOrder: q.sortOrder,
            auditArea: "auditArea" in q ? q.auditArea : null,
            criticalElement: "criticalElement" in q ? q.criticalElement : null,
            isPriorityPQ: "isPriorityPQ" in q ? q.isPriorityPQ : false,
            requiresOnSite: "requiresOnSite" in q ? q.requiresOnSite : false,
            pqStatus: "pqStatus" in q ? q.pqStatus : "NO_CHANGE",
            previousPqNumber: "previousPqNumber" in q ? q.previousPqNumber : null,
            smsComponent: "smsComponent" in q ? q.smsComponent : null,
            studyArea: "studyArea" in q ? q.studyArea : null,
            maturityLevel: "maturityLevel" in q ? q.maturityLevel : null,
          };

          const created = await tx.question.create({
            data: questionData,
          });

          createdQuestions++;

          // Create ICAO references
          if (q.icaoReferences && q.icaoReferences.length > 0) {
            await tx.iCAOReference.createMany({
              data: q.icaoReferences.map((ref) => ({
                questionId: created.id,
                referenceType: ref.referenceType,
                document: ref.document,
                chapter: ref.chapter || null,
                description: ref.description || null,
              })),
            });
            createdReferences += q.icaoReferences.length;
          }
        }

        return {
          categories: categoryMap.size,
          questions: createdQuestions,
          references: createdReferences,
        };
      });

      console.log(
        `[Admin] User ${ctx.user.id} bulk imported questionnaire ${questionnaireId}: ${importResult.categories} categories, ${importResult.questions} questions, ${importResult.references} references`
      );

      return {
        success: true,
        errors: [],
        questionnaireId,
        summary: {
          categories: importResult.categories,
          questions: importResult.questions,
          references: importResult.references,
        },
      };
    }),

  /**
   * Get import statistics for a questionnaire
   */
  getStats: adminProcedure
    .input(z.object({ id: z.string().cuid() }))
    .query(async ({ input }) => {
      const questionnaire = await prisma.questionnaire.findUnique({
        where: { id: input.id },
        include: {
          _count: {
            select: {
              categories: true,
              questions: true,
              assessments: true,
            },
          },
        },
      });

      if (!questionnaire) {
        throw new TRPCError({
          code: "NOT_FOUND",
          message: "Questionnaire not found",
        });
      }

      // Get question breakdown
      const questionStats = await prisma.question.groupBy({
        by: ["pqStatus"],
        where: { questionnaireId: input.id },
        _count: true,
      });

      // Get priority PQ count
      const priorityCount = await prisma.question.count({
        where: { questionnaireId: input.id, isPriorityPQ: true },
      });

      // Get ICAO reference count
      const referenceCount = await prisma.iCAOReference.count({
        where: { question: { questionnaireId: input.id } },
      });

      return {
        questionnaire,
        totalCategories: questionnaire._count.categories,
        totalQuestions: questionnaire._count.questions,
        totalAssessments: questionnaire._count.assessments,
        priorityQuestions: priorityCount,
        totalReferences: referenceCount,
        questionsByStatus: questionStats.reduce(
          (acc, item) => {
            acc[item.pqStatus] = item._count;
            return acc;
          },
          {} as Record<string, number>
        ),
      };
    }),
});

```

# src/server/trpc/routers/assessment.ts

```ts
/**
 * Assessment Router - Self-Assessment Module API
 *
 * Provides comprehensive CRUD operations, scoring, and progress tracking
 * for both ANS USOAP CMA and SMS CANSO SoE assessments.
 */

import { z } from "zod";
import { TRPCError } from "@trpc/server";
import {
  router,
  protectedProcedure,
  roleProcedure,
} from "../trpc";
import { prisma } from "@/lib/db";
import {
  AssessmentStatus,
  AssessmentType,
  MaturityLevel,
  UserRole,
  QuestionnaireType,
  USOAPAuditArea,
  SMSComponent,
  CriticalElement,
  CANSOStudyArea,
  Prisma,
} from "@prisma/client";
import {
  calculateEIScore,
  calculateSMSMaturity,
  calculateCategoryScores,
  calculateProgress,
  validateAssessmentForSubmission,
  maturityLevelToScore,
} from "@/lib/assessment";
import type {
  AssessmentResponseWithQuestion,
} from "@/lib/assessment";

// =============================================================================
// CONSTANTS & HELPERS
// =============================================================================

/**
 * Roles with full access to organization assessments
 */
const ASSESSMENT_MANAGER_ROLES: UserRole[] = [
  "SUPER_ADMIN",
  "SYSTEM_ADMIN",
  "PROGRAMME_COORDINATOR",
  "ANSP_ADMIN",
  "SAFETY_MANAGER",
  "QUALITY_MANAGER",
];

/**
 * Valid status transitions
 */
const STATUS_TRANSITIONS: Record<AssessmentStatus, AssessmentStatus[]> = {
  DRAFT: ["SUBMITTED", "ARCHIVED"],
  SUBMITTED: ["UNDER_REVIEW", "DRAFT"],
  UNDER_REVIEW: ["COMPLETED", "SUBMITTED"],
  COMPLETED: ["ARCHIVED"],
  ARCHIVED: [],
};

/**
 * Maturity level mapping for database/display conversion
 */
const MATURITY_LEVEL_MAP: Record<string, MaturityLevel> = {
  A: "LEVEL_A",
  B: "LEVEL_B",
  C: "LEVEL_C",
  D: "LEVEL_D",
  E: "LEVEL_E",
};

const MATURITY_LEVEL_REVERSE: Record<MaturityLevel, string> = {
  LEVEL_A: "A",
  LEVEL_B: "B",
  LEVEL_C: "C",
  LEVEL_D: "D",
  LEVEL_E: "E",
};

/**
 * Assessment with relations type
 */
type AssessmentWithRelations = Prisma.AssessmentGetPayload<{
  include: {
    organization: true;
    questionnaire: true;
  };
}>;

/**
 * Check if user has access to assessment
 */
async function checkAssessmentAccess(
  assessmentId: string,
  userId: string,
  userRole: UserRole,
  userOrgId: string | null,
  requireWrite: boolean = false
): Promise<{
  assessment: AssessmentWithRelations | null;
  hasAccess: boolean;
  reason?: string;
}> {
  const assessment = await prisma.assessment.findUnique({
    where: { id: assessmentId },
    include: {
      organization: true,
      questionnaire: true,
    },
  });

  if (!assessment) {
    return { assessment: null, hasAccess: false, reason: "Assessment not found" };
  }

  // Super admins and system admins have full access
  if (["SUPER_ADMIN", "SYSTEM_ADMIN", "PROGRAMME_COORDINATOR"].includes(userRole)) {
    return { assessment, hasAccess: true };
  }

  // Check organization membership
  if (userOrgId !== assessment.organizationId) {
    // Peer reviewers can view submitted assessments
    if (
      ["PEER_REVIEWER", "LEAD_REVIEWER"].includes(userRole) &&
      ["SUBMITTED", "UNDER_REVIEW", "COMPLETED"].includes(assessment.status) &&
      !requireWrite
    ) {
      return { assessment, hasAccess: true };
    }

    // Steering committee can view all completed assessments
    if (
      userRole === "STEERING_COMMITTEE" &&
      assessment.status === "COMPLETED" &&
      !requireWrite
    ) {
      return { assessment, hasAccess: true };
    }

    return {
      assessment,
      hasAccess: false,
      reason: "You do not have access to this organization's assessments",
    };
  }

  // Organization members - check role for write access
  if (requireWrite && !ASSESSMENT_MANAGER_ROLES.includes(userRole)) {
    return {
      assessment,
      hasAccess: false,
      reason: "You do not have permission to modify assessments",
    };
  }

  return { assessment, hasAccess: true };
}

/**
 * Log audit entry
 */
async function logAuditEntry(
  userId: string,
  action: string,
  entityType: string,
  entityId: string,
  newData?: Record<string, unknown>
): Promise<void> {
  try {
    await prisma.auditLog.create({
      data: {
        userId,
        action,
        entityType,
        entityId,
        newData: newData ? JSON.stringify(newData) : Prisma.JsonNull,
      },
    });
  } catch (error) {
    console.error("[Audit] Failed to log entry:", error);
  }
}

/**
 * Transform responses for scoring functions
 */
function transformResponsesForScoring(
  responses: Array<{
    id: string;
    assessmentId: string;
    questionId: string;
    responseValue: string | null;
    maturityLevel: MaturityLevel | null;
    score: number | null;
    notes: string | null;
    evidenceUrls: string[];
    respondedById: string | null;
    respondedAt: Date | null;
    updatedAt: Date;
    question: {
      id: string;
      pqNumber: string | null;
      questionTextEn: string;
      questionTextFr: string;
      auditArea: USOAPAuditArea | null;
      criticalElement: CriticalElement | null;
      smsComponent: SMSComponent | null;
      studyArea: CANSOStudyArea | null;
      isPriorityPQ: boolean;
      requiresOnSite: boolean;
      weight: number;
    };
  }>
): AssessmentResponseWithQuestion[] {
  return responses.map((r) => ({
    id: r.id,
    assessmentId: r.assessmentId,
    questionId: r.questionId,
    responseValue: r.responseValue as "SATISFACTORY" | "NOT_SATISFACTORY" | "NOT_APPLICABLE" | "NOT_REVIEWED" | null,
    maturityLevel: r.maturityLevel
      ? (MATURITY_LEVEL_REVERSE[r.maturityLevel] as "A" | "B" | "C" | "D" | "E")
      : null,
    score: r.score ?? undefined,
    evidenceDescription: r.notes ?? undefined,
    evidenceUrls: r.evidenceUrls,
    respondedById: r.respondedById ?? "",
    respondedAt: r.respondedAt ?? new Date(),
    lastModifiedAt: r.updatedAt,
    isComplete: r.evidenceUrls.length > 0 || (r.notes?.length ?? 0) > 0,
    needsReview: false,
    question: {
      id: r.question.id,
      pqNumber: r.question.pqNumber ?? undefined,
      questionTextEn: r.question.questionTextEn,
      questionTextFr: r.question.questionTextFr,
      auditArea: r.question.auditArea ?? undefined,
      criticalElement: r.question.criticalElement ?? undefined,
      smsComponent: r.question.smsComponent ?? undefined,
      studyArea: r.question.studyArea ?? undefined,
      isPriorityPQ: r.question.isPriorityPQ,
      requiresOnSite: r.question.requiresOnSite,
      weight: r.question.weight,
    },
  }));
}

// =============================================================================
// INPUT SCHEMAS
// =============================================================================

const CreateAssessmentInput = z.object({
  // Either questionnaireId or questionnaireType must be provided
  questionnaireId: z.string().cuid().optional(),
  questionnaireType: z.nativeEnum(QuestionnaireType).optional(),
  assessmentType: z.nativeEnum(AssessmentType),
  title: z.string().min(3).max(200),
  description: z.string().max(2000).optional(),
  dueDate: z.date().optional(),
  scope: z.array(z.string()).optional(), // Audit areas or SMS components to include
}).refine(
  (data) => data.questionnaireId || data.questionnaireType,
  { message: "Either questionnaireId or questionnaireType must be provided" }
);

const AssessmentFilterInput = z.object({
  organizationId: z.string().cuid().optional(),
  questionnaireId: z.string().cuid().optional(),
  questionnaireType: z.nativeEnum(QuestionnaireType).optional(),
  type: z.nativeEnum(AssessmentType).optional(),
  status: z
    .union([z.nativeEnum(AssessmentStatus), z.array(z.nativeEnum(AssessmentStatus))])
    .optional(),
  search: z.string().max(100).optional(),
  page: z.number().int().positive().default(1),
  limit: z.number().int().min(1).max(100).default(20),
  sortBy: z.enum(["createdAt", "updatedAt", "status", "progress"]).default("updatedAt"),
  sortOrder: z.enum(["asc", "desc"]).default("desc"),
});

const SaveResponseInput = z.object({
  assessmentId: z.string().cuid(),
  questionId: z.string().cuid(),
  responseValue: z.string().optional().nullable(),
  maturityLevel: z.enum(["A", "B", "C", "D", "E"]).optional().nullable(),
  notes: z.string().max(2000).optional(),
  evidenceUrls: z.array(z.string().url()).optional(),
});

const BulkSaveResponsesInput = z.object({
  assessmentId: z.string().cuid(),
  responses: z.array(
    z.object({
      questionId: z.string().cuid(),
      responseValue: z.string().optional().nullable(),
      maturityLevel: z.enum(["A", "B", "C", "D", "E"]).optional().nullable(),
      notes: z.string().max(2000).optional(),
    })
  ).min(1).max(100),
});

const GetResponsesInput = z.object({
  assessmentId: z.string().cuid(),
  categoryId: z.string().optional(),
  auditArea: z.string().optional(),
  criticalElement: z.string().optional(),
  smsComponent: z.string().optional(),
  studyArea: z.string().optional(),
  onlyUnanswered: z.boolean().optional(),
  page: z.number().int().positive().default(1),
  limit: z.number().int().min(1).max(100).default(50),
});

const AddEvidenceInput = z.object({
  assessmentId: z.string().cuid(),
  questionId: z.string().cuid(),
  evidenceUrl: z.string().url(),
});

const ExportInput = z.object({
  assessmentId: z.string().cuid(),
  format: z.enum(["JSON", "CSV"]),
  includeEvidence: z.boolean().default(true),
  includeNotes: z.boolean().default(true),
});

// =============================================================================
// ASSESSMENT ROUTER
// =============================================================================

export const assessmentRouter = router({
  // ============================================
  // ASSESSMENT CRUD
  // ============================================

  /**
   * Create a new assessment
   */
  create: protectedProcedure
    .input(CreateAssessmentInput)
    .mutation(async ({ ctx, input }) => {
      const user = ctx.user;

      // User must belong to an organization
      if (!user.organizationId) {
        throw new TRPCError({
          code: "BAD_REQUEST",
          message: "You must belong to an organization to create assessments",
        });
      }

      // Check user has permission
      if (!ASSESSMENT_MANAGER_ROLES.includes(user.role)) {
        throw new TRPCError({
          code: "FORBIDDEN",
          message: "You do not have permission to create assessments",
        });
      }

      // Resolve questionnaire - either by ID or by type
      let questionnaire;
      if (input.questionnaireId) {
        questionnaire = await prisma.questionnaire.findUnique({
          where: { id: input.questionnaireId },
          include: {
            _count: { select: { questions: true } },
          },
        });
      } else if (input.questionnaireType) {
        // Find the active questionnaire of this type
        questionnaire = await prisma.questionnaire.findFirst({
          where: {
            type: input.questionnaireType,
            isActive: true,
          },
          orderBy: { version: "desc" },
          include: {
            _count: { select: { questions: true } },
          },
        });
      }

      if (!questionnaire) {
        throw new TRPCError({
          code: "NOT_FOUND",
          message: input.questionnaireType
            ? `No active questionnaire found for type ${input.questionnaireType}`
            : "Questionnaire not found",
        });
      }

      if (!questionnaire.isActive) {
        throw new TRPCError({
          code: "BAD_REQUEST",
          message: "Cannot create assessment for inactive questionnaire",
        });
      }

      // Check for existing active assessment of same type
      const existingAssessment = await prisma.assessment.findFirst({
        where: {
          organizationId: user.organizationId,
          questionnaireId: questionnaire.id,
          type: input.assessmentType,
          status: { notIn: ["COMPLETED", "ARCHIVED"] },
        },
      });

      if (existingAssessment) {
        throw new TRPCError({
          code: "CONFLICT",
          message: `An active ${input.assessmentType.toLowerCase().replace("_", " ")} already exists for this questionnaire. Please complete or archive it before creating a new one.`,
        });
      }

      // Build question filter based on scope
      const questionFilter: Prisma.QuestionWhereInput = {
        questionnaireId: questionnaire.id,
      };
      if (input.scope && input.scope.length > 0) {
        if (questionnaire.type === "ANS_USOAP_CMA") {
          questionFilter.auditArea = { in: input.scope as USOAPAuditArea[] };
        } else {
          questionFilter.smsComponent = { in: input.scope as SMSComponent[] };
        }
      }

      // Create assessment with empty responses for all questions
      const assessment = await prisma.$transaction(async (tx) => {
        // Create the assessment
        const newAssessment = await tx.assessment.create({
          data: {
            type: input.assessmentType,
            title: input.title,
            description: input.description,
            dueDate: input.dueDate,
            questionnaireId: questionnaire.id,
            organizationId: user.organizationId!,
            status: "DRAFT",
            progress: 0,
          },
          include: {
            questionnaire: true,
            organization: true,
          },
        });

        // Get questions for this questionnaire (filtered by scope if provided)
        const questions = await tx.question.findMany({
          where: questionFilter,
          select: { id: true },
        });

        // Create empty responses for all questions
        if (questions.length > 0) {
          await tx.assessmentResponse.createMany({
            data: questions.map((q) => ({
              assessmentId: newAssessment.id,
              questionId: q.id,
            })),
          });
        }

        return newAssessment;
      });

      // Log audit entry
      await logAuditEntry(user.id, "CREATE", "Assessment", assessment.id, {
        type: input.assessmentType,
        title: input.title,
        questionnaireId: questionnaire.id,
        questionnaireType: questionnaire.type,
        organizationId: user.organizationId,
        scope: input.scope,
      });

      console.log(
        `[Assessment] User ${user.id} created assessment ${assessment.id} for org ${user.organizationId}`
      );

      return assessment;
    }),

  /**
   * Get assessment by ID with full details
   */
  getById: protectedProcedure
    .input(z.object({ id: z.string().cuid() }))
    .query(async ({ ctx, input }) => {
      const { assessment, hasAccess, reason } = await checkAssessmentAccess(
        input.id,
        ctx.user.id,
        ctx.user.role,
        ctx.user.organizationId ?? null,
        false
      );

      if (!hasAccess || !assessment) {
        throw new TRPCError({
          code: assessment ? "FORBIDDEN" : "NOT_FOUND",
          message: reason || "Assessment not found",
        });
      }

      // Get full assessment with responses
      const fullAssessment = await prisma.assessment.findUnique({
        where: { id: input.id },
        include: {
          organization: {
            select: { id: true, nameEn: true, nameFr: true, icaoCode: true },
          },
          questionnaire: {
            select: {
              id: true,
              code: true,
              type: true,
              titleEn: true,
              titleFr: true,
              version: true,
            },
          },
          responses: {
            include: {
              question: {
                include: {
                  category: true,
                  icaoReferences: true,
                },
              },
              respondedBy: {
                select: { id: true, firstName: true, lastName: true },
              },
            },
            orderBy: { question: { sortOrder: "asc" } },
          },
          _count: {
            select: { responses: true },
          },
        },
      });

      if (!fullAssessment) {
        throw new TRPCError({
          code: "NOT_FOUND",
          message: "Assessment not found",
        });
      }

      // Calculate current progress
      const totalQuestions = fullAssessment._count.responses;
      const answeredQuestions = fullAssessment.responses.filter((r) => {
        if (fullAssessment.questionnaire.type === "ANS_USOAP_CMA") {
          return r.responseValue !== null;
        }
        return r.maturityLevel !== null;
      }).length;

      const progress =
        totalQuestions > 0
          ? Math.round((answeredQuestions / totalQuestions) * 100)
          : 0;

      return {
        ...fullAssessment,
        calculatedProgress: progress,
        totalQuestions,
        answeredQuestions,
      };
    }),

  /**
   * List assessments with filters
   */
  list: protectedProcedure
    .input(AssessmentFilterInput)
    .query(async ({ ctx, input }) => {
      const user = ctx.user;
      const { page, limit, sortBy, sortOrder, ...filters } = input;

      // Build where clause based on user role
      const where: Prisma.AssessmentWhereInput = {};

      // Apply organization filter based on role
      if (["SUPER_ADMIN", "SYSTEM_ADMIN", "PROGRAMME_COORDINATOR"].includes(user.role)) {
        // Admin can see all - apply optional filter
        if (filters.organizationId) {
          where.organizationId = filters.organizationId;
        }
      } else if (["STEERING_COMMITTEE"].includes(user.role)) {
        // Can only see completed assessments
        where.status = "COMPLETED";
        if (filters.organizationId) {
          where.organizationId = filters.organizationId;
        }
      } else if (["PEER_REVIEWER", "LEAD_REVIEWER"].includes(user.role)) {
        // Can see submitted+ assessments
        where.status = { in: ["SUBMITTED", "UNDER_REVIEW", "COMPLETED"] };
        if (filters.organizationId) {
          where.organizationId = filters.organizationId;
        }
      } else {
        // Regular users can only see their organization's assessments
        if (!user.organizationId) {
          return { assessments: [], total: 0, page, limit, totalPages: 0 };
        }
        where.organizationId = user.organizationId;
      }

      // Apply other filters
      if (filters.questionnaireId) {
        where.questionnaireId = filters.questionnaireId;
      }
      if (filters.type) {
        where.type = filters.type;
      }
      if (filters.status) {
        if (Array.isArray(filters.status)) {
          where.status = { in: filters.status };
        } else {
          where.status = filters.status;
        }
      }
      if (filters.questionnaireType) {
        where.questionnaire = { type: filters.questionnaireType };
      }

      // Get total count
      const total = await prisma.assessment.count({ where });

      // Get paginated assessments
      const assessments = await prisma.assessment.findMany({
        where,
        include: {
          organization: {
            select: { id: true, nameEn: true, nameFr: true, icaoCode: true },
          },
          questionnaire: {
            select: {
              id: true,
              code: true,
              type: true,
              titleEn: true,
              titleFr: true,
            },
          },
          _count: {
            select: { responses: true },
          },
        },
        orderBy: { [sortBy]: sortOrder },
        skip: (page - 1) * limit,
        take: limit,
      });

      return {
        assessments,
        total,
        page,
        limit,
        totalPages: Math.ceil(total / limit),
      };
    }),

  /**
   * Get assessments for current user's organization
   */
  getMyAssessments: protectedProcedure
    .input(
      z.object({
        status: z.nativeEnum(AssessmentStatus).optional(),
        questionnaireType: z.nativeEnum(QuestionnaireType).optional(),
      })
    )
    .query(async ({ ctx, input }) => {
      const user = ctx.user;

      if (!user.organizationId) {
        return [];
      }

      const where: Prisma.AssessmentWhereInput = {
        organizationId: user.organizationId,
      };

      if (input.status) {
        where.status = input.status;
      }
      if (input.questionnaireType) {
        where.questionnaire = { type: input.questionnaireType };
      }

      return prisma.assessment.findMany({
        where,
        include: {
          questionnaire: {
            select: {
              id: true,
              code: true,
              type: true,
              titleEn: true,
              titleFr: true,
            },
          },
          _count: {
            select: { responses: true },
          },
        },
        orderBy: { updatedAt: "desc" },
      });
    }),

  /**
   * Delete assessment (archive it)
   */
  delete: protectedProcedure
    .input(z.object({ id: z.string().cuid() }))
    .mutation(async ({ ctx, input }) => {
      const { assessment, hasAccess, reason } = await checkAssessmentAccess(
        input.id,
        ctx.user.id,
        ctx.user.role,
        ctx.user.organizationId ?? null,
        true
      );

      if (!hasAccess || !assessment) {
        throw new TRPCError({
          code: assessment ? "FORBIDDEN" : "NOT_FOUND",
          message: reason || "Assessment not found",
        });
      }

      // Only DRAFT assessments can be deleted (archived)
      if (assessment.status !== "DRAFT") {
        throw new TRPCError({
          code: "BAD_REQUEST",
          message: "Only draft assessments can be deleted. Submit the assessment for review instead.",
        });
      }

      const deleted = await prisma.assessment.update({
        where: { id: input.id },
        data: { status: "ARCHIVED" },
      });

      await logAuditEntry(ctx.user.id, "DELETE", "Assessment", input.id, {
        previousStatus: assessment.status,
      });

      console.log(
        `[Assessment] User ${ctx.user.id} archived assessment ${input.id}`
      );

      return deleted;
    }),

  // ============================================
  // STATUS TRANSITIONS
  // ============================================

  /**
   * Start assessment (set startedAt timestamp)
   */
  start: protectedProcedure
    .input(z.object({ id: z.string().cuid() }))
    .mutation(async ({ ctx, input }) => {
      const { assessment, hasAccess, reason } = await checkAssessmentAccess(
        input.id,
        ctx.user.id,
        ctx.user.role,
        ctx.user.organizationId ?? null,
        true
      );

      if (!hasAccess || !assessment) {
        throw new TRPCError({
          code: assessment ? "FORBIDDEN" : "NOT_FOUND",
          message: reason || "Assessment not found",
        });
      }

      if (assessment.status !== "DRAFT") {
        throw new TRPCError({
          code: "BAD_REQUEST",
          message: "Assessment has already been started",
        });
      }

      const updated = await prisma.assessment.update({
        where: { id: input.id },
        data: {
          startedAt: new Date(),
        },
        include: {
          questionnaire: true,
          organization: true,
        },
      });

      await logAuditEntry(ctx.user.id, "START", "Assessment", input.id, {
        startedAt: updated.startedAt?.toISOString(),
      });

      console.log(
        `[Assessment] User ${ctx.user.id} started assessment ${input.id}`
      );

      return updated;
    }),

  /**
   * Submit assessment for review (DRAFT -> SUBMITTED)
   */
  submit: protectedProcedure
    .input(
      z.object({
        id: z.string().cuid(),
        submissionNotes: z.string().max(2000).optional(),
      })
    )
    .mutation(async ({ ctx, input }) => {
      const { assessment, hasAccess, reason } = await checkAssessmentAccess(
        input.id,
        ctx.user.id,
        ctx.user.role,
        ctx.user.organizationId ?? null,
        true
      );

      if (!hasAccess || !assessment) {
        throw new TRPCError({
          code: assessment ? "FORBIDDEN" : "NOT_FOUND",
          message: reason || "Assessment not found",
        });
      }

      if (!STATUS_TRANSITIONS[assessment.status].includes("SUBMITTED")) {
        throw new TRPCError({
          code: "BAD_REQUEST",
          message: `Cannot submit assessment with status "${assessment.status}"`,
        });
      }

      // Get all responses with questions
      const responses = await prisma.assessmentResponse.findMany({
        where: { assessmentId: input.id },
        include: {
          question: true,
        },
      });

      const totalQuestions = responses.length;
      const questionnaireType = assessment.questionnaire.type;

      // Transform for validation
      const responsesForValidation = responses.map((r) => ({
        id: r.id,
        assessmentId: r.assessmentId,
        questionId: r.questionId,
        responseValue: r.responseValue as "SATISFACTORY" | "NOT_SATISFACTORY" | "NOT_APPLICABLE" | "NOT_REVIEWED" | null,
        maturityLevel: r.maturityLevel
          ? (MATURITY_LEVEL_REVERSE[r.maturityLevel] as "A" | "B" | "C" | "D" | "E")
          : null,
        score: r.score ?? undefined,
        evidenceDescription: r.notes ?? undefined,
        evidenceUrls: r.evidenceUrls,
        respondedById: r.respondedById ?? "",
        respondedAt: r.respondedAt ?? new Date(),
        lastModifiedAt: r.updatedAt,
        isComplete: false,
        needsReview: false,
      }));

      // Validate submission requirements
      const validation = validateAssessmentForSubmission(
        responsesForValidation,
        totalQuestions,
        questionnaireType
      );

      if (!validation.isValid) {
        throw new TRPCError({
          code: "BAD_REQUEST",
          message: `Assessment cannot be submitted:\n${validation.errors.join("\n")}`,
        });
      }

      // Calculate scores
      const responsesForScoring = transformResponsesForScoring(
        responses.map((r) => ({
          ...r,
          question: {
            id: r.question.id,
            pqNumber: r.question.pqNumber,
            questionTextEn: r.question.questionTextEn,
            questionTextFr: r.question.questionTextFr,
            auditArea: r.question.auditArea,
            criticalElement: r.question.criticalElement,
            smsComponent: r.question.smsComponent,
            studyArea: r.question.studyArea,
            isPriorityPQ: r.question.isPriorityPQ,
            requiresOnSite: r.question.requiresOnSite,
            weight: r.question.weight,
          },
        }))
      );

      let overallScore: number | undefined;
      let eiScore: number | undefined;
      let maturityLevel: MaturityLevel | undefined;
      let categoryScores: Record<string, number> = {};

      if (questionnaireType === "ANS_USOAP_CMA") {
        const eiResult = calculateEIScore(responsesForScoring);
        eiScore = eiResult.overallEI;
        overallScore = eiScore;
        categoryScores = calculateCategoryScores(responsesForScoring, questionnaireType);
      } else {
        const smsResult = calculateSMSMaturity(responsesForScoring);
        if (smsResult.overallLevel) {
          maturityLevel = MATURITY_LEVEL_MAP[smsResult.overallLevel];
        }
        overallScore = smsResult.overallPercentage;
        categoryScores = calculateCategoryScores(responsesForScoring, questionnaireType);
      }

      // Update assessment with scores and status
      const updated = await prisma.assessment.update({
        where: { id: input.id },
        data: {
          status: "SUBMITTED",
          submittedAt: new Date(),
          progress: 100,
          overallScore,
          eiScore,
          maturityLevel,
          categoryScores,
        },
        include: {
          organization: true,
          questionnaire: true,
        },
      });

      await logAuditEntry(ctx.user.id, "SUBMIT", "Assessment", input.id, {
        overallScore,
        eiScore,
        maturityLevel,
        submissionNotes: input.submissionNotes,
      });

      console.log(
        `[Assessment] User ${ctx.user.id} submitted assessment ${input.id} with score ${overallScore}`
      );

      return {
        assessment: updated,
        warnings: validation.warnings,
      };
    }),

  /**
   * Start review (SUBMITTED -> UNDER_REVIEW)
   */
  startReview: roleProcedure(
    "SUPER_ADMIN",
    "SYSTEM_ADMIN",
    "PROGRAMME_COORDINATOR",
    "LEAD_REVIEWER",
    "PEER_REVIEWER"
  )
    .input(z.object({ id: z.string().cuid() }))
    .mutation(async ({ ctx, input }) => {
      const assessment = await prisma.assessment.findUnique({
        where: { id: input.id },
      });

      if (!assessment) {
        throw new TRPCError({
          code: "NOT_FOUND",
          message: "Assessment not found",
        });
      }

      if (!STATUS_TRANSITIONS[assessment.status].includes("UNDER_REVIEW")) {
        throw new TRPCError({
          code: "BAD_REQUEST",
          message: `Cannot start review for assessment with status "${assessment.status}"`,
        });
      }

      const updated = await prisma.assessment.update({
        where: { id: input.id },
        data: { status: "UNDER_REVIEW" },
      });

      await logAuditEntry(ctx.user.id, "START_REVIEW", "Assessment", input.id);

      return updated;
    }),

  /**
   * Complete assessment (UNDER_REVIEW -> COMPLETED)
   */
  complete: roleProcedure(
    "SUPER_ADMIN",
    "SYSTEM_ADMIN",
    "PROGRAMME_COORDINATOR",
    "LEAD_REVIEWER"
  )
    .input(
      z.object({
        id: z.string().cuid(),
        completionNotes: z.string().max(2000).optional(),
      })
    )
    .mutation(async ({ ctx, input }) => {
      const assessment = await prisma.assessment.findUnique({
        where: { id: input.id },
        include: { questionnaire: true, organization: true },
      });

      if (!assessment) {
        throw new TRPCError({
          code: "NOT_FOUND",
          message: "Assessment not found",
        });
      }

      if (!STATUS_TRANSITIONS[assessment.status].includes("COMPLETED")) {
        throw new TRPCError({
          code: "BAD_REQUEST",
          message: `Cannot complete assessment with status "${assessment.status}". It must be under review first.`,
        });
      }

      const updated = await prisma.assessment.update({
        where: { id: input.id },
        data: {
          status: "COMPLETED",
          completedAt: new Date(),
        },
        include: {
          organization: true,
          questionnaire: true,
        },
      });

      await logAuditEntry(ctx.user.id, "COMPLETE", "Assessment", input.id, {
        completionNotes: input.completionNotes,
      });

      console.log(
        `[Assessment] User ${ctx.user.id} completed assessment ${input.id}`
      );

      return updated;
    }),

  /**
   * Reopen assessment (SUBMITTED -> DRAFT)
   */
  reopen: protectedProcedure
    .input(
      z.object({
        id: z.string().cuid(),
        reason: z.string().min(10).max(500),
      })
    )
    .mutation(async ({ ctx, input }) => {
      const { assessment, hasAccess, reason } = await checkAssessmentAccess(
        input.id,
        ctx.user.id,
        ctx.user.role,
        ctx.user.organizationId ?? null,
        true
      );

      if (!hasAccess || !assessment) {
        throw new TRPCError({
          code: assessment ? "FORBIDDEN" : "NOT_FOUND",
          message: reason || "Assessment not found",
        });
      }

      if (!STATUS_TRANSITIONS[assessment.status].includes("DRAFT")) {
        throw new TRPCError({
          code: "BAD_REQUEST",
          message: `Cannot reopen assessment with status "${assessment.status}"`,
        });
      }

      const updated = await prisma.assessment.update({
        where: { id: input.id },
        data: {
          status: "DRAFT",
          submittedAt: null,
        },
        include: {
          organization: true,
          questionnaire: true,
        },
      });

      await logAuditEntry(ctx.user.id, "REOPEN", "Assessment", input.id, {
        reason: input.reason,
        previousStatus: assessment.status,
      });

      console.log(
        `[Assessment] User ${ctx.user.id} reopened assessment ${input.id}: ${input.reason}`
      );

      return updated;
    }),

  // ============================================
  // RESPONSES
  // ============================================

  /**
   * Save single response
   */
  saveResponse: protectedProcedure
    .input(SaveResponseInput)
    .mutation(async ({ ctx, input }) => {
      const { assessment, hasAccess, reason } = await checkAssessmentAccess(
        input.assessmentId,
        ctx.user.id,
        ctx.user.role,
        ctx.user.organizationId ?? null,
        true
      );

      if (!hasAccess || !assessment) {
        throw new TRPCError({
          code: assessment ? "FORBIDDEN" : "NOT_FOUND",
          message: reason || "Assessment not found",
        });
      }

      // Can only edit DRAFT assessments
      if (assessment.status !== "DRAFT") {
        throw new TRPCError({
          code: "BAD_REQUEST",
          message: "Assessment is not editable. Only draft assessments can be modified.",
        });
      }

      // Verify question belongs to this questionnaire
      const question = await prisma.question.findFirst({
        where: {
          id: input.questionId,
          questionnaireId: assessment.questionnaireId,
        },
      });

      if (!question) {
        throw new TRPCError({
          code: "NOT_FOUND",
          message: "Question not found in this questionnaire",
        });
      }

      // Build update data based on questionnaire type
      const updateData: Prisma.AssessmentResponseUpdateInput = {
        respondedBy: { connect: { id: ctx.user.id } },
        respondedAt: new Date(),
      };

      if (assessment.questionnaire.type === "ANS_USOAP_CMA") {
        updateData.responseValue = input.responseValue;
        updateData.maturityLevel = null;
      } else {
        updateData.maturityLevel = input.maturityLevel
          ? MATURITY_LEVEL_MAP[input.maturityLevel]
          : null;
        updateData.responseValue = null;

        // Calculate score for maturity level
        if (input.maturityLevel) {
          updateData.score = maturityLevelToScore(input.maturityLevel);
        }
      }

      if (input.notes !== undefined) {
        updateData.notes = input.notes;
      }
      if (input.evidenceUrls !== undefined) {
        updateData.evidenceUrls = input.evidenceUrls;
      }

      // Upsert response
      const response = await prisma.assessmentResponse.upsert({
        where: {
          assessmentId_questionId: {
            assessmentId: input.assessmentId,
            questionId: input.questionId,
          },
        },
        update: updateData,
        create: {
          assessment: { connect: { id: input.assessmentId } },
          question: { connect: { id: input.questionId } },
          responseValue: assessment.questionnaire.type === "ANS_USOAP_CMA" ? input.responseValue : null,
          maturityLevel: assessment.questionnaire.type === "SMS_CANSO_SOE" && input.maturityLevel
            ? MATURITY_LEVEL_MAP[input.maturityLevel]
            : null,
          score: input.maturityLevel ? maturityLevelToScore(input.maturityLevel) : null,
          notes: input.notes,
          evidenceUrls: input.evidenceUrls || [],
          respondedBy: { connect: { id: ctx.user.id } },
          respondedAt: new Date(),
        },
        include: {
          question: {
            include: { category: true },
          },
        },
      });

      // Update assessment progress
      const allResponses = await prisma.assessmentResponse.findMany({
        where: { assessmentId: input.assessmentId },
      });

      const totalQuestions = allResponses.length;
      const answeredQuestions = allResponses.filter((r) => {
        if (assessment.questionnaire.type === "ANS_USOAP_CMA") {
          return r.responseValue !== null;
        }
        return r.maturityLevel !== null;
      }).length;

      const progress =
        totalQuestions > 0
          ? Math.round((answeredQuestions / totalQuestions) * 100)
          : 0;

      await prisma.assessment.update({
        where: { id: input.assessmentId },
        data: { progress },
      });

      return {
        response,
        progress,
        answeredQuestions,
        totalQuestions,
      };
    }),

  /**
   * Save multiple responses (bulk update)
   */
  saveResponses: protectedProcedure
    .input(BulkSaveResponsesInput)
    .mutation(async ({ ctx, input }) => {
      const { assessment, hasAccess, reason } = await checkAssessmentAccess(
        input.assessmentId,
        ctx.user.id,
        ctx.user.role,
        ctx.user.organizationId ?? null,
        true
      );

      if (!hasAccess || !assessment) {
        throw new TRPCError({
          code: assessment ? "FORBIDDEN" : "NOT_FOUND",
          message: reason || "Assessment not found",
        });
      }

      if (assessment.status !== "DRAFT") {
        throw new TRPCError({
          code: "BAD_REQUEST",
          message: "Assessment is not editable",
        });
      }

      const questionnaireType = assessment.questionnaire.type;

      // Process all responses in a transaction
      const results = await prisma.$transaction(async (tx) => {
        const updatedResponses = [];

        for (const response of input.responses) {
          const updateData: Prisma.AssessmentResponseUpdateInput = {
            respondedBy: { connect: { id: ctx.user.id } },
            respondedAt: new Date(),
          };

          if (questionnaireType === "ANS_USOAP_CMA") {
            updateData.responseValue = response.responseValue;
          } else {
            updateData.maturityLevel = response.maturityLevel
              ? MATURITY_LEVEL_MAP[response.maturityLevel]
              : null;
            if (response.maturityLevel) {
              updateData.score = maturityLevelToScore(response.maturityLevel);
            }
          }

          if (response.notes !== undefined) {
            updateData.notes = response.notes;
          }

          const updated = await tx.assessmentResponse.upsert({
            where: {
              assessmentId_questionId: {
                assessmentId: input.assessmentId,
                questionId: response.questionId,
              },
            },
            update: updateData,
            create: {
              assessment: { connect: { id: input.assessmentId } },
              question: { connect: { id: response.questionId } },
              responseValue: questionnaireType === "ANS_USOAP_CMA" ? response.responseValue : null,
              maturityLevel: questionnaireType === "SMS_CANSO_SOE" && response.maturityLevel
                ? MATURITY_LEVEL_MAP[response.maturityLevel]
                : null,
              score: response.maturityLevel ? maturityLevelToScore(response.maturityLevel) : null,
              notes: response.notes,
              respondedBy: { connect: { id: ctx.user.id } },
              respondedAt: new Date(),
            },
          });

          updatedResponses.push(updated);
        }

        return updatedResponses;
      });

      // Update assessment progress
      const allResponses = await prisma.assessmentResponse.findMany({
        where: { assessmentId: input.assessmentId },
      });

      const totalQuestions = allResponses.length;
      const answeredQuestions = allResponses.filter((r) => {
        if (questionnaireType === "ANS_USOAP_CMA") {
          return r.responseValue !== null;
        }
        return r.maturityLevel !== null;
      }).length;

      const progress =
        totalQuestions > 0
          ? Math.round((answeredQuestions / totalQuestions) * 100)
          : 0;

      await prisma.assessment.update({
        where: { id: input.assessmentId },
        data: { progress },
      });

      await logAuditEntry(ctx.user.id, "BULK_UPDATE", "Assessment", input.assessmentId, {
        responseCount: results.length,
      });

      return {
        updatedCount: results.length,
        progress,
        answeredQuestions,
        totalQuestions,
      };
    }),

  /**
   * Get responses for assessment
   */
  getResponses: protectedProcedure
    .input(GetResponsesInput)
    .query(async ({ ctx, input }) => {
      const { assessment, hasAccess, reason } = await checkAssessmentAccess(
        input.assessmentId,
        ctx.user.id,
        ctx.user.role,
        ctx.user.organizationId ?? null,
        false
      );

      if (!hasAccess || !assessment) {
        throw new TRPCError({
          code: assessment ? "FORBIDDEN" : "NOT_FOUND",
          message: reason || "Assessment not found",
        });
      }

      // Build filter
      const where: Prisma.AssessmentResponseWhereInput = {
        assessmentId: input.assessmentId,
      };

      // Add question filters
      const questionWhere: Prisma.QuestionWhereInput = {};

      if (input.categoryId) {
        questionWhere.categoryId = input.categoryId;
      }
      if (input.auditArea) {
        questionWhere.auditArea = input.auditArea as USOAPAuditArea;
      }
      if (input.criticalElement) {
        questionWhere.criticalElement = input.criticalElement as CriticalElement;
      }
      if (input.smsComponent) {
        questionWhere.smsComponent = input.smsComponent as SMSComponent;
      }
      if (input.studyArea) {
        questionWhere.studyArea = input.studyArea as CANSOStudyArea;
      }

      if (Object.keys(questionWhere).length > 0) {
        where.question = questionWhere;
      }

      // Filter for unanswered only
      if (input.onlyUnanswered) {
        if (assessment.questionnaire.type === "ANS_USOAP_CMA") {
          where.responseValue = null;
        } else {
          where.maturityLevel = null;
        }
      }

      const total = await prisma.assessmentResponse.count({ where });

      const responses = await prisma.assessmentResponse.findMany({
        where,
        include: {
          question: {
            include: {
              category: true,
              icaoReferences: true,
            },
          },
          respondedBy: {
            select: { id: true, firstName: true, lastName: true },
          },
        },
        orderBy: { question: { sortOrder: "asc" } },
        skip: (input.page - 1) * input.limit,
        take: input.limit,
      });

      return {
        responses,
        total,
        page: input.page,
        limit: input.limit,
        totalPages: Math.ceil(total / input.limit),
      };
    }),

  /**
   * Clear response (reset to unanswered)
   */
  clearResponse: protectedProcedure
    .input(
      z.object({
        assessmentId: z.string().cuid(),
        questionId: z.string().cuid(),
      })
    )
    .mutation(async ({ ctx, input }) => {
      const { assessment, hasAccess, reason } = await checkAssessmentAccess(
        input.assessmentId,
        ctx.user.id,
        ctx.user.role,
        ctx.user.organizationId ?? null,
        true
      );

      if (!hasAccess || !assessment) {
        throw new TRPCError({
          code: assessment ? "FORBIDDEN" : "NOT_FOUND",
          message: reason || "Assessment not found",
        });
      }

      if (assessment.status !== "DRAFT") {
        throw new TRPCError({
          code: "BAD_REQUEST",
          message: "Assessment is not editable",
        });
      }

      const response = await prisma.assessmentResponse.update({
        where: {
          assessmentId_questionId: {
            assessmentId: input.assessmentId,
            questionId: input.questionId,
          },
        },
        data: {
          responseValue: null,
          maturityLevel: null,
          score: null,
          notes: null,
          evidenceUrls: [],
          respondedById: null,
          respondedAt: null,
        },
      });

      // Update progress
      const allResponses = await prisma.assessmentResponse.findMany({
        where: { assessmentId: input.assessmentId },
      });

      const totalQuestions = allResponses.length;
      const answeredQuestions = allResponses.filter((r) => {
        if (assessment.questionnaire.type === "ANS_USOAP_CMA") {
          return r.responseValue !== null;
        }
        return r.maturityLevel !== null;
      }).length;

      const progress =
        totalQuestions > 0
          ? Math.round((answeredQuestions / totalQuestions) * 100)
          : 0;

      await prisma.assessment.update({
        where: { id: input.assessmentId },
        data: { progress },
      });

      return { response, progress };
    }),

  // ============================================
  // EVIDENCE
  // ============================================

  /**
   * Add evidence URL to response
   */
  addEvidence: protectedProcedure
    .input(AddEvidenceInput)
    .mutation(async ({ ctx, input }) => {
      const { assessment, hasAccess, reason } = await checkAssessmentAccess(
        input.assessmentId,
        ctx.user.id,
        ctx.user.role,
        ctx.user.organizationId ?? null,
        true
      );

      if (!hasAccess || !assessment) {
        throw new TRPCError({
          code: assessment ? "FORBIDDEN" : "NOT_FOUND",
          message: reason || "Assessment not found",
        });
      }

      if (assessment.status !== "DRAFT") {
        throw new TRPCError({
          code: "BAD_REQUEST",
          message: "Assessment is not editable",
        });
      }

      // Get current response
      const response = await prisma.assessmentResponse.findUnique({
        where: {
          assessmentId_questionId: {
            assessmentId: input.assessmentId,
            questionId: input.questionId,
          },
        },
      });

      if (!response) {
        throw new TRPCError({
          code: "NOT_FOUND",
          message: "Response not found",
        });
      }

      // Add URL to evidence array
      const updatedResponse = await prisma.assessmentResponse.update({
        where: { id: response.id },
        data: {
          evidenceUrls: {
            push: input.evidenceUrl,
          },
        },
        include: {
          question: true,
        },
      });

      await logAuditEntry(ctx.user.id, "ADD_EVIDENCE", "AssessmentResponse", response.id, {
        evidenceUrl: input.evidenceUrl,
      });

      return updatedResponse;
    }),

  /**
   * Remove evidence URL from response
   */
  removeEvidence: protectedProcedure
    .input(
      z.object({
        assessmentId: z.string().cuid(),
        questionId: z.string().cuid(),
        evidenceUrl: z.string().url(),
      })
    )
    .mutation(async ({ ctx, input }) => {
      const { assessment, hasAccess, reason } = await checkAssessmentAccess(
        input.assessmentId,
        ctx.user.id,
        ctx.user.role,
        ctx.user.organizationId ?? null,
        true
      );

      if (!hasAccess || !assessment) {
        throw new TRPCError({
          code: assessment ? "FORBIDDEN" : "NOT_FOUND",
          message: reason || "Assessment not found",
        });
      }

      if (assessment.status !== "DRAFT") {
        throw new TRPCError({
          code: "BAD_REQUEST",
          message: "Assessment is not editable",
        });
      }

      const response = await prisma.assessmentResponse.findUnique({
        where: {
          assessmentId_questionId: {
            assessmentId: input.assessmentId,
            questionId: input.questionId,
          },
        },
      });

      if (!response) {
        throw new TRPCError({
          code: "NOT_FOUND",
          message: "Response not found",
        });
      }

      // Remove URL from evidence array
      const updatedUrls = response.evidenceUrls.filter(
        (url) => url !== input.evidenceUrl
      );

      const updatedResponse = await prisma.assessmentResponse.update({
        where: { id: response.id },
        data: {
          evidenceUrls: updatedUrls,
        },
      });

      await logAuditEntry(ctx.user.id, "REMOVE_EVIDENCE", "AssessmentResponse", response.id, {
        removedUrl: input.evidenceUrl,
      });

      return updatedResponse;
    }),

  // ============================================
  // SCORING & PROGRESS
  // ============================================

  /**
   * Calculate current scores
   */
  calculateScores: protectedProcedure
    .input(z.object({ assessmentId: z.string().cuid() }))
    .query(async ({ ctx, input }) => {
      const { assessment, hasAccess, reason } = await checkAssessmentAccess(
        input.assessmentId,
        ctx.user.id,
        ctx.user.role,
        ctx.user.organizationId ?? null,
        false
      );

      if (!hasAccess || !assessment) {
        throw new TRPCError({
          code: assessment ? "FORBIDDEN" : "NOT_FOUND",
          message: reason || "Assessment not found",
        });
      }

      // Get all responses with questions
      const responses = await prisma.assessmentResponse.findMany({
        where: { assessmentId: input.assessmentId },
        include: { question: true },
      });

      const questionnaireType = assessment.questionnaire.type;

      // Transform responses for scoring functions
      const responsesForScoring = transformResponsesForScoring(
        responses.map((r) => ({
          ...r,
          question: {
            id: r.question.id,
            pqNumber: r.question.pqNumber,
            questionTextEn: r.question.questionTextEn,
            questionTextFr: r.question.questionTextFr,
            auditArea: r.question.auditArea,
            criticalElement: r.question.criticalElement,
            smsComponent: r.question.smsComponent,
            studyArea: r.question.studyArea,
            isPriorityPQ: r.question.isPriorityPQ,
            requiresOnSite: r.question.requiresOnSite,
            weight: r.question.weight,
          },
        }))
      );

      if (questionnaireType === "ANS_USOAP_CMA") {
        const eiResult = calculateEIScore(responsesForScoring);
        const categoryScores = calculateCategoryScores(responsesForScoring, questionnaireType);

        return {
          type: "ANS" as const,
          eiScore: eiResult,
          categoryScores,
          overallScore: eiResult.overallEI,
        };
      } else {
        const smsResult = calculateSMSMaturity(responsesForScoring);
        const categoryScores = calculateCategoryScores(responsesForScoring, questionnaireType);

        return {
          type: "SMS" as const,
          smsMaturity: smsResult,
          categoryScores,
          overallScore: smsResult.overallPercentage,
          overallLevel: smsResult.overallLevel,
        };
      }
    }),

  /**
   * Get detailed progress
   */
  getProgress: protectedProcedure
    .input(z.object({ assessmentId: z.string().cuid() }))
    .query(async ({ ctx, input }) => {
      const { assessment, hasAccess, reason } = await checkAssessmentAccess(
        input.assessmentId,
        ctx.user.id,
        ctx.user.role,
        ctx.user.organizationId ?? null,
        false
      );

      if (!hasAccess || !assessment) {
        throw new TRPCError({
          code: assessment ? "FORBIDDEN" : "NOT_FOUND",
          message: reason || "Assessment not found",
        });
      }

      // Get all responses with questions
      const responses = await prisma.assessmentResponse.findMany({
        where: { assessmentId: input.assessmentId },
        include: { question: true },
      });

      const questionnaireType = assessment.questionnaire.type;
      const totalQuestions = responses.length;

      // Transform for progress calculation
      const responsesForProgress = transformResponsesForScoring(
        responses.map((r) => ({
          ...r,
          question: {
            id: r.question.id,
            pqNumber: r.question.pqNumber,
            questionTextEn: r.question.questionTextEn,
            questionTextFr: r.question.questionTextFr,
            auditArea: r.question.auditArea,
            criticalElement: r.question.criticalElement,
            smsComponent: r.question.smsComponent,
            studyArea: r.question.studyArea,
            isPriorityPQ: r.question.isPriorityPQ,
            requiresOnSite: r.question.requiresOnSite,
            weight: r.question.weight,
          },
        }))
      );

      const progress = calculateProgress(
        responsesForProgress,
        totalQuestions,
        questionnaireType
      );

      return progress;
    }),

  /**
   * Get assessment summary for dashboard
   */
  getSummary: protectedProcedure
    .input(z.object({ assessmentId: z.string().cuid() }))
    .query(async ({ ctx, input }) => {
      const { assessment, hasAccess, reason } = await checkAssessmentAccess(
        input.assessmentId,
        ctx.user.id,
        ctx.user.role,
        ctx.user.organizationId ?? null,
        false
      );

      if (!hasAccess || !assessment) {
        throw new TRPCError({
          code: assessment ? "FORBIDDEN" : "NOT_FOUND",
          message: reason || "Assessment not found",
        });
      }

      // Get response counts by status
      const responses = await prisma.assessmentResponse.findMany({
        where: { assessmentId: input.assessmentId },
        include: { question: true },
      });

      const questionnaireType = assessment.questionnaire.type;
      const totalQuestions = responses.length;

      let answeredCount = 0;
      let satisfactoryCount = 0;
      let notSatisfactoryCount = 0;
      let notApplicableCount = 0;
      let withEvidenceCount = 0;

      const maturityCounts: Record<string, number> = {
        A: 0, B: 0, C: 0, D: 0, E: 0,
      };

      for (const r of responses) {
        const hasEvidence = r.evidenceUrls.length > 0 || (r.notes?.length ?? 0) > 0;
        if (hasEvidence) withEvidenceCount++;

        if (questionnaireType === "ANS_USOAP_CMA") {
          if (r.responseValue) {
            answeredCount++;
            switch (r.responseValue) {
              case "SATISFACTORY":
                satisfactoryCount++;
                break;
              case "NOT_SATISFACTORY":
                notSatisfactoryCount++;
                break;
              case "NOT_APPLICABLE":
                notApplicableCount++;
                break;
            }
          }
        } else {
          if (r.maturityLevel) {
            answeredCount++;
            const level = MATURITY_LEVEL_REVERSE[r.maturityLevel];
            maturityCounts[level]++;
          }
        }
      }

      // Calculate key metrics
      const progressPercent = totalQuestions > 0
        ? Math.round((answeredCount / totalQuestions) * 100)
        : 0;

      const evidencePercent = totalQuestions > 0
        ? Math.round((withEvidenceCount / totalQuestions) * 100)
        : 0;

      // Calculate score preview
      let scorePreview: number | null = null;
      let levelPreview: string | null = null;

      if (questionnaireType === "ANS_USOAP_CMA") {
        const applicable = satisfactoryCount + notSatisfactoryCount;
        scorePreview = applicable > 0
          ? Math.round((satisfactoryCount / applicable) * 100)
          : null;
      } else {
        if (answeredCount > 0) {
          const totalScore = Object.entries(maturityCounts)
            .reduce((sum, [level, count]) => {
              const scores: Record<string, number> = { A: 1, B: 2, C: 3, D: 4, E: 5 };
              return sum + (scores[level] * count);
            }, 0);
          const avgScore = totalScore / answeredCount;
          scorePreview = Math.round((avgScore / 5) * 100);

          // Determine level
          if (avgScore >= 4.5) levelPreview = "E";
          else if (avgScore >= 3.5) levelPreview = "D";
          else if (avgScore >= 2.5) levelPreview = "C";
          else if (avgScore >= 1.5) levelPreview = "B";
          else levelPreview = "A";
        }
      }

      // Determine next steps
      const nextSteps: string[] = [];
      if (progressPercent < 100) {
        nextSteps.push(`Complete remaining ${totalQuestions - answeredCount} questions`);
      }
      if (evidencePercent < 80) {
        nextSteps.push(`Add evidence to improve documentation (currently ${evidencePercent}%)`);
      }
      if (progressPercent === 100 && assessment.status === "DRAFT") {
        nextSteps.push("Ready to submit for review");
      }

      return {
        assessment: {
          id: assessment.id,
          status: assessment.status,
          type: assessment.type,
          progress: assessment.progress,
          startedAt: assessment.startedAt,
          submittedAt: assessment.submittedAt,
          completedAt: assessment.completedAt,
        },
        questionnaire: {
          id: assessment.questionnaire.id,
          code: assessment.questionnaire.code,
          type: questionnaireType,
        },
        stats: {
          totalQuestions,
          answeredQuestions: answeredCount,
          progressPercent,
          evidencePercent,
          ...(questionnaireType === "ANS_USOAP_CMA"
            ? {
                satisfactoryCount,
                notSatisfactoryCount,
                notApplicableCount,
              }
            : {
                maturityDistribution: maturityCounts,
              }),
        },
        scorePreview,
        levelPreview,
        nextSteps,
      };
    }),

  // ============================================
  // EXPORT & REPORTING
  // ============================================

  /**
   * Export assessment data
   */
  export: protectedProcedure
    .input(ExportInput)
    .mutation(async ({ ctx, input }) => {
      const { assessment, hasAccess, reason } = await checkAssessmentAccess(
        input.assessmentId,
        ctx.user.id,
        ctx.user.role,
        ctx.user.organizationId ?? null,
        false
      );

      if (!hasAccess || !assessment) {
        throw new TRPCError({
          code: assessment ? "FORBIDDEN" : "NOT_FOUND",
          message: reason || "Assessment not found",
        });
      }

      // Get full assessment data
      const fullAssessment = await prisma.assessment.findUnique({
        where: { id: input.assessmentId },
        include: {
          organization: true,
          questionnaire: true,
          responses: {
            include: {
              question: {
                include: { category: true },
              },
              respondedBy: {
                select: { firstName: true, lastName: true },
              },
            },
            orderBy: { question: { sortOrder: "asc" } },
          },
        },
      });

      if (!fullAssessment) {
        throw new TRPCError({
          code: "NOT_FOUND",
          message: "Assessment not found",
        });
      }

      await logAuditEntry(ctx.user.id, "EXPORT", "Assessment", input.assessmentId, {
        format: input.format,
      });

      if (input.format === "JSON") {
        return {
          format: "JSON" as const,
          data: fullAssessment,
          filename: `assessment-${fullAssessment.id}-${new Date().toISOString().split("T")[0]}.json`,
        };
      }

      // CSV format
      const headers = [
        "Question ID",
        "PQ Number",
        "Category",
        "Question (EN)",
        "Response",
        ...(input.includeNotes ? ["Notes"] : []),
        ...(input.includeEvidence ? ["Evidence URLs"] : []),
        "Responded By",
        "Responded At",
      ];

      const rows = fullAssessment.responses.map((r) => {
        const responseValue = assessment.questionnaire.type === "ANS_USOAP_CMA"
          ? r.responseValue
          : r.maturityLevel
            ? MATURITY_LEVEL_REVERSE[r.maturityLevel]
            : "";

        return [
          r.questionId,
          r.question.pqNumber || "",
          r.question.category?.nameEn || "",
          r.question.questionTextEn.substring(0, 200),
          responseValue || "",
          ...(input.includeNotes ? [r.notes || ""] : []),
          ...(input.includeEvidence ? [r.evidenceUrls.join("; ")] : []),
          r.respondedBy ? `${r.respondedBy.firstName} ${r.respondedBy.lastName}` : "",
          r.respondedAt ? r.respondedAt.toISOString() : "",
        ];
      });

      const csvContent = [
        headers.join(","),
        ...rows.map((row) =>
          row.map((cell) => `"${String(cell).replace(/"/g, '""')}"`).join(",")
        ),
      ].join("\n");

      return {
        format: "CSV" as const,
        data: csvContent,
        filename: `assessment-${fullAssessment.id}-${new Date().toISOString().split("T")[0]}.csv`,
      };
    }),

  /**
   * Get report data for PDF generation
   */
  getReportData: protectedProcedure
    .input(z.object({ assessmentId: z.string().cuid() }))
    .query(async ({ ctx, input }) => {
      const { assessment, hasAccess, reason } = await checkAssessmentAccess(
        input.assessmentId,
        ctx.user.id,
        ctx.user.role,
        ctx.user.organizationId ?? null,
        false
      );

      if (!hasAccess || !assessment) {
        throw new TRPCError({
          code: assessment ? "FORBIDDEN" : "NOT_FOUND",
          message: reason || "Assessment not found",
        });
      }

      // Get full assessment with all data
      const fullAssessment = await prisma.assessment.findUnique({
        where: { id: input.assessmentId },
        include: {
          organization: true,
          questionnaire: true,
          responses: {
            include: {
              question: {
                include: {
                  category: true,
                  icaoReferences: true,
                },
              },
            },
            orderBy: { question: { sortOrder: "asc" } },
          },
        },
      });

      if (!fullAssessment) {
        throw new TRPCError({
          code: "NOT_FOUND",
          message: "Assessment not found",
        });
      }

      // Transform responses for scoring
      const questionnaireType = fullAssessment.questionnaire.type;
      const responsesForScoring = transformResponsesForScoring(
        fullAssessment.responses.map((r) => ({
          ...r,
          question: {
            id: r.question.id,
            pqNumber: r.question.pqNumber,
            questionTextEn: r.question.questionTextEn,
            questionTextFr: r.question.questionTextFr,
            auditArea: r.question.auditArea,
            criticalElement: r.question.criticalElement,
            smsComponent: r.question.smsComponent,
            studyArea: r.question.studyArea,
            isPriorityPQ: r.question.isPriorityPQ,
            requiresOnSite: r.question.requiresOnSite,
            weight: r.question.weight,
          },
        }))
      );

      // Calculate scores
      let scores;
      if (questionnaireType === "ANS_USOAP_CMA") {
        scores = calculateEIScore(responsesForScoring);
      } else {
        scores = calculateSMSMaturity(responsesForScoring);
      }

      const categoryScores = calculateCategoryScores(responsesForScoring, questionnaireType);

      // Group responses by category for the report
      const responsesByCategory: Record<string, typeof fullAssessment.responses> = {};
      for (const response of fullAssessment.responses) {
        const categoryId = response.question.category?.id || "uncategorized";
        if (!responsesByCategory[categoryId]) {
          responsesByCategory[categoryId] = [];
        }
        responsesByCategory[categoryId].push(response);
      }

      return {
        assessment: fullAssessment,
        scores,
        categoryScores,
        responsesByCategory,
        generatedAt: new Date(),
      };
    }),

  // ============================================
  // DASHBOARD STATS
  // ============================================

  /**
   * Get organization assessment statistics
   */
  getOrgStats: protectedProcedure.query(async ({ ctx }) => {
    const user = ctx.user;

    if (!user.organizationId) {
      return null;
    }

    const assessments = await prisma.assessment.findMany({
      where: { organizationId: user.organizationId },
      include: {
        questionnaire: {
          select: { type: true },
        },
      },
    });

    const stats = {
      total: assessments.length,
      byStatus: {
        DRAFT: 0,
        SUBMITTED: 0,
        UNDER_REVIEW: 0,
        COMPLETED: 0,
        ARCHIVED: 0,
      } as Record<AssessmentStatus, number>,
      byType: {
        ANS_USOAP_CMA: 0,
        SMS_CANSO_SOE: 0,
      } as Record<QuestionnaireType, number>,
      averageProgress: 0,
      averageScore: null as number | null,
    };

    let totalProgress = 0;
    let scoreSum = 0;
    let scoreCount = 0;

    for (const assessment of assessments) {
      stats.byStatus[assessment.status]++;
      stats.byType[assessment.questionnaire.type]++;
      totalProgress += assessment.progress;

      if (assessment.overallScore !== null) {
        scoreSum += assessment.overallScore;
        scoreCount++;
      }
    }

    stats.averageProgress = assessments.length > 0
      ? Math.round(totalProgress / assessments.length)
      : 0;

    stats.averageScore = scoreCount > 0
      ? Math.round((scoreSum / scoreCount) * 10) / 10
      : null;

    return stats;
  }),
});

export type AssessmentRouter = typeof assessmentRouter;

```

# src/server/trpc/routers/document.ts

```ts
/**
 * Document Router
 *
 * tRPC procedures for document and evidence management.
 * Handles document CRUD operations and linking to assessment responses.
 */

import { z } from "zod";
import { TRPCError } from "@trpc/server";
import { router, protectedProcedure } from "../trpc";
import { documentService } from "@/server/services/document.service";
import { prisma } from "@/lib/db";

// =============================================================================
// INPUT SCHEMAS
// =============================================================================

const CreateDocumentInput = z.object({
  name: z.string().min(1).max(255),
  originalName: z.string().optional(),
  description: z.string().max(1000).optional(),
  fileUrl: z.string().min(1).refine((val) => val.startsWith("/") || val.startsWith("http"), { message: "Must be a valid URL or path" }),
  fileType: z.string(),
  fileSize: z.number().min(0),
  category: z
    .enum([
      "POLICY",
      "PROCEDURE",
      "RECORD",
      "CERTIFICATE",
      "REPORT",
      "TRAINING",
      "EVIDENCE",
      "OTHER",
    ])
    .optional(),
  tags: z.array(z.string()).optional(),
  language: z.enum(["EN", "FR"]).optional(),
  organizationId: z.string().cuid().optional(),
  assessmentId: z.string().cuid().optional(),
});

const CreateUrlReferenceInput = z.object({
  url: z.string().url(),
  name: z.string().min(1).max(255),
  description: z.string().max(1000).optional(),
  category: z
    .enum([
      "POLICY",
      "PROCEDURE",
      "RECORD",
      "CERTIFICATE",
      "REPORT",
      "TRAINING",
      "EVIDENCE",
      "OTHER",
    ])
    .optional(),
  organizationId: z.string().cuid().optional(),
  assessmentId: z.string().cuid().optional(),
});

const LinkToResponseInput = z.object({
  documentId: z.string().cuid(),
  responseId: z.string().cuid(),
  notes: z.string().max(500).optional(),
});

const UnlinkFromResponseInput = z.object({
  documentId: z.string().cuid(),
  responseId: z.string().cuid(),
});

const GetByAssessmentInput = z.object({
  assessmentId: z.string().cuid(),
});

const GetByResponseInput = z.object({
  responseId: z.string().cuid(),
});

const GetByOrganizationInput = z.object({
  organizationId: z.string().cuid(),
  category: z
    .enum([
      "POLICY",
      "PROCEDURE",
      "RECORD",
      "CERTIFICATE",
      "REPORT",
      "TRAINING",
      "EVIDENCE",
      "OTHER",
    ])
    .optional(),
  assessmentId: z.string().cuid().optional(),
  tags: z.array(z.string()).optional(),
  search: z.string().optional(),
});

const UpdateDocumentInput = z.object({
  documentId: z.string().cuid(),
  name: z.string().min(1).max(255).optional(),
  description: z.string().max(1000).optional(),
  category: z
    .enum([
      "POLICY",
      "PROCEDURE",
      "RECORD",
      "CERTIFICATE",
      "REPORT",
      "TRAINING",
      "EVIDENCE",
      "OTHER",
    ])
    .optional(),
  tags: z.array(z.string()).optional(),
  language: z.enum(["EN", "FR"]).optional(),
});

const DeleteDocumentInput = z.object({
  documentId: z.string().cuid(),
});

const GetDocumentInput = z.object({
  documentId: z.string().cuid(),
});

// =============================================================================
// DOCUMENT ROUTER
// =============================================================================

export const documentRouter = router({
  /**
   * Create a document record (after file upload)
   */
  create: protectedProcedure
    .input(CreateDocumentInput)
    .mutation(async ({ input, ctx }) => {
      // Verify organization access if provided
      if (input.organizationId) {
        const isAdmin =
          ctx.user.role === "SUPER_ADMIN" || ctx.user.role === "SYSTEM_ADMIN";
        const isOrgMember = ctx.user.organizationId === input.organizationId;

        if (!isAdmin && !isOrgMember) {
          throw new TRPCError({
            code: "FORBIDDEN",
            message: "You do not have permission to upload to this organization",
          });
        }
      }

      // Verify assessment access if provided
      if (input.assessmentId) {
        const assessment = await prisma.assessment.findUnique({
          where: { id: input.assessmentId },
        });

        if (!assessment) {
          throw new TRPCError({
            code: "NOT_FOUND",
            message: "Assessment not found",
          });
        }

        const isAdmin =
          ctx.user.role === "SUPER_ADMIN" || ctx.user.role === "SYSTEM_ADMIN";
        const isOrgMember = ctx.user.organizationId === assessment.organizationId;

        if (!isAdmin && !isOrgMember) {
          throw new TRPCError({
            code: "FORBIDDEN",
            message: "You do not have permission to upload to this assessment",
          });
        }
      }

      try {
        const document = await documentService.createDocument({
          ...input,
          organizationId: input.organizationId ?? ctx.user.organizationId ?? undefined,
          uploadedById: ctx.user.id,
        });

        return {
          success: true,
          document,
        };
      } catch (error) {
        throw new TRPCError({
          code: "INTERNAL_SERVER_ERROR",
          message:
            error instanceof Error ? error.message : "Failed to create document",
        });
      }
    }),

  /**
   * Create an external URL reference
   */
  createUrlReference: protectedProcedure
    .input(CreateUrlReferenceInput)
    .mutation(async ({ input, ctx }) => {
      // Validate URL
      const validation = documentService.validateUrl(input.url);
      if (!validation.valid) {
        throw new TRPCError({
          code: "BAD_REQUEST",
          message: validation.errors.join("; "),
        });
      }

      // Verify organization access if provided
      if (input.organizationId) {
        const isAdmin =
          ctx.user.role === "SUPER_ADMIN" || ctx.user.role === "SYSTEM_ADMIN";
        const isOrgMember = ctx.user.organizationId === input.organizationId;

        if (!isAdmin && !isOrgMember) {
          throw new TRPCError({
            code: "FORBIDDEN",
            message: "You do not have permission for this organization",
          });
        }
      }

      try {
        const document = await documentService.createUrlReference(
          input.url,
          input.name,
          ctx.user.id,
          {
            description: input.description,
            category: input.category,
            organizationId: input.organizationId ?? ctx.user.organizationId ?? undefined,
            assessmentId: input.assessmentId,
          }
        );

        return {
          success: true,
          document,
        };
      } catch (error) {
        throw new TRPCError({
          code: "INTERNAL_SERVER_ERROR",
          message:
            error instanceof Error
              ? error.message
              : "Failed to create URL reference",
        });
      }
    }),

  /**
   * Link a document to an assessment response
   */
  linkToResponse: protectedProcedure
    .input(LinkToResponseInput)
    .mutation(async ({ input, ctx }) => {
      // Verify response exists and user has access
      const response = await prisma.assessmentResponse.findUnique({
        where: { id: input.responseId },
        include: { assessment: true },
      });

      if (!response) {
        throw new TRPCError({
          code: "NOT_FOUND",
          message: "Response not found",
        });
      }

      const isAdmin =
        ctx.user.role === "SUPER_ADMIN" || ctx.user.role === "SYSTEM_ADMIN";
      const isOrgMember =
        ctx.user.organizationId === response.assessment.organizationId;

      if (!isAdmin && !isOrgMember) {
        throw new TRPCError({
          code: "FORBIDDEN",
          message: "You do not have permission to modify this response",
        });
      }

      try {
        await documentService.linkToResponse({
          documentId: input.documentId,
          responseId: input.responseId,
          notes: input.notes,
          addedById: ctx.user.id,
        });

        return { success: true };
      } catch (error) {
        throw new TRPCError({
          code: "BAD_REQUEST",
          message:
            error instanceof Error
              ? error.message
              : "Failed to link document to response",
        });
      }
    }),

  /**
   * Unlink a document from an assessment response
   */
  unlinkFromResponse: protectedProcedure
    .input(UnlinkFromResponseInput)
    .mutation(async ({ input, ctx }) => {
      // Verify response exists and user has access
      const response = await prisma.assessmentResponse.findUnique({
        where: { id: input.responseId },
        include: { assessment: true },
      });

      if (!response) {
        throw new TRPCError({
          code: "NOT_FOUND",
          message: "Response not found",
        });
      }

      const isAdmin =
        ctx.user.role === "SUPER_ADMIN" || ctx.user.role === "SYSTEM_ADMIN";
      const isOrgMember =
        ctx.user.organizationId === response.assessment.organizationId;

      if (!isAdmin && !isOrgMember) {
        throw new TRPCError({
          code: "FORBIDDEN",
          message: "You do not have permission to modify this response",
        });
      }

      try {
        await documentService.unlinkFromResponse(
          input.documentId,
          input.responseId
        );

        return { success: true };
      } catch (error) {
        throw new TRPCError({
          code: "BAD_REQUEST",
          message:
            error instanceof Error
              ? error.message
              : "Failed to unlink document from response",
        });
      }
    }),

  /**
   * Get a single document by ID
   */
  get: protectedProcedure
    .input(GetDocumentInput)
    .query(async ({ input, ctx }) => {
      const document = await documentService.getDocument(input.documentId);

      if (!document) {
        throw new TRPCError({
          code: "NOT_FOUND",
          message: "Document not found",
        });
      }

      // Check access
      const isAdmin =
        ctx.user.role === "SUPER_ADMIN" || ctx.user.role === "SYSTEM_ADMIN";
      const canAccess = await documentService.canAccessDocument(
        input.documentId,
        ctx.user.id,
        ctx.user.organizationId,
        isAdmin
      );

      if (!canAccess) {
        throw new TRPCError({
          code: "FORBIDDEN",
          message: "You do not have permission to view this document",
        });
      }

      return document;
    }),

  /**
   * Get documents for an assessment
   */
  getByAssessment: protectedProcedure
    .input(GetByAssessmentInput)
    .query(async ({ input, ctx }) => {
      // Verify user has access to assessment
      const assessment = await prisma.assessment.findUnique({
        where: { id: input.assessmentId },
      });

      if (!assessment) {
        throw new TRPCError({
          code: "NOT_FOUND",
          message: "Assessment not found",
        });
      }

      const isAdmin =
        ctx.user.role === "SUPER_ADMIN" || ctx.user.role === "SYSTEM_ADMIN";
      const isOrgMember =
        ctx.user.organizationId === assessment.organizationId;

      if (!isAdmin && !isOrgMember) {
        throw new TRPCError({
          code: "FORBIDDEN",
          message: "You do not have permission to view this assessment",
        });
      }

      const documents = await documentService.getAssessmentDocuments(
        input.assessmentId
      );

      return documents;
    }),

  /**
   * Get documents for a specific response
   */
  getByResponse: protectedProcedure
    .input(GetByResponseInput)
    .query(async ({ input, ctx }) => {
      // Verify user has access to response
      const response = await prisma.assessmentResponse.findUnique({
        where: { id: input.responseId },
        include: { assessment: true },
      });

      if (!response) {
        throw new TRPCError({
          code: "NOT_FOUND",
          message: "Response not found",
        });
      }

      const isAdmin =
        ctx.user.role === "SUPER_ADMIN" || ctx.user.role === "SYSTEM_ADMIN";
      const isOrgMember =
        ctx.user.organizationId === response.assessment.organizationId;

      if (!isAdmin && !isOrgMember) {
        throw new TRPCError({
          code: "FORBIDDEN",
          message: "You do not have permission to view this response",
        });
      }

      const documents = await documentService.getResponseDocuments(
        input.responseId
      );

      return documents;
    }),

  /**
   * Get documents for an organization (document library)
   */
  getByOrganization: protectedProcedure
    .input(GetByOrganizationInput)
    .query(async ({ input, ctx }) => {
      const isAdmin =
        ctx.user.role === "SUPER_ADMIN" || ctx.user.role === "SYSTEM_ADMIN";
      const isOrgMember = ctx.user.organizationId === input.organizationId;

      if (!isAdmin && !isOrgMember) {
        throw new TRPCError({
          code: "FORBIDDEN",
          message: "You do not have permission to view this organization",
        });
      }

      const documents = await documentService.getOrganizationDocuments(
        input.organizationId,
        {
          category: input.category,
          assessmentId: input.assessmentId,
          tags: input.tags,
          search: input.search,
        }
      );

      return documents;
    }),

  /**
   * Update document metadata
   */
  update: protectedProcedure
    .input(UpdateDocumentInput)
    .mutation(async ({ input, ctx }) => {
      // Check access
      const isAdmin =
        ctx.user.role === "SUPER_ADMIN" || ctx.user.role === "SYSTEM_ADMIN";
      const canAccess = await documentService.canAccessDocument(
        input.documentId,
        ctx.user.id,
        ctx.user.organizationId,
        isAdmin
      );

      if (!canAccess) {
        throw new TRPCError({
          code: "FORBIDDEN",
          message: "You do not have permission to update this document",
        });
      }

      try {
        const { documentId, ...updateData } = input;
        const document = await documentService.updateDocument(
          documentId,
          updateData,
          ctx.user.id
        );

        return {
          success: true,
          document,
        };
      } catch (error) {
        throw new TRPCError({
          code: "BAD_REQUEST",
          message:
            error instanceof Error ? error.message : "Failed to update document",
        });
      }
    }),

  /**
   * Delete a document (soft delete)
   */
  delete: protectedProcedure
    .input(DeleteDocumentInput)
    .mutation(async ({ input, ctx }) => {
      // Check access
      const isAdmin =
        ctx.user.role === "SUPER_ADMIN" || ctx.user.role === "SYSTEM_ADMIN";
      const canAccess = await documentService.canAccessDocument(
        input.documentId,
        ctx.user.id,
        ctx.user.organizationId,
        isAdmin
      );

      if (!canAccess) {
        throw new TRPCError({
          code: "FORBIDDEN",
          message: "You do not have permission to delete this document",
        });
      }

      try {
        await documentService.deleteDocument(input.documentId, ctx.user.id);

        return { success: true };
      } catch (error) {
        throw new TRPCError({
          code: "BAD_REQUEST",
          message:
            error instanceof Error ? error.message : "Failed to delete document",
        });
      }
    }),

  /**
   * Get upload constraints for client-side validation
   */
  getConstraints: protectedProcedure.query(() => {
    return documentService.getConstraints();
  }),
});

```

# src/server/trpc/routers/progress.ts

```ts
/**
 * Progress Router
 *
 * tRPC procedures for tracking assessment progress, activity timeline,
 * and dashboard analytics.
 */

import { z } from "zod";
import { TRPCError } from "@trpc/server";
import { router, protectedProcedure } from "../trpc";
import { progressService } from "@/server/services/progress.service";
import { prisma } from "@/lib/db";

// =============================================================================
// INPUT SCHEMAS
// =============================================================================

const GetProgressInput = z.object({
  assessmentId: z.string().cuid(),
});

const GetTimelineInput = z.object({
  assessmentId: z.string().cuid(),
  limit: z.number().min(1).max(100).optional().default(20),
  offset: z.number().min(0).optional().default(0),
});

const LogEventInput = z.object({
  assessmentId: z.string().cuid(),
  type: z.enum([
    "CREATED",
    "STARTED",
    "RESPONSE_SAVED",
    "EVIDENCE_ADDED",
    "EVIDENCE_REMOVED",
    "STATUS_CHANGED",
    "SUBMITTED",
    "REVIEWED",
    "COMPLETED",
    "REOPENED",
    "COMMENT_ADDED",
  ]),
  description: z.string().min(1).max(500),
  metadata: z.record(z.string(), z.unknown()).optional(),
});

const GetOrganizationAnalyticsInput = z.object({
  organizationId: z.string().cuid(),
});

const GetDashboardStatsInput = z.object({
  organizationId: z.string().cuid().optional(),
});

const GetAssessmentsNeedingAttentionInput = z.object({
  organizationId: z.string().cuid().optional(),
  limit: z.number().min(1).max(50).optional().default(10),
});

const GetAssessmentSummaryInput = z.object({
  assessmentId: z.string().cuid(),
});

// =============================================================================
// PROGRESS ROUTER
// =============================================================================

export const progressRouter = router({
  /**
   * Get progress statistics for an assessment
   */
  getProgress: protectedProcedure
    .input(GetProgressInput)
    .query(async ({ input, ctx }) => {
      const { assessmentId } = input;

      // Verify user has access to this assessment
      const assessment = await prisma.assessment.findUnique({
        where: { id: assessmentId },
      });

      if (!assessment) {
        throw new TRPCError({
          code: "NOT_FOUND",
          message: "Assessment not found",
        });
      }

      // Check access (user must be from the same org or be admin)
      const isAdmin =
        ctx.user.role === "SUPER_ADMIN" || ctx.user.role === "SYSTEM_ADMIN";
      const isOrgMember = ctx.user.organizationId === assessment.organizationId;

      if (!isAdmin && !isOrgMember) {
        throw new TRPCError({
          code: "FORBIDDEN",
          message: "You do not have permission to access this assessment",
        });
      }

      try {
        const progress =
          await progressService.getAssessmentProgress(assessmentId);
        return progress;
      } catch (error) {
        throw new TRPCError({
          code: "INTERNAL_SERVER_ERROR",
          message:
            error instanceof Error
              ? error.message
              : "Failed to get progress statistics",
        });
      }
    }),

  /**
   * Update assessment progress (recalculate)
   */
  updateProgress: protectedProcedure
    .input(GetProgressInput)
    .mutation(async ({ input, ctx }) => {
      const { assessmentId } = input;

      // Verify access
      const assessment = await prisma.assessment.findUnique({
        where: { id: assessmentId },
      });

      if (!assessment) {
        throw new TRPCError({
          code: "NOT_FOUND",
          message: "Assessment not found",
        });
      }

      const isAdmin =
        ctx.user.role === "SUPER_ADMIN" || ctx.user.role === "SYSTEM_ADMIN";
      const isOrgMember = ctx.user.organizationId === assessment.organizationId;

      if (!isAdmin && !isOrgMember) {
        throw new TRPCError({
          code: "FORBIDDEN",
          message: "You do not have permission to access this assessment",
        });
      }

      try {
        const newProgress =
          await progressService.updateAssessmentProgress(assessmentId);
        return { assessmentId, progress: newProgress };
      } catch (error) {
        throw new TRPCError({
          code: "INTERNAL_SERVER_ERROR",
          message:
            error instanceof Error
              ? error.message
              : "Failed to update progress",
        });
      }
    }),

  /**
   * Get activity timeline for an assessment
   */
  getTimeline: protectedProcedure
    .input(GetTimelineInput)
    .query(async ({ input, ctx }) => {
      const { assessmentId, limit, offset } = input;

      // Verify access
      const assessment = await prisma.assessment.findUnique({
        where: { id: assessmentId },
      });

      if (!assessment) {
        throw new TRPCError({
          code: "NOT_FOUND",
          message: "Assessment not found",
        });
      }

      const isAdmin =
        ctx.user.role === "SUPER_ADMIN" || ctx.user.role === "SYSTEM_ADMIN";
      const isOrgMember = ctx.user.organizationId === assessment.organizationId;

      if (!isAdmin && !isOrgMember) {
        throw new TRPCError({
          code: "FORBIDDEN",
          message: "You do not have permission to access this assessment",
        });
      }

      try {
        const timeline = await progressService.getAssessmentTimeline(
          assessmentId,
          limit,
          offset
        );
        return timeline;
      } catch (error) {
        throw new TRPCError({
          code: "INTERNAL_SERVER_ERROR",
          message:
            error instanceof Error ? error.message : "Failed to get timeline",
        });
      }
    }),

  /**
   * Log an event for an assessment
   */
  logEvent: protectedProcedure
    .input(LogEventInput)
    .mutation(async ({ input, ctx }) => {
      const { assessmentId, type, description, metadata } = input;

      // Verify access
      const assessment = await prisma.assessment.findUnique({
        where: { id: assessmentId },
      });

      if (!assessment) {
        throw new TRPCError({
          code: "NOT_FOUND",
          message: "Assessment not found",
        });
      }

      const isAdmin =
        ctx.user.role === "SUPER_ADMIN" || ctx.user.role === "SYSTEM_ADMIN";
      const isOrgMember = ctx.user.organizationId === assessment.organizationId;

      if (!isAdmin && !isOrgMember) {
        throw new TRPCError({
          code: "FORBIDDEN",
          message: "You do not have permission to access this assessment",
        });
      }

      try {
        await progressService.logEvent({
          assessmentId,
          type,
          description,
          metadata,
          userId: ctx.user.id,
        });
        return { success: true };
      } catch (error) {
        throw new TRPCError({
          code: "INTERNAL_SERVER_ERROR",
          message:
            error instanceof Error ? error.message : "Failed to log event",
        });
      }
    }),

  /**
   * Get organization-level analytics
   */
  getOrganizationAnalytics: protectedProcedure
    .input(GetOrganizationAnalyticsInput)
    .query(async ({ input, ctx }) => {
      const { organizationId } = input;

      // Verify access
      const isAdmin =
        ctx.user.role === "SUPER_ADMIN" || ctx.user.role === "SYSTEM_ADMIN";
      const isOrgMember = ctx.user.organizationId === organizationId;

      if (!isAdmin && !isOrgMember) {
        throw new TRPCError({
          code: "FORBIDDEN",
          message: "You do not have permission to access this organization",
        });
      }

      try {
        const analytics =
          await progressService.getOrganizationAnalytics(organizationId);
        return analytics;
      } catch (error) {
        throw new TRPCError({
          code: "INTERNAL_SERVER_ERROR",
          message:
            error instanceof Error
              ? error.message
              : "Failed to get organization analytics",
        });
      }
    }),

  /**
   * Get dashboard statistics
   */
  getDashboardStats: protectedProcedure
    .input(GetDashboardStatsInput)
    .query(async ({ input, ctx }) => {
      const { organizationId } = input;

      // If organizationId is provided, verify access
      if (organizationId) {
        const isAdmin =
          ctx.user.role === "SUPER_ADMIN" || ctx.user.role === "SYSTEM_ADMIN";
        const isOrgMember = ctx.user.organizationId === organizationId;

        if (!isAdmin && !isOrgMember) {
          throw new TRPCError({
            code: "FORBIDDEN",
            message: "You do not have permission to access this organization",
          });
        }
      }

      try {
        // Use user's org if no specific org requested
        const targetOrgId = organizationId ?? ctx.user.organizationId ?? undefined;
        const stats = await progressService.getDashboardStats(
          ctx.user.id,
          targetOrgId
        );
        return stats;
      } catch (error) {
        throw new TRPCError({
          code: "INTERNAL_SERVER_ERROR",
          message:
            error instanceof Error
              ? error.message
              : "Failed to get dashboard statistics",
        });
      }
    }),

  /**
   * Get assessment summary with progress
   */
  getAssessmentSummary: protectedProcedure
    .input(GetAssessmentSummaryInput)
    .query(async ({ input, ctx }) => {
      const { assessmentId } = input;

      // Verify access
      const assessment = await prisma.assessment.findUnique({
        where: { id: assessmentId },
      });

      if (!assessment) {
        throw new TRPCError({
          code: "NOT_FOUND",
          message: "Assessment not found",
        });
      }

      const isAdmin =
        ctx.user.role === "SUPER_ADMIN" || ctx.user.role === "SYSTEM_ADMIN";
      const isOrgMember = ctx.user.organizationId === assessment.organizationId;

      if (!isAdmin && !isOrgMember) {
        throw new TRPCError({
          code: "FORBIDDEN",
          message: "You do not have permission to access this assessment",
        });
      }

      try {
        const summary =
          await progressService.getAssessmentSummary(assessmentId);
        return summary;
      } catch (error) {
        throw new TRPCError({
          code: "INTERNAL_SERVER_ERROR",
          message:
            error instanceof Error
              ? error.message
              : "Failed to get assessment summary",
        });
      }
    }),

  /**
   * Get assessments that need attention
   */
  getAssessmentsNeedingAttention: protectedProcedure
    .input(GetAssessmentsNeedingAttentionInput)
    .query(async ({ input, ctx }) => {
      const { organizationId, limit } = input;

      // If organizationId is provided, verify access
      if (organizationId) {
        const isAdmin =
          ctx.user.role === "SUPER_ADMIN" || ctx.user.role === "SYSTEM_ADMIN";
        const isOrgMember = ctx.user.organizationId === organizationId;

        if (!isAdmin && !isOrgMember) {
          throw new TRPCError({
            code: "FORBIDDEN",
            message: "You do not have permission to access this organization",
          });
        }
      }

      try {
        const targetOrgId = organizationId ?? ctx.user.organizationId ?? undefined;
        const assessments =
          await progressService.getAssessmentsNeedingAttention(
            targetOrgId,
            limit
          );
        return assessments;
      } catch (error) {
        throw new TRPCError({
          code: "INTERNAL_SERVER_ERROR",
          message:
            error instanceof Error
              ? error.message
              : "Failed to get assessments needing attention",
        });
      }
    }),

  /**
   * Get event type metadata (for display)
   */
  getEventTypeMetadata: protectedProcedure.query(() => {
    return {
      eventTypes: {
        CREATED: {
          label: "Created",
          labelFr: "Créé",
          icon: "Plus",
          color: "#22C55E",
        },
        STARTED: {
          label: "Started",
          labelFr: "Démarré",
          icon: "Play",
          color: "#3B82F6",
        },
        RESPONSE_SAVED: {
          label: "Response Saved",
          labelFr: "Réponse enregistrée",
          icon: "Save",
          color: "#6366F1",
        },
        EVIDENCE_ADDED: {
          label: "Evidence Added",
          labelFr: "Document ajouté",
          icon: "Paperclip",
          color: "#8B5CF6",
        },
        EVIDENCE_REMOVED: {
          label: "Evidence Removed",
          labelFr: "Document supprimé",
          icon: "Trash2",
          color: "#F97316",
        },
        STATUS_CHANGED: {
          label: "Status Changed",
          labelFr: "Statut modifié",
          icon: "RefreshCw",
          color: "#EAB308",
        },
        SUBMITTED: {
          label: "Submitted",
          labelFr: "Soumis",
          icon: "Send",
          color: "#14B8A6",
        },
        REVIEWED: {
          label: "Reviewed",
          labelFr: "Examiné",
          icon: "CheckCircle",
          color: "#0EA5E9",
        },
        COMPLETED: {
          label: "Completed",
          labelFr: "Complété",
          icon: "CheckCircle2",
          color: "#22C55E",
        },
        REOPENED: {
          label: "Reopened",
          labelFr: "Réouvert",
          icon: "RefreshCcw",
          color: "#F59E0B",
        },
        COMMENT_ADDED: {
          label: "Comment Added",
          labelFr: "Commentaire ajouté",
          icon: "MessageSquare",
          color: "#64748B",
        },
      },
    };
  }),
});

```

# src/server/trpc/routers/questionnaire.ts

```ts
import { z } from "zod";
import { TRPCError } from "@trpc/server";
import { router, publicProcedure, protectedProcedure } from "../trpc";
import type { Prisma } from "@prisma/client";

// =============================================================================
// INPUT VALIDATION SCHEMAS
// =============================================================================

const listInputSchema = z.object({
  type: z.enum(["ANS_USOAP_CMA", "SMS_CANSO_SOE"]).optional(),
  isActive: z.boolean().optional(),
  page: z.number().int().positive().default(1),
  limit: z.number().int().min(1).max(100).default(20),
});

const getByIdInputSchema = z.object({
  id: z.string().cuid(),
});

const getQuestionsInputSchema = z.object({
  questionnaireId: z.string().cuid(),
  categoryId: z.string().cuid().optional(),
  auditArea: z
    .enum(["LEG", "ORG", "PEL", "OPS", "AIR", "AIG", "ANS", "AGA", "SSP"])
    .optional(),
  criticalElement: z
    .enum(["CE_1", "CE_2", "CE_3", "CE_4", "CE_5", "CE_6", "CE_7", "CE_8"])
    .optional(),
  smsComponent: z
    .enum([
      "SAFETY_POLICY_OBJECTIVES",
      "SAFETY_RISK_MANAGEMENT",
      "SAFETY_ASSURANCE",
      "SAFETY_PROMOTION",
    ])
    .optional(),
  studyArea: z
    .enum([
      "SA_1_1",
      "SA_1_2",
      "SA_1_3",
      "SA_1_4",
      "SA_1_5",
      "SA_2_1",
      "SA_2_2",
      "SA_3_1",
      "SA_3_2",
      "SA_3_3",
      "SA_4_1",
      "SA_4_2",
    ])
    .optional(),
  isPriorityPQ: z.boolean().optional(),
  search: z.string().max(200).optional(),
  page: z.number().int().positive().default(1),
  limit: z.number().int().min(1).max(100).default(50),
});

const getQuestionByIdInputSchema = z.object({
  id: z.string().cuid(),
});

const getCategoriesInputSchema = z.object({
  questionnaireId: z.string().cuid(),
});

const getStatsInputSchema = z.object({
  questionnaireId: z.string().cuid(),
});

// =============================================================================
// QUESTIONNAIRE ROUTER
// =============================================================================

export const questionnaireRouter = router({
  /**
   * List questionnaires with pagination and filtering
   */
  list: publicProcedure.input(listInputSchema).query(async ({ ctx, input }) => {
    const { type, isActive, page, limit } = input;
    const skip = (page - 1) * limit;

    const where: Prisma.QuestionnaireWhereInput = {};

    if (type) {
      where.type = type;
    }

    if (isActive !== undefined) {
      where.isActive = isActive;
    }

    const [questionnaires, total] = await Promise.all([
      ctx.db.questionnaire.findMany({
        where,
        skip,
        take: limit,
        orderBy: { createdAt: "desc" },
        select: {
          id: true,
          code: true,
          type: true,
          version: true,
          titleEn: true,
          titleFr: true,
          descriptionEn: true,
          descriptionFr: true,
          effectiveDate: true,
          expiryDate: true,
          isActive: true,
          createdAt: true,
          updatedAt: true,
          _count: {
            select: {
              categories: true,
              questions: true,
            },
          },
        },
      }),
      ctx.db.questionnaire.count({ where }),
    ]);

    return {
      questionnaires,
      total,
      pages: Math.ceil(total / limit),
      page,
      limit,
    };
  }),

  /**
   * Get single questionnaire by ID with categories (without questions for performance)
   */
  getById: publicProcedure
    .input(getByIdInputSchema)
    .query(async ({ ctx, input }) => {
      const questionnaire = await ctx.db.questionnaire.findUnique({
        where: { id: input.id },
        include: {
          categories: {
            orderBy: { sortOrder: "asc" },
            include: {
              _count: {
                select: { questions: true },
              },
            },
          },
          _count: {
            select: {
              questions: true,
            },
          },
        },
      });

      if (!questionnaire) {
        throw new TRPCError({
          code: "NOT_FOUND",
          message: "Questionnaire not found",
        });
      }

      return questionnaire;
    }),

  /**
   * Get questions for a questionnaire with advanced filtering
   */
  getQuestions: publicProcedure
    .input(getQuestionsInputSchema)
    .query(async ({ ctx, input }) => {
      const {
        questionnaireId,
        categoryId,
        auditArea,
        criticalElement,
        smsComponent,
        studyArea,
        isPriorityPQ,
        search,
        page,
        limit,
      } = input;

      const skip = (page - 1) * limit;

      // Build where clause
      const where: Prisma.QuestionWhereInput = {
        questionnaireId,
        isActive: true,
      };

      if (categoryId) {
        where.categoryId = categoryId;
      }

      if (auditArea) {
        where.auditArea = auditArea;
      }

      if (criticalElement) {
        where.criticalElement = criticalElement;
      }

      if (smsComponent) {
        where.smsComponent = smsComponent;
      }

      if (studyArea) {
        where.studyArea = studyArea;
      }

      if (isPriorityPQ !== undefined) {
        where.isPriorityPQ = isPriorityPQ;
      }

      if (search) {
        where.OR = [
          { questionTextEn: { contains: search, mode: "insensitive" } },
          { questionTextFr: { contains: search, mode: "insensitive" } },
          { pqNumber: { contains: search, mode: "insensitive" } },
        ];
      }

      const [questions, total] = await Promise.all([
        ctx.db.question.findMany({
          where,
          skip,
          take: limit,
          orderBy: [{ sortOrder: "asc" }],
          include: {
            category: {
              select: {
                id: true,
                code: true,
                nameEn: true,
                nameFr: true,
              },
            },
            icaoReferences: true,
          },
        }),
        ctx.db.question.count({ where }),
      ]);

      return {
        questions,
        total,
        pages: Math.ceil(total / limit),
        page,
        limit,
      };
    }),

  /**
   * Get single question by ID with ICAO references
   */
  getQuestionById: publicProcedure
    .input(getQuestionByIdInputSchema)
    .query(async ({ ctx, input }) => {
      const question = await ctx.db.question.findUnique({
        where: { id: input.id },
        include: {
          questionnaire: {
            select: {
              id: true,
              code: true,
              type: true,
              titleEn: true,
              titleFr: true,
            },
          },
          category: {
            select: {
              id: true,
              code: true,
              nameEn: true,
              nameFr: true,
              auditArea: true,
              criticalElement: true,
              smsComponent: true,
              studyArea: true,
            },
          },
          icaoReferences: {
            orderBy: { referenceType: "asc" },
          },
        },
      });

      if (!question) {
        throw new TRPCError({
          code: "NOT_FOUND",
          message: "Question not found",
        });
      }

      return question;
    }),

  /**
   * Get categories for a questionnaire
   */
  getCategories: publicProcedure
    .input(getCategoriesInputSchema)
    .query(async ({ ctx, input }) => {
      const categories = await ctx.db.questionnaireCategory.findMany({
        where: { questionnaireId: input.questionnaireId },
        orderBy: { sortOrder: "asc" },
        include: {
          _count: {
            select: { questions: true },
          },
        },
      });

      return categories;
    }),

  /**
   * Get statistics for a questionnaire
   */
  getStats: protectedProcedure
    .input(getStatsInputSchema)
    .query(async ({ ctx, input }) => {
      const questionnaire = await ctx.db.questionnaire.findUnique({
        where: { id: input.questionnaireId },
        select: { type: true },
      });

      if (!questionnaire) {
        throw new TRPCError({
          code: "NOT_FOUND",
          message: "Questionnaire not found",
        });
      }

      // Get total questions count
      const totalQuestions = await ctx.db.question.count({
        where: {
          questionnaireId: input.questionnaireId,
          isActive: true,
        },
      });

      // Get priority PQs count
      const priorityPQs = await ctx.db.question.count({
        where: {
          questionnaireId: input.questionnaireId,
          isActive: true,
          isPriorityPQ: true,
        },
      });

      // Get on-site required count
      const requiresOnSite = await ctx.db.question.count({
        where: {
          questionnaireId: input.questionnaireId,
          isActive: true,
          requiresOnSite: true,
        },
      });

      // Get breakdown by audit area (for USOAP)
      const byAuditArea = await ctx.db.question.groupBy({
        by: ["auditArea"],
        where: {
          questionnaireId: input.questionnaireId,
          isActive: true,
          auditArea: { not: null },
        },
        _count: { id: true },
      });

      // Get breakdown by critical element (for USOAP)
      const byCriticalElement = await ctx.db.question.groupBy({
        by: ["criticalElement"],
        where: {
          questionnaireId: input.questionnaireId,
          isActive: true,
          criticalElement: { not: null },
        },
        _count: { id: true },
      });

      // Get breakdown by SMS component (for CANSO SoE)
      const bySmsComponent = await ctx.db.question.groupBy({
        by: ["smsComponent"],
        where: {
          questionnaireId: input.questionnaireId,
          isActive: true,
          smsComponent: { not: null },
        },
        _count: { id: true },
      });

      // Get breakdown by study area (for CANSO SoE)
      const byStudyArea = await ctx.db.question.groupBy({
        by: ["studyArea"],
        where: {
          questionnaireId: input.questionnaireId,
          isActive: true,
          studyArea: { not: null },
        },
        _count: { id: true },
      });

      // Get breakdown by PQ amendment status
      const byPqStatus = await ctx.db.question.groupBy({
        by: ["pqStatus"],
        where: {
          questionnaireId: input.questionnaireId,
          isActive: true,
        },
        _count: { id: true },
      });

      // Get categories count
      const categoriesCount = await ctx.db.questionnaireCategory.count({
        where: { questionnaireId: input.questionnaireId },
      });

      return {
        questionnaireType: questionnaire.type,
        totalQuestions,
        priorityPQs,
        requiresOnSite,
        categoriesCount,
        byAuditArea: byAuditArea.map((item) => ({
          auditArea: item.auditArea,
          count: item._count.id,
        })),
        byCriticalElement: byCriticalElement.map((item) => ({
          criticalElement: item.criticalElement,
          count: item._count.id,
        })),
        bySmsComponent: bySmsComponent.map((item) => ({
          smsComponent: item.smsComponent,
          count: item._count.id,
        })),
        byStudyArea: byStudyArea.map((item) => ({
          studyArea: item.studyArea,
          count: item._count.id,
        })),
        byPqStatus: byPqStatus.map((item) => ({
          status: item.pqStatus,
          count: item._count.id,
        })),
      };
    }),
});

```

# src/server/trpc/routers/response.ts

```ts
/**
 * Response Router - Assessment Response Management API
 *
 * Provides CRUD operations for assessment responses including:
 * - Single and bulk response saves
 * - Auto-save support for drafts
 * - Evidence attachment management
 * - Progress tracking
 *
 * Supports both ANS (USOAP CMA) and SMS (CANSO SoE) response types.
 */

import { z } from "zod";
import { TRPCError } from "@trpc/server";
import { router, protectedProcedure } from "../trpc";
import {
  SaveResponseInput,
  BulkSaveResponsesInput,
  GetResponsesInput,
  DeleteResponseInput,
  AddEvidenceInput,
  RemoveEvidenceInput,
  RESPONSE_ERRORS,
  MATURITY_LEVEL_REVERSE,
  ANS_RESPONSE_LABELS,
  SMS_MATURITY_LABELS,
} from "@/lib/validations/response";
import {
  checkAssessmentAccess,
  isAssessmentEditable,
  saveResponse,
  saveResponses,
  getResponses,
  getResponseByQuestion,
  clearResponse,
  addEvidence,
  removeEvidence,
  getDetailedProgress,
  getResponsesForScoring,
  transformResponsesForScoring,
  validateResponseValue,
  validateQuestionInQuestionnaire,
  logResponseAudit,
} from "@/server/services/response.service";
import {
  calculateEIScore,
  calculateSMSMaturity,
  calculateCategoryScores,
} from "@/lib/assessment";

// =============================================================================
// RESPONSE ROUTER
// =============================================================================

export const responseRouter = router({
  // ============================================
  // SAVE OPERATIONS
  // ============================================

  /**
   * Save a single response (auto-save compatible)
   * Used for real-time saving as users answer questions
   */
  save: protectedProcedure
    .input(SaveResponseInput)
    .mutation(async ({ ctx, input }) => {
      const { assessment, hasAccess, canWrite, reason } = await checkAssessmentAccess(
        input.assessmentId,
        ctx.user.id,
        ctx.user.role,
        ctx.user.organizationId ?? null,
        true
      );

      if (!hasAccess || !assessment) {
        throw new TRPCError({
          code: assessment ? "FORBIDDEN" : "NOT_FOUND",
          message: reason || RESPONSE_ERRORS.ASSESSMENT_NOT_FOUND.en,
        });
      }

      if (!canWrite) {
        throw new TRPCError({
          code: "FORBIDDEN",
          message: RESPONSE_ERRORS.UNAUTHORIZED.en,
        });
      }

      // Check assessment is editable
      if (!isAssessmentEditable(assessment.status)) {
        throw new TRPCError({
          code: "BAD_REQUEST",
          message: RESPONSE_ERRORS.NOT_EDITABLE.en,
        });
      }

      // Validate question belongs to questionnaire
      const isValidQuestion = await validateQuestionInQuestionnaire(
        input.questionId,
        assessment.questionnaireId
      );

      if (!isValidQuestion) {
        throw new TRPCError({
          code: "NOT_FOUND",
          message: RESPONSE_ERRORS.QUESTION_NOT_FOUND.en,
        });
      }

      // Validate response value
      const validation = validateResponseValue(
        assessment.questionnaire.type,
        input.ansResponse,
        input.smsResponse
      );

      if (!validation.valid) {
        throw new TRPCError({
          code: "BAD_REQUEST",
          message: validation.error || RESPONSE_ERRORS.INVALID_RESPONSE_TYPE.en,
        });
      }

      // Save response
      const result = await saveResponse(
        input,
        ctx.user.id,
        assessment.questionnaire.type
      );

      // Log audit
      await logResponseAudit(ctx.user.id, "SAVE_RESPONSE", input.assessmentId, input.questionId, {
        ansResponse: input.ansResponse,
        smsResponse: input.smsResponse,
        isDraft: input.isDraft,
      });

      return result;
    }),

  /**
   * Bulk save multiple responses
   * Used for batch updates or offline sync
   */
  bulkSave: protectedProcedure
    .input(BulkSaveResponsesInput)
    .mutation(async ({ ctx, input }) => {
      const { assessment, hasAccess, canWrite, reason } = await checkAssessmentAccess(
        input.assessmentId,
        ctx.user.id,
        ctx.user.role,
        ctx.user.organizationId ?? null,
        true
      );

      if (!hasAccess || !assessment) {
        throw new TRPCError({
          code: assessment ? "FORBIDDEN" : "NOT_FOUND",
          message: reason || RESPONSE_ERRORS.ASSESSMENT_NOT_FOUND.en,
        });
      }

      if (!canWrite) {
        throw new TRPCError({
          code: "FORBIDDEN",
          message: RESPONSE_ERRORS.UNAUTHORIZED.en,
        });
      }

      if (!isAssessmentEditable(assessment.status)) {
        throw new TRPCError({
          code: "BAD_REQUEST",
          message: RESPONSE_ERRORS.NOT_EDITABLE.en,
        });
      }

      // Validate all responses
      for (const response of input.responses) {
        const validation = validateResponseValue(
          assessment.questionnaire.type,
          response.ansResponse,
          response.smsResponse
        );

        if (!validation.valid) {
          throw new TRPCError({
            code: "BAD_REQUEST",
            message: `Question ${response.questionId}: ${validation.error}`,
          });
        }
      }

      // Save all responses
      const result = await saveResponses(
        input,
        ctx.user.id,
        assessment.questionnaire.type
      );

      // Log audit
      await logResponseAudit(ctx.user.id, "BULK_SAVE_RESPONSES", input.assessmentId, "bulk", {
        count: result.updatedCount,
        failed: result.failedCount,
      });

      return result;
    }),

  // ============================================
  // GET OPERATIONS
  // ============================================

  /**
   * Get responses for an assessment with filters
   */
  getByAssessment: protectedProcedure
    .input(GetResponsesInput)
    .query(async ({ ctx, input }) => {
      const { assessment, hasAccess, reason } = await checkAssessmentAccess(
        input.assessmentId,
        ctx.user.id,
        ctx.user.role,
        ctx.user.organizationId ?? null,
        false
      );

      if (!hasAccess || !assessment) {
        throw new TRPCError({
          code: assessment ? "FORBIDDEN" : "NOT_FOUND",
          message: reason || RESPONSE_ERRORS.ASSESSMENT_NOT_FOUND.en,
        });
      }

      const result = await getResponses(input, assessment.questionnaire.type);

      // Transform maturity levels for display
      const responses = result.responses.map((r) => ({
        ...r,
        displayValue:
          assessment.questionnaire.type === "ANS_USOAP_CMA"
            ? r.responseValue
            : r.maturityLevel
              ? MATURITY_LEVEL_REVERSE[r.maturityLevel]
              : null,
      }));

      return {
        ...result,
        responses,
        questionnaireType: assessment.questionnaire.type,
      };
    }),

  /**
   * Get a single response by question ID
   */
  getByQuestion: protectedProcedure
    .input(
      z.object({
        assessmentId: z.string().cuid(),
        questionId: z.string().cuid(),
      })
    )
    .query(async ({ ctx, input }) => {
      const { assessment, hasAccess, reason } = await checkAssessmentAccess(
        input.assessmentId,
        ctx.user.id,
        ctx.user.role,
        ctx.user.organizationId ?? null,
        false
      );

      if (!hasAccess || !assessment) {
        throw new TRPCError({
          code: assessment ? "FORBIDDEN" : "NOT_FOUND",
          message: reason || RESPONSE_ERRORS.ASSESSMENT_NOT_FOUND.en,
        });
      }

      const response = await getResponseByQuestion(input.assessmentId, input.questionId);

      if (!response) {
        return null;
      }

      return {
        ...response,
        displayValue:
          assessment.questionnaire.type === "ANS_USOAP_CMA"
            ? response.responseValue
            : response.maturityLevel
              ? MATURITY_LEVEL_REVERSE[response.maturityLevel]
              : null,
        questionnaireType: assessment.questionnaire.type,
      };
    }),

  // ============================================
  // DELETE OPERATIONS
  // ============================================

  /**
   * Clear/delete a response (reset to unanswered)
   */
  delete: protectedProcedure
    .input(DeleteResponseInput)
    .mutation(async ({ ctx, input }) => {
      const { assessment, hasAccess, canWrite, reason } = await checkAssessmentAccess(
        input.assessmentId,
        ctx.user.id,
        ctx.user.role,
        ctx.user.organizationId ?? null,
        true
      );

      if (!hasAccess || !assessment) {
        throw new TRPCError({
          code: assessment ? "FORBIDDEN" : "NOT_FOUND",
          message: reason || RESPONSE_ERRORS.ASSESSMENT_NOT_FOUND.en,
        });
      }

      if (!canWrite) {
        throw new TRPCError({
          code: "FORBIDDEN",
          message: RESPONSE_ERRORS.UNAUTHORIZED.en,
        });
      }

      if (!isAssessmentEditable(assessment.status)) {
        throw new TRPCError({
          code: "BAD_REQUEST",
          message: RESPONSE_ERRORS.NOT_EDITABLE.en,
        });
      }

      const result = await clearResponse(
        input.assessmentId,
        input.questionId,
        assessment.questionnaire.type
      );

      // Log audit
      await logResponseAudit(ctx.user.id, "DELETE_RESPONSE", input.assessmentId, input.questionId);

      return result;
    }),

  // ============================================
  // EVIDENCE OPERATIONS
  // ============================================

  /**
   * Add evidence URL to a response
   */
  addEvidence: protectedProcedure
    .input(AddEvidenceInput)
    .mutation(async ({ ctx, input }) => {
      const { assessment, hasAccess, canWrite, reason } = await checkAssessmentAccess(
        input.assessmentId,
        ctx.user.id,
        ctx.user.role,
        ctx.user.organizationId ?? null,
        true
      );

      if (!hasAccess || !assessment) {
        throw new TRPCError({
          code: assessment ? "FORBIDDEN" : "NOT_FOUND",
          message: reason || RESPONSE_ERRORS.ASSESSMENT_NOT_FOUND.en,
        });
      }

      if (!canWrite) {
        throw new TRPCError({
          code: "FORBIDDEN",
          message: RESPONSE_ERRORS.UNAUTHORIZED.en,
        });
      }

      if (!isAssessmentEditable(assessment.status)) {
        throw new TRPCError({
          code: "BAD_REQUEST",
          message: RESPONSE_ERRORS.NOT_EDITABLE.en,
        });
      }

      try {
        const response = await addEvidence(
          input.assessmentId,
          input.questionId,
          input.evidenceUrl
        );

        // Log audit
        await logResponseAudit(
          ctx.user.id,
          "ADD_EVIDENCE",
          input.assessmentId,
          input.questionId,
          { evidenceUrl: input.evidenceUrl }
        );

        return response;
      } catch {
        throw new TRPCError({
          code: "NOT_FOUND",
          message: "Response not found",
        });
      }
    }),

  /**
   * Remove evidence URL from a response
   */
  removeEvidence: protectedProcedure
    .input(RemoveEvidenceInput)
    .mutation(async ({ ctx, input }) => {
      const { assessment, hasAccess, canWrite, reason } = await checkAssessmentAccess(
        input.assessmentId,
        ctx.user.id,
        ctx.user.role,
        ctx.user.organizationId ?? null,
        true
      );

      if (!hasAccess || !assessment) {
        throw new TRPCError({
          code: assessment ? "FORBIDDEN" : "NOT_FOUND",
          message: reason || RESPONSE_ERRORS.ASSESSMENT_NOT_FOUND.en,
        });
      }

      if (!canWrite) {
        throw new TRPCError({
          code: "FORBIDDEN",
          message: RESPONSE_ERRORS.UNAUTHORIZED.en,
        });
      }

      if (!isAssessmentEditable(assessment.status)) {
        throw new TRPCError({
          code: "BAD_REQUEST",
          message: RESPONSE_ERRORS.NOT_EDITABLE.en,
        });
      }

      try {
        const response = await removeEvidence(
          input.assessmentId,
          input.questionId,
          input.evidenceUrl
        );

        // Log audit
        await logResponseAudit(
          ctx.user.id,
          "REMOVE_EVIDENCE",
          input.assessmentId,
          input.questionId,
          { removedUrl: input.evidenceUrl }
        );

        return response;
      } catch {
        throw new TRPCError({
          code: "NOT_FOUND",
          message: "Response not found",
        });
      }
    }),

  // ============================================
  // PROGRESS & SCORING
  // ============================================

  /**
   * Get completion progress for an assessment
   */
  getProgress: protectedProcedure
    .input(z.object({ assessmentId: z.string().cuid() }))
    .query(async ({ ctx, input }) => {
      const { assessment, hasAccess, reason } = await checkAssessmentAccess(
        input.assessmentId,
        ctx.user.id,
        ctx.user.role,
        ctx.user.organizationId ?? null,
        false
      );

      if (!hasAccess || !assessment) {
        throw new TRPCError({
          code: assessment ? "FORBIDDEN" : "NOT_FOUND",
          message: reason || RESPONSE_ERRORS.ASSESSMENT_NOT_FOUND.en,
        });
      }

      const progress = await getDetailedProgress(
        input.assessmentId,
        assessment.questionnaire.type
      );

      return {
        ...progress,
        assessmentStatus: assessment.status,
        questionnaireType: assessment.questionnaire.type,
      };
    }),

  /**
   * Calculate current scores without submitting
   */
  calculateScores: protectedProcedure
    .input(z.object({ assessmentId: z.string().cuid() }))
    .query(async ({ ctx, input }) => {
      const { assessment, hasAccess, reason } = await checkAssessmentAccess(
        input.assessmentId,
        ctx.user.id,
        ctx.user.role,
        ctx.user.organizationId ?? null,
        false
      );

      if (!hasAccess || !assessment) {
        throw new TRPCError({
          code: assessment ? "FORBIDDEN" : "NOT_FOUND",
          message: reason || RESPONSE_ERRORS.ASSESSMENT_NOT_FOUND.en,
        });
      }

      // Get all responses
      const responses = await getResponsesForScoring(input.assessmentId);
      const transformedResponses = transformResponsesForScoring(responses);

      const questionnaireType = assessment.questionnaire.type;

      if (questionnaireType === "ANS_USOAP_CMA") {
        const eiScore = calculateEIScore(transformedResponses);
        const categoryScores = calculateCategoryScores(transformedResponses, questionnaireType);

        return {
          type: "ANS" as const,
          eiScore,
          categoryScores,
          overallScore: eiScore.overallEI,
        };
      } else {
        const smsMaturity = calculateSMSMaturity(transformedResponses);
        const categoryScores = calculateCategoryScores(transformedResponses, questionnaireType);

        return {
          type: "SMS" as const,
          smsMaturity,
          categoryScores,
          overallScore: smsMaturity.overallPercentage,
          overallLevel: smsMaturity.overallLevel,
        };
      }
    }),

  // ============================================
  // LABELS & METADATA
  // ============================================

  /**
   * Get response value labels (for UI display)
   */
  getLabels: protectedProcedure
    .input(
      z.object({
        type: z.enum(["ANS_USOAP_CMA", "SMS_CANSO_SOE"]),
        locale: z.enum(["en", "fr"]).default("en"),
      })
    )
    .query(({ input }) => {
      if (input.type === "ANS_USOAP_CMA") {
        return Object.entries(ANS_RESPONSE_LABELS).map(([value, labels]) => ({
          value,
          label: labels[input.locale],
        }));
      } else {
        return Object.entries(SMS_MATURITY_LABELS).map(([value, labels]) => ({
          value,
          label: labels[input.locale],
          short: labels.short,
        }));
      }
    }),

  /**
   * Get response statistics for an assessment
   */
  getStats: protectedProcedure
    .input(z.object({ assessmentId: z.string().cuid() }))
    .query(async ({ ctx, input }) => {
      const { assessment, hasAccess, reason } = await checkAssessmentAccess(
        input.assessmentId,
        ctx.user.id,
        ctx.user.role,
        ctx.user.organizationId ?? null,
        false
      );

      if (!hasAccess || !assessment) {
        throw new TRPCError({
          code: assessment ? "FORBIDDEN" : "NOT_FOUND",
          message: reason || RESPONSE_ERRORS.ASSESSMENT_NOT_FOUND.en,
        });
      }

      const responses = await getResponsesForScoring(input.assessmentId);
      const questionnaireType = assessment.questionnaire.type;

      let stats;
      if (questionnaireType === "ANS_USOAP_CMA") {
        let satisfactory = 0;
        let notSatisfactory = 0;
        let notApplicable = 0;
        let notReviewed = 0;

        for (const r of responses) {
          switch (r.responseValue) {
            case "SATISFACTORY":
              satisfactory++;
              break;
            case "NOT_SATISFACTORY":
              notSatisfactory++;
              break;
            case "NOT_APPLICABLE":
              notApplicable++;
              break;
            default:
              notReviewed++;
          }
        }

        const applicable = satisfactory + notSatisfactory;
        const complianceRate =
          applicable > 0 ? Math.round((satisfactory / applicable) * 100) : null;

        stats = {
          type: "ANS" as const,
          total: responses.length,
          satisfactory,
          notSatisfactory,
          notApplicable,
          notReviewed,
          complianceRate,
        };
      } else {
        const maturityCounts: Record<string, number> = {
          A: 0,
          B: 0,
          C: 0,
          D: 0,
          E: 0,
          unanswered: 0,
        };

        for (const r of responses) {
          if (r.maturityLevel) {
            const level = MATURITY_LEVEL_REVERSE[r.maturityLevel];
            maturityCounts[level]++;
          } else {
            maturityCounts.unanswered++;
          }
        }

        // Calculate average maturity
        const answered = responses.length - maturityCounts.unanswered;
        let avgScore = 0;
        if (answered > 0) {
          const scores: Record<string, number> = { A: 1, B: 2, C: 3, D: 4, E: 5 };
          let totalScore = 0;
          for (const [level, count] of Object.entries(maturityCounts)) {
            if (level !== "unanswered" && scores[level]) {
              totalScore += scores[level] * count;
            }
          }
          avgScore = totalScore / answered;
        }

        let avgLevel: string | null = null;
        if (avgScore >= 4.5) avgLevel = "E";
        else if (avgScore >= 3.5) avgLevel = "D";
        else if (avgScore >= 2.5) avgLevel = "C";
        else if (avgScore >= 1.5) avgLevel = "B";
        else if (avgScore > 0) avgLevel = "A";

        stats = {
          type: "SMS" as const,
          total: responses.length,
          maturityDistribution: maturityCounts,
          averageScore: answered > 0 ? Math.round(avgScore * 100) / 100 : null,
          averageLevel: avgLevel,
          answeredCount: answered,
        };
      }

      const withEvidence = responses.filter((r) => r.evidenceUrls.length > 0).length;
      const withNotes = responses.filter((r) => r.notes && r.notes.length > 0).length;

      return {
        ...stats,
        evidenceCount: withEvidence,
        notesCount: withNotes,
        evidencePercent:
          responses.length > 0
            ? Math.round((withEvidence / responses.length) * 100)
            : 0,
      };
    }),
});

export type ResponseRouter = typeof responseRouter;

```

# src/server/trpc/routers/scoring.ts

```ts
/**
 * Scoring Router
 *
 * tRPC procedures for calculating and retrieving assessment scores.
 * Implements ICAO USOAP CMA (EI) and CANSO SoE 2024 (SMS Maturity) scoring.
 */

import { z } from "zod";
import { TRPCError } from "@trpc/server";
import { router, protectedProcedure } from "../trpc";
import { scoringService } from "@/server/services/scoring.service";
import { prisma } from "@/lib/db";

// =============================================================================
// INPUT SCHEMAS
// =============================================================================

const CalculateEIInput = z.object({
  assessmentId: z.string().cuid(),
  useWeighting: z.boolean().optional().default(false),
});

const CalculateSMSInput = z.object({
  assessmentId: z.string().cuid(),
});

const GetScoresInput = z.object({
  assessmentId: z.string().cuid(),
});

const GetScoreBreakdownInput = z.object({
  assessmentId: z.string().cuid(),
});

const CompareAssessmentsInput = z.object({
  assessmentIds: z.array(z.string().cuid()).min(1).max(10),
});

const RecalculateInput = z.object({
  assessmentId: z.string().cuid(),
  force: z.boolean().optional().default(false),
});

const ValidateForScoringInput = z.object({
  assessmentId: z.string().cuid(),
});

const GetOrganizationHistoryInput = z.object({
  organizationId: z.string().cuid(),
  questionnaireType: z.enum(["ANS_USOAP_CMA", "SMS_CANSO_SOE"]).optional(),
});

// =============================================================================
// SCORING ROUTER
// =============================================================================

export const scoringRouter = router({
  /**
   * Calculate EI score for ANS (USOAP CMA) assessment
   */
  calculateEI: protectedProcedure
    .input(CalculateEIInput)
    .mutation(async ({ input, ctx }) => {
      const { assessmentId, useWeighting } = input;

      // Verify user has access to this assessment
      const assessment = await prisma.assessment.findUnique({
        where: { id: assessmentId },
        include: { organization: true, questionnaire: true },
      });

      if (!assessment) {
        throw new TRPCError({
          code: "NOT_FOUND",
          message: "Assessment not found",
        });
      }

      // Check access (user must be from the same org or be admin)
      const isAdmin = ctx.user.role === "SUPER_ADMIN" || ctx.user.role === "SYSTEM_ADMIN";
      const isOrgMember = ctx.user.organizationId === assessment.organizationId;

      if (!isAdmin && !isOrgMember) {
        throw new TRPCError({
          code: "FORBIDDEN",
          message: "You do not have permission to access this assessment",
        });
      }

      if (assessment.questionnaire.type !== "ANS_USOAP_CMA") {
        throw new TRPCError({
          code: "BAD_REQUEST",
          message: "This assessment is not an ANS (USOAP CMA) type",
        });
      }

      try {
        const scores = await scoringService.calculateEIScore(assessmentId, {
          useWeighting,
        });

        return {
          success: true,
          scores,
          assessment: {
            id: assessment.id,
            title: assessment.title,
            organization: assessment.organization.nameEn,
            questionnaireCode: assessment.questionnaire.code,
          },
        };
      } catch (error) {
        throw new TRPCError({
          code: "INTERNAL_SERVER_ERROR",
          message:
            error instanceof Error
              ? error.message
              : "Failed to calculate EI score",
        });
      }
    }),

  /**
   * Calculate SMS maturity for CANSO SoE assessment
   */
  calculateSMS: protectedProcedure
    .input(CalculateSMSInput)
    .mutation(async ({ input, ctx }) => {
      const { assessmentId } = input;

      // Verify user has access
      const assessment = await prisma.assessment.findUnique({
        where: { id: assessmentId },
        include: { organization: true, questionnaire: true },
      });

      if (!assessment) {
        throw new TRPCError({
          code: "NOT_FOUND",
          message: "Assessment not found",
        });
      }

      const isAdmin = ctx.user.role === "SUPER_ADMIN" || ctx.user.role === "SYSTEM_ADMIN";
      const isOrgMember = ctx.user.organizationId === assessment.organizationId;

      if (!isAdmin && !isOrgMember) {
        throw new TRPCError({
          code: "FORBIDDEN",
          message: "You do not have permission to access this assessment",
        });
      }

      if (assessment.questionnaire.type !== "SMS_CANSO_SOE") {
        throw new TRPCError({
          code: "BAD_REQUEST",
          message: "This assessment is not an SMS (CANSO SoE) type",
        });
      }

      try {
        const scores = await scoringService.calculateSMSMaturity(assessmentId);

        return {
          success: true,
          scores,
          assessment: {
            id: assessment.id,
            title: assessment.title,
            organization: assessment.organization.nameEn,
            questionnaireCode: assessment.questionnaire.code,
          },
        };
      } catch (error) {
        throw new TRPCError({
          code: "INTERNAL_SERVER_ERROR",
          message:
            error instanceof Error
              ? error.message
              : "Failed to calculate SMS maturity",
        });
      }
    }),

  /**
   * Get stored scores for an assessment
   */
  getScores: protectedProcedure
    .input(GetScoresInput)
    .query(async ({ input, ctx }) => {
      const { assessmentId } = input;

      const assessment = await prisma.assessment.findUnique({
        where: { id: assessmentId },
        include: { organization: true, questionnaire: true },
      });

      if (!assessment) {
        throw new TRPCError({
          code: "NOT_FOUND",
          message: "Assessment not found",
        });
      }

      const isAdmin = ctx.user.role === "SUPER_ADMIN" || ctx.user.role === "SYSTEM_ADMIN";
      const isOrgMember = ctx.user.organizationId === assessment.organizationId;

      if (!isAdmin && !isOrgMember) {
        throw new TRPCError({
          code: "FORBIDDEN",
          message: "You do not have permission to access this assessment",
        });
      }

      return {
        assessmentId: assessment.id,
        title: assessment.title,
        type: assessment.questionnaire.type,
        organization: assessment.organization.nameEn,
        overallScore: assessment.overallScore,
        eiScore: assessment.eiScore,
        maturityLevel: assessment.maturityLevel,
        categoryScores: assessment.categoryScores,
        progress: assessment.progress,
        status: assessment.status,
      };
    }),

  /**
   * Get detailed score breakdown (recalculate on demand)
   */
  getScoreBreakdown: protectedProcedure
    .input(GetScoreBreakdownInput)
    .query(async ({ input, ctx }) => {
      const { assessmentId } = input;

      const assessment = await prisma.assessment.findUnique({
        where: { id: assessmentId },
        include: { organization: true, questionnaire: true },
      });

      if (!assessment) {
        throw new TRPCError({
          code: "NOT_FOUND",
          message: "Assessment not found",
        });
      }

      const isAdmin = ctx.user.role === "SUPER_ADMIN" || ctx.user.role === "SYSTEM_ADMIN";
      const isOrgMember = ctx.user.organizationId === assessment.organizationId;

      if (!isAdmin && !isOrgMember) {
        throw new TRPCError({
          code: "FORBIDDEN",
          message: "You do not have permission to access this assessment",
        });
      }

      try {
        const breakdown = await scoringService.getScoreBreakdown(assessmentId);

        return {
          assessmentId: assessment.id,
          type: assessment.questionnaire.type,
          breakdown,
        };
      } catch (error) {
        throw new TRPCError({
          code: "INTERNAL_SERVER_ERROR",
          message:
            error instanceof Error
              ? error.message
              : "Failed to get score breakdown",
        });
      }
    }),

  /**
   * Compare scores across multiple assessments
   */
  compareAssessments: protectedProcedure
    .input(CompareAssessmentsInput)
    .query(async ({ input, ctx }) => {
      const { assessmentIds } = input;

      // Verify access to all assessments
      const assessments = await prisma.assessment.findMany({
        where: { id: { in: assessmentIds } },
        include: { organization: true },
      });

      const isAdmin = ctx.user.role === "SUPER_ADMIN" || ctx.user.role === "SYSTEM_ADMIN";

      for (const assessment of assessments) {
        const isOrgMember =
          ctx.user.organizationId === assessment.organizationId;
        if (!isAdmin && !isOrgMember) {
          throw new TRPCError({
            code: "FORBIDDEN",
            message: `You do not have permission to access assessment ${assessment.id}`,
          });
        }
      }

      try {
        const comparison = await scoringService.compareScores(assessmentIds);
        return comparison;
      } catch (error) {
        throw new TRPCError({
          code: "INTERNAL_SERVER_ERROR",
          message:
            error instanceof Error
              ? error.message
              : "Failed to compare assessments",
        });
      }
    }),

  /**
   * Force recalculation of scores
   */
  recalculate: protectedProcedure
    .input(RecalculateInput)
    .mutation(async ({ input, ctx }) => {
      const { assessmentId, force } = input;

      const assessment = await prisma.assessment.findUnique({
        where: { id: assessmentId },
        include: { organization: true, questionnaire: true },
      });

      if (!assessment) {
        throw new TRPCError({
          code: "NOT_FOUND",
          message: "Assessment not found",
        });
      }

      const isAdmin = ctx.user.role === "SUPER_ADMIN" || ctx.user.role === "SYSTEM_ADMIN";
      const isOrgMember = ctx.user.organizationId === assessment.organizationId;

      if (!isAdmin && !isOrgMember) {
        throw new TRPCError({
          code: "FORBIDDEN",
          message: "You do not have permission to access this assessment",
        });
      }

      // Validate before recalculating unless forced
      if (!force) {
        const validation =
          await scoringService.validateForScoring(assessmentId);
        if (!validation.canCalculate) {
          throw new TRPCError({
            code: "BAD_REQUEST",
            message: validation.errors.join("; "),
          });
        }
      }

      try {
        await scoringService.calculateAndSaveScores(assessmentId);

        // Fetch updated assessment
        const updated = await prisma.assessment.findUnique({
          where: { id: assessmentId },
        });

        return {
          success: true,
          assessmentId,
          overallScore: updated?.overallScore,
          eiScore: updated?.eiScore,
          maturityLevel: updated?.maturityLevel,
          progress: updated?.progress,
        };
      } catch (error) {
        throw new TRPCError({
          code: "INTERNAL_SERVER_ERROR",
          message:
            error instanceof Error ? error.message : "Failed to recalculate scores",
        });
      }
    }),

  /**
   * Validate assessment for scoring
   */
  validateForScoring: protectedProcedure
    .input(ValidateForScoringInput)
    .query(async ({ input, ctx }) => {
      const { assessmentId } = input;

      const assessment = await prisma.assessment.findUnique({
        where: { id: assessmentId },
        include: { organization: true },
      });

      if (!assessment) {
        throw new TRPCError({
          code: "NOT_FOUND",
          message: "Assessment not found",
        });
      }

      const isAdmin = ctx.user.role === "SUPER_ADMIN" || ctx.user.role === "SYSTEM_ADMIN";
      const isOrgMember = ctx.user.organizationId === assessment.organizationId;

      if (!isAdmin && !isOrgMember) {
        throw new TRPCError({
          code: "FORBIDDEN",
          message: "You do not have permission to access this assessment",
        });
      }

      try {
        const validation =
          await scoringService.validateForScoring(assessmentId);
        return validation;
      } catch (error) {
        throw new TRPCError({
          code: "INTERNAL_SERVER_ERROR",
          message:
            error instanceof Error ? error.message : "Validation failed",
        });
      }
    }),

  /**
   * Get score history for an organization
   */
  getOrganizationHistory: protectedProcedure
    .input(GetOrganizationHistoryInput)
    .query(async ({ input, ctx }) => {
      const { organizationId, questionnaireType } = input;

      // Verify access
      const isAdmin = ctx.user.role === "SUPER_ADMIN" || ctx.user.role === "SYSTEM_ADMIN";
      const isOrgMember = ctx.user.organizationId === organizationId;

      if (!isAdmin && !isOrgMember) {
        throw new TRPCError({
          code: "FORBIDDEN",
          message: "You do not have permission to access this organization",
        });
      }

      try {
        const history = await scoringService.getOrganizationScoreHistory(
          organizationId,
          questionnaireType
        );
        return history;
      } catch (error) {
        throw new TRPCError({
          code: "INTERNAL_SERVER_ERROR",
          message:
            error instanceof Error
              ? error.message
              : "Failed to get score history",
        });
      }
    }),

  /**
   * Get scoring labels and thresholds (for display)
   */
  getScoringMetadata: protectedProcedure.query(() => {
    return {
      eiThresholds: {
        excellent: { min: 90, label: "Excellent", color: "#22C55E" },
        good: { min: 70, label: "Good", color: "#3B82F6" },
        satisfactory: { min: 50, label: "Satisfactory", color: "#EAB308" },
        needsImprovement: { min: 30, label: "Needs Improvement", color: "#F97316" },
        poor: { min: 0, label: "Poor", color: "#DC2626" },
      },
      maturityLevels: {
        LEVEL_A: {
          code: "A",
          name: "Initial/Ad-hoc",
          description: "No formal processes",
          color: "#DC2626",
          range: "0-20%",
        },
        LEVEL_B: {
          code: "B",
          name: "Defined/Documented",
          description: "Processes documented but not consistently applied",
          color: "#F97316",
          range: "21-40%",
        },
        LEVEL_C: {
          code: "C",
          name: "Implemented/Measured",
          description: "Processes implemented and measured",
          color: "#EAB308",
          range: "41-60%",
        },
        LEVEL_D: {
          code: "D",
          name: "Managed/Controlled",
          description: "Processes managed with continuous monitoring",
          color: "#22C55E",
          range: "61-80%",
        },
        LEVEL_E: {
          code: "E",
          name: "Optimizing/Leading",
          description: "Industry-leading practices, continuous improvement",
          color: "#3B82F6",
          range: "81-100%",
        },
      },
      minCompletionForScoring: 80,
      priorityPQWeight: 1.5,
    };
  }),
});

```

# src/server/trpc/trpc.ts

```ts
import { initTRPC, TRPCError } from "@trpc/server";
import superjson from "superjson";
import type { Context } from "./context";
import { UserRole } from "@prisma/client";

/**
 * Initialize tRPC with SuperJSON transformer for proper Date/Map/Set serialization
 */
const t = initTRPC.context<Context>().create({
  transformer: superjson,
  errorFormatter({ shape, error }) {
    return {
      ...shape,
      data: {
        ...shape.data,
        zodError:
          error.cause instanceof Error ? error.cause.message : null,
      },
    };
  },
});

/**
 * Create a router
 */
export const router = t.router;

/**
 * Create a caller factory for server-side calls
 */
export const createCallerFactory = t.createCallerFactory;

/**
 * Middleware to log procedure calls (development only)
 */
const loggerMiddleware = t.middleware(async ({ path, type, next }) => {
  const start = Date.now();
  const result = await next();
  const duration = Date.now() - start;

  if (process.env.NODE_ENV === "development") {
    console.log(`[tRPC] ${type} ${path} - ${duration}ms`);
  }

  return result;
});

/**
 * Base public procedure - no authentication required
 */
export const publicProcedure = t.procedure.use(loggerMiddleware);

/**
 * Middleware to check if user is authenticated
 */
const isAuthed = t.middleware(async ({ ctx, next }) => {
  if (!ctx.session || !ctx.session.user) {
    throw new TRPCError({
      code: "UNAUTHORIZED",
      message: "You must be logged in to access this resource",
    });
  }

  return next({
    ctx: {
      ...ctx,
      session: ctx.session,
      user: ctx.session.user,
    },
  });
});

/**
 * Protected procedure - requires authentication
 */
export const protectedProcedure = t.procedure
  .use(loggerMiddleware)
  .use(isAuthed);

/**
 * Admin roles that have elevated access
 */
const ADMIN_ROLES: UserRole[] = [
  "SUPER_ADMIN",
  "SYSTEM_ADMIN",
  "PROGRAMME_COORDINATOR",
];

/**
 * Middleware to check if user has admin role
 */
const isAdmin = t.middleware(async ({ ctx, next }) => {
  if (!ctx.session || !ctx.session.user) {
    throw new TRPCError({
      code: "UNAUTHORIZED",
      message: "You must be logged in to access this resource",
    });
  }

  if (!ADMIN_ROLES.includes(ctx.session.user.role)) {
    throw new TRPCError({
      code: "FORBIDDEN",
      message: "You do not have permission to access this resource",
    });
  }

  return next({
    ctx: {
      ...ctx,
      session: ctx.session,
      user: ctx.session.user,
    },
  });
});

/**
 * Admin procedure - requires admin role
 */
export const adminProcedure = t.procedure.use(loggerMiddleware).use(isAdmin);

/**
 * Middleware to check for specific roles
 */
export const requireRole = (...roles: UserRole[]) =>
  t.middleware(async ({ ctx, next }) => {
    if (!ctx.session || !ctx.session.user) {
      throw new TRPCError({
        code: "UNAUTHORIZED",
        message: "You must be logged in to access this resource",
      });
    }

    if (!roles.includes(ctx.session.user.role)) {
      throw new TRPCError({
        code: "FORBIDDEN",
        message: `This action requires one of the following roles: ${roles.join(", ")}`,
      });
    }

    return next({
      ctx: {
        ...ctx,
        session: ctx.session,
        user: ctx.session.user,
      },
    });
  });

/**
 * Create a procedure that requires specific roles
 */
export const roleProcedure = (...roles: UserRole[]) =>
  t.procedure.use(loggerMiddleware).use(requireRole(...roles));

```

# src/types/index.ts

```ts
export type Locale = "EN" | "FR";
export type QuestionnaireType = "ANS_USOAP_CMA" | "SMS_CANSO_SOE";

export type USOAPAuditArea = "LEG" | "ORG" | "PEL" | "OPS" | "AIR" | "AIG" | "ANS" | "AGA" | "SSP";
export type CriticalElement = "CE_1" | "CE_2" | "CE_3" | "CE_4" | "CE_5" | "CE_6" | "CE_7" | "CE_8";
export type SMSComponent = "SAFETY_POLICY_OBJECTIVES" | "SAFETY_RISK_MANAGEMENT" | "SAFETY_ASSURANCE" | "SAFETY_PROMOTION";
export type CANSOStudyArea = "SA_1_1" | "SA_1_2" | "SA_1_3" | "SA_1_4" | "SA_1_5" | "SA_2_1" | "SA_2_2" | "SA_3_1" | "SA_3_2" | "SA_3_3" | "SA_4_1" | "SA_4_2";
export type MaturityLevel = "LEVEL_A" | "LEVEL_B" | "LEVEL_C" | "LEVEL_D" | "LEVEL_E";

export type UserRole =
  | "SUPER_ADMIN" | "SYSTEM_ADMIN" | "STEERING_COMMITTEE" | "PROGRAMME_COORDINATOR"
  | "LEAD_REVIEWER" | "PEER_REVIEWER" | "OBSERVER"
  | "ANSP_ADMIN" | "SAFETY_MANAGER" | "QUALITY_MANAGER" | "STAFF";

export type ExpertiseArea =
  | "ATS" | "AIM_AIS" | "MET" | "CNS" | "PANS_OPS" | "SAR"
  | "SMS_POLICY" | "SMS_RISK" | "SMS_ASSURANCE" | "SMS_PROMOTION"
  | "AERODROME" | "RFF" | "ENGINEERING" | "QMS" | "TRAINING" | "HUMAN_FACTORS";

export interface BilingualContent {
  en: string;
  fr: string;
}

```

# TASKS.md

```md
# African ANSP Peer Review Platform - Development Tasks

## Completed Tasks

### Week 1-2: Foundation
- [x] Initial project setup with Next.js 16, TypeScript, Tailwind CSS
- [x] Prisma schema with 23 models for peer review system
- [x] Supabase PostgreSQL database integration
- [x] NextAuth.js v5 authentication system
- [x] next-intl internationalization (EN/FR)
- [x] Core UI components (shadcn/ui)
- [x] Dashboard layout with sidebar navigation

### Week 3-4: Questionnaire System Foundation
- [x] Questionnaire type definitions and constants
- [x] Zod validation schemas for filters and pagination
- [x] tRPC router setup with React Query integration
- [x] ICAO reference type mappings

### Week 5-6: Dual Questionnaire Browser (Current Phase)
- [x] ANS USOAP CMA 2024 browser interface
  - [x] 9 audit area filter (LEG, ORG, PEL, OPS, AIR, AIG, ANS, AGA, SSP)
  - [x] 8 critical element filter (CE-1 to CE-8)
  - [x] Priority PQ toggle
  - [x] On-site required toggle
  - [x] Full-text search
  - [x] Paginated question list
  - [x] Question detail modal
- [x] SMS CANSO SoE 2024 browser interface
  - [x] 4 SMS component tabs
  - [x] 12 study area accordions
  - [x] 5 maturity level table
  - [x] 3 transversal area badges (SPM, HP, CI)
  - [x] Question detail view
- [x] Question detail page with ICAO references
- [x] tRPC API routes for questionnaires and questions
- [x] Admin questionnaire management interface
- [x] Bulk import wizard (JSON/CSV)
- [x] Database seed with 153 AGA Protocol Questions
- [x] Full bilingual translations (EN/FR)
- [x] Unit tests for constants and Zod schemas
- [x] Questionnaire system documentation

## Upcoming Tasks

### Week 7-8: Assessment System
- [ ] Self-assessment creation workflow
- [ ] Response entry interface for ANS (Satisfactory/Not Satisfactory)
- [ ] Response entry interface for SMS (Maturity Level A-E)
- [ ] Evidence upload integration
- [ ] Progress tracking dashboard
- [ ] Auto-save functionality
- [ ] Assessment submission workflow

### Week 9-10: Scoring and Analytics
- [ ] EI (Effective Implementation) score calculation
- [ ] Weighted SMS maturity score calculation
- [ ] Audit area breakdown charts
- [ ] SMS component radar chart
- [ ] Critical element heat map
- [ ] Trend analysis over time
- [ ] Export assessment results (PDF, Excel)

### Week 11-12: Peer Review Workflow
- [ ] Review request submission
- [ ] Team assembly interface
- [ ] Reviewer assignment by expertise area
- [ ] Pre-visit document exchange
- [ ] On-site visit scheduling
- [ ] Real-time collaboration features
- [ ] Finding entry and classification

### Week 13-14: Findings and CAP Management
- [ ] Finding creation (Non-conformity, Observation, Recommendation)
- [ ] Severity classification (Critical, Major, Minor)
- [ ] ICAO reference linkage
- [ ] Corrective Action Plan (CAP) templates
- [ ] CAP submission and tracking
- [ ] Root cause analysis fields
- [ ] Verification workflow

### Week 15-16: Reporting
- [ ] Review report generation
- [ ] Executive summary auto-generation
- [ ] Finding appendices
- [ ] Score summaries by area
- [ ] Comparison with previous reviews
- [ ] PDF export with ICAO formatting
- [ ] Report approval workflow

### Week 17-18: Training Module
- [ ] Training module browser
- [ ] USOAP CMA familiarization content
- [ ] CANSO SoE methodology training
- [ ] Peer reviewer guidelines
- [ ] Knowledge check quizzes
- [ ] Completion certificates
- [ ] Training record tracking

### Week 19-20: Dashboard and Analytics
- [ ] Executive dashboard
- [ ] Organization comparison view
- [ ] Regional analytics (WACAF, ESAF, Northern)
- [ ] Maturity trend visualization
- [ ] Upcoming review calendar
- [ ] Notification center
- [ ] Activity feed

### Week 21-22: Integration and Polish
- [ ] Email notifications (Resend)
- [ ] Document storage (Supabase Storage)
- [ ] Performance optimization
- [ ] Accessibility audit (WCAG 2.1)
- [ ] Security audit
- [ ] Load testing
- [ ] Bug fixes and refinements

### Week 23-24: Launch Preparation
- [ ] User acceptance testing
- [ ] Documentation finalization
- [ ] Admin training materials
- [ ] Deployment to production
- [ ] Data migration scripts
- [ ] Monitoring setup
- [ ] Launch checklist completion

## Technical Debt
- [ ] Add remaining 698 Protocol Questions (currently have 153 AGA)
- [ ] Complete SMS CANSO SoE question content
- [ ] Add unit tests for tRPC routers
- [ ] Add integration tests for assessment workflow
- [ ] Add E2E tests with Playwright
- [ ] Optimize database queries with proper indexing
- [ ] Implement proper error boundaries
- [ ] Add loading states for all async operations

## Documentation
- [x] QUESTIONNAIRE_SYSTEM.md - Architecture and API documentation
- [x] IMPORT_FORMAT.md - Import format specification
- [ ] API_REFERENCE.md - Complete API documentation
- [ ] DATABASE_SCHEMA.md - Database schema documentation
- [ ] DEPLOYMENT.md - Deployment guide
- [ ] CONTRIBUTING.md - Contribution guidelines
- [ ] USER_GUIDE.md - End-user documentation

```

# tsconfig.json

```json
{
  "compilerOptions": {
    "target": "ES2017",
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "react-jsx",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "paths": {
      "@/*": ["./src/*"]
    }
  },
  "include": [
    "next-env.d.ts",
    "**/*.ts",
    "**/*.tsx",
    ".next/types/**/*.ts",
    ".next/dev/types/**/*.ts",
    "**/*.mts"
  ],
  "exclude": ["node_modules"]
}

```

# tsconfig.tsbuildinfo

```tsbuildinfo
{"fileNames":["./node_modules/typescript/lib/lib.es5.d.ts","./node_modules/typescript/lib/lib.es2015.d.ts","./node_modules/typescript/lib/lib.es2016.d.ts","./node_modules/typescript/lib/lib.es2017.d.ts","./node_modules/typescript/lib/lib.es2018.d.ts","./node_modules/typescript/lib/lib.es2019.d.ts","./node_modules/typescript/lib/lib.es2020.d.ts","./node_modules/typescript/lib/lib.es2021.d.ts","./node_modules/typescript/lib/lib.es2022.d.ts","./node_modules/typescript/lib/lib.es2023.d.ts","./node_modules/typescript/lib/lib.es2024.d.ts","./node_modules/typescript/lib/lib.esnext.d.ts","./node_modules/typescript/lib/lib.dom.d.ts","./node_modules/typescript/lib/lib.dom.iterable.d.ts","./node_modules/typescript/lib/lib.es2015.core.d.ts","./node_modules/typescript/lib/lib.es2015.collection.d.ts","./node_modules/typescript/lib/lib.es2015.generator.d.ts","./node_modules/typescript/lib/lib.es2015.iterable.d.ts","./node_modules/typescript/lib/lib.es2015.promise.d.ts","./node_modules/typescript/lib/lib.es2015.proxy.d.ts","./node_modules/typescript/lib/lib.es2015.reflect.d.ts","./node_modules/typescript/lib/lib.es2015.symbol.d.ts","./node_modules/typescript/lib/lib.es2015.symbol.wellknown.d.ts","./node_modules/typescript/lib/lib.es2016.array.include.d.ts","./node_modules/typescript/lib/lib.es2016.intl.d.ts","./node_modules/typescript/lib/lib.es2017.arraybuffer.d.ts","./node_modules/typescript/lib/lib.es2017.date.d.ts","./node_modules/typescript/lib/lib.es2017.object.d.ts","./node_modules/typescript/lib/lib.es2017.sharedmemory.d.ts","./node_modules/typescript/lib/lib.es2017.string.d.ts","./node_modules/typescript/lib/lib.es2017.intl.d.ts","./node_modules/typescript/lib/lib.es2017.typedarrays.d.ts","./node_modules/typescript/lib/lib.es2018.asyncgenerator.d.ts","./node_modules/typescript/lib/lib.es2018.asynciterable.d.ts","./node_modules/typescript/lib/lib.es2018.intl.d.ts","./node_modules/typescript/lib/lib.es2018.promise.d.ts","./node_modules/typescript/lib/lib.es2018.regexp.d.ts","./node_modules/typescript/lib/lib.es2019.array.d.ts","./node_modules/typescript/lib/lib.es2019.object.d.ts","./node_modules/typescript/lib/lib.es2019.string.d.ts","./node_modules/typescript/lib/lib.es2019.symbol.d.ts","./node_modules/typescript/lib/lib.es2019.intl.d.ts","./node_modules/typescript/lib/lib.es2020.bigint.d.ts","./node_modules/typescript/lib/lib.es2020.date.d.ts","./node_modules/typescript/lib/lib.es2020.promise.d.ts","./node_modules/typescript/lib/lib.es2020.sharedmemory.d.ts","./node_modules/typescript/lib/lib.es2020.string.d.ts","./node_modules/typescript/lib/lib.es2020.symbol.wellknown.d.ts","./node_modules/typescript/lib/lib.es2020.intl.d.ts","./node_modules/typescript/lib/lib.es2020.number.d.ts","./node_modules/typescript/lib/lib.es2021.promise.d.ts","./node_modules/typescript/lib/lib.es2021.string.d.ts","./node_modules/typescript/lib/lib.es2021.weakref.d.ts","./node_modules/typescript/lib/lib.es2021.intl.d.ts","./node_modules/typescript/lib/lib.es2022.array.d.ts","./node_modules/typescript/lib/lib.es2022.error.d.ts","./node_modules/typescript/lib/lib.es2022.intl.d.ts","./node_modules/typescript/lib/lib.es2022.object.d.ts","./node_modules/typescript/lib/lib.es2022.string.d.ts","./node_modules/typescript/lib/lib.es2022.regexp.d.ts","./node_modules/typescript/lib/lib.es2023.array.d.ts","./node_modules/typescript/lib/lib.es2023.collection.d.ts","./node_modules/typescript/lib/lib.es2023.intl.d.ts","./node_modules/typescript/lib/lib.es2024.arraybuffer.d.ts","./node_modules/typescript/lib/lib.es2024.collection.d.ts","./node_modules/typescript/lib/lib.es2024.object.d.ts","./node_modules/typescript/lib/lib.es2024.promise.d.ts","./node_modules/typescript/lib/lib.es2024.regexp.d.ts","./node_modules/typescript/lib/lib.es2024.sharedmemory.d.ts","./node_modules/typescript/lib/lib.es2024.string.d.ts","./node_modules/typescript/lib/lib.esnext.array.d.ts","./node_modules/typescript/lib/lib.esnext.collection.d.ts","./node_modules/typescript/lib/lib.esnext.intl.d.ts","./node_modules/typescript/lib/lib.esnext.disposable.d.ts","./node_modules/typescript/lib/lib.esnext.promise.d.ts","./node_modules/typescript/lib/lib.esnext.decorators.d.ts","./node_modules/typescript/lib/lib.esnext.iterator.d.ts","./node_modules/typescript/lib/lib.esnext.float16.d.ts","./node_modules/typescript/lib/lib.esnext.error.d.ts","./node_modules/typescript/lib/lib.esnext.sharedmemory.d.ts","./node_modules/typescript/lib/lib.decorators.d.ts","./node_modules/typescript/lib/lib.decorators.legacy.d.ts","./node_modules/@types/react/global.d.ts","./node_modules/csstype/index.d.ts","./node_modules/@types/react/index.d.ts","./node_modules/next/dist/styled-jsx/types/css.d.ts","./node_modules/next/dist/styled-jsx/types/macro.d.ts","./node_modules/next/dist/styled-jsx/types/style.d.ts","./node_modules/next/dist/styled-jsx/types/global.d.ts","./node_modules/next/dist/styled-jsx/types/index.d.ts","./node_modules/next/dist/server/get-page-files.d.ts","./node_modules/@types/node/compatibility/disposable.d.ts","./node_modules/@types/node/compatibility/indexable.d.ts","./node_modules/@types/node/compatibility/iterators.d.ts","./node_modules/@types/node/compatibility/index.d.ts","./node_modules/@types/node/globals.typedarray.d.ts","./node_modules/@types/node/buffer.buffer.d.ts","./node_modules/@types/node/globals.d.ts","./node_modules/@types/node/web-globals/abortcontroller.d.ts","./node_modules/@types/node/web-globals/domexception.d.ts","./node_modules/@types/node/web-globals/events.d.ts","./node_modules/undici-types/header.d.ts","./node_modules/undici-types/readable.d.ts","./node_modules/undici-types/file.d.ts","./node_modules/undici-types/fetch.d.ts","./node_modules/undici-types/formdata.d.ts","./node_modules/undici-types/connector.d.ts","./node_modules/undici-types/client.d.ts","./node_modules/undici-types/errors.d.ts","./node_modules/undici-types/dispatcher.d.ts","./node_modules/undici-types/global-dispatcher.d.ts","./node_modules/undici-types/global-origin.d.ts","./node_modules/undici-types/pool-stats.d.ts","./node_modules/undici-types/pool.d.ts","./node_modules/undici-types/handlers.d.ts","./node_modules/undici-types/balanced-pool.d.ts","./node_modules/undici-types/agent.d.ts","./node_modules/undici-types/mock-interceptor.d.ts","./node_modules/undici-types/mock-agent.d.ts","./node_modules/undici-types/mock-client.d.ts","./node_modules/undici-types/mock-pool.d.ts","./node_modules/undici-types/mock-errors.d.ts","./node_modules/undici-types/proxy-agent.d.ts","./node_modules/undici-types/env-http-proxy-agent.d.ts","./node_modules/undici-types/retry-handler.d.ts","./node_modules/undici-types/retry-agent.d.ts","./node_modules/undici-types/api.d.ts","./node_modules/undici-types/interceptors.d.ts","./node_modules/undici-types/util.d.ts","./node_modules/undici-types/cookies.d.ts","./node_modules/undici-types/patch.d.ts","./node_modules/undici-types/websocket.d.ts","./node_modules/undici-types/eventsource.d.ts","./node_modules/undici-types/filereader.d.ts","./node_modules/undici-types/diagnostics-channel.d.ts","./node_modules/undici-types/content-type.d.ts","./node_modules/undici-types/cache.d.ts","./node_modules/undici-types/index.d.ts","./node_modules/@types/node/web-globals/fetch.d.ts","./node_modules/@types/node/assert.d.ts","./node_modules/@types/node/assert/strict.d.ts","./node_modules/@types/node/async_hooks.d.ts","./node_modules/@types/node/buffer.d.ts","./node_modules/@types/node/child_process.d.ts","./node_modules/@types/node/cluster.d.ts","./node_modules/@types/node/console.d.ts","./node_modules/@types/node/constants.d.ts","./node_modules/@types/node/crypto.d.ts","./node_modules/@types/node/dgram.d.ts","./node_modules/@types/node/diagnostics_channel.d.ts","./node_modules/@types/node/dns.d.ts","./node_modules/@types/node/dns/promises.d.ts","./node_modules/@types/node/domain.d.ts","./node_modules/@types/node/events.d.ts","./node_modules/@types/node/fs.d.ts","./node_modules/@types/node/fs/promises.d.ts","./node_modules/@types/node/http.d.ts","./node_modules/@types/node/http2.d.ts","./node_modules/@types/node/https.d.ts","./node_modules/@types/node/inspector.generated.d.ts","./node_modules/@types/node/module.d.ts","./node_modules/@types/node/net.d.ts","./node_modules/@types/node/os.d.ts","./node_modules/@types/node/path.d.ts","./node_modules/@types/node/perf_hooks.d.ts","./node_modules/@types/node/process.d.ts","./node_modules/@types/node/punycode.d.ts","./node_modules/@types/node/querystring.d.ts","./node_modules/@types/node/readline.d.ts","./node_modules/@types/node/readline/promises.d.ts","./node_modules/@types/node/repl.d.ts","./node_modules/@types/node/sea.d.ts","./node_modules/@types/node/stream.d.ts","./node_modules/@types/node/stream/promises.d.ts","./node_modules/@types/node/stream/consumers.d.ts","./node_modules/@types/node/stream/web.d.ts","./node_modules/@types/node/string_decoder.d.ts","./node_modules/@types/node/test.d.ts","./node_modules/@types/node/timers.d.ts","./node_modules/@types/node/timers/promises.d.ts","./node_modules/@types/node/tls.d.ts","./node_modules/@types/node/trace_events.d.ts","./node_modules/@types/node/tty.d.ts","./node_modules/@types/node/url.d.ts","./node_modules/@types/node/util.d.ts","./node_modules/@types/node/v8.d.ts","./node_modules/@types/node/vm.d.ts","./node_modules/@types/node/wasi.d.ts","./node_modules/@types/node/worker_threads.d.ts","./node_modules/@types/node/zlib.d.ts","./node_modules/@types/node/index.d.ts","./node_modules/@types/react/canary.d.ts","./node_modules/@types/react/experimental.d.ts","./node_modules/@types/react-dom/index.d.ts","./node_modules/@types/react-dom/canary.d.ts","./node_modules/@types/react-dom/experimental.d.ts","./node_modules/next/dist/lib/fallback.d.ts","./node_modules/next/dist/compiled/webpack/webpack.d.ts","./node_modules/next/dist/shared/lib/modern-browserslist-target.d.ts","./node_modules/next/dist/shared/lib/entry-constants.d.ts","./node_modules/next/dist/shared/lib/constants.d.ts","./node_modules/next/dist/server/config.d.ts","./node_modules/next/dist/lib/load-custom-routes.d.ts","./node_modules/next/dist/shared/lib/image-config.d.ts","./node_modules/next/dist/build/webpack/plugins/subresource-integrity-plugin.d.ts","./node_modules/next/dist/server/body-streams.d.ts","./node_modules/next/dist/server/lib/cache-control.d.ts","./node_modules/next/dist/lib/setup-exception-listeners.d.ts","./node_modules/next/dist/lib/worker.d.ts","./node_modules/next/dist/lib/constants.d.ts","./node_modules/next/dist/lib/bundler.d.ts","./node_modules/next/dist/server/lib/experimental/ppr.d.ts","./node_modules/next/dist/lib/page-types.d.ts","./node_modules/next/dist/build/segment-config/app/app-segment-config.d.ts","./node_modules/next/dist/build/segment-config/pages/pages-segment-config.d.ts","./node_modules/next/dist/build/analysis/get-page-static-info.d.ts","./node_modules/next/dist/build/webpack/loaders/get-module-build-info.d.ts","./node_modules/next/dist/build/webpack/plugins/middleware-plugin.d.ts","./node_modules/next/dist/server/require-hook.d.ts","./node_modules/next/dist/server/node-polyfill-crypto.d.ts","./node_modules/next/dist/server/node-environment-baseline.d.ts","./node_modules/next/dist/server/node-environment-extensions/error-inspect.d.ts","./node_modules/next/dist/server/node-environment-extensions/console-file.d.ts","./node_modules/next/dist/server/node-environment-extensions/console-exit.d.ts","./node_modules/next/dist/server/node-environment-extensions/console-dim.external.d.ts","./node_modules/next/dist/server/node-environment-extensions/unhandled-rejection.d.ts","./node_modules/next/dist/server/node-environment-extensions/random.d.ts","./node_modules/next/dist/server/node-environment-extensions/date.d.ts","./node_modules/next/dist/server/node-environment-extensions/web-crypto.d.ts","./node_modules/next/dist/server/node-environment-extensions/node-crypto.d.ts","./node_modules/next/dist/server/node-environment-extensions/fast-set-immediate.external.d.ts","./node_modules/next/dist/server/node-environment.d.ts","./node_modules/next/dist/build/page-extensions-type.d.ts","./node_modules/next/dist/server/route-kind.d.ts","./node_modules/next/dist/server/route-definitions/route-definition.d.ts","./node_modules/next/dist/server/route-definitions/app-page-route-definition.d.ts","./node_modules/next/dist/server/lib/cache-handlers/types.d.ts","./node_modules/next/dist/server/response-cache/types.d.ts","./node_modules/next/dist/server/resume-data-cache/cache-store.d.ts","./node_modules/next/dist/server/resume-data-cache/resume-data-cache.d.ts","./node_modules/next/dist/client/components/app-router-headers.d.ts","./node_modules/next/dist/server/render-result.d.ts","./node_modules/next/dist/server/instrumentation/types.d.ts","./node_modules/next/dist/lib/coalesced-function.d.ts","./node_modules/next/dist/shared/lib/router/utils/middleware-route-matcher.d.ts","./node_modules/next/dist/server/lib/router-utils/types.d.ts","./node_modules/next/dist/trace/types.d.ts","./node_modules/next/dist/trace/trace.d.ts","./node_modules/next/dist/trace/shared.d.ts","./node_modules/next/dist/trace/index.d.ts","./node_modules/next/dist/build/load-jsconfig.d.ts","./node_modules/@next/env/dist/index.d.ts","./node_modules/next/dist/build/webpack/plugins/telemetry-plugin/use-cache-tracker-utils.d.ts","./node_modules/next/dist/build/webpack/plugins/telemetry-plugin/telemetry-plugin.d.ts","./node_modules/next/dist/telemetry/storage.d.ts","./node_modules/next/dist/build/build-context.d.ts","./node_modules/next/dist/shared/lib/bloom-filter.d.ts","./node_modules/next/dist/build/webpack-config.d.ts","./node_modules/next/dist/build/swc/generated-native.d.ts","./node_modules/next/dist/build/swc/types.d.ts","./node_modules/next/dist/server/dev/parse-version-info.d.ts","./node_modules/next/dist/next-devtools/shared/types.d.ts","./node_modules/next/dist/server/dev/dev-indicator-server-state.d.ts","./node_modules/next/dist/next-devtools/dev-overlay/cache-indicator.d.ts","./node_modules/next/dist/server/lib/parse-stack.d.ts","./node_modules/next/dist/next-devtools/server/shared.d.ts","./node_modules/next/dist/next-devtools/shared/stack-frame.d.ts","./node_modules/next/dist/next-devtools/dev-overlay/utils/get-error-by-type.d.ts","./node_modules/@types/react/jsx-runtime.d.ts","./node_modules/next/dist/next-devtools/dev-overlay/container/runtime-error/render-error.d.ts","./node_modules/next/dist/next-devtools/dev-overlay/shared.d.ts","./node_modules/next/dist/server/dev/debug-channel.d.ts","./node_modules/next/dist/server/dev/hot-reloader-types.d.ts","./node_modules/next/dist/server/lib/i18n-provider.d.ts","./node_modules/next/dist/server/web/next-url.d.ts","./node_modules/next/dist/compiled/@edge-runtime/cookies/index.d.ts","./node_modules/next/dist/server/web/spec-extension/cookies.d.ts","./node_modules/next/dist/server/web/spec-extension/request.d.ts","./node_modules/next/dist/server/after/builtin-request-context.d.ts","./node_modules/next/dist/server/web/spec-extension/fetch-event.d.ts","./node_modules/next/dist/server/web/spec-extension/response.d.ts","./node_modules/next/dist/build/segment-config/middleware/middleware-config.d.ts","./node_modules/next/dist/server/web/types.d.ts","./node_modules/next/dist/build/webpack/plugins/pages-manifest-plugin.d.ts","./node_modules/next/dist/shared/lib/router/utils/parse-url.d.ts","./node_modules/next/dist/server/route-definitions/locale-route-definition.d.ts","./node_modules/next/dist/server/route-definitions/pages-route-definition.d.ts","./node_modules/next/dist/build/webpack/plugins/flight-manifest-plugin.d.ts","./node_modules/next/dist/build/webpack/plugins/next-font-manifest-plugin.d.ts","./node_modules/next/dist/shared/lib/deep-readonly.d.ts","./node_modules/next/dist/next-devtools/userspace/pages/pages-dev-overlay-setup.d.ts","./node_modules/next/dist/server/render.d.ts","./node_modules/next/dist/shared/lib/mitt.d.ts","./node_modules/next/dist/client/with-router.d.ts","./node_modules/next/dist/client/router.d.ts","./node_modules/next/dist/client/route-loader.d.ts","./node_modules/next/dist/client/page-loader.d.ts","./node_modules/next/dist/shared/lib/router/router.d.ts","./node_modules/next/dist/shared/lib/router-context.shared-runtime.d.ts","./node_modules/next/dist/shared/lib/loadable-context.shared-runtime.d.ts","./node_modules/next/dist/shared/lib/loadable.shared-runtime.d.ts","./node_modules/next/dist/shared/lib/image-config-context.shared-runtime.d.ts","./node_modules/next/dist/client/components/readonly-url-search-params.d.ts","./node_modules/next/dist/shared/lib/hooks-client-context.shared-runtime.d.ts","./node_modules/next/dist/shared/lib/head-manager-context.shared-runtime.d.ts","./node_modules/next/dist/shared/lib/app-router-types.d.ts","./node_modules/next/dist/client/flight-data-helpers.d.ts","./node_modules/next/dist/client/components/router-reducer/ppr-navigations.d.ts","./node_modules/next/dist/client/components/segment-cache/types.d.ts","./node_modules/next/dist/client/components/segment-cache/navigation.d.ts","./node_modules/next/dist/client/components/segment-cache/cache-key.d.ts","./node_modules/next/dist/client/components/router-reducer/fetch-server-response.d.ts","./node_modules/next/dist/client/components/router-reducer/router-reducer-types.d.ts","./node_modules/next/dist/shared/lib/app-router-context.shared-runtime.d.ts","./node_modules/next/dist/shared/lib/server-inserted-html.shared-runtime.d.ts","./node_modules/next/dist/server/route-modules/pages/vendored/contexts/entrypoints.d.ts","./node_modules/next/dist/server/route-modules/pages/module.compiled.d.ts","./node_modules/next/dist/build/templates/pages.d.ts","./node_modules/next/dist/server/route-modules/pages/module.d.ts","./node_modules/next/dist/server/route-modules/pages/builtin/_error.d.ts","./node_modules/next/dist/server/load-default-error-components.d.ts","./node_modules/next/dist/server/base-http/node.d.ts","./node_modules/next/dist/server/response-cache/index.d.ts","./node_modules/next/dist/server/route-definitions/pages-api-route-definition.d.ts","./node_modules/next/dist/server/route-matches/pages-api-route-match.d.ts","./node_modules/next/dist/server/route-matchers/route-matcher.d.ts","./node_modules/next/dist/server/route-matcher-providers/route-matcher-provider.d.ts","./node_modules/next/dist/server/route-matcher-managers/route-matcher-manager.d.ts","./node_modules/next/dist/server/normalizers/normalizer.d.ts","./node_modules/next/dist/server/normalizers/locale-route-normalizer.d.ts","./node_modules/next/dist/server/normalizers/request/pathname-normalizer.d.ts","./node_modules/next/dist/server/normalizers/request/suffix.d.ts","./node_modules/next/dist/server/normalizers/request/rsc.d.ts","./node_modules/next/dist/server/normalizers/request/next-data.d.ts","./node_modules/next/dist/server/normalizers/request/segment-prefix-rsc.d.ts","./node_modules/next/dist/build/static-paths/types.d.ts","./node_modules/next/dist/server/base-server.d.ts","./node_modules/next/dist/server/lib/async-callback-set.d.ts","./node_modules/next/dist/shared/lib/router/utils/route-regex.d.ts","./node_modules/next/dist/shared/lib/router/utils/route-matcher.d.ts","./node_modules/sharp/lib/index.d.ts","./node_modules/next/dist/server/image-optimizer.d.ts","./node_modules/next/dist/server/next-server.d.ts","./node_modules/next/dist/server/lib/types.d.ts","./node_modules/next/dist/server/lib/lru-cache.d.ts","./node_modules/next/dist/server/lib/dev-bundler-service.d.ts","./node_modules/next/dist/server/use-cache/cache-life.d.ts","./node_modules/next/dist/server/dev/static-paths-worker.d.ts","./node_modules/next/dist/server/dev/next-dev-server.d.ts","./node_modules/next/dist/server/next.d.ts","./node_modules/next/dist/server/lib/render-server.d.ts","./node_modules/next/dist/server/lib/router-server.d.ts","./node_modules/next/dist/shared/lib/router/utils/path-match.d.ts","./node_modules/next/dist/server/lib/router-utils/filesystem.d.ts","./node_modules/next/dist/server/lib/router-utils/setup-dev-bundler.d.ts","./node_modules/next/dist/server/lib/router-utils/router-server-context.d.ts","./node_modules/next/dist/server/route-modules/route-module.d.ts","./node_modules/next/dist/server/load-components.d.ts","./node_modules/next/dist/server/web/adapter.d.ts","./node_modules/next/dist/server/app-render/types.d.ts","./node_modules/next/dist/build/webpack/loaders/metadata/types.d.ts","./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.d.ts","./node_modules/next/dist/server/lib/app-dir-module.d.ts","./node_modules/next/dist/server/web/spec-extension/adapters/request-cookies.d.ts","./node_modules/next/dist/server/async-storage/draft-mode-provider.d.ts","./node_modules/next/dist/server/web/spec-extension/adapters/headers.d.ts","./node_modules/next/dist/server/app-render/cache-signal.d.ts","./node_modules/next/dist/server/app-render/dynamic-rendering.d.ts","./node_modules/next/dist/server/request/fallback-params.d.ts","./node_modules/next/dist/server/app-render/work-unit-async-storage-instance.d.ts","./node_modules/next/dist/server/lib/lazy-result.d.ts","./node_modules/next/dist/server/lib/implicit-tags.d.ts","./node_modules/next/dist/server/app-render/staged-rendering.d.ts","./node_modules/next/dist/server/app-render/work-unit-async-storage.external.d.ts","./node_modules/next/dist/shared/lib/router/utils/parse-relative-url.d.ts","./node_modules/next/dist/server/app-render/app-render.d.ts","./node_modules/next/dist/server/route-modules/app-page/vendored/contexts/entrypoints.d.ts","./node_modules/next/dist/client/components/error-boundary.d.ts","./node_modules/next/dist/client/components/layout-router.d.ts","./node_modules/next/dist/client/components/render-from-template-context.d.ts","./node_modules/next/dist/server/app-render/action-async-storage-instance.d.ts","./node_modules/next/dist/server/app-render/action-async-storage.external.d.ts","./node_modules/next/dist/client/components/client-page.d.ts","./node_modules/next/dist/client/components/client-segment.d.ts","./node_modules/next/dist/server/request/search-params.d.ts","./node_modules/next/dist/client/components/hooks-server-context.d.ts","./node_modules/next/dist/client/components/http-access-fallback/error-boundary.d.ts","./node_modules/next/dist/lib/metadata/types/alternative-urls-types.d.ts","./node_modules/next/dist/lib/metadata/types/extra-types.d.ts","./node_modules/next/dist/lib/metadata/types/metadata-types.d.ts","./node_modules/next/dist/lib/metadata/types/manifest-types.d.ts","./node_modules/next/dist/lib/metadata/types/opengraph-types.d.ts","./node_modules/next/dist/lib/metadata/types/twitter-types.d.ts","./node_modules/next/dist/lib/metadata/types/metadata-interface.d.ts","./node_modules/next/dist/lib/metadata/types/resolvers.d.ts","./node_modules/next/dist/lib/metadata/types/icons.d.ts","./node_modules/next/dist/lib/metadata/resolve-metadata.d.ts","./node_modules/next/dist/lib/metadata/metadata.d.ts","./node_modules/next/dist/lib/framework/boundary-components.d.ts","./node_modules/next/dist/server/app-render/rsc/preloads.d.ts","./node_modules/next/dist/server/app-render/rsc/postpone.d.ts","./node_modules/next/dist/server/app-render/rsc/taint.d.ts","./node_modules/next/dist/shared/lib/segment-cache/segment-value-encoding.d.ts","./node_modules/next/dist/server/app-render/collect-segment-data.d.ts","./node_modules/next/dist/next-devtools/userspace/app/segment-explorer-node.d.ts","./node_modules/next/dist/server/app-render/entry-base.d.ts","./node_modules/next/dist/build/templates/app-page.d.ts","./node_modules/next/dist/build/rendering-mode.d.ts","./node_modules/@types/react/jsx-dev-runtime.d.ts","./node_modules/@types/react/compiler-runtime.d.ts","./node_modules/next/dist/server/route-modules/app-page/vendored/rsc/entrypoints.d.ts","./node_modules/@types/react-dom/client.d.ts","./node_modules/@types/react-dom/static.d.ts","./node_modules/@types/react-dom/server.d.ts","./node_modules/next/dist/server/route-modules/app-page/vendored/ssr/entrypoints.d.ts","./node_modules/next/dist/server/route-modules/app-page/module.d.ts","./node_modules/next/dist/server/route-modules/app-page/module.compiled.d.ts","./node_modules/next/dist/server/route-definitions/app-route-route-definition.d.ts","./node_modules/next/dist/server/async-storage/work-store.d.ts","./node_modules/next/dist/server/web/http.d.ts","./node_modules/next/dist/server/route-modules/app-route/shared-modules.d.ts","./node_modules/next/dist/client/components/redirect-status-code.d.ts","./node_modules/next/dist/client/components/redirect-error.d.ts","./node_modules/next/dist/build/templates/app-route.d.ts","./node_modules/next/dist/server/route-modules/app-route/module.d.ts","./node_modules/next/dist/server/route-modules/app-route/module.compiled.d.ts","./node_modules/next/dist/build/segment-config/app/app-segments.d.ts","./node_modules/next/dist/build/utils.d.ts","./node_modules/next/dist/server/lib/router-utils/build-prefetch-segment-data-route.d.ts","./node_modules/next/dist/build/turborepo-access-trace/types.d.ts","./node_modules/next/dist/build/turborepo-access-trace/result.d.ts","./node_modules/next/dist/build/turborepo-access-trace/helpers.d.ts","./node_modules/next/dist/build/turborepo-access-trace/index.d.ts","./node_modules/next/dist/export/routes/types.d.ts","./node_modules/next/dist/export/types.d.ts","./node_modules/next/dist/export/worker.d.ts","./node_modules/next/dist/build/worker.d.ts","./node_modules/next/dist/build/index.d.ts","./node_modules/next/dist/server/lib/incremental-cache/index.d.ts","./node_modules/next/dist/server/after/after.d.ts","./node_modules/next/dist/server/after/after-context.d.ts","./node_modules/next/dist/server/app-render/work-async-storage-instance.d.ts","./node_modules/next/dist/server/app-render/create-error-handler.d.ts","./node_modules/next/dist/shared/lib/action-revalidation-kind.d.ts","./node_modules/next/dist/server/app-render/work-async-storage.external.d.ts","./node_modules/next/dist/server/request/params.d.ts","./node_modules/next/dist/server/route-matches/route-match.d.ts","./node_modules/next/dist/server/request-meta.d.ts","./node_modules/next/dist/cli/next-test.d.ts","./node_modules/next/dist/server/config-shared.d.ts","./node_modules/next/dist/server/base-http/index.d.ts","./node_modules/next/dist/server/api-utils/index.d.ts","./node_modules/next/dist/build/adapter/build-complete.d.ts","./node_modules/next/dist/types.d.ts","./node_modules/next/dist/shared/lib/html-context.shared-runtime.d.ts","./node_modules/next/dist/shared/lib/utils.d.ts","./node_modules/next/dist/pages/_app.d.ts","./node_modules/next/app.d.ts","./node_modules/next/dist/server/web/spec-extension/unstable-cache.d.ts","./node_modules/next/dist/server/web/spec-extension/revalidate.d.ts","./node_modules/next/dist/server/web/spec-extension/unstable-no-store.d.ts","./node_modules/next/dist/server/use-cache/cache-tag.d.ts","./node_modules/next/cache.d.ts","./node_modules/next/dist/pages/_document.d.ts","./node_modules/next/document.d.ts","./node_modules/next/dist/shared/lib/dynamic.d.ts","./node_modules/next/dynamic.d.ts","./node_modules/next/dist/pages/_error.d.ts","./node_modules/next/error.d.ts","./node_modules/next/dist/shared/lib/head.d.ts","./node_modules/next/head.d.ts","./node_modules/next/dist/server/request/cookies.d.ts","./node_modules/next/dist/server/request/headers.d.ts","./node_modules/next/dist/server/request/draft-mode.d.ts","./node_modules/next/headers.d.ts","./node_modules/next/dist/shared/lib/get-img-props.d.ts","./node_modules/next/dist/client/image-component.d.ts","./node_modules/next/dist/shared/lib/image-external.d.ts","./node_modules/next/image.d.ts","./node_modules/next/dist/client/link.d.ts","./node_modules/next/link.d.ts","./node_modules/next/dist/client/components/unrecognized-action-error.d.ts","./node_modules/next/dist/client/components/redirect.d.ts","./node_modules/next/dist/client/components/not-found.d.ts","./node_modules/next/dist/client/components/forbidden.d.ts","./node_modules/next/dist/client/components/unauthorized.d.ts","./node_modules/next/dist/client/components/unstable-rethrow.server.d.ts","./node_modules/next/dist/client/components/unstable-rethrow.d.ts","./node_modules/next/dist/client/components/navigation.react-server.d.ts","./node_modules/next/dist/client/components/navigation.d.ts","./node_modules/next/navigation.d.ts","./node_modules/next/router.d.ts","./node_modules/next/dist/client/script.d.ts","./node_modules/next/script.d.ts","./node_modules/next/dist/server/web/spec-extension/user-agent.d.ts","./node_modules/next/dist/compiled/@edge-runtime/primitives/url.d.ts","./node_modules/next/dist/server/web/spec-extension/image-response.d.ts","./node_modules/next/dist/compiled/@vercel/og/satori/index.d.ts","./node_modules/next/dist/compiled/@vercel/og/emoji/index.d.ts","./node_modules/next/dist/compiled/@vercel/og/types.d.ts","./node_modules/next/dist/server/after/index.d.ts","./node_modules/next/dist/server/request/connection.d.ts","./node_modules/next/server.d.ts","./node_modules/next/types/global.d.ts","./node_modules/next/types/compiled.d.ts","./node_modules/next/types.d.ts","./node_modules/next/index.d.ts","./node_modules/next/image-types/global.d.ts","./.next/dev/types/routes.d.ts","./next-env.d.ts","./node_modules/next-intl/dist/types/extractor/types.d.ts","./node_modules/next-intl/dist/types/extractor/format/ExtractorCodec.d.ts","./node_modules/next-intl/dist/types/extractor/format/codecs/JSONCodec.d.ts","./node_modules/next-intl/dist/types/extractor/format/codecs/POCodec.d.ts","./node_modules/next-intl/dist/types/extractor/format/index.d.ts","./node_modules/next-intl/dist/types/extractor/format/types.d.ts","./node_modules/next-intl/dist/types/plugin/types.d.ts","./node_modules/next-intl/dist/types/plugin/createNextIntlPlugin.d.ts","./node_modules/next-intl/dist/types/plugin/index.d.ts","./node_modules/next-intl/dist/types/plugin.d.ts","./next.config.ts","./node_modules/dotenv/config.d.ts","./node_modules/@prisma/config/dist/index.d.ts","./node_modules/prisma/config.d.ts","./prisma.config.ts","./node_modules/@vitest/pretty-format/dist/index.d.ts","./node_modules/@vitest/utils/dist/display.d.ts","./node_modules/@vitest/utils/dist/types.d.ts","./node_modules/@vitest/utils/dist/helpers.d.ts","./node_modules/@vitest/utils/dist/timers.d.ts","./node_modules/@vitest/utils/dist/index.d.ts","./node_modules/@vitest/runner/dist/tasks.d-C7UxawJ9.d.ts","./node_modules/@vitest/utils/dist/types.d-BCElaP-c.d.ts","./node_modules/@vitest/utils/dist/diff.d.ts","./node_modules/@vitest/runner/dist/types.d.ts","./node_modules/@vitest/runner/dist/index.d.ts","./node_modules/@vitest/spy/dist/index.d.ts","./node_modules/tinyrainbow/dist/index.d.ts","./node_modules/@standard-schema/spec/dist/index.d.ts","./node_modules/@types/deep-eql/index.d.ts","./node_modules/assertion-error/index.d.ts","./node_modules/@types/chai/index.d.ts","./node_modules/@vitest/expect/dist/index.d.ts","./node_modules/vite/types/hmrPayload.d.ts","./node_modules/vite/dist/node/chunks/moduleRunnerTransport.d.ts","./node_modules/vite/types/customEvent.d.ts","./node_modules/@types/estree/index.d.ts","./node_modules/rollup/dist/rollup.d.ts","./node_modules/rollup/dist/parseAst.d.ts","./node_modules/vite/types/hot.d.ts","./node_modules/vite/dist/node/module-runner.d.ts","./node_modules/vite/node_modules/esbuild/lib/main.d.ts","./node_modules/vite/types/internal/terserOptions.d.ts","./node_modules/source-map-js/source-map.d.ts","./node_modules/postcss/lib/previous-map.d.ts","./node_modules/postcss/lib/input.d.ts","./node_modules/postcss/lib/css-syntax-error.d.ts","./node_modules/postcss/lib/declaration.d.ts","./node_modules/postcss/lib/root.d.ts","./node_modules/postcss/lib/warning.d.ts","./node_modules/postcss/lib/lazy-result.d.ts","./node_modules/postcss/lib/no-work-result.d.ts","./node_modules/postcss/lib/processor.d.ts","./node_modules/postcss/lib/result.d.ts","./node_modules/postcss/lib/document.d.ts","./node_modules/postcss/lib/rule.d.ts","./node_modules/postcss/lib/node.d.ts","./node_modules/postcss/lib/comment.d.ts","./node_modules/postcss/lib/container.d.ts","./node_modules/postcss/lib/at-rule.d.ts","./node_modules/postcss/lib/list.d.ts","./node_modules/postcss/lib/postcss.d.ts","./node_modules/postcss/lib/postcss.d.mts","./node_modules/vite/types/internal/cssPreprocessorOptions.d.ts","./node_modules/lightningcss/node/ast.d.ts","./node_modules/lightningcss/node/targets.d.ts","./node_modules/lightningcss/node/index.d.ts","./node_modules/vite/types/internal/lightningcssOptions.d.ts","./node_modules/vite/types/importGlob.d.ts","./node_modules/vite/types/metadata.d.ts","./node_modules/vite/dist/node/index.d.ts","./node_modules/@vitest/snapshot/dist/environment.d-DHdQ1Csl.d.ts","./node_modules/@vitest/snapshot/dist/rawSnapshot.d-lFsMJFUd.d.ts","./node_modules/@vitest/snapshot/dist/index.d.ts","./node_modules/vitest/dist/chunks/traces.d.402V_yFI.d.ts","./node_modules/vitest/dist/chunks/rpc.d.RH3apGEf.d.ts","./node_modules/vitest/dist/chunks/config.d.Cy95HiCx.d.ts","./node_modules/vitest/dist/chunks/environment.d.CrsxCzP1.d.ts","./node_modules/vitest/dist/chunks/worker.d.Dyxm8DEL.d.ts","./node_modules/vitest/dist/chunks/browser.d.ChKACdzH.d.ts","./node_modules/@vitest/mocker/dist/types.d-B8CCKmHt.d.ts","./node_modules/@vitest/mocker/dist/index.d-C-sLYZi-.d.ts","./node_modules/@vitest/mocker/dist/index.d.ts","./node_modules/@vitest/utils/dist/source-map.d.ts","./node_modules/vitest/dist/chunks/coverage.d.BZtK59WP.d.ts","./node_modules/@vitest/utils/dist/serialize.d.ts","./node_modules/@vitest/utils/dist/error.d.ts","./node_modules/vitest/dist/browser.d.ts","./node_modules/vitest/browser/context.d.ts","./node_modules/vitest/optional-types.d.ts","./node_modules/@vitest/runner/dist/utils.d.ts","./node_modules/tinybench/dist/index.d.ts","./node_modules/vitest/dist/chunks/benchmark.d.DAaHLpsq.d.ts","./node_modules/@vitest/snapshot/dist/manager.d.ts","./node_modules/vitest/dist/chunks/reporters.d.CWXNI2jG.d.ts","./node_modules/vitest/dist/chunks/plugin.d.CtqpEehP.d.ts","./node_modules/vitest/dist/config.d.ts","./node_modules/vitest/config.d.ts","./vitest.config.ts","./node_modules/@prisma/client-runtime-utils/dist/index.d.ts","./node_modules/@prisma/client/runtime/client.d.ts","./node_modules/.prisma/client/index.d.ts","./node_modules/.prisma/client/default.d.ts","./node_modules/@prisma/client/default.d.ts","./prisma/seed-client.ts","./node_modules/pg-types/index.d.ts","./node_modules/pg-protocol/dist/messages.d.ts","./node_modules/pg-protocol/dist/serializer.d.ts","./node_modules/pg-protocol/dist/parser.d.ts","./node_modules/pg-protocol/dist/index.d.ts","./node_modules/@types/pg/lib/type-overrides.d.ts","./node_modules/@types/pg/index.d.ts","./node_modules/@types/pg/index.d.mts","./node_modules/@prisma/debug/dist/index.d.mts","./node_modules/@prisma/driver-adapter-utils/dist/index.d.mts","./node_modules/@prisma/adapter-pg/dist/index.d.mts","./prisma/seed-demo.ts","./node_modules/bcryptjs/types.d.ts","./node_modules/bcryptjs/index.d.ts","./prisma/seed-dev-users.ts","./prisma/seed.ts","./node_modules/next-intl/dist/types/routing/types.d.ts","./node_modules/next-intl/dist/types/routing/config.d.ts","./node_modules/next-intl/dist/types/middleware/middleware.d.ts","./node_modules/next-intl/dist/types/middleware/index.d.ts","./node_modules/next-intl/dist/types/middleware.d.ts","./node_modules/next-intl/dist/types/routing/defineRouting.d.ts","./node_modules/next-intl/dist/types/routing/index.d.ts","./node_modules/next-intl/dist/types/routing.d.ts","./node_modules/use-intl/dist/types/core/AbstractIntlMessages.d.ts","./node_modules/use-intl/dist/types/core/TranslationValues.d.ts","./node_modules/use-intl/dist/types/core/TimeZone.d.ts","./node_modules/use-intl/dist/types/core/DateTimeFormatOptions.d.ts","./node_modules/@formatjs/ecma402-abstract/CanonicalizeLocaleList.d.ts","./node_modules/@formatjs/ecma402-abstract/CanonicalizeTimeZoneName.d.ts","./node_modules/@formatjs/ecma402-abstract/CoerceOptionsToObject.d.ts","./node_modules/@formatjs/ecma402-abstract/GetNumberOption.d.ts","./node_modules/@formatjs/ecma402-abstract/GetOption.d.ts","./node_modules/@formatjs/ecma402-abstract/GetOptionsObject.d.ts","./node_modules/@formatjs/ecma402-abstract/GetStringOrBooleanOption.d.ts","./node_modules/@formatjs/ecma402-abstract/IsSanctionedSimpleUnitIdentifier.d.ts","./node_modules/@formatjs/ecma402-abstract/IsValidTimeZoneName.d.ts","./node_modules/@formatjs/ecma402-abstract/IsWellFormedCurrencyCode.d.ts","./node_modules/@formatjs/ecma402-abstract/IsWellFormedUnitIdentifier.d.ts","./node_modules/decimal.js/decimal.d.ts","./node_modules/@formatjs/ecma402-abstract/types/core.d.ts","./node_modules/@formatjs/ecma402-abstract/types/plural-rules.d.ts","./node_modules/@formatjs/ecma402-abstract/types/number.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/ApplyUnsignedRoundingMode.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/CollapseNumberRange.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/ComputeExponent.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/ComputeExponentForMagnitude.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/CurrencyDigits.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/format_to_parts.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/FormatApproximately.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/FormatNumeric.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/FormatNumericRange.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/FormatNumericRangeToParts.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/FormatNumericToParts.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/FormatNumericToString.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/GetUnsignedRoundingMode.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/InitializeNumberFormat.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/PartitionNumberPattern.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/PartitionNumberRangePattern.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/SetNumberFormatDigitOptions.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/SetNumberFormatUnitOptions.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/ToRawFixed.d.ts","./node_modules/@formatjs/ecma402-abstract/NumberFormat/ToRawPrecision.d.ts","./node_modules/@formatjs/ecma402-abstract/PartitionPattern.d.ts","./node_modules/@formatjs/ecma402-abstract/SupportedLocales.d.ts","./node_modules/@formatjs/ecma402-abstract/utils.d.ts","./node_modules/@formatjs/ecma402-abstract/262.d.ts","./node_modules/@formatjs/ecma402-abstract/data.d.ts","./node_modules/@formatjs/ecma402-abstract/types/date-time.d.ts","./node_modules/@formatjs/ecma402-abstract/types/displaynames.d.ts","./node_modules/@formatjs/ecma402-abstract/types/list.d.ts","./node_modules/@formatjs/ecma402-abstract/types/relative-time.d.ts","./node_modules/@formatjs/ecma402-abstract/constants.d.ts","./node_modules/@formatjs/ecma402-abstract/ToIntlMathematicalValue.d.ts","./node_modules/@formatjs/ecma402-abstract/index.d.ts","./node_modules/@formatjs/icu-skeleton-parser/date-time.d.ts","./node_modules/@formatjs/icu-skeleton-parser/number.d.ts","./node_modules/@formatjs/icu-skeleton-parser/index.d.ts","./node_modules/@formatjs/icu-messageformat-parser/types.d.ts","./node_modules/@formatjs/icu-messageformat-parser/error.d.ts","./node_modules/@formatjs/icu-messageformat-parser/parser.d.ts","./node_modules/@formatjs/icu-messageformat-parser/manipulator.d.ts","./node_modules/@formatjs/icu-messageformat-parser/index.d.ts","./node_modules/intl-messageformat/src/formatters.d.ts","./node_modules/intl-messageformat/src/core.d.ts","./node_modules/intl-messageformat/src/error.d.ts","./node_modules/intl-messageformat/index.d.ts","./node_modules/use-intl/dist/types/core/NumberFormatOptions.d.ts","./node_modules/use-intl/dist/types/core/Formats.d.ts","./node_modules/use-intl/dist/types/core/AppConfig.d.ts","./node_modules/use-intl/dist/types/core/IntlErrorCode.d.ts","./node_modules/use-intl/dist/types/core/IntlError.d.ts","./node_modules/use-intl/dist/types/core/types.d.ts","./node_modules/use-intl/dist/types/core/IntlConfig.d.ts","./node_modules/@schummar/icu-type-parser/dist/index.d.ts","./node_modules/use-intl/dist/types/core/ICUArgs.d.ts","./node_modules/use-intl/dist/types/core/ICUTags.d.ts","./node_modules/use-intl/dist/types/core/MessageKeys.d.ts","./node_modules/use-intl/dist/types/core/formatters.d.ts","./node_modules/use-intl/dist/types/core/createTranslator.d.ts","./node_modules/use-intl/dist/types/core/RelativeTimeFormatOptions.d.ts","./node_modules/use-intl/dist/types/core/createFormatter.d.ts","./node_modules/use-intl/dist/types/core/initializeConfig.d.ts","./node_modules/use-intl/dist/types/core/hasLocale.d.ts","./node_modules/use-intl/dist/types/core/index.d.ts","./node_modules/use-intl/dist/types/core.d.ts","./node_modules/use-intl/dist/types/react/IntlProvider.d.ts","./node_modules/use-intl/dist/types/react/useTranslations.d.ts","./node_modules/use-intl/dist/types/react/useLocale.d.ts","./node_modules/use-intl/dist/types/react/useNow.d.ts","./node_modules/use-intl/dist/types/react/useTimeZone.d.ts","./node_modules/use-intl/dist/types/react/useMessages.d.ts","./node_modules/use-intl/dist/types/react/useFormatter.d.ts","./node_modules/use-intl/dist/types/react/useExtracted.d.ts","./node_modules/use-intl/dist/types/react/index.d.ts","./node_modules/use-intl/dist/types/react.d.ts","./node_modules/use-intl/dist/types/index.d.ts","./node_modules/next-intl/dist/types/navigation/shared/StrictParams.d.ts","./node_modules/next-intl/dist/types/navigation/shared/utils.d.ts","./node_modules/next-intl/dist/types/navigation/react-client/createNavigation.d.ts","./node_modules/next-intl/dist/types/navigation/react-client/index.d.ts","./node_modules/next-intl/dist/types/navigation.react-client.d.ts","./src/lib/i18n/routing.ts","./src/middleware.ts","./src/__tests__/helpers/index.ts","./node_modules/vitest/dist/chunks/global.d.B15mdLcR.d.ts","./node_modules/vitest/dist/chunks/suite.d.BJWk38HB.d.ts","./node_modules/vitest/dist/chunks/evaluatedModules.d.BxJ5omdx.d.ts","./node_modules/expect-type/dist/utils.d.ts","./node_modules/expect-type/dist/overloads.d.ts","./node_modules/expect-type/dist/branding.d.ts","./node_modules/expect-type/dist/messages.d.ts","./node_modules/expect-type/dist/index.d.ts","./node_modules/vitest/dist/index.d.ts","./src/__tests__/integration/assessment-workflow.test.ts","./node_modules/zod/v4/core/json-schema.d.cts","./node_modules/zod/v4/core/standard-schema.d.cts","./node_modules/zod/v4/core/registries.d.cts","./node_modules/zod/v4/core/to-json-schema.d.cts","./node_modules/zod/v4/core/util.d.cts","./node_modules/zod/v4/core/versions.d.cts","./node_modules/zod/v4/core/schemas.d.cts","./node_modules/zod/v4/core/checks.d.cts","./node_modules/zod/v4/core/errors.d.cts","./node_modules/zod/v4/core/core.d.cts","./node_modules/zod/v4/core/parse.d.cts","./node_modules/zod/v4/core/regexes.d.cts","./node_modules/zod/v4/locales/ar.d.cts","./node_modules/zod/v4/locales/az.d.cts","./node_modules/zod/v4/locales/be.d.cts","./node_modules/zod/v4/locales/bg.d.cts","./node_modules/zod/v4/locales/ca.d.cts","./node_modules/zod/v4/locales/cs.d.cts","./node_modules/zod/v4/locales/da.d.cts","./node_modules/zod/v4/locales/de.d.cts","./node_modules/zod/v4/locales/en.d.cts","./node_modules/zod/v4/locales/eo.d.cts","./node_modules/zod/v4/locales/es.d.cts","./node_modules/zod/v4/locales/fa.d.cts","./node_modules/zod/v4/locales/fi.d.cts","./node_modules/zod/v4/locales/fr.d.cts","./node_modules/zod/v4/locales/fr-CA.d.cts","./node_modules/zod/v4/locales/he.d.cts","./node_modules/zod/v4/locales/hu.d.cts","./node_modules/zod/v4/locales/hy.d.cts","./node_modules/zod/v4/locales/id.d.cts","./node_modules/zod/v4/locales/is.d.cts","./node_modules/zod/v4/locales/it.d.cts","./node_modules/zod/v4/locales/ja.d.cts","./node_modules/zod/v4/locales/ka.d.cts","./node_modules/zod/v4/locales/kh.d.cts","./node_modules/zod/v4/locales/km.d.cts","./node_modules/zod/v4/locales/ko.d.cts","./node_modules/zod/v4/locales/lt.d.cts","./node_modules/zod/v4/locales/mk.d.cts","./node_modules/zod/v4/locales/ms.d.cts","./node_modules/zod/v4/locales/nl.d.cts","./node_modules/zod/v4/locales/no.d.cts","./node_modules/zod/v4/locales/ota.d.cts","./node_modules/zod/v4/locales/ps.d.cts","./node_modules/zod/v4/locales/pl.d.cts","./node_modules/zod/v4/locales/pt.d.cts","./node_modules/zod/v4/locales/ru.d.cts","./node_modules/zod/v4/locales/sl.d.cts","./node_modules/zod/v4/locales/sv.d.cts","./node_modules/zod/v4/locales/ta.d.cts","./node_modules/zod/v4/locales/th.d.cts","./node_modules/zod/v4/locales/tr.d.cts","./node_modules/zod/v4/locales/ua.d.cts","./node_modules/zod/v4/locales/uk.d.cts","./node_modules/zod/v4/locales/ur.d.cts","./node_modules/zod/v4/locales/uz.d.cts","./node_modules/zod/v4/locales/vi.d.cts","./node_modules/zod/v4/locales/zh-CN.d.cts","./node_modules/zod/v4/locales/zh-TW.d.cts","./node_modules/zod/v4/locales/yo.d.cts","./node_modules/zod/v4/locales/index.d.cts","./node_modules/zod/v4/core/doc.d.cts","./node_modules/zod/v4/core/api.d.cts","./node_modules/zod/v4/core/json-schema-processors.d.cts","./node_modules/zod/v4/core/json-schema-generator.d.cts","./node_modules/zod/v4/core/index.d.cts","./node_modules/zod/v4/classic/errors.d.cts","./node_modules/zod/v4/classic/parse.d.cts","./node_modules/zod/v4/classic/schemas.d.cts","./node_modules/zod/v4/classic/checks.d.cts","./node_modules/zod/v4/classic/compat.d.cts","./node_modules/zod/v4/classic/from-json-schema.d.cts","./node_modules/zod/v4/classic/iso.d.cts","./node_modules/zod/v4/classic/coerce.d.cts","./node_modules/zod/v4/classic/external.d.cts","./node_modules/zod/index.d.cts","./src/lib/questionnaire/types.ts","./src/lib/questionnaire/constants.ts","./src/__tests__/questionnaire/constants.test.ts","./src/__tests__/questionnaire/types.test.ts","./src/lib/assessment/types.ts","./src/lib/assessment/constants.ts","./src/lib/constants/scoring.ts","./src/__tests__/unit/bilingual.test.ts","./src/lib/assessment/scoring.ts","./src/__tests__/unit/scoring.test.ts","./node_modules/next-auth/node_modules/@auth/core/lib/symbols.d.ts","./node_modules/next-auth/node_modules/@auth/core/lib/index.d.ts","./node_modules/next-auth/node_modules/@auth/core/lib/vendored/cookie.d.ts","./node_modules/oauth4webapi/build/index.d.ts","./node_modules/next-auth/node_modules/@auth/core/lib/utils/cookie.d.ts","./node_modules/next-auth/node_modules/@auth/core/warnings.d.ts","./node_modules/next-auth/node_modules/@auth/core/lib/utils/logger.d.ts","./node_modules/preact/src/jsx.d.ts","./node_modules/preact/src/index.d.ts","./node_modules/next-auth/node_modules/@auth/core/providers/credentials.d.ts","./node_modules/next-auth/node_modules/@auth/core/providers/provider-types.d.ts","./node_modules/next-auth/node_modules/@auth/core/providers/nodemailer.d.ts","./node_modules/next-auth/node_modules/@auth/core/providers/email.d.ts","./node_modules/next-auth/node_modules/@auth/core/providers/oauth.d.ts","./node_modules/next-auth/node_modules/@auth/core/providers/webauthn.d.ts","./node_modules/next-auth/node_modules/@auth/core/providers/index.d.ts","./node_modules/next-auth/node_modules/@auth/core/adapters.d.ts","./node_modules/next-auth/node_modules/@auth/core/lib/utils/webauthn-utils.d.ts","./node_modules/next-auth/node_modules/@auth/core/types.d.ts","./node_modules/next-auth/node_modules/@auth/core/lib/utils/env.d.ts","./node_modules/next-auth/node_modules/@auth/core/jwt.d.ts","./node_modules/next-auth/node_modules/@auth/core/lib/utils/actions.d.ts","./node_modules/next-auth/node_modules/@auth/core/index.d.ts","./node_modules/next-auth/lib/types.d.ts","./node_modules/next-auth/lib/index.d.ts","./node_modules/next-auth/node_modules/@auth/core/errors.d.ts","./node_modules/next-auth/index.d.ts","./node_modules/next-auth/providers/credentials.d.ts","./src/lib/db/index.ts","./src/lib/auth/config.ts","./src/lib/auth/index.ts","./src/app/api/auth/[...nextauth]/route.ts","./src/app/api/auth/register/route.ts","./node_modules/@trpc/server/dist/index.d-D4qZxQJh.d.mts","./node_modules/@trpc/server/dist/unstable-core-do-not-import.d-CjQPvBRI.d.mts","./node_modules/@trpc/server/dist/index.d-vq_QHko2.d.mts","./node_modules/@trpc/server/dist/adapters/fetch/index.d.mts","./node_modules/@trpc/server/dist/index.d.mts","./node_modules/superjson/dist/transformer.d.ts","./node_modules/superjson/dist/plainer.d.ts","./node_modules/superjson/dist/types.d.ts","./node_modules/superjson/dist/registry.d.ts","./node_modules/superjson/dist/class-registry.d.ts","./node_modules/superjson/dist/custom-transformer-registry.d.ts","./node_modules/superjson/dist/index.d.ts","./src/server/trpc/context.ts","./src/server/trpc/trpc.ts","./src/server/trpc/routers/questionnaire.ts","./src/lib/questionnaire/import-schema.ts","./src/lib/questionnaire/import-parser.ts","./src/server/trpc/routers/admin/questionnaire.ts","./src/server/trpc/routers/admin/index.ts","./src/lib/assessment/schemas.ts","./src/lib/assessment/progress.ts","./src/lib/assessment/index.ts","./src/server/trpc/routers/assessment.ts","./src/lib/validations/response.ts","./src/server/services/response.service.ts","./src/server/trpc/routers/response.ts","./src/server/services/scoring.service.ts","./src/server/trpc/routers/scoring.ts","./src/server/services/document.service.ts","./src/server/trpc/routers/document.ts","./src/server/services/progress.service.ts","./src/server/trpc/routers/progress.ts","./src/server/trpc/routers/_app.ts","./src/app/api/trpc/[trpc]/route.ts","./src/app/api/upload/route.ts","./src/app/api/upload/[filename]/route.ts","./node_modules/next-intl/dist/types/shared/NextIntlClientProvider.d.ts","./node_modules/next-intl/dist/types/react-client/index.d.ts","./node_modules/next-intl/dist/types/index.react-client.d.ts","./node_modules/lucide-react/dist/lucide-react.d.ts","./node_modules/clsx/clsx.d.mts","./node_modules/tailwind-merge/dist/types.d.ts","./src/lib/utils.ts","./node_modules/@radix-ui/react-slot/dist/index.d.mts","./node_modules/class-variance-authority/dist/types.d.ts","./node_modules/class-variance-authority/dist/index.d.ts","./src/components/ui/button.tsx","./src/components/ui/input.tsx","./node_modules/@radix-ui/react-label/node_modules/@radix-ui/react-primitive/dist/index.d.mts","./node_modules/@radix-ui/react-label/dist/index.d.mts","./src/components/ui/label.tsx","./src/components/ui/textarea.tsx","./node_modules/@radix-ui/react-context/dist/index.d.mts","./node_modules/@radix-ui/react-primitive/dist/index.d.mts","./node_modules/@radix-ui/react-dismissable-layer/dist/index.d.mts","./node_modules/@radix-ui/react-focus-scope/dist/index.d.mts","./node_modules/@radix-ui/react-arrow/dist/index.d.mts","./node_modules/@radix-ui/rect/dist/index.d.mts","./node_modules/@radix-ui/react-popper/dist/index.d.mts","./node_modules/@radix-ui/react-portal/dist/index.d.mts","./node_modules/@radix-ui/react-select/dist/index.d.mts","./src/components/ui/select.tsx","./node_modules/@radix-ui/react-dialog/dist/index.d.mts","./src/components/ui/dialog.tsx","./node_modules/@radix-ui/react-progress/node_modules/@radix-ui/react-context/dist/index.d.mts","./node_modules/@radix-ui/react-progress/node_modules/@radix-ui/react-primitive/dist/index.d.mts","./node_modules/@radix-ui/react-progress/dist/index.d.mts","./src/components/ui/progress.tsx","./src/components/ui/alert.tsx","./node_modules/@trpc/client/dist/subscriptions.d-Dlr1nWGD.d.mts","./node_modules/@trpc/server/dist/observable/index.d.mts","./node_modules/@trpc/server/dist/unstable-core-do-not-import.d.mts","./node_modules/@trpc/client/dist/types.d-ByL4iq_b.d.mts","./node_modules/@trpc/client/dist/unstable-internals.d-BOmV7EK1.d.mts","./node_modules/@trpc/client/dist/httpUtils.d-BordpgU5.d.mts","./node_modules/@trpc/client/dist/httpBatchLink.d-VqJm9adv.d.mts","./node_modules/@trpc/client/dist/httpLink.d-Cw8WgV_O.d.mts","./node_modules/@trpc/client/dist/loggerLink.d-DNZv9tYh.d.mts","./node_modules/@trpc/client/dist/splitLink.d-BQlbH9vp.d.mts","./node_modules/@trpc/server/dist/http.d.mts","./node_modules/@trpc/client/dist/wsLink.d-em3USiMI.d.mts","./node_modules/@trpc/client/dist/index.d.mts","./node_modules/@tanstack/query-core/build/modern/subscribable.d.ts","./node_modules/@tanstack/query-core/build/modern/focusManager.d.ts","./node_modules/@tanstack/query-core/build/modern/removable.d.ts","./node_modules/@tanstack/query-core/build/modern/hydration-C-jfQLut.d.ts","./node_modules/@tanstack/query-core/build/modern/infiniteQueryObserver.d.ts","./node_modules/@tanstack/query-core/build/modern/notifyManager.d.ts","./node_modules/@tanstack/query-core/build/modern/onlineManager.d.ts","./node_modules/@tanstack/query-core/build/modern/queriesObserver.d.ts","./node_modules/@tanstack/query-core/build/modern/timeoutManager.d.ts","./node_modules/@tanstack/query-core/build/modern/streamedQuery.d.ts","./node_modules/@tanstack/query-core/build/modern/index.d.ts","./node_modules/@tanstack/react-query/build/modern/types.d.ts","./node_modules/@tanstack/react-query/build/modern/useQueries.d.ts","./node_modules/@tanstack/react-query/build/modern/queryOptions.d.ts","./node_modules/@tanstack/react-query/build/modern/useQuery.d.ts","./node_modules/@tanstack/react-query/build/modern/useSuspenseQuery.d.ts","./node_modules/@tanstack/react-query/build/modern/useSuspenseInfiniteQuery.d.ts","./node_modules/@tanstack/react-query/build/modern/useSuspenseQueries.d.ts","./node_modules/@tanstack/react-query/build/modern/usePrefetchQuery.d.ts","./node_modules/@tanstack/react-query/build/modern/usePrefetchInfiniteQuery.d.ts","./node_modules/@tanstack/react-query/build/modern/infiniteQueryOptions.d.ts","./node_modules/@tanstack/react-query/build/modern/QueryClientProvider.d.ts","./node_modules/@tanstack/react-query/build/modern/QueryErrorResetBoundary.d.ts","./node_modules/@tanstack/react-query/build/modern/HydrationBoundary.d.ts","./node_modules/@tanstack/react-query/build/modern/useIsFetching.d.ts","./node_modules/@tanstack/react-query/build/modern/useMutationState.d.ts","./node_modules/@tanstack/react-query/build/modern/useMutation.d.ts","./node_modules/@tanstack/react-query/build/modern/mutationOptions.d.ts","./node_modules/@tanstack/react-query/build/modern/useInfiniteQuery.d.ts","./node_modules/@tanstack/react-query/build/modern/IsRestoringProvider.d.ts","./node_modules/@tanstack/react-query/build/modern/index.d.ts","./node_modules/@trpc/react-query/dist/getQueryKey.d-CruH3ncI.d.mts","./node_modules/@trpc/react-query/dist/index.d.mts","./src/lib/trpc/client.ts","./src/components/features/document/EvidenceUpload.tsx","./src/components/ui/badge.tsx","./src/components/features/document/DocumentPreview.tsx","./node_modules/@radix-ui/react-checkbox/dist/index.d.mts","./src/components/ui/checkbox.tsx","./node_modules/@radix-ui/react-scroll-area/dist/index.d.mts","./src/components/ui/scroll-area.tsx","./src/components/features/document/DocumentLibrary.tsx","./src/components/features/document/index.ts","./src/components/ui/card.tsx","./src/components/features/questionnaire/questionnaire-type-card.tsx","./src/components/features/questionnaire/language-toggle.tsx","./src/components/features/questionnaire/amendment-badge.tsx","./src/components/features/questionnaire/icao-reference-list.tsx","./node_modules/@radix-ui/react-separator/node_modules/@radix-ui/react-primitive/dist/index.d.mts","./node_modules/@radix-ui/react-separator/dist/index.d.mts","./src/components/ui/separator.tsx","./src/components/features/questionnaire/question-detail-modal.tsx","./node_modules/@radix-ui/react-collapsible/dist/index.d.mts","./node_modules/@radix-ui/react-accordion/dist/index.d.mts","./src/components/ui/accordion.tsx","./node_modules/@radix-ui/react-switch/dist/index.d.mts","./src/components/ui/switch.tsx","./src/components/ui/sheet.tsx","./src/components/features/questionnaire/ans/audit-area-filter.tsx","./src/components/features/questionnaire/ans/critical-element-filter.tsx","./src/components/ui/pagination.tsx","./src/components/ui/collapsible.tsx","./src/components/features/questionnaire/ans/pq-card.tsx","./src/components/features/questionnaire/ans/pq-list.tsx","./src/components/features/questionnaire/ans/ans-browser.tsx","./src/components/ui/skeleton.tsx","./src/components/features/questionnaire/ans/ans-browser-skeleton.tsx","./src/components/features/questionnaire/ans/index.ts","./src/components/features/questionnaire/sms/component-tabs.tsx","./node_modules/@radix-ui/react-tooltip/dist/index.d.mts","./src/components/ui/tooltip.tsx","./src/components/features/questionnaire/sms/transversal-badge.tsx","./src/components/features/questionnaire/sms/maturity-legend.tsx","./src/components/features/questionnaire/sms/maturity-table.tsx","./src/components/features/questionnaire/sms/study-area-accordion.tsx","./src/components/features/questionnaire/sms/sms-browser.tsx","./src/components/features/questionnaire/sms/sms-browser-skeleton.tsx","./src/components/features/questionnaire/sms/index.ts","./src/components/features/questionnaire/index.ts","./node_modules/motion-utils/dist/index.d.ts","./node_modules/motion-dom/dist/index.d.ts","./node_modules/framer-motion/dist/types.d-CQ4vRM6h.d.ts","./node_modules/framer-motion/dist/types/index.d.ts","./src/components/features/scoring/ei-score-display.tsx","./src/components/features/scoring/sms-maturity-display.tsx","./src/components/features/scoring/score-breakdown-chart.tsx","./src/components/features/scoring/index.ts","./src/hooks/useAutoSave.ts","./src/lib/auth/permissions.ts","./src/lib/auth/rbac.ts","./src/lib/auth/types.ts","./node_modules/next-intl/dist/types/server/react-server/getRequestConfig.d.ts","./node_modules/next-intl/dist/types/server/react-server/getFormatter.d.ts","./node_modules/next-intl/dist/types/server/react-server/getNow.d.ts","./node_modules/next-intl/dist/types/server/react-server/getTimeZone.d.ts","./node_modules/next-intl/dist/types/server/react-server/getTranslations.d.ts","./node_modules/next-intl/dist/types/server/react-server/getServerExtractor.d.ts","./node_modules/next-intl/dist/types/server/react-server/getExtracted.d.ts","./node_modules/next-intl/dist/types/server/react-server/getConfig.d.ts","./node_modules/next-intl/dist/types/server/react-server/getMessages.d.ts","./node_modules/next-intl/dist/types/server/react-server/getLocale.d.ts","./node_modules/next-intl/dist/types/server/react-server/RequestLocaleCache.d.ts","./node_modules/next-intl/dist/types/server/react-server/index.d.ts","./node_modules/next-intl/dist/types/server.react-server.d.ts","./src/lib/i18n/request.ts","./src/lib/questionnaire/index.ts","./src/lib/trpc/provider.tsx","./src/lib/trpc/index.ts","./src/lib/utils/cn.ts","./src/server/trpc/index.ts","./src/types/index.ts","./src/app/layout.tsx","./src/app/page.tsx","./src/app/[locale]/layout.tsx","./src/app/[locale]/page.tsx","./src/app/[locale]/(auth)/layout.tsx","./node_modules/next-auth/lib/client.d.ts","./node_modules/next-auth/react.d.ts","./node_modules/react-hook-form/dist/constants.d.ts","./node_modules/react-hook-form/dist/utils/createSubject.d.ts","./node_modules/react-hook-form/dist/types/events.d.ts","./node_modules/react-hook-form/dist/types/path/common.d.ts","./node_modules/react-hook-form/dist/types/path/eager.d.ts","./node_modules/react-hook-form/dist/types/path/index.d.ts","./node_modules/react-hook-form/dist/types/fieldArray.d.ts","./node_modules/react-hook-form/dist/types/resolvers.d.ts","./node_modules/react-hook-form/dist/types/form.d.ts","./node_modules/react-hook-form/dist/types/utils.d.ts","./node_modules/react-hook-form/dist/types/fields.d.ts","./node_modules/react-hook-form/dist/types/errors.d.ts","./node_modules/react-hook-form/dist/types/validator.d.ts","./node_modules/react-hook-form/dist/types/controller.d.ts","./node_modules/react-hook-form/dist/types/watch.d.ts","./node_modules/react-hook-form/dist/types/index.d.ts","./node_modules/react-hook-form/dist/controller.d.ts","./node_modules/react-hook-form/dist/form.d.ts","./node_modules/react-hook-form/dist/formStateSubscribe.d.ts","./node_modules/react-hook-form/dist/logic/appendErrors.d.ts","./node_modules/react-hook-form/dist/logic/createFormControl.d.ts","./node_modules/react-hook-form/dist/logic/index.d.ts","./node_modules/react-hook-form/dist/useController.d.ts","./node_modules/react-hook-form/dist/useFieldArray.d.ts","./node_modules/react-hook-form/dist/useForm.d.ts","./node_modules/react-hook-form/dist/useFormContext.d.ts","./node_modules/react-hook-form/dist/useFormState.d.ts","./node_modules/react-hook-form/dist/useWatch.d.ts","./node_modules/react-hook-form/dist/utils/get.d.ts","./node_modules/react-hook-form/dist/utils/set.d.ts","./node_modules/react-hook-form/dist/utils/index.d.ts","./node_modules/react-hook-form/dist/watch.d.ts","./node_modules/react-hook-form/dist/index.d.ts","./node_modules/zod/v3/helpers/typeAliases.d.cts","./node_modules/zod/v3/helpers/util.d.cts","./node_modules/zod/v3/ZodError.d.cts","./node_modules/zod/v3/locales/en.d.cts","./node_modules/zod/v3/errors.d.cts","./node_modules/zod/v3/helpers/parseUtil.d.cts","./node_modules/zod/v3/helpers/enumUtil.d.cts","./node_modules/zod/v3/helpers/errorUtil.d.cts","./node_modules/zod/v3/helpers/partialUtil.d.cts","./node_modules/zod/v3/standard-schema.d.cts","./node_modules/zod/v3/types.d.cts","./node_modules/zod/v3/external.d.cts","./node_modules/zod/v3/index.d.cts","./node_modules/@hookform/resolvers/zod/dist/zod.d.ts","./node_modules/@hookform/resolvers/zod/dist/index.d.ts","./src/app/[locale]/(auth)/login/page.tsx","./src/app/[locale]/(auth)/register/page.tsx","./src/app/[locale]/(auth)/unauthorized/page.tsx","./src/components/layout/sidebar.tsx","./node_modules/@radix-ui/react-roving-focus/dist/index.d.mts","./node_modules/@radix-ui/react-menu/dist/index.d.mts","./node_modules/@radix-ui/react-dropdown-menu/dist/index.d.mts","./src/components/ui/dropdown-menu.tsx","./node_modules/@radix-ui/react-avatar/node_modules/@radix-ui/react-context/dist/index.d.mts","./node_modules/@radix-ui/react-avatar/node_modules/@radix-ui/react-primitive/dist/index.d.mts","./node_modules/@radix-ui/react-avatar/dist/index.d.mts","./src/components/ui/avatar.tsx","./src/components/layout/header.tsx","./src/components/layout/app-shell.tsx","./src/components/providers/dashboard-providers.tsx","./src/app/[locale]/(dashboard)/layout.tsx","./node_modules/sonner/dist/index.d.mts","./node_modules/date-fns/constants.d.ts","./node_modules/date-fns/locale/types.d.ts","./node_modules/date-fns/fp/types.d.ts","./node_modules/date-fns/types.d.ts","./node_modules/date-fns/add.d.ts","./node_modules/date-fns/addBusinessDays.d.ts","./node_modules/date-fns/addDays.d.ts","./node_modules/date-fns/addHours.d.ts","./node_modules/date-fns/addISOWeekYears.d.ts","./node_modules/date-fns/addMilliseconds.d.ts","./node_modules/date-fns/addMinutes.d.ts","./node_modules/date-fns/addMonths.d.ts","./node_modules/date-fns/addQuarters.d.ts","./node_modules/date-fns/addSeconds.d.ts","./node_modules/date-fns/addWeeks.d.ts","./node_modules/date-fns/addYears.d.ts","./node_modules/date-fns/areIntervalsOverlapping.d.ts","./node_modules/date-fns/clamp.d.ts","./node_modules/date-fns/closestIndexTo.d.ts","./node_modules/date-fns/closestTo.d.ts","./node_modules/date-fns/compareAsc.d.ts","./node_modules/date-fns/compareDesc.d.ts","./node_modules/date-fns/constructFrom.d.ts","./node_modules/date-fns/constructNow.d.ts","./node_modules/date-fns/daysToWeeks.d.ts","./node_modules/date-fns/differenceInBusinessDays.d.ts","./node_modules/date-fns/differenceInCalendarDays.d.ts","./node_modules/date-fns/differenceInCalendarISOWeekYears.d.ts","./node_modules/date-fns/differenceInCalendarISOWeeks.d.ts","./node_modules/date-fns/differenceInCalendarMonths.d.ts","./node_modules/date-fns/differenceInCalendarQuarters.d.ts","./node_modules/date-fns/differenceInCalendarWeeks.d.ts","./node_modules/date-fns/differenceInCalendarYears.d.ts","./node_modules/date-fns/differenceInDays.d.ts","./node_modules/date-fns/differenceInHours.d.ts","./node_modules/date-fns/differenceInISOWeekYears.d.ts","./node_modules/date-fns/differenceInMilliseconds.d.ts","./node_modules/date-fns/differenceInMinutes.d.ts","./node_modules/date-fns/differenceInMonths.d.ts","./node_modules/date-fns/differenceInQuarters.d.ts","./node_modules/date-fns/differenceInSeconds.d.ts","./node_modules/date-fns/differenceInWeeks.d.ts","./node_modules/date-fns/differenceInYears.d.ts","./node_modules/date-fns/eachDayOfInterval.d.ts","./node_modules/date-fns/eachHourOfInterval.d.ts","./node_modules/date-fns/eachMinuteOfInterval.d.ts","./node_modules/date-fns/eachMonthOfInterval.d.ts","./node_modules/date-fns/eachQuarterOfInterval.d.ts","./node_modules/date-fns/eachWeekOfInterval.d.ts","./node_modules/date-fns/eachWeekendOfInterval.d.ts","./node_modules/date-fns/eachWeekendOfMonth.d.ts","./node_modules/date-fns/eachWeekendOfYear.d.ts","./node_modules/date-fns/eachYearOfInterval.d.ts","./node_modules/date-fns/endOfDay.d.ts","./node_modules/date-fns/endOfDecade.d.ts","./node_modules/date-fns/endOfHour.d.ts","./node_modules/date-fns/endOfISOWeek.d.ts","./node_modules/date-fns/endOfISOWeekYear.d.ts","./node_modules/date-fns/endOfMinute.d.ts","./node_modules/date-fns/endOfMonth.d.ts","./node_modules/date-fns/endOfQuarter.d.ts","./node_modules/date-fns/endOfSecond.d.ts","./node_modules/date-fns/endOfToday.d.ts","./node_modules/date-fns/endOfTomorrow.d.ts","./node_modules/date-fns/endOfWeek.d.ts","./node_modules/date-fns/endOfYear.d.ts","./node_modules/date-fns/endOfYesterday.d.ts","./node_modules/date-fns/_lib/format/formatters.d.ts","./node_modules/date-fns/_lib/format/longFormatters.d.ts","./node_modules/date-fns/format.d.ts","./node_modules/date-fns/formatDistance.d.ts","./node_modules/date-fns/formatDistanceStrict.d.ts","./node_modules/date-fns/formatDistanceToNow.d.ts","./node_modules/date-fns/formatDistanceToNowStrict.d.ts","./node_modules/date-fns/formatDuration.d.ts","./node_modules/date-fns/formatISO.d.ts","./node_modules/date-fns/formatISO9075.d.ts","./node_modules/date-fns/formatISODuration.d.ts","./node_modules/date-fns/formatRFC3339.d.ts","./node_modules/date-fns/formatRFC7231.d.ts","./node_modules/date-fns/formatRelative.d.ts","./node_modules/date-fns/fromUnixTime.d.ts","./node_modules/date-fns/getDate.d.ts","./node_modules/date-fns/getDay.d.ts","./node_modules/date-fns/getDayOfYear.d.ts","./node_modules/date-fns/getDaysInMonth.d.ts","./node_modules/date-fns/getDaysInYear.d.ts","./node_modules/date-fns/getDecade.d.ts","./node_modules/date-fns/_lib/defaultOptions.d.ts","./node_modules/date-fns/getDefaultOptions.d.ts","./node_modules/date-fns/getHours.d.ts","./node_modules/date-fns/getISODay.d.ts","./node_modules/date-fns/getISOWeek.d.ts","./node_modules/date-fns/getISOWeekYear.d.ts","./node_modules/date-fns/getISOWeeksInYear.d.ts","./node_modules/date-fns/getMilliseconds.d.ts","./node_modules/date-fns/getMinutes.d.ts","./node_modules/date-fns/getMonth.d.ts","./node_modules/date-fns/getOverlappingDaysInIntervals.d.ts","./node_modules/date-fns/getQuarter.d.ts","./node_modules/date-fns/getSeconds.d.ts","./node_modules/date-fns/getTime.d.ts","./node_modules/date-fns/getUnixTime.d.ts","./node_modules/date-fns/getWeek.d.ts","./node_modules/date-fns/getWeekOfMonth.d.ts","./node_modules/date-fns/getWeekYear.d.ts","./node_modules/date-fns/getWeeksInMonth.d.ts","./node_modules/date-fns/getYear.d.ts","./node_modules/date-fns/hoursToMilliseconds.d.ts","./node_modules/date-fns/hoursToMinutes.d.ts","./node_modules/date-fns/hoursToSeconds.d.ts","./node_modules/date-fns/interval.d.ts","./node_modules/date-fns/intervalToDuration.d.ts","./node_modules/date-fns/intlFormat.d.ts","./node_modules/date-fns/intlFormatDistance.d.ts","./node_modules/date-fns/isAfter.d.ts","./node_modules/date-fns/isBefore.d.ts","./node_modules/date-fns/isDate.d.ts","./node_modules/date-fns/isEqual.d.ts","./node_modules/date-fns/isExists.d.ts","./node_modules/date-fns/isFirstDayOfMonth.d.ts","./node_modules/date-fns/isFriday.d.ts","./node_modules/date-fns/isFuture.d.ts","./node_modules/date-fns/isLastDayOfMonth.d.ts","./node_modules/date-fns/isLeapYear.d.ts","./node_modules/date-fns/isMatch.d.ts","./node_modules/date-fns/isMonday.d.ts","./node_modules/date-fns/isPast.d.ts","./node_modules/date-fns/isSameDay.d.ts","./node_modules/date-fns/isSameHour.d.ts","./node_modules/date-fns/isSameISOWeek.d.ts","./node_modules/date-fns/isSameISOWeekYear.d.ts","./node_modules/date-fns/isSameMinute.d.ts","./node_modules/date-fns/isSameMonth.d.ts","./node_modules/date-fns/isSameQuarter.d.ts","./node_modules/date-fns/isSameSecond.d.ts","./node_modules/date-fns/isSameWeek.d.ts","./node_modules/date-fns/isSameYear.d.ts","./node_modules/date-fns/isSaturday.d.ts","./node_modules/date-fns/isSunday.d.ts","./node_modules/date-fns/isThisHour.d.ts","./node_modules/date-fns/isThisISOWeek.d.ts","./node_modules/date-fns/isThisMinute.d.ts","./node_modules/date-fns/isThisMonth.d.ts","./node_modules/date-fns/isThisQuarter.d.ts","./node_modules/date-fns/isThisSecond.d.ts","./node_modules/date-fns/isThisWeek.d.ts","./node_modules/date-fns/isThisYear.d.ts","./node_modules/date-fns/isThursday.d.ts","./node_modules/date-fns/isToday.d.ts","./node_modules/date-fns/isTomorrow.d.ts","./node_modules/date-fns/isTuesday.d.ts","./node_modules/date-fns/isValid.d.ts","./node_modules/date-fns/isWednesday.d.ts","./node_modules/date-fns/isWeekend.d.ts","./node_modules/date-fns/isWithinInterval.d.ts","./node_modules/date-fns/isYesterday.d.ts","./node_modules/date-fns/lastDayOfDecade.d.ts","./node_modules/date-fns/lastDayOfISOWeek.d.ts","./node_modules/date-fns/lastDayOfISOWeekYear.d.ts","./node_modules/date-fns/lastDayOfMonth.d.ts","./node_modules/date-fns/lastDayOfQuarter.d.ts","./node_modules/date-fns/lastDayOfWeek.d.ts","./node_modules/date-fns/lastDayOfYear.d.ts","./node_modules/date-fns/_lib/format/lightFormatters.d.ts","./node_modules/date-fns/lightFormat.d.ts","./node_modules/date-fns/max.d.ts","./node_modules/date-fns/milliseconds.d.ts","./node_modules/date-fns/millisecondsToHours.d.ts","./node_modules/date-fns/millisecondsToMinutes.d.ts","./node_modules/date-fns/millisecondsToSeconds.d.ts","./node_modules/date-fns/min.d.ts","./node_modules/date-fns/minutesToHours.d.ts","./node_modules/date-fns/minutesToMilliseconds.d.ts","./node_modules/date-fns/minutesToSeconds.d.ts","./node_modules/date-fns/monthsToQuarters.d.ts","./node_modules/date-fns/monthsToYears.d.ts","./node_modules/date-fns/nextDay.d.ts","./node_modules/date-fns/nextFriday.d.ts","./node_modules/date-fns/nextMonday.d.ts","./node_modules/date-fns/nextSaturday.d.ts","./node_modules/date-fns/nextSunday.d.ts","./node_modules/date-fns/nextThursday.d.ts","./node_modules/date-fns/nextTuesday.d.ts","./node_modules/date-fns/nextWednesday.d.ts","./node_modules/date-fns/parse/_lib/types.d.ts","./node_modules/date-fns/parse/_lib/Setter.d.ts","./node_modules/date-fns/parse/_lib/Parser.d.ts","./node_modules/date-fns/parse/_lib/parsers.d.ts","./node_modules/date-fns/parse.d.ts","./node_modules/date-fns/parseISO.d.ts","./node_modules/date-fns/parseJSON.d.ts","./node_modules/date-fns/previousDay.d.ts","./node_modules/date-fns/previousFriday.d.ts","./node_modules/date-fns/previousMonday.d.ts","./node_modules/date-fns/previousSaturday.d.ts","./node_modules/date-fns/previousSunday.d.ts","./node_modules/date-fns/previousThursday.d.ts","./node_modules/date-fns/previousTuesday.d.ts","./node_modules/date-fns/previousWednesday.d.ts","./node_modules/date-fns/quartersToMonths.d.ts","./node_modules/date-fns/quartersToYears.d.ts","./node_modules/date-fns/roundToNearestHours.d.ts","./node_modules/date-fns/roundToNearestMinutes.d.ts","./node_modules/date-fns/secondsToHours.d.ts","./node_modules/date-fns/secondsToMilliseconds.d.ts","./node_modules/date-fns/secondsToMinutes.d.ts","./node_modules/date-fns/set.d.ts","./node_modules/date-fns/setDate.d.ts","./node_modules/date-fns/setDay.d.ts","./node_modules/date-fns/setDayOfYear.d.ts","./node_modules/date-fns/setDefaultOptions.d.ts","./node_modules/date-fns/setHours.d.ts","./node_modules/date-fns/setISODay.d.ts","./node_modules/date-fns/setISOWeek.d.ts","./node_modules/date-fns/setISOWeekYear.d.ts","./node_modules/date-fns/setMilliseconds.d.ts","./node_modules/date-fns/setMinutes.d.ts","./node_modules/date-fns/setMonth.d.ts","./node_modules/date-fns/setQuarter.d.ts","./node_modules/date-fns/setSeconds.d.ts","./node_modules/date-fns/setWeek.d.ts","./node_modules/date-fns/setWeekYear.d.ts","./node_modules/date-fns/setYear.d.ts","./node_modules/date-fns/startOfDay.d.ts","./node_modules/date-fns/startOfDecade.d.ts","./node_modules/date-fns/startOfHour.d.ts","./node_modules/date-fns/startOfISOWeek.d.ts","./node_modules/date-fns/startOfISOWeekYear.d.ts","./node_modules/date-fns/startOfMinute.d.ts","./node_modules/date-fns/startOfMonth.d.ts","./node_modules/date-fns/startOfQuarter.d.ts","./node_modules/date-fns/startOfSecond.d.ts","./node_modules/date-fns/startOfToday.d.ts","./node_modules/date-fns/startOfTomorrow.d.ts","./node_modules/date-fns/startOfWeek.d.ts","./node_modules/date-fns/startOfWeekYear.d.ts","./node_modules/date-fns/startOfYear.d.ts","./node_modules/date-fns/startOfYesterday.d.ts","./node_modules/date-fns/sub.d.ts","./node_modules/date-fns/subBusinessDays.d.ts","./node_modules/date-fns/subDays.d.ts","./node_modules/date-fns/subHours.d.ts","./node_modules/date-fns/subISOWeekYears.d.ts","./node_modules/date-fns/subMilliseconds.d.ts","./node_modules/date-fns/subMinutes.d.ts","./node_modules/date-fns/subMonths.d.ts","./node_modules/date-fns/subQuarters.d.ts","./node_modules/date-fns/subSeconds.d.ts","./node_modules/date-fns/subWeeks.d.ts","./node_modules/date-fns/subYears.d.ts","./node_modules/date-fns/toDate.d.ts","./node_modules/date-fns/transpose.d.ts","./node_modules/date-fns/weeksToDays.d.ts","./node_modules/date-fns/yearsToDays.d.ts","./node_modules/date-fns/yearsToMonths.d.ts","./node_modules/date-fns/yearsToQuarters.d.ts","./node_modules/date-fns/index.d.ts","./src/components/ui/table.tsx","./node_modules/@radix-ui/react-alert-dialog/dist/index.d.mts","./src/components/ui/alert-dialog.tsx","./src/app/[locale]/(dashboard)/admin/questionnaires/questionnaire-list-content.tsx","./src/app/[locale]/(dashboard)/admin/questionnaires/questionnaire-list-skeleton.tsx","./src/app/[locale]/(dashboard)/admin/questionnaires/page.tsx","./node_modules/@radix-ui/react-radio-group/dist/index.d.mts","./src/components/ui/radio-group.tsx","./src/components/features/admin/import-preview-table.tsx","./src/components/features/admin/questionnaire-import-wizard.tsx","./src/app/[locale]/(dashboard)/admin/questionnaires/import/page.tsx","./node_modules/date-fns/locale/af.d.ts","./node_modules/date-fns/locale/ar.d.ts","./node_modules/date-fns/locale/ar-DZ.d.ts","./node_modules/date-fns/locale/ar-EG.d.ts","./node_modules/date-fns/locale/ar-MA.d.ts","./node_modules/date-fns/locale/ar-SA.d.ts","./node_modules/date-fns/locale/ar-TN.d.ts","./node_modules/date-fns/locale/az.d.ts","./node_modules/date-fns/locale/be.d.ts","./node_modules/date-fns/locale/be-tarask.d.ts","./node_modules/date-fns/locale/bg.d.ts","./node_modules/date-fns/locale/bn.d.ts","./node_modules/date-fns/locale/bs.d.ts","./node_modules/date-fns/locale/ca.d.ts","./node_modules/date-fns/locale/ckb.d.ts","./node_modules/date-fns/locale/cs.d.ts","./node_modules/date-fns/locale/cy.d.ts","./node_modules/date-fns/locale/da.d.ts","./node_modules/date-fns/locale/de.d.ts","./node_modules/date-fns/locale/de-AT.d.ts","./node_modules/date-fns/locale/el.d.ts","./node_modules/date-fns/locale/en-AU.d.ts","./node_modules/date-fns/locale/en-CA.d.ts","./node_modules/date-fns/locale/en-GB.d.ts","./node_modules/date-fns/locale/en-IE.d.ts","./node_modules/date-fns/locale/en-IN.d.ts","./node_modules/date-fns/locale/en-NZ.d.ts","./node_modules/date-fns/locale/en-US.d.ts","./node_modules/date-fns/locale/en-ZA.d.ts","./node_modules/date-fns/locale/eo.d.ts","./node_modules/date-fns/locale/es.d.ts","./node_modules/date-fns/locale/et.d.ts","./node_modules/date-fns/locale/eu.d.ts","./node_modules/date-fns/locale/fa-IR.d.ts","./node_modules/date-fns/locale/fi.d.ts","./node_modules/date-fns/locale/fr.d.ts","./node_modules/date-fns/locale/fr-CA.d.ts","./node_modules/date-fns/locale/fr-CH.d.ts","./node_modules/date-fns/locale/fy.d.ts","./node_modules/date-fns/locale/gd.d.ts","./node_modules/date-fns/locale/gl.d.ts","./node_modules/date-fns/locale/gu.d.ts","./node_modules/date-fns/locale/he.d.ts","./node_modules/date-fns/locale/hi.d.ts","./node_modules/date-fns/locale/hr.d.ts","./node_modules/date-fns/locale/ht.d.ts","./node_modules/date-fns/locale/hu.d.ts","./node_modules/date-fns/locale/hy.d.ts","./node_modules/date-fns/locale/id.d.ts","./node_modules/date-fns/locale/is.d.ts","./node_modules/date-fns/locale/it.d.ts","./node_modules/date-fns/locale/it-CH.d.ts","./node_modules/date-fns/locale/ja.d.ts","./node_modules/date-fns/locale/ja-Hira.d.ts","./node_modules/date-fns/locale/ka.d.ts","./node_modules/date-fns/locale/kk.d.ts","./node_modules/date-fns/locale/km.d.ts","./node_modules/date-fns/locale/kn.d.ts","./node_modules/date-fns/locale/ko.d.ts","./node_modules/date-fns/locale/lb.d.ts","./node_modules/date-fns/locale/lt.d.ts","./node_modules/date-fns/locale/lv.d.ts","./node_modules/date-fns/locale/mk.d.ts","./node_modules/date-fns/locale/mn.d.ts","./node_modules/date-fns/locale/ms.d.ts","./node_modules/date-fns/locale/mt.d.ts","./node_modules/date-fns/locale/nb.d.ts","./node_modules/date-fns/locale/nl.d.ts","./node_modules/date-fns/locale/nl-BE.d.ts","./node_modules/date-fns/locale/nn.d.ts","./node_modules/date-fns/locale/oc.d.ts","./node_modules/date-fns/locale/pl.d.ts","./node_modules/date-fns/locale/pt.d.ts","./node_modules/date-fns/locale/pt-BR.d.ts","./node_modules/date-fns/locale/ro.d.ts","./node_modules/date-fns/locale/ru.d.ts","./node_modules/date-fns/locale/se.d.ts","./node_modules/date-fns/locale/sk.d.ts","./node_modules/date-fns/locale/sl.d.ts","./node_modules/date-fns/locale/sq.d.ts","./node_modules/date-fns/locale/sr.d.ts","./node_modules/date-fns/locale/sr-Latn.d.ts","./node_modules/date-fns/locale/sv.d.ts","./node_modules/date-fns/locale/ta.d.ts","./node_modules/date-fns/locale/te.d.ts","./node_modules/date-fns/locale/th.d.ts","./node_modules/date-fns/locale/tr.d.ts","./node_modules/date-fns/locale/ug.d.ts","./node_modules/date-fns/locale/uk.d.ts","./node_modules/date-fns/locale/uz.d.ts","./node_modules/date-fns/locale/uz-Cyrl.d.ts","./node_modules/date-fns/locale/vi.d.ts","./node_modules/date-fns/locale/zh-CN.d.ts","./node_modules/date-fns/locale/zh-HK.d.ts","./node_modules/date-fns/locale/zh-TW.d.ts","./node_modules/date-fns/locale.d.ts","./src/app/[locale]/(dashboard)/assessments/page.tsx","./src/components/features/assessment/assessment-workspace-context.tsx","./src/components/features/assessment/question-navigation-sidebar.tsx","./src/components/features/assessment/response-types/ans-response.tsx","./src/components/features/assessment/response-types/sms-response.tsx","./src/components/features/assessment/comments-section.tsx","./src/components/features/assessment/evidence-panel.tsx","./src/components/features/assessment/question-response-panel.tsx","./src/app/[locale]/(dashboard)/assessments/[id]/page.tsx","./node_modules/@radix-ui/react-tabs/dist/index.d.mts","./src/components/ui/tabs.tsx","./src/components/features/progress/ProgressBar.tsx","./src/components/features/progress/CategoryProgress.tsx","./src/components/features/progress/ActivityTimeline.tsx","./src/app/[locale]/(dashboard)/assessments/[id]/progress/page.tsx","./src/app/[locale]/(dashboard)/assessments/[id]/take/page.tsx","./src/components/features/assessment/wizard-steps/wizard-stepper.tsx","./src/components/features/assessment/wizard-steps/questionnaire-type-step.tsx","./src/components/features/assessment/wizard-steps/assessment-type-step.tsx","./src/components/features/assessment/wizard-steps/assessment-details-step.tsx","./src/components/features/assessment/wizard-steps/review-confirm-step.tsx","./src/components/features/assessment/assessment-wizard.tsx","./src/app/[locale]/(dashboard)/assessments/new/page.tsx","./src/components/features/dashboard/StatsCard.tsx","./src/components/features/dashboard/AssessmentStatusWidget.tsx","./src/components/features/dashboard/RecentActivityWidget.tsx","./src/components/features/dashboard/AttentionRequiredWidget.tsx","./src/app/[locale]/(dashboard)/dashboard/dashboard-content.tsx","./src/app/[locale]/(dashboard)/dashboard/page.tsx","./src/app/[locale]/(dashboard)/questionnaires/layout.tsx","./src/app/[locale]/(dashboard)/questionnaires/loading.tsx","./src/app/[locale]/(dashboard)/questionnaires/page.tsx","./src/app/[locale]/(dashboard)/questionnaires/ans/loading.tsx","./src/app/[locale]/(dashboard)/questionnaires/ans/page.tsx","./src/app/[locale]/(dashboard)/questionnaires/question/[id]/question-detail-view.tsx","./src/app/[locale]/(dashboard)/questionnaires/question/[id]/question-detail-skeleton.tsx","./src/app/[locale]/(dashboard)/questionnaires/question/[id]/page.tsx","./src/app/[locale]/(dashboard)/questionnaires/sms/loading.tsx","./src/app/[locale]/(dashboard)/questionnaires/sms/page.tsx","./src/components/ui/form.tsx","./node_modules/next-themes/dist/index.d.ts","./src/components/ui/sonner.tsx","./.next/types/routes.d.ts","./.next/types/validator.ts","./.next/dev/types/cache-life.d.ts","./.next/dev/types/validator.ts","./node_modules/@types/bcryptjs/index.d.ts","./node_modules/@types/d3-array/index.d.ts","./node_modules/@types/d3-color/index.d.ts","./node_modules/@types/d3-ease/index.d.ts","./node_modules/@types/d3-interpolate/index.d.ts","./node_modules/@types/d3-path/index.d.ts","./node_modules/@types/d3-time/index.d.ts","./node_modules/@types/d3-scale/index.d.ts","./node_modules/@types/d3-shape/index.d.ts","./node_modules/@types/d3-timer/index.d.ts","./node_modules/@types/json-schema/index.d.ts","./node_modules/@types/json5/index.d.ts","./node_modules/@types/use-sync-external-store/index.d.ts"],"fileIdsList":[[97,143,459,460,461,462],[97,143],[97,143,269,503,506,509,869,870,904,905,906,1064,1065,1066,1067,1068,1119,1120,1121,1134,1399,1404,1501,1509,1515,1516,1523,1529,1530,1532,1534,1537,1539],[97,143,269,503,506,869,870,904,905,906,1064,1065,1066,1067,1068,1119,1120,1121,1134,1399,1404,1501,1509,1515,1516,1523,1529,1530,1532,1534,1537,1539,1543],[97,143,507,508,509],[97,143,269,507,520],[97,143,612],[97,143,611],[97,143,655],[97,143,655,658],[97,143,658],[97,143,644,645,646,647,648,649,650,651,652,653,654,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689],[97,143,656],[97,143,655,656,657],[97,143,656,658],[97,143,656,657],[97,143,694],[97,143,694,696,697],[97,143,694,695],[97,143,690,693],[97,143,691,692],[97,143,690],[97,143,1117],[97,143,817,1103,1116],[97,143,623,625],[97,143,613],[97,143,610],[97,143,624],[85,97,143,923,924,1005],[85,97,143,923,933],[85,97,143,924],[85,97,143,919,935],[85,97,143],[85,97,143,269,923,924],[85,97,143,923,924],[85,97,143,923,924,925,926,930],[85,97,143,923,924,1124],[85,97,143,919],[85,97,143,923,924,925,926,929,930,1123],[85,97,143,923,924,927,928],[85,97,143,923,924,1123],[85,97,143,923,924,925,926,929,930],[85,89,97,143,192,193,194,195,196,454,500],[85,97,143,923,924,925,929,930],[97,143,953],[97,143,953,955],[97,143,953,954,955,956,957,958,959,960,961,962],[97,143,953,955,956],[85,97,143,963],[85,97,143,269],[85,97,143,269,963,964,965,966,967,968,969,970,971,972,973,974,975,976,977,978,979,980,981,982],[97,143,963,964],[97,143,963],[97,143,963,964,973],[97,143,963,964,966],[97,143,875,942,943,945],[97,143,942,943,945],[97,143,942,943,944],[97,143,875,940,941,942,943,944,945,946,947,948,949,951],[97,143,942,943],[97,143,940,941,942],[97,143,942],[97,143,875,940,941,942,943,944,950],[85,97,143,942,952,983],[97,143,942,952,983,984],[97,143,871,872,873],[97,143,871,872],[97,143,871],[97,143,540,541],[97,143,1549],[97,143,1553],[97,143,1552],[97,140,143],[97,142,143],[143],[97,143,148,176],[97,143,144,149,154,162,173,184],[97,143,144,145,154,162],[92,93,94,97,143],[97,143,146,185],[97,143,147,148,155,163],[97,143,148,173,181],[97,143,149,151,154,162],[97,142,143,150],[97,143,151,152],[97,143,153,154],[97,142,143,154],[97,143,154,155,156,173,184],[97,143,154,155,156,169,173,176],[97,143,151,154,157,162,173,184],[97,143,154,155,157,158,162,173,181,184],[97,143,157,159,173,181,184],[95,96,97,98,99,100,101,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190],[97,143,154,160],[97,143,161,184,189],[97,143,151,154,162,173],[97,143,163],[97,143,164],[97,142,143,165],[97,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190],[97,143,167],[97,143,168],[97,143,154,169,170],[97,143,169,171,185,187],[97,143,154,173,174,176],[97,143,175,176],[97,143,173,174],[97,143,176],[97,143,177],[97,140,143,173,178],[97,143,154,179,180],[97,143,179,180],[97,143,148,162,173,181],[97,143,182],[97,143,162,183],[97,143,157,168,184],[97,143,148,185],[97,143,173,186],[97,143,161,187],[97,143,188],[97,138,143],[97,138,143,154,156,165,173,176,184,187,189],[97,143,173,190],[97,143,622],[97,143,154,173,181,191,616,617,620,621,622],[85,89,97,143,192,193,194,196,454,500,914],[85,89,97,143,192,193,194,195,412,454,500,914],[85,89,97,143,192,193,195,196,454,500,914],[85,97,143,196,412,413],[85,97,143,196,412],[85,89,97,143,193,194,195,196,454,500,914],[85,89,97,143,192,194,195,196,454,500,914],[83,84,97,143],[97,143,527,531,534,536,537,538,539,542,741],[97,143,591],[97,143,591,592],[97,143,531,532,534,535],[97,143,531],[97,143,531,532,534],[97,143,531,532],[97,143,526,582,583],[97,143,526,582],[97,143,526,533],[97,143,526],[97,143,526,533,596],[97,143,528],[97,143,526,527,528,529,530],[97,143,628],[97,143,911,915],[97,143,911],[97,143,1139],[97,143,1137,1139],[97,143,1137],[97,143,1139,1203,1204],[97,143,1139,1206],[97,143,1139,1207],[97,143,1224],[97,143,1139,1140,1141,1142,1143,1144,1145,1146,1147,1148,1149,1150,1151,1152,1153,1154,1155,1156,1157,1158,1159,1160,1161,1162,1163,1164,1165,1166,1167,1168,1169,1170,1171,1172,1173,1174,1175,1176,1177,1178,1179,1180,1181,1182,1183,1184,1185,1186,1187,1188,1189,1190,1191,1192,1193,1194,1195,1196,1197,1198,1199,1200,1201,1202,1205,1206,1207,1208,1209,1210,1211,1212,1213,1214,1215,1216,1217,1218,1219,1220,1221,1222,1223,1225,1226,1227,1228,1229,1230,1231,1232,1233,1234,1235,1236,1237,1238,1239,1240,1241,1242,1243,1244,1245,1246,1247,1248,1249,1250,1251,1252,1253,1254,1255,1256,1257,1258,1259,1260,1261,1262,1263,1264,1265,1266,1267,1268,1269,1270,1271,1272,1273,1274,1275,1276,1277,1278,1279,1280,1281,1282,1283,1284,1285,1286,1287,1288,1289,1290,1291,1292,1293,1294,1295,1296,1297,1298,1299,1301,1302,1303,1304,1305,1306,1307,1308,1309,1310,1311,1312,1313,1314,1315,1316,1317,1318,1319,1320,1325,1326,1327,1328,1329,1330,1331,1332,1333,1334,1335,1336,1337,1338,1339,1340,1341,1342,1343,1344,1345,1346,1347,1348,1349,1350,1351,1352,1353,1354,1355,1356,1357,1358,1359,1360,1361,1362,1363,1364,1365,1366,1367,1368,1369,1370,1371,1372,1373,1374,1375,1376,1377,1378,1379,1380,1381,1382,1383,1384,1385,1386,1387,1388,1389,1390,1391,1392],[97,143,1139,1300],[97,143,1137,1405,1406,1407,1408,1409,1410,1411,1412,1413,1414,1415,1416,1417,1418,1419,1420,1421,1422,1423,1424,1425,1426,1427,1428,1429,1430,1431,1432,1433,1434,1435,1436,1437,1438,1439,1440,1441,1442,1443,1444,1445,1446,1447,1448,1449,1450,1451,1452,1453,1454,1455,1456,1457,1458,1459,1460,1461,1462,1463,1464,1465,1466,1467,1468,1469,1470,1471,1472,1473,1474,1475,1476,1477,1478,1479,1480,1481,1482,1483,1484,1485,1486,1487,1488,1489,1490,1491,1492,1493,1494,1495,1496,1497,1498,1499],[97,143,1139,1204,1324],[97,143,1137,1321,1322],[97,143,1139,1321],[97,143,1323],[97,143,1136,1137,1138],[97,143,744,745],[97,143,744,745,746,747],[97,143,744,746],[97,143,744],[85,97,143,1033],[85,97,143,269,1032,1033,1034],[97,143,699,700,701],[97,143,698,699],[97,143,690,698],[97,143,575,576],[97,143,1032],[97,143,503,507,853,856,860,861,862,863],[85,97,143,853,856,863],[97,143,503,507,856,860,861],[97,143,503],[97,143,853,856],[97,143,838,839,844,853,854,856,857,858,859],[97,143,844,856],[97,143,838],[97,143,856],[97,143,856,860],[97,143,843,860],[97,143,842,852,854,856],[97,143,846,853,856],[97,143,848,849,853,856],[97,143,847,850,851,852,856],[97,143,850,856],[97,143,838,841,848,853,856,860],[97,143,840,841,842,843,844,853,855,860],[97,143,847],[85,97,143,853,856,1069],[97,143,511],[97,143,512],[97,143,512,513,514,516],[97,143,515],[97,143,516],[97,143,908],[97,143,635],[97,143,634],[97,143,503,632,633],[97,143,736],[85,97,143,184,314,491,632,633,732,733,734],[97,143,734,735],[97,143,168,184,632,633,732,733],[97,143,519],[97,143,507,517],[97,143,518],[97,143,721,731,732,907],[97,143,638],[97,143,503,632],[97,143,632,633],[97,143,632,633,637],[97,143,1055],[97,143,732],[97,143,721],[97,143,721,1049],[97,143,732,1051],[97,143,721,731],[97,143,1044,1045,1046,1047,1048,1050,1052,1053,1054],[85,97,143,269,731,732],[97,143,457],[97,143,201,203,207,218,408,438,450],[97,143,203,213,214,215,217,450],[97,143,203,250,252,254,255,258,450,452],[97,143,203,207,209,210,211,241,336,408,428,429,437,450,452],[97,143,450],[97,143,214,306,417,426,446],[97,143,203],[97,143,197,306,446],[97,143,260],[97,143,259,450],[97,143,157,406,417,505],[97,143,157,374,386,426,445],[97,143,157,317],[97,143,431],[97,143,430,431,432],[97,143,430],[91,97,143,157,197,203,207,210,212,214,218,219,232,233,260,336,347,427,438,450,454],[97,143,201,203,216,250,251,256,257,450,505],[97,143,216,505],[97,143,201,233,361,450,505],[97,143,505],[97,143,203,216,217,505],[97,143,253,505],[97,143,219,428,436],[97,143,168,269,446],[97,143,269,446],[85,97,143,378],[97,143,304,314,315,446,482,489],[97,143,303,423,483,484,485,486,488],[97,143,422],[97,143,422,423],[97,143,241,306,307,311],[97,143,306],[97,143,306,310,312],[97,143,306,307,308,309],[97,143,487],[85,97,143,204,476],[85,97,143,184],[85,97,143,216,296],[85,97,143,216,438],[97,143,294,298],[85,97,143,295,456],[85,89,97,143,157,191,192,193,194,195,196,454,498,499,914],[97,143,157],[97,143,157,207,240,292,337,358,360,433,434,438,450,451],[97,143,232,435],[97,143,454],[97,143,202],[85,97,143,363,376,385,395,397,445],[97,143,168,363,376,394,395,396,445,504],[97,143,388,389,390,391,392,393],[97,143,390],[97,143,394],[97,143,267,268,269,271],[85,97,143,261,262,263,264,270],[97,143,267,270],[97,143,265],[97,143,266],[85,97,143,269,295,456],[85,97,143,269,455,456],[85,97,143,269,456],[97,143,337,440],[97,143,440],[97,143,157,451,456],[97,143,382],[97,142,143,381],[97,143,242,306,323,360,369,372,374,375,416,445,448,451],[97,143,288,306,403],[97,143,374,445],[85,97,143,374,379,380,382,383,384,385,386,387,398,399,400,401,402,404,405,445,446,505],[97,143,368],[97,143,157,168,204,240,243,264,289,290,337,347,358,359,416,439,450,451,452,454,505],[97,143,445],[97,142,143,214,290,347,371,439,441,442,443,444,451],[97,143,374],[97,142,143,240,277,323,364,365,366,367,368,369,370,372,373,445,446],[97,143,157,277,278,364,451,452],[97,143,214,337,347,360,439,445,451],[97,143,157,450,452],[97,143,157,173,448,451,452],[97,143,157,168,184,197,207,216,242,243,245,274,279,284,288,289,290,292,321,323,325,328,330,333,334,335,336,358,360,438,439,446,448,450,451,452],[97,143,157,173],[97,143,203,204,205,212,448,449,454,456,505],[97,143,201,450],[97,143,273],[97,143,157,173,184,235,258,260,261,262,263,264,271,272,505],[97,143,168,184,197,235,250,283,284,285,321,322,323,328,336,337,343,346,348,358,360,439,446,448,450],[97,143,212,219,232,336,347,439,450],[97,143,157,184,204,207,323,341,448,450],[97,143,362],[97,143,157,273,344,345,355],[97,143,448,450],[97,143,369,371],[97,143,290,323,438,456],[97,143,157,168,246,250,322,328,343,346,350,448],[97,143,157,219,232,250,351],[97,143,203,245,353,438,450],[97,143,157,184,264,450],[97,143,157,216,244,245,246,255,273,352,354,438,450],[91,97,143,157,290,357,454,456],[97,143,320,358],[97,143,157,168,184,207,218,219,232,242,243,279,283,284,285,289,321,322,323,325,337,338,340,342,358,360,438,439,446,447,448,456],[97,143,157,173,219,343,349,355,448],[97,143,222,223,224,225,226,227,228,229,230,231],[97,143,274,329],[97,143,331],[97,143,329],[97,143,331,332],[97,143,157,207,210,240,241,451],[97,143,157,168,202,204,242,288,289,290,291,319,358,448,452,454,456],[97,143,157,168,184,206,241,291,323,369,439,447,451],[97,143,364],[97,143,365],[97,143,306,336,416],[97,143,366],[97,143,234,238],[97,143,157,207,234,242],[97,143,237,238],[97,143,239],[97,143,234,235],[97,143,234,286],[97,143,234],[97,143,274,327,447],[97,143,326],[97,143,235,446,447],[97,143,324,447],[97,143,235,446],[97,143,416],[97,143,207,236,242,290,306,323,357,360,363,369,376,377,407,408,411,415,438,448,451],[97,143,299,302,304,305,314,315],[85,97,143,194,196,269,409,410],[85,97,143,194,196,269,409,410,414],[97,143,425],[97,143,214,278,290,357,360,374,382,386,418,419,420,421,423,424,427,438,445,450],[97,143,314],[97,143,157,319],[97,143,319],[97,143,157,242,287,292,316,318,357,448,454,456],[97,143,299,300,301,302,304,305,314,315,455],[91,97,143,157,168,184,234,235,243,289,290,323,355,356,358,438,439,448,450,451,454],[97,143,278,280,283,439],[97,143,157,274,450],[97,143,277,374],[97,143,276],[97,143,278,279],[97,143,275,277,450],[97,143,157,206,278,280,281,282,450,451],[85,97,143,306,313,446],[97,143,199,200],[85,97,143,204],[85,97,143,303,446],[85,91,97,143,289,290,454,456],[97,143,204,476,477],[85,97,143,298],[85,97,143,168,184,202,257,293,295,297,456],[97,143,216,446,451],[97,143,339,446],[85,97,143,155,157,168,201,202,252,298,454,455],[85,97,143,192,193,194,195,196,454,500,914],[85,86,87,88,89,97,143],[97,143,148],[97,143,247,248,249],[97,143,247],[85,89,97,143,157,159,168,191,192,193,194,195,196,197,202,243,350,394,452,453,456,500,914],[97,143,464],[97,143,466],[97,143,468],[97,143,470],[97,143,472,473,474],[97,143,478],[90,97,143,458,463,465,467,469,471,475,479,481,491,492,494,503,504,505,506],[97,143,480],[97,143,490],[97,143,295],[97,143,493],[97,142,143,278,280,281,283,495,496,497,500,501,502],[97,143,191],[97,143,191,617,618,619],[97,143,173,191,617],[97,143,569],[97,143,567,569],[97,143,558,566,567,568,570,572],[97,143,556],[97,143,559,564,569,572],[97,143,555,572],[97,143,559,560,563,564,565,572],[97,143,559,560,561,563,564,572],[97,143,556,557,558,559,560,564,565,566,568,569,570,572],[97,143,572],[97,143,554,556,557,558,559,560,561,563,564,565,566,567,568,569,570,571],[97,143,554,572],[97,143,559,561,562,564,565,572],[97,143,563,572],[97,143,564,565,569,572],[97,143,557,567],[97,143,845],[97,143,846],[97,143,523],[85,97,143,1086],[97,143,1086,1087,1088,1089,1092,1093,1094,1095,1096,1097,1098,1101,1102],[97,143,1086],[97,143,1090,1091],[85,97,143,1083,1086],[97,143,1080,1081,1083],[97,143,1076,1079,1081,1083],[97,143,1080,1083],[85,97,143,1071,1072,1073,1076,1077,1078,1080,1081,1082,1083],[97,143,1073,1076,1077,1078,1079,1080,1081,1082,1083,1084,1085],[97,143,1080],[97,143,1074,1080,1081],[97,143,1074,1075],[97,143,1079,1081,1082],[97,143,1079],[97,143,1071,1076,1081,1082],[85,97,143,1076,1079,1080,1081],[97,143,1099,1100],[97,143,548,580,581],[97,143,547,548],[97,143,173,191],[97,143,878,879],[97,143,878],[97,143,878,879,880,881],[97,143,876,882],[97,143,882],[97,143,876,877],[97,110,114,143,184],[97,110,143,173,184],[97,105,143],[97,107,110,143,181,184],[97,143,162,181],[97,105,143,191],[97,107,110,143,162,184],[97,102,103,106,109,143,154,173,184],[97,110,117,143],[97,102,108,143],[97,110,131,132,143],[97,106,110,143,176,184,191],[97,131,143,191],[97,104,105,143,191],[97,110,143],[97,104,105,106,107,108,109,110,111,112,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,132,133,134,135,136,137,143],[97,110,125,143],[97,110,117,118,143],[97,108,110,118,119,143],[97,109,143],[97,102,105,110,143],[97,110,114,118,119,143],[97,114,143],[97,108,110,113,143,184],[97,102,107,110,117,143],[97,143,173],[97,105,110,131,143,189,191],[97,143,720],[97,143,642],[97,143,643,703],[97,143,710],[97,143,642,704,705,707,708],[97,143,706],[97,143,702],[85,97,143,642,643,703,704,705,707,714,716],[85,97,143,641,704,708,709,711,712,713,714],[97,143,705],[97,143,640,641,642,643,703,704,705,706,707,709,711,712,713,714,715,716,717,718,719],[97,143,707,709],[97,143,730],[85,97,143,269,709],[97,143,722,723,724,725,726,727,728,729],[85,97,143,641,715],[97,143,717],[97,143,705,713,715],[97,143,544],[97,143,154,155,157,158,159,162,173,181,184,190,191,544,545,546,548,549,551,552,553,573,574,578,579,580,581],[97,143,544,545,546,550],[97,143,546],[97,143,577],[97,143,548,581],[97,143,598],[97,143,543,607,741],[97,143,526,527,529,530,531,534,536,537,584,585,587,594,595,597,741],[97,143,536,601,602,741],[97,143,536,585,589,741],[97,143,526,534,536,584,741],[97,143,551],[97,143,526,536,543,584,586,603,741],[97,143,581,605,607],[97,143,146,155,173,526,531,534,536,543,581,584,585,586,587,589,590,593,594,595,599,600,603,604,607,741],[97,143,536,551,584,585,741],[97,143,536,601,602,603,741],[97,143,536,551,586,587,588,741],[97,143,146,155,173,526,531,534,536,543,551,581,584,585,586,587,588,589,590,593,594,595,599,600,601,602,603,604,605,606,607,741],[97,143,526,531,534,536,537,543,551,584,585,586,587,588,589,590,601,602,603,741,742,743,748],[97,143,826],[97,143,1104,1105,1116],[97,143,1106,1107],[97,143,1104,1105,1106,1108,1109,1114],[97,143,1105,1106],[97,143,1114],[97,143,1115],[97,143,1106],[97,143,1104,1105,1106,1109,1110,1111,1112,1113],[97,143,817],[97,143,817,820],[97,143,812,815,817,818,819,820,821,822,823,824,825],[97,143,751,753,820],[97,143,817,818],[97,143,752,817,819],[97,143,753,755,757,758,759,760],[97,143,755,757,759,760],[97,143,755,757,759],[97,143,752,755,757,758,760],[97,143,751,753,754,755,756,757,758,759,760,761,762,812,813,814,815,816],[97,143,751,753,754,757],[97,143,753,754,757],[97,143,757,760],[97,143,751,752,754,755,756,758,759,760],[97,143,751,752,753,757,817],[97,143,757,758,759,760],[97,143,759],[97,143,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800,801,802,803,804,805,806,807,808,809,810,811],[97,143,269,522,524],[97,143,269,614],[97,143,269,522,614,623,626],[97,143,269,522,614,623,626,629],[97,143,155,164,269,522,614,623,626],[97,143,269,614,749],[97,143,269,749,829],[97,143,269,749,828],[97,143,269,749,833,834],[97,143,269,614,749,832,833,836],[97,143,269],[85,97,143,269,481,491,827,909,910,917,918,921,939,996,1070,1103,1118],[85,97,143,269,481,491,827,909,910,917,918,921,932,939,996,1103,1118],[97,143,269,481,910,917,996],[97,143,269,481,491,868,910,917,1056,1403],[85,97,143,269,491,868,1056,1397,1398],[85,97,143,269,481,491,909,910,913,917,986,988,996,1126,1135,1393,1394,1396],[97,143,269,996,1018],[85,97,143,269,481,909,910,917,988,1023,1035,1502,1503,1508],[85,97,143,269,481,491,909,910,917,986,988,996,1393,1511,1512,1513,1514],[85,97,143,269,481,491,909,910,917,938,986,988,1023,1035,1135,1396,1502,1503,1508],[97,143,269,1056,1522],[97,143,269,614,738,909,910,917,938,986,988,996,1393,1500],[97,143,269,481,491,909,910,917,986,996,1018,1524,1525,1526,1527],[97,143,269,868,1056,1528],[97,143,269,491,868,1132,1133],[97,143,269,1019],[85,97,143,269,1017,1019,1056],[97,143,269,829,910,997,1056],[85,97,143,269,481,491,866,910,1056,1535,1536],[85,97,143,269,481,614,829,909,910,917,988,996,998,999,1000],[97,143,269,1029],[85,97,143,269,1028,1029,1056],[97,143,269,491,738,909,1056],[97,143,269,481,909],[97,143,269,868],[97,143,269,503,629,827,866],[97,143,269,874,883,903],[97,143,155,156,164,269,503,868],[97,143,148,155,156,164,269,503,868],[97,143,269,507],[97,143,269,479],[85,97,143,269,886,909,910,913,917,918,934,988,993,1394],[85,97,143,269,491,886,909,910,913,917,921,938,986,988,996,1135,1401,1402],[85,97,143,269,491,614,909,910,917,986,996,1035,1135,1517,1518,1519,1520,1521],[85,97,143,269,614,986,1135],[85,97,143,269,909,910,913,917,921,922,1014,1023,1035],[85,97,143,269,614,909,910,913,917,918,921,922,932,938,986,988,989,994,996,1035,1396],[85,97,143,269,909,910,913,917,918,932,938,988,993,1035,1502],[85,97,143,269,909,910,913,917,988,996,1023,1035,1502,1504,1505,1506,1507],[97,143,269,909,910,913,988,1035,1502],[97,143,269,909,913,988,1035,1502],[85,97,143,269,614,909,910,913,917,918,921,991,996,1035,1393],[97,143,269,614,909,910,913,988,996,1035],[97,143,269,614,909,910,913,921,988,991,996,1003,1035,1393],[97,143,269,910,913,1035],[85,97,143,269,491,614,909,910,913,917,988,996],[97,143,269,491,614,909,910,913,917,988,996,1393,1512],[97,143,269,614,909,910,913,917,993,996,1393],[97,143,269,910,913,996],[85,97,143,269,614,909,910,913,917,918,932,934,986,988,989,991,993],[85,97,143,269,479,614,909,910,913,917,934,988],[85,97,143,269,614,909,910,913,917,918,921,922,932,934,938,939,986],[97,143,269,987,989,994],[85,97,143,269,614,909,910,913,917,993,1393],[85,97,143,269,909,910,913,917,988,1014,1512],[97,143,269,913],[97,143,269,614,909,910,913,988],[85,97,143,269,481,491,614,829,909,910,917,918,921,988,993,996,1003,1007,1009,1010,1011,1012,1016],[97,143,269,614,829,909,913,917,988,991],[97,143,269,614,829,909,913,917,991],[97,143,269,1011,1012,1015,1016,1017,1019],[97,143,269,614,829,909,910,913,917,988,996,1003,1014],[85,97,143,269,614,909,910,939,1013,1015],[97,143,269,614,829,909,910,913,988,998],[97,143,269,997,998,999,1000,1004,1020,1030],[85,97,143,269,910,913,917],[85,97,143,269,481,614,829,909,910,917,934,988,993,998,999,1000,1003],[97,143,269,481,910,913,917,988,996],[97,143,269,614,829,909,910,913],[97,143,269,1021,1024,1025,1026,1027,1028,1029],[85,97,143,269,614,829,909,910,913,917,996,1014],[97,143,269,614,829,909,913,1025],[85,97,143,269,481,491,614,829,909,910,1021,1025,1027],[97,143,269,614,829,909,910,913,996,1007,1024,1026],[97,143,269,614,829,910,913,988,1023],[85,97,143,269,834,897,909,910,913,938,988,996,1023,1035],[97,143,269,1036,1037,1038],[85,97,143,269,614,834,897,909,913,988,996,1023,1035],[85,97,143,269,614,834,897,909,910,913,938,988,996,1023,1035],[97,143,269,1122,1131],[97,143,269,481,491,909,910,917,988,1070,1126,1130],[85,97,143,269,481,491,909,910,913,917,993,1023],[97,143,269,1059],[85,97,143,269,910,913,1006],[85,97,143,269,913,917,1395],[85,97,143,269,913,916],[85,97,143,269,913,1129],[85,97,143,269,913,914,916],[85,97,143,269,913],[85,97,143,269,910,913,990],[97,143,269,1005],[85,97,143,269,910,913,933],[85,97,143,269,910,913,1125],[85,97,143,269,913,914,920,921,1103],[85,97,143,269,913,920],[85,97,143,269,913,937],[85,97,143,269,910,913,1400],[85,97,143,269,913,992],[85,97,143,269,910,913,931],[85,97,143,269,913,1002],[97,143,269,910,1135,1541],[85,97,143,269,913,1008],[85,97,143,269,913,1510],[85,97,143,269,913,1022],[97,143,269,832],[97,143,269,832,833,836,890,891],[97,143,269,614,832,833,836],[97,143,269,827],[97,143,269,614,832,833],[97,143,269,614,629,864,865,866,1043],[97,143,269,864,867,1043],[97,143,269,491,868,1041],[97,143,269,614,864,1043],[97,143,269,614,623,626],[97,143,269,738,1056],[97,143,269,639,737],[97,143,269,614,828],[97,143,269,886],[97,143,269,828,829],[97,143,269,614,827],[97,143,269,903,985],[97,143,269,903,986,1059],[85,97,143,269,882,952,983,986],[97,143,269,911,912],[97,143,269,636,738],[97,143,269,614,866],[97,143,269,614,866,894],[97,143,269,614,834,866],[97,143,269,864,866,868,874,1043],[97,143,269,883,884,903],[97,143,269,884,885,889,893,896,898,900,902],[97,143,269,884,888],[97,143,269,827,866,875,884,886,887],[97,143,269,614,827,866,875,884,892],[97,143,269,827,866,875,884,899],[97,143,269,827,866,875,884,901],[97,143,269,614,827,875,884],[97,143,269,827,875,884,892,894,895],[97,143,269,827,866,875,884,897],[97,143,269,614,875,882,883],[97,143,164,269,608]],"fileInfos":[{"version":"c430d44666289dae81f30fa7b2edebf186ecc91a2d4c71266ea6ae76388792e1","affectsGlobalScope":true,"impliedFormat":1},{"version":"45b7ab580deca34ae9729e97c13cfd999df04416a79116c3bfb483804f85ded4","impliedFormat":1},{"version":"3facaf05f0c5fc569c5649dd359892c98a85557e3e0c847964caeb67076f4d75","impliedFormat":1},{"version":"e44bb8bbac7f10ecc786703fe0a6a4b952189f908707980ba8f3c8975a760962","impliedFormat":1},{"version":"5e1c4c362065a6b95ff952c0eab010f04dcd2c3494e813b493ecfd4fcb9fc0d8","impliedFormat":1},{"version":"68d73b4a11549f9c0b7d352d10e91e5dca8faa3322bfb77b661839c42b1ddec7","impliedFormat":1},{"version":"5efce4fc3c29ea84e8928f97adec086e3dc876365e0982cc8479a07954a3efd4","impliedFormat":1},{"version":"feecb1be483ed332fad555aff858affd90a48ab19ba7272ee084704eb7167569","impliedFormat":1},{"version":"ee7bad0c15b58988daa84371e0b89d313b762ab83cb5b31b8a2d1162e8eb41c2","impliedFormat":1},{"version":"27bdc30a0e32783366a5abeda841bc22757c1797de8681bbe81fbc735eeb1c10","impliedFormat":1},{"version":"8fd575e12870e9944c7e1d62e1f5a73fcf23dd8d3a321f2a2c74c20d022283fe","impliedFormat":1},{"version":"2ab096661c711e4a81cc464fa1e6feb929a54f5340b46b0a07ac6bbf857471f0","impliedFormat":1},{"version":"080941d9f9ff9307f7e27a83bcd888b7c8270716c39af943532438932ec1d0b9","affectsGlobalScope":true,"impliedFormat":1},{"version":"2e80ee7a49e8ac312cc11b77f1475804bee36b3b2bc896bead8b6e1266befb43","affectsGlobalScope":true,"impliedFormat":1},{"version":"c57796738e7f83dbc4b8e65132f11a377649c00dd3eee333f672b8f0a6bea671","affectsGlobalScope":true,"impliedFormat":1},{"version":"dc2df20b1bcdc8c2d34af4926e2c3ab15ffe1160a63e58b7e09833f616efff44","affectsGlobalScope":true,"impliedFormat":1},{"version":"515d0b7b9bea2e31ea4ec968e9edd2c39d3eebf4a2d5cbd04e88639819ae3b71","affectsGlobalScope":true,"impliedFormat":1},{"version":"0559b1f683ac7505ae451f9a96ce4c3c92bdc71411651ca6ddb0e88baaaad6a3","affectsGlobalScope":true,"impliedFormat":1},{"version":"0dc1e7ceda9b8b9b455c3a2d67b0412feab00bd2f66656cd8850e8831b08b537","affectsGlobalScope":true,"impliedFormat":1},{"version":"ce691fb9e5c64efb9547083e4a34091bcbe5bdb41027e310ebba8f7d96a98671","affectsGlobalScope":true,"impliedFormat":1},{"version":"8d697a2a929a5fcb38b7a65594020fcef05ec1630804a33748829c5ff53640d0","affectsGlobalScope":true,"impliedFormat":1},{"version":"4ff2a353abf8a80ee399af572debb8faab2d33ad38c4b4474cff7f26e7653b8d","affectsGlobalScope":true,"impliedFormat":1},{"version":"fb0f136d372979348d59b3f5020b4cdb81b5504192b1cacff5d1fbba29378aa1","affectsGlobalScope":true,"impliedFormat":1},{"version":"d15bea3d62cbbdb9797079416b8ac375ae99162a7fba5de2c6c505446486ac0a","affectsGlobalScope":true,"impliedFormat":1},{"version":"68d18b664c9d32a7336a70235958b8997ebc1c3b8505f4f1ae2b7e7753b87618","affectsGlobalScope":true,"impliedFormat":1},{"version":"eb3d66c8327153d8fa7dd03f9c58d351107fe824c79e9b56b462935176cdf12a","affectsGlobalScope":true,"impliedFormat":1},{"version":"38f0219c9e23c915ef9790ab1d680440d95419ad264816fa15009a8851e79119","affectsGlobalScope":true,"impliedFormat":1},{"version":"69ab18c3b76cd9b1be3d188eaf8bba06112ebbe2f47f6c322b5105a6fbc45a2e","affectsGlobalScope":true,"impliedFormat":1},{"version":"a680117f487a4d2f30ea46f1b4b7f58bef1480456e18ba53ee85c2746eeca012","affectsGlobalScope":true,"impliedFormat":1},{"version":"2f11ff796926e0832f9ae148008138ad583bd181899ab7dd768a2666700b1893","affectsGlobalScope":true,"impliedFormat":1},{"version":"4de680d5bb41c17f7f68e0419412ca23c98d5749dcaaea1896172f06435891fc","affectsGlobalScope":true,"impliedFormat":1},{"version":"954296b30da6d508a104a3a0b5d96b76495c709785c1d11610908e63481ee667","affectsGlobalScope":true,"impliedFormat":1},{"version":"ac9538681b19688c8eae65811b329d3744af679e0bdfa5d842d0e32524c73e1c","affectsGlobalScope":true,"impliedFormat":1},{"version":"0a969edff4bd52585473d24995c5ef223f6652d6ef46193309b3921d65dd4376","affectsGlobalScope":true,"impliedFormat":1},{"version":"9e9fbd7030c440b33d021da145d3232984c8bb7916f277e8ffd3dc2e3eae2bdb","affectsGlobalScope":true,"impliedFormat":1},{"version":"811ec78f7fefcabbda4bfa93b3eb67d9ae166ef95f9bff989d964061cbf81a0c","affectsGlobalScope":true,"impliedFormat":1},{"version":"717937616a17072082152a2ef351cb51f98802fb4b2fdabd32399843875974ca","affectsGlobalScope":true,"impliedFormat":1},{"version":"d7e7d9b7b50e5f22c915b525acc5a49a7a6584cf8f62d0569e557c5cfc4b2ac2","affectsGlobalScope":true,"impliedFormat":1},{"version":"71c37f4c9543f31dfced6c7840e068c5a5aacb7b89111a4364b1d5276b852557","affectsGlobalScope":true,"impliedFormat":1},{"version":"576711e016cf4f1804676043e6a0a5414252560eb57de9faceee34d79798c850","affectsGlobalScope":true,"impliedFormat":1},{"version":"89c1b1281ba7b8a96efc676b11b264de7a8374c5ea1e6617f11880a13fc56dc6","affectsGlobalScope":true,"impliedFormat":1},{"version":"74f7fa2d027d5b33eb0471c8e82a6c87216223181ec31247c357a3e8e2fddc5b","affectsGlobalScope":true,"impliedFormat":1},{"version":"d6d7ae4d1f1f3772e2a3cde568ed08991a8ae34a080ff1151af28b7f798e22ca","affectsGlobalScope":true,"impliedFormat":1},{"version":"063600664504610fe3e99b717a1223f8b1900087fab0b4cad1496a114744f8df","affectsGlobalScope":true,"impliedFormat":1},{"version":"934019d7e3c81950f9a8426d093458b65d5aff2c7c1511233c0fd5b941e608ab","affectsGlobalScope":true,"impliedFormat":1},{"version":"52ada8e0b6e0482b728070b7639ee42e83a9b1c22d205992756fe020fd9f4a47","affectsGlobalScope":true,"impliedFormat":1},{"version":"3bdefe1bfd4d6dee0e26f928f93ccc128f1b64d5d501ff4a8cf3c6371200e5e6","affectsGlobalScope":true,"impliedFormat":1},{"version":"59fb2c069260b4ba00b5643b907ef5d5341b167e7d1dbf58dfd895658bda2867","affectsGlobalScope":true,"impliedFormat":1},{"version":"639e512c0dfc3fad96a84caad71b8834d66329a1f28dc95e3946c9b58176c73a","affectsGlobalScope":true,"impliedFormat":1},{"version":"368af93f74c9c932edd84c58883e736c9e3d53cec1fe24c0b0ff451f529ceab1","affectsGlobalScope":true,"impliedFormat":1},{"version":"af3dd424cf267428f30ccfc376f47a2c0114546b55c44d8c0f1d57d841e28d74","affectsGlobalScope":true,"impliedFormat":1},{"version":"995c005ab91a498455ea8dfb63aa9f83fa2ea793c3d8aa344be4a1678d06d399","affectsGlobalScope":true,"impliedFormat":1},{"version":"959d36cddf5e7d572a65045b876f2956c973a586da58e5d26cde519184fd9b8a","affectsGlobalScope":true,"impliedFormat":1},{"version":"965f36eae237dd74e6cca203a43e9ca801ce38824ead814728a2807b1910117d","affectsGlobalScope":true,"impliedFormat":1},{"version":"3925a6c820dcb1a06506c90b1577db1fdbf7705d65b62b99dce4be75c637e26b","affectsGlobalScope":true,"impliedFormat":1},{"version":"0a3d63ef2b853447ec4f749d3f368ce642264246e02911fcb1590d8c161b8005","affectsGlobalScope":true,"impliedFormat":1},{"version":"8cdf8847677ac7d20486e54dd3fcf09eda95812ac8ace44b4418da1bbbab6eb8","affectsGlobalScope":true,"impliedFormat":1},{"version":"8444af78980e3b20b49324f4a16ba35024fef3ee069a0eb67616ea6ca821c47a","affectsGlobalScope":true,"impliedFormat":1},{"version":"3287d9d085fbd618c3971944b65b4be57859f5415f495b33a6adc994edd2f004","affectsGlobalScope":true,"impliedFormat":1},{"version":"b4b67b1a91182421f5df999988c690f14d813b9850b40acd06ed44691f6727ad","affectsGlobalScope":true,"impliedFormat":1},{"version":"df83c2a6c73228b625b0beb6669c7ee2a09c914637e2d35170723ad49c0f5cd4","affectsGlobalScope":true,"impliedFormat":1},{"version":"436aaf437562f276ec2ddbee2f2cdedac7664c1e4c1d2c36839ddd582eeb3d0a","affectsGlobalScope":true,"impliedFormat":1},{"version":"8e3c06ea092138bf9fa5e874a1fdbc9d54805d074bee1de31b99a11e2fec239d","affectsGlobalScope":true,"impliedFormat":1},{"version":"87dc0f382502f5bbce5129bdc0aea21e19a3abbc19259e0b43ae038a9fc4e326","affectsGlobalScope":true,"impliedFormat":1},{"version":"b1cb28af0c891c8c96b2d6b7be76bd394fddcfdb4709a20ba05a7c1605eea0f9","affectsGlobalScope":true,"impliedFormat":1},{"version":"2fef54945a13095fdb9b84f705f2b5994597640c46afeb2ce78352fab4cb3279","affectsGlobalScope":true,"impliedFormat":1},{"version":"ac77cb3e8c6d3565793eb90a8373ee8033146315a3dbead3bde8db5eaf5e5ec6","affectsGlobalScope":true,"impliedFormat":1},{"version":"56e4ed5aab5f5920980066a9409bfaf53e6d21d3f8d020c17e4de584d29600ad","affectsGlobalScope":true,"impliedFormat":1},{"version":"4ece9f17b3866cc077099c73f4983bddbcb1dc7ddb943227f1ec070f529dedd1","affectsGlobalScope":true,"impliedFormat":1},{"version":"0a6282c8827e4b9a95f4bf4f5c205673ada31b982f50572d27103df8ceb8013c","affectsGlobalScope":true,"impliedFormat":1},{"version":"1c9319a09485199c1f7b0498f2988d6d2249793ef67edda49d1e584746be9032","affectsGlobalScope":true,"impliedFormat":1},{"version":"e3a2a0cee0f03ffdde24d89660eba2685bfbdeae955a6c67e8c4c9fd28928eeb","affectsGlobalScope":true,"impliedFormat":1},{"version":"811c71eee4aa0ac5f7adf713323a5c41b0cf6c4e17367a34fbce379e12bbf0a4","affectsGlobalScope":true,"impliedFormat":1},{"version":"51ad4c928303041605b4d7ae32e0c1ee387d43a24cd6f1ebf4a2699e1076d4fa","affectsGlobalScope":true,"impliedFormat":1},{"version":"60037901da1a425516449b9a20073aa03386cce92f7a1fd902d7602be3a7c2e9","affectsGlobalScope":true,"impliedFormat":1},{"version":"d4b1d2c51d058fc21ec2629fff7a76249dec2e36e12960ea056e3ef89174080f","affectsGlobalScope":true,"impliedFormat":1},{"version":"22adec94ef7047a6c9d1af3cb96be87a335908bf9ef386ae9fd50eeb37f44c47","affectsGlobalScope":true,"impliedFormat":1},{"version":"196cb558a13d4533a5163286f30b0509ce0210e4b316c56c38d4c0fd2fb38405","affectsGlobalScope":true,"impliedFormat":1},{"version":"73f78680d4c08509933daf80947902f6ff41b6230f94dd002ae372620adb0f60","affectsGlobalScope":true,"impliedFormat":1},{"version":"c5239f5c01bcfa9cd32f37c496cf19c61d69d37e48be9de612b541aac915805b","affectsGlobalScope":true,"impliedFormat":1},{"version":"8e7f8264d0fb4c5339605a15daadb037bf238c10b654bb3eee14208f860a32ea","affectsGlobalScope":true,"impliedFormat":1},{"version":"782dec38049b92d4e85c1585fbea5474a219c6984a35b004963b00beb1aab538","affectsGlobalScope":true,"impliedFormat":1},{"version":"170d4db14678c68178ee8a3d5a990d5afb759ecb6ec44dbd885c50f6da6204f6","affectsGlobalScope":true,"impliedFormat":1},{"version":"ac51dd7d31333793807a6abaa5ae168512b6131bd41d9c5b98477fc3b7800f9f","impliedFormat":1},{"version":"cf8db38686dfd74567ea692266fe44fbb32fa0e25fc0888ad6fc40e65873607e","impliedFormat":1},{"version":"acd8fd5090ac73902278889c38336ff3f48af6ba03aa665eb34a75e7ba1dccc4","impliedFormat":1},{"version":"d6258883868fb2680d2ca96bc8b1352cab69874581493e6d52680c5ffecdb6cc","impliedFormat":1},{"version":"1b61d259de5350f8b1e5db06290d31eaebebc6baafd5f79d314b5af9256d7153","impliedFormat":1},{"version":"f258e3960f324a956fc76a3d3d9e964fff2244ff5859dcc6ce5951e5413ca826","impliedFormat":1},{"version":"643f7232d07bf75e15bd8f658f664d6183a0efaca5eb84b48201c7671a266979","impliedFormat":1},{"version":"21da358700a3893281ce0c517a7a30cbd46be020d9f0c3f2834d0a8ad1f5fc75","impliedFormat":1},{"version":"70521b6ab0dcba37539e5303104f29b721bfb2940b2776da4cc818c07e1fefc1","affectsGlobalScope":true,"impliedFormat":1},{"version":"ab41ef1f2cdafb8df48be20cd969d875602483859dc194e9c97c8a576892c052","affectsGlobalScope":true,"impliedFormat":1},{"version":"d153a11543fd884b596587ccd97aebbeed950b26933ee000f94009f1ab142848","affectsGlobalScope":true,"impliedFormat":1},{"version":"21d819c173c0cf7cc3ce57c3276e77fd9a8a01d35a06ad87158781515c9a438a","impliedFormat":1},{"version":"98cffbf06d6bab333473c70a893770dbe990783904002c4f1a960447b4b53dca","affectsGlobalScope":true,"impliedFormat":1},{"version":"ba481bca06f37d3f2c137ce343c7d5937029b2468f8e26111f3c9d9963d6568d","affectsGlobalScope":true,"impliedFormat":1},{"version":"6d9ef24f9a22a88e3e9b3b3d8c40ab1ddb0853f1bfbd5c843c37800138437b61","affectsGlobalScope":true,"impliedFormat":1},{"version":"1db0b7dca579049ca4193d034d835f6bfe73096c73663e5ef9a0b5779939f3d0","affectsGlobalScope":true,"impliedFormat":1},{"version":"9798340ffb0d067d69b1ae5b32faa17ab31b82466a3fc00d8f2f2df0c8554aaa","affectsGlobalScope":true,"impliedFormat":1},{"version":"f26b11d8d8e4b8028f1c7d618b22274c892e4b0ef5b3678a8ccbad85419aef43","affectsGlobalScope":true,"impliedFormat":1},{"version":"5929864ce17fba74232584d90cb721a89b7ad277220627cc97054ba15a98ea8f","impliedFormat":1},{"version":"763fe0f42b3d79b440a9b6e51e9ba3f3f91352469c1e4b3b67bfa4ff6352f3f4","impliedFormat":1},{"version":"25c8056edf4314820382a5fdb4bb7816999acdcb929c8f75e3f39473b87e85bc","impliedFormat":1},{"version":"c464d66b20788266e5353b48dc4aa6bc0dc4a707276df1e7152ab0c9ae21fad8","impliedFormat":1},{"version":"78d0d27c130d35c60b5e5566c9f1e5be77caf39804636bc1a40133919a949f21","impliedFormat":1},{"version":"c6fd2c5a395f2432786c9cb8deb870b9b0e8ff7e22c029954fabdd692bff6195","impliedFormat":1},{"version":"1d6e127068ea8e104a912e42fc0a110e2aa5a66a356a917a163e8cf9a65e4a75","impliedFormat":1},{"version":"5ded6427296cdf3b9542de4471d2aa8d3983671d4cac0f4bf9c637208d1ced43","impliedFormat":1},{"version":"7f182617db458e98fc18dfb272d40aa2fff3a353c44a89b2c0ccb3937709bfb5","impliedFormat":1},{"version":"cadc8aced301244057c4e7e73fbcae534b0f5b12a37b150d80e5a45aa4bebcbd","impliedFormat":1},{"version":"385aab901643aa54e1c36f5ef3107913b10d1b5bb8cbcd933d4263b80a0d7f20","impliedFormat":1},{"version":"9670d44354bab9d9982eca21945686b5c24a3f893db73c0dae0fd74217a4c219","impliedFormat":1},{"version":"0b8a9268adaf4da35e7fa830c8981cfa22adbbe5b3f6f5ab91f6658899e657a7","impliedFormat":1},{"version":"11396ed8a44c02ab9798b7dca436009f866e8dae3c9c25e8c1fbc396880bf1bb","impliedFormat":1},{"version":"ba7bc87d01492633cb5a0e5da8a4a42a1c86270e7b3d2dea5d156828a84e4882","impliedFormat":1},{"version":"4893a895ea92c85345017a04ed427cbd6a1710453338df26881a6019432febdd","impliedFormat":1},{"version":"c21dc52e277bcfc75fac0436ccb75c204f9e1b3fa5e12729670910639f27343e","impliedFormat":1},{"version":"13f6f39e12b1518c6650bbb220c8985999020fe0f21d818e28f512b7771d00f9","impliedFormat":1},{"version":"9b5369969f6e7175740bf51223112ff209f94ba43ecd3bb09eefff9fd675624a","impliedFormat":1},{"version":"4fe9e626e7164748e8769bbf74b538e09607f07ed17c2f20af8d680ee49fc1da","impliedFormat":1},{"version":"24515859bc0b836719105bb6cc3d68255042a9f02a6022b3187948b204946bd2","impliedFormat":1},{"version":"ea0148f897b45a76544ae179784c95af1bd6721b8610af9ffa467a518a086a43","impliedFormat":1},{"version":"24c6a117721e606c9984335f71711877293a9651e44f59f3d21c1ea0856f9cc9","impliedFormat":1},{"version":"dd3273ead9fbde62a72949c97dbec2247ea08e0c6952e701a483d74ef92d6a17","impliedFormat":1},{"version":"405822be75ad3e4d162e07439bac80c6bcc6dbae1929e179cf467ec0b9ee4e2e","impliedFormat":1},{"version":"0db18c6e78ea846316c012478888f33c11ffadab9efd1cc8bcc12daded7a60b6","impliedFormat":1},{"version":"e61be3f894b41b7baa1fbd6a66893f2579bfad01d208b4ff61daef21493ef0a8","impliedFormat":1},{"version":"bd0532fd6556073727d28da0edfd1736417a3f9f394877b6d5ef6ad88fba1d1a","impliedFormat":1},{"version":"89167d696a849fce5ca508032aabfe901c0868f833a8625d5a9c6e861ef935d2","impliedFormat":1},{"version":"615ba88d0128ed16bf83ef8ccbb6aff05c3ee2db1cc0f89ab50a4939bfc1943f","impliedFormat":1},{"version":"a4d551dbf8746780194d550c88f26cf937caf8d56f102969a110cfaed4b06656","impliedFormat":1},{"version":"8bd86b8e8f6a6aa6c49b71e14c4ffe1211a0e97c80f08d2c8cc98838006e4b88","impliedFormat":1},{"version":"317e63deeb21ac07f3992f5b50cdca8338f10acd4fbb7257ebf56735bf52ab00","impliedFormat":1},{"version":"4732aec92b20fb28c5fe9ad99521fb59974289ed1e45aecb282616202184064f","impliedFormat":1},{"version":"2e85db9e6fd73cfa3d7f28e0ab6b55417ea18931423bd47b409a96e4a169e8e6","impliedFormat":1},{"version":"c46e079fe54c76f95c67fb89081b3e399da2c7d109e7dca8e4b58d83e332e605","impliedFormat":1},{"version":"bf67d53d168abc1298888693338cb82854bdb2e69ef83f8a0092093c2d562107","impliedFormat":1},{"version":"2cbe0621042e2a68c7cbce5dfed3906a1862a16a7d496010636cdbdb91341c0f","affectsGlobalScope":true,"impliedFormat":1},{"version":"e2677634fe27e87348825bb041651e22d50a613e2fdf6a4a3ade971d71bac37e","impliedFormat":1},{"version":"7394959e5a741b185456e1ef5d64599c36c60a323207450991e7a42e08911419","impliedFormat":1},{"version":"8c0bcd6c6b67b4b503c11e91a1fb91522ed585900eab2ab1f61bba7d7caa9d6f","impliedFormat":1},{"version":"8cd19276b6590b3ebbeeb030ac271871b9ed0afc3074ac88a94ed2449174b776","affectsGlobalScope":true,"impliedFormat":1},{"version":"696eb8d28f5949b87d894b26dc97318ef944c794a9a4e4f62360cd1d1958014b","impliedFormat":1},{"version":"3f8fa3061bd7402970b399300880d55257953ee6d3cd408722cb9ac20126460c","impliedFormat":1},{"version":"35ec8b6760fd7138bbf5809b84551e31028fb2ba7b6dc91d95d098bf212ca8b4","affectsGlobalScope":true,"impliedFormat":1},{"version":"5524481e56c48ff486f42926778c0a3cce1cc85dc46683b92b1271865bcf015a","impliedFormat":1},{"version":"68bd56c92c2bd7d2339457eb84d63e7de3bd56a69b25f3576e1568d21a162398","affectsGlobalScope":true,"impliedFormat":1},{"version":"3e93b123f7c2944969d291b35fed2af79a6e9e27fdd5faa99748a51c07c02d28","impliedFormat":1},{"version":"9d19808c8c291a9010a6c788e8532a2da70f811adb431c97520803e0ec649991","impliedFormat":1},{"version":"87aad3dd9752067dc875cfaa466fc44246451c0c560b820796bdd528e29bef40","impliedFormat":1},{"version":"4aacb0dd020eeaef65426153686cc639a78ec2885dc72ad220be1d25f1a439df","impliedFormat":1},{"version":"f0bd7e6d931657b59605c44112eaf8b980ba7f957a5051ed21cb93d978cf2f45","impliedFormat":1},{"version":"8db0ae9cb14d9955b14c214f34dae1b9ef2baee2fe4ce794a4cd3ac2531e3255","affectsGlobalScope":true,"impliedFormat":1},{"version":"15fc6f7512c86810273af28f224251a5a879e4261b4d4c7e532abfbfc3983134","impliedFormat":1},{"version":"58adba1a8ab2d10b54dc1dced4e41f4e7c9772cbbac40939c0dc8ce2cdb1d442","impliedFormat":1},{"version":"2fd4c143eff88dabb57701e6a40e02a4dbc36d5eb1362e7964d32028056a782b","impliedFormat":1},{"version":"714435130b9015fae551788df2a88038471a5a11eb471f27c4ede86552842bc9","impliedFormat":1},{"version":"855cd5f7eb396f5f1ab1bc0f8580339bff77b68a770f84c6b254e319bbfd1ac7","impliedFormat":1},{"version":"5650cf3dace09e7c25d384e3e6b818b938f68f4e8de96f52d9c5a1b3db068e86","impliedFormat":1},{"version":"1354ca5c38bd3fd3836a68e0f7c9f91f172582ba30ab15bb8c075891b91502b7","affectsGlobalScope":true,"impliedFormat":1},{"version":"27fdb0da0daf3b337c5530c5f266efe046a6ceb606e395b346974e4360c36419","impliedFormat":1},{"version":"2d2fcaab481b31a5882065c7951255703ddbe1c0e507af56ea42d79ac3911201","impliedFormat":1},{"version":"a192fe8ec33f75edbc8d8f3ed79f768dfae11ff5735e7fe52bfa69956e46d78d","impliedFormat":1},{"version":"ca867399f7db82df981d6915bcbb2d81131d7d1ef683bc782b59f71dda59bc85","affectsGlobalScope":true,"impliedFormat":1},{"version":"6abe2fd8671c5f80c4c58a404f81ddf39cb7a69df1ad5c50c86debf0ea5ec8e9","affectsGlobalScope":true,"impliedFormat":1},{"version":"9e043a1bc8fbf2a255bccf9bf27e0f1caf916c3b0518ea34aa72357c0afd42ec","impliedFormat":1},{"version":"b4f70ec656a11d570e1a9edce07d118cd58d9760239e2ece99306ee9dfe61d02","impliedFormat":1},{"version":"3bc2f1e2c95c04048212c569ed38e338873f6a8593930cf5a7ef24ffb38fc3b6","impliedFormat":1},{"version":"6e70e9570e98aae2b825b533aa6292b6abd542e8d9f6e9475e88e1d7ba17c866","impliedFormat":1},{"version":"f9d9d753d430ed050dc1bf2667a1bab711ccbb1c1507183d794cc195a5b085cc","impliedFormat":1},{"version":"9eece5e586312581ccd106d4853e861aaaa1a39f8e3ea672b8c3847eedd12f6e","impliedFormat":1},{"version":"47ab634529c5955b6ad793474ae188fce3e6163e3a3fb5edd7e0e48f14435333","impliedFormat":1},{"version":"37ba7b45141a45ce6e80e66f2a96c8a5ab1bcef0fc2d0f56bb58df96ec67e972","impliedFormat":1},{"version":"45650f47bfb376c8a8ed39d4bcda5902ab899a3150029684ee4c10676d9fbaee","impliedFormat":1},{"version":"0225ecb9ed86bdb7a2c7fd01f1556906902929377b44483dc4b83e03b3ef227d","affectsGlobalScope":true,"impliedFormat":1},{"version":"74cf591a0f63db318651e0e04cb55f8791385f86e987a67fd4d2eaab8191f730","impliedFormat":1},{"version":"5eab9b3dc9b34f185417342436ec3f106898da5f4801992d8ff38ab3aff346b5","impliedFormat":1},{"version":"12ed4559eba17cd977aa0db658d25c4047067444b51acfdcbf38470630642b23","affectsGlobalScope":true,"impliedFormat":1},{"version":"f3ffabc95802521e1e4bcba4c88d8615176dc6e09111d920c7a213bdda6e1d65","impliedFormat":1},{"version":"ddc734b4fae82a01d247e9e342d020976640b5e93b4e9b3a1e30e5518883a060","impliedFormat":1},{"version":"ae56f65caf3be91108707bd8dfbccc2a57a91feb5daabf7165a06a945545ed26","impliedFormat":1},{"version":"a136d5de521da20f31631a0a96bf712370779d1c05b7015d7019a9b2a0446ca9","impliedFormat":1},{"version":"c3b41e74b9a84b88b1dca61ec39eee25c0dbc8e7d519ba11bb070918cfacf656","affectsGlobalScope":true,"impliedFormat":1},{"version":"4737a9dc24d0e68b734e6cfbcea0c15a2cfafeb493485e27905f7856988c6b29","affectsGlobalScope":true,"impliedFormat":1},{"version":"36d8d3e7506b631c9582c251a2c0b8a28855af3f76719b12b534c6edf952748d","impliedFormat":1},{"version":"1ca69210cc42729e7ca97d3a9ad48f2e9cb0042bada4075b588ae5387debd318","impliedFormat":1},{"version":"f5ebe66baaf7c552cfa59d75f2bfba679f329204847db3cec385acda245e574e","impliedFormat":1},{"version":"ed59add13139f84da271cafd32e2171876b0a0af2f798d0c663e8eeb867732cf","affectsGlobalScope":true,"impliedFormat":1},{"version":"05db535df8bdc30d9116fe754a3473d1b6479afbc14ae8eb18b605c62677d518","impliedFormat":1},{"version":"b1810689b76fd473bd12cc9ee219f8e62f54a7d08019a235d07424afbf074d25","impliedFormat":1},{"version":"24259d3dae14de55d22f8b3d3e96954e5175a925ab6a830dc05a1993d4794eda","impliedFormat":1},{"version":"27e046d30d55669e9b5a325788a9b4073b05ce62607867754d2918af559a0877","impliedFormat":1},{"version":"be1cc4d94ea60cbe567bc29ed479d42587bf1e6cba490f123d329976b0fe4ee5","impliedFormat":1},{"version":"42bc0e1a903408137c3df2b06dfd7e402cdab5bbfa5fcfb871b22ebfdb30bd0b","impliedFormat":1},{"version":"9894dafe342b976d251aac58e616ac6df8db91fb9d98934ff9dd103e9e82578f","impliedFormat":1},{"version":"413df52d4ea14472c2fa5bee62f7a40abd1eb49be0b9722ee01ee4e52e63beb2","impliedFormat":1},{"version":"db6d2d9daad8a6d83f281af12ce4355a20b9a3e71b82b9f57cddcca0a8964a96","impliedFormat":1},{"version":"446a50749b24d14deac6f8843e057a6355dd6437d1fac4f9e5ce4a5071f34bff","impliedFormat":1},{"version":"182e9fcbe08ac7c012e0a6e2b5798b4352470be29a64fdc114d23c2bab7d5106","impliedFormat":1},{"version":"5c9b31919ea1cb350a7ae5e71c9ced8f11723e4fa258a8cc8d16ae46edd623c7","impliedFormat":1},{"version":"4aa42ce8383b45823b3a1d3811c0fdd5f939f90254bc4874124393febbaf89f6","impliedFormat":1},{"version":"96ffa70b486207241c0fcedb5d9553684f7fa6746bc2b04c519e7ebf41a51205","impliedFormat":1},{"version":"5c24c66b3ba29ce9f2a79c719967e6e944131352a117a0bc43fa5b346b5562b3","impliedFormat":1},{"version":"a86f82d646a739041d6702101afa82dcb935c416dd93cbca7fd754fd0282ce1f","impliedFormat":1},{"version":"ad0d1d75d129b1c80f911be438d6b61bfa8703930a8ff2be2f0e1f8a91841c64","impliedFormat":1},{"version":"ce75b1aebb33d510ff28af960a9221410a3eaf7f18fc5f21f9404075fba77256","impliedFormat":1},{"version":"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855","impliedFormat":1},{"version":"02436d7e9ead85e09a2f8e27d5f47d9464bced31738dec138ca735390815c9f0","impliedFormat":1},{"version":"f4625edcb57b37b84506e8b276eb59ca30d31f88c6656d29d4e90e3bc58e69df","impliedFormat":1},{"version":"78a2869ad0cbf3f9045dda08c0d4562b7e1b2bfe07b19e0db072f5c3c56e9584","impliedFormat":1},{"version":"f8d5ff8eafd37499f2b6a98659dd9b45a321de186b8db6b6142faed0fea3de77","impliedFormat":1},{"version":"c86fe861cf1b4c46a0fb7d74dffe596cf679a2e5e8b1456881313170f092e3fa","impliedFormat":1},{"version":"c685d9f68c70fe11ce527287526585a06ea13920bb6c18482ca84945a4e433a7","impliedFormat":1},{"version":"540cc83ab772a2c6bc509fe1354f314825b5dba3669efdfbe4693ecd3048e34f","impliedFormat":1},{"version":"121b0696021ab885c570bbeb331be8ad82c6efe2f3b93a6e63874901bebc13e3","impliedFormat":1},{"version":"4e01846df98d478a2a626ec3641524964b38acaac13945c2db198bf9f3df22ee","impliedFormat":1},{"version":"678d6d4c43e5728bf66e92fc2269da9fa709cb60510fed988a27161473c3853f","impliedFormat":1},{"version":"ffa495b17a5ef1d0399586b590bd281056cee6ce3583e34f39926f8dcc6ecdb5","impliedFormat":1},{"version":"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855","impliedFormat":1},{"version":"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855","impliedFormat":1},{"version":"8e609bb71c20b858c77f0e9f90bb1319db8477b13f9f965f1a1e18524bf50881","impliedFormat":1},{"version":"8e609bb71c20b858c77f0e9f90bb1319db8477b13f9f965f1a1e18524bf50881","impliedFormat":1},{"version":"aa14cee20aa0db79f8df101fc027d929aec10feb5b8a8da3b9af3895d05b7ba2","impliedFormat":1},{"version":"493c700ac3bd317177b2eb913805c87fe60d4e8af4fb39c41f04ba81fae7e170","impliedFormat":1},{"version":"aeb554d876c6b8c818da2e118d8b11e1e559adbe6bf606cc9a611c1b6c09f670","impliedFormat":1},{"version":"acf5a2ac47b59ca07afa9abbd2b31d001bf7448b041927befae2ea5b1951d9f9","impliedFormat":1},{"version":"8e609bb71c20b858c77f0e9f90bb1319db8477b13f9f965f1a1e18524bf50881","impliedFormat":1},{"version":"d71291eff1e19d8762a908ba947e891af44749f3a2cbc5bd2ec4b72f72ea795f","impliedFormat":1},{"version":"c0480e03db4b816dff2682b347c95f2177699525c54e7e6f6aa8ded890b76be7","impliedFormat":1},{"version":"e2a37ac938c4bede5bb284b9d2d042da299528f1e61f6f57538f1bd37d760869","impliedFormat":1},{"version":"76def37aff8e3a051cf406e10340ffba0f28b6991c5d987474cc11137796e1eb","impliedFormat":1},{"version":"b620391fe8060cf9bedc176a4d01366e6574d7a71e0ac0ab344a4e76576fcbb8","impliedFormat":1},{"version":"3e7efde639c6a6c3edb9847b3f61e308bf7a69685b92f665048c45132f51c218","impliedFormat":1},{"version":"df45ca1176e6ac211eae7ddf51336dc075c5314bc5c253651bae639defd5eec5","impliedFormat":1},{"version":"106c6025f1d99fd468fd8bf6e5bda724e11e5905a4076c5d29790b6c3745e50c","impliedFormat":1},{"version":"ee8df1cb8d0faaca4013a1b442e99130769ce06f438d18d510fed95890067563","impliedFormat":1},{"version":"bfb7f8475428637bee12bdd31bd9968c1c8a1cc2c3e426c959e2f3a307f8936f","impliedFormat":1},{"version":"6f491d0108927478d3247bbbc489c78c2da7ef552fd5277f1ab6819986fdf0b1","impliedFormat":1},{"version":"0d8f2b8781c721170b87a6b662b3cb038fd1a721165ecca390352c818d425872","impliedFormat":1},{"version":"7cb0ee103671d1e201cd53dda12bc1cd0a35f1c63d6102720c6eeb322cb8e17e","impliedFormat":1},{"version":"15a234e5031b19c48a69ccc1607522d6e4b50f57d308ecb7fe863d44cd9f9eb3","impliedFormat":1},{"version":"148679c6d0f449210a96e7d2e562d589e56fcde87f843a92808b3ff103f1a774","impliedFormat":1},{"version":"6459054aabb306821a043e02b89d54da508e3a6966601a41e71c166e4ea1474f","impliedFormat":1},{"version":"2f9c89cbb29d362290531b48880a4024f258c6033aaeb7e59fbc62db26819650","impliedFormat":1},{"version":"bb37588926aba35c9283fe8d46ebf4e79ffe976343105f5c6d45f282793352b2","impliedFormat":1},{"version":"05c97cddbaf99978f83d96de2d8af86aded9332592f08ce4a284d72d0952c391","impliedFormat":1},{"version":"72179f9dd22a86deaad4cc3490eb0fe69ee084d503b686985965654013f1391b","impliedFormat":1},{"version":"2e6114a7dd6feeef85b2c80120fdbfb59a5529c0dcc5bfa8447b6996c97a69f5","impliedFormat":1},{"version":"7b6ff760c8a240b40dab6e4419b989f06a5b782f4710d2967e67c695ef3e93c4","impliedFormat":1},{"version":"c8f004e6036aa1c764ad4ec543cf89a5c1893a9535c80ef3f2b653e370de45e6","impliedFormat":1},{"version":"dd80b1e600d00f5c6a6ba23f455b84a7db121219e68f89f10552c54ba46e4dc9","impliedFormat":1},{"version":"b064c36f35de7387d71c599bfcf28875849a1dbc733e82bd26cae3d1cd060521","impliedFormat":1},{"version":"05c7280d72f3ed26f346cbe7cbbbb002fb7f15739197cbbee6ab3fd1a6cb9347","impliedFormat":1},{"version":"8de9fe97fa9e00ec00666fa77ab6e91b35d25af8ca75dabcb01e14ad3299b150","impliedFormat":1},{"version":"803cd2aaf1921c218916c2c7ee3fce653e852d767177eb51047ff15b5b253893","impliedFormat":1},{"version":"dba114fb6a32b355a9cfc26ca2276834d72fe0e94cd2c3494005547025015369","impliedFormat":1},{"version":"7ab12b2f1249187223d11a589f5789c75177a0b597b9eb7f8e2e42d045393347","impliedFormat":1},{"version":"ad37fb4be61c1035b68f532b7220f4e8236cf245381ce3b90ac15449ecfe7305","impliedFormat":1},{"version":"93436bd74c66baba229bfefe1314d122c01f0d4c1d9e35081a0c4f0470ac1a6c","impliedFormat":1},{"version":"f974e4a06953682a2c15d5bd5114c0284d5abf8bc0fe4da25cb9159427b70072","impliedFormat":1},{"version":"50256e9c31318487f3752b7ac12ff365c8949953e04568009c8705db802776fb","impliedFormat":1},{"version":"7d73b24e7bf31dfb8a931ca6c4245f6bb0814dfae17e4b60c9e194a631fe5f7b","impliedFormat":1},{"version":"d130c5f73768de51402351d5dc7d1b36eaec980ca697846e53156e4ea9911476","impliedFormat":1},{"version":"413586add0cfe7369b64979d4ec2ed56c3f771c0667fbde1bf1f10063ede0b08","impliedFormat":1},{"version":"06472528e998d152375ad3bd8ebcb69ff4694fd8d2effaf60a9d9f25a37a097a","impliedFormat":1},{"version":"50b5bc34ce6b12eccb76214b51aadfa56572aa6cc79c2b9455cdbb3d6c76af1d","impliedFormat":1},{"version":"b7e16ef7f646a50991119b205794ebfd3a4d8f8e0f314981ebbe991639023d0e","impliedFormat":1},{"version":"42c169fb8c2d42f4f668c624a9a11e719d5d07dacbebb63cbcf7ef365b0a75b3","impliedFormat":1},{"version":"a401617604fa1f6ce437b81689563dfdc377069e4c58465dbd8d16069aede0a5","impliedFormat":1},{"version":"6e9082e91370de5040e415cd9f24e595b490382e8c7402c4e938a8ce4bccc99f","impliedFormat":1},{"version":"8695dec09ad439b0ceef3776ea68a232e381135b516878f0901ed2ea114fd0fe","impliedFormat":1},{"version":"304b44b1e97dd4c94697c3313df89a578dca4930a104454c99863f1784a54357","impliedFormat":1},{"version":"d682336018141807fb602709e2d95a192828fcb8d5ba06dda3833a8ea98f69e3","impliedFormat":1},{"version":"6124e973eab8c52cabf3c07575204efc1784aca6b0a30c79eb85fe240a857efa","impliedFormat":1},{"version":"0d891735a21edc75df51f3eb995e18149e119d1ce22fd40db2b260c5960b914e","impliedFormat":1},{"version":"3b414b99a73171e1c4b7b7714e26b87d6c5cb03d200352da5342ab4088a54c85","impliedFormat":1},{"version":"4fbd3116e00ed3a6410499924b6403cc9367fdca303e34838129b328058ede40","impliedFormat":1},{"version":"b01bd582a6e41457bc56e6f0f9de4cb17f33f5f3843a7cf8210ac9c18472fb0f","impliedFormat":1},{"version":"0a437ae178f999b46b6153d79095b60c42c996bc0458c04955f1c996dc68b971","impliedFormat":1},{"version":"74b2a5e5197bd0f2e0077a1ea7c07455bbea67b87b0869d9786d55104006784f","impliedFormat":1},{"version":"4a7baeb6325920044f66c0f8e5e6f1f52e06e6d87588d837bdf44feb6f35c664","impliedFormat":1},{"version":"12d218a49dbe5655b911e6cc3c13b2c655e4c783471c3b0432137769c79e1b3c","impliedFormat":1},{"version":"7274fbffbd7c9589d8d0ffba68157237afd5cecff1e99881ea3399127e60572f","impliedFormat":1},{"version":"6b0fc04121360f752d196ba35b6567192f422d04a97b2840d7d85f8b79921c92","impliedFormat":1},{"version":"65a15fc47900787c0bd18b603afb98d33ede930bed1798fc984d5ebb78b26cf9","impliedFormat":1},{"version":"9d202701f6e0744adb6314d03d2eb8fc994798fc83d91b691b75b07626a69801","impliedFormat":1},{"version":"a365c4d3bed3be4e4e20793c999c51f5cd7e6792322f14650949d827fbcd170f","impliedFormat":1},{"version":"c5426dbfc1cf90532f66965a7aa8c1136a78d4d0f96d8180ecbfc11d7722f1a5","impliedFormat":1},{"version":"9c82171d836c47486074e4ca8e059735bf97b205e70b196535b5efd40cbe1bc5","impliedFormat":1},{"version":"f374cb24e93e7798c4d9e83ff872fa52d2cdb36306392b840a6ddf46cb925cb6","impliedFormat":1},{"version":"42b81043b00ff27c6bd955aea0f6e741545f2265978bf364b614702b72a027ab","impliedFormat":1},{"version":"de9d2df7663e64e3a91bf495f315a7577e23ba088f2949d5ce9ec96f44fba37d","impliedFormat":1},{"version":"c7af78a2ea7cb1cd009cfb5bdb48cd0b03dad3b54f6da7aab615c2e9e9d570c5","impliedFormat":1},{"version":"1ee45496b5f8bdee6f7abc233355898e5bf9bd51255db65f5ff7ede617ca0027","impliedFormat":1},{"version":"97e5ccc7bb88419005cbdf812243a5b3186cdef81b608540acabe1be163fc3e4","affectsGlobalScope":true,"impliedFormat":1},{"version":"3fbdd025f9d4d820414417eeb4107ffa0078d454a033b506e22d3a23bc3d9c41","affectsGlobalScope":true,"impliedFormat":1},{"version":"a8f8e6ab2fa07b45251f403548b78eaf2022f3c2254df3dc186cb2671fe4996d","affectsGlobalScope":true,"impliedFormat":1},{"version":"fa6c12a7c0f6b84d512f200690bfc74819e99efae69e4c95c4cd30f6884c526e","impliedFormat":1},{"version":"f1c32f9ce9c497da4dc215c3bc84b722ea02497d35f9134db3bb40a8d918b92b","impliedFormat":1},{"version":"b73c319af2cc3ef8f6421308a250f328836531ea3761823b4cabbd133047aefa","affectsGlobalScope":true,"impliedFormat":1},{"version":"e433b0337b8106909e7953015e8fa3f2d30797cea27141d1c5b135365bb975a6","impliedFormat":1},{"version":"9f9bb6755a8ce32d656ffa4763a8144aa4f274d6b69b59d7c32811031467216e","impliedFormat":1},{"version":"5c32bdfbd2d65e8fffbb9fbda04d7165e9181b08dad61154961852366deb7540","impliedFormat":1},{"version":"ddff7fc6edbdc5163a09e22bf8df7bef75f75369ebd7ecea95ba55c4386e2441","impliedFormat":1},{"version":"6b3453eebd474cc8acf6d759f1668e6ce7425a565e2996a20b644c72916ecf75","impliedFormat":1},{"version":"0c05e9842ec4f8b7bfebfd3ca61604bb8c914ba8da9b5337c4f25da427a005f2","impliedFormat":1},{"version":"89cd3444e389e42c56fd0d072afef31387e7f4107651afd2c03950f22dc36f77","impliedFormat":1},{"version":"7f2aa4d4989a82530aaac3f72b3dceca90e9c25bee0b1a327e8a08a1262435ad","impliedFormat":1},{"version":"e39a304f882598138a8022106cb8de332abbbb87f3fee71c5ca6b525c11c51fc","impliedFormat":1},{"version":"faed7a5153215dbd6ebe76dfdcc0af0cfe760f7362bed43284be544308b114cf","impliedFormat":1},{"version":"fcdf3e40e4a01b9a4b70931b8b51476b210c511924fcfe3f0dae19c4d52f1a54","impliedFormat":1},{"version":"345c4327b637d34a15aba4b7091eb068d6ab40a3dedaab9f00986253c9704e53","impliedFormat":1},{"version":"3a788c7fb7b1b1153d69a4d1d9e1d0dfbcf1127e703bdb02b6d12698e683d1fb","impliedFormat":1},{"version":"2e4f37ffe8862b14d8e24ae8763daaa8340c0df0b859d9a9733def0eee7562d9","impliedFormat":1},{"version":"d38530db0601215d6d767f280e3a3c54b2a83b709e8d9001acb6f61c67e965fc","impliedFormat":1},{"version":"6ac6715916fa75a1f7ebdfeacac09513b4d904b667d827b7535e84ff59679aff","impliedFormat":1},{"version":"4805f6161c2c8cefb8d3b8bd96a080c0fe8dbc9315f6ad2e53238f9a79e528a6","impliedFormat":1},{"version":"b83cb14474fa60c5f3ec660146b97d122f0735627f80d82dd03e8caa39b4388c","impliedFormat":1},{"version":"2b5b70d7782fe028487a80a1c214e67bd610532b9f978b78fa60f5b4a359f77e","impliedFormat":1},{"version":"7ee86fbb3754388e004de0ef9e6505485ddfb3be7640783d6d015711c03d302d","impliedFormat":1},{"version":"1a82deef4c1d39f6882f28d275cad4c01f907b9b39be9cbc472fcf2cf051e05b","impliedFormat":1},{"version":"162e071992b34bc36ca257d629547f93cb43728d6fe073ad18a237e4f7c52d7d","impliedFormat":1},{"version":"b73cbf0a72c8800cf8f96a9acfe94f3ad32ca71342a8908b8ae484d61113f647","impliedFormat":1},{"version":"bae6dd176832f6423966647382c0d7ba9e63f8c167522f09a982f086cd4e8b23","impliedFormat":1},{"version":"20865ac316b8893c1a0cc383ccfc1801443fbcc2a7255be166cf90d03fac88c9","impliedFormat":1},{"version":"c9958eb32126a3843deedda8c22fb97024aa5d6dd588b90af2d7f2bfac540f23","impliedFormat":1},{"version":"461d0ad8ae5f2ff981778af912ba71b37a8426a33301daa00f21c6ccb27f8156","impliedFormat":1},{"version":"e927c2c13c4eaf0a7f17e6022eee8519eb29ef42c4c13a31e81a611ab8c95577","impliedFormat":1},{"version":"fcafff163ca5e66d3b87126e756e1b6dfa8c526aa9cd2a2b0a9da837d81bbd72","impliedFormat":1},{"version":"70246ad95ad8a22bdfe806cb5d383a26c0c6e58e7207ab9c431f1cb175aca657","impliedFormat":1},{"version":"f00f3aa5d64ff46e600648b55a79dcd1333458f7a10da2ed594d9f0a44b76d0b","impliedFormat":1},{"version":"772d8d5eb158b6c92412c03228bd9902ccb1457d7a705b8129814a5d1a6308fc","impliedFormat":1},{"version":"802e797bcab5663b2c9f63f51bdf67eff7c41bc64c0fd65e6da3e7941359e2f7","impliedFormat":1},{"version":"8b4327413e5af38cd8cb97c59f48c3c866015d5d642f28518e3a891c469f240e","impliedFormat":1},{"version":"7e6ac205dcb9714f708354fd863bffa45cee90740706cc64b3b39b23ebb84744","impliedFormat":1},{"version":"61dc6e3ac78d64aa864eedd0a208b97b5887cc99c5ba65c03287bf57d83b1eb9","impliedFormat":1},{"version":"4b20fcf10a5413680e39f5666464859fc56b1003e7dfe2405ced82371ebd49b6","impliedFormat":1},{"version":"c06ef3b2569b1c1ad99fcd7fe5fba8d466e2619da5375dfa940a94e0feea899b","impliedFormat":1},{"version":"f7d628893c9fa52ba3ab01bcb5e79191636c4331ee5667ecc6373cbccff8ae12","impliedFormat":1},{"version":"1d879125d1ec570bf04bc1f362fdbe0cb538315c7ac4bcfcdf0c1e9670846aa6","impliedFormat":1},{"version":"8baa8dbdc393e3c6b26e8e31384b938756ce2effdc126648d43e58291ce9869b","impliedFormat":1},{"version":"933aee906d42ea2c53b6892192a8127745f2ec81a90695df4024308ba35a8ff4","impliedFormat":1},{"version":"d663134457d8d669ae0df34eabd57028bddc04fc444c4bc04bc5215afc91e1f4","impliedFormat":1},{"version":"985153f0deb9b4391110331a2f0c114019dbea90cba5ca68a4107700796e0d75","impliedFormat":1},{"version":"a3e3f0efcae272ab8ee3298e4e819f7d9dd9ff411101f45444877e77cfeca9a4","impliedFormat":1},{"version":"43e96a3d5d1411ab40ba2f61d6a3192e58177bcf3b133a80ad2a16591611726d","impliedFormat":1},{"version":"58659b06d33fa430bee1105b75cf876c0a35b2567207487c8578aec51ca2d977","impliedFormat":1},{"version":"71d9eb4c4e99456b78ae182fb20a5dfc20eb1667f091dbb9335b3c017dd1c783","impliedFormat":1},{"version":"cfa846a7b7847a1d973605fbb8c91f47f3a0f0643c18ac05c47077ebc72e71c7","impliedFormat":1},{"version":"30e6520444df1a004f46fdc8096f3fe06f7bbd93d09c53ada9dcdde59919ccca","impliedFormat":1},{"version":"6c800b281b9e89e69165fd11536195488de3ff53004e55905e6c0059a2d8591e","impliedFormat":1},{"version":"7d4254b4c6c67a29d5e7f65e67d72540480ac2cfb041ca484847f5ae70480b62","impliedFormat":1},{"version":"a58beefce74db00dbb60eb5a4bb0c6726fb94c7797c721f629142c0ae9c94306","impliedFormat":1},{"version":"41eeb453ccb75c5b2c3abef97adbbd741bd7e9112a2510e12f03f646dc9ad13d","impliedFormat":1},{"version":"502fa5863df08b806dbf33c54bee8c19f7e2ad466785c0fc35465d7c5ff80995","impliedFormat":1},{"version":"c91a2d08601a1547ffef326201be26db94356f38693bb18db622ae5e9b3d7c92","impliedFormat":1},{"version":"888cda0fa66d7f74e985a3f7b1af1f64b8ff03eb3d5e80d051c3cbdeb7f32ab7","impliedFormat":1},{"version":"60681e13f3545be5e9477acb752b741eae6eaf4cc01658a25ec05bff8b82a2ef","impliedFormat":1},{"version":"8b4b8ebc2d99ae651c5c4169ee8b24e2b0e02a3dfaef84e357d677b663c18fdf","impliedFormat":1},{"version":"a57b1802794433adec9ff3fed12aa79d671faed86c49b09e02e1ac41b4f1d33a","impliedFormat":1},{"version":"ad10d4f0517599cdeca7755b930f148804e3e0e5b5a3847adce0f1f71bbccd74","impliedFormat":1},{"version":"1042064ece5bb47d6aba91648fbe0635c17c600ebdf567588b4ca715602f0a9d","impliedFormat":1},{"version":"c49469a5349b3cc1965710b5b0f98ed6c028686aa8450bcb3796728873eb923e","impliedFormat":1},{"version":"4a889f2c763edb4d55cb624257272ac10d04a1cad2ed2948b10ed4a7fda2a428","impliedFormat":1},{"version":"7bb79aa2fead87d9d56294ef71e056487e848d7b550c9a367523ee5416c44cfa","impliedFormat":1},{"version":"d88ea80a6447d7391f52352ec97e56b52ebec934a4a4af6e2464cfd8b39c3ba8","impliedFormat":1},{"version":"55095860901097726220b6923e35a812afdd49242a1246d7b0942ee7eb34c6e4","impliedFormat":1},{"version":"96171c03c2e7f314d66d38acd581f9667439845865b7f85da8df598ff9617476","impliedFormat":1},{"version":"27ff4196654e6373c9af16b6165120e2dd2169f9ad6abb5c935af5abd8c7938c","impliedFormat":1},{"version":"bb8f2dbc03533abca2066ce4655c119bff353dd4514375beb93c08590c03e023","impliedFormat":1},{"version":"d193c8a86144b3a87b22bc1f5534b9c3e0f5a187873ec337c289a183973a58fe","impliedFormat":1},{"version":"1a6e6ba8a07b74e3ad237717c0299d453f9ceb795dbc2f697d1f2dd07cb782d2","impliedFormat":1},{"version":"58d70c38037fc0f949243388ff7ae20cf43321107152f14a9d36ca79311e0ada","impliedFormat":1},{"version":"f56bdc6884648806d34bc66d31cdb787c4718d04105ce2cd88535db214631f82","impliedFormat":1},{"version":"190da5eac6478d61ab9731ab2146fbc0164af2117a363013249b7e7992f1cccb","impliedFormat":1},{"version":"01479d9d5a5dda16d529b91811375187f61a06e74be294a35ecce77e0b9e8d6c","impliedFormat":1},{"version":"49f95e989b4632c6c2a578cc0078ee19a5831832d79cc59abecf5160ea71abad","impliedFormat":1},{"version":"9666533332f26e8995e4d6fe472bdeec9f15d405693723e6497bf94120c566c8","impliedFormat":1},{"version":"ce0df82a9ae6f914ba08409d4d883983cc08e6d59eb2df02d8e4d68309e7848b","impliedFormat":1},{"version":"796273b2edc72e78a04e86d7c58ae94d370ab93a0ddf40b1aa85a37a1c29ecd7","impliedFormat":1},{"version":"5df15a69187d737d6d8d066e189ae4f97e41f4d53712a46b2710ff9f8563ec9f","impliedFormat":1},{"version":"1a4dc28334a926d90ba6a2d811ba0ff6c22775fcc13679521f034c124269fd40","impliedFormat":1},{"version":"f05315ff85714f0b87cc0b54bcd3dde2716e5a6b99aedcc19cad02bf2403e08c","impliedFormat":1},{"version":"8a8c64dafaba11c806efa56f5c69f611276471bef80a1db1f71316ec4168acef","impliedFormat":1},{"version":"43ba4f2fa8c698f5c304d21a3ef596741e8e85a810b7c1f9b692653791d8d97a","impliedFormat":1},{"version":"5fad3b31fc17a5bc58095118a8b160f5260964787c52e7eb51e3d4fcf5d4a6f0","impliedFormat":1},{"version":"72105519d0390262cf0abe84cf41c926ade0ff475d35eb21307b2f94de985778","impliedFormat":1},{"version":"d0a4cac61fa080f2be5ebb68b82726be835689b35994ba0e22e3ed4d2bc45e3b","impliedFormat":1},{"version":"c857e0aae3f5f444abd791ec81206020fbcc1223e187316677e026d1c1d6fe08","impliedFormat":1},{"version":"ccf6dd45b708fb74ba9ed0f2478d4eb9195c9dfef0ff83a6092fa3cf2ff53b4f","impliedFormat":1},{"version":"2d7db1d73456e8c5075387d4240c29a2a900847f9c1bff106a2e490da8fbd457","impliedFormat":1},{"version":"2b15c805f48e4e970f8ec0b1915f22d13ca6212375e8987663e2ef5f0205e832","impliedFormat":1},{"version":"205a31b31beb7be73b8df18fcc43109cbc31f398950190a0967afc7a12cb478c","impliedFormat":1},{"version":"8fca3039857709484e5893c05c1f9126ab7451fa6c29e19bb8c2411a2e937345","impliedFormat":1},{"version":"35069c2c417bd7443ae7c7cafd1de02f665bf015479fec998985ffbbf500628c","impliedFormat":1},{"version":"dba6c7006e14a98ec82999c6f89fbbbfd1c642f41db148535f3b77b8018829b8","impliedFormat":1},{"version":"7f897b285f22a57a5c4dc14a27da2747c01084a542b4d90d33897216dceeea2e","impliedFormat":1},{"version":"7e0b7f91c5ab6e33f511efc640d36e6f933510b11be24f98836a20a2dc914c2d","impliedFormat":1},{"version":"045b752f44bf9bbdcaffd882424ab0e15cb8d11fa94e1448942e338c8ef19fba","impliedFormat":1},{"version":"2894c56cad581928bb37607810af011764a2f511f575d28c9f4af0f2ef02d1ab","impliedFormat":1},{"version":"0a72186f94215d020cb386f7dca81d7495ab6c17066eb07d0f44a5bf33c1b21a","impliedFormat":1},{"version":"d96b39301d0ded3f1a27b47759676a33a02f6f5049bfcbde81e533fd10f50dcb","impliedFormat":1},{"version":"2ded4f930d6abfaa0625cf55e58f565b7cbd4ab5b574dd2cb19f0a83a2f0be8b","impliedFormat":1},{"version":"0aedb02516baf3e66b2c1db9fef50666d6ed257edac0f866ea32f1aa05aa474f","impliedFormat":1},{"version":"ca0f4d9068d652bad47e326cf6ba424ac71ab866e44b24ddb6c2bd82d129586a","affectsGlobalScope":true,"impliedFormat":1},{"version":"04d36005fcbeac741ac50c421181f4e0316d57d148d37cc321a8ea285472462b","impliedFormat":1},{"version":"9e2739b32f741859263fdba0244c194ca8e96da49b430377930b8f721d77c000","impliedFormat":1},{"version":"56ccb49443bfb72e5952f7012f0de1a8679f9f75fc93a5c1ac0bafb28725fc5f","impliedFormat":1},{"version":"20fa37b636fdcc1746ea0738f733d0aed17890d1cd7cb1b2f37010222c23f13e","impliedFormat":1},{"version":"d90b9f1520366d713a73bd30c5a9eb0040d0fb6076aff370796bc776fd705943","impliedFormat":1},{"version":"bc03c3c352f689e38c0ddd50c39b1e65d59273991bfc8858a9e3c0ebb79c023b","impliedFormat":1},{"version":"19df3488557c2fc9b4d8f0bac0fd20fb59aa19dec67c81f93813951a81a867f8","affectsGlobalScope":true,"impliedFormat":1},{"version":"b25350193e103ae90423c5418ddb0ad1168dc9c393c9295ef34980b990030617","affectsGlobalScope":true,"impliedFormat":1},{"version":"bef86adb77316505c6b471da1d9b8c9e428867c2566270e8894d4d773a1c4dc2","impliedFormat":1},{"version":"a46dba563f70f32f9e45ae015f3de979225f668075d7a427f874e0f6db584991","impliedFormat":1},{"version":"6ac6715916fa75a1f7ebdfeacac09513b4d904b667d827b7535e84ff59679aff","impliedFormat":1},{"version":"2652448ac55a2010a1f71dd141f828b682298d39728f9871e1cdf8696ef443fd","impliedFormat":1},{"version":"02c4fc9e6bb27545fa021f6056e88ff5fdf10d9d9f1467f1d10536c6e749ac50","impliedFormat":1},{"version":"120599fd965257b1f4d0ff794bc696162832d9d8467224f4665f713a3119078b","impliedFormat":1},{"version":"5433f33b0a20300cca35d2f229a7fc20b0e8477c44be2affeb21cb464af60c76","impliedFormat":1},{"version":"db036c56f79186da50af66511d37d9fe77fa6793381927292d17f81f787bb195","impliedFormat":1},{"version":"bd4131091b773973ca5d2326c60b789ab1f5e02d8843b3587effe6e1ea7c9d86","impliedFormat":1},{"version":"c7f6485931085bf010fbaf46880a9b9ec1a285ad9dc8c695a9e936f5a48f34b4","impliedFormat":1},{"version":"14f6b927888a1112d662877a5966b05ac1bf7ed25d6c84386db4c23c95a5363b","impliedFormat":1},{"version":"6ac6715916fa75a1f7ebdfeacac09513b4d904b667d827b7535e84ff59679aff","impliedFormat":1},{"version":"622694a8522b46f6310c2a9b5d2530dde1e2854cb5829354e6d1ff8f371cf469","impliedFormat":1},{"version":"d24ff95760ea2dfcc7c57d0e269356984e7046b7e0b745c80fea71559f15bdd8","impliedFormat":1},{"version":"a9e6c0ff3f8186fccd05752cf75fc94e147c02645087ac6de5cc16403323d870","impliedFormat":1},{"version":"49c346823ba6d4b12278c12c977fb3a31c06b9ca719015978cb145eb86da1c61","impliedFormat":1},{"version":"bfac6e50eaa7e73bb66b7e052c38fdc8ccfc8dbde2777648642af33cf349f7f1","impliedFormat":1},{"version":"92f7c1a4da7fbfd67a2228d1687d5c2e1faa0ba865a94d3550a3941d7527a45d","impliedFormat":1},{"version":"f53b120213a9289d9a26f5af90c4c686dd71d91487a0aa5451a38366c70dc64b","impliedFormat":1},{"version":"83fe880c090afe485a5c02262c0b7cdd76a299a50c48d9bde02be8e908fb4ae6","impliedFormat":1},{"version":"13c1b657932e827a7ed510395d94fc8b743b9d053ab95b7cd829b2bc46fb06db","impliedFormat":1},{"version":"57d67b72e06059adc5e9454de26bbfe567d412b962a501d263c75c2db430f40e","impliedFormat":1},{"version":"6511e4503cf74c469c60aafd6589e4d14d5eb0a25f9bf043dcbecdf65f261972","impliedFormat":1},{"version":"078131f3a722a8ad3fc0b724cd3497176513cdcb41c80f96a3acbda2a143b58e","impliedFormat":1},{"version":"8c70ddc0c22d85e56011d49fddfaae3405eb53d47b59327b9dd589e82df672e7","impliedFormat":1},{"version":"a67b87d0281c97dfc1197ef28dfe397fc2c865ccd41f7e32b53f647184cc7307","impliedFormat":1},{"version":"771ffb773f1ddd562492a6b9aaca648192ac3f056f0e1d997678ff97dbb6bf9b","impliedFormat":1},{"version":"232f70c0cf2b432f3a6e56a8dc3417103eb162292a9fd376d51a3a9ea5fbbf6f","impliedFormat":1},{"version":"9e155d2255348d950b1f65643fb26c0f14f5109daf8bd9ee24a866ad0a743648","affectsGlobalScope":true,"impliedFormat":1},{"version":"0b103e9abfe82d14c0ad06a55d9f91d6747154ef7cacc73cf27ecad2bfb3afcf","impliedFormat":1},{"version":"7a883e9c84e720810f86ef4388f54938a65caa0f4d181a64e9255e847a7c9f51","impliedFormat":1},{"version":"a0ba218ac1baa3da0d5d9c1ec1a7c2f8676c284e6f5b920d6d049b13fa267377","impliedFormat":1},{"version":"8a0e762ceb20c7e72504feef83d709468a70af4abccb304f32d6b9bac1129b2c","impliedFormat":1},{"version":"d408d6f32de8d1aba2ff4a20f1aa6a6edd7d92c997f63b90f8ad3f9017cf5e46","impliedFormat":1},{"version":"9252d498a77517aab5d8d4b5eb9d71e4b225bbc7123df9713e08181de63180f6","impliedFormat":1},{"version":"221e915caef37c5cbaabd4946418f97dcc20591469e260732b31008321024dd8","impliedFormat":1},{"version":"35e6379c3f7cb27b111ad4c1aa69538fd8e788ab737b8ff7596a1b40e96f4f90","impliedFormat":1},{"version":"1fffe726740f9787f15b532e1dc870af3cd964dbe29e191e76121aa3dd8693f2","impliedFormat":1},{"version":"371bf6127c1d427836de95197155132501cb6b69ef8709176ce6e0b85d059264","impliedFormat":1},{"version":"2bafd700e617d3693d568e972d02b92224b514781f542f70d497a8fdf92d52a2","affectsGlobalScope":true,"impliedFormat":1},{"version":"5542d8a7ea13168cb573be0d1ba0d29460d59430fb12bb7bf4674efd5604e14c","impliedFormat":1},{"version":"af48e58339188d5737b608d41411a9c054685413d8ae88b8c1d0d9bfabdf6e7e","impliedFormat":1},{"version":"616775f16134fa9d01fc677ad3f76e68c051a056c22ab552c64cc281a9686790","impliedFormat":1},{"version":"65c24a8baa2cca1de069a0ba9fba82a173690f52d7e2d0f1f7542d59d5eb4db0","impliedFormat":1},{"version":"f9fe6af238339a0e5f7563acee3178f51db37f32a2e7c09f85273098cee7ec49","impliedFormat":1},{"version":"1de8c302fd35220d8f29dea378a4ae45199dc8ff83ca9923aca1400f2b28848a","impliedFormat":1},{"version":"77e71242e71ebf8528c5802993697878f0533db8f2299b4d36aa015bae08a79c","impliedFormat":1},{"version":"98a787be42bd92f8c2a37d7df5f13e5992da0d967fab794adbb7ee18370f9849","impliedFormat":1},{"version":"332248ee37cca52903572e66c11bef755ccc6e235835e63d3c3e60ddda3e9b93","impliedFormat":1},{"version":"94e8cc88ae2ef3d920bb3bdc369f48436db123aa2dc07f683309ad8c9968a1e1","impliedFormat":1},{"version":"4545c1a1ceca170d5d83452dd7c4994644c35cf676a671412601689d9a62da35","impliedFormat":1},{"version":"320f4091e33548b554d2214ce5fc31c96631b513dffa806e2e3a60766c8c49d9","impliedFormat":1},{"version":"a2d648d333cf67b9aeac5d81a1a379d563a8ffa91ddd61c6179f68de724260ff","impliedFormat":1},{"version":"d90d5f524de38889d1e1dbc2aeef00060d779f8688c02766ddb9ca195e4a713d","impliedFormat":1},{"version":"a3f41ed1b4f2fc3049394b945a68ae4fdefd49fa1739c32f149d32c0545d67f5","impliedFormat":1},{"version":"b0309e1eda99a9e76f87c18992d9c3689b0938266242835dd4611f2b69efe456","impliedFormat":1},{"version":"47699512e6d8bebf7be488182427189f999affe3addc1c87c882d36b7f2d0b0e","impliedFormat":1},{"version":"6ceb10ca57943be87ff9debe978f4ab73593c0c85ee802c051a93fc96aaf7a20","impliedFormat":1},{"version":"1de3ffe0cc28a9fe2ac761ece075826836b5a02f340b412510a59ba1d41a505a","impliedFormat":1},{"version":"e46d6cc08d243d8d0d83986f609d830991f00450fb234f5b2f861648c42dc0d8","impliedFormat":1},{"version":"1c0a98de1323051010ce5b958ad47bc1c007f7921973123c999300e2b7b0ecc0","impliedFormat":1},{"version":"ff863d17c6c659440f7c5c536e4db7762d8c2565547b2608f36b798a743606ca","impliedFormat":1},{"version":"5412ad0043cd60d1f1406fc12cb4fb987e9a734decbdd4db6f6acf71791e36fe","impliedFormat":1},{"version":"ad036a85efcd9e5b4f7dd5c1a7362c8478f9a3b6c3554654ca24a29aa850a9c5","impliedFormat":1},{"version":"fedebeae32c5cdd1a85b4e0504a01996e4a8adf3dfa72876920d3dd6e42978e7","impliedFormat":1},{"version":"b6c1f64158da02580f55e8a2728eda6805f79419aed46a930f43e68ad66a38fc","impliedFormat":1},{"version":"cdf21eee8007e339b1b9945abf4a7b44930b1d695cc528459e68a3adc39a622e","impliedFormat":1},{"version":"bc9ee0192f056b3d5527bcd78dc3f9e527a9ba2bdc0a2c296fbc9027147df4b2","impliedFormat":1},{"version":"330896c1a2b9693edd617be24fbf9e5895d6e18c7955d6c08f028f272b37314d","impliedFormat":1},{"version":"1d9c0a9a6df4e8f29dc84c25c5aa0bb1da5456ebede7a03e03df08bb8b27bae6","impliedFormat":1},{"version":"84380af21da938a567c65ef95aefb5354f676368ee1a1cbb4cae81604a4c7d17","impliedFormat":1},{"version":"1af3e1f2a5d1332e136f8b0b95c0e6c0a02aaabd5092b36b64f3042a03debf28","impliedFormat":1},{"version":"30d8da250766efa99490fc02801047c2c6d72dd0da1bba6581c7e80d1d8842a4","impliedFormat":1},{"version":"03566202f5553bd2d9de22dfab0c61aa163cabb64f0223c08431fb3fc8f70280","impliedFormat":1},{"version":"4c0a1233155afb94bd4d7518c75c84f98567cd5f13fc215d258de196cdb40d91","impliedFormat":1},{"version":"e7765aa8bcb74a38b3230d212b4547686eb9796621ffb4367a104451c3f9614f","impliedFormat":1},{"version":"1de80059b8078ea5749941c9f863aa970b4735bdbb003be4925c853a8b6b4450","impliedFormat":1},{"version":"1d079c37fa53e3c21ed3fa214a27507bda9991f2a41458705b19ed8c2b61173d","impliedFormat":1},{"version":"5bf5c7a44e779790d1eb54c234b668b15e34affa95e78eada73e5757f61ed76a","impliedFormat":1},{"version":"5835a6e0d7cd2738e56b671af0e561e7c1b4fb77751383672f4b009f4e161d70","impliedFormat":1},{"version":"5c634644d45a1b6bc7b05e71e05e52ec04f3d73d9ac85d5927f647a5f965181a","impliedFormat":1},{"version":"4b7f74b772140395e7af67c4841be1ab867c11b3b82a51b1aeb692822b76c872","impliedFormat":1},{"version":"27be6622e2922a1b412eb057faa854831b95db9db5035c3f6d4b677b902ab3b7","impliedFormat":1},{"version":"a68d4b3182e8d776cdede7ac9630c209a7bfbb59191f99a52479151816ef9f9e","impliedFormat":99},{"version":"39644b343e4e3d748344af8182111e3bbc594930fff0170256567e13bbdbebb0","impliedFormat":99},{"version":"ed7fd5160b47b0de3b1571c5c5578e8e7e3314e33ae0b8ea85a895774ee64749","impliedFormat":99},{"version":"63a7595a5015e65262557f883463f934904959da563b4f788306f699411e9bac","impliedFormat":1},{"version":"4ba137d6553965703b6b55fd2000b4e07ba365f8caeb0359162ad7247f9707a6","impliedFormat":1},{"version":"6de125ea94866c736c6d58d68eb15272cf7d1020a5b459fea1c660027eca9a90","affectsGlobalScope":true,"impliedFormat":1},{"version":"8fac4a15690b27612d8474fb2fc7cc00388df52d169791b78d1a3645d60b4c8b","affectsGlobalScope":true,"impliedFormat":1},{"version":"064ac1c2ac4b2867c2ceaa74bbdce0cb6a4c16e7c31a6497097159c18f74aa7c","impliedFormat":1},{"version":"3dc14e1ab45e497e5d5e4295271d54ff689aeae00b4277979fdd10fa563540ae","impliedFormat":1},{"version":"d3b315763d91265d6b0e7e7fa93cfdb8a80ce7cdd2d9f55ba0f37a22db00bdb8","impliedFormat":1},{"version":"b789bf89eb19c777ed1e956dbad0925ca795701552d22e68fd130a032008b9f9","impliedFormat":1},{"version":"2a45b0b08329d492c618e2a21647e01a12544c9e815492d393faad430e07383b","affectsGlobalScope":true},"7ad303e40d4fddf44f156129e397511953a71481c5cfd86b1862649aaaf240cc",{"version":"6678de633bd595628168da887a1d24e0caa5304f7586b2a92cb52499ab55eeb0","impliedFormat":99},{"version":"9db46d1322ca3b7e5c982a915070ca7c05212e55f277f4d02ac3f74ff8ece67c","impliedFormat":99},{"version":"f6fc0ed8b8811ad1b451511cc3ee3581f82c2227cc140a47a86c383a48b2f490","impliedFormat":99},{"version":"f6fc0ed8b8811ad1b451511cc3ee3581f82c2227cc140a47a86c383a48b2f490","impliedFormat":99},{"version":"c1d15bfb5df457b54922d3b9664796190d6cbe1faf0c892f4e873b45730c0447","impliedFormat":99},{"version":"d5d6b53334d846db54bc6f1a35d52202c5c19cee3cd3a0effba959381f7e2feb","impliedFormat":99},{"version":"e9bd3457d2cae491c4d26473c160431ce2be929865d147b3ee733ff73bb9481f","impliedFormat":99},{"version":"f3d73901e4383f84add3a98573a2738ac5d0cbc648697c302b69b26b75ee140f","impliedFormat":99},{"version":"4acccd722f80edbf731840b8363e17f18f679434a4578ee44f1d3b70c67d858c","impliedFormat":99},{"version":"b3fae73d7dd47d6be5831e14cfa75be9ad8ad5da6ca1f1777bb30be81d744d2b","impliedFormat":99},{"version":"7046e54e5c1d78dca3747c07294829e3bdb773ae5853d3f186ea3bba5b6feef7","signature":"9c0eeb8de8dfdfb63ebcef09564c84ae1f6b6187c8e8e274fc5b0ee0a2c8432b"},{"version":"8e609bb71c20b858c77f0e9f90bb1319db8477b13f9f965f1a1e18524bf50881","impliedFormat":1},{"version":"ce156ed1e82e1a9e4ceef49d98c510638bfa290142ec17ddd0a295871e58af17","impliedFormat":1},{"version":"2729bdb66a2d3d6dbb88c897cec50bf8e1cd0b63b9c3979d5c7691ce788354c0","impliedFormat":1},{"version":"381f1c97bad454d7579bd2283904d0f19b4398cc62ffc6d30eeae78a009e21cd","signature":"8c6629d3a6f36715b1324431569f1fa65e10d84dcc82e87967a1aa1c5f4a9da4"},{"version":"acfb723d81eda39156251aed414c553294870bf53062429ebfcfba8a68cb4753","impliedFormat":99},{"version":"fa69a90381c2f85889722a911a732a5ee3596dc3acecda8a9aa2fa89b9615d8d","impliedFormat":99},{"version":"b5ce343886d23392be9c8280e9f24a87f1d7d3667f6672c2fe4aa61fa4ece7d4","impliedFormat":99},{"version":"57e9e1b0911874c62d743af24b5d56032759846533641d550b12a45ff404bf07","impliedFormat":99},{"version":"b0857bb28fd5236ace84280f79a25093f919fd0eff13e47cc26ea03de60a7294","impliedFormat":99},{"version":"5e43e0824f10cd8c48e7a8c5c673638488925a12c31f0f9e0957965c290eb14c","impliedFormat":99},{"version":"854cd3a3375ffc4e7a92b2168dd065d7ff2614b43341038a65cca865a44c00c5","impliedFormat":99},{"version":"ef13c73d6157a32933c612d476c1524dd674cf5b9a88571d7d6a0d147544d529","impliedFormat":99},{"version":"3b0a56d056d81a011e484b9c05d5e430711aaecd561a788bad1d0498aad782c7","impliedFormat":99},{"version":"2f863ee9b873a65d9c3338ea7aaddbdb41a9673f062f06983d712bd01c25dc6b","impliedFormat":99},{"version":"67aa128c2bc170b93794f191feffc65a4b33e878db211cfcb7658c4b72f7a1f5","impliedFormat":99},{"version":"31fd7c12f6e27154efb52a916b872509a771880f3b20f2dfd045785c13aa813f","impliedFormat":99},{"version":"b481de4ab5379bd481ca12fc0b255cdc47341629a22c240a89cdb4e209522be2","impliedFormat":99},{"version":"bdd14f07b4eca0b4b5203b85b8dbc4d084c749fa590bee5ea613e1641dcd3b29","impliedFormat":99},{"version":"427fe2004642504828c1476d0af4270e6ad4db6de78c0b5da3e4c5ca95052a99","impliedFormat":1},{"version":"2eeffcee5c1661ddca53353929558037b8cf305ffb86a803512982f99bcab50d","impliedFormat":99},{"version":"9afb4cb864d297e4092a79ee2871b5d3143ea14153f62ef0bb04ede25f432030","affectsGlobalScope":true,"impliedFormat":99},{"version":"4e258d11c899cb9ff36b4b5c53df59cf4a5ccae9a9931529686e77431e0a3518","affectsGlobalScope":true,"impliedFormat":99},{"version":"a7ca8df4f2931bef2aa4118078584d84a0b16539598eaadf7dce9104dfaa381c","impliedFormat":1},{"version":"10073cdcf56982064c5337787cc59b79586131e1b28c106ede5bff362f912b70","impliedFormat":99},{"version":"72950913f4900b680f44d8cab6dd1ea0311698fc1eefb014eb9cdfc37ac4a734","impliedFormat":1},{"version":"151ff381ef9ff8da2da9b9663ebf657eac35c4c9a19183420c05728f31a6761d","impliedFormat":1},{"version":"4e741b9c88e80c9e4cedf07b5a698e8e3a3bd73cf649f664d6dd3f868c05c2f3","affectsGlobalScope":true,"impliedFormat":1},{"version":"a660aa95476042d3fdcc1343cf6bb8fdf24772d31712b1db321c5a4dcc325434","impliedFormat":1},{"version":"36977c14a7f7bfc8c0426ae4343875689949fb699f3f84ecbe5b300ebf9a2c55","impliedFormat":1},{"version":"ff0a83c9a0489a627e264ffcb63f2264b935b20a502afa3a018848139e3d8575","impliedFormat":99},{"version":"161c8e0690c46021506e32fda85956d785b70f309ae97011fd27374c065cac9b","affectsGlobalScope":true,"impliedFormat":1},{"version":"f582b0fcbf1eea9b318ab92fb89ea9ab2ebb84f9b60af89328a91155e1afce72","impliedFormat":1},{"version":"402e5c534fb2b85fa771170595db3ac0dd532112c8fa44fc23f233bc6967488b","impliedFormat":1},{"version":"8885cf05f3e2abf117590bbb951dcf6359e3e5ac462af1c901cfd24c6a6472e2","impliedFormat":1},{"version":"333caa2bfff7f06017f114de738050dd99a765c7eb16571c6d25a38c0d5365dc","impliedFormat":1},{"version":"e61df3640a38d535fd4bc9f4a53aef17c296b58dc4b6394fd576b808dd2fe5e6","impliedFormat":1},{"version":"459920181700cec8cbdf2a5faca127f3f17fd8dd9d9e577ed3f5f3af5d12a2e4","impliedFormat":1},{"version":"4719c209b9c00b579553859407a7e5dcfaa1c472994bd62aa5dd3cc0757eb077","impliedFormat":1},{"version":"7ec359bbc29b69d4063fe7dad0baaf35f1856f914db16b3f4f6e3e1bca4099fa","impliedFormat":1},{"version":"70790a7f0040993ca66ab8a07a059a0f8256e7bb57d968ae945f696cbff4ac7a","impliedFormat":1},{"version":"d1b9a81e99a0050ca7f2d98d7eedc6cda768f0eb9fa90b602e7107433e64c04c","impliedFormat":1},{"version":"a022503e75d6953d0e82c2c564508a5c7f8556fad5d7f971372d2d40479e4034","impliedFormat":1},{"version":"b215c4f0096f108020f666ffcc1f072c81e9f2f95464e894a5d5f34c5ea2a8b1","impliedFormat":1},{"version":"644491cde678bd462bb922c1d0cfab8f17d626b195ccb7f008612dc31f445d2d","impliedFormat":1},{"version":"dfe54dab1fa4961a6bcfba68c4ca955f8b5bbeb5f2ab3c915aa7adaa2eabc03a","impliedFormat":1},{"version":"1251d53755b03cde02466064260bb88fd83c30006a46395b7d9167340bc59b73","impliedFormat":1},{"version":"47865c5e695a382a916b1eedda1b6523145426e48a2eae4647e96b3b5e52024f","impliedFormat":1},{"version":"4cdf27e29feae6c7826cdd5c91751cc35559125e8304f9e7aed8faef97dcf572","impliedFormat":1},{"version":"331b8f71bfae1df25d564f5ea9ee65a0d847c4a94baa45925b6f38c55c7039bf","impliedFormat":1},{"version":"2a771d907aebf9391ac1f50e4ad37952943515eeea0dcc7e78aa08f508294668","impliedFormat":1},{"version":"0146fd6262c3fd3da51cb0254bb6b9a4e42931eb2f56329edd4c199cb9aaf804","impliedFormat":1},{"version":"183f480885db5caa5a8acb833c2be04f98056bdcc5fb29e969ff86e07efe57ab","impliedFormat":99},{"version":"960bd764c62ac43edc24eaa2af958a4b4f1fa5d27df5237e176d0143b36a39c6","affectsGlobalScope":true,"impliedFormat":1},{"version":"f7eebe1b25040d805aefe8971310b805cd49b8602ec206d25b38dc48c542f165","impliedFormat":1},{"version":"a18642ddf216f162052a16cba0944892c4c4c977d3306a87cb673d46abbb0cbf","impliedFormat":1},{"version":"509f8efdfc5f9f6b52284170e8d7413552f02d79518d1db691ee15acc0088676","impliedFormat":1},{"version":"4ec16d7a4e366c06a4573d299e15fe6207fc080f41beac5da06f4af33ea9761e","impliedFormat":1},{"version":"59f8dc89b9e724a6a667f52cdf4b90b6816ae6c9842ce176d38fcc973669009e","affectsGlobalScope":true,"impliedFormat":1},{"version":"e4af494f7a14b226bbe732e9c130d8811f8c7025911d7c58dd97121a85519715","impliedFormat":1},{"version":"47416e41b1af81e53e8c3cc5bf909d47ff632a7b6eddfe7ff43d187b4dcca047","impliedFormat":99},{"version":"324ac98294dab54fbd580c7d0e707d94506d7b2c3d5efe981a8495f02cf9ad96","impliedFormat":99},{"version":"9ec72eb493ff209b470467e24264116b6a8616484bca438091433a545dfba17e","impliedFormat":99},{"version":"c35b8117804c639c53c87f2c23e0c786df61d552e513bd5179f5b88e29964838","impliedFormat":99},{"version":"ac3d263474022e9a14c43f588f485d549641d839b159ecc971978b90f34bdf6b","impliedFormat":99},{"version":"67acaedb46832d66c15f1b09fb7b6a0b7f41bdbf8eaa586ec70459b3e8896eb9","impliedFormat":99},{"version":"c609331c6ed4ad4af54e101088c6a4dcb48f8db7b0b97e44a6efeb130f4331bd","impliedFormat":99},{"version":"bcbd3becd08b4515225880abea0dbfbbf0d1181ce3af8f18f72f61edbe4febfb","impliedFormat":99},{"version":"4535ab977ee871e956eb7bebe2db5de79f5d5ec7dfbbf1d35e08f4a2d6630dac","impliedFormat":99},{"version":"b79b5ed99f26ffb2f8ae4bdcc4b34a9542197dc3fa96cfb425c2a81e618cff28","impliedFormat":99},{"version":"213a00d511892898e9dad3c98efe3b1de230f171b9e91496faca3e40e27ef6a7","impliedFormat":99},{"version":"62486ec77ac020b82d5a65a270096bb7f2a1fd0627a89f29c5a5d3cbd6bd1f59","impliedFormat":99},{"version":"c637a793905f02d354b640fae41a6ae79395ed0d77fbb87c36d9664ecbd95ac1","impliedFormat":99},{"version":"437b7613a30a2fcde463f7b707c6d5567a8823fbc51de50b8641bf5b1d126fad","impliedFormat":99},{"version":"63ea959e28c110923f495576e614fb8b36c09b6828b467b2c7cd7f03b03ccf9f","impliedFormat":99},{"version":"1601a95dbb33059fc3d12638ed2a9aecff899e339c5c0f3a0b28768866d385b4","impliedFormat":99},{"version":"a8dd232837b1d83f76a47a5193c1afd9e17b9bf352cb84345f86f7759ee346d0","impliedFormat":99},{"version":"be5fc0dd37f64420b0423059370b8319521e0b58060d7b07b8f62fe1c145b02e","impliedFormat":99},{"version":"45f770f2ae71acc1cacfac137f50911e1a004ccba52b2b55c4432c0d4bd97814","impliedFormat":99},{"version":"8124828a11be7db984fcdab052fd4ff756b18edcfa8d71118b55388176210923","impliedFormat":99},{"version":"a5ae67a67f786ffe92d34b55467a40fb50fb0093e92388cadce6168fa42690fd","impliedFormat":99},{"version":"69bf2422313487956e4dacf049f30cb91b34968912058d244cb19e4baa24da97","impliedFormat":99},{"version":"6987dfb4b0c4e02112cc4e548e7a77b3d9ddfeffa8c8a2db13ceac361a4567d9","impliedFormat":99},{"version":"b62006bbc815fe8190c7aee262aad6bff993e3f9ade70d7057dfceab6de79d2f","impliedFormat":99},{"version":"a20c4976da01d1c823b165275cef98a896d4758388c6409bc4ce24f0a5b49900","impliedFormat":99},{"version":"dffffa77f7716aa110e4253c6cd73a067e4729d95c97a538dbb20e58f0eb3e1d","impliedFormat":99},{"version":"0daddd6f389da2b55770e95c9ef8831bf2520aab44fb941bae38bb7ddfe1d6b6","impliedFormat":99},{"version":"7bbff6783e96c691a41a7cf12dd5486b8166a01b0c57d071dbcfca55c9525ec4","impliedFormat":99},{"version":"f7032da8e1fc8644dc2ff823d66748b75857bbfff27d03c8cbc1f8e91be5ca16","signature":"4b96dd19fd2949d28ce80e913412b0026dc421e5bf6c31d87c7b5eb11b5753b4"},{"version":"85ee2513d76319ac025a0b70dfef3fbf52ca8fc96de4a0200e26f58c1c72ebfa","impliedFormat":1},{"version":"1ba4cb78a0ebc9ef6a3880ce88070f9e789584a0323de5592abe6a900fb61ba0","impliedFormat":1},{"version":"6a80d17ef68537a0a8ee6063a26c5d23b5f35f637e6ef5c1ee6bbd1c4d39a2da","impliedFormat":1},{"version":"d5eb5865d4cbaa9985cc3cfb920b230cdcf3363f1e70903a08dc4baab80b0ce1","impliedFormat":1},{"version":"51ebca098538b252953b1ef83c165f25b52271bfb6049cd09d197dddd4cd43c5","impliedFormat":1},{"version":"c374b5aefaf966755880e18faee66c5adda1c4855888ef8c00926d13651de409","signature":"f984e528aa6b4f3591024787649685d92e3897f2951fe53b8f626a7c199b110d"},{"version":"f60e3e3060207ac982da13363181fd7ee4beecc19a7c569f0d6bb034331066c2","impliedFormat":1},{"version":"17230b34bb564a3a2e36f9d3985372ccab4ad1722df2c43f7c5c2b553f68e5db","impliedFormat":1},{"version":"6e5c9272f6b3783be7bdddaf207cccdb8e033be3d14c5beacc03ae9d27d50929","impliedFormat":1},{"version":"9b4f7ff9681448c72abe38ea8eefd7ffe0c3aefe495137f02012a08801373f71","impliedFormat":1},{"version":"0dfe35191a04e8f9dc7caeb9f52f2ee07402736563d12cbccd15fb5f31ac877f","impliedFormat":1},{"version":"798367363a3274220cbed839b883fe2f52ba7197b25e8cb2ac59c1e1fd8af6b7","impliedFormat":1},{"version":"3fa6aece30a44b769633651b07e0a0859e8194dfbbcfe0d7cda561bc521a5d7c","impliedFormat":1},{"version":"5aea76ab98173f2c230b1f78dc010da403da622c105c468ace9fe24e3b77883c","impliedFormat":99},{"version":"8aa255453712ce8df1652947a0406769415ee7113c54551310e36cf6ab9db99c","impliedFormat":99},{"version":"6ef2ac05da44657a9a2fc1cd47198d2474a0f25d8ea02dcbb9c4a1e45a96dd9d","impliedFormat":99},{"version":"69f56d8b9be27fa77055e144ab75843b2c342f7e287d61770abfab9510e723da","impliedFormat":99},{"version":"97fda98062db1e6ad93f3742e3196bf943c7a69526d79c65476b5fcccadf19f9","signature":"4e60d170e0db6cc16121ea16a0e748faa57befcd83d3e2a05d5409fc20a31a5f"},{"version":"07fcc9be98e12bd2f0f71a501a9bfbe2e53d38c50e8a5e84223fdd05bd8749c5","impliedFormat":99},{"version":"b887a4575db46263f82d7bde681bdc14526e4a2618a1172fef4206c467752d8f","impliedFormat":99},{"version":"bd23e7881d954fa4a731eb77aacc7f97b93d01818d7734625525e14fa6ced6e4","signature":"5d1e59b003eb57c4e66a002caa9df46166b71233d85002c83cc8d8f011c0943a"},{"version":"42f37fa7f019fe8c36fa31cba9c1306f5646dfdc352312a5e74275ea78ed4511","signature":"4ffc694a13cfb6aa43e3926e1d8e05ded8727af2e95835063c1d98e75c5d7ad6"},{"version":"03981a348c4473a6a0bbaf606b651043860c8fc3efd7786bc02c4a1e05bf37b1","impliedFormat":99},{"version":"fb82344c312fd920a25c33ae4e0381023f46ef1432775cda1d9ab50077e639a8","impliedFormat":99},{"version":"e0037499acbd201cd60956a4d54ee45e4953cd60f80a2d8acb1bd13c9b134842","impliedFormat":99},{"version":"92339882b71c2ec1f48f82fe70d4ccd003822c4959169f0bab4f1ed0e99dd486","impliedFormat":99},{"version":"d627151917233bf28874a54e2478a6c5e15ef92b7aa8ed0500ca663d1510ce26","impliedFormat":99},{"version":"5fb1b2ce00b645b22fa28bb565b01bb87ba991e58bc6058a02fec611e7d727d8","impliedFormat":99},{"version":"a9b4b1235cc7b2ca1a3bf02e9ad19b7b0aa897b7fba1d138b9b4f8b7baba83fe","impliedFormat":99},{"version":"ba90eb33597e9d44217593b9a0c5753743445e1a4a9e4ce3e15c185f009d60b0","impliedFormat":99},{"version":"e3507ff969a7c1c9d55e0e6a7986d863433ac6fab17e27f5fa6c8d0fd79c15be","impliedFormat":99},{"version":"8bb642bc24d7a21e67124613f77174e377b053b4e50f08d3bb8b4b71c30da185","impliedFormat":99},{"version":"c043623180122dddecf5565e0809ea90426d6fc370454cd2ba1ab99ca3398248","impliedFormat":99},{"version":"70f20697bc3ed03af85920db61fb1e4388fffa37cd2e0c0d937e7608f5608bd1","impliedFormat":99},{"version":"5e35a2a3f0b62ee763fd1d1f13cdec015ea10fb1ed7a670989b1ba49b37ad287","impliedFormat":1},{"version":"b3b5aca751100320745c8bfd826202aed7d753d336448ce2265b9470dfa8a298","impliedFormat":1},{"version":"5fa35c6051059d5ed57cbda5479b593cec15d5405229542042bd583c1e680fb4","impliedFormat":1},{"version":"7df3932c1b8816845e1774538c4e921e196d396b3419e2e18bc973079b4064a3","impliedFormat":1},{"version":"c8a7131a27d7892f009ab03d78dc113582f819c429af2064280bec83c2e7c599","impliedFormat":1},{"version":"19629032a378771a07e93c0ab8253b92cb83e786446f1c0aed01d8f9b96a3fb6","impliedFormat":1},{"version":"fd4b51f120103d53cc03eea9d98d6a1c7e6c07f04847c0658ec925ceeb7667aa","impliedFormat":1},{"version":"53bacb19d6714c3ea41bebf01a34d35468a0ac0c9331d2ffdc411ce452444a2f","impliedFormat":1},{"version":"e2ce339ecc8f65810eda93bb801eb9278f616b653f5974135908df2c30acc5ae","impliedFormat":1},{"version":"234058398306e26bc917e6efba8fb26c9d9f2cfdfbaa17abfcb11138847de081","impliedFormat":1},{"version":"b3ff9aff54c18834bce9690184e69fd44fd5d57273a98a47fbf518b68cc4ec60","impliedFormat":1},{"version":"e6cfcf171b5f7ec0cb620eee4669739ad2711597d0ff7fdb79298dfc1118e66a","impliedFormat":1},{"version":"3dc40ead9c5ac3f164af434069561d6c660e64f77c71ab6ad405c5edc0724a94","impliedFormat":1},{"version":"d5fb34e3200ce13445c603012c0dfbd116317f8d5fef294e11f49d00a859a3d0","impliedFormat":1},{"version":"58fc843cdfd37a8b1ae2cbf3d6d3718d41cdafcbbf17e228bd6a7762a7235bf0","impliedFormat":1},{"version":"a4d0945318f81b27529abcae16d65612decf4164021a0d4d2ec19fbfcbaf1555","impliedFormat":1},{"version":"fbe57f37a07a627af9ae5922c86132677e58689427cc748866a549ef3862f859","impliedFormat":1},{"version":"8df750d51d498be760d538ac9818c7aebea597f21d4937a65fb2ebedd8a976e7","impliedFormat":1},{"version":"5b9c5efb469020fd6a8c6cb8c4b378ef3dc46ad97938ac900882f1d5f237bc91","impliedFormat":1},{"version":"83dc862cd9b7b1a929bcc03e9bbc8690cebc7e29b1edfa263f6fd11b737f19df","impliedFormat":1},{"version":"fffacebbcc213081096e101e64402c9fb772c5b4b36ad5e3d675e8d487c9e8af","impliedFormat":1},{"version":"1b243b5a51dff2bf70b7a6ce368fe7ff845c300027404b5a41a87ce5490cdad0","impliedFormat":1},{"version":"dfb119c12d7d177eb47b98c011677ca852dff82ddbe40ea571e31e04d2b84278","impliedFormat":1},{"version":"e0b50044596bf7b246a9ad7b804cc5ab521f02e89460a017981384895a468f23","impliedFormat":1},{"version":"b303a99933b69d9d6589ac24f215e5d987933782244251a10e62534f08852d94","impliedFormat":1},{"version":"e052b679185d44460040d5ce3d703d503e5f7108cd4e9d057323f307c6c0e42e","impliedFormat":1},{"version":"ddb79ad4350198a188ad3230d2646b4c67467941ddf4022ed01e4511a56d2cd9","impliedFormat":1},{"version":"8b3de2f727cfd97055765350c2e4d50ea322cabb517ff7aa3fa0ad74aab4826e","impliedFormat":1},{"version":"b3e584a57553f573aa01b34bf0d08c4dfefb2b9ede471c70d85207131f0f742f","impliedFormat":1},{"version":"23a24f7efe3c9186a1b05cd9a64a300818dd0716ffbd522d27178ec13dc1f620","impliedFormat":1},{"version":"6849f3dd56770a08b9783d61e3ba6e2d0ba82850a20ae97e1bdcaeb231d2f7fc","impliedFormat":1},{"version":"6fb23beb59f1f5c8dc97bfc012d5edac81ffca1c1b83a91381b4e130e7ce24f3","impliedFormat":1},{"version":"bc759b587b3e7213fc658fe78dbaf7b0e7c0a85f37626823b4bbef063759c406","impliedFormat":1},{"version":"04ed59801192608de22461e38b9f2e300953f1d6d6c05332f19e78e668d6a843","impliedFormat":1},{"version":"bf5cfc96bacabfe71962c32755df63ac499f732571368db3bdd7e144336c50f7","impliedFormat":1},{"version":"4c10770eca2ae9c1d5c97dad5c715b0c65def8699066231851a69fa58aaab3bf","impliedFormat":1},{"version":"c7e7d48913bfa205453911f699307e7ce630deb3c3e68326377bc2ba20abb1f9","impliedFormat":1},{"version":"4b78505d4f7ba7a80b24dae9b9808c2ec3ecb6171af03a4b86a7a0855d7a80c1","impliedFormat":1},{"version":"d09d8ac8da326eb4cf708d3a3937266180fe28e91c3a26e47218425b2ec1851d","impliedFormat":1},{"version":"50c0c2b5e76e48e1168355e3622ca22e939c09867e3deb9b7a260d5f4e8d890c","impliedFormat":1},{"version":"66491ea35e30cc8c11169e5580aef31e30fdf20b39bc22e0847c2c7994e2071b","impliedFormat":1},{"version":"35680fb7f25a165e31e93ea22d106220db4450b1270a135b73f731b66b3d4539","impliedFormat":1},{"version":"5865007a5331be0842d8f0aace163deda0a0672e95389fe6f87b61988478a626","impliedFormat":1},{"version":"dddc865f251a4993b9e23494a9ae0fb58997e0941b1ec774490a272d5a0b29bd","impliedFormat":1},{"version":"76d1f106ef20648708a7d410326b8ad90fc6f7d4cdf0e262edd6bd150676151b","impliedFormat":1},{"version":"6e974c9f7e02b1f1b7c9538619fe25d9d23e4eb5df3102f62f3bb0cb3d735d1a","impliedFormat":1},{"version":"18f3835257e2f87f8dc995c566217c5434d9bc14a6d18e7ca0e2afbfc2f1eca8","impliedFormat":1},{"version":"69055f4f0b1b2df9f0ca89231075c0578975518543100582dd37adb956ad6135","impliedFormat":1},{"version":"c3f85a0f71b64d78e7dfb27a12d10b0cd621745f40752b8e9fa61a7099d4290e","impliedFormat":1},{"version":"0b4b2424b5d19bbac7e7ad9366419746fff0f70001c1867b04440d0031b26991","impliedFormat":1},{"version":"e6d999c047721b80fc44a025370dbc02022390bfcf3c1e05cd200c53720c3f16","impliedFormat":1},{"version":"4fd695c068c325f2eb6effd7a2ed607d04f4ed24b1f7cc006b8325b3eb5bd595","impliedFormat":1},{"version":"c18fb9b8d4a7f41ae537512368ec9028d50b17e33e26c99f864912824b6e8c30","impliedFormat":1},{"version":"2b214fb1c919b0483175967f9cf0809e0ac595a7be41ba5566be27ce3d66cf86","impliedFormat":1},{"version":"ff8ece28a240cb8a29342a8c54efdaf124f93301081afa047bd1e7f6ec2a79e3","impliedFormat":1},{"version":"9b923be7ef4337bbddbd1713b13cf81da9a955034bdf657bb9e60a8fc9b20ac5","affectsGlobalScope":true,"impliedFormat":1},{"version":"527668d62da5909154a74b74a7a9ae59c41ab4a70da76c2f476765308efafb0f","impliedFormat":1},{"version":"e2974b2b0a7ba6384f5f3338d2a6a70170c3002112d6e05ce593d966100bf232","impliedFormat":1},{"version":"cc3738598b5fe875e341f701824403b3cac48c50472c72423d3e236b610fa977","impliedFormat":1},{"version":"f06e49e80942ebd4f352b1d52d51e749cb943e5b7e368cdf0ce15a169cfad5d0","impliedFormat":99},{"version":"adcbd1ed0d1621b7b2998cc3639871b57d85a3f862759d81c8634fbb6f3ec260","impliedFormat":99},{"version":"c982042c9614e12edd22a8ec0ba55c52fb31b41a513e841a0f3916fea6f775ca","impliedFormat":99},{"version":"28004f9370a7177104fe5c71381f4d2ddf8099066ba15ad0264df14135f0210a","impliedFormat":99},{"version":"0d85481bf9d4418ad633806d8d909777749291164161e87d3f76fb68ab1ae4b1","impliedFormat":99},{"version":"26474a5870247854706ee1a1b53846c464fa46d4f0fce6feca43516c6a565ece","impliedFormat":99},{"version":"499060fff17e6127887065c69309b9785808229fa4851185762b434fd191eb8f","impliedFormat":99},{"version":"e8b61ed76ce071a18c16b3d5145c9ec24a79afa4a40e4e70482d420988ad2e92","impliedFormat":99},{"version":"959c15065a76d4dc5e77e5c83dab8bcd52ebaa5779eb4d42fb43a5134c219eca","impliedFormat":99},{"version":"6aba2b87d07562e15164415aeb5ef55e544cfc4ead91c18982e0c5b70739c120","impliedFormat":99},{"version":"876324641782ef0d4123c39ce5b4fe59ddf3dcd8ef747bc06bd935aedf0a71c6","impliedFormat":99},{"version":"0716a38be84ad12588a2ffeb66977b960b6f9ec477473063b61b7fab971bbe4e","impliedFormat":99},{"version":"b735d2a2c8c350d82d158153e5335c3f4e444ffaef9cce20a19ba07671146d26","impliedFormat":99},{"version":"5cfb2066d3fe03aa5d6ffad84629bcb1eb4fe7cad46f874afca80aa459962b75","impliedFormat":99},{"version":"0a1b0a946c2dc3dbc3f7b41fab8ca5a3bb5f21fc3965dc07d1cb5af831a962d3","impliedFormat":99},{"version":"0e1a03168fbe0d48c1a558ce495ea48c922f9c2c98658092ef8361bb8c40536a","impliedFormat":99},{"version":"1204aa56ffbdf67afe38cd279d602ff1033fe9dc2110fc8fc219f1deb4b18a5e","impliedFormat":99},{"version":"4c1ff9f63a51c238c1fb1c86282d101c81677e46f155b12077e08ee57cffbf99","impliedFormat":99},{"version":"a06db219f83fd299973856c648293bcfca1f606a2617b7750f75b13dd28ca5fd","impliedFormat":99},{"version":"ebd64fdcbf908c363ab65ccb1ad9f26d82cd2bbb910fee5a955f3b75f937b1d2","impliedFormat":99},{"version":"608c0d45e9440b26e61a906bcd32ca23db396fa32aa29087db107bee281d70bf","impliedFormat":99},{"version":"c57ff70bc0ae1a2abe4f1a4c8fc8708f7cd99d0de97fac042e0ba9f4970c35db","impliedFormat":99},{"version":"cf5007ed1f1bdd4d9c696370c6fa698eddef590768bbb9807c7b9cb4000a9ec7","impliedFormat":99},{"version":"b96853f733fed9aa8ad28d397e1ec843792749dd8432e7f764edcb5231ec4160","impliedFormat":99},{"version":"6ee0d36f09cff8a99010c8761003a83b910149e5d7b39656f889b2bbbabe0f27","impliedFormat":99},{"version":"b9f6ae525124fa2244c7e5ae3d788d787db47c4dab1beda7809cfb6c47f74968","impliedFormat":99},{"version":"f8f75cca65070d998f57e0a8dc19901a1fb45d7f9a00d52bb58a110c5c1a1bbe","impliedFormat":99},{"version":"22f11a23b6a5fd4a2cad1fba0416cccd42b6a7b8cae4d4480184e0a43203309e","impliedFormat":99},{"version":"a1fc2559d90de9e703fab40ed46ff05a402113d164892c3c4ca192102f136c99","impliedFormat":99},{"version":"514167c3cc3640146a0ede53e59dc82c1d27ad1bc1e134912a0ea2cff69f997c","impliedFormat":99},{"version":"be3e007fce48e278f74ae65322d12b854ddbe43ad668f7029e694772f1b9b0c0","impliedFormat":99},{"version":"67bf109fbb2bc9c90d02cd32393577b411c99030a116c284baacaea07074b323","impliedFormat":99},{"version":"bceff386a896b398fd6277ebb87d37c96a2d5407d970875dd6f617fdf837758d","impliedFormat":99},{"version":"062b7306d2432bfafe9fa5912529a773da133187752fac6b1ec6ce0fe6654271","impliedFormat":99},{"version":"42aaa7efe249cb7c01cdb2a955efce8f2b309038da1edca6bf8e3738aebb8359","impliedFormat":99},{"version":"32d658d74465b471bf18f85fae438d5c9a836bf6e7d0f8df31c5763c2f134e15","signature":"f8eecc2443a20a33ac5b322ad733189a38fe757b586882d8860fc745dea8a852"},{"version":"09797d041ad10147400cba24a0d60191af8bfa4ae2c53da56f4354f59155cb3d","signature":"bab033775301da076188b4d71da6fb70390e31b0957ed43d2af5fc30c43484eb"},{"version":"d8fa4de4813a91c957b8330dff00d14eccd41439d574148818c25fa82f3a4ece","signature":"16d4f4bdcc0e45c6327ce52437c5b6df480f2e1ec11eb89b47adb55f8ae74106"},{"version":"a534e61c2f06a147d97aebad720db97dffd8066b7142212e46bcbcdcb640b81a","impliedFormat":99},{"version":"ddf569d04470a4d629090d43a16735185001f3fcf0ae036ead99f2ceab62be48","impliedFormat":99},{"version":"b413fbc6658fe2774f8bf9a15cf4c53e586fc38a2d5256b3b9647da242c14389","impliedFormat":99},{"version":"c30a41267fc04c6518b17e55dcb2b810f267af4314b0b6d7df1c33a76ce1b330","impliedFormat":1},{"version":"72422d0bac4076912385d0c10911b82e4694fc106e2d70added091f88f0824ba","impliedFormat":1},{"version":"da251b82c25bee1d93f9fd80c5a61d945da4f708ca21285541d7aff83ecb8200","impliedFormat":1},{"version":"64db14db2bf37ac089766fdb3c7e1160fabc10e9929bc2deeede7237e4419fc8","impliedFormat":1},{"version":"98b94085c9f78eba36d3d2314affe973e8994f99864b8708122750788825c771","impliedFormat":1},{"version":"53c448183c7177c83d3eb0b40824cf8952721a6584cf22052adc24f778986732","impliedFormat":99},{"version":"cb12951f8033990db6e317e7608195fb183ab491fe307cb8902d3a48035b9fc1","signature":"2a2138e9112f90bae462f82766009e6cd454b53705a55ea414be459ada7a8c1a"},{"version":"c1a2e05eb6d7ca8d7e4a7f4c93ccf0c2857e842a64c98eaee4d85841ee9855e6","impliedFormat":1},{"version":"835fb2909ce458740fb4a49fc61709896c6864f5ce3db7f0a88f06c720d74d02","impliedFormat":1},{"version":"6e5857f38aa297a859cab4ec891408659218a5a2610cd317b6dcbef9979459cc","impliedFormat":1},{"version":"ead8e39c2e11891f286b06ae2aa71f208b1802661fcdb2425cffa4f494a68854","impliedFormat":1},{"version":"82919acbb38870fcf5786ec1292f0f5afe490f9b3060123e48675831bd947192","impliedFormat":1},{"version":"e222701788ec77bd57c28facbbd142eadf5c749a74d586bc2f317db7e33544b1","impliedFormat":1},{"version":"09154713fae0ed7befacdad783e5bd1970c06fc41a5f866f7f933b96312ce764","impliedFormat":1},{"version":"8d67b13da77316a8a2fabc21d340866ddf8a4b99e76a6c951cc45189142df652","impliedFormat":1},{"version":"a91c8d28d10fee7fe717ddf3743f287b68770c813c98f796b6e38d5d164bd459","impliedFormat":1},{"version":"68add36d9632bc096d7245d24d6b0b8ad5f125183016102a3dad4c9c2438ccb0","impliedFormat":1},{"version":"3a819c2928ee06bbcc84e2797fd3558ae2ebb7e0ed8d87f71732fb2e2acc87b4","impliedFormat":1},{"version":"f6f827cd43e92685f194002d6b52a9408309cda1cec46fb7ca8489a95cbd2fd4","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"a270a1a893d1aee5a3c1c8c276cd2778aa970a2741ee2ccf29cc3210d7da80f5","impliedFormat":1},{"version":"add0ce7b77ba5b308492fa68f77f24d1ed1d9148534bdf05ac17c30763fc1a79","impliedFormat":1},{"version":"8926594ee895917e90701d8cbb5fdf77fc238b266ac540f929c7253f8ad6233d","impliedFormat":1},{"version":"2f67911e4bf4e0717dc2ded248ce2d5e4398d945ee13889a6852c1233ea41508","impliedFormat":1},{"version":"d8430c275b0f59417ea8e173cfb888a4477b430ec35b595bf734f3ec7a7d729f","impliedFormat":1},{"version":"69364df1c776372d7df1fb46a6cb3a6bf7f55e700f533a104e3f9d70a32bec18","impliedFormat":1},{"version":"6042774c61ece4ba77b3bf375f15942eb054675b7957882a00c22c0e4fe5865c","impliedFormat":1},{"version":"5a3bd57ed7a9d9afef74c75f77fce79ba3c786401af9810cdf45907c4e93f30e","impliedFormat":1},{"version":"ed8763205f02fb65e84eff7432155258df7f93b7d938f01785cb447d043d53f3","impliedFormat":1},{"version":"30db853bb2e60170ba11e39ab48bacecb32d06d4def89eedf17e58ebab762a65","impliedFormat":1},{"version":"e27451b24234dfed45f6cf22112a04955183a99c42a2691fb4936d63cfe42761","impliedFormat":1},{"version":"2316301dd223d31962d917999acf8e543e0119c5d24ec984c9f22cb23247160c","impliedFormat":1},{"version":"58d65a2803c3b6629b0e18c8bf1bc883a686fcf0333230dd0151ab6e85b74307","impliedFormat":1},{"version":"e818471014c77c103330aee11f00a7a00b37b35500b53ea6f337aefacd6174c9","impliedFormat":1},{"version":"d4a5b1d2ff02c37643e18db302488cd64c342b00e2786e65caac4e12bda9219b","impliedFormat":1},{"version":"29f823cbe0166e10e7176a94afe609a24b9e5af3858628c541ff8ce1727023cd","impliedFormat":1},{"version":"0f1adeb73408b68671c1ee36003c5562b7ecaebb7df26afd797c14b6cdfced94","signature":"54c892cff4ae9214b4757cda742783dceda11b24f2732c3ad629316f64378327"},{"version":"92fb9011012738b2b1e6dc003ee0eccd02ffcf932b2f24e5ad189a47e722f768","signature":"867ff3eb613abe85adb3da152334a8710feb07b2e118a54790f1691c950bfad1"},{"version":"bd86a81ed118d39ae13d1dbd906c41c927f9da911012680c55006a4311caa40c","signature":"8e609bb71c20b858c77f0e9f90bb1319db8477b13f9f965f1a1e18524bf50881"},{"version":"566bc548c7e554be52c2bb02ef7c0069b48ec7364d55bb7b639f6d39fa695d56","signature":"8e609bb71c20b858c77f0e9f90bb1319db8477b13f9f965f1a1e18524bf50881"},{"version":"1ee12c539961ac7605f2e17405088fd8e14ac49e2a40bfd68a389a2b1dcc970e","signature":"b8c5eaea33db3fe9e8fb43b1e1baeb746a5dbfd48d09a58f86a8a7961bd3270d"},{"version":"e35ad5c8bec33f1cfa69d427e6f3a8143296eb9dbbbda456d334303019fdf9a2","signature":"98d4ee4a8e608e29a12b85012df206ece560e43695f43605f0d2f46aeb27b79d"},{"version":"ab12f7b1cc6d28b90f78d4e24cd1df860c4884be6e8737e2ac3a5d71b36fe6de","signature":"ef28371847abaa6990b42ffd13bf9968afc62d76371e2670c7325575e4c7cb16"},{"version":"22e8ad8172af8152050187cb221b2ea82f5cf0ccafbe6bace673a20968e72b5a","signature":"8367700429e4fe3c639b8fb9694a2a5336519d3698a78499af1544dda746006a"},{"version":"c581d2722e33d281ce0646f4d2f86bd83a0a76376f6357f9689d4df12c04a9ec","signature":"1e51aa6babaee199e7e1688c8bc4c8e4266544cea16299765383d9142201d95e"},{"version":"ada582ffbdb6a1684a69b2bdb6a7aa5c5985b65c6e9a2ebd18afb1a3fbffa1ae","signature":"db0248a4bf7e5f30b1239db34c8f4b310c2f57edd44e563fc3968bcf034507d8"},{"version":"cc2958d8abd86edcdf05542bb1b40ba659db5bc5a2560720cde08e8950e63bc1","impliedFormat":99},{"version":"e44e0ea195d68c0aea951809bda325322085008c0622fc4ee44db5359f37b747","impliedFormat":99},{"version":"fa2c48fd724dd8f0e11dfb04f20d727a2595890bfa95419c83b21ed575ed77d1","impliedFormat":99},{"version":"6d23ffe7f1b73f16b08f5baeca430e6655b46fdc5862fd7bff1483b71fc6b28d","impliedFormat":99},{"version":"20be44c04e883d5fe7840d630a8d0656e95b00c2d6eebab9ab253275e7170534","impliedFormat":99},{"version":"3b674288fbdc0ff0ed2b7fc2839014c2ff209c84999fd06b6339347d0f976a85","impliedFormat":99},{"version":"87561cc8a2d7444adf4eed4b3f15bef8c6098cceb0e7617fba1cc45d187ac8c8","impliedFormat":99},{"version":"fd40c454d56e1d14e60ce13f3bc60c7fdb9bc70c6ef9c7bfafec1f0eb5d8075b","impliedFormat":1},{"version":"155ced96d70533d95c481061e2691802fae7cfb96869d7c85ac8622f53b51cb7","impliedFormat":1},{"version":"3689b6f599705380d2ceaccb4e58eec5c9439a7a5635d6e37c1ba66ed7c34b35","impliedFormat":99},{"version":"6cf0d3cc668cdbb01358ef7c2e41bbcc14d8d8e4ca424a1b6d2838d9a1cae8ce","impliedFormat":99},{"version":"b7bd70307671536c735389e0a1748555c438c392dfceb6f2ac3aa0a50ca82530","impliedFormat":99},{"version":"661c403f4c5bbf259e03f4fdc3a9e3f51ad562684f702e1b842e6c5336de0752","impliedFormat":99},{"version":"415dd92247ca21db682f75ba7e6289ab2d093cd34c6f471c6c789afd047ad4f3","impliedFormat":99},{"version":"b52f7568bb9b00bcee6c4929938226541c09d86b849b8ba8db2fe2a8bba46f49","impliedFormat":99},{"version":"39d80ec3c018d7ffe7c99ddd3a7b6844b3376c15e52937a7687d2c2828830fd0","impliedFormat":99},{"version":"828f8b38dff4e5c47b0112cb437da379c720f0360d40d392457c9775f30c8ae8","impliedFormat":99},{"version":"d42e1872d53ebb213e7bbe15e5fecdcaa9a490d2f2a2b035ee9cf4a6d3f1e44e","impliedFormat":99},{"version":"2262d96c02073dcb17a31ae8c738651ebff75f102522eae686f5462658b687a8","impliedFormat":99},{"version":"21053659ad72fe51b9dfbde4fa14dbbac0912359fa37c9a5aa75f188782b2ee8","impliedFormat":99},{"version":"e297bdcb7db008d8d7d0481f2c935a9f7f0a338f41b7e5d1cec6a7744140a4ff","impliedFormat":99},{"version":"ef816ad6735a271c4c8035a1914c3a9beaaa90b3c174da312d26bce8736e56ec","impliedFormat":99},{"version":"7202026e24c5e5b7b6e5fe6b99455a91058ef82e74a5cdf6a3a4136b7ae9c080","impliedFormat":99},{"version":"69dbe5d61d2f298046513598f55bd1e719c50dfd6af2f9feea6fc84f8aa3c4bf","impliedFormat":99},{"version":"6a78643fbbf1b0bd954a53d4edfa217b6a5f92d357fa9cdf8d2ee430f96b9472","impliedFormat":99},{"version":"2ebe2f0255b6f301ba7bc0e10c3dda289c6cf1876f289f7a8f6444613d988e5e","impliedFormat":99},{"version":"012b5083a47ccbe050763f8df2be89daa50c1606e9a0bb31f64276d508c02d78","impliedFormat":99},{"version":"fc7c3943608aec142abb8c28f5892a1faaf255d48e1137ff2b2e0be0afdd479e","impliedFormat":99},{"version":"42aa071346a5fab8aaa711a5e5419e7cce811e6c756b4bb9c5c987704b986b5b","signature":"8b3e6a0d30746c35ff7ab2a7179a1700bd199dcdf936804a1d4eae0017050f67"},{"version":"de1543ab5c6d5e3ab8fad5170d076dc37dba0f89ef3801694035917f101349f3","signature":"7680d128c01a02bd131fed5a76aa6879917fbb26d730b90ec15a25ded4318e8c"},{"version":"ed49870f21543a16bd5571f602cc74caed04a0f699c2b49e7e174f7d87b9014e","signature":"d32a6891fb31dee4dbc4b128f3e744c9dc3911f5ffb08e6cc5c918ab8558aaa5"},{"version":"479b00a0d93d044a1eeeb9d1439a6fbd26cb478ace45a21b64f197caa93d81e4","signature":"7671ec19c96956f7963daaac309286da3ce9f1b4e16824c1d3cbb1791745be11"},{"version":"59226398b7e6a88962a5474bc7f2ab57c7bfc7329d1d2cf6386233588caf5db5","signature":"a9904eff5f59be5ee5c2daf5c28b5a1bc652ad7b7359c831eab16977e4d9d782"},{"version":"6b2c934c2b6c60c98da8d9427d6838665d4fe8efb2659547663d77a3ef3ac5d9","impliedFormat":99},{"version":"fe47ec4f7f79eb01a2282a0598f919e9b46088147fda6034437a5edb9382cd30","impliedFormat":99},{"version":"a46fefd2d219c22b10266294269555f5ab0b13237b2a719377b6c6192a62843e","impliedFormat":99},{"version":"43f01343ad7498742e35c9881161ffc4bdf7a6b33f4a437299f0e4f1c8fb64f2","impliedFormat":99},{"version":"811c780ede319f5830e00730dc9d8a2a98e87e66535eaf824a3a0da81f7e21fa","impliedFormat":99},{"version":"a9347d2796c333f60f4f6ee1749226cf5255fd54f8e73f2ad83a0054293a4f91","impliedFormat":99},{"version":"49070cbd8d8edc96626303df51625ce7481bf9e450ce0ad89e8c936758cc3bb9","impliedFormat":99},{"version":"639663a633d039219df52c863b5f27ed7e04bbf680e679db1e7101c552d3a2c9","impliedFormat":99},{"version":"01545f0274a774e191f06380ddedaec2b2dfbd021ca2e8775f7819959beb2cb4","impliedFormat":99},{"version":"6c557db1095e0588b7d82d9bdd9e4328872d436a94f2025da271d5ef57845309","impliedFormat":99},{"version":"2827790fc4a5c48d032a79a8d547eca0620d7fc7c997b830417f6de5b04c7c3d","impliedFormat":99},{"version":"7c11a1ba7e6c12ac8f50ba8c40b1126a154799343f135c221d0407a5f29ed6f9","impliedFormat":99},{"version":"8e1eac40a317afe1efafb7594f2204bef315a56d45c31762d61e77387083fd53","signature":"be5e176705a18599f7e76d01cbe81fa45bebd1a8f7e269e79280c7745f1fbca2"},{"version":"ad3e0245e4ee499d0870c3419cd9a0d12cc667f9a6cca0b22d0daff048bc05de","signature":"92db75b85f220d479d842a7c10335bb4b19ecf7bc20711ff2afa3c53efdfff25"},{"version":"32246c428ca62bd1e53e394a79fa87d1ba216bf1b22a0bd4a3945132767119b0","signature":"53eec4e92bff557d9d48ea67c50ed0b0597d117d7f35adf3eeac500a7cbc6f63"},{"version":"13782b7c1c334f73c99ef70c26e546a27fdef1412941d7424ee21b0da2fd6524","signature":"068e144d2984b801ba0c1a98e15672abc564dc2786f8b8143c2319d8339c1e5f"},{"version":"7b4f05a202254e947b41a86794f3fdcac03ef84d9afcd86442d83d6aa619ffad","signature":"6d69a9bfc2096ae21d134473ef06f16586e65747e8da5d9ebd169731a1995686"},{"version":"69d6d3bbd6c292ef8bb1ed5c22f09f248712c6f3ac724457c1d02c81c8685dd0","signature":"0296536bcb8c48bf59bf2110d8df5966aa26f1b1cefdb6ea2e098ca57945387a"},{"version":"ab0ec536a248b19e8a8d952e69231ec72012fc00e3a897afd5e21d9caf6075fe","signature":"a3b78ab82e44a72e19af974fea763b2359635de85661925b13c44f489782c94a"},{"version":"bcd835eb9f6c13e4c7879728382accb4abd1d3e229070c973820ce0c544aeff1","signature":"4b3ce10eb5ebd7b8a04b9c72d5df83fd10a234072d87ae8cc5894ed03b6d7d23"},{"version":"145cce0f9e11865eaf5a53cbee54eb55c8244ae0559b66965034df15dd33c888","signature":"95a23140d4cca06f17d34d6a6dc704ebb46db1a706fb703e9a1cfb7335e01949"},{"version":"30aed1d899ce77c53e1c3f5083faf9088244b2ece412b1591006d21ce1a8c3b9","signature":"bbe34cc1ed168908d9eaf4e964ddc0536397b52c087d8b86fa86fdd980c7f647"},{"version":"8a19f23abe2f01ec06a5a6fe9bad0ed727ff709c3a2f5d5bf8615cb2c55a5b87","signature":"40af593d50f8eaf4f2ca6b0758cb565c9d716e14bb8f9685e48936c4559714e0"},{"version":"20670b730f5166e84d1ec7516a2c4400329063c3ea0c272c9e73d5a18faa9039","signature":"153e1e2029cdb7914f043c7c5b7f665cdba4c7385779c7474ddcdc7cec163e69"},{"version":"4b03034d2ea80d00e2b2d86c1f3248ab978f612ac1ef4e998a3535a66680e01a","signature":"0b339f27d46999d736291b1a2672f8b557f0fdea223d2d0cc1501a0766569516"},{"version":"75ba4e15b67f86ff757ee8203f8fb862cb76b032742ef5f3df93bafca00f6241","signature":"c090f8daf14db1f6f4c10b7c7c7249c5e63c48c11343c5ba53b95f152f4fa5ef"},{"version":"c7dbcedc887f87bd02fc7a0a0759378afd6bf5fc08786317ed8d9d140cec42ba","signature":"01ffcf47ac06b1b7f6b0de3e70f24a59361c9ab0508f62131baa9d1d6d13d70e"},{"version":"c273b5d39eb1f9853c0fdb7f0a9cf405038f893f70c58df54504ec98736fc080","signature":"9db266f21fc20d3e53c4681eec23a65e446ac3390da1ff6d264cd72302e481cb"},{"version":"10fb6bd7129ac9c0f6810228c6d650745a69107afd027610eb368f728fd293e8","signature":"34dab4fa4f344137bee76d7f8432c34a8ea29a3cc5091fbd172a91d8d71e649a"},{"version":"bbbf78e217c65e0a5e1bcef8f7b12217fdc710e0a5f28fcc3680892744b36946","signature":"5c897e5611d400032a1545aa6d6d040e97414bbc34762ed7a97e5d54df77276f"},{"version":"f286e42795b71b671211cd828da471c464e037c35dbcfb4c7208c11939abfb56","signature":"17d6e91622a5ad3d21b12dfde16c8cce319f83628c96c589b2cc53c6be972da4"},{"version":"31d4c5fa51eacb8b9fd36bac10e29037b948ad249cb38d8b99021b0fffe1d4fb","signature":"15e00b37689f61ca88fa05544dc9233302fce1949164d7ee88e4a89d9c6fb764"},"b7453e7c7ea46d60a85e3d77c3fd273a2b5185fe66f714d2872fcc9b4578ada5","1113c000b424b5533fcd6d4e89685606655668fed0eacf97ce51dd372262f252",{"version":"3f8a1a28044cde5943725a8a74f5eab9bb8e3ef9ca2aeae0b9f0c4a1b0def6b7","signature":"b0161a54a939361bbc152bb45a84713868b1a4411ad13f7525386abef76db0a4"},{"version":"658dfb182d9aea5cb805fa95cc29f643753f659e7ac7b624273cc40ee105a6e5","signature":"52822a12c70d6115b15c87f6bf009de4434a873026b81d82d5e3774b1e741e86"},{"version":"c13bc0c7c75bc996a9157a6319e3d007996d1389efc23e1417f0f42a3faf6045","impliedFormat":99},{"version":"3b4c53547dfca662aee2af553927fde9519b3d1ee13002c01cb7d3e0dd845cdf","impliedFormat":99},{"version":"5c1255a52052237b712730bd0da805b0a708262909e500479a321688c1d6d197","impliedFormat":99},{"version":"1fd7bfea6c425ce8ec33a7d92edae59f10bc09f86ae01658447509d09ca663f1","impliedFormat":1},{"version":"c57b441e0c0a9cbdfa7d850dae1f8a387d6f81cbffbc3cd0465d530084c2417d","impliedFormat":99},{"version":"51954e948be6a5b728fcfaf561f12331b4f54f068934c77adfc8f70eea17d285","impliedFormat":1},{"version":"7c8c3dfc0cdd370d44932828eb067ef771c8fe7996693221d5d4b90af6d54f2d","signature":"512960c0e955a2324b34354dac25e3e4d431a1af4cd33077935eda5e95c8b7e1"},{"version":"a346701ad6dcdaa58e388fe0995fc5304c09c395b8cba68ed872780f8c102004","impliedFormat":99},{"version":"2fbe402f0ee5aa8ab55367f88030f79d46211c0a0f342becaa9f648bf8534e9d","impliedFormat":1},{"version":"b94258ef37e67474ac5522e9c519489a55dcb3d4a8f645e335fc68ea2215fe88","impliedFormat":1},{"version":"5a5c4b8b60a8a80ba7b8b5d0319be2d3c61bfd2ce4fc2a645371dee9f6db0a77","signature":"5617b4039bfaf841355761a98a33aaf64daf6485fb0011aa9696b7088a4f20f4"},{"version":"56b7fd30208addbcc2468cfda4f5bc0a55342211deaab61ee35b1c352b1622f1","signature":"f774a7e8875649db68f5952801f001f3c316560ede472e5663af7a8c9c18f938"},{"version":"caf4af98bf464ad3e10c46cf7d340556f89197aab0f87f032c7b84eb8ddb24d9","impliedFormat":99},{"version":"71acd198e19fa38447a3cbc5c33f2f5a719d933fccf314aaff0e8b0593271324","impliedFormat":99},{"version":"9ec42c8a57e82311118b794318409ee02b2cebfa49ba6cce8457cff6448cd471","signature":"dbebb8bec7d542573751dfaaf4d26db5f11c7780d76ea9c3a7e2de472ad1681a"},{"version":"7d524f01b932e18b4d71ff104768f81f43bcd404976bed6a148acdfd84ba3adb","signature":"21586647dd5745748a731456ea10e85fd3bfa6258291d8b15adccadde921551c"},{"version":"a9373d52584b48809ffd61d74f5b3dfd127da846e3c4ee3c415560386df3994b","impliedFormat":99},{"version":"caf4af98bf464ad3e10c46cf7d340556f89197aab0f87f032c7b84eb8ddb24d9","impliedFormat":99},{"version":"7ec047b73f621c526468517fea779fec2007dd05baa880989def59126c98ef79","impliedFormat":99},{"version":"8dd450de6d756cee0761f277c6dc58b0b5a66b8c274b980949318b8cad26d712","impliedFormat":99},{"version":"6b5f886fe41e2e767168e491fe6048398ed6439d44e006d9f51cc31265f08978","impliedFormat":99},{"version":"56a87e37f91f5625eb7d5f8394904f3f1e2a90fb08f347161dc94f1ae586bdd0","impliedFormat":99},{"version":"6b863463764ae572b9ada405bf77aac37b5e5089a3ab420d0862e4471051393b","impliedFormat":99},{"version":"904d6ad970b6bd825449480488a73d9b98432357ab38cf8d31ffd651ae376ff5","impliedFormat":99},{"version":"1179ef8174e0e4a09d35576199df04803b1db17c0fb35b9326442884bc0b0cce","impliedFormat":99},{"version":"71459423cd653def7dc3b55e2b5fd583955903ecc6c4a32889303c496e36f198","signature":"b79d4c431a053e075eaf2949dbf85259243acb49b26b66346f27009eb7719250"},{"version":"dfcf16e716338e9fe8cf790ac7756f61c85b83b699861df970661e97bf482692","impliedFormat":99},{"version":"bd07164f172aafffb93861e4b1a3be4249f5a8739f24454864f2cf9c0c46758d","signature":"04c08108e382fd9865d254a7f2a0e59df26dfe981d977b34c4cd096f6e8df872"},{"version":"a9373d52584b48809ffd61d74f5b3dfd127da846e3c4ee3c415560386df3994b","impliedFormat":99},{"version":"caf4af98bf464ad3e10c46cf7d340556f89197aab0f87f032c7b84eb8ddb24d9","impliedFormat":99},{"version":"cbfd5ef0c8fdb4983202252b5f5758a579f4500edc3b9ad413da60cffb5c3564","impliedFormat":99},{"version":"e7a89220fb49e18d6613956781cfd5eb38d5da36379e93f5fc90ccec127dc871","signature":"64073fe93e9bd17358918a585e5aeda241e7b6dc1dd4b745f49e1889c5935366"},{"version":"49d8311589b810b106aada8ef7b13f70b2b1f68cfce4e1458b7f31a191f420e9","signature":"99cced08956b46ddaaacfc9e62594334726e43031627301a08ce2b0650d0e0fe"},{"version":"f2b6d401b1c8387d0a03bcca48467ee689ecc5d03493b8440f57d96218f66da7","impliedFormat":99},{"version":"933d6cfcc7c4ac2a5a4679f96dab41d1f38d0d6973e79288fd570d0ef9f3de58","impliedFormat":99},{"version":"0aad57315517e398f977907ca66e26aef6dc06cf482538dd3efe876baa5efa34","impliedFormat":99},{"version":"5f9ea9cfa716dea35bea3b11a8c52ff7ca90ec86ef5db1ab462975d10ed5fefb","impliedFormat":99},{"version":"8a432ff1c3a5f3083f3fc698ccb614a422514f845ad2158e8a954d3dd9a1c383","impliedFormat":99},{"version":"bb0f3a67272b6e12765ee5bd04d9969f779c35e632cac31bebb8a238e79ccc01","impliedFormat":99},{"version":"f049628b303d1ba30dcfa46e095b7c67638ad17146599c4df66fd40e38045885","impliedFormat":99},{"version":"035ffb3bf35b09544af186b3e78c6640ab23e6a374e6abf875e277bed59e0b81","impliedFormat":99},{"version":"3d30c84bac42c4f3da06a303771e58da9d0bab7a40f7adda166bd7e35c708533","impliedFormat":99},{"version":"405501b4c236ed78cb85928230c036407876112567adbaf3bfdbb892fa7a1bc2","impliedFormat":99},{"version":"077b0833e6544bac6a03e8e55fa15d93e2cd468309de5b2b36510f9f15657594","impliedFormat":99},{"version":"c01c797d13204a56ff9adb165f961605d3bee4d9171aec0dd2cf2d867b22a258","impliedFormat":99},{"version":"4fc9df4b5e878b00cd1019d6c9bb9bb27873194ea91eaa1a980d8d1480ffb2cf","impliedFormat":99},{"version":"50cf7a23fc93928995caec8d7956206990f82113beeb6b3242dae8124edc3ca0","impliedFormat":99},{"version":"352031ac2e53031b69a09355e09ad7d95361edf32cc827cfe2417d80247a5a50","impliedFormat":99},{"version":"9971931daaf18158fc38266e838d56eb5d9d1f13360b1181bb4735a05f534c03","impliedFormat":99},{"version":"12b97d1c4f0ea1407744fcbb049195ed5db407608e29299d89c209b4a19e8a70","impliedFormat":99},{"version":"687790a1cceb96b33bb4a35f668a657845c7726a8f4231641bc2a3fcb5ffb1fb","impliedFormat":99},{"version":"0c5b705d31420477189618154d1b6a9bb62a34fa6055f56ade1a316f6adb6b3a","impliedFormat":99},{"version":"853b8bdb5da8c8e5d31e4d715a8057d8e96059d6774b13545c3616ed216b890c","impliedFormat":99},{"version":"969acadc6dc10ae257c05e8b584124c8bc4a3fb12fb2062b1da6b1e8550d681c","impliedFormat":99},{"version":"fe3c64bf61fcfec9b9861725c6d92de03f33748a01d982760ccfa798d777cf9d","impliedFormat":99},{"version":"ae0c10759c986fe28c7003da407747090b6a838a34ae2ad2d0e0d7f7a7e70691","impliedFormat":99},{"version":"204541866908e7dd2b9a4c845eecefb9727e340e657728a5febb59615e41b508","impliedFormat":99},{"version":"2bb7e3f4061e7fdb62652ffb077ca2a01b55e9d898409e37fe1ae97acab894ea","impliedFormat":99},{"version":"c363b57a3dfab561bfe884baacf8568eea085bd5e11ccf0992fac67537717d90","impliedFormat":99},{"version":"1757a53a602a8991886070f7ba4d81258d70e8dca133b256ae6a1a9f08cd73b3","impliedFormat":99},{"version":"084c09a35a9611e1777c02343c11ab8b1be48eb4895bbe6da90222979940b4a6","impliedFormat":99},{"version":"4b3049a2c849f0217ff4def308637931661461c329e4cf36aeb31db34c4c0c64","impliedFormat":99},{"version":"6245aa515481727f994d1cf7adfc71e36b5fc48216a92d7e932274cee3268000","impliedFormat":99},{"version":"d542fb814a8ceb7eb858ecd5a41434274c45a7d511b9d46feb36d83b437b08d5","impliedFormat":99},{"version":"660ce583eaa09bb39eef5ad7af9d1b5f027a9d1fbf9f76bf5b9dc9ef1be2830e","impliedFormat":99},{"version":"b7d9ca4e3248f643fa86ff11872623fdc8ed2c6009836bec0e38b163b6faed0c","impliedFormat":99},{"version":"ac7a28ab421ea564271e1a9de78d70d68c65fab5cbb6d5c5568afcf50496dd61","impliedFormat":99},{"version":"d4f7a7a5f66b9bc6fbfd53fa08dcf8007ff752064df816da05edfa35abd2c97c","impliedFormat":99},{"version":"1f38ecf63dead74c85180bf18376dc6bc152522ef3aedf7b588cadbbd5877506","impliedFormat":99},{"version":"82fb33c00b1300c19591105fc25ccf78acba220f58d162b120fe3f4292a5605f","impliedFormat":99},{"version":"facde2bec0f59cf92f4635ece51b2c3fa2d0a3bbb67458d24af61e7e6b8f003c","impliedFormat":99},{"version":"4669194e4ca5f7c160833bbb198f25681e629418a6326aba08cf0891821bfe8f","impliedFormat":99},{"version":"db185b403e30e91c5b90f3f2cfa062832d764c9d7df3ad7f5db7e17596344fe8","impliedFormat":99},{"version":"669b62a7169354658d4ae1e043ad8203728655492a8f70a940a11ca5ed4d5029","impliedFormat":99},{"version":"a95cd11c5c8bc03eab4011f8e339a48f9a87293e90c0bf3e9003d7a6f833f557","impliedFormat":99},{"version":"e9bc0db0144701fab1e98c4d595a293c7c840d209b389144142f0adbc36b5ec2","impliedFormat":99},{"version":"9d884b885c4b2d89286685406b45911dcaab03e08e948850e3e41e29af69561c","impliedFormat":99},{"version":"d09bc516a2186c2f4246ccca9f03d8d47539ddbc44a706571ceb0677f8ae49c9","impliedFormat":99},{"version":"89f717131e5687c4b1c0743f0d7f378c5976036a9434028b42727bee8fa794cb","impliedFormat":99},"b6306cd68a398e5ff06195ca93a8970ac9f0abb7024019b070c145e85387e492","af2a08c05f45c0ec409357cd8867db42dec5f6693a86f4abfb575c1bf171582b",{"version":"e7455feb113b38c59456ba29a9ec264b5ffa1daae8883866332ad637ffd57c31","signature":"7612537cfaddf7d94eadc71c476610562b58ad2919ff9c918789c1fcbe32b2d4"},{"version":"f6aae6fb4c40635421467a4852de98643f3bc120b8181fca4752747046d98676","signature":"de04ae66d4f35b26397d205c1c356372942829d68ebed40011b68c40529b7704"},{"version":"2c57db2bf2dbd9e8ef4853be7257d62a1cb72845f7b976bb4ee827d362675f96","impliedFormat":99},{"version":"a8292972a5b81eff164f621ac0bb66f4ed4419d1599e2d4901968e216574677f","signature":"6e78426389b5b55452342b7385f6b16cd0785b76d421e019e823f6b41c42c6ca"},{"version":"99d1a601593495371e798da1850b52877bf63d0678f15722d5f048e404f002e4","impliedFormat":99},{"version":"1c5d0b242d0513848f4bfa9b57ba7f438d9b1120617029941bfaa137196ecead","signature":"01ea6a3d10be8e840344854550edb1a46859d714767ab61e3a7b836ea2dd6410"},"c00a3850199a8b78c9ad76d8fcd702f23d7103773e87bd08c11cc3558c192a5e","b8ddc893a7116657306be23b6d652522fe002bfb265c6b2535b85b68a9d397ba",{"version":"2040cdff27cd1ed771e0ebbd15abcd73d31f2f1e4be6664bd6816fffd2a87476","signature":"1a6115819fa1e86a8fdfdef41f15eb65ba315a1ab6079a7db3f018bf72f4c0c2"},{"version":"bc22bc49d51fd2bc55d6646624b224183450c12fd3d62f40828bc52fcfb66e97","signature":"3a9b0e089530432b4decf0e9ff98328bf3a838f2e1019ab6695db8709738cfc9"},{"version":"688d688eb526565c34bf4bea5b3f63d8550605c8f4c56b93da2379c80d3e8e13","signature":"21667da74aa90bea925d6c7a2468ee2593cb6c78fcd10a73ce0a3ff0afee6a38"},{"version":"604a60eded7045e43c124bd1c767c506282b1a9280803ff475897a06621fbbae","signature":"866fb4dd8a2c7cfde71dbb48ec72a6f4a72816f39cce53fbdd185882ed6face9"},{"version":"fa157c4009d40963e9be3446cb873a48e6e871429c7b86c657cd96f84037b471","signature":"b68e7c9c7b239e2964e081c3498c64d663e41e49c1ba590cfadf99dd45e1b174"},{"version":"caf4af98bf464ad3e10c46cf7d340556f89197aab0f87f032c7b84eb8ddb24d9","impliedFormat":99},{"version":"9c580c6eae94f8c9a38373566e59d5c3282dc194aa266b23a50686fe10560159","impliedFormat":99},{"version":"e9dddbd8dbbc0eccd683306481b0f0bbc8e2b60ea97817416ebb9fe7fbbbdca8","signature":"dd8394b1eea2ba970a716e87af002b610d513280d6d8e521b5f3b2fd73e6c89f"},{"version":"867981472a880db8ce88e1ab569c3626ced3ae4200c8dc21b308213925968d2f","signature":"5c72ee5c6024348cc1025d8fa93e94848ad71d6bd04896bbe6db4a0892ea57db"},{"version":"0943a6e4e026d0de8a4969ee975a7283e0627bf41aa4635d8502f6f24365ac9b","impliedFormat":99},{"version":"1461efc4aefd3e999244f238f59c9b9753a7e3dfede923ebe2b4a11d6e13a0d0","impliedFormat":99},{"version":"7251e973cc6896411e3348c1e9cd10bb359934b0e766055c9a3439b07b775edc","signature":"37f59505107bb3a51f97f38742df1546cac9278e0d2d5387515fe76c9f344034"},{"version":"4a5aa16151dbec524bb043a5cbce2c3fec75957d175475c115a953aca53999a9","impliedFormat":99},{"version":"17f2390d98e8ce4d9e90155eac1918266914d6a9ada7c276b5d1c917cef0e969","signature":"a52cc3f0303c61d350c1b1e81bbb773251b1b37e1f0ff8d9c58338ed8f5d8b6e"},{"version":"3d6a560c635fd91094e43191ecf73b124ccb2537e6060f85d5d31fcf68150e74","signature":"6aea4b913e1f06f2e2aac93fc923f76d7acd4ce0f1ee3adbffab41ebc81f2a2f"},{"version":"0164300b0a6072921c2ad753b24e7b849151a5e19485ca0143b51a8b89123a01","signature":"92a13efb85baf2fb050de4e967a7f548980a5bc58727a0a92c9a32964ba15709"},{"version":"5e65f29f4367d4e69dd6b4fa3b45046ae39cfc8f4493f3ac963da1de1777a143","signature":"15f61b3decc6dfa3796b4d87ca5841d4c6e39082d4427f71ab2e77faba59e731"},{"version":"374ad135c3d4ff3ec080a0009cd9745cdd0e12faa89d2b0e86074f11e5127fd1","signature":"5a8f49de902f7915b6ed0b3389a52d77f02b61cc14772478eaac0ec245b41b0c"},{"version":"c2c74dc3e99482d00a57de673b56920860c2ff4b330373d783843f505dc11dae","signature":"e23d1f28fb64a169347d4a0564f89d70950ab3d2a376ec26b08a5b149f7d1524"},{"version":"189c8b0040500d73ce43c393fd7d935c5da79f040396f98e06a0fce7912282fa","signature":"38633901357fc46159bd046c3355085b61618661f56c10781026649d5074ba13"},{"version":"acd1fb41cd5dbb0526cd393bfd7c5ba459f6c32e39d8eae4c441368f722a0a3f","signature":"b5ae196f51ada13fd4c88ee78ece90acb00070a28206fa2c77544ac849452c83"},{"version":"02fe652d9a26b3c97baa721717c3df6043ec8a87c7637cdc71005553c03d855c","signature":"88cea0966a6dfc31aff7c7abd8f3c6ff7aa73b485645c46dfd01e7e9aeb90c7a"},{"version":"f2aea81d8baf2b621945382aabac150e3db40f20d19ac1abea7aff805f1dc33c","signature":"b3ee5184dbf154ca01ff12e4703e5dc467ad7c79d8b16c98b8361118de54cea4"},{"version":"34111337bb50a21be1bb700b8cd1452295bada7490b6a320502918bd7fd2bf23","signature":"2c3b4aa66afee1c9b18f030ddb945571267b5f4dfaec41f4618ae824356c40d3"},"56ecf475685efdb8760337cb43a497511e2fe3968efa9d345eba51651a76f091",{"version":"c94e9bff3f346841239c585a12cda55ed620c25af524ca3078f70ee55bed9532","signature":"b871a1a036ee2cc4fd6bf5f24f8ad66b3d13dc57bd52877b443f72d937d67dab"},{"version":"233267a4a036c64aee95f66a0d31e3e0ef048cccc57dd66f9cf87582b38691e4","impliedFormat":99},{"version":"cbc12f4086448f8a307ed5fbb160f79467c84a44c48ca0dbd2c62e39a2db6f5d","signature":"1e37fc0a173ec758e50b02a497c85f176f9da989272fcb78594e7307278603ae"},{"version":"87c3b072dcd93c6181054e426b4d07fd6a35ce91f40a058686d7967407dc3736","signature":"f3d44398ddbc1a0785c8d76db3babe0a7782d9be9825f4003a33952b9ecbcd00"},{"version":"4bde6946822fb63067170e0e2e30897f13f3df487a05662a538580bbbb27a4a6","signature":"385eb2fb3ec3ffe75c7e5a11c3ff613e91737843a0843a2233837787d22f872f"},{"version":"ebd84583070393a4f538f1fd8027314f3161fea2ce247f2f51134c489d73d633","signature":"ca4972057a0472c3ec025159fb44e733cd31b34d4599b652169b8c090720c755"},{"version":"524f13bec567dc275f364e02c68c6a38149759a88840fc4f8b7e74a7702573c1","signature":"29cb23cfe49c991202eb4feb2651b29bd4f2d0e9b5c4e0d01fe3011fd11d5d37"},{"version":"e807c536963378ea0c5a4e159ee9aa53afd8ef44f6d76280cc0d913d07ad1184","signature":"c90309187508dbe5cb75e98cd97b79c2ef2e5e863a27014d287e6248ad9ae859"},{"version":"4ff067ed2a2f7792af2a7bf6bd86d4664fc1d2487dfbaec51b0f36c8aaa9cc8b","signature":"d7851e2b185af5667974be742fbff17a5f880bfd995eaff34c0992f126a7bf50"},"917abde05488c4b41de7c0d5c260ef5947782453cc3502d2e9cca8f951ebebf9",{"version":"864f90ded6697078a18e38167b68559e9921ae0e854bf4853237d9171fb91f1d","signature":"ef98f676452d375ba8075857fe4c337dff6ebfcf2e3c22c0d3d3b45482d1ba33"},{"version":"37c7961117708394f64361ade31a41f96cef7f2a6606300821c72438dd4abda3","impliedFormat":1},{"version":"4553fb948ff5cdff28084bf667543ec841934cac5a20b5495a8de6fb90c611f3","affectsGlobalScope":true,"impliedFormat":1},{"version":"64d4c41b11c1c817ddd39c4febdba05b560e4bdc4aef196ca48799b732ec8241","impliedFormat":1},{"version":"b9d31776c215f35fd76d4426cc7046f8c1ade1f2f5a1b59158363f5004790b03","impliedFormat":1},{"version":"2d83d95f0727073ce8c7a3f1204518a4162439e3727f2e8c02db5d15fdba0cb4","signature":"991781dd2cdc1e508cd384a320cfc05aa9e0a10e79522cfef1718212c0723476"},{"version":"f1ce4ef4639c147bf3b4cde80d481363b3e698446b58e3d341370894464dfcd7","signature":"e68ea7b99aab06b5382beec05b2a661dcc16ad0ade6d6d0cdda6384b4ad2194c"},{"version":"4705db79c9d735974a21265da4e8d6958a04cecf665a6fbd31a127adea9f0166","signature":"debfc50d36f5af21f71d603043f853ecaec019b2b396eedc3313b7244f21087c"},{"version":"919f87f57ee5a31157d1d552f241b9b0c8c2ab1390fccbb521a94123bd87c33d","signature":"a845befcadbed3859ffb4caadce52378da4ad5c942caa1f09169eb3b1ab607f3"},{"version":"ec44b73581497c601148f06a220d4f61e9a6dd02bf894bdbc53a1e309cfc7713","signature":"5e34cd1f74638f8ab506da63e07672eabf64e588d41134f6d4b84a5be20b1f75"},{"version":"b734ccfd6531a41f00fab38e42239df8d7195ae99e6a4bb7e705b6e228417c38","signature":"e70f4955cd3c83700b39a2ce450a690b754a6828b5beb082a50cd86c14da32e3"},{"version":"1bbaaed4b534b33878900d8e4ea87e4cea5922cd97942b87f6bce192718464b2","signature":"589256968a73c12720866c752bcc2135377f51656209b4e1ba779c7e5c900e0f"},{"version":"b26d3b0c0202486445eb5509c4830a04da894213461c7b78e40482ae9e1ebb86","signature":"aa5d6e66a6a6ef273267cca3e20583391ac353e79b9e3428a411295fa6089225"},{"version":"8832937a4f608e96d8c7b53fd5c040fd1e2be78dea6ca926b9c16e235f114749","impliedFormat":99},{"version":"60fa62255c9a3fc917f4be2d8c23ded1f3e919f68db44af67f8c67b46014663a","impliedFormat":99},{"version":"10ce8a11a9beb91431a0246977d0c9342c9f530b6ddaf756a0ad6fef22818b9d","impliedFormat":99},{"version":"269ed3176766758542995bfab9612b921bb47c3b1efd382b3ec843d0e2dc147d","impliedFormat":99},{"version":"f3ec93a448c4bf491bd372962f4c9a402ba97a917ce905ac0251f16c2e03fb43","impliedFormat":99},{"version":"807dd7f06dcd9dd0af7574606188fcc2054498636022005390030d84957b92b8","impliedFormat":99},{"version":"62bed6305549eaa0ec8e7b75a13e6177987f9b24122babdc267cfe01a2a6cfa9","impliedFormat":99},{"version":"3c7869711e28e33bb715dedb6879707cb54bb91b0ea9e54c9e308ed23be6b8b4","impliedFormat":99},{"version":"abbd33f1c632b4e592fde62769716a5134831f960832d7007a6491e73e4ae109","impliedFormat":99},{"version":"f88a59d7650984e794b40b34303dcedc1c3802acf21429f110c832fedb529dc0","impliedFormat":99},{"version":"2e7ef180b0a117ec2edfc2e349b4ccea4ad63114ea41b0262aa3a6e01cb223f0","impliedFormat":99},{"version":"82fe93d8ca122c107336ef52f40c55790b50c9822b226ad4b5608cdcfc8d7a08","impliedFormat":99},{"version":"de94ac03f309847b4febab46e6a7de3ed68cf6d3a3faf50823def5d1309cbf47","impliedFormat":99},{"version":"072c70c2fca2a333c11ad438f6aa2c1e7f7a7ca63c3107ae81a4469124c96a4d","signature":"496cd22bb4f82c69d05d88ac924b20c9777a3232348707278cf5375b7a1ab576"},{"version":"d54a2016b94c80e909bbbe9d7fc74c614eaaad20facae2c0a396ae867a2ec988","signature":"335947e9c887abd6d097e6900df4002159536505442fc84d2cad708f5ac7addc"},"5025c82a791aa83af2e85c6d6c474066a3874edf8ba7ce75bf7f277dc8e2e3ff","75cf9c9208dd53fcbb1a478cc0823433b53f49bea630b961a53b5a868599a206",{"version":"4acbc7165a8d54738ff62b51414e772c08fe78434e524e6d8770180d3ba2925f","signature":"512960c0e955a2324b34354dac25e3e4d431a1af4cd33077935eda5e95c8b7e1"},"70e07297cd5e0af1824369ee63b4de69bfb44fc9396de38e5adad7a148931832",{"version":"9e9800fd3d78773013da1c9f3aef3b3e7ab8caebb97121c960fcebd4642d70b8","signature":"65b6125d8ced57331b8086cc243a4126725ffc835c0bf1f42ec20b774d7c7e64"},{"version":"d7da25aab8e8481bea9d3d6fd80812a0c88df6e815bb0e16158cb4ad5fe28a82","signature":"a9407719e655207cc2663aba86e46eec06856649aa77809558ddb2f300dd373e"},{"version":"54cfdb1174c3b81046470a867a760bee44bf2b75527504a3d8b10f24ce856a23","signature":"ff6dfda5378fc7b1ffb6f75724fa0b04c32109d9459a9df45de1ae5186b44a1c"},{"version":"ed13622be2960d91a1d3d00fed267a422114eb1fcd2d77c06944fab5bf1db9f2","signature":"cfc2eca82bb1c8cab0b0ce6d34d23211f2aaa83f2a8e6f427cf22a99196322fe"},{"version":"2095b203bfd0a0acc7626f13c09e2f120769636bb7766a3c6191739107089e81","signature":"7b87720aae5dbfb749d597c437531239e4019502dc0e78633561735db617b6f3"},{"version":"a98886b45a4337a7f45862e2cb50b2ffd4a7572f9798f8dc6ffad1f28c364312","signature":"9eb291d4b463342f557d4858971e12ce86803d7c261db37c5b37fe250b95e133"},{"version":"d6056b480feb3370ff004ca083aed2b9dd36b391fc3cef6da7038574bcdb5577","impliedFormat":99},{"version":"d00b7ef279b5e11236738e99e985ced45d75dbf417eab19110519d7fcf029be9","impliedFormat":99},{"version":"91b4ce96f6ad631a0a6920eb0ab928159ff01a439ae0e266ecdc9ea83126a195","impliedFormat":1},{"version":"88efe27bebddb62da9655a9f093e0c27719647e96747f16650489dc9671075d6","impliedFormat":1},{"version":"e348f128032c4807ad9359a1fff29fcbc5f551c81be807bfa86db5a45649b7ba","impliedFormat":1},{"version":"8ee6b07974528da39b7835556e12dd3198c0a13e4a9de321217cd2044f3de22e","impliedFormat":1},{"version":"deefd8c43b40f9797c3921d78d3f9243959621a17b817be7f5d95c149f23a9dd","impliedFormat":1},{"version":"5f12132800d430adbe59b49c2c0354d85a71ada7d756e34250a655baa8ad4ae5","impliedFormat":1},{"version":"1996d1cd7d585a8359a35878f67abdd73cc35b1f675c9c6b147b202fdd8dfc3f","impliedFormat":1},{"version":"b16e757e4c35434065120a2b3bf13a518fc9e621dc9c2ed668f91635a9dc4e75","impliedFormat":1},{"version":"7c18088ccbca1cfe297c22f4cf598a3a36e798efe63f572e39442e9b6af7ccf9","impliedFormat":1},{"version":"d02ced7accb512e6198b796b8d284e7979abde0f089b0a77969747a5f27bfb23","impliedFormat":1},{"version":"4374cefdde5c6e9bad52b0436e887b8325b8f407c12035194ad02c28f1553a3a","impliedFormat":1},{"version":"9b70cad270593f676aecfe4d1611dc766464f0b8138527b0ebbf1ff773578d69","impliedFormat":1},{"version":"b4f85bfb7e831703ac81737361842f1ae4d924b42c5d1af2bff93cca521de4d1","impliedFormat":1},{"version":"ee933420aacba1f60aa70fb8ba47c5e69001b005073b71973114587089a13c7f","impliedFormat":1},{"version":"0a0714999d0a5bdfacd15c7b34cffbcc6f263f6cb0ccb42076cdc541c6987797","impliedFormat":1},{"version":"56584bfc655f9df64afc0f22f7d1122c29e5b74b342c203b891e19de9fa37de8","impliedFormat":1},{"version":"40ec58f0fadd0b3981b3d383e1c12fa0680115ae9f018387fc2cfc0bbcf23204","impliedFormat":1},{"version":"849b9e7283b7309a4556c9b90bb8e2dfc27751f157798065bbc513dcddb09a8c","impliedFormat":1},{"version":"76bba0c97594248c1be19af32d5799f7eff51cec2926d8e4dd59267d7636a0b4","impliedFormat":1},{"version":"10e109212c7be8a9f66e988e5d6c2a8900c9d14bf6beadf5fa70d32ada3425cf","impliedFormat":1},{"version":"2b821aeb31e690092f8eae671dd961a9d0fd598ff4883ce0a600c90e9e8fa716","impliedFormat":1},{"version":"26602933b613e4df3868a6c82e14fffa2393a08531cb333ed27b151923462981","impliedFormat":1},{"version":"f57a588d8f6b3ce5c8b494f2dc759a8885eaee18e80a4952df47de45403fedbe","impliedFormat":1},{"version":"34735727b3fe7a0ed0651a0f88d06449163d1989a2b2de7f047473adc7c1c383","impliedFormat":1},{"version":"a5b13abc88ab3186e713c445e59e2f6eee20c6167943517bc2f56985d89b8c55","impliedFormat":1},{"version":"c8a206a6ba4e32710ebb4a389187772423de0f4f6180b95a7ef1a5a1934c1be6","impliedFormat":1},{"version":"7ae65fe95b18205e241e6695cb2c61c0828d660aca7d08f68781b439a800e6b8","impliedFormat":1},{"version":"c2c8c166199d3a7bd093152437d1f6399d05e458a9ca9364456feecba920cda4","impliedFormat":1},{"version":"369b7270eeeb37982203b2cb18c7302947b89bf5818c1d3d2e95a0418f02b74e","impliedFormat":1},{"version":"94f95d223e2783b0aef4d15d7f6990a6a550fe17d099c501395f690337f7105e","impliedFormat":1},{"version":"039bd8d1e0d151570b66e75ee152877fb0e2f42eca43718632ac195e6884be34","impliedFormat":1},{"version":"d565d66b38d54de037c9d46dede1f12630010d9b45fd9c6b432c7a40b2e30502","impliedFormat":1},{"version":"d7386a1ebe9a3eae227a5561c898c10cacb61a49f941c5a18cdf593f979c693c","impliedFormat":1},{"version":"d3cfde44f8089768ebb08098c96d01ca260b88bccf238d55eee93f1c620ff5a5","impliedFormat":1},{"version":"293eadad9dead44c6fd1db6de552663c33f215c55a1bfa2802a1bceed88ff0ec","impliedFormat":1},{"version":"36eb5babc665b890786550d4a8cb20ef7105673a6d5551fbdd7012877bb26942","impliedFormat":1},{"version":"fec412ded391a7239ef58f455278154b62939370309c1fed322293d98c8796a6","impliedFormat":1},{"version":"e3498cf5e428e6c6b9e97bd88736f26d6cf147dedbfa5a8ad3ed8e05e059af8a","impliedFormat":1},{"version":"dba3f34531fd9b1b6e072928b6f885aa4d28dd6789cbd0e93563d43f4b62da53","impliedFormat":1},{"version":"f672c876c1a04a223cf2023b3d91e8a52bb1544c576b81bf64a8fec82be9969c","impliedFormat":1},{"version":"e4b03ddcf8563b1c0aee782a185286ed85a255ce8a30df8453aade2188bbc904","impliedFormat":1},{"version":"2329d90062487e1eaca87b5e06abcbbeeecf80a82f65f949fd332cfcf824b87b","impliedFormat":1},{"version":"25b3f581e12ede11e5739f57a86e8668fbc0124f6649506def306cad2c59d262","impliedFormat":1},{"version":"93c3e73824ad57f98fd23b39335dbdae2db0bd98199b0dc0b9ccc60bf3c5134a","impliedFormat":1},{"version":"a9ebb67d6bbead6044b43714b50dcb77b8f7541ffe803046fdec1714c1eba206","impliedFormat":1},{"version":"833e92c058d033cde3f29a6c7603f517001d1ddd8020bc94d2067a3bc69b2a8e","impliedFormat":1},{"version":"8e6427dd1a4321b0857499739c641b98657ea6dc7cc9a02c9b2c25a845c3c8e6","impliedFormat":1},{"version":"58da08d1fe876c79c47dcf88be37c5c3fab55d97b34c8c09a666599a2191208d","impliedFormat":1},{"version":"ccab2a1e371ecf7462b950a6fb646b56d28cba01092966ff954e2fe84065b09c","signature":"3922ff69f55c419ae0566ff6f26871357d2ba9b20da1987f69769d3a7a8a704c"},{"version":"9d3ed12d47e8d74c398d1ecf52de07e69faea8e472bfb5a942f7438404c162e5","signature":"1a25aa9f077ddd9e7c3d1c22af77c2cbaf82625aa8046a2c0ff0dae7e210e37d"},{"version":"46294d8c5dcd538f005abae8cf8a66e4e0312e02ed6743c179369a453badb31c","signature":"185eb50ff87090bd8757dd1abcfbcacfb009fc9cc94e92fe51d4da416c17ece1"},{"version":"f0b66429961bbd0aa5aaf4c281ec3c1c0029144b0cc414d4c5b3e0aa7f0b0678","signature":"7bd370591796faca667589bf2081b8738c77cf5eacb791c36299ddd615a31681"},{"version":"68b6a7501a56babd7bcd840e0d638ee7ec582f1e70b3c36ebf32e5e5836913c8","impliedFormat":99},{"version":"89783bd45ab35df55203b522f8271500189c3526976af533a599a86caaf31362","impliedFormat":99},{"version":"26e6c521a290630ea31f0205a46a87cab35faac96e2b30606f37bae7bcda4f9d","impliedFormat":99},{"version":"e1564b0912361081da39e1ee61d5759a75aa4e2e8d28a90f5e229921addb4083","signature":"075f3a4de810b091b4a6ebd47db566aaf010151d9cda7622f6711387f0a38ff7"},{"version":"a9373d52584b48809ffd61d74f5b3dfd127da846e3c4ee3c415560386df3994b","impliedFormat":99},{"version":"caf4af98bf464ad3e10c46cf7d340556f89197aab0f87f032c7b84eb8ddb24d9","impliedFormat":99},{"version":"8085954ba165e611c6230596078063627f3656fed3fb68ad1e36a414c4d7599a","impliedFormat":99},{"version":"e8672934f1c315f36cdae39380454ba8c2da62aca420dfb827d96693091419c4","signature":"5487019d46f80ed8da92d934729caab77c902a55fdf970831ca7ac1f980735c4"},{"version":"68a7a847b1d2270f56665a25672c90020f04f9407ff3c0b43e7c24fb7538f008","signature":"4a04b984ab167b2e4a34188cee6291f135a71d76435f786fd531937f3b1e5079"},{"version":"d2c9b6d94c32a2e97c43023a195aa2b13765647883617bff27da9e8ed0231dfb","signature":"1b5568cba0e5453bb7891e59ad0508977bbbbda6fcdc6ab8880419f2f2c92ba6"},"21a69f6c71858d358d377e7195a471cf80725d52f26bf6d057d099985a4a77db","537a6cf5317241cf142f16c9d14c5e1172fb8a0b98885688b0dee7ccc879e610",{"version":"6aa2859da46f726a22040725e684ea964d7469a6b26f1c0a6634bb65e79062b0","impliedFormat":99},{"version":"2cef84bf00cbdb452fdc5d8ecfe7b8c0aa3fa788bdc4ad8961e2e636530dbb60","impliedFormat":99},{"version":"24104650185414f379d5cc35c0e2c19f06684a73de5b472bae79e0d855771ecf","impliedFormat":99},{"version":"799003c0ab928582fca04977f47b8d85b43a8de610f4eef0ad2d069fbb9f9399","impliedFormat":99},{"version":"b13dd41c344a23e085f81b2f5cd96792e6b35ae814f32b25e39d9841844ad240","impliedFormat":99},{"version":"17d8b4e6416e48b6e23b73d05fd2fde407e2af8fddbe9da2a98ede14949c3489","impliedFormat":99},{"version":"6d17b2b41f874ab4369b8e04bdbe660163ea5c8239785c850f767370604959e3","impliedFormat":99},{"version":"04b4c044c8fe6af77b6c196a16c41e0f7d76b285d036d79dcaa6d92e24b4982b","impliedFormat":99},{"version":"30bdeead5293c1ddfaea4097d3e9dd5a6b0bc59a1e07ff4714ea1bbe7c5b2318","impliedFormat":99},{"version":"e7df226dcc1b0ce76b32f160556f3d1550124c894aae2d5f73cefaaf28df7779","impliedFormat":99},{"version":"f2b7eef5c46c61e6e72fba9afd7cc612a08c0c48ed44c3c5518559d8508146a2","impliedFormat":99},{"version":"00f0ba57e829398d10168b7db1e16217f87933e61bd8612b53a894bd7d6371da","impliedFormat":99},{"version":"126b20947d9fa74a88bb4e9281462bda05e529f90e22d08ee9f116a224291e84","impliedFormat":99},{"version":"40d9e43acee39702745eb5c641993978ac40f227475eacc99a83ba893ad995db","impliedFormat":99},{"version":"8a66b69b21c8de9cb88b4b6d12f655d5b7636e692a014c5aa1bd81745c8c51d5","impliedFormat":99},{"version":"ebbb846bdd5a78fdacff59ae04cea7a097912aeb1a2b34f8d88f4ebb84643069","impliedFormat":99},{"version":"7321adb29ffd637acb33ee67ea035f1a97d0aa0b14173291cc2fd58e93296e04","impliedFormat":99},{"version":"320816f1a4211188f07a782bdb6c1a44555b3e716ce13018f528ad7387108d5f","impliedFormat":99},{"version":"b2cc8a474b7657f4a03c67baf6bff75e26635fd4b5850675e8cad524a09ddd0c","impliedFormat":99},{"version":"0d081e9dc251063cc69611041c17d25847e8bdbe18164baaa89b7f1f1633c0ab","impliedFormat":99},{"version":"a64c25d8f4ec16339db49867ea2324e77060782993432a875d6e5e8608b0de1e","impliedFormat":99},{"version":"0739310b6b777f3e2baaf908c0fbc622c71160e6310eb93e0d820d86a52e2e23","impliedFormat":99},{"version":"37b32e4eadd8cd3c263e7ac1681c58b2ac54f3f77bb34c5e4326cc78516d55a9","impliedFormat":99},{"version":"9b7a8974e028c4ed6f7f9abb969e3eb224c069fd7f226e26fcc3a5b0e2a1eba8","impliedFormat":99},{"version":"e8100b569926a5592146ed68a0418109d625a045a94ed878a8c5152b1379237c","impliedFormat":99},{"version":"594201c616c318b7f3149a912abd8d6bdf338d765b7bcbde86bca2e66b144606","impliedFormat":99},{"version":"03e380975e047c5c6ded532cf8589e6cc85abb7be3629e1e4b0c9e703f2fd36f","impliedFormat":99},{"version":"fae14b53b7f52a8eb3274c67c11f261a58530969885599efe3df0277b48909e1","impliedFormat":99},{"version":"c41206757c428186f2e0d1fd373915c823504c249336bdc9a9c9bbdf9da95fef","impliedFormat":99},{"version":"e961f853b7b0111c42b763a6aa46fc70d06a697db3d8ed69b38f7ba0ae42a62b","impliedFormat":99},{"version":"3db90f79e36bcb60b3f8de1bc60321026800979c150e5615047d598c787a64b7","impliedFormat":99},{"version":"639b6fb3afbb8f6067c1564af2bd284c3e883f0f1556d59bd5eb87cdbbdd8486","impliedFormat":99},{"version":"49795f5478cb607fd5965aa337135a8e7fd1c58bc40c0b6db726adf186dd403f","impliedFormat":99},{"version":"7d8890e6e2e4e215959e71d5b5bd49482cf7a23be68d48ea446601a4c99bd511","impliedFormat":99},{"version":"d56f72c4bb518de5702b8b6ae3d3c3045c99e0fd48b3d3b54c653693a8378017","impliedFormat":99},{"version":"4c9ac40163e4265b5750510d6d2933fb7b39023eed69f7b7c68b540ad960826e","impliedFormat":99},{"version":"8dfab17cf48e7be6e023c438a9cdf6d15a9b4d2fa976c26e223ba40c53eb8da8","impliedFormat":99},{"version":"38bdf7ccacfd8e418de3a7b1e3cecc29b5625f90abc2fa4ac7843a290f3bf555","impliedFormat":99},{"version":"9819e46a914735211fbc04b8dc6ba65152c62e3a329ca0601a46ba6e05b2c897","impliedFormat":99},{"version":"50f0dc9a42931fb5d65cdd64ba0f7b378aedd36e0cfca988aa4109aad5e714cb","impliedFormat":99},{"version":"894f23066f9fafccc6e2dd006ed5bd85f3b913de90f17cf1fe15a2eb677fd603","impliedFormat":99},{"version":"abdf39173867e6c2d6045f120a316de451bbb6351a6929546b8470ddf2e4b3b9","impliedFormat":99},{"version":"aa2cb4053f948fbd606228195bbe44d78733861b6f7204558bbee603202ee440","impliedFormat":99},{"version":"6911b41bfe9942ac59c2da1bbcbe5c3c1f4e510bf65cae89ed00f434cc588860","impliedFormat":99},{"version":"7b81bc4d4e2c764e85d869a8dd9fe3652b34b45c065482ac94ffaacc642b2507","impliedFormat":99},{"version":"895df4edb46ccdcbce2ec982f5eed292cf7ea3f7168f1efea738ee346feab273","impliedFormat":99},{"version":"8692bb1a4799eda7b2e3288a6646519d4cebb9a0bddf800085fc1bd8076997a0","impliedFormat":99},{"version":"239c9e98547fe99711b01a0293f8a1a776fc10330094aa261f3970aaba957c82","impliedFormat":99},{"version":"34833ec50360a32efdc12780ae624e9a710dd1fd7013b58c540abf856b54285a","impliedFormat":99},{"version":"647538e4007dcc351a8882067310a0835b5bb8559d1cfa5f378e929bceb2e64d","impliedFormat":99},{"version":"992d6b1abcc9b6092e5a574d51d441238566b6461ade5de53cb9718e4f27da46","impliedFormat":99},{"version":"938702305649bf1050bd79f3803cf5cc2904596fc1edd4e3b91033184eae5c54","impliedFormat":99},{"version":"1e931d3c367d4b96fe043e792196d9c2cf74f672ff9c0b894be54e000280a79d","impliedFormat":99},{"version":"05bec322ea9f6eb9efcd6458bb47087e55bd688afdd232b78379eb5d526816ed","impliedFormat":99},{"version":"4c449a874c2d2e5e5bc508e6aa98f3140218e78c585597a21a508a647acd780a","impliedFormat":99},{"version":"dae15e326140a633d7693e92b1af63274f7295ea94fb7c322d5cbe3f5e48be88","impliedFormat":99},{"version":"c2b0a869713bca307e58d81d1d1f4b99ebfc7ec8b8f17e80dde40739aa8a2bc6","impliedFormat":99},{"version":"6e4b4ff6c7c54fa9c6022e88f2f3e675eac3c6923143eb8b9139150f09074049","impliedFormat":99},{"version":"69559172a9a97bbe34a32bff8c24ef1d8c8063feb5f16a6d3407833b7ee504cf","impliedFormat":99},{"version":"86b94a2a3edcb78d9bfcdb3b382547d47cb017e71abe770c9ee8721e9c84857f","impliedFormat":99},{"version":"e3fafafda82853c45c0afc075fea1eaf0df373a06daf6e6c7f382f9f61b2deb3","impliedFormat":99},{"version":"a4ba4b31de9e9140bc49c0addddbfaf96b943a7956a46d45f894822e12bf5560","impliedFormat":99},{"version":"d8a7926fc75f2ed887f17bae732ee31a4064b8a95a406c87e430c58578ee1f67","impliedFormat":99},{"version":"9886ffbb134b0a0059fd82219eba2a75f8af341d98bc6331b6ef8a921e10ec68","impliedFormat":99},{"version":"c2ead057b70d0ae7b87a771461a6222ebdb187ba6f300c974768b0ae5966d10e","impliedFormat":99},{"version":"46687d985aed8485ab2c71085f82fafb11e69e82e8552cf5d3849c00e64a00a5","impliedFormat":99},{"version":"999ca66d4b5e2790b656e0a7ce42267737577fc7a52b891e97644ec418eff7ec","impliedFormat":99},{"version":"ec948ee7e92d0888f92d4a490fdd0afb27fbf6d7aabebe2347a3e8ac82c36db9","impliedFormat":99},{"version":"03ef2386c683707ce741a1c30cb126e8c51a908aa0acc01c3471fafb9baaacd5","impliedFormat":99},{"version":"66a372e03c41d2d5e920df5282dadcec2acae4c629cb51cab850825d2a144cea","impliedFormat":99},{"version":"ddf9b157bd4c06c2e4646c9f034f36267a0fbd028bd4738214709de7ea7c548b","impliedFormat":99},{"version":"3e795aac9be23d4ad9781c00b153e7603be580602e40e5228e2dafe8a8e3aba1","impliedFormat":99},{"version":"98c461ec5953dfb1b5d5bca5fee0833c8a932383b9e651ca6548e55f1e2c71c3","impliedFormat":99},{"version":"5c42107b46cb1d36b6f1dee268df125e930b81f9b47b5fa0b7a5f2a42d556c10","impliedFormat":99},{"version":"7e32f1251d1e986e9dd98b6ff25f62c06445301b94aeebdf1f4296dbd2b8652f","impliedFormat":99},{"version":"2f7e328dda700dcb2b72db0f58c652ae926913de27391bd11505fc5e9aae6c33","impliedFormat":99},{"version":"3de7190e4d37da0c316db53a8a60096dbcd06d1a50677ccf11d182fa26882080","impliedFormat":99},{"version":"a9d6f87e59b32b02c861aade3f4477d7277c30d43939462b93f48644fa548c58","impliedFormat":99},{"version":"2bce8fd2d16a9432110bbe0ba1e663fd02f7d8b8968cd10178ea7bc306c4a5df","impliedFormat":99},{"version":"798bedbf45a8f1e55594e6879cd46023e8767757ecce1d3feaa78d16ad728703","impliedFormat":99},{"version":"62723d5ac66f7ed6885a3931dd5cfa017797e73000d590492988a944832e8bc2","impliedFormat":99},{"version":"03db8e7df7514bf17fc729c87fff56ca99567b9aa50821f544587a666537c233","impliedFormat":99},{"version":"9b1f311ba4409968b68bf20b5d892dbd3c5b1d65c673d5841c7dbde351bc0d0b","impliedFormat":99},{"version":"2d1e8b5431502739fe335ceec0aaded030b0f918e758a5d76f61effa0965b189","impliedFormat":99},{"version":"e725839b8f884dab141b42e9d7ff5659212f6e1d7b4054caa23bc719a4629071","impliedFormat":99},{"version":"4fa38a0b8ae02507f966675d0a7d230ed67c92ab8b5736d99a16c5fbe2b42036","impliedFormat":99},{"version":"50ec1e8c23bad160ddedf8debeebc722becbddda127b8fdce06c23eacd3fe689","impliedFormat":99},{"version":"9a0aea3a113064fd607f41375ade308c035911d3c8af5ae9db89593b5ca9f1f9","impliedFormat":99},{"version":"8d643903b58a0bf739ce4e6a8b0e5fb3fbdfaacbae50581b90803934b27d5b89","impliedFormat":99},{"version":"19de2915ccebc0a1482c2337b34cb178d446def2493bf775c4018a4ea355adb8","impliedFormat":99},{"version":"9be8fc03c8b5392cd17d40fd61063d73f08d0ee3457ecf075dcb3768ae1427bd","impliedFormat":99},{"version":"a2d89a8dc5a993514ca79585039eea083a56822b1d9b9d9d85b14232e4782cbe","impliedFormat":99},{"version":"f526f20cae73f17e8f38905de4c3765287575c9c4d9ecacee41cfda8c887da5b","impliedFormat":99},{"version":"d9ec0978b7023612b9b83a71fee8972e290d02f8ff894e95cdd732cd0213b070","impliedFormat":99},{"version":"7ab10c473a058ec8ac4790b05cae6f3a86c56be9b0c0a897771d428a2a48a9f9","impliedFormat":99},{"version":"451d7a93f8249d2e1453b495b13805e58f47784ef2131061821b0e456a9fd0e1","impliedFormat":99},{"version":"21c56fe515d227ed4943f275a8b242d884046001722a4ba81f342a08dbe74ae2","impliedFormat":99},{"version":"d8311f0c39381aa1825081c921efde36e618c5cf46258c351633342a11601208","impliedFormat":99},{"version":"6b50c3bcc92dc417047740810596fcb2df2502aa3f280c9e7827e87896da168a","impliedFormat":99},{"version":"18a6b318d1e7b31e5749a52be0cf9bbce1b275f63190ef32e2c79db0579328ca","impliedFormat":99},{"version":"6a2d0af2c27b993aa85414f3759898502aa198301bc58b0d410948fe908b07b0","impliedFormat":99},{"version":"2da11b6f5c374300e5e66a6b01c3c78ec21b5d3fec0748a28cc28e00be73e006","impliedFormat":99},{"version":"0729691b39c24d222f0b854776b00530877217bfc30aac1dc7fa2f4b1795c536","impliedFormat":99},{"version":"ca45bb5c98c474d669f0e47615e4a5ae65d90a2e78531fda7862ee43e687a059","impliedFormat":99},{"version":"c1c058b91d5b9a24c95a51aea814b0ad4185f411c38ac1d5eef0bf3cebec17dc","impliedFormat":99},{"version":"3ab0ed4060b8e5b5e594138aab3e7f0262d68ad671d6678bcda51568d4fc4ccc","impliedFormat":99},{"version":"e2bf1faba4ff10a6020c41df276411f641d3fdce5c6bae1db0ec84a0bf042106","impliedFormat":99},{"version":"80b0a8fe14d47a71e23d7c3d4dcee9584d4282ef1d843b70cab1a42a4ea1588c","impliedFormat":99},{"version":"a0f02a73f6e3de48168d14abe33bf5970fdacdb52d7c574e908e75ad571e78f7","impliedFormat":99},{"version":"c728002a759d8ec6bccb10eed56184e86aeff0a762c1555b62b5d0fa9d1f7d64","impliedFormat":99},{"version":"586f94e07a295f3d02f847f9e0e47dbf14c16e04ccc172b011b3f4774a28aaea","impliedFormat":99},{"version":"cfe1a0f4ed2df36a2c65ea6bc235dbb8cf6e6c25feb6629989f1fa51210b32e7","impliedFormat":99},{"version":"8ba69c9bf6de79c177329451ffde48ddab7ec495410b86972ded226552f664df","impliedFormat":99},{"version":"15111cbe020f8802ad1d150524f974a5251f53d2fe10eb55675f9df1e82dbb62","impliedFormat":99},{"version":"782dc153c56a99c9ed07b2f6f497d8ad2747764966876dbfef32f3e27ce11421","impliedFormat":99},{"version":"cc2db30c3d8bb7feb53a9c9ff9b0b859dd5e04c83d678680930b5594b2bf99cb","impliedFormat":99},{"version":"46909b8c85a6fd52e0807d18045da0991e3bdc7373435794a6ba425bc23cc6be","impliedFormat":99},{"version":"e4e511ff63bb6bd69a2a51e472c6044298bca2c27835a34a20827bc3ef9b7d13","impliedFormat":99},{"version":"2c86f279d7db3c024de0f21cd9c8c2c972972f842357016bfbbd86955723b223","impliedFormat":99},{"version":"112c895cff9554cf754f928477c7d58a21191c8089bffbf6905c87fe2dc6054f","impliedFormat":99},{"version":"8cfc293b33082003cacbf7856b8b5e2d6dd3bde46abbd575b0c935dc83af4844","impliedFormat":99},{"version":"d2c5c53f85ce0474b3a876d76c4fc44ff7bb766b14ed1bf495f9abac181d7f5f","impliedFormat":99},{"version":"3c523f27926905fcbe20b8301a0cc2da317f3f9aea2273f8fc8d9ae88b524819","impliedFormat":99},{"version":"9ca0d706f6b039cc52552323aeccb4db72e600b67ddc7a54cebc095fc6f35539","impliedFormat":99},{"version":"a64909a9f75081342ddd061f8c6b49decf0d28051bc78e698d347bdcb9746577","impliedFormat":99},{"version":"7d8d55ae58766d0d52033eae73084c4db6a93c4630a3e17f419dd8a0b2a4dcd8","impliedFormat":99},{"version":"b8b5c8ba972d9ffff313b3c8a3321e7c14523fc58173862187e8d1cb814168ac","impliedFormat":99},{"version":"9c42c0fa76ee36cf9cc7cc34b1389fbb4bd49033ec124b93674ec635fabf7ffe","impliedFormat":99},{"version":"6184c8da9d8107e3e67c0b99dedb5d2dfe5ccf6dfea55c2a71d4037caf8ca196","impliedFormat":99},{"version":"4030ceea7bf41449c1b86478b786e3b7eadd13dfe5a4f8f5fe2eb359260e08b3","impliedFormat":99},{"version":"7bf516ec5dfc60e97a5bde32a6b73d772bd9de24a2e0ec91d83138d39ac83d04","impliedFormat":99},{"version":"e6a6fb3e6525f84edf42ba92e261240d4efead3093aca3d6eb1799d5942ba393","impliedFormat":99},{"version":"45df74648934f97d26800262e9b2af2f77ef7191d4a5c2eb1df0062f55e77891","impliedFormat":99},{"version":"3fe361e4e567f32a53af1f2c67ad62d958e3d264e974b0a8763d174102fe3b29","impliedFormat":99},{"version":"28b520acee4bc6911bfe458d1ad3ebc455fa23678463f59946ad97a327c9ab2b","impliedFormat":99},{"version":"121b39b1a9ad5d23ed1076b0db2fe326025150ef476dccb8bf87778fcc4f6dd7","impliedFormat":99},{"version":"f791f92a060b52aa043dde44eb60307938f18d4c7ac13df1b52c82a1e658953f","impliedFormat":99},{"version":"df09443e7743fd6adc7eb108e760084bacdf5914403b7aac5fbd4dc4e24e0c2c","impliedFormat":99},{"version":"eeb4ff4aa06956083eaa2aad59070361c20254b865d986bc997ee345dbd44cbb","impliedFormat":99},{"version":"ed84d5043444d51e1e5908f664addc4472c227b9da8401f13daa565f23624b6e","impliedFormat":99},{"version":"146bf888b703d8baa825f3f2fb1b7b31bda5dff803e15973d9636cdda33f4af3","impliedFormat":99},{"version":"b4ec8b7a8d23bdf7e1c31e43e5beac3209deb7571d2ccf2a9572865bf242da7c","impliedFormat":99},{"version":"3fba0d61d172091638e56fba651aa1f8a8500aac02147d29bd5a9cc0bc8f9ec2","impliedFormat":99},{"version":"a5a57deb0351b03041e0a1448d3a0cc5558c48e0ed9b79b69c99163cdca64ad8","impliedFormat":99},{"version":"9bcecf0cbc2bfc17e33199864c19549905309a0f9ecc37871146107aac6e05ae","impliedFormat":99},{"version":"d6a211db4b4a821e93c978add57e484f2a003142a6aef9dbfa1fe990c66f337b","impliedFormat":99},{"version":"bd4d10bd44ce3f630dd9ce44f102422cb2814ead5711955aa537a52c8d2cae14","impliedFormat":99},{"version":"08e4c39ab1e52eea1e528ee597170480405716bae92ebe7a7c529f490afff1e0","impliedFormat":99},{"version":"625bb2bc3867557ea7912bd4581288a9fca4f3423b8dffa1d9ed57fafc8610e3","impliedFormat":99},{"version":"d1992164ecc334257e0bef56b1fd7e3e1cea649c70c64ffc39999bb480c0ecdf","impliedFormat":99},{"version":"a53ff2c4037481eb357e33b85e0d78e8236e285b6428b93aa286ceea1db2f5dc","impliedFormat":99},{"version":"4fe608d524954b6857d78857efce623852fcb0c155f010710656f9db86e973a5","impliedFormat":99},{"version":"b53b62a9838d3f57b70cc456093662302abb9962e5555f5def046172a4fe0d4e","impliedFormat":99},{"version":"9866369eb72b6e77be2a92589c9df9be1232a1a66e96736170819e8a1297b61f","impliedFormat":99},{"version":"43abfbdf4e297868d780b8f4cfdd8b781b90ecd9f588b05e845192146a86df34","impliedFormat":99},{"version":"582419791241fb851403ae4a08d0712a63d4c94787524a7419c2bc8e0eb1b031","impliedFormat":99},{"version":"18437eeb932fe48590b15f404090db0ab3b32d58f831d5ffc157f63b04885ee5","impliedFormat":99},{"version":"0c5eaedf622d7a8150f5c2ec1f79ac3d51eea1966b0b3e61bfdea35e8ca213a7","impliedFormat":99},{"version":"fac39fc7a9367c0246de3543a6ee866a0cf2e4c3a8f64641461c9f2dac0d8aae","impliedFormat":99},{"version":"3b9f559d0200134f3c196168630997caedeadc6733523c8b6076a09615d5dec8","impliedFormat":99},{"version":"932af64286d9723da5ef7b77a0c4229829ce8e085e6bcc5f874cb0b83e8310d4","impliedFormat":99},{"version":"adeb9278f11f5561157feee565171c72fd48f5fe34ed06f71abf24e561fcaa1e","impliedFormat":99},{"version":"2269fef79b4900fc6b08c840260622ca33524771ff24fda5b9101ad98ea551f3","impliedFormat":99},{"version":"73d47498a1b73d5392d40fb42a3e7b009ae900c8423f4088c4faa663cc508886","impliedFormat":99},{"version":"7efc34cdc4da0968c3ba687bc780d5cacde561915577d8d1c1e46c7ac931d023","impliedFormat":99},{"version":"3c20a3bb0c50c819419f44aa55acc58476dad4754a16884cef06012d02b0722f","impliedFormat":99},{"version":"4569abf6bc7d51a455503670f3f1c0e9b4f8632a3b030e0794c61bfbba2d13be","impliedFormat":99},{"version":"98b2297b4dc1404078a54b61758d8643e4c1d7830af724f3ed2445d77a7a2d57","impliedFormat":99},{"version":"952ba89d75f1b589e07070fea2d8174332e3028752e76fd46e1c16cc51e6e2af","impliedFormat":99},{"version":"b6c9a2deefb6a57ff68d2a38d33c34407b9939487fc9ee9f32ba3ecf2987a88a","impliedFormat":99},{"version":"f6b371377bab3018dac2bca63e27502ecbd5d06f708ad7e312658d3b5315d948","impliedFormat":99},{"version":"31947dd8f1c8eeb7841e1f139a493a73bd520f90e59a6415375d0d8e6a031f01","impliedFormat":99},{"version":"95cd83b807e10b1af408e62caf5fea98562221e8ddca9d7ccc053d482283ddda","impliedFormat":99},{"version":"19287d6b76288c2814f1633bdd68d2b76748757ffd355e73e41151644e4773d6","impliedFormat":99},{"version":"fc4e6ec7dade5f9d422b153c5d8f6ad074bd9cc4e280415b7dc58fb5c52b5df1","impliedFormat":99},{"version":"3aea973106e1184db82d8880f0ca134388b6cbc420f7309d1c8947b842886349","impliedFormat":99},{"version":"765e278c464923da94dda7c2b281ece92f58981642421ae097862effe2bd30fa","impliedFormat":99},{"version":"de260bed7f7d25593f59e859bd7c7f8c6e6bb87e8686a0fcafa3774cb5ca02d8","impliedFormat":99},{"version":"b5c341ce978f5777fbe05bc86f65e9906a492fa6b327bda3c6aae900c22e76c6","impliedFormat":99},{"version":"686ddbfaf88f06b02c6324005042f85317187866ca0f8f4c9584dd9479653344","impliedFormat":99},{"version":"7f789c0c1db29dd3aab6e159d1ba82894a046bf8df595ac48385931ae6ad83e0","impliedFormat":99},{"version":"8eb3057d4fe9b59b2492921b73a795a2455ebe94ccb3d01027a7866612ead137","impliedFormat":99},{"version":"1e43c5d7aee1c5ec20611e28b5417f5840c75d048de9d7f1800d6808499236f8","impliedFormat":99},{"version":"d42610a5a2bee4b71769968a24878885c9910cd049569daa2d2ee94208b3a7a5","impliedFormat":99},{"version":"f6ed95506a6ed2d40ed5425747529befaa4c35fcbbc1e0d793813f6d725690fa","impliedFormat":99},{"version":"a6fcc1cd6583939506c906dff1276e7ebdc38fbe12d3e108ba38ad231bd18d97","impliedFormat":99},{"version":"ed13354f0d96fb6d5878655b1fead51722b54875e91d5e53ef16de5b71a0e278","impliedFormat":99},{"version":"1193b4872c1fb65769d8b164ca48124c7ebacc33eae03abf52087c2b29e8c46c","impliedFormat":99},{"version":"af682dfabe85688289b420d939020a10eb61f0120e393d53c127f1968b3e9f66","impliedFormat":99},{"version":"0dca04006bf13f72240c6a6a502df9c0b49c41c3cab2be75e81e9b592dcd4ea8","impliedFormat":99},{"version":"79d6ac4a2a229047259116688f9cd62fda25422dee3ad304f77d7e9af53a41ef","impliedFormat":99},{"version":"64534c17173990dc4c3d9388d16675a059aac407031cfce8f7fdffa4ee2de988","impliedFormat":99},{"version":"ba46d160a192639f3ca9e5b640b870b1263f24ac77b6895ab42960937b42dcbb","impliedFormat":99},{"version":"5e5ddd6fc5b590190dde881974ab969455e7fad61012e32423415ae3d085b037","impliedFormat":99},{"version":"1c16fd00c42b60b96fe0fa62113a953af58ddf0d93b0a49cb4919cf5644616f0","impliedFormat":99},{"version":"eb240c0e6b412c57f7d9a9f1c6cd933642a929837c807b179a818f6e8d3a4e44","impliedFormat":99},{"version":"4a7bde5a1155107fc7d9483b8830099f1a6072b6afda5b78d91eb5d6549b3956","impliedFormat":99},{"version":"3c1baaffa9a24cc7ef9eea6b64742394498e0616b127ca630aca0e11e3298006","impliedFormat":99},{"version":"87ca1c31a326c898fa3feb99ec10750d775e1c84dbb7c4b37252bcf3742c7b21","impliedFormat":99},{"version":"d7bd26af1f5457f037225602035c2d7e876b80d02663ab4ca644099ad3a55888","impliedFormat":99},{"version":"2ad0a6b93e84a56b64f92f36a07de7ebcb910822f9a72ad22df5f5d642aff6f3","impliedFormat":99},{"version":"523d1775135260f53f672264937ee0f3dc42a92a39de8bee6c48c7ea60b50b5a","impliedFormat":99},{"version":"e441b9eebbc1284e5d995d99b53ed520b76a87cab512286651c4612d86cd408e","impliedFormat":99},{"version":"76f853ee21425c339a79d28e0859d74f2e53dee2e4919edafff6883dd7b7a80f","impliedFormat":99},{"version":"00cf042cd6ba1915648c8d6d2aa00e63bbbc300ea54d28ed087185f0f662e080","impliedFormat":99},{"version":"f57e6707d035ab89a03797d34faef37deefd3dd90aa17d90de2f33dce46a2c56","impliedFormat":99},{"version":"cc8b559b2cf9380ca72922c64576a43f000275c72042b2af2415ce0fb88d7077","impliedFormat":99},{"version":"1a337ca294c428ba8f2eb01e887b28d080ee4a4307ae87e02e468b1d26af4a74","impliedFormat":99},{"version":"5a15362fc2e72765a908c0d4dd89e3ab3b763e8bc8c23f19234a709ecfd202fe","impliedFormat":99},{"version":"2dffdfe62ac8af0943853234519616db6fd8958fc7ff631149fd8364e663f361","impliedFormat":99},{"version":"5dbdb2b2229b5547d8177c34705272da5a10b8d0033c49efbc9f6efba5e617f2","impliedFormat":99},{"version":"6fc0498cd8823d139004baff830343c9a0d210c687b2402c1384fb40f0aa461c","impliedFormat":99},{"version":"8492306a4864a1dc6fc7e0cc0de0ae9279cbd37f3aae3e9dc1065afcdc83dddc","impliedFormat":99},{"version":"c011b378127497d6337a93f020a05f726db2c30d55dc56d20e6a5090f05919a6","impliedFormat":99},{"version":"f4556979e95a274687ae206bbab2bb9a71c3ad923b92df241d9ab88c184b3f40","impliedFormat":99},{"version":"50e82bb6e238db008b5beba16d733b77e8b2a933c9152d1019cf8096845171a4","impliedFormat":99},{"version":"d6011f8b8bbf5163ef1e73588e64a53e8bf1f13533c375ec53e631aad95f1375","impliedFormat":99},{"version":"693cd7936ac7acfa026d4bcb5801fce71cec49835ba45c67af1ef90dbfd30af7","impliedFormat":99},{"version":"195e2cf684ecddfc1f6420564535d7c469f9611ce7a380d6e191811f84556cd2","impliedFormat":99},{"version":"1dc6b6e7b2a7f2962f31c77f4713f3a5a132bbe14c00db75d557568fe82e4311","impliedFormat":99},{"version":"add93b1180e9aaac2dae4ef3b16f7655893e2ecbe62bd9e48366c305f0063d89","impliedFormat":99},{"version":"594bd896fe37c970aafb7a376ebeec4c0d636b62a5f611e2e27d30fb839ad8a5","impliedFormat":99},{"version":"b1c6a6faf60542ba4b4271db045d7faea56e143b326ef507d2797815250f3afc","impliedFormat":99},{"version":"8c8b165beb794260f462679329b131419e9f5f35212de11c4d53e6d4d9cbedf6","impliedFormat":99},{"version":"ee5a4cf57d49fcf977249ab73c690a59995997c4672bb73fcaaf2eed65dbd1b2","impliedFormat":99},{"version":"f9f36051f138ab1c40b76b230c2a12b3ce6e1271179f4508da06a959f8bee4c1","impliedFormat":99},{"version":"9dc2011a3573d271a45c12656326530c0930f92539accbec3531d65131a14a14","impliedFormat":99},{"version":"091521ce3ede6747f784ae6f68ad2ea86bbda76b59d2bf678bcad2f9d141f629","impliedFormat":99},{"version":"202c2be951f53bafe943fb2c8d1245e35ed0e4dfed89f48c9a948e4d186dd6d4","impliedFormat":99},{"version":"c618aead1d799dbf4f5b28df5a6b9ce13d72722000a0ec3fe90a8115b1ea9226","impliedFormat":99},{"version":"9b0bf59708549c3e77fddd36530b95b55419414f88bbe5893f7bc8b534617973","impliedFormat":99},{"version":"7e216f67c4886f1bde564fb4eebdd6b185f262fe85ad1d6128cad9b229b10354","impliedFormat":99},{"version":"cd51e60b96b4d43698df74a665aa7a16604488193de86aa60ec0c44d9f114951","impliedFormat":99},{"version":"b63341fb6c7ba6f2aeabd9fc46b43e6cc2d2b9eec06534cfd583d9709f310ec2","impliedFormat":99},{"version":"be2af50c81b15bcfe54ad60f53eb1c72dae681c72d0a9dce1967825e1b5830a3","impliedFormat":99},{"version":"be5366845dfb9726f05005331b9b9645f237f1ddc594c0def851208e8b7d297b","impliedFormat":99},{"version":"5ddd536aaeadd4bf0f020492b3788ed209a7050ce27abec4e01c7563ff65da81","impliedFormat":99},{"version":"e243b24da119c1ef0d79af2a45217e50682b139cb48e7607efd66cc01bd9dcda","impliedFormat":99},{"version":"5b1398c8257fd180d0bf62e999fe0a89751c641e87089a83b24392efda720476","impliedFormat":99},{"version":"1588b1359f8507a16dbef67cd2759965fc2e8d305e5b3eb71be5aa9506277dff","impliedFormat":99},{"version":"4c99f2524eee1ec81356e2b4f67047a4b7efaf145f1c4eb530cd358c36784423","impliedFormat":99},{"version":"b30c6b9f6f30c35d6ef84daed1c3781e367f4360171b90598c02468b0db2fc3d","impliedFormat":99},{"version":"79c0d32274ccfd45fae74ac61d17a2be27aea74c70806d22c43fc625b7e9f12a","impliedFormat":99},{"version":"1b7e3958f668063c9d24ac75279f3e610755b0f49b1c02bb3b1c232deb958f54","impliedFormat":99},{"version":"779d4022c3d0a4df070f94858a33d9ebf54af3664754536c4ce9fd37c6f4a8db","impliedFormat":99},{"version":"e662f063d46aa8c088edffdf1d96cb13d9a2cbf06bc38dc6fc62b4d125fb7b49","impliedFormat":99},{"version":"d1d612df1e41c90d9678b07740d13d4f8e6acec2f17390d4ff4be5c889a6d37d","impliedFormat":99},{"version":"c95933fe140918892d569186f17b70ef6b1162f851a0f13f6a89e8f4d599c5a1","impliedFormat":99},{"version":"1d8d30677f87c13c2786980a80750ac1e281bdb65aa013ea193766fe9f0edd74","impliedFormat":99},{"version":"4661673cbc984b8a6ee5e14875a71ed529b64e7f8e347e12c0db4cecc25ad67d","impliedFormat":99},{"version":"7f980a414274f0f23658baa9a16e21d828535f9eac538e2eab2bb965325841db","impliedFormat":99},{"version":"20fb747a339d3c1d4a032a31881d0c65695f8167575e01f222df98791a65da9b","impliedFormat":99},{"version":"dd4e7ebd3f205a11becf1157422f98db675a626243d2fbd123b8b93efe5fb505","impliedFormat":99},{"version":"43ec6b74c8d31e88bb6947bb256ad78e5c6c435cbbbad991c3ff39315b1a3dba","impliedFormat":99},{"version":"b27242dd3af2a5548d0c7231db7da63d6373636d6c4e72d9b616adaa2acef7e1","impliedFormat":99},{"version":"e0ee7ba0571b83c53a3d6ec761cf391e7128d8f8f590f8832c28661b73c21b68","impliedFormat":99},{"version":"072bfd97fc61c894ef260723f43a416d49ebd8b703696f647c8322671c598873","impliedFormat":99},{"version":"e70875232f5d5528f1650dd6f5c94a5bed344ecf04bdbb998f7f78a3c1317d02","impliedFormat":99},{"version":"8e495129cb6cd8008de6f4ff8ce34fe1302a9e0dcff8d13714bd5593be3f7898","impliedFormat":99},{"version":"7b8c7a952cf49e78aafe5f628c3bd90f7e01bd5602eb5d3650bef5727a8186d7","signature":"4700c4aaa2f5711d21a8cd9a22eef223fe7b80bd96a12d3467cb6f84c81a3f25"},{"version":"31c30cc54e8c3da37c8e2e40e5658471f65915df22d348990d1601901e8c9ff3","impliedFormat":99},{"version":"59967c334f56dd44100e49b1fc18db428e7f15f5a28b9c2c4f9a3b7dcb4db4b7","signature":"f31a2a838ba8df2488a275e7ecc0d047fa7f08532bbf4edbfbaf7f31753dafcb"},"a4e3fb5879ca4da49fa1ebd412bb253f69de856268ec41ad6cf39726bd3d7d01",{"version":"954221001df9670d25d50703a81de40597f1fdeb854f35028eb3dd9cdbcde2c1","signature":"30ce1cdeada71c5b56e82c0a89fba5577330b443c9b54d846b902582277aed8a"},"78a4a4d5bf2c95f6046496553091121c154815d1844ea05831d62fbc7ab5f256",{"version":"9f7a3c434912fd3feb87af4aabdf0d1b614152ecb5e7b2aa1fff3429879cdd51","impliedFormat":99},{"version":"b12ca5cef859dd75b274337234bae66e413b0f97845243254a1dedcb2d7a7237","signature":"e23e12b3b25689e0b4c6d889ea40807bbda4dafd177e6b099382e9ca31da6c77"},{"version":"bbf004e3b1d2de48c7dc49cc019d79054312b423620de6078efd4a7b3013ddb2","signature":"c83b46495fe042bb12e432bad3a26d89686860910419fe4016632e4c20d982f2"},"d477975b1660774736964c6d5223324f242da3f25019c2244281efb46615edf2","eeeeefdf15ba78f52c511b80ee655f3bd845a180ebcd1c3832da958f7a3aa1e2",{"version":"0345bc0b1067588c4ea4c48e34425d3284498c629bc6788ebc481c59949c9037","impliedFormat":99},{"version":"e30f5b5d77c891bc16bd65a2e46cd5384ea57ab3d216c377f482f535db48fc8f","impliedFormat":99},{"version":"f113afe92ee919df8fc29bca91cab6b2ffbdd12e4ac441d2bb56121eb5e7dbe3","impliedFormat":99},{"version":"49d567cc002efb337f437675717c04f207033f7067825b42bb59c9c269313d83","impliedFormat":99},{"version":"1d248f707d02dc76555298a934fba0f337f5028bb1163ce59cd7afb831c9070f","impliedFormat":99},{"version":"5d8debffc9e7b842dc0f17b111673fe0fc0cca65e67655a2b543db2150743385","impliedFormat":99},{"version":"5fccbedc3eb3b23bc6a3a1e44ceb110a1f1a70fa8e76941dce3ae25752caa7a9","impliedFormat":99},{"version":"f4031b95f3bab2b40e1616bd973880fb2f1a97c730bac5491d28d6484fac9560","impliedFormat":99},{"version":"dbe75b3c5ed547812656e7945628f023c4cd0bc1879db0db3f43a57fb8ec0e2b","impliedFormat":99},{"version":"b754718a546a1939399a6d2a99f9022d8a515f2db646bab09f7d2b5bff3cbb82","impliedFormat":99},{"version":"2eef10fb18ed0b4be450accf7a6d5bcce7b7f98e02cac4e6e793b7ad04fc0d79","impliedFormat":99},{"version":"c46f471e172c3be12c0d85d24876fedcc0c334b0dab48060cdb1f0f605f09fed","impliedFormat":99},{"version":"7d6ddeead1d208588586c58c26e4a23f0a826b7a143fb93de62ed094d0056a33","impliedFormat":99},{"version":"7c5782291ff6e7f2a3593295681b9a411c126e3736b83b37848032834832e6b9","impliedFormat":99},{"version":"3a3f09df6258a657dd909d06d4067ee360cd2dccc5f5d41533ae397944a11828","impliedFormat":99},{"version":"ea54615be964503fec7bce04336111a6fa455d3e8d93d44da37b02c863b93eb8","impliedFormat":99},{"version":"2a83694bc3541791b64b0e57766228ea23d92834df5bf0b0fcb93c5bb418069c","impliedFormat":99},{"version":"b5913641d6830e7de0c02366c08b1d26063b5758132d8464c938e78a45355979","impliedFormat":99},{"version":"46c095d39c1887979d9494a824eda7857ec13fb5c20a6d4f7d02c2975309bf45","impliedFormat":99},{"version":"f6e02ca076dc8e624aa38038e3488ebd0091e2faea419082ed764187ba8a6500","impliedFormat":99},{"version":"4d49e8a78aba1d4e0ad32289bf8727ae53bc2def9285dff56151a91e7d770c3e","impliedFormat":99},{"version":"63315cf08117cc728eab8f3eec8801a91d2cd86f91d0ae895d7fd928ab54596d","impliedFormat":99},{"version":"a14a6f3a5636bcaebfe9ec2ccfa9b07dc94deb1f6c30358e9d8ea800a1190d5e","impliedFormat":99},{"version":"21206e7e81876dabf2a7af7aa403f343af1c205bdcf7eff24d9d7f4eee6214c4","impliedFormat":99},{"version":"cd0a9f0ffec2486cad86b7ef1e4da42953ffeb0eb9f79f536e16ff933ec28698","impliedFormat":99},{"version":"f609a6ec6f1ab04dba769e14d6b55411262fd4627a099e333aa8876ea125b822","impliedFormat":99},{"version":"6d8052bb814be030c64cb22ca0e041fe036ad3fc8d66208170f4e90d0167d354","impliedFormat":99},{"version":"851f72a5d3e8a2bf7eeb84a3544da82628f74515c92bdf23c4a40af26dcc1d16","impliedFormat":99},{"version":"59692a7938aab65ea812a8339bbc63c160d64097fe5a457906ea734d6f36bcd4","impliedFormat":99},{"version":"8cb3b95e610c44a9986a7eab94d7b8f8462e5de457d5d10a0b9c6dd16bde563b","impliedFormat":99},{"version":"f571713abd9a676da6237fe1e624d2c6b88c0ca271c9f1acc1b4d8efeea60b66","impliedFormat":99},{"version":"16c5d3637d1517a3d17ed5ebcfbb0524f8a9997a7b60f6100f7c5309b3bb5ac8","impliedFormat":99},{"version":"ca1ec669726352c8e9d897f24899abf27ad15018a6b6bcf9168d5cd1242058ab","impliedFormat":99},{"version":"bffb1b39484facf6d0c5d5feefe6c0736d06b73540b9ce0cf0f12da2edfd8e1d","impliedFormat":99},{"version":"f1663c030754f6171b8bb429096c7d2743282de7733bccd6f67f84a4c588d96e","impliedFormat":99},{"version":"dd09693285e58504057413c3adc84943f52b07d2d2fd455917f50fa2a63c9d69","impliedFormat":99},{"version":"d94c94593d03d44a03810a85186ae6d61ebeb3a17a9b210a995d85f4b584f23d","impliedFormat":99},{"version":"c7c3bf625a8cb5a04b1c0a2fbe8066ecdbb1f383d574ca3ffdabe7571589a935","impliedFormat":99},{"version":"7a2f39a4467b819e873cd672c184f45f548511b18f6a408fe4e826136d0193bb","impliedFormat":99},{"version":"f8a0ae0d3d4993616196619da15da60a6ec5a7dfaf294fe877d274385eb07433","impliedFormat":99},{"version":"2cca80de38c80ef6c26deb4e403ca1ff4efbe3cf12451e26adae5e165421b58d","impliedFormat":99},{"version":"0070d3e17aa5ad697538bf865faaff94c41f064db9304b2b949eb8bcccb62d34","impliedFormat":99},{"version":"53df93f2db5b7eb8415e98242c1c60f6afcac2db44bce4a8830c8f21eee6b1dd","impliedFormat":99},{"version":"d67bf28dc9e6691d165357424c8729c5443290367344263146d99b2f02a72584","impliedFormat":99},{"version":"932557e93fbdf0c36cc29b9e35950f6875425b3ac917fa0d3c7c2a6b4f550078","impliedFormat":99},{"version":"e3dc7ec1597fb61de7959335fb7f8340c17bebf2feb1852ed8167a552d9a4a25","impliedFormat":99},{"version":"b64e15030511c5049542c2e0300f1fe096f926cf612662884f40227267f5cd9f","impliedFormat":99},{"version":"1932796f09c193783801972a05d8fb1bfef941bb46ac76fbe1abb0b3bfb674fa","impliedFormat":99},{"version":"d9575d5787311ee7d61ad503f5061ebcfaf76b531cfecce3dc12afb72bb2d105","impliedFormat":99},{"version":"5b41d96c9a4c2c2d83f1200949f795c3b6a4d2be432b357ad1ab687e0f0de07c","impliedFormat":99},{"version":"38ec829a548e869de4c5e51671245a909644c8fb8e7953259ebb028d36b4dd06","impliedFormat":99},{"version":"20c2c5e44d37dac953b516620b5dba60c9abd062235cdf2c3bfbf722d877a96b","impliedFormat":99},{"version":"875fe6f7103cf87c1b741a0895fda9240fed6353d5e7941c8c8cbfb686f072b4","impliedFormat":99},{"version":"c0ccccf8fbcf5d95f88ed151d0d8ce3015aa88cf98d4fd5e8f75e5f1534ee7ae","impliedFormat":99},{"version":"1b1f4aba21fd956269ced249b00b0e5bfdbd5ebd9e628a2877ab1a2cf493c919","impliedFormat":99},{"version":"939e3299952dff0869330e3324ba16efe42d2cf25456d7721d7f01a43c1b0b34","impliedFormat":99},{"version":"f0a9b52faec508ba22053dedfa4013a61c0425c8b96598cef3dea9e4a22637c6","impliedFormat":99},{"version":"d5b302f50db61181adc6e209af46ae1f27d7ef3d822de5ea808c9f44d7d219fd","impliedFormat":99},{"version":"19131632ba492c83e8eeadf91a481def0e0b39ffc3f155bc20a7f640e0570335","impliedFormat":99},{"version":"4581c03abea21396c3e1bb119e2fd785a4d91408756209cbeed0de7070f0ab5b","impliedFormat":99},{"version":"ebcd3b99e17329e9d542ef2ccdd64fddab7f39bc958ee99bbdb09056c02d6e64","impliedFormat":99},{"version":"4b148999deb1d95b8aedd1a810473a41d9794655af52b40e4894b51a8a4e6a6d","impliedFormat":99},{"version":"1781cc99a0f3b4f11668bb37cca7b8d71f136911e87269e032f15cf5baa339bf","impliedFormat":99},{"version":"33f1b7fa96117d690035a235b60ecd3cd979fb670f5f77b08206e4d8eb2eb521","impliedFormat":99},{"version":"01429b306b94ff0f1f5548ce5331344e4e0f5872b97a4776bd38fd2035ad4764","impliedFormat":99},{"version":"c1bc4f2136de7044943d784e7a18cb8411c558dbb7be4e4b4876d273cbd952af","impliedFormat":99},{"version":"5470f84a69b94643697f0d7ec2c8a54a4bea78838aaa9170189b9e0a6e75d2cf","impliedFormat":99},{"version":"36aaa44ee26b2508e9a6e93cd567e20ec700940b62595caf962249035e95b5e3","impliedFormat":99},{"version":"f8343562f283b7f701f86ad3732d0c7fd000c20fe5dc47fa4ed0073614202b4d","impliedFormat":99},{"version":"a53c572630a78cd99a25b529069c1e1370f8a5d8586d98e798875f9052ad7ad1","impliedFormat":99},{"version":"4ad3451d066711dde1430c544e30e123f39e23c744341b2dfd3859431c186c53","impliedFormat":99},{"version":"8069cbef9efa7445b2f09957ffbc27b5f8946fdbade4358fb68019e23df4c462","impliedFormat":99},{"version":"cd8b4e7ad04ba9d54eb5b28ac088315c07335b837ee6908765436a78d382b4c3","impliedFormat":99},{"version":"d533d8f8e5c80a30c51f0cbfe067b60b89b620f2321d3a581b5ba9ac8ffd7c3a","impliedFormat":99},{"version":"33f49f22fdda67e1ddbacdcba39e62924793937ea7f71f4948ed36e237555de3","impliedFormat":99},{"version":"710c31d7c30437e2b8795854d1aca43b540cb37cefd5900f09cfcd9e5b8540c4","impliedFormat":99},{"version":"b2c03a0e9628273bc26a1a58112c311ffbc7a0d39938f3878837ab14acf3bc41","impliedFormat":99},{"version":"a93beb0aa992c9b6408e355ea3f850c6f41e20328186a8e064173106375876c2","impliedFormat":99},{"version":"efdcba88fcd5421867898b5c0e8ea6331752492bd3547942dea96c7ebcb65194","impliedFormat":99},{"version":"a98e777e7a6c2c32336a017b011ba1419e327320c3556b9139413e48a8460b9a","impliedFormat":99},{"version":"ea44f7f8e1fe490516803c06636c1b33a6b82314366be1bd6ffa4ba89bc09f86","impliedFormat":99},{"version":"c25f22d78cc7f46226179c33bef0e4b29c54912bde47b62e5fdaf9312f22ffcb","impliedFormat":99},{"version":"d57579cfedc5a60fda79be303080e47dfe0c721185a5d95276523612228fcefc","impliedFormat":99},{"version":"a41630012afe0d4a9ff14707f96a7e26e1154266c008ddbd229e3f614e4d1cf7","impliedFormat":99},{"version":"298a858633dfa361bb8306bbd4cfd74f25ab7cc20631997dd9f57164bc2116d1","impliedFormat":99},{"version":"921782c45e09940feb232d8626a0b8edb881be2956520c42c44141d9b1ddb779","impliedFormat":99},{"version":"06117e4cc7399ce1c2b512aa070043464e0561f956bda39ef8971a2fcbcdbf2e","impliedFormat":99},{"version":"daccf332594b304566c7677c2732fed6e8d356da5faac8c5f09e38c2f607a4ab","impliedFormat":99},{"version":"4386051a0b6b072f35a2fc0695fecbe4a7a8a469a1d28c73be514548e95cd558","impliedFormat":99},{"version":"78e41de491fe25947a7fd8eeef7ebc8f1c28c1849a90705d6e33f34b1a083b90","impliedFormat":99},{"version":"3ccd198e0a693dd293ed22e527c8537c76b8fe188e1ebf20923589c7cfb2c270","impliedFormat":99},{"version":"2ebf2ee015d5c8008428493d4987e2af9815a76e4598025dd8c2f138edc1dcae","impliedFormat":99},{"version":"0dcc8f61382c9fcdafd48acc54b6ffda69ca4bb7e872f8ad12fb011672e8b20c","impliedFormat":99},{"version":"9db563287eb527ead0bcb9eb26fbec32f662f225869101af3cabcb6aee9259cf","impliedFormat":99},{"version":"068489bec523be43f12d8e4c5c337be4ff6a7efb4fe8658283673ae5aae14b85","impliedFormat":99},{"version":"838212d0dc5b97f7c5b5e29a89953de3906f72fce13c5ae3c5ade346f561d226","impliedFormat":99},"aa0428c5a402bbc13e6dae4cf24c724bd12433f4ba303759e509b832ad16b90a","6c49f7c06e04efd48c35b859e253776649bc61b426689c87b2438c0b9661b495","45210e47405e1f10900c717a30acf8282fd139dec17b84fdc25920f5cf145529","4f26ee7004e020e402631b09445bf153f9ad4bc4fdf698467317ae9b27a96441","6fda0453a2a5e76a66071b36a3971a5b07fe36163d42e960b386ceb5a85867fc",{"version":"0ab775f579d92947647b32b2aad2d447dbb4a744364223692895dbcde2d67dbd","signature":"753bf7735818ff2ef122c5765c2445f069e7611aa8cb6c1e5d38596f375d4572"},"612464bbb4305b2770ebed516db61644ac2195cd01e2d68bed8c85513792b02b","afecca5c5eacffe4c28d50218342087d0cf259a59ae47acff01b18f1ac56772b","ae9f4e7a1a689285d3ef74dde581fb7ab9d63db3d982cc005809e2885feb7cf7",{"version":"7a14bf21ae8a29d64c42173c08f026928daf418bed1b97b37ac4bb2aa197b89b","impliedFormat":99},{"version":"e8469e599381cf021ce751c27cca3d8cb06440a45665ca9c2ef2efb0acef1fd9","signature":"fca5bc9aaa54ea2e647742564317e79e2c5a52eb1301d25264e8b8c510a90585"},{"version":"95e68000a650d92e1a88396ba7e9c89deb44f0284440a2c3f99f773b4c8ad68c","signature":"d7a677b57c5aec26229a6cc7f586be5960e70b56612c022984a2989f7edc60d8"},{"version":"6c5345e99a24affc18681b1fefdc11b66cd0cf0ecf6cc81d065ee47c6a9d8425","signature":"efe9e3b81a4aed0a99f154ea784e9cc36c92b3ad54f25dc8d10f9284a2f3b3f7"},{"version":"0c1cc050bcf43cb8f9e95995ca192dbf3567b24dce3139ffc147b4078343b318","signature":"51742e60b46ad2ae283b44d00ea451e9d52410ef457fee990a7f126c63918874"},"de08724f189d954c7d94a65ddd333c404b9a1ae781a40dc8405b47ecfcf02360",{"version":"a7f851c8397984010765eadc00f66dcf3d128d8e360526c8534caaffd2da52bd","signature":"a3a01a6902254aeef2a868e4010669faa0bf286ccff617baab58b9862a2f28d5"},{"version":"9ef4415b37547212c1efee5579e5f5827cdc8ae0029fb30e5d91b24813d4dbc5","signature":"edf0f71c0c1981321654bd7b699645c95e5aca24cf78db6eb95b7fc60dde034d"},{"version":"b5b3139be441c1843f0ea29bf1a70c698a62ea6f26f3596844c46d9c00be1a34","signature":"11ca433652bc0eceb20cd9cd07b4de13a8fd1b4c8e92d6246fe00128dae85713"},{"version":"24849f37ae4b17a684e82e1f93a0a7d6feabfb7b71aa67eebd58d4dc061ec4db","signature":"e367a7faaacde928093e35fbdc7810328e2a3559a97fce908609a5dc1bfdb77d"},{"version":"35e0490f05131567b261d9f2c2c68dda16c3d78ba71ea49be77bca0154b50814","signature":"eef4232b21efbbf39596c430afe292814ce2ded15cf0c342591d78415ecb335b"},{"version":"cee167ee42f019c68826a341fc65e37656b69f371520297adb9a9c9ecfd5b07c","signature":"fbd42b1bc2f3e65d606001e6330ba3c1d934c92cfec1c6cca6edff799333c7f7"},"2a2d16755a0888aefc07c90f2e2427e96f61a7d7e1a4b0aa95fa7433b10a3a4d","12b550aa860553e8cc16722ec30a03d44f4f47e24e1af47e693bad94def9b992",{"version":"f74b70e143e6d9a6e104dd345a2ce6966f0caad5d81f2e0352c25ace3c8e74c8","signature":"acb87a6feadb9f3d2304cb9f79cb3ae9936592872425d85d1cc520aed0387aa2"},{"version":"02e04862ade205563d228fbf0acb7329310f002fe37faea8b255e78e3e60def7","signature":"d7e797e73e3c5a2f1fb5befe8f26f074a2ed2f98ef69b21d5d6f04dd41509106"},{"version":"2a08efbd6afcd5111c147b1cac0db8c2a344ecfa106f587fdd0466b44b19698c","signature":"a3179d1463ac2f19bd0c4ab91c7a1ed643fba24cbc686da6baa96aebb5943f7d"},{"version":"c7957ab43261d6261e1c64f533d7938ef742a269d32873523f5cc6eb6387d7aa","signature":"c2bb49c042bdcbe8dc499247102b61c8a23fd5f7ef1bf90d0f6eca47737ef506"},"d4d6a025490995c140c1d1ffa118c44bad8897c978ae4d11bea54e69512d85e9","6550a43f86a166fb162c5944618554d18426e89f724fed5938bc000bb58b624e",{"version":"add91a5cb372dcbfc3a79415e8514a66f4d744bc79e416b32242d1f72c191515","signature":"7344f16881cbf502dd7498ffbaf1f87c0bb9ef1754b57f6e72d844ca4bb36cb7"},{"version":"967f8f6c5e9d668b21dd6d88560b19f543e4f4ed24860b6bf280c2f1e56cb447","signature":"4fd5129bdaef0969e3b179131ff7d3f364c8030c92be4be702367f2dfffd3a9c"},{"version":"70f1952ca5ef2a46578835e97256058c11ac7e97a05532e41b54b27faebb3ec3","signature":"4092f4dc01b898e971134f55023e332d04d1cc5fbb64bec3fcd7bef4fdf276d4"},{"version":"e8a5d1cd838ba0153dd16c97983739188bb4aad2a3a73012dfefa0189f1bf760","signature":"e1728e07069832cceec0bb7de2270a0e62591dc4eaf0092b8cf881ddabf0deb7"},{"version":"0313acd27d5065690d18feb02ab4910e1dfc05e62e23e3fa31a5674b95b66bb4","signature":"f64f302b77c2951507967bf02e31695f4ed5f0d11016503f78f12984c693f4ce"},{"version":"58b25a143e1796d28da6c2e62a5746504972743846485cdcb7e2e9d347a6c419","signature":"c7f2268ceaa725c54a249605a5079a3fb9478391c1469c1a8c1a3bbb47d026ae"},{"version":"e29f5edf92dc2e277dc6513798fadb26890e65d9b9bab7ef50f196ffe3232b82","signature":"a3d83e13cb60d6250aae9cb13546b3b11697c71b4c727f94076d99c53c0e9943"},{"version":"dcbeee9307911d9d82e9ea5fe5f92c947121cfa0e97d28aefdce547898308214","signature":"297f1390e6cb581b439905d096bb38076aafd4cf11cee284d75e525f555ed8eb"},{"version":"fc59d652cb1695d43fef5ff416938cdfd2cc4902d283b5c681db0686719c4924","signature":"918e1426d1a61f03b9998e3e6a90edb395c51bc50e55abb65c9a6ac9f381120a"},{"version":"d42b5d38071b1f40022f65fe50251f8078956d93507065150703312d862fd56d","signature":"3365f148e7d150053153f012b3789c3af95bed30f2fcfff08f99de31c38f6732"},{"version":"a12f73507ab613e9d797979b988a15e32d23458fc8dd4ba71b922aeee977a3b6","signature":"962b7ee724a1e057a07d808a18a92c4a5744fdfcae837e0c4f354477e9bfb312"},{"version":"6c05d0fcee91437571513c404e62396ee798ff37a2d8bef2104accdc79deb9c0","impliedFormat":1},{"version":"13ccc9b0fe4248e622f83a1d3b2f0566b72b5e04162d7d0c8db8945ecc71b55f","signature":"933fa1ee8f2a4d203589011944fc76d755d90af71b43ae3c1a174bbe7cac4cfa"},{"version":"2a45b0b08329d492c618e2a21647e01a12544c9e815492d393faad430e07383b","affectsGlobalScope":true},"6f9eba87d59354754bb21c5b2a9438bba0229fd39948d017b6ba9cb80285de73","d1986184a09a52db8228cb2bb2a61a8c05c9354e5b93cec8e2628d8579c892d7","e0cd4ec2891863bf2bfeca3381d293673076cc1afce1325846cec9886e6e4eb5",{"version":"a3d3f704c5339a36da3ca8c62b29072f87e86c783b8452d235992142ec71aa2d","impliedFormat":1},{"version":"b1538a92b9bae8d230267210c5db38c2eb6bdb352128a3ce3aa8c6acf9fc9622","impliedFormat":1},{"version":"6fc1a4f64372593767a9b7b774e9b3b92bf04e8785c3f9ea98973aa9f4bbe490","impliedFormat":1},{"version":"ff09b6fbdcf74d8af4e131b8866925c5e18d225540b9b19ce9485ca93e574d84","impliedFormat":1},{"version":"d5895252efa27a50f134a9b580aa61f7def5ab73d0a8071f9b5bf9a317c01c2d","impliedFormat":1},{"version":"2c378d9368abcd2eba8c29b294d40909845f68557bc0b38117e4f04fc56e5f9c","impliedFormat":1},{"version":"56208c500dcb5f42be7e18e8cb578f257a1a89b94b3280c506818fed06391805","impliedFormat":1},{"version":"0c94c2e497e1b9bcfda66aea239d5d36cd980d12a6d9d59e66f4be1fa3da5d5a","impliedFormat":1},{"version":"9b048390bcffe88c023a4cd742a720b41d4cd7df83bc9270e6f2339bf38de278","affectsGlobalScope":true,"impliedFormat":1},{"version":"1f366bde16e0513fa7b64f87f86689c4d36efd85afce7eb24753e9c99b91c319","impliedFormat":1},{"version":"f3d8c757e148ad968f0d98697987db363070abada5f503da3c06aefd9d4248c1","impliedFormat":1},{"version":"96d14f21b7652903852eef49379d04dbda28c16ed36468f8c9fa08f7c14c9538","impliedFormat":1},{"version":"7fa8d75d229eeaee235a801758d9c694e94405013fe77d5d1dd8e3201fc414f1","impliedFormat":1}],"root":[509,510,521,525,609,615,627,630,631,[738,740],750,[828,837],[866,870],[883,906],913,917,918,921,922,932,934,938,939,[986,989],991,[993,1000],1003,1004,1007,[1009,1021],[1023,1031],[1036,1043],[1057,1068],[1119,1122],1126,[1130,1134],1394,[1396,1399],[1401,1404],[1501,1509],[1511,1540],[1542,1546]],"options":{"allowJs":true,"esModuleInterop":true,"jsx":4,"module":99,"skipLibCheck":true,"strict":true,"target":4},"referencedMap":[[1545,1],[509,2],[1546,3],[1543,2],[1544,4],[510,5],[521,6],[613,7],[612,8],[682,9],[644,2],[645,2],[646,2],[647,2],[648,2],[649,2],[650,2],[651,2],[652,2],[653,2],[654,2],[659,10],[660,11],[661,10],[662,10],[663,2],[665,11],[666,10],[667,10],[668,10],[669,10],[670,10],[671,11],[672,11],[673,10],[674,10],[675,11],[676,11],[677,10],[678,10],[664,10],[679,2],[680,2],[689,9],[688,9],[683,2],[690,12],[656,2],[684,2],[685,13],[686,13],[658,14],[657,15],[687,16],[681,2],[695,17],[698,18],[697,17],[696,19],[694,20],[691,2],[693,21],[692,22],[1118,23],[1117,24],[252,2],[626,25],[610,2],[614,26],[611,27],[523,2],[624,2],[625,28],[1006,29],[1395,30],[927,31],[1129,32],[1127,33],[1128,33],[990,34],[1005,35],[923,33],[933,36],[925,31],[1125,37],[926,31],[920,38],[919,33],[1124,39],[929,40],[930,31],[924,33],[937,32],[935,33],[936,33],[1400,41],[1123,35],[992,35],[931,42],[1002,38],[1001,33],[914,43],[1008,35],[1510,41],[1022,44],[928,2],[710,2],[539,2],[954,45],[956,46],[963,47],[957,48],[958,2],[959,45],[960,48],[955,2],[962,48],[953,2],[961,2],[976,49],[982,33],[974,49],[975,50],[983,51],[973,52],[980,52],[966,52],[964,53],[981,54],[977,53],[979,52],[978,53],[972,53],[971,52],[965,52],[967,55],[969,52],[970,52],[968,52],[946,56],[947,57],[945,58],[952,59],[948,60],[949,60],[940,2],[943,61],[944,62],[951,63],[984,64],[985,65],[874,66],[950,67],[871,2],[873,2],[875,66],[941,68],[872,68],[942,67],[1547,2],[542,69],[1548,2],[1549,2],[1550,2],[1551,70],[1552,2],[1554,71],[1555,72],[1553,2],[1556,2],[540,2],[547,2],[1557,2],[1558,2],[140,73],[141,73],[142,74],[97,75],[143,76],[144,77],[145,78],[92,2],[95,79],[93,2],[94,2],[146,80],[147,81],[148,82],[149,83],[150,84],[151,85],[152,85],[153,86],[154,87],[155,88],[156,89],[98,2],[96,2],[157,90],[158,91],[159,92],[191,93],[160,94],[161,95],[162,96],[163,97],[164,98],[165,99],[166,100],[167,101],[168,102],[169,103],[170,103],[171,104],[172,2],[173,105],[175,106],[174,107],[176,108],[177,109],[178,110],[179,111],[180,112],[181,113],[182,114],[183,115],[184,116],[185,117],[186,118],[187,119],[188,120],[99,2],[100,2],[101,2],[139,121],[189,122],[190,123],[623,124],[622,125],[621,124],[195,126],[412,33],[196,127],[194,128],[414,129],[413,130],[192,131],[410,2],[193,132],[83,2],[85,133],[409,33],[269,33],[1559,2],[543,134],[592,135],[593,136],[591,2],[526,2],[536,137],[532,138],[535,139],[601,140],[582,2],[584,141],[604,141],[583,142],[537,2],[534,143],[527,144],[597,145],[529,146],[531,147],[596,2],[594,146],[530,2],[533,144],[528,2],[541,2],[629,148],[628,2],[916,149],[915,150],[911,2],[84,2],[1224,151],[1203,152],[1300,2],[1204,153],[1140,151],[1141,151],[1142,151],[1143,151],[1144,151],[1145,151],[1146,151],[1147,151],[1148,151],[1149,151],[1150,151],[1151,151],[1152,151],[1153,151],[1154,151],[1155,151],[1156,151],[1157,151],[1136,2],[1158,151],[1159,151],[1160,2],[1161,151],[1162,151],[1163,151],[1164,151],[1165,151],[1166,151],[1167,151],[1168,151],[1169,151],[1170,151],[1171,151],[1172,151],[1173,151],[1174,151],[1175,151],[1176,151],[1177,151],[1178,151],[1179,151],[1180,151],[1181,151],[1182,151],[1183,151],[1184,151],[1185,151],[1186,151],[1187,151],[1188,151],[1189,151],[1190,151],[1191,151],[1192,151],[1193,151],[1194,151],[1195,151],[1196,151],[1197,151],[1198,151],[1199,151],[1200,151],[1201,151],[1202,151],[1205,154],[1206,151],[1207,151],[1208,155],[1209,156],[1210,151],[1211,151],[1212,151],[1213,151],[1214,151],[1215,151],[1216,151],[1138,2],[1217,151],[1218,151],[1219,151],[1220,151],[1221,151],[1222,151],[1223,151],[1225,157],[1226,151],[1227,151],[1228,151],[1229,151],[1230,151],[1231,151],[1232,151],[1233,151],[1234,151],[1235,151],[1236,151],[1237,151],[1238,151],[1239,151],[1240,151],[1241,151],[1242,151],[1243,151],[1244,2],[1245,2],[1246,2],[1393,158],[1247,151],[1248,151],[1249,151],[1250,151],[1251,151],[1252,151],[1253,2],[1254,151],[1255,2],[1256,151],[1257,151],[1258,151],[1259,151],[1260,151],[1261,151],[1262,151],[1263,151],[1264,151],[1265,151],[1266,151],[1267,151],[1268,151],[1269,151],[1270,151],[1271,151],[1272,151],[1273,151],[1274,151],[1275,151],[1276,151],[1277,151],[1278,151],[1279,151],[1280,151],[1281,151],[1282,151],[1283,151],[1284,151],[1285,151],[1286,151],[1287,151],[1288,2],[1289,151],[1290,151],[1291,151],[1292,151],[1293,151],[1294,151],[1295,151],[1296,151],[1297,151],[1298,151],[1299,151],[1301,159],[1500,160],[1405,153],[1407,153],[1408,153],[1409,153],[1410,153],[1411,153],[1406,153],[1412,153],[1414,153],[1413,153],[1415,153],[1416,153],[1417,153],[1418,153],[1419,153],[1420,153],[1421,153],[1422,153],[1424,153],[1423,153],[1425,153],[1426,153],[1427,153],[1428,153],[1429,153],[1430,153],[1431,153],[1432,153],[1433,153],[1434,153],[1435,153],[1436,153],[1437,153],[1438,153],[1439,153],[1441,153],[1442,153],[1440,153],[1443,153],[1444,153],[1445,153],[1446,153],[1447,153],[1448,153],[1449,153],[1450,153],[1451,153],[1452,153],[1453,153],[1454,153],[1456,153],[1455,153],[1458,153],[1457,153],[1459,153],[1460,153],[1461,153],[1462,153],[1463,153],[1464,153],[1465,153],[1466,153],[1467,153],[1468,153],[1469,153],[1470,153],[1471,153],[1473,153],[1472,153],[1474,153],[1475,153],[1476,153],[1478,153],[1477,153],[1479,153],[1480,153],[1481,153],[1482,153],[1483,153],[1484,153],[1486,153],[1485,153],[1487,153],[1488,153],[1489,153],[1490,153],[1491,153],[1137,151],[1492,153],[1493,153],[1495,153],[1494,153],[1496,153],[1497,153],[1498,153],[1499,153],[1302,151],[1303,151],[1304,2],[1305,2],[1306,2],[1307,151],[1308,2],[1309,2],[1310,2],[1311,2],[1312,2],[1313,151],[1314,151],[1315,151],[1316,151],[1317,151],[1318,151],[1319,151],[1320,151],[1325,161],[1323,162],[1322,163],[1324,164],[1321,151],[1326,151],[1327,151],[1328,151],[1329,151],[1330,151],[1331,151],[1332,151],[1333,151],[1334,151],[1335,151],[1336,2],[1337,2],[1338,151],[1339,151],[1340,2],[1341,2],[1342,2],[1343,151],[1344,151],[1345,151],[1346,151],[1347,157],[1348,151],[1349,151],[1350,151],[1351,151],[1352,151],[1353,151],[1354,151],[1355,151],[1356,151],[1357,151],[1358,151],[1359,151],[1360,151],[1361,151],[1362,151],[1363,151],[1364,151],[1365,151],[1366,151],[1367,151],[1368,151],[1369,151],[1370,151],[1371,151],[1372,151],[1373,151],[1374,151],[1375,151],[1376,151],[1377,151],[1378,151],[1379,151],[1380,151],[1381,151],[1382,151],[1383,151],[1384,151],[1385,151],[1386,151],[1387,151],[1388,151],[1139,165],[1389,2],[1390,2],[1391,2],[1392,2],[655,2],[522,2],[746,166],[748,167],[747,168],[745,169],[744,2],[1034,170],[1035,171],[702,172],[700,173],[701,2],[699,174],[575,2],[577,175],[576,2],[910,33],[1033,176],[1032,2],[864,177],[1069,178],[862,179],[861,180],[854,181],[863,2],[860,182],[858,183],[839,184],[838,2],[859,185],[842,185],[857,186],[844,187],[855,188],[840,2],[847,189],[850,190],[853,191],[849,192],[851,193],[848,2],[852,181],[856,194],[843,2],[865,195],[1070,196],[512,197],[513,198],[514,198],[515,199],[516,200],[511,201],[909,202],[636,203],[635,204],[634,205],[737,206],[735,207],[736,208],[733,2],[734,209],[520,210],[518,211],[519,212],[517,201],[908,213],[639,214],[633,215],[637,216],[638,217],[632,2],[1056,218],[1054,219],[1051,220],[1050,221],[1045,220],[1053,219],[1052,222],[1046,219],[1044,220],[1049,223],[1047,219],[1048,220],[1055,224],[907,225],[1541,33],[458,226],[463,1],[453,227],[216,228],[256,229],[438,230],[251,231],[233,2],[408,2],[214,2],[427,232],[282,233],[215,2],[336,234],[259,235],[260,236],[407,237],[424,238],[318,239],[432,240],[433,241],[431,242],[430,2],[428,243],[258,244],[217,245],[361,2],[362,246],[288,247],[218,248],[289,247],[284,247],[205,247],[254,249],[253,2],[437,250],[449,2],[241,2],[383,251],[384,252],[378,33],[485,2],[386,2],[387,50],[379,253],[490,254],[489,255],[484,2],[303,2],[423,256],[422,2],[483,257],[380,33],[312,258],[308,259],[313,260],[311,2],[310,261],[309,2],[486,2],[482,2],[488,262],[487,2],[307,259],[477,263],[480,264],[297,265],[296,266],[295,267],[493,33],[294,268],[276,2],[496,2],[499,2],[498,33],[500,269],[198,2],[434,270],[435,271],[436,272],[211,2],[244,2],[210,273],[197,2],[399,33],[203,274],[398,275],[397,276],[388,2],[389,2],[396,2],[391,2],[394,277],[390,2],[392,278],[395,279],[393,278],[213,2],[208,2],[209,247],[264,2],[270,280],[271,281],[268,282],[266,283],[267,284],[262,2],[405,50],[291,50],[457,285],[464,286],[468,287],[441,288],[440,2],[279,2],[501,289],[452,290],[381,291],[382,292],[376,293],[367,2],[404,294],[443,33],[368,295],[406,296],[401,297],[400,2],[402,2],[373,2],[360,298],[442,299],[445,300],[370,301],[374,302],[365,303],[419,304],[451,305],[322,306],[337,307],[206,308],[450,309],[202,310],[272,311],[263,2],[273,312],[349,313],[261,2],[348,314],[91,2],[342,315],[243,2],[363,316],[338,2],[207,2],[237,2],[346,317],[212,2],[274,318],[372,319],[439,320],[371,2],[345,2],[265,2],[351,321],[352,322],[429,2],[354,323],[356,324],[355,325],[246,2],[344,308],[358,326],[321,327],[343,328],[350,329],[221,2],[225,2],[224,2],[223,2],[228,2],[222,2],[231,2],[230,2],[227,2],[226,2],[229,2],[232,330],[220,2],[330,331],[329,2],[334,332],[331,333],[333,334],[335,332],[332,333],[242,335],[292,336],[448,337],[502,2],[472,338],[474,339],[369,340],[473,341],[446,299],[385,299],[219,2],[323,342],[238,343],[239,344],[240,345],[236,346],[418,346],[286,346],[324,347],[287,347],[235,348],[234,2],[328,349],[327,350],[326,351],[325,352],[447,353],[417,354],[416,355],[377,356],[411,357],[415,358],[426,359],[425,360],[421,361],[320,362],[317,363],[319,364],[316,365],[357,366],[347,2],[462,2],[359,367],[420,2],[275,368],[366,270],[364,369],[277,370],[280,371],[497,2],[278,372],[281,372],[460,2],[459,2],[461,2],[495,2],[283,373],[444,2],[314,374],[306,33],[257,2],[201,375],[290,2],[466,33],[200,2],[476,376],[305,33],[470,50],[304,377],[455,378],[302,376],[204,2],[478,379],[300,33],[301,33],[293,2],[199,2],[299,380],[298,381],[245,382],[375,102],[285,102],[353,2],[340,383],[339,2],[403,259],[315,33],[456,384],[86,33],[89,385],[90,386],[87,33],[88,2],[255,387],[250,388],[249,2],[248,389],[247,2],[454,390],[465,391],[467,392],[469,393],[471,394],[475,395],[508,396],[479,396],[507,397],[481,398],[491,399],[492,400],[494,401],[503,402],[506,273],[505,2],[504,403],[841,2],[620,404],[617,403],[619,405],[618,2],[616,2],[570,406],[568,407],[569,408],[557,409],[558,407],[565,410],[556,411],[561,412],[571,2],[562,413],[567,414],[573,415],[572,416],[555,417],[563,418],[564,419],[559,420],[566,406],[560,421],[846,422],[845,423],[524,424],[1071,2],[1087,425],[1088,425],[1089,425],[1103,426],[1090,427],[1091,427],[1092,428],[1084,429],[1082,430],[1073,2],[1077,431],[1081,432],[1079,433],[1086,434],[1074,435],[1075,436],[1076,437],[1078,438],[1080,439],[1083,440],[1085,441],[1093,427],[1094,427],[1095,427],[1096,425],[1097,427],[1098,427],[1072,427],[1099,2],[1101,442],[1100,427],[1102,425],[549,443],[548,444],[341,445],[1135,33],[554,2],[880,446],[881,447],[882,448],[877,449],[879,2],[876,450],[878,451],[912,2],[602,2],[538,2],[81,2],[82,2],[13,2],[14,2],[16,2],[15,2],[2,2],[17,2],[18,2],[19,2],[20,2],[21,2],[22,2],[23,2],[24,2],[3,2],[25,2],[26,2],[4,2],[27,2],[31,2],[28,2],[29,2],[30,2],[32,2],[33,2],[34,2],[5,2],[35,2],[36,2],[37,2],[38,2],[6,2],[42,2],[39,2],[40,2],[41,2],[43,2],[7,2],[44,2],[49,2],[50,2],[45,2],[46,2],[47,2],[48,2],[8,2],[54,2],[51,2],[52,2],[53,2],[55,2],[9,2],[56,2],[57,2],[58,2],[60,2],[59,2],[61,2],[62,2],[10,2],[63,2],[64,2],[65,2],[11,2],[66,2],[67,2],[68,2],[69,2],[70,2],[1,2],[71,2],[72,2],[12,2],[76,2],[74,2],[79,2],[78,2],[73,2],[77,2],[75,2],[80,2],[117,452],[127,453],[116,452],[137,454],[108,455],[107,456],[136,403],[130,457],[135,458],[110,459],[124,460],[109,461],[133,462],[105,463],[104,403],[134,464],[106,465],[111,466],[112,2],[115,466],[102,2],[138,467],[128,468],[119,469],[120,470],[122,471],[118,472],[121,473],[131,403],[113,474],[114,475],[123,476],[103,477],[126,468],[125,466],[129,2],[132,478],[721,479],[640,2],[705,2],[643,480],[704,481],[711,482],[712,2],[709,483],[707,484],[706,2],[713,2],[703,485],[716,2],[642,2],[641,33],[717,486],[715,487],[714,485],[719,488],[720,489],[718,490],[708,2],[732,223],[731,491],[722,492],[730,493],[729,494],[728,495],[724,220],[727,488],[725,2],[726,220],[723,496],[545,497],[581,498],[551,499],[552,2],[546,497],[544,2],[550,500],[579,2],[574,2],[578,501],[553,2],[580,502],[599,503],[608,504],[598,505],[603,506],[590,507],[587,508],[595,2],[588,138],[743,509],[741,510],[606,511],[605,512],[586,513],[742,514],[585,2],[589,515],[607,516],[749,517],[600,2],[827,518],[1106,519],[1108,520],[1115,521],[1110,2],[1111,2],[1109,522],[1112,523],[1104,2],[1105,2],[1116,524],[1107,525],[1113,2],[1114,526],[821,527],[825,528],[822,528],[818,527],[826,529],[823,530],[824,528],[819,531],[820,532],[814,533],[758,534],[760,535],[813,2],[759,536],[817,537],[816,538],[815,539],[751,2],[761,534],[762,2],[753,540],[757,541],[752,2],[754,542],[755,543],[756,2],[763,544],[764,544],[765,544],[766,544],[767,544],[768,544],[769,544],[770,544],[771,544],[772,544],[773,544],[774,544],[775,544],[777,544],[776,544],[778,544],[779,544],[780,544],[781,544],[812,545],[782,544],[783,544],[784,544],[785,544],[786,544],[787,544],[788,544],[789,544],[790,544],[791,544],[792,544],[793,544],[794,544],[796,544],[795,544],[797,544],[798,544],[799,544],[800,544],[801,544],[802,544],[803,544],[804,544],[805,544],[806,544],[807,544],[808,544],[811,544],[809,544],[810,544],[525,546],[615,547],[627,548],[630,549],[631,550],[740,547],[750,551],[830,552],[831,553],[835,554],[837,555],[1068,556],[1119,557],[1120,558],[1121,559],[1404,560],[1399,561],[1397,562],[1398,563],[1509,564],[1515,565],[1516,566],[1523,567],[1501,568],[1528,569],[1529,570],[1134,571],[1533,572],[1534,573],[1530,556],[1531,563],[1532,574],[1537,575],[1536,563],[1535,576],[1538,577],[1539,578],[1066,579],[1067,580],[869,581],[870,582],[904,583],[906,584],[905,585],[1064,586],[1065,587],[1402,588],[1403,589],[1522,590],[1502,591],[1506,592],[1507,593],[1503,594],[1508,595],[1504,596],[1505,597],[1520,598],[1519,599],[1518,599],[1521,600],[1517,601],[1525,602],[1527,603],[1526,604],[1524,605],[994,606],[989,607],[987,608],[995,609],[1514,610],[1513,611],[1512,612],[999,613],[1019,563],[1017,614],[1011,615],[1012,616],[1020,617],[1015,618],[1016,619],[1000,620],[1031,621],[998,622],[1004,623],[997,624],[1021,625],[1030,626],[1025,627],[1026,628],[1029,563],[1028,629],[1027,630],[1024,631],[1036,632],[1039,633],[1038,634],[1037,635],[1132,636],[1131,637],[1122,638],[1133,639],[1007,640],[1396,641],[939,642],[1130,643],[988,644],[917,644],[996,645],[991,646],[1014,647],[934,648],[1126,649],[1540,650],[918,645],[921,651],[1013,622],[938,652],[1401,653],[993,654],[932,655],[1003,656],[1010,648],[1018,612],[1542,657],[1009,658],[1394,645],[1511,659],[922,645],[1023,660],[1040,50],[833,661],[892,662],[891,663],[890,664],[836,665],[832,547],[867,666],[868,667],[1041,547],[1042,668],[1043,669],[834,547],[866,670],[1057,671],[738,672],[829,673],[887,674],[886,664],[1058,675],[828,676],[986,677],[1060,678],[1059,679],[913,680],[1061,680],[894,676],[739,681],[899,682],[901,682],[895,683],[897,684],[883,685],[1062,686],[903,687],[889,688],[888,689],[893,690],[900,691],[902,692],[885,693],[896,694],[898,695],[884,696],[1063,556],[609,697]],"affectedFilesPendingEmit":[1546,1544,521,525,615,627,630,631,740,750,830,831,835,837,1068,1119,1120,1121,1404,1399,1397,1398,1509,1515,1516,1523,1501,1528,1529,1134,1533,1534,1530,1531,1532,1537,1536,1535,1538,1539,1066,1067,869,870,904,906,905,1064,1065,1402,1403,1522,1502,1506,1507,1503,1508,1504,1505,1520,1519,1518,1521,1517,1525,1527,1526,1524,994,989,987,995,1514,1513,1512,999,1019,1017,1011,1012,1020,1015,1016,1000,1031,998,1004,997,1021,1030,1025,1026,1029,1028,1027,1024,1036,1039,1038,1037,1132,1131,1122,1133,1007,1396,939,1130,988,917,996,991,1014,934,1126,1540,918,921,1013,938,1401,993,932,1003,1010,1018,1542,1009,1394,1511,922,1023,1040,833,892,891,890,836,832,867,868,1041,1042,1043,834,866,1057,738,829,887,886,1058,828,986,1060,1059,913,1061,894,739,899,901,895,897,883,1062,903,889,888,893,900,902,885,896,898,884,1063,609],"version":"5.9.3"}
```

# uploads/4b4c1eb4-e586-4751-b669-0e98eee2f830.pdf

This is a binary file of the type: PDF

# uploads/58049bad-8b5c-49a7-886f-7de53f8edfbe.pdf

This is a binary file of the type: PDF

# uploads/cc334f9f-933d-4be2-b27e-3b82058d6652.docx

This is a binary file of the type: Word Document

# uploads/dbbddf3e-8fca-4fbb-9622-72717decf8f5.pdf

This is a binary file of the type: PDF

# vitest.config.ts

```ts
import { defineConfig } from "vitest/config";
import path from "path";

export default defineConfig({
  test: {
    globals: true,
    environment: "node",
    include: ["src/__tests__/**/*.test.ts"],
    coverage: {
      provider: "v8",
      reporter: ["text", "json", "html"],
      include: ["src/lib/**/*.ts"],
    },
  },
  resolve: {
    alias: {
      "@": path.resolve(__dirname, "./src"),
    },
  },
});

```

